{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../app-builder/common/constants/common.constant.ts","webpack:///./common/angular-constants.ts","webpack:///./common/services/dialog-service.ts","webpack:///./common/helper.ts","webpack:///./common/defines.ts","webpack:///./designer/editor/services/editor-service.ts","webpack:///../app-builder/common/enums/value-type.enum.ts","webpack:///./components/services/framework-service.ts","webpack:///../app-builder/common/enums/size-type.enum.ts","webpack:///../app-builder/common/enums/binding-type.enum.ts","webpack:///../app-builder/common/model/databearer/components/json-component.model.ts","webpack:///../app-builder/common/constants/sohoxi.constant.ts","webpack:///../app-builder/common/model/databearer/dataservice/json-datasource.model.ts","webpack:///../app-builder/common/model/databearer/json-binding.model.ts","webpack:///../app-builder/common/enums/orientation.enum.ts","webpack:///./components/component.ts","webpack:///./common/sohoxi/utils.ts","webpack:///./common/error-response.ts","webpack:///../app-builder/common/constants/interaction-defines.constant.ts","webpack:///../app-builder/common/enums/datasource-type.enum.ts","webpack:///./designer/editor/components/editor-component.ts","webpack:///./designer/editor/component-settings/settings-base.ts","webpack:///../app-builder/common/project/backward-compatible.ts","webpack:///./designer/editor/defines.ts","webpack:///./common/IComponent.ts","webpack:///./components/helper.ts","webpack:///./common/services/common-service.ts","webpack:///./components/services/translation-management-service.ts","webpack:///../app-builder/common/model/sohoxi/sohoxi-datagrid.model.ts","webpack:///./components/defines.ts","webpack:///./common/services/http-service.ts","webpack:///./common/services/feature-switch-service.ts","webpack:///./common/instance-event.ts","webpack:///./common/sohoxi/datagrid-helper.ts","webpack:///./common/shared-components/base/field-validation.ts","webpack:///../app-builder/components/services/framework.service.ts","webpack:///../app-builder/components/services/dynamic-component.service.ts","webpack:///../app-builder/common/model/project/boundary.model.ts","webpack:///./common/debugger.ts","webpack:///../app-builder/common/enums/parameter-type.enum.ts","webpack:///./common/model/datasource/datasource.model.ts","webpack:///../app-builder/common/model/components/settings/component-field-setting.model.ts","webpack:///./designer/editor/component-settings/component-settings.ts","webpack:///../app-builder/components/interaction/interaction.ts","webpack:///../app-builder/common/enums/http-verb.enum.ts","webpack:///../app-builder/common/project/designer-mashup.ts","webpack:///./common/sohoxi/custom-formatters.ts","webpack:///./common/shared-components/base/feature-switch-ctrl.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/etc-assets/user-control-es.ts","webpack:///../app-builder/common/project/manifest/designer-manifest.ts","webpack:///../app-builder/common/model/components/settings/component-setting-category.model.ts","webpack:///./common/shared-components/base/notifiable-component.ts","webpack:///./designer/services/designer-service.ts","webpack:///./designer/editor/helper.ts","webpack:///./common/services/language-service.ts","webpack:///./components/services/local-ido-service.ts","webpack:///./designer/services/project-service.ts","webpack:///./designer/editor/services/interaction-management-service.ts","webpack:///../app-builder/common/model/dataservice/parameter-object.model.ts","webpack:///../app-builder/common/model/databearer/json-interaction.model.ts","webpack:///../app-builder/common/model/databearer/components/json-datagrid.model.ts","webpack:///../app-builder/common/model/databearer/json-layout-component.model.ts","webpack:///../app-builder/common/model/databearer/json-manifest.model.ts","webpack:///./components/application-parent.ts","webpack:///./components/flexbox/flexbox.ts","webpack:///./components/services/datasource-service.ts","webpack:///./designer/repository/repository-service.ts","webpack:///./designer/editor/wizard/wizard-ctrl.ts","webpack:///../app-builder/common/helpers/data-service.helper.ts","webpack:///./components/datagrid/datagrid.ts","webpack:///./components/lookup/lookup.ts","webpack:///./components/tabs/tab-panel.ts","webpack:///./app.state.ts","webpack:///./designer/editor/services/undo-service.ts","webpack:///./designer/editor/component-settings/generic-settings.ts","webpack:///../app-builder/components/base/component.ts","webpack:///../app-builder/components/base/component.metadata.ts","webpack:///../app-builder/common/project/runtime-app.ts","webpack:///../app-builder/common/project/mashup.ts","webpack:///../app-builder/common/helpers/json.helper.ts","webpack:///../app-builder/common/helpers/date.helper.ts","webpack:///../app-builder/common/model/dataservice/list-data-item.model.ts","webpack:///./components/layout-component.ts","webpack:///./components/list/list.ts","webpack:///./components/tabs/tabs.ts","webpack:///../app-builder/common/model/databearer/components/json-flexbox.model.ts","webpack:///./common/dialogs/test-dataservice/test-dataservice-dialog.ts","webpack:///./common/sohoxi/component/datagrid-directive.ts","webpack:///./common/dialogs/export/export-dialog.html","webpack:///./designer/repository/datasource/create-wizard/datasource-wizard-ctrl.ts","webpack:///./designer/editor/components/editor-flexbox.ts","webpack:///../app-builder/common/model/databearer/components/json-composite-component.model.ts","webpack:///./designer/editor/services/insert-component-service.ts","webpack:///../app-builder/common/constants/standard-boundaries.constant.ts","webpack:///../app-builder/common/enums/http-accept-enum.ts","webpack:///../app-builder/common/model/dataservice/meta-data.model.ts","webpack:///../app-builder/common/model/databearer/components/json-lookup.model.ts","webpack:///./components/chart/chart.ts","webpack:///../app-builder/common/model/databearer/components/json-chart.model.ts","webpack:///./components/radiobutton/radiobutton.ts","webpack:///./components/services/ion-api-service.ts","webpack:///./common/model/component/tabs.model.ts","webpack:///./runtime/runtime-service.ts","webpack:///./common/services/conflict-resolution-service.ts","webpack:///../app-builder/common/model/databearer/json-tag.model.ts","webpack:///./common/dialogs/test-dataservice/test-dataservice-dialog.html","webpack:///./designer/repository/repository-helper.ts","webpack:///./designer/editor/services/binding-management-service.ts","webpack:///./designer/editor/services/boundary-management-service.ts","webpack:///./designer/editor/services/save-service.ts","webpack:///./designer/editor/component-settings/flexbox/flexbox-settings.ts","webpack:///../app-builder/components/interaction/interaction-parameter.ts","webpack:///../app-builder/common/model/interaction/interaction.model.ts","webpack:///../app-builder/common/model/interaction/available-target-field.model.ts","webpack:///../app-builder/common/model/questions/questions.enum.ts","webpack:///./components/dropdown/dropdown.ts","webpack:///./components/hyperlink/hyperlink.ts","webpack:///./components/image/image.ts","webpack:///./components/label/label.ts","webpack:///../app-builder/common/constants/colors.constant.ts","webpack:///./components/textbox/textbox.ts","webpack:///./common/services/hash-service.ts","webpack:///./common/services/theme-service.ts","webpack:///./common/project/datasource/datasource.ts","webpack:///./common/model/component/radiobutton.model.ts","webpack:///./common/services/tag-service.ts","webpack:///../app-builder/common/project/project-info.ts","webpack:///./designer/repository/datasource/datasource-tab-ctrl.ts","webpack:///./designer/repository/repository-tab-ctrl.ts","webpack:///./common/dialogs/import/import-dialog.html","webpack:///./designer/repository/datasource/create-from-wizard/select-source-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/datasource-wizard-description.html","webpack:///./designer/repository/datasource/search/local-ido/operation-details-ctrl.ts","webpack:///./designer/editor/component-settings/chart/chart-settings.ts","webpack:///./designer/editor/components/editor-chart.ts","webpack:///./designer/editor/component-settings/expression-dialog/expression-dialog.html","webpack:///./designer/editor/components/editor-application-parent.ts","webpack:///./designer/editor/components/editor-radiobutton.ts","webpack:///./designer/editor/component-settings/tabs/tab-panel-settings.ts","webpack:///./designer/editor/components/editor-layout-component.ts","webpack:///./designer/editor/components/editor-tabs.ts","webpack:///./designer/editor/services/composite-component-management-service.ts","webpack:///./designer/editor/services/hotkey-service.ts","webpack:///./designer/dashboard/import-dialog/id-conflict-dialog.ts","webpack:///../app-builder/components/base/layout-component.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src lazy namespace object","webpack:///./app.ts","webpack:///../app-builder/app.states.ts","webpack:///../app-builder/app-launcher/app-launcher-hybrid.component.ts","webpack:///../app-builder/app-launcher/app-launcher.base.ts","webpack:///../app-builder/common/project/manifest/runtime-manifest.ts","webpack:///../app-builder/components/services/component.service.ts","webpack:///../app-builder/components/services/data-service.service.ts","webpack:///../app-builder/common/model/interaction/interaction-parameter.model.ts","webpack:///../app-builder/common/model/components/custom-component-definition.model.ts","webpack:///../app-builder/common/project/manifest/file-metadata.ts","webpack:///../app-builder/common/model/project/mashup/designer-manifest.model.ts","webpack:///./components/button/button.ts","webpack:///./components/checkbox/checkbox.ts","webpack:///./components/datepicker/datepicker.ts","webpack:///./components/textarea/textarea.ts","webpack:///../app-builder/common/model/databearer/components/json-textbox.model.ts","webpack:///./components/timepicker/timepicker.ts","webpack:///../app-builder/common/model/ion-api/ion-api.model.ts","webpack:///./common/project/datasource/generic2.ts","webpack:///./common/services/expression-service.ts","webpack:///./common/services/mingle-service.ts","webpack:///./components/module.ts","webpack:///./common/dialogs/export/export-dialog.ts","webpack:///../app-builder/common/enums/infor-owned.enum.ts","webpack:///./common/sohoxi/component/listview-directive.ts","webpack:///./components/services/ion-metadata-service.ts","webpack:///./components/children-directive.ts","webpack:///./designer/helper.ts","webpack:///./designer/repository/datasource/dialog/datasource-upsert-dialog.html","webpack:///./designer/repository/datasource/create-from-wizard/select-source.html","webpack:///./designer/repository/datasource/search/ion-api/ion-api-search-wizard-ctrl.ts","webpack:///./designer/repository/datasource/search/base-search-ctrl.ts","webpack:///./designer/repository/datasource/search/ion-api/ion-api-operation-details-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/datasource-wizard-helper.ts","webpack:///./designer/repository/ido/create/ido-wizard-ctrl.ts","webpack:///./designer/defines.ts","webpack:///./designer/images/createPage/02-thumb.png","webpack:///./designer/editor/component-settings/chart/chart-settings-dialog.ts","webpack:///./designer/editor/component-settings/upsert-datagrid-columns-content-settings.ts","webpack:///./designer/editor/component-settings/flexbox/flexbox-content-settings.ts","webpack:///./designer/editor/component-settings/list/list-settings.ts","webpack:///./designer/editor/component-settings/radiobutton/edit-radiobutton-dialog.ts","webpack:///./designer/editor/component-settings/textbox/textbox-settings.ts","webpack:///./designer/editor/components/editor-textbox.ts","webpack:///./designer/editor/canvas/standard-boundaries-dialog.ts","webpack:///./designer/editor/component-settings/settings.ts","webpack:///./designer/editor/component-settings/valuesource-settings/edit-binding-dialog.ts","webpack:///./designer/editor/component-settings/interaction/interaction-settings.ts","webpack:///./designer/editor/component-settings/build-link-dialog/build-link-dialog.html","webpack:///./designer/editor/component-settings/expression-dialog/expression-dialog.ts","webpack:///./designer/editor/component-settings/manage-dialogs/manage-dialog-base.ts","webpack:///../app-builder/components/button/button.metadata.ts","webpack:///../app-builder/components/list/list.metadata.ts","webpack:///../app-builder/components/textbox/textbox.metadata.ts","webpack:///../app-builder/components/button/button.component.ts","webpack:///../app-builder/components/dropdown/dropdown.component.ts","webpack:///../app-builder/components/layout-components/flexbox/flexbox.component.ts","webpack:///../app-builder/components/list/list.component.ts","webpack:///../app-builder/components/lookup/lookup.component.ts","webpack:///../app-builder/components/textbox/textbox.component.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/polyfill.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/etc-assets/assets.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/etc-assets/UserControl.js","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/etc-assets/infor-companyon-client.js","webpack:///../main.ts","webpack:///../app-builder/common/constants/state-names.constant.ts","webpack:///../app-builder/common/project/data-service/generic.ts","webpack:///../app-builder/common/project/data-service/base-data-service.ts","webpack:///../app-builder/common/model/databearer/components/json-custom-component-def.model.ts","webpack:///./components/button/button.html","webpack:///./components/chart/chart.html","webpack:///./components/checkbox/checkbox.html","webpack:///./common/sohoxi/locale-helper.ts","webpack:///./components/datagrid/datagrid-export-dialog.html","webpack:///./components/datagrid/datagrid.html","webpack:///./components/datepicker/datepicker.html","webpack:///./components/dropdown/dropdown.html","webpack:///./components/flexbox/flexbox.html","webpack:///./components/hyperlink/hyperlink.html","webpack:///./components/image/image.html","webpack:///./components/label/label.html","webpack:///./components/list/list.html","webpack:///./components/lookup/lookup.html","webpack:///./components/radiobutton/radiobutton.html","webpack:///./components/tabs/tabs.html","webpack:///./components/tabs/tab-panel.html","webpack:///./components/textarea/textarea.html","webpack:///./components/textbox/textbox.html","webpack:///./components/timepicker/timepicker.html","webpack:///./common/interface/itabs-component.ts","webpack:///./common/services/http-utils.ts","webpack:///./common/project/datasource/inline-list.ts","webpack:///./common/project/datasource/local-ido.ts","webpack:///./common/project/datasource/mongoose.ts","webpack:///./designer/editor/component-settings/valuesource-settings/translation-dialog.html","webpack:///./common/dialogs/add-string/add-string.html","webpack:///../app-builder/app-launcher/runtime-canvas/runtime.service.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/ids-assets/module.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/ids-assets/svg/ids-svg.component.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/ids-assets/svg/eir-svg.html","webpack:///./designer/module.ts","webpack:///./common/module.ts","webpack:///./common/filters.ts","webpack:///./common/dialogs/add-string/add-string.ts","webpack:///./common/dialogs/import-conflict/conflict-decision-dialog.ts","webpack:///./common/dialogs/import-conflict/conflict-decision-dialog.html","webpack:///./common/dialogs/import-error/import-error-dialog.ts","webpack:///./common/dialogs/import/import-dialog.ts","webpack:///./common/dialogs/licenses/licenses-button.ts","webpack:///./common/dialogs/licenses/licenses-dialog.ts","webpack:///./components/datagrid/datagrid-export-dialog-ctrl.ts","webpack:///./common/after-repeat-directive.ts","webpack:///./common/drag-directive.ts","webpack:///./common/helpers/infinite-scroll.ts","webpack:///./common/initialize-directive.ts","webpack:///./common/shared-components/dropdown-field/dropdown-field-component.ts","webpack:///./common/shared-components/dropdown-field/dropdown-template.html","webpack:///./common/shared-components/filter-popupmenu/filter-popupmenu-component.ts","webpack:///./common/shared-components/filter-popupmenu/filter-popupmenu-ctrl.ts","webpack:///./common/shared-components/filter-popupmenu/filter-popupmenu-template.html","webpack:///./common/shared-components/filter-tag-dropdown/filter-tag-component.ts","webpack:///./common/shared-components/filter-tag-dropdown/filter-tag-ctrl.ts","webpack:///./common/shared-components/filter-tag-dropdown/filter-tag-template.html","webpack:///./common/shared-components/filter-toolbar/filter-toolbar.ts","webpack:///./common/shared-components/filter-toolbar/filter-toolbar.html","webpack:///./common/shared-components/input-field/input-field-component.ts","webpack:///./common/shared-components/input-field/input-field-template.html","webpack:///./common/shared-components/paginator/paginator-component.ts","webpack:///./common/shared-components/paginator/paginator-ctrl.ts","webpack:///./common/shared-components/paginator/paginator-template.html","webpack:///./common/shared-components/project-tags/project-tags-component.ts","webpack:///./common/shared-components/project-tags/project-tags-component.html","webpack:///./common/shared-components/sort-popupmenu/sort-popupmenu-component.ts","webpack:///./common/shared-components/sort-popupmenu/sort-popupmenu-ctrl.ts","webpack:///./common/shared-components/sort-popupmenu/sort-popupmenu-template.html","webpack:///./common/shared-components/tag-dropdown/tag-dropdown-component.ts","webpack:///./common/shared-components/tag-dropdown/tag-dropdown-component.html","webpack:///./common/shared-components/textarea-field/textarea-field-component.ts","webpack:///./common/shared-components/textarea-field/textarea-field-ctrl.ts","webpack:///./common/shared-components/textarea-field/textarea-field-template.html","webpack:///./common/sohoxi/component/about-directive.ts","webpack:///./common/sohoxi/component/application-menu-directive.ts","webpack:///./common/sohoxi/component/arrange-directive.ts","webpack:///./common/sohoxi/component/autocomplete-directive.ts","webpack:///./common/sohoxi/component/busy-directive.ts","webpack:///./common/sohoxi/component/button-directive.ts","webpack:///./common/sohoxi/component/colorpicker-directive.ts","webpack:///./common/sohoxi/component/control-directive.ts","webpack:///./common/sohoxi/component/datepicker-directive.ts","webpack:///./common/sohoxi/component/dropdown-directive.ts","webpack:///./common/sohoxi/component/editor-directive.ts","webpack:///./common/sohoxi/component/fileupload-directive.ts","webpack:///./common/sohoxi/component/lookup-directive.ts","webpack:///./common/sohoxi/component/mask-directive.ts","webpack:///./common/sohoxi/component/multiselect-directive.ts","webpack:///./common/sohoxi/component/popover-directive.ts","webpack:///./common/sohoxi/component/popupmenu-directive.ts","webpack:///./common/sohoxi/component/search-field-directive.ts","webpack:///./common/sohoxi/component/slider-directive.ts","webpack:///./common/sohoxi/component/spinbox-directive.ts","webpack:///./common/sohoxi/component/tabs-directive.ts","webpack:///./common/sohoxi/component/textarea-directive.ts","webpack:///./common/sohoxi/component/timepicker-directive.ts","webpack:///./common/sohoxi/component/toolbar-directive.ts","webpack:///./common/sohoxi/component/tooltip-directive.ts","webpack:///./common/sohoxi/component/trackdirty-directive.ts","webpack:///./common/sohoxi/component/validate-directive.ts","webpack:///./components/component-helper.ts","webpack:///./components/component-common.ts","webpack:///./components/component-common.html","webpack:///./components/component-directive.ts","webpack:///./components/titlebar/titlebar.ts","webpack:///./components/titlebar/titlebar.html","webpack:///./designer/designer.ts","webpack:///./designer/dashboard/duplicate-dialog/duplicate-dialog.html","webpack:///./designer/repository/module.ts","webpack:///./designer/repository/repository.ts","webpack:///./designer/repository/repository.html","webpack:///./common/shared-components/base/cacheable-ctrl.ts","webpack:///./designer/repository/datasource/datasource-tab.html","webpack:///./designer/repository/datasource/search/local-ido/search-wizard.html","webpack:///./designer/repository/datasource/search/ion-api/ion-api-search-wizard.html","webpack:///./designer/repository/datasource/create-wizard/datasource-parameter/datasource-parameter-component.ts","webpack:///./designer/editor/wizard/wizard.html","webpack:///./designer/repository/datasource/search/ion-api/ion-api-operation-details.html","webpack:///./designer/repository/datasource/create-wizard/datasource-wizard-inputparameters.html","webpack:///./designer/repository/datasource/create-wizard/datasource-wizard-outputparameters.html","webpack:///./designer/repository/datasource/create-wizard/datasource-wizard-summary.html","webpack:///./designer/repository/datasource/create-wizard/jsonpath-help-dialog/jsonpath-help-dialog.html","webpack:///./designer/repository/datasource/create-wizard/view-json-dialog/view-json-dialog.html","webpack:///./designer/repository/datasource/create-wizard/datasource-parameter/datasource-parameter.html","webpack:///./designer/repository/datasource/create-wizard/jsonpath-help-dialog/jsonpath-help-dialog-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/request-header-editor/dialog/request-editor-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/request-header-editor/request-header-editor-component.ts","webpack:///./designer/repository/datasource/create-wizard/request-header-editor/dialog/request-editor-template.html","webpack:///./designer/repository/datasource/create-wizard/request-header-editor/request-header-component-template.html","webpack:///./designer/repository/datasource/create-wizard/resource-url-editor/edit-url-dialog/edit-url-dialog-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/resource-url-editor/resource-url-editor-component.ts","webpack:///./designer/repository/datasource/create-wizard/resource-url-editor/resource-url-editor-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/resource-url-editor/edit-url-dialog/edit-url-dialog.html","webpack:///./designer/repository/datasource/create-wizard/resource-url-editor/resource-url-editor.html","webpack:///./designer/repository/datasource/create-wizard/view-json-dialog/view-json-dialog-ctrl.ts","webpack:///./designer/repository/datasource/dialog/datasource-upsert-dialog-ctrl.ts","webpack:///./designer/repository/datasource/dialog/swagger-schema-expander.ts","webpack:///./designer/repository/datasource/dialog/swagger-schema-expander.html","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-parameters/dataservice-parameters-component.ts","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-parameters/dataservice-parameters-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-parameters/dataservice-parameters.html","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-summary/dataservice-summary-datagrid-component.ts","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-summary/dataservice-summary-datagrid-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-summary/dataservice-summary-datagrid.html","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-wizard-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-wizard-operation.html","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-parameters/dataservice-wizard-parameters.html","webpack:///./designer/repository/datasource/create-wizard/local-ido/dataservice-summary/dataservice-wizard-summary.html","webpack:///./designer/repository/datasource/search/local-ido/search-wizard-ctrl.ts","webpack:///./designer/repository/datasource/search/local-ido/operation-details.html","webpack:///./designer/repository/composite/composite-tab-ctrl.ts","webpack:///./designer/repository/composite/composite-tab.html","webpack:///./designer/repository/ido/create/ido-wizard-basic.html","webpack:///./designer/repository/ido/create/ido-wizard-properties.html","webpack:///./designer/repository/ido/create/ido-wizard-summary.html","webpack:///./designer/repository/ido/create/preview-dialog/preview-template.html","webpack:///./designer/repository/ido/create/preview-dialog/preview-ctrl.ts","webpack:///./designer/repository/ido/create/property-component/ido-property-component.ts","webpack:///./designer/repository/ido/create/property-component/ido-property-template.html","webpack:///./designer/repository/ido/create/property-datagrid-component/ido-property-datagrid-component.ts","webpack:///./common/shared-components/base-datagrid/base-datagrid-component.ts","webpack:///./common/shared-components/base-datagrid/base-datagrid-template.html","webpack:///./designer/repository/ido/ido-tab-ctrl.ts","webpack:///./designer/repository/ido/create/preview-dialog/table-template.html","webpack:///./designer/repository/ido/ido-tab.html","webpack:///./designer/repository/datasource/create-wizard/inline-list/add-new-column/add-new-column.ts","webpack:///./designer/repository/datasource/create-wizard/inline-list/dataservice-wizard-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/inline-list/inline-list-properties.html","webpack:///./designer/repository/datasource/create-wizard/inline-list/summary-page/dataservice-wizard-summary.html","webpack:///./designer/repository/datasource/create-wizard/inline-list/add-new-column/add-new-column.html","webpack:///./designer/repository/datasource/create-wizard/inline-list/delete-column/delete-column.html","webpack:///./designer/repository/datasource/create-wizard/inline-list/delete-column/delete-column.ts","webpack:///./designer/repository/datasource/create-wizard/inline-list/summary-page/dataservice-wizard-summary-component.ts","webpack:///./designer/repository/datasource/create-wizard/inline-list/summary-page/dataservice-wizard-summary-ctrl.ts","webpack:///./designer/repository/datasource/create-wizard/inline-list/summary-page/dataservice-summary-datagrid.html","webpack:///./runtime/module.ts","webpack:///./runtime/app-launcher.component.ts","webpack:///./runtime/runtime-canvas-directive.ts","webpack:///./runtime/runtime-canvas.html","webpack:///./designer/editor/component-settings/chart/chart-content-settings.ts","webpack:///./designer/images/createPage/01-thumb.png","webpack:///./designer/images/createPage/010-thumb.png","webpack:///./designer/images/createPage/011-thumb.png","webpack:///./designer/images/createPage/012-thumb.png","webpack:///./designer/images/createPage/013-thumb.png","webpack:///./designer/images/createPage/03-thumb.png","webpack:///./designer/images/createPage/04-thumb.png","webpack:///./designer/images/createPage/05-thumb.png","webpack:///./designer/images/createPage/06-thumb.png","webpack:///./designer/images/createPage/07-thumb.png","webpack:///./designer/images/createPage/08-thumb.png","webpack:///./designer/images/createPage/09-thumb.png","webpack:///./designer/editor/url-settings/url-variable-dialog.html","webpack:///./designer/editor/component-settings/chart/chart-content-dialog.html","webpack:///./designer/editor/component-settings/chart/chart-content-settings.html","webpack:///./designer/editor/component-settings/chart/chart-style-settings.ts","webpack:///./designer/editor/component-settings/chart/chart-style-settings.html","webpack:///./designer/editor/component-settings/datagrid/datagrid-settings.ts","webpack:///./designer/editor/component-settings/datagrid/datagrid-content-settings.ts","webpack:///./designer/editor/component-settings/dialog/auto-add-columns-dialog.html","webpack:///./designer/editor/component-settings/dialog/upsert-column.html","webpack:///./designer/editor/component-settings/datagrid/datagrid-content-settings.html","webpack:///./designer/editor/component-settings/flexbox/flexbox-content-settings.html","webpack:///./designer/editor/component-settings/list/list-style-settings.ts","webpack:///./designer/editor/component-settings/list/list-style-settings.html","webpack:///./designer/editor/component-settings/lookup/lookup-settings.ts","webpack:///./designer/editor/component-settings/lookup/lookup-content-settings.ts","webpack:///./designer/editor/component-settings/lookup/lookup-content-settings.html","webpack:///./designer/editor/component-settings/radiobutton/radiobutton-settings.ts","webpack:///./designer/editor/component-settings/radiobutton/radiobutton-content-settings.ts","webpack:///./designer/editor/component-settings/radiobutton/edit-radiobutton-dialog.html","webpack:///./designer/editor/component-settings/radiobutton/radiobutton-content-settings.html","webpack:///./designer/editor/component-settings/tabs/tabs-settings.ts","webpack:///./designer/editor/component-settings/tabs/tabs-content-settings.ts","webpack:///./designer/editor/component-settings/tabs/edit-tab-dialog.html","webpack:///./designer/editor/component-settings/tabs/tabs-content-settings.html","webpack:///./designer/editor/component-settings/textbox/textbox-style-settings.ts","webpack:///./designer/editor/component-settings/textbox/mask-setting-dialog.html","webpack:///./designer/editor/component-settings/textbox/textbox-style-settings.html","webpack:///./designer/editor/component-settings/manage-dialogs/composites-dialog.html","webpack:///./designer/editor/component-settings/interaction/interaction-wizard.html","webpack:///./designer/dashboard/all-projects/dashboard.ts","webpack:///./designer/dashboard/all-projects/dashboard.html","webpack:///./designer/dashboard/duplicate-dialog/duplicate-dialog.ts","webpack:///./designer/dashboard/import-dialog/displayname-conflict-dialog.ts","webpack:///./designer/dashboard/all-projects/all-projects-toolbar/all-projects-toolbar.ts","webpack:///./designer/dashboard/import-dialog/id-conflict-dialog.html","webpack:///./designer/dashboard/import-dialog/displayname-conflict-dialog.html","webpack:///./designer/dashboard/all-projects/all-projects-toolbar/all-projects-toolbar.html","webpack:///./designer/dashboard/all-projects/project-card/project-card.ts","webpack:///./designer/dashboard/all-projects/project-card/project-card.html","webpack:///./designer/dashboard/create-project/create-project.ts","webpack:///./designer/dashboard/create-project/create-project.html","webpack:///./designer/dashboard/create-project/create-toolbar/create-toolbar.ts","webpack:///./designer/dashboard/create-project/create-toolbar/create-toolbar.html","webpack:///./designer/component-value-directive.ts","webpack:///./designer/editor/canvas/canvas.ts","webpack:///./designer/editor/canvas/canvas.html","webpack:///./designer/editor/canvas/canvas-slider.ts","webpack:///./designer/editor/canvas/standard-boundaries-dialog.html","webpack:///./designer/editor/canvas/canvas-slider.html","webpack:///./designer/editor/component-settings/build-link-dialog/url-source-field/url-source-field.ts","webpack:///./designer/editor/component-settings/build-link-dialog/url-source-field/url-source-field.html","webpack:///./designer/editor/editor.ts","webpack:///./designer/editor/editor.html","webpack:///./designer/editor/new-component/component/new-component.ts","webpack:///./designer/editor/new-component/component/new-component.html","webpack:///./designer/editor/new-component/composite/new-composite.ts","webpack:///./designer/editor/new-component/composite/new-composite.html","webpack:///./designer/editor/new-component/new-component-tabs.ts","webpack:///./designer/editor/new-component/new-component-tabs.html","webpack:///./designer/editor/ruler/ruler.ts","webpack:///./designer/editor/ruler/boundary-editor-dialog/boundary-editor-dialog.html","webpack:///./designer/editor/ruler/ruler.html","webpack:///./designer/editor/selection-box/selection-box.ts","webpack:///./designer/editor/selection-box/selection-box.html","webpack:///./designer/editor/statusbar/statusbar.ts","webpack:///./designer/editor/statusbar/statusbar.html","webpack:///./designer/editor/topbar/topbar.ts","webpack:///./designer/editor/topbar/base-modal/base.html","webpack:///./designer/editor/topbar/copy-form/copy-form.html","webpack:///./designer/editor/project-settings/project-settings-dialog.html","webpack:///./designer/editor/topbar/key-dialog/key-dialog.html","webpack:///./designer/editor/topbar/topbar.html","webpack:///./designer/editor/new-component/composite/composite-component-wizard-ctrl.ts","webpack:///./designer/editor/new-component/composite/composite-component-wizard-name.html","webpack:///./designer/editor/new-component/composite/composite-component-wizard-include.html","webpack:///./designer/editor/new-component/composite/composite-component-wizard-summary.html","webpack:///./designer/editor/component-settings/generic-settings.html","webpack:///./designer/editor/component-settings/manage-dialogs/datasources-dialog.html","webpack:///./designer/editor/component-settings/settings.html","webpack:///./designer/editor/component-settings/setting-templates/border-setting.ts","webpack:///./designer/editor/component-settings/setting-templates/border-setting.html","webpack:///./designer/editor/component-settings/setting-templates/checkbox-setting.ts","webpack:///./designer/editor/component-settings/setting-templates/checkbox-setting.html","webpack:///./designer/editor/component-settings/setting-templates/dropdown-setting.ts","webpack:///./designer/editor/component-settings/setting-templates/dropdown-setting.html","webpack:///./designer/editor/component-settings/setting-templates/margin-setting.ts","webpack:///./designer/editor/component-settings/setting-templates/margin-setting.html","webpack:///./designer/editor/component-settings/setting-templates/radiobutton-setting.ts","webpack:///./designer/editor/component-settings/setting-templates/radiobutton-setting.html","webpack:///./designer/editor/component-settings/setting-templates/switch-setting.ts","webpack:///./designer/editor/component-settings/setting-templates/switch-setting.html","webpack:///./designer/editor/component-settings/setting-templates/text-setting.ts","webpack:///./designer/editor/component-settings/setting-templates/text-setting.html","webpack:///./designer/editor/component-settings/attribute-settings.ts","webpack:///./designer/editor/component-settings/attribute-settings.html","webpack:///./designer/editor/component-settings/settings-switchers.ts","webpack:///./designer/editor/component-settings/valuesource-settings/valuesource-settings.ts","webpack:///./designer/editor/component-settings/valuesource-settings/edit-binding-dialog.html","webpack:///./designer/editor/component-settings/valuesource-settings/valuesource-settings.html","webpack:///./designer/editor/component-settings/interaction/interaction-settings.html","webpack:///./designer/editor/component-settings/interaction/interaction-wizard-ctrl.ts","webpack:///./designer/editor/component-settings/interaction/interaction-wizard-source.html","webpack:///./designer/editor/component-settings/interaction/interaction-wizard-target.html","webpack:///./designer/editor/component-settings/interaction/interaction-wizard-datamapping.html","webpack:///./designer/editor/component-settings/interaction/interaction-wizard-summary.html","webpack:///./designer/editor/component-settings/interaction/parameter-handler.ts","webpack:///./designer/editor/component-settings/interaction/parameter-handler.html","webpack:///./common/dev/developer-tool-component.ts","webpack:///./common/dev/developer-tool-ctrl.ts","webpack:///./common/dev/developer-tool-template.html","webpack:///./designer/editor/components/editor-button.ts","webpack:///./designer/editor/components/editor-checkbox.ts","webpack:///./designer/editor/components/editor-datagrid.ts","webpack:///./designer/editor/components/editor-datepicker.ts","webpack:///./designer/editor/components/editor-dropdown.ts","webpack:///../app-builder/common/model/databearer/components/json-dropdown.model.ts","webpack:///./designer/editor/components/editor-hyperlink.ts","webpack:///./designer/editor/components/editor-image.ts","webpack:///./designer/editor/components/editor-label.ts","webpack:///../app-builder/common/model/databearer/components/json-label.model.ts","webpack:///./designer/editor/components/editor-list.ts","webpack:///./designer/editor/components/editor-lookup.ts","webpack:///./designer/editor/components/editor-tabpanel.ts","webpack:///./designer/editor/components/editor-textarea.ts","webpack:///./designer/editor/components/editor-timepicker.ts","webpack:///./designer/editor/component-settings/custom/custom-component-ctrl.ts","webpack:///./designer/editor/component-settings/build-link-dialog/build-link-dialog.ts","webpack:///./designer/editor/component-settings/dialog/auto-add-columns-dialog.ts","webpack:///./designer/editor/component-settings/dialog/upsert-column.ts","webpack:///./designer/editor/component-settings/expression-dialog/edit-expression-dialog/edit-expression-dialog.ts","webpack:///./designer/editor/component-settings/expression-dialog/edit-expression-dialog/edit-expression-dialog.html","webpack:///./designer/editor/component-settings/manage-dialogs/manage-composites-dialog.ts","webpack:///./designer/editor/component-settings/manage-dialogs/manage-repository-dialog/manage-repository-dialog.html","webpack:///./designer/editor/component-settings/manage-dialogs/manage-datasources-dialog.ts","webpack:///./designer/editor/component-settings/manage-dialogs/manage-repository-dialog/manage-repository-dialog.ts","webpack:///./designer/editor/component-settings/tabs/edit-tab-dialog.ts","webpack:///./designer/editor/component-settings/textbox/mask-setting-dialog.ts","webpack:///./designer/editor/component-settings/valuesource-settings/translation-dialog.ts","webpack:///./designer/editor/project-settings/project-settings-dialog.ts","webpack:///./designer/editor/ruler/boundary-editor-dialog/boundary-editor-dialog.ts","webpack:///./designer/editor/topbar/base-modal/base.ts","webpack:///./designer/editor/topbar/base-modal/upsert-question-dialog/upsert-question-dialog.html","webpack:///./designer/editor/topbar/base-modal/upsert-question-dialog/upsert-question-dialog.ts","webpack:///./designer/editor/topbar/copy-form/copy-form.ts","webpack:///./designer/editor/url-settings/url-variable-dialog-ctrl.ts","webpack:///../app-builder/app.module.ts","webpack:///../app-builder/app-launcher/app-launcher.module.ts","webpack:///../app-builder/app-launcher/app-launcher.component.ts","webpack:///../app-builder/app-launcher/runtime-canvas/runtime-canvas.component.ts","webpack:///../app-builder/components/base/application-parent.ts","webpack:///../app-builder/components/components.module.ts","webpack:///../app-builder/common/directives/remove-host.directive.ts","webpack:///../app-builder/components/containers/children-component-container.component.ts","webpack:///../app-builder/components/containers/component-container.component.ts","webpack:///../app-builder/components/dropdown/dropdown.metadata.ts","webpack:///../app-builder/components/layout-components/flexbox/flexbox.metadata.ts","webpack:///../app-builder/components/lookup/lookup.metadata.ts","webpack:///../app-builder/components/titlebar/titlebar.component.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","3","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","p","jsonpArray","window","oldJsonpFunction","slice","CanvasModeEnum","AppStatus","DashboardStates","DashboardViewStates","ReplaceEnum","availableDatasourceTypes","DatasourceTypeEnum","IDM","M3","MONGOOSE","generic","INLINE_LIST","Numbers","ITEM_ID","RECORD_DATE","ROW_POINTER","IdoProperties","BuildEnvTypes","AppEnvTypes","ChartTypeEnum","ProjectLayout","DatagridPageSizesEnum","ColumnFormatterType","HorizontalAlignmentEnum","DirectionEnum","ThemeEnum","FlexSizeTypeEnum","FlexOverflowEnum","WizardFocusEnum","AlignmentEnum","SortEnum","SaveFlagsEnum","SaveProjectSettingEnum","MGPlatform","ION_PROXY","ION_TOKEN","LAUNCH_WITH_ANGULAR","DeveloperConstants","ProjectTypeEnum","APP_ROOT","REST_ROOT","APP_BUILDER_ROOT","APP_BUILDER_REST_ROOT","APP_RUNTIME_ROOT","APP_RUNTIME_REST_ROOT","ION_API_ROOT","ION_API_URL","ION_API_TOKEN","localStorage","getItem","ION_API_PROXY_PORT","TENANT_ID","IS_DEV","IS_BASE_BUILDER","IS_FIRST_LOAD","IS_CONFIG_LOADED","MAX_PROJECTS","MAX_DATASOURCES","MAX_COMPOSITES","MAX_APPS","RUN_PATH","RUN_ROOT","Config","RUN_RUNTIME_ROOT","MG_FORM_NAME","MG_FORM_ONLY","MG_PLATFORM","MG_CONFIG_NAME","MG_HELP_BASE_URL","PROJECT","ADMINISTRATION","RUNTIME","SETTINGS","SWITCHABLE_FEATURES","REPOSITORY","COMPOSITE_COMPONENTS","DATASOURCES","IDO","LOCAL_IDO","DESIGNER","ADMIN","ServerPaths","AppTypeEnum","SOURCE","TARGET","SettingTypes","STATIC","CONTEXT","URL","BindingTypes","CLICK","DRAGEND","DRAGLEAVE","DRAGOVER","DRAGSTART","DROP","KEYDOWN","KEYUP","MOUSEUP","EventTypes","DISPLAY","POINTER_EVENTS","CURSOR","BACKGROUND_COLOR","CssConstantKeys","CURSOR_NODROP","CURSOR_POINTER","AUTO","NONE","INLINE_BLOCK","CssConstantValues","EQUALS","NOT_EQUALS","GREATER","SAME_GREATER","LOWER","SAME_LOWER","INCLUDES","Operators","ALL","DISABLE","HIDE","ConditionType","MOVE","COPY","InsertEventTypes","SMALL","LARGE","ComponentSizeTypes","COPY_SUFFIX","ComponentConstants","HORIZONTAL","VERTICAL","PAGE","OrientationTypes","CONTENT","INTERACTION","STYLE","SidebarTabTypes","CHECKBOX","DROPDOWN","MARGIN","BORDER","NUMBER","RADIO","SWITCH","TEXT","COLOR_PICKER","SettingInputKeys","ADMINISTRATION_SERVICE","APP_ENV_CONSTANT","BINDING_MANAGEMENT_SERVICE","BOUNDARY_MANAGEMENT_SERVICE","BUILD_ENV_CONSTANT","COMMON_SERVICE","COMPOSITE_COMPONENT_MANAGEMENT_SERVICE","CONFLICT_RESOLUTION_SERVICE","DATASOURCE_SERVICE","DESIGNER_COMPONENT_SERVICE","DESIGNER_SERVICE","DIALOG_SERVICE","EDITOR_SERVICE","EXPRESSION_SERVICE","FEATURE_SWITCH_SERVICE","FRAMEWORK_SERVICE","HASH_SERVICE","HOTKEY_SERVICE","HTTP_SERVICE","HUB_SERVICE","INSERT_COMPONENT_SERVICE","INTERACTION_MANAGEMENT_SERVICE","ION_API_SERVICE","ION_METADATA_SERVICE","LANGUAGE_SERVICE","LOCAL_IDO_SERVICE","MINGLE_SERVICE","NO_CACHE_INTERCEPTOR","PROJECT_SERVICE","REPOSITORY_SERVICE","RUNTIME_SERVICE","SAVE_SERVICE","TAG_SERVICE","THEME_SERVICE","TRANSLATION_MANAGEMENT_SERVICE","UNDO_SERVICE","InjectNames","ROOT_COMPONENT","DATASOURCE","CUSTOM_COMPONENT","TRANSLATIONS","ProjectFileKeys","InteractionActionEnum","InteractionTriggerEnum","COMPONENT","MimeTypes","DETAIL_RESULT","LIST_RESULT","ContextKeys","DirectionType","FeatureIdEnum","DEFAULT_BOUNDARY","id","displayName","HEIGHT","VISIBILITY","WIDTH","SHOW_ERROR","SIZE","SIZE_TYPE","ORIENTATION","ALIGNMENT_HORIZONTAL","ALIGNMENT_VERTICAL","OVERFLOW","ITEM_TEMPLATE","KEEP_SELECTED","SEARCH","CHART_VIEW","CHART_TYPE","CHART_LEGEND_DISPLAY","CHART_STARTUP_ANIMATION_ENABLE","CHART_TITLE","CHART_AXIS_CATEGORY_TITLE","CHART_AXIS_CATEGORY_UNITS","CHART_AXIS_VALUES_TITLE","CHART_AXIS_VALUES_UNITS","LOOKUP_OUTPUT_ID","IS_RESIZABLE","MAX_LENGTH","ROW_HEIGHT","USE_PAGING","PAGE_SIZE","SUMMARY_ROW","ROW_COUNT","FILTER_BAR","ENABLE_EXPORT","ROW_COUNT_OUTPUT","SUMMARY_OUTPUT","DATE_FORMAT_SHOW","DATE_FORMAT_BINDING","DATE_FORMAT_INPUT","DATE_FORMATTED","DATE_VALUE","DATE_TODAY","BOX_WIDTH","TIME_FORMAT","ENABLE_SECONDS","TIME_VALUE","LANGUAGE","LANGUAGE_SHORT","USER_NAME","USER_DESCRIPTION","TIMESTAMP","APPLICATION_HEADER","BORDER_COLOR","CHECK_STATE","COLOR","CURRENT_ITEM","CURRENT_ITEM_NAME","CURRENT_ITEM_VALUE","DISPLAY_VALUE","DIRECTION","FONT_STYLE","FONT_CHAR","IS_DEFAULT","IS_DRILLBACK","IS_LIST","IS_READONLY","LABEL","LINK_VALUE","MULTI_SELECT","PLACEHOLDER","POSITION","SELECTED_ITEM","DIRTY_ITEMS","SHOW_LABEL","TOOLTIP","SettingKeys","FORMAT_1","FORMAT_2","FORMAT_3","FORMAT_4","ISO8601","AUTOMATIC","RAW","DateFormat","SUPPORTED_LANGUAGES","DEFAULT","LanguageConsts","ONE","FIVE","TEN","FIFTEEN","MinInterval","TWELVE","TWENTYFOUR","HourMode","PRIMARY","SECONDARY","TERTIARY","FILL","ButtonStyle","VALUE","SubstitutionTags","TARGET_CONTEXT","STATIC_VALUE","URL_VALUE","ValueObject","CLEAR","GET","LIST","ON_LOAD","ON_ITEM_CHANGED","CURRENT_ITEM_CHANGED","ON_ITEM_UPDATED","CURRENT_ITEM_UPDATED","ON_STARTUP","STARTUP","ON_CLOSE","CLOSE","ON_CLICK","ON_CHANGED","CHANGED","IS_CHECKED","CHECKED","IS_UNCHECKED","UNCHECKED","SET_CURRENT_ITEM","InteractionPairOperation","SHORT","MEDIUM","TALL","RowHeight","DATE_TIME","STRING","PASSWORD","MaskProcess","ImagePositions","MarginType","BorderType","ImageBase64","ListTemplateIdEnum","this","maxDatasource","maxCompositeComponent","errorMessage","item","importErrorMessage","MAX_BOUNDARIES","ProjectLimit","CONTACT_SYSTEM_ADMIN","GENERIC_ERROR","UNABLE_TO_UNZIP_ERROR","GENERIC_ID_ERROR","PROJECT_ID_CONFLICT","PROJECT_DISPLAYNAME_CONFLICT","PROJECT_IMPORT_ERROR","DATA_SERVICE_ERROR","Subcodes","success","StatusCodes","DATA_SERVICE","COMPOSITE_COMPONENT","FileExtensions","CSSClasses","ElementDataKeys","EDITOR_COMPONENT_PREFIX","ComponentClassNames","SHOW_OPEN_FILE_DIALOG","SHOW_SAVE_FILE_DIALOG","TOKEN","APPBUILDER_REST","ABFormScriptMethod","GLOBALSTRING","EMAIL","SPECIAL_CHARACTERS","NUMERIC","NO_NUMERIC","NUMERIC_NO_NEGATIVE","NEW_LINES","STARTS_WITH_NUMBER","NO_SPECIAL","TIME","FIRST_CHAR_LETTER","RegexStrings","GridAggregators","SummaryTextPlacement","TextAlignment","EXCEL","CSV","DatagridExportTypes","file","boolean","date","decimal","integer","string","IdoDataType","Chart","Datagrid","Dropdown","Flexbox","List","Lookup","RadioButton","Tabs","TabPanel","TextBox","ComponentNames","CACHE_FACTORY","COMPILE","CONTROLLER","DESTROY","ELEMENT","FILTER","HTTP","INTERVAL","Q","ROOT_SCOPE","ROUTE","SCOPE","STATE_PARAMS","STATE_SERVICE","TEMPLATE_CACHE","TIMEOUT","WINDOW","AngularConstants","StandardDialogButtons","DialogButtonType","removePopupMenus","element","popupMenus","find","$","close","destroy","random","stringLength","chars","randomstring","rnum","Math","floor","substring","Util","$rootScope","$compile","$q","show","options","deferred","defer","title","dialogOptions","dialog","Dialog","modalScope","scope","$new","parameter","eirDialog","contentTemplate","template","url","templateUrl","style","cssClass","draggable","append","compiledTemplate","css","hasHideOverlayOption","toggleOverlay","buttons","setSpecificButtons","unsubscribe","$on","createAndOpenModal","promise","Helper","isIE","setTimeout","each","idx","elem","setAttribute","getAttribute","modal","init","one","$destroy","hideOverlay","showContextualActionPanel","contextualactionpanel","content","trigger","text","icon","showMessage","standardButtons","Ok","setDefaultButtons","undefined","hasPrimaryButton","message","isChildDialog","finally","showError","isError","status","audibleLabel","showYesNo","YesNo","toggleClass","showToast","position","timeout","defaults","OkCancel","YesNoCancel","click","resolve","button","Cancel","isDefault","No","Yes","specificButtons","forEach","index","type","add","ngModule","service","DialogService","$inject","canClose","modalParent","parent","modalGrandParent","hasClass","remove","closeOnEscape","$event","keyCode","KeyCodeEnum","ESCAPE","on","off","closing","e","cancel","closed","opened","attr","generateUniqueId","getPromise","hide","RegExpMatchCandidate","getFormattedDate","format","Date","year","getFullYear","formattedMonth","getMonth","toString","padStart","formattedDay","getDate","formattedHour","getHours","formattedMinute","getMinutes","formattedSecond","getSeconds","formattedMilleSecond","getMilliseconds","become","obj","newClass","__proto__","getDeepValue","paths","path","split","len","isUndefinedOrNull","setDeepValue","newValue","secondToLast","stringReplace","str","context","replace","match","$1","$2","trimmed","exec","getStringParameters","map","hit","isUndefined","anyObject","isFloat","isInt","Number","isUndefinedEmpty","getListByRegex","regex","myString","cleanedString","createQueryParameters","values","join","deepObjectTrim","objectToTrim","deepTrim","keys","trim","getListFromMap","list","arrayList","concat","sortObjectByProperty","reverse","output","sort","a","b","sortObjectKeys","unordered","doNotSortKey","ordered","sortedKeys","indexOf","unshift","objectHasValue","some","objectHasKey","exceedAllowed","limit","listA","listB","numberOfNewDatasource","wrapKeyInBrackets","wrapInBrackets","sanitizedSourceKey","cleanNulls","propName","cleanTemplateLiteral","templateLiteral","htmlEncode","html","htmlDecode","isMobile","test","navigator","userAgent","getTime","MILLION","generateNewDisplayName","oldDisplayName","conflictingCandidates","newDisplayName","splitCopyNumber","oldDisplayNameBase","numbers","filter","maybeString","conflictCandidate","matches","candidateBaseName","BASE_NAME","candidateIsCopy","Boolean","IS_COPY","candidateNumber","parseInt","pop","getListNames","items","itemNames","getProposedNewDisplayName","projectName","projects","exceptID","proposedName","recursiveInnerFunction","counter","manifest","joinWithDefauldEmptyString","stringArray","joinChar","appIsReadyForSelenium","mashupRootContainer","isMashupReady","parseQueryString","query","rPlus","rQueryParameter","decode","uriEncodedText","decodeURIComponent","urlParams","trimIfPossible","isSafari","myWindow","isChrome","chrome","webstore","HTMLElement","webkitAudioContext","isEdge","document","documentMode","convertBase64ToSaveableBlob","base64String","byteString","atob","arrayBuffer","ArrayBuffer","ia","Uint8Array","charCodeAt","SmartBlob","getBase64FileExtension","toUpperCase","parseBase64","isDifferent","array1","array2","compare","x","y","removeItemFromListByIndex","instanceOfLayoutComponent","instanceOfListComponent","isFirstCharLetter","blobParts","smartBlob","Blob","saveAs","fileName","msSaveOrOpenBlob","createObjectURL","createElement","href","download","body","appendChild","removeChild","revokeObjectURL","EDITOR","ViewEnum","DASHBOARD","saveService","designerService","frameworkService","bindingManagementService","undoService","dialogService","translationChangedEvent","InstanceEvent","projectBoundariesChangedEvent","finderComponentSelectedEvent","canvasModeChangedEvent","sidebarViewChangedEvent","sidebarChangedEvent","currentSidebarTab","selectedComponentChangedEvent","selectedInteractionChangedEvent","selectedDatasourceChangedEvent","refreshSettingEvent","currentFlexOrientationChangedEvent","currentFlexIsParentChangedEvent","triggerSourceComponentChangedEvent","targetActionComponentChangedEvent","wizardFocusComponentChangedEvent","finderModeChangedEvent","wizardSetFinderModeEvent","wizardCloseEvent","wizardTickChangedEvent","newWizardInteractionEvent","isWizardChangedEvent","setSourceTriggerEvent","setTargetActionEvent","removeSelectedInteractionEvent","cancelInsertEvent","compositeComponentsChangedEvent","toggleCanvasChangedEvent","projectSettingsChangedEvent","hyperlinkAliasChangedEvent","urlVariableChangedEvent","sidebarView","SidebarViewEnum","NEW_COMPONENT","isSidebarVisible","idCounter","currentBoundaryChangedEvent","currentCanvasThemeChangedEvent","boundary","selectedComponent","getTypedef","currentOrientation","getBoundarySetting","raise","setSidebarVisibility","component","setSidebarView","setCanvasTheme","defaultTheme","LIGHT","loadProject","projectId","canvasWidth","then","project","ids","forEachComponent","rootComponent","ComponentsHelper","nextNumber","console","warn","setView","setCurrentSidebarTab","tabView","getCurrentSidebarTab","unloadProject","updateCurrentBoundary","clearIdCounter","generateId","componentTypeName","newId","components","getAllComponents","getId","setTriggerSourceComponent","setTargetActionComponent","setFinderActivity","setSourceTrigger","sourceTrigger","setTargetAction","targetAction","setWizardFocusComponent","focus","setting","focusSettings","deselectComponent","setSelectedComponent","isRuntimeMode","getCanvasMode","saveCanvas","getCurrentProject","addUndoStack","save","CANVAS_COMPONENTS","pushUndoAction","saveCurrent","flags","WIZARD","getNewDeferred","INTERACTIONS","refreshLatestUndoStack","renameProject","view","raiseSidebarViewChanged","getSidebarView","copy","setHoveredComponent","setIsSelected","refreshMetaSettings","getSelectedComponent","setFinderComponent","finderComponent","setIsFinder","canvasMode","FINDER","canCut","canCopy","isMovable","ApplicationParent","isGenerated","selectFinderComponent","finderModeOptions","closeOnSelect","setCanvasMode","SELECTION","hoveredComponent","setIsHovered","startFinderMode","previousMode","extend","hideCancel","unsubscribeFinderComponent","reject","unsubscribeCanvasMode","getFinderModeOptions","removeFinderComponent","newCanvasMode","canvasModeChanged","isSelectionMode","isFinderMode","isWizardMode","triggerDatasourceChanged","datasource","getCurrentBoundary","setCurrentBoundary","getCurrentRootComponentInstance","setCurrentRootComponentInstance","setManifest","getCurrentCanvasTheme","getCanvasTheme","getApplicationParent","filterFn","componentList","forEachChild","child","openURLDialog","setUrlVariables","URL_VARIABLES","initializeUrlBindings","sourceKey","hasUrlBinding","forEachBindable","bindable","field","getBindableField","ref","Type","BindingTypeEnum","URL_BINDING","initializeBindings","getAllInteractiveComponents","generatedIdsIterated","componentClass","Defines","allComponents","class","getDatasource","SOURCE_TRIGGERS","TARGET_ACTIONS","getAllBindableComponents","exposesReadableBindables","getAllTranslatableComponents","exposesLocalizedBindables","componentObject","oldToNewIdMap","suffix","copiedComponent","typedef","generateNewIdsForTree","applicationParentDatabearer","getNewDisplayName","redirectBindings","syncComponentTranslations","bindableField","currValueSource","getTranslatableStringByProperty","updatedTranslation","locale","getSelectedLocale","setTranslatableStringByProperty","newComponent","currentValueSource","BINDING","sourceName","getNameBase","strLength","lastIndexOf","substr","copyRegexExpression","copyRegex","RegExp","replaceSuffixRegex","nameBase","conflictingNames","componentNameBase","getDisplayName","nextHighestNumber","parentComponent","oldId","componentRadioButtons","radioButton","oldRadioButtonId","listComponent","boundaryId","boundarySettings","itemTemplate","componentTabs","componentTab","columns","column","updateClassesAndSizes","newBoundaryEntered","setDefaultBindings","availOutput","getComponentInstanceById","getComponentInstance","onAllPromises","promises","all","fn","getDatasourceObject","updateDatasourceOnComponents","datasourceObject","setDatasource","getTranslationsFromComponentTree","languageComponents","componentChild","componentTranslations","getTranslation","findInComponentTree","predicate","foundChild","copyTranslationsToCurrentProject","newComponentTree","componentTranslation","copyTranslationByMapList","addTranslation","idMap","componentId","bindableRefs","createLanguageComponentFromOldComponents","theme","updateTranslatables","syncTranslations","newTranslations","currentProject","newTranslationList","addTranslations","getTranslationsList","removeTranslations","translation","removeTranslation","projectLanguageComponent","translations","undoTranslation","projectTranslations","readValueSource","valueSource","getUrlMetaData","setUrlMetaData","newUrlMetaData","variables","generateUrlMetaData","getUrlValue","removeCacheObject","getTimeout","getActiveUrlBindings","urlBindings","EditorService","ValueTypeEnum","$window","$timeout","$cacheFactoryService","commonService","datasourceService","languageService","translationManagementService","mingleService","expressionService","datasourceChangedEvent","activeBindings","newBoundary","openComponentDialog","currentManifest","getManifest","createGeneralLanguageComponent","componentInstance","binding","valueType","LOCALIZED_STRING","tab","radioButtons","radiobutton","datagridOptions","openWindow","open","getCurrentLanguage","updatedValue","sendDrillbackMessage","getGlobalValue","stringValue","cleanedValue","globalValue","getGlobalString","openNewStringDialog","addGlobalString","getTranslatableHeaderString","currentValue","getProjectCacheObject","cacheId","getCacheObject","cacheObject","checkIfListTemplate","BINDABLE_FIELDS_2","isLayoutComponent","children","getNextProjectBoundary","projectBoundaries","mashupBoundaries","limitX","triggerExpressions","getAllComponentInstances","isDesigner","getTranslatableFieldDisplayName","reference","findIndex","getBindableDisplayName","includes","getDatabearer","bindables","maybeDefinition","bindableDefinition","fromRoot","recursive","getComponentInstances","attrName","attrValue","getCustomComponentDefinition","customId","getCustomComponentDefinitions","container","datasourceId","datasourceInstance","parseDatasourceToTS","readParameters","parameters","multipleValue","targetKey","setParameter","sourceComponent","applyValuesourceFormatter","getValue","error","CONTEXT_BINDING","getActiveBinding","registerContextBinding","targetComponent","targetComponentScope","getScope","targetComponentId","generatedId","getContextBindingId","$watch","setBindableValue","getBindingId","valueSourceObject","registerBinding","valuesourceObject","sourceComponentId","sourceComponentKey","sourcePath","watchKey","onUpdateValue","source","triggerName","getInteractions","interaction","sourceTriggerName","runInteraction","targetName","targetActionName","loadInteraction","runStartupInteractions","ev","convertImageUrlToBase64","FrameworkService","SizeTypeEnum","SelectableEnum","FormatterEnum","ColumnOptionEnum","DateFormatEnum","OrientationEnum","databearer","$element","isVisible","isShowError","usedBy","isReadonly","updateClassesAndStyle","setGenerated","createCacheObject","canDelete","is","classs","calcNewSizes","calcNewWidth","calcNewHeight","margin","cssWidth","calcNewSize","left","right","cssHeight","top","bottom","sizeObject","orientation","retSize","hasIndividualChildSizes","sizeType","PERCENT","pxPerPercentComponent","getPxPerPercentComponent","HUNDRED","PIXELS","setBoundarySettingIfChanged","settingId","noTraverse","componentBoundarySettings","getBindableValue","bindableReference","isTranslatableComponent","Image","updateClasses","removeClass","cssClasses","getClassList","addClass","updateInlineStyle","getInlineStyle","updateVisibility","updateShowError","classList","width","height","getGeneratingParent","getContext","resetLayout","setErrorTooltip","stopLoading","errorTooltip","startLoading","isLoading","dataserviceAction","isDataserviceAction","getParameters","getListData","listResult","ListResult","catch","errResponse","resetContext","getDetailData","detailData","setDetailResultForGetAction","updateItemID","detailResult","DetailResult","refreshBindings","errorResponse","detail","runComponentAction","buildLink","link","sources","renderedLink","valuesource","alias","isBinding","isContextBinding","oldValue","generic2Databearer","method","HttpVerbEnum","PUT","itemIdParameter","inputParameters","interactionParameter","getParameter","write","currentStringValue","getComponentTranslation","databearer2","localContext","isOutputFile","outputParameters","clear","translationValue","forEachParent","getPredictedSize","sizePredicter","sizes","appendTo","clone","outerHeight","forEachFieldSetting","SETTING_FIELDS","doGenerated","cache","settings","boundarySetting","inputType","defaultValue","tooltip","Component","getData","Utils","code","stack","ErrorResponse","InteractionDefines","$scope","editorService","interactionManagementService","insertComponentService","isDraggable","selectionBox","prepend","controller","EditorComponentCtrl","exposesBindables","read","onClick","onDragenter","dragEnterCounter","onMouseOver","onDragleave","onMouseLeave","onDragover","onMouseMove","onDragstart","onDrop","resizableHeight","resizableWidth","setIsInsertChild","setIsInsertParent","setIsWizardFocus","wizardFocusType","UNFOCUSED","getBindingMetaData","getContextMetaData","getLocalContextMetaData","getParameterMetadata","getFieldSettings","getSourceTriggers","getTargetActions","getDefaultAction","getDefaultTrigger","detach","setProperty","removeDatasource","setSetting","setBoundarySetting","getSettingCategories","getCurrentComponentFieldSettings","openDialog","getInsertComponent","isInsertChild","settingKey","option","settingMeta","newSettingValue","settingReference","generatingParent","generatingList","currentTemplate","subComponent","currentBoundaryId","setBoundarySettingOnDatabearer","refresh","detachChild","settingValue","event","isSelected","stopPropagation","EditorHelper","getUnderlyingComponent","INSERT","dragstartTimer","finishInsert","setInsertParent","getSelection","removeAllRanges","originalEvent","dataTransfer","effectAllowed","startInserting","newParent","insert","insertIteration","heightType","resizableChildren","widthType","isFinder","isHovered","isInsertParent","isWizardFocusEnum","propertyName","newDatasource","usedByComponent","refreshGeneratedComponents","getMetaData","clearData","showDialog","action","metaData","inputFields","inputField","isMandatory","MAND","visibleName","FLDS","FLNM","Meta","meta","version","sourceKeyShort","outputFields","outputField","promiseList","availableSourceField","parentMeta","metadata","val","exists","contextField","maxLength","TWENTY","truncate","availableBindings","hasBindableFields","availableSourceFields","bindableFieldDefinition","OBJECT","objectMetaData","currentItemMetaData","fldsName","currentVisibleName","fieldRef","onSuccess","DEFAULT_ACTION","DEFAULT_TRIGGER","directive","restrict","controllerAs","EditorComponentDirective","unsubscribers","onComponentChanged","onBoundaryChanged","currentBoundary","onChangeSetting","onIconClick","settingsRef","MANIFEST","readSettingValue","SettingsBase","setDataServiceHeader","headers","Accept","HttpAcceptEnum","APPLICATION_JSON","tryUpdateUrlName","urlName","newUrlName","tryGetMask","mask","process","getShowLabel","defaultBoundary","showLabel","tryGetBoxWidth","tryUpdateButtonStyle","getHref","rowData","hyperlinkOptions","tryConvertLegacyChart","isLegacyChart","isLegacyChartType","chartType","newType","StackedColumn","ColumnStacked","Profile","StackedLine","Line","Bar","hasLegacyChartData","convertToNewChartFormat","legendDisplay","startupAnimationEnable","categories","category","newDataset","series","datasets","BackwardCompatible","STATIC_VALUE_OBJECT","isComponent","TARGET_CONTEXT_OBJECT","URL_VALUE_OBJECT","SourceComponent","settingsComponentsList","settingsClass","ChartSettingsCtrl","DatagridSettings","FlexboxSettings","ListSettings","LookupSettings","RadioButtonSettings","TabsSettings","TabPanelSettings","TextboxSettings","BOTH","instantiateComponent","parentInstance","instance","Error","getComponentDisplayName","className","clazz","isApplicationParent","names","highestNumber","lastNumberMatch","suffixNumber","sortComponentList","naturalCompare","ax","bx","_","Infinity","an","bn","nn","localeCompare","isBase64","base64Str","prefix","occupiedStrings","possibleConflict","findItemIndexById","listResults","itemId","incrementIndex","previousItem","newItem","newIndex","params","getDefaultComponentSettingValue","settingCategories","componentFieldSetting","componentCategory","maxlength","httpService","themeService","onDuplicateProjectChangedEvent","urlMetaData","loadProjects","executeGet","loadActivatedApps","loadPublishedProject","getLanguage","loadPublishedProjectNoConstraints","cleanOldDataservices","datasources","info","loadEnvironmentSettings","loadDBVersions","loadLicensesHtml","loadApplicationVersion","currentRootComponentInstance","setCurrentProject","newCurrentProject","updateTheme","buildPrerequisites","mashup","urlAlias","getUrlVariables","urlVar","WSForm","getVarValue","sourceField","getCurrentTheme","currentCanvasTheme","newTheme","changeThemeCss","getBoundaryForWidth","location","hash","exportProjectContent","contentIds","filePath","saveFlagEnum","resourceName","getProjectContentResourcePath","response","WEB","rawJson","JSON","stringify","filteredBase64","base64","contentType","openHelp","CommonService","onTranslationsChangedEvent","initLookupOptions","openTranslations","globalString","fetchGlobalStrings","getCurrentStringsList","currentStringList","currentStringDictionary","getCurrentStrings","saveGlobalTranslations","globalStrings","saveGlobalStrings","loadGlobalStrings","deleteGlobalTranslations","deleteGlobalStrings","getProjectLanguages","language","localeEquals","getDefaultLanguage","propertyId","triggerEvent","getTranslations","getSupportedLanguages","addLanguage","newLanguage","translatedValue","componentLanguage","newComponentLanguage","deleteLanguage","deletedlanguage","locale1","locale2","hasLanguageComponent","currentTranslations","hasTranslations","setTranslatableStringByTranslationIndex","componentIndex","translationIndex","projectLanguageComponents","languageValue","currentLanguageKey","projectHasLanguage","setTranslationFromComponentLanguage","languageComponent","setTranslatableStringById","projectLanguages","firstTranslation","getLocaleDisplayName","localeDisplayName","createDefaultLanguageComponents","createLanguageComponentFromBindableField","getLookupOptions","lookupOptions","getAutoOptions","searchInput","done","charAt","autoCompleteGlobalStrings","filteredList","Name","maxItems","resizable","sortable","formatter","Soho","Formatters","Ellipsis","selectedRow","paging","pagesize","dataset","request","stringList","total","datasetCopy","filterExpr","DatagridHelper","getSearchResultOnPaths","sortId","sortDatasetByField","sortField","sortAsc","getPage","selectable","Single","toolbar","keywordFilter","localeNotDefault","TranslationManagementService","available","Button","Checkbox","Datepicker","Hyperlink","Label","TextArea","Timepicker","addComponents","componentName","toLowerCase","appendLinkFunction","LayoutComponent","componentReady","http","q","getUrl","getBaseUrl","setOverrideUrl","overrideUrl","resource","external","execute","executePost","POST","executePut","executeDelete","DELETE","executeRequest","requestConfig","debug","onCompleted","httpResponse","executeHttp","upload","files","formFields","formData","FormData","transformRequest","identity","post","encodeURI","errorPayload","statusText","reduce","outside","parse","modifiedHttpResponse","logMessage","toJson","possibleReasons","reason","newStatusText","Debugger","isEnabled","HttpService","features","fetchFeatures","fetchedFeatures","feature","getFeatures","getFeature","isFeatureEnabled","enabled","toggleFeatureStatus","enable","FeatureSwitchService","handlers","handler","h","pageRequest","activePage","normalizeValue","itemA","itemB","filterExpression","clearSohoProperties","deepValue","getSearchResultOnKeyword","isFiltered","_selected","_isFilteredOut","setEditableOnColumn","editable","editorOptions","formatterName","editor","Editors","Time","timeFormat","Locale","cultures","calendars","dateFormat","timestamp","minuteInterval","secondInterval","Datetime","showTime","Input","Textarea","Autocomplete","isEditable","setColumnSettings","textOverflow","setFormatterOnColumns","isChecked","jQuery","isNumeric","CustomFormatters","LocaleHelper","getDateFormat","Short","Integer","Decimal","Timeformat","Timestamp","SelectionCheckbox","AbsoluteValue","ToggleSummarizeOnColumn","summarize","summaryRowFormatter","aggregator","SummaryRow","SUM","convertDatetimeToTicks","calendar","oldDate","DateHelper","parseOption","pattern","parseDate","setHours","setMinutes","setSeconds","setFullYear","setMonth","setDate","addColumnData","dataservice","autocompleteSource","listItem","listOptions","parameterId","label","lookupData","outputParam","row","DEFAULT_INPUT_FIELD_NAME","parentAnnounce","isInvalid","$onInit","fieldName","validation","isRequired","validators","fieldValue","validate","$onChanges","changeObjects","isCallback","isFirstChange","currentComponentFieldError","fieldSpecificErrors","sharedError","errorList","previousValue","customValidator","validator","getError","validatorError","labelName","target","custom","onComponentChange","$data","callback","isValidationResult","removeFieldRelatedErrorsFromErrorList","sharedErrors","FieldValidation","componentService","dataServiceBuilder","jsonRuntimeApp","getBoundaryByWidth","rootComponentInstance","onBoundaryChange","_currentBoundary","getBoundaryByWidgetSize","cols","WIDGET_BOUNDARIES","_currentProject","_componentInstance","startupInteraction","getInteractionByTriggerName","observables","forkJoin","getComponentOnInteractionTargetName","throwError","runtimeApp","RuntimeApp","fromObj","Injectable","ComponentService","DataServiceBuilder","componentFactoryResolver","componentRefs","setRootViewContainerRef","viewContainerRef","addComponent","componentFactory","resolveComponentFactory","newComponentRef","createComponent","destroyComponent","componentRef","ngOnDestroy","DynamicComponentService","Inject","ComponentFactoryResolver","DebugState","$routeParams","STORAGE_KEY","ENABLED","setItem","disable","DISABLED","initialize","search","log","classObject","constructor","ParameterTypeEnum","DEFAULT_WIDTH","DEFAULT_HEIGHT","initiateDefaultValues","settingCategory","ComponentSettingsCtrl","InteractionParameter","param","addParameter","removeParameter","removeAllParameters","Interaction","questions","deleteQuestion","questionId","question","addQuestion","newQuestion","QuestionDefinitionsEnum","COMPONENT_SETTINGS","sameQuestion","getQuestion","SEEKS_BINDING","getQuestions","setQuestions","getQuestionById","setRoot","setHasFile","addDatasource","addInteraction","addCustomComponentDefinition","customComponent","addCompositeComponent","compositeComponent","entry","Mashup","DesignerMashup","DesignerManifest","DataSourceDescription","cell","col","datagrid","m3Datasource","operations","descriptionValue","dataParameters","DataSourceParameterType","parameterType","BODY_PART","MATRIX","PATH","QUERY","Multi","formatters","DataPairPresenter","dataPairList","foundItem","datapair","DatasourceSuiteFormatter","RequiredFormatter","checkValue","trimedValue","datetime","formatDate","parsedValue","isNaN","parseFloat","abs","featureService","isFeatureTranslationEnabled","isFeatureCatalogEnabled","ShowFeatureCatalog","FeatureSwitchCtrl","MG","WSUserControl","arg1","arg2","fileMetaData","createdBy","createdByDisplayName","createdTime","lastChangedBy","lastChangedByDisplayName","lastChangedTime","urlVariables","description","previewImg","showTitleBar","themeSwitchEnabled","typeDef","fileKey","mimeType","FileMetaData","updateLastChangedInformation","newManifest","USER","featureSwitchService","notify","getValidation","NotifiableComponent","viewChangedEvent","parseAndSetProject","DARK","getView","requestInfo","requestInfoPromise","Designer","designer","getInfo","jsonMashup","DesignerService","getComponentSettingsClass","allSettingsComponents","getInstance","updateParentComponentSizeClass","parentComponentEirChildren","containsBigComponent","isBigComponent","jsonComponent","componentElement","elementFromPoint","clientX","clientY","swap","array","firstIndex","secondIndex","temporaryItem","moveByIndex","startIndex","endIndex","tempItem","updateDOMTreeElement","isOverflowed","scrollHeight","clientHeight","scrollWidth","clientWidth","itemUnique","targetItem","ionApiService","hashService","currentStrings","supportedLanguages","initializeLanguageSettings","loadSupportedLanguages","detectLanguage","loadSohoLocale","strings","Value","stringItem","savedValue","modifiedStrings","languageKey","deletedStrings","changeCurrentLanguage","localStorageValue","username","urlSearchParams","getLanguageThroughSearchParams","getUrlLanguage","isValid","getMingleLanguage","getLocalStorageLanguage","LOCALE","getBrowserLanguage","isSupported","currentLanguage","getLocale","filename","$language","inforCurrentLanguage","supportedLanguage","isEqual","supportedLanguageKey","languages","hashedFilenames","getHashMap","mapFilenameToSupportedLanguages","cacheBustedFilenames","re","isMatch","fetchSupportedMingleLanguages","executeIonApiAsync","LanguageList","LanguageService","getIdoProjectList","getIdoCollectionList","pageNo","getIdoProperties","collectionName","getIdoCollection","inputParameterValues","recordCap","orderBy","filterQuery","parsedParameters","parseParameters","isTestIDO","initParameters","encodeURIComponent","updateIdoCollectionEntry","isValidUpsertRequest","insertIdoCollectionEntry","deleteIdoCollectionEntry","parameterValues","parameterNames","targetInput","inputParameter","rowPointer","required","LocalIdoService","createProject","saveData","designerMashup","duplicate","originProject","DesignerHelper","duplicateProject","publish","addToRuntime","progressBar","launchProject","openRuntime","deleteByIds","projectIds","deleteById","export","exportProject","exportProjectId","exportFileName","exportResult","importProject","projectFilePath","newName","copyToForm","formName","originProjectId","ProjectService","projectInteractionsChanged","startInteractionWizard","isActive","runStartupOnComponent","createNew","generateInteractionId","getInteractionDisplayName","interactionIds","interactionId","removeInteraction","resetErrorTooltip","createNewOnTheFly","jsonInteraction","updateAndSaveParameters","urlInteractions","getAllInteractionsWithUrlParameter","getInteractionsWithTarget","actionName","getActionName","urlVariableName","InteractionManagementService","currentTheme","languageShort","userName","userDescription","now","createSpoofedElement","addChildInstance","direction","ori","isFlexParent","border","borderColor","updateIsFlexParent","isParent","getAlignment","horizAlignment","verticAlignment","getAlignmentProperty","alignment","alignmentProperty","FLEX_START","CENTER","FLEX_END","generalComponentStyle","backgroundColor","padding","size","flexGrow","flexShrink","flexBasis","classes","WRAP","SCROLL","updateChildrenClasses","childrenHasPercentSizes","childrenClasses","_ori","_percent","pixels","getOrientationSetting","styleOptions","getPadding","getBorder","availableOrientations","availableHorizontalAlignments","availableVerticalAlignments","availableFlexSizeTypes","FLEX","availableOverflows","HIDDEN","condition","$cacheFactory","localIdoService","getDeferred","localIdoRequest","ionApiRequest","urlPath","isBinaryResponse","def","responseType","ionApiResponse","FileReader","readAsText","onloadend","ionApiResponseError","FOUR_HUNDRED","SIX_HUNDRED","isBinary","readAsDataURL","datasourceDatabearer","Generic2","Mongoose","LocalIdo","InlineList","DatasourceService","cacheData","cacheDatasources","cacheComposites","getDatasources","responseData","addDatasources","updateDatasource","deleteDatasources","exportDatasources","defaultFilename","loadCompositeComponents","addCompositeComponents","compositeComponents","deleteCompositeComponents","updateCompositeComponents","exportCompositeComponents","exportDefaultName","toISOString","getIDOs","createIDO","newCollection","deleteIDOs","idoNames","readJsonFile","deferredFile","fileReader","parsedObject","onerror","newDeferred","getDataByName","serverPath","RepositoryService","$templateCache","nextDisabled","backDisabled","initWizard","initTemplates","steps","ticks","initTicks","initWizardElement","setCurrentStep","wizardElement","$applyAsync","wizard","$evalAsync","selectedTick","WizardCtrl","dataKeyWizard","onChangeCurrentStep","tick","removeAttr","step","currentStep","updateBackDisabled","state","put","getEndStep","updateWizardTick","tickIndex","select","selectWizardStepByIndex","newStepIndex","selectWizardStep","next","getFinishParameter","nextStepIndex","back","previousStepIndex","WizardDirective","getNextId","DataServiceHelper","resourceUrl","deconstructPath","matrix","pathParameters","getPathParameters","matrixParameters","getSpecificParameters","queryParameters","pathMatch","matrixMatch","queryMatch","hashMatch","getURLVariable","paramType","regexp","urlComponentRegexBracket","urlComponentRegex","queryPath","validatePath","validateUrlPart","emptyItem","pathRegex","deliminator","nameMatch","showDatagrid","selectHandler","args","onItemSelected","changeHandler","onItemChanged","settingsChangedHandler","onSettingsChanged","rerenderTbody","datagridApi","getSohoXiApi","pagerInfo","pagerAPI","render","afterPaging","SOURCE_SETTING","dataItem","keepSelected","rowCount","filterBar","enableExport","initiateDatagridOptions","detachEvents","initClasses","refreshDatagrid","usePaging","togglePager","pageSize","isList","setRowCountOutput","multiSelect","toggleMultiSelection","toggleToolbar","updateValuesWithTranslations","onChildrenReady","translatedTitle","translatedCellText","refreshSubstitutions","refreshColumns","refreshDatagridTriggers","emptyMessage","setDatagridOptions","updateGrid","rowHeight","attachEvents","setSummaryRowOutput","datagridBearer","initial","columnDefinitions","hasSummaryRow","shouldHaveSummaryRow","selectType","getSelectType","saveColumns","TWENTYFIVE","showDirty","showSelectAllCheckBox","enableTooltips","summaryRow","results","previousAttributes","sortOrder","interactionPromise","setSelection","substituteValues","api","exportType","exportToExcel","exportName","exportToCsv","summaryOutput","summary","rowCountOutput","Multiple","substitute","substituteOptions","dropdownOptions","from","to","updateColumns","outParam","moveIndex","selectedItem","toggleSelected","currentDataLength","previousLength","syncAndDeselectAll","previousRow","previousPage","previousSortOrder","deSelectAllRows","getPagerApi","setActivePage","setSortColumn","selectRow","clearDirty","syncSelectedRowsIdx","dirtyItems","clearSummaryRow","getGridElement","updated","blankId","addClickEvent","addHyperlinkEvent","loadOptions","checkboxExists","checkbox","align","rowsSelected","isDrillback","drillbacklink","hrefString","datagridElement","checkExist","setInterval","clearInterval","updateBindableItem","listData","arg","argData","newData","selectedRows","setSelectedItem","dirtyRows","ON_COLUMN_UPDATED","sourceId","autoData","summaryRowCells","availableRowHeights","AVAILABE_PAGE_SIZES","OPTION1","OPTION2","OPTION3","OPTION4","lookupOutputId","beforeShow","lookup","lookupCallback","openLookupDialog","AVAILABLE_WIDTHS","OUTPUT_SETTING_TITLE","tabsParent","currentTab","visibility","config","$stateProvider","$urlRouterProvider","otherwise","AppState","HOME","APP_LAUNCHER","REFRESH","DEVELOPER","reloadOnSearch","appType","DESIGNER_PREVIEW","$stateParams","undoActionEvent","maxUndoCount","undoStack","currentIndex","getCurrentUndo","undoAction","redoAction","stateRootComponent","stateInteractions","stateTranslations","clearActions","isUndoAvailable","isRedoAvailable","UndoService","settingInstances","settingRef","registerSetting","settingCtrl","settingFields","relevantSettings","hasRelevantTab","settingsTab","conditionPassed","$eval","GenericSettingsCtrl","GenericSettingsDirective","elementRef","renderer","changeDetectorRef","dynamicComponentService","sohoMessageService","boundaryChange$","Subject","componentReady$","subscriptions","dataserviceId","_dataservice","dataserviceDatabearer","ngOnInit","nativeElement","parentElement","onInitComponent","ngAfterViewInit","setInitialSohoComponentSettings","ngAfterViewChecked","detectChanges","subscription","updateClassesAndInlineStyles","getInlineStyles","setStyles","styles","propertyValue","setStyle","updateClassNames","updateInlineStyles","componentStyleProperties","runComponentDataService","of","Observable","throw","busyIndicator","activated","newObservable","pipe","take","subscribe","dataServiceError","dataServiceCompleted","showErrorDialog","initializeBinding","componentDatabearer","updateBindings","componentMetaData","ButtonMetadata","ListMetadata","TextboxMetadata","displayDelay","interactionTrigger","interactions","componentELement","ViewChild","SohoBusyIndicatorDirective","static","BaseComponent","BaseComponentMetadata","RuntimeManifest","customComponentDefinitions","tags","expressions","getExpressions","getExpressionsByComponentId","expression","addExpression","deleteExpression","deletedExpression","removeExpression","saveExpression","savedExpression","expressionIndex","dsName","getDatasourceDatabearers","datasourceDatabearers","removedDataservice","getInteractionDatabearers","setInteractions","toRemoveInteraction","getCompositeComponents","getCompositeComponent","compositeId","cmp","removeCompositeComponent","compositeToDelete","getTags","setTags","getBoundaries","setTranslations","translationList","setPreviewImage","base64Img","manifestType","newInteraction","generateSample","schema","swaggerDoc","tempSchema","$ref","definitions","getSchemaType","default","Array","isArray","JsonHelper","sample","properties","generateSchema","getPropertyFormat","TypeError","getPropertyType","propertyNameMatch","jsonQuery","isCyclic","seenObjects","detect","fixCyclic","prettify","jsonString","spaces","isInvalidJsonPath","root","datetimeParts","time","milliseconds","isValidMillisecondTimestamp","MAX_TIMESTAMP","MIN_TIMESTAMP","isValidDate","addChild","ch","childrenDatabearers","filterValue","clearSearch","getFilteredList","filterList","updateCurrentTemplateHeight","renderChildren","setCurrentItem","realIndex","getRealIndexFromGeneratedId","currItem","currentItem","selectedGeneratedId","forEachItemTemplate","onLoad","onComponentReady","childInstance","subChild","loadFillOptimal","childrenReadyDeferred","getChildContext","percent","childKey","loadMore","down","infiniteScrollEnabled","newRowCount","getRowsPerPage","realIndexMax","remainingSlots","deletedChild","getNewGeneratedComponent","realIndexMin","getActiveFieldsFromTemplate","checkObjectforFilterMatch","activeIDs","breakdown","toolTip","objectValues","activeFields","entries","firstLiElement","first","currentTemplateHeight","goToPage","moveScroll","listresult","getGeneratedPrefix","generatedIndex","optimalRowCount","SCROLLABLE_PAGE_FACTOR","listElement","scrollTop","dataLength","remainingTilOptimaleCount","remainingDataLength","min","updateView","returnNumber","eachHeight","hasListResults","hasData","noData","readyChildrenCount","DEFAULT_ORIENTAION","updateWhenExist","tabs","changeTabOnHashChange","hashChangeCallback","onChangeTab","updatePanels","initializeTabs","selectedId","selectedTab","onOrientationChanged","tabAPI","tabPanel","innerChild","TestDataserviceDialogType","fetching","testDialogTypes","initDatagridOptions","initGenericState","handleError","runApi","runGenericApi","copyToClipboard","execCommand","onKeyPress","which","ENTER","mandatory","paramForInput","acc","UNFORMATTED","getUnFormattedData","FORMATTED","getFormattedData","maybeNewKey","newKey","formatResults","fillResponseData","getNonParsedData","TestDataserviceDialogCtrl","DATAGRID_RENDERED","attributes","DatagridDirective","DIRECTIVE_NAME","columnName","finishedResult","newOptions","oldOptions","oldDataset","loadData","preserveSelected","updateDatagrid","DatasourceCreateModeEnum","ionMetadataService","userTip","outputRootElementInvalid","inputRootElementInvalid","objectIdInvalid","hasRequestBody","focusedOperation","swaggerDocument","runWizard","RepositoryHelper","getSwaggerOperation","suite","endpoint","editDataservice","newDataserviceFromSwaggerDocument","newDataserviceFromScratch","onChangeRequestMethod","datasourceCreateMode","EDIT","loadSwaggerOperation","searchOperations","operation","swaggerJsonFilePath","operationPath","getSwaggerDoc","FROM_SCRATCH","outputRootElement","inputRootElement","bodyTemplate","outputJson","FROM_SWAGGER","deconstructPaths","outputSchema","getResponseSchema","inputSchemaFetch","getRequestBodySchema","inputSchema","isEmptyObject","autoCorrectM3","autoCorrectM3Version2","dialogEvent","messageOutput","operationSummary","configureResourcePath","getTypeDef","generateRequestBodyTemplate","generateInputParameterObjects","generateRequestHeaders","originalSchema","generateOutputParameters","json","MIRecord","records","RowIndex","NameValue","example","resourcePath","swaggerOperation","in","onChangeOutputType","BINARY","OUTPUT","onChangeOutputRootElement","onChangeInputRootElement","onChangeObjectIdPath","objectIdPath","openTestDataserviceDialog","testDialogType","openInputJsonDialog","viewJsonDialog","onOpenJsonHelp","openOutputJsonDialog","generateInputParameters","bodyParameters","DatasourceWizardHelper","generateParameters","responses","getResponseObject","verifyResponseSchema","allOf","jsonSchema","xml","successCodes","showBadResponseError","codeString","successCode","swaggerParameter","isInput","showHelp","isValidated","swaggerParam","nameValue","bodySchema","produces","getAcceptValue","mime","filteredErrorList","setNextDisabled","$item","indexOfItem","DatasourceWizardCtrl","EditorFlexboxCtrl","getInsertPoints","getChildIndex","flexbox","thisElement","isVertical","offset","ghostOffset","getPosition","getOffset","nonGhostChildren","childElement","isGhost","outerWidth","firstChildElement","childPosition","childOffset","leftOffsetToAdd","points","offsetToAdd","isFinalInsert","insertedElement","flexboxDatabearer","eirChildrenNode","EditorLayoutComponentCtrl","createTemplate","childScope","childAtGivenIndex","before","removePossibleChildInstance","childId","indexToDetach","childDatabearer","sizeSetting","parsed","clipboardComponentChangedEvent","clearSelection","cancelInserting","setClipboardComponent","clipboardComponent","getClipboardComponent","insertComponent","setInsertComponent","newInsertParent","oldInsertParent","insertParent","insertHandlerOut","showCursorNoDrop","insertType","finishedDeferred","resetVariables","finalParent","canInsertAt","cancelTimer","offsetX","offsetY","foundIndex","updateGhostPosition","newMousePosition","timerPromise","movedFarEnough","lastMousePosition","getInsertIndex","currentParent","canInsert","hasParentChildren","insideRulerElement","newCursorValue","dropEffect","preventDefault","availableInsertPoints","notNewParent","axis","movedEnough","undoFunction","previousInsertParent","mousePosition","isHorizontal","positionToCompare","eirEditorComponent","InsertComponentService","STANDARD_ID_PREFIX","STANDARD_BOUNDARIES","updateChart","datasourceChanged","getSohoChartType","chartEnum","getExampleData","getDataset","datasetsMetadata","datasetMetadata","Column","Donut","Pie","BarGrouped","BarStacked","ColumnGrouped","chartElement","hasLabel","chartWrapper","chart","axisLabels","axisValuesTitle","axisCategoryTitle","showLegend","animate","isArea","Area","isDonut","isGrouped","isStacked","selectedRadioButtonId","currentItemName","currentItemValue","selected","tenantId","token","setTenant","getToken","setToken","setUrl","getHeaderName","getHeaderValue","IonApiContext","getIonApiContextAsync","hasToken","ionApiContext","getIonBaseUrl","tokenURL","isDeveloperModeActive","proxyURL","executeIonApi","isRetry","contextUrl","HttpUtil","combine","m3Data","nrOfFailedTransactions","isUnauthorized","ionApiRetry","retryContext","retryError","IonApiService","loadRuntimeProject","parseAndSetApp","loadPublishedProjectNoConstraint","instantiateDataservice","setCurrentUrlValues","urlDataset","urlData","RuntimeService","ConflictResolutionEnum","newObjects","currentObjects","conflictKey","objectName","splitConflicting","conflictingObjects","conflicting","notConflicting","deferredResolutions","resolveNextConflict","resolutions","resolutionResult","applyResolutions","toAdd","toRemove","checkIfInvalidImportedItems","errorText","importedItems","oldObjects","newObject","existingObject","getConflictString","resolveConflictDialog","conflictedString","conflictCount","lastAction","remainingCount","REPLACE","deferredResolutionChoice","currentObject","nextIndex","dialogValue","resolution","SKIP","sameForRemaining","resolvedCompositeComponents","valuesToRemove","objsToRemove","valueToRemove","ConflictResolutonService","swagger","pathItemObj","restPath","delete","head","suiteContext","tenant","proxyPath","caseInsensitive","endsWith","mapSchemaToGridData","depth","expanded","childName","childSchema","addQueryParameter","getAppbuilderDataType","dataType","newDataType","unregisterBinding","bindingID","unregisterContextBinding","bindingId","availableOutput","newAvailableOutput","innerComponent","currentvalueSource","BOOLEAN","BindingManagementService","boundaryIdCounter","newBoundaryAddedEvent","boundaryMovedEvent","getBoundary","getProjectBoundaries","generateBoundaryId","boundaries","goToCurrentBoundaryMarker","alreadyExistsHere","addNewBoundaryMarker","addProjectBoundary","isBoundaryReadOnly","removeBoundarySettingsFromComponents","removeProjectBoundary","removeBoundaryMarker","allBoundaries","updateBoundaryMarker","BoundaryManagementService","saveStates","inProgress","saved","failed","saveStateEvent","raiseSaveStateEvent","saveManifest","saveRootComponent","saveInteractions","saveDatasources","SCREENSHOT","saveScreenshot","CUSTOMCOMPONENTS","saveCustomComponentDefinitions","saveCompositeComponents","saveTranslations","TAGS","saveTags","saveUrlVariables","EXPRESSIONS","saveExpressions","QUESTIONS","saveQuestions","saveState","canvasArea","prop","inlineWidth","useCORS","allowTaint","canvas","toDataURL","jsonInteractions","jsonTranslations","jsonDatasources","jsonDatasource","compositeComponentDefinitions","SaveService","contentSettingsDirective","FlexboxContentSettingsDirective","newFlexbox","createWithoutPadding","defaultFlexbox","modifiedFlexbox","Default","currentItemIndex","emptyValue","updateCurrentItem","newCurrentItem","setPseudoElemDisplayText","onListUpdated","firstItem","displayValue","dropdown","getSoHoDropdown","pseudoElem","executeSetSelectedItemAction","interactionDeferred","valueToFind","actualValue","removeEmptyValue","setEmptyValue","bindableRef","renderURL","onLinkClick","availableDirectionTypes","BACK","DIRECTIONAL","setImageSource","webkitURL","setImageFromUrlToSource","base64result","availablePositionTypes","FIT","fontStyle","fontChar","color","availableStyles","availableCharacteristics","availableColors","colors","graphite10","componentNameBackgroundColor","azure01","azure02","azure03","azure04","azure05","azure06","azure07","azure08","azure09","azure10","amber01","amber02","amber03","amber04","amber05","amber06","amber07","amber08","amber09","amber10","amethyst01","amethyst02","amethyst03","amethyst04","amethyst05","amethyst06","amethyst07","amethyst08","amethyst09","amethyst10","turquoise01","turquoise02","turquoise03","turquoise04","turquoise05","turquoise06","turquoise07","turquoise08","turquoise09","turquoise10","ruby01","ruby02","ruby03","ruby04","ruby05","ruby06","ruby07","ruby08","ruby09","ruby10","emerald01","emerald02","emerald03","emerald04","emerald05","emerald06","emerald07","emerald08","emerald09","emerald10","graphite01","graphite02","graphite03","graphite04","graphite05","graphite06","graphite07","graphite08","graphite09","slate01","slate02","slate03","slate04","slate05","slate06","slate07","slate08","slate09","slate10","lengthWarning","updateMaskOptions","getMask","maskOptions","editType","maskApi","patternOptions","allowDecimal","decimalLimit","allowNegative","integerLimit","allowThousandsSeparator","newBoxWidth","boxWidth","HashSources","HashSourceTypes","buildEnv","appEnv","DEV","getHashDataSrc","designerMapOfHashes","runtimeMapOfHashes","getHashFromMapOfHashes","srcString","hashSrc","formattedSrcString","getHashFromHashDataDesigner","getHashFromHashDataRuntime","getHash","newSrcString","err","getValueFromMapAndParseToMongooseAssetsPath","mapWithHashes","src","DESIGNER_HASH_SRC","RUNTIME_HASH_SRC","HashService","mainTheme","changeStylesheetPromises","updateCanvasCss","canvasTheme","cssUrl","linkId","getCssTheme","srcHashData","hashedString","bodyElement","LIGHT_TRANSPARENT","DARK_TRANSPARENT","linkElement","changeStylesheet","HIGH_CONTRAST","ThemeService","fillInParameters","extraParameters","ionApiParameter","Datasource","projectInfoChangedEvent","getAvailableTags","TagService","projectInfo","ProjectInfo","repositoryService","conflictResolutionService","anySelectedDataItem","selectedDataItems","datagridId","dialogTitle","importActionTitle","CACHE_KEY","saveToCache","dateFilter","advancedFilter","actions","views","loadDatasources","dataserviceToTest","cachedDataset","getFromCache","loading","Dataset","clearSelected","exportDatasource","import","datasourcesToImport","importDatasources","conflictResolutionObject","datasourcesToAdd","idsToDelete","datasourceToDelete","addImportedDatasources","addedDatasources","errorDialogOptions","displayNames","deletedId","editDatasource","selectedDatasource","isCorrectVersion","isEdit","openDataserviceWizard","cachedDatasources","datasourceFind","isSearch","DATASOURCE_ERROR_MESSAGE","RepositoryTab","DatasourceTabCtrl","DatasourceTabComponent","initDatagridEvents","rowObject","CacheableCtrl","SourceEnum","sourceList","ION_API","SELECT_SOURCE_ELEMENT_ID","initDialogEvents","selectedSource","openIonApiSearch","openCreateInlineList","openCreateLocalIdo","Back","selectOption","currentTarget","SelectSourceCtrl","initParameterDatagrid","parameterDatagridOptions","LocalIdoOperationDetails","ChartDialogActionEnum","ChartContentSettingsDirective","styleSettingsDirective","ChartStyleSettingsDirective","EditorChartCtrl","listRow","previewText","onComponentInserted","onComponentDeleted","EditorApplicationParent","EditorRadioButtonCtrl","panelIndex","newPanel","initializeSourceBindings","componentTemplate","ChildrenDirective","EditorTabsCtrl","addTab","deleteTab","updateTab","switchFocusTab","updateTabPosition","getTabApi","newTabComponent","createTabComponent","newTabPanel","appendTabComponentToTemplate","listOfTabs","adjencentTabIndex","updatedTab","tabElement","getTabElement","after","elementSelector","newTabId","tabComponent","elementName","tabPanelTemplate","templateLinkingFunction","tabOption","createNewViaWizard","MAX_COMPOSITE_COMPONENTS","COMPOSITE_COMPONENT_ERROR_MESSAGE","startCompositeComponentWizard","dialogResult","creationDate","author","getUserName","authorDisplayName","getUserDisplayName","includeDatasources","manageCompositeComponents","compositeComponentDialogPromise","removeViaDialog","confirmDialogOptions","addLanguagesFromComposite","setCurrentValuesToCurrentLanguage","composite","childComponent","CompositeComponentManagementService","originalTranslations","bindEvents","onKeyDown","onKeyUp","removeClipboardComponentByUndoStack","currentUndoComponent","getSelectedText","altKey","ctrlKey","cmdKey","metaKey","modifierKey","CTRL","previewMode","LESS_THAN","saveProject","KEY_S","isAnyModalOpen","KEY_X","cutComponent","KEY_C","copyComponent","deleteComponent","KEY_Z","KEY_Y","KEY_V","pasteComponent","multiInsert","currentComponent","childComponentInstance","childComponentId","finishInsertComponent","nextCopy","HotkeyService","newDisplayNameOverwrite","OVERWRITE","COPYNEW","IdConflictCtrl","observers","webpackEmptyAsyncContext","req","Promise","appBuilder","upgradeModule","idsAssetsModule","designerModule","repositoryModule","runtimeModule","run","$state","$interval","onReady","stop","App","doUnloadPrompt","initUrl","isLaunchApp","isLaunchWithAngular","stateName","appLauncherState","go","$qProvider","$compileProvider","errorOnUnhandledRejections","debugInfoEnabled","commentDirectivesEnabled","cssClassDirectivesEnabled","DashboardDirective","DuplicateProjectCtrl","DisplayNameConflictCtrl","AllProjectsToolbarComponent","CreateProjectComponent","CreateToolbarComponent","ProjectCardComponent","CanvasDirective","CanvasSliderDirective","ComponentValueDirective","EditorDirective","NewComponentDirective","NewComponentTabsDirective","NewCompositeDirective","RulerDirective","SelectionBoxDirective","StatusbarDirective","TopbarDirective","UrlSourceFieldDirective","CompositeComponentWizardCtrl","SettingsDirective","BorderSettingsDirective","CheckboxSettingsDirective","DropdownSettingsDirective","MarginSettingsDirective","RadiobuttonSettingsDirective","SwitchSettingsDirective","TextSettingsDirective","SettingsSwitchers","addComponentSettings","ValuesourceSettingsDirective","AttributeSettingsDirective","InteractionSettingsDirective","ParameterHandlerDirective","EditorButtonCtrl","EditorCheckboxCtrl","EditorDatagridCtrl","EditorDatepickerCtrl","EditorDropdownCtrl","EditorHyperlinkCtrl","EditorImageCtrl","EditorLabelCtrl","EditorListCtrl","EditorLookupCtrl","EditorTabPanelCtrl","EditorTextAreaCtrl","EditorTextboxCtrl","EditorTimepickerCtrl","CustomComponentCtrl","InteractionSettingsCtrl","InteractionWizardCtrl","StandardBoundariesCtrl","AutoAddColumnCtrl","BoundaryEditorCtrl","BuildLinkCtrl","ChartSettingsDialogCtrl","CopyFormDialogController","UpsertQuestionDialogCtrl","BaseDialogController","EditBindingCtrl","EditRadioButtonCtrl","EditTabCtrl","EditExpressionDialogCtrl","ExpressionDialogCtrl","ManageDatasourcesCtrl","ManageCompositesCtrl","ManageRepositoryCtrl","MaskSettingsDialogCtrl","ProjectSettingsCtrl","TranslationDialogCtrl","UpsertColumnCtrl","UrlVariableDialogCtrl","DeveloperToolComponent","StateNames","AppLauncherHybridComponent","appStates","injector","setNg1Services","loadNg1Project","ng1RuntimeService","ng1FrameworkService","self","takeUntil","setNg2FrameworkServiceProperties","showMashup","complete","observer","ADMIN_PREVIEW","APPHUB","onResize","innerWidth","HostListener","Event","selector","Injector","AppLauncherBase","Generic","HttpClient","availableButtonStyles","checkboxState","checked","dateFormatted","dateFormatShow","dateFormatBinding","dateFormatInput","isDefaultTodayDate","setDatepickerOptions","datepickerOptions","placeholder","setValue","isStaticSet","updateDatepickerValue","newDate","setDateValue","dateValue","datepickerApi","setToday","initializeDatepicker","updateDatepickerReadonlyValue","addPreventDefault","ulPath","THREE_HUNDRED","readonly","datePickerApi","parseDateFormatAutomatic","availableDateFormats","$attrs","updateMaxLength","textareaOptions","characterCounter","DEFAULT_MAX_LENGTH","charRemainingText","enableSeconds","formatString","updateReadonly","timepickerApi","timeValue","setTimepickerOptions","upperCaseTime","isValidTime","setTime","refreshTimepicker","timepickerOptions","finalTime","availableHourMode","detailObject","resultToFormat","getVerifiedResult","listObject","setSubstitutionTags","bodyParameter","substitutionTag","requestBody","datasourceParameter","strToReplace","fullSubstitutionTag","getRequestBody","relativeUrl","relativeUrlPath","ionApiCalls","ionapiParameter","inputparameter","ionApiCall","deferredMetaData","triggeredConditions","currentProjectComponents","isUsed","conditionType","sourceValue","sourceProperty","getExpressionValue","targetValue","targetProperty","runExpression","triggeredCondition","findComponent","clauseOperator","triggerCondition","targetString","sourceString","getExpressionComponentValue","componentDataservice","componentValue","componentBindableValue","ExpressionService","getLogicalId","logicalId","MingleService","DEFAULT_LID","setupMessageHandler","messageType","infor","companyon","client","registerMessageHandler","sendApplicationInitComplete","sendMessage","MESSAGETYPE_APPINITCOMPLETE","sendPrepareDrillbackMessage","sendBusinessContextMessage","appId","appName","MESSAGETYPE_BUSINESSCONTEXT","getOriginatingTime","generateContextId","getDrillbackUrl","MESSAGETYPE_SHORTCUTCONTEXT","sendClearContextMessage","MESSAGETYPE_CLEARCONTEXT","MESSAGETYPE_APPLICATIONDRILLBACK","MESSAGETYPE_FAVORITECONTEXT","componentsModule","commonModule","IonMetadataService","ComponentCommonDirective","ComponentDirective","TitlebarDirective","getFormattedFilename","formattedFilename","fileExtension","getFileExtension","ExportProjectCtrl","InforOwnedEnum","LISTVIEW_RENDERED","ListviewDirective","closest","unbindWatcher","listview","selectedItems","listViewData","initCache","getApiSuites","makeIonRequest","searchCriteria","OPERATIONS_PAGE_SIZE","fullPath","swaggerPath","resp","dereferenced","ComponentHelper","dereferenceSwagger","relativePath","$compileService","childrenReady","attrs","nrChildrenReady","onChildReady","getSizeSuffix","launchInMongooseIframes","launchAsIntended","varValue","variable","setVarValue","generate","setFilterOptions","filterOptions","displayText","methodsFilter","allUnchecked","f","operationShouldPass","opt","setDropdownOptions","isBusy","metadataService","suites","selectedOption","getListItems","handleRequestError","showOperationDetails","showSwaggerDocumentation","getSwaggerDocumentFromCache","cacheKey","swaggerOperationId","addSwaggerDocumentToCache","isValidSwaggerDocument","runCreateNewWizard","getErrorMessage","errorStatus","IonApiSearchCtrl","BaseSearchCtrl","resultListContainerElement","resultListElement","onResultListScroll","onToggleSelected","previousIndex","getNextPage","previousPageHadResults","getResultListScrollPosition","containerHeight","initResponseDatagrid","initDialogData","swaggerOp","parameterDatagridOption","responseDataset","responseCode","responseDatagridOption","Tree","treeGrid","IonApiOperationDetails","isSupportedIonApiDataservice","MINGLE","jsonData","findParameters","renameDuplicates","count","parameter2","getm3OnpremValue","doIndex","createParameterObject","newPath","dataserviceType","getParameterType","finalAlias","getNumericType","getStringType","numericValue","isValidName","isUniqueName","collections","isDuplicateName","IdoValidator","listviewId","idoProjects","openTypeHelp","showTypeHelp","collection","initIdoWizard","listApi","selectedProperty","currentProperty","isCurrentUndefined","invalidProperty","verifyErrorList","propertyLength","decimalLength","isCurrentPropertyValid","setErrorToListItem","alert","alertClass","propertyFound","isDisabled","currentStepTitle","idoProject","tableAlias","primaryKey","getIdoProjects","serverName","newProperty","deleteRow","getSelected","nextEntryIndex","setNextSelectedRow","preview","showOptions","idoCollectionUsedToValidateNameIsUnique","tableName","initIdoProjectDropdown","initListviewOptions","loadIdoCollections","listviewOptions","Mixed","showCheckboxes","selectOnFocus","setTableAlias","idoName","shortHand","successful","IdoWizardCtrl","PAGE_TEMPLATES","imgSrc","chartActionEnum","setSelectedSourceField","sourceFields","chartContent","selectedCategory","selectedSeries","dialogAction","onArrange","refreshComponent","onAddColumn","addColumn","openUpsertDialog","editColumn","deleteColumn","onEditColumn","resultPromise","addColumns","deleteAllColumns","showAskDialog","showAddPredefinedColumnsDialog","dialogResponse","autoAddColumns","selectedColumns","autoFormatColumns","newColumn","getFormatterName","columnIds","adjustColumnSizes","addToLanguageComponents","ignoredColumn","hasTextTranslation","summaryText","summaryTextPlacement","numberOfColumns","isAdd","addTitle","editTitle","getAvailableSourceFields","UpsertDatagridColumnContentSettings","addFirstColumn","addFirstChildren","addFirstRow","onMouseEnter","selectComponent","pushChild","FlexboxContentSettingsCtrl","MIN_CHILDREN_COUNT","popChild","removeLastChildren","countflexChildren","flexChildrenCount","flexChildrenAmount","newFlexChild","childIdToRemove","detachedChildren","childrenContext","childArray","currentItemOptions","firstFlexChild","resetPreviousData","childContext","newFlexboxParent","lastChild","transferChildrenToGrandParent","availableTemplates","OneLabelFlexbox","TwoVerticalLabels","ImageAndLabels","OneHyperlink","OneHyperlinkAndLabel","ImageLabelAndHyperlink","ListStyleSettingsDirective","newList","getTemplate","listId","templateComponent","labelFlexbox","flexboxVertical","topLabel","createLabel","bottomLabel","imageFlexbox","image","createImage","innerFlexbox","label1","label2","hyperlinkFlexbox","flexboxHyperlinkVertical","hyperlink","imageHyperlinkFlexbox","imagePiece","innerFlexboxPiece","labelPiece","hyperlinkPiece","radio","autocompleteOptions","changes","savedComponentStrings","selectedChanged","equals","savedGlobalStrings","deletedGlobalStrings","onChangeRadioButtonName","availableMasks","TextboxStyleSettingsDirective","boundaryManagementService","standardBoundaries","selectedStandardBoundaryIds","ok","newBoundaryIds","showOverlay","refreshAvailableDatasources","availableDatasources","manageDatasources","changeSidebarTab","hideSidebar","selectedComponentClassName","settingDatasource","onChangeDisplayName","newWidth","onChangeDatasource","previousDatasourceId","changeSelectDatasourceOnComponent","promptUpdateOrRemoveInteractionsConfirmDialog","runDefaultInteraction","defaultAction","prevDatasourceId","isChangeDatasource","amountInteractions","removeComponentInteractions","SettingsCtrl","invalidString","bindingString","isLocalized","onChangeBindingString","availableTargetActions","interactionChangedEvent","targetActionChangedEvent","sourceTriggerChangedEvent","updateRelevantInteractions","setWizardFocusType","selectInteraction","isFinderActive","isWizard","selectedInteraction","updateUI","currentInteractionsForSelectedComponent","refreshInteractionDisplayName","createDefaultInteraction","initAvailableComponents","useFinder","selectSourceApplication","settingSourceComponent","onChangeSourceComponent","settingTargetComponent","onChangeTargetComponent","setSourceAsTarget","selectTargetApplication","setDisplayStrings","triggerString","relevantInteractions","availableSources","availableTargets","sourceComponentInstance","targetComponentInstance","setAvailableTargetActions","setAvailableSourceTriggers","availableSourceTriggers","settingSourceTrigger","settingTargetAction","getSelectedInteractionDisplayName","sourceTriggers","identifier","COMPONENT_HAS_NO_DATASERVICE","targetActions","manualRunSelected","getSelectedInteraction","encodedFocusSettings","createNewInteraction","interactionComponent","removeSelectedInteraction","interactionSource","onChangeSourceTrigger","interactionTarget","onChangeTargetAction","newTargetAction","setMode","settingComponent","triggerChangeComponent","selectedComponentAsTarget","isTarget","componentToSet","finderOptions","itemSelected","operatorDictionary","typeDictionary","expressionType","refreshDataset","initGridOptions","editExpression","newExpression","selectedExpression","updateDisplayNames","updatePropertyNames","setSourcePropertyName","setTargetPropertyName","getComponentExpression","allExpressions","getPropertyName","targetPropertyName","getName","sourcePropertyName","propertyDisplayName","bindings","componentDisplayName","buildDataset","expressionViewData","displayItem","operatorName","conditionalType","existingComponent","manageDisplayItem","manageColumns","gridcolumns","projectService","initGrid","openGlobalRepository","repoDatagridOptions","getItemSpecificData","newUniqueItems","isUnique","getItemDisplayName","addItems","newItems","exceedsMaximum","importPromise","importToCurrentProject","dataName","addItemsToProject","getDataList","maxErrorMessage","itemsToImport","importItems","maxAllowed","itemToImport","deleteItems","deletedItems","setItemId","deleteItem","withExtra","amount","idToFind","getItemId","existingItem","ManageDialogBase","bindingValue","ButtonComponent","ElementRef","Renderer2","ChangeDetectorRef","SohoMessageService","DropdownMetadata","contextData$","onChange","dropDownComponent","setFocus","blur","SohoDropDownComponent","DropdownComponent","getOrientationSettings","FlexboxMetadata","classNames","updateChildCageInlineStyles","updateParentInlineStyles","inlineStyles","assign","FlexboxComponent","templateId","setTemplateBindings","onSelected","selectedItemIndex","getSelectedItems","SohoListViewComponent","ListComponent","LookupMetadata","Readonly","productId","productName","activity","quantity","price","orderDate","onBeforeShow","SohoLookupComponent","LookupComponent","input","SohoInputComponent","TextboxComponent","origin","parentDomain","postMessage","userControlListener","userControlListenerScope","handleParentMessage","readyHandlers","isInitialized","requestId","requestCallbacks","pos","parms","ix","rh","payload","fireEvent","addEventListener","attachEvent","msg","getIsConnected","UserControl","postMessageDirect","generateServerEvent","cmd","sendWebUserControlRequest","getQueryParameter","getOrigin","getPlatform","getTheme","getWebClientUrl","getSession","getConfigName","Ajax","cb","onError","XMLHttpRequest","onreadystatechange","readyState","responseText","send","registerListener","invoke","eventName","getFormId","getCompValue","setCompValue","getPropValue","setPropValue","arguments","async","getImageSrc","registerCallback","listeningMessageTypes","drillbackSelector","favoritesSelector","MsgType","messageReceiver","executeMessage","parseJSON","registeredHandlers","wildCardHandlers","allHandlers","registeredHandler","sendRelayMessage","proxyMessage","sendMessageToParent","encodedProxyMessage","encodedMessage","containerWindow","opener","sendMessageProxy","testFrameAndSend","frame","frames","sharePointUrl","messageObject","evalJSON","adjustHeight","iframeName","sendPrepareFavoritesMessage","getValueQuerystring","qs","namespace","unRegisterMessageHandler","newHandlers","unbind","getEnvironmentInformation","randomNumber","getRandomNumber","MessageId","getEntityInformation","getInforMingleHomeUrl","relayMessage","ct","fr","contentWindow","iframeId","live","ng1Import","ng2Import","RootModule","ng1RootModule","$urlService","deferIntercept","ng2RootModule","platformBrowserDynamic","bootstrapModule","platformRef","urlService","UrlService","NgZone","listen","sync","interactionParameters","substituedUrl","bodyParameterJson","sourceComponentValue","DataService","initService","isDevelopment","ionapiCall","Authorization","currentLocale","url1","url2","end","newEntry","parseListData","idoParameter","idoEntry","Items","remapItemProperties","parsedResponse","parsedItems","runtimeHelo","providedIn","set","IdsSvgComponent","pathname","pathnameNoIndex","$animateProvider","classNameFilter","animation","enter","doneFn","slideDown","leave","slideUp","fadeIn","fadeOut","AddStringCtrl","ImportConflictCtrl","ImportErrorCtrl","ImportProjectCtrl","LicensesButton","LicensesDialogCtrl","DatagridExportDialogCtrl","DragDirective","InitializeDirective","InfiniteScrollDirective","RepeatDoneDirective","Filters","DropdownFieldComponent","FilterPopupmenuComponent","FilterTagComponent","FilterToolbarComponent","InputFieldComponent","PaginatorComponent","ProjectTagsComponent","TagDropdownComponent","TextareaFieldComponent","SortPopupmenuComponent","AboutDirective","ArrangeDirective","AutocompleteDirective","BusyDirective","ButtonDirective","ColorPickerDirective","ControlDirective","DatepickerDirective","DropDownDirective","FileuploadDirective","LookupDirective","MaskDirective","MultiSelectDirective","PopupmenuDirective","PopoverDirective","SearchFieldDirective","SliderDirective","SpinboxDirective","TabsDirective","TextareaDirective","TimepickerDirective","ToolbarDirective","TooltipDirective","TrackDirtyDirective","ValidateDirective","ApplicationMenuDirective","inputArray","criteria","itemProperty","keepItem","compareValue1","item2","compareValue2","itemProperty1","itemProperty2","ExcludeFromFilter","OnlyIncludeFilter","HtmlEncode","stringName","sameForAll","resolutionOption","onChangeOption","currentActionName","stateBasedOnSubcode","subcode","information","extraInfo","confirmButtonDisplayName","confirmButton","None","confirm","chosenFile","dbVersion","aboutOptions","useDefaultCopyright","$sce","licensesHtml","applicationVersion","dbVersions","htmlCode","trustAsHtml","$last","repeatDone","ngDragEventDirectives","directiveName","$parse","compile","ngDragEventHandler","$digest","THROTTLE_MILLISECONDS","scrollDistanceThreshold","bounceDistance","EDGE_BOUNCE_INTERVAL_MILLIESECONDS","lastScrollTop","edgeBounceInterval","up","eirInfiniteScroll","scrollEnabled","throttle","evt","scrollingDown","scrollingUp","distanceFromBottom","offsetHeight","$apply","distanceFromTop","bounceEdges","func","wait","previous","later","remaining","eirInfiniteScrollEnabled","InfiniteScrollCtrl","maxProjects","maxApps","maxComposites","maxDatasources","user","mgFormName","mgFormOnly","mgPlatform","mgConfigName","mgHelpBaseUrl","setBaseBuilder","basebuilder","InitializeCtrl","$static","DropdownFieldCtrl","listValues","filterValues","localPrefix","FilterPopupmenuCtrl","$filter","filterOn","storageName","storedFilter","originalValues","currentSelectedFilter","filterOption","doFilter","$doCheck","previousValues","previousFilterValues","currentValues","equalLengthsNotSameContent","onFilter","FilterTagCtrl","tagService","selectedTags","currentTag","updateValues","projectItem","filterProject","addTag","tag","deleteTag","selectedTag","projectTag","originalProject","filterTypeOptions","sortPropertiesOptions","filterTarget","InputFieldCtrl","pagingValues","currentPage","PaginatorCtrl","createPages","pagerOptions","pageSizeSelectorText","pagesizes","showPageSizeSelector","showFirstButton","enableFirstButton","showPreviousButton","enablePreviousButton","showNextButton","enableNextButton","showLastButton","enableLastButton","onFirstPage","_elem","_args","resetCurrentPage","onPreviousPage","pageNumber","onNextPage","nextPage","onLastPage","pages","updateButtons","onPageSizeChange","getPagerElement","pager","currentList","previousList","page","pagingTarget","pageIndex","last","tagsOverflowed","checkOverflow","tagContainerElement","moreTagInit","popoverOptions","popover","placement","extraClass","sortOptions","sortValues","SortPopupmenuCtrl","OrderEnum","sortOrderTypes","sortOn","bindingSortValues","currentSelected","currentSelectedSortOrder","doSort","sortOption","onSort","onSortOrder","DESCENDING","ASCENDING","availableTags","availableTagNames","initAvailableTags","initSearchFieldEvent","changeObject","getAvailableTag","getNewTag","onKeyPressed","inforOwned","FALSE","tagName","availableTag","onSaveTags","$tags","TextareaFieldCtrl","autoGrow","autoGrowAnimate","aboutComponent","about","modalData","applicationMenu","arrangeElement","arrange","xiArrange","childNodes","$watchCollection","autocomplete","autoCompleteData","delay","busyDelay","transparentOverlay","busyindicator","isRunning","busyData","require","ngModel","selectedColor","colorpicker","setColor","functionName","expandablearea","accordion","ex","exc","datepicker","modelWatcher","disabledWatcher","setDisplayedValues","modelAttr","disabledAttr","ngDisabled","editorData","fileupload","fileUploadData","thousands","String","mustComplete","showCurrency","maskData","multiselect","multiSelectApi","tooltipData","popupmenu","popupMenuData","searchfield","searchFieldData","slider","sliderData","spinbox","spinBoxData","modalId","resize","tabToSelect","tabData","textareaApi","textarea","textAreaData","timepicker","timePickerData","toolbarData","isInstantiated","xiTooltip","disabledTooltip","trackdirty","doc","mapObject","lookupRef","mapFunc","newProp","k","upperPropName","firstMatch","restOfPath","ComponentCommonCtrl","$controller","componentDestroyed","controllerExists","controllerName","editorControllerName","outerHTML","empty","commonPart","themes","updateSettings","showTitlebar","showThemeSwitch","changeCanvasTheme","TitlebarCtrl","userDisplayName","fromJson","RepositoryDirective","DatasourceUpsertDialogCtrl","DatasourceParameterComponent","EditUrlDialogCtrl","JsonpathHelpDialogCtrl","RequestEditorDialogCtrl","RequestHeaderEditorComponent","ResourceUrlEditorComponent","SwaggerSchemaExpanderComponent","ViewJsonDialogCtrl","LocalIdoSearchCtrl","LocalIdoDataserviceWizardCtrl","LocalIdoDataserviceParametersComponent","LocalIdoDataserviceSummaryDatagridComponent","InlineListDataserviceWizardCtrl","AddNewColumnDialogCtrl","DeleteColumnDialogCtrl","InlineListDataserviceSummaryDatagridComponent","CompositeTabComponent","IdoTabComponent","IdoPropertyComponent","IdoPropertyDatagridComponent","PreviewCtrl","RepositoryTabEnum","tabEnum","setCanNavigateBack","navigateBack","canNavigateBack","fromEditor","reloadProject","currentView","RepositoryCtrl","setCacheObject","invalidParameters","requiredParameters","matrixPath","privateErrorList","isInputPriv","bindingDatasourceParameters","wizardNextDisabled","headTitle","parameterTypes","datasourceParameters","$datasource","isUrlComponent","getParameterTypeName","dataPair","onDeleteDatasourceParameter","deleteParameter","updateRestPath","updateRestMatrixPath","updateRestQueryPath","onAddDatasourceParameter","getNewName","isPathParameter","getNextParamName","baseName","elementMatch","lastElement","newQueryPath","onUpdateResourceUrl","oldItem","datasourceResourceUrl","foundMatch","isAliasUnique","checkAlias","DatasourceParameterCtrl","isInitialValid","hasError","editMode","validateCell","newParameter","Text","updateDataset","createDatagridColumns","headerObject","_parsedHeaders","isValidParsedHeaders","keyValuePair","indexOfFirstColon","parseHeader","parsedHeaders","keyValue","validHeaderRequestRow","isNextDisabled","hasInvalid","onEdit","RequestHeaderEditorCtrl","componentRoot","datasourceRestUrl","ResourceUrlEditorCtrl","onEditDatasourceUrl","newParameters","existingIndex","existingParameter","existingParameters","schemaString","sampleString","resetEnabled","rootElementInvalid","isModified","schemaHasError","sampleHasError","parsedSchema","sampleError","parsedSample","onChangeRootElement","refreshSchema","validForm","datasourceTypeEnum","buttonTitle","datasourceType","saveable","hasNameConflict","removeDisabledFields","HEAD","upsertDatasource","getIndentationStyle","getExpandedStyle","toggleExpanded","schemaIsObject","schemaIsArray","schemaIsPrimitive","isNumber","isBoolean","isString","isInteger","isNull","schemaName","idoProperties","dataserviceParameters","setRequiredParameters","setPrimaryParameters","LocalIdoDataserviceParametersCtrl","initDatagridEvent","initDatagridSelectedEvent","setSelectedRows","rowsToSelect","addToSelect","selectRows","findRowsByValue","selectedDatagridItems","onSelectedEvent","newDataserviceParameters","getSelectedDataserviceParameters","addedDataserviceParameters","newDataserviceParameter","addedOutputParameter","requiredFirst","idoProperty","keySequence","indeterminate","isRowDisabled","LocalIdoDataserviceSummaryDatagridCtrl","LOAD","UPDATE","operationList","IdoOperations","recordCapOptions","DEFAULT_ORDER","initEditDataServiceDialog","idoCollection","selectedOperation","selectedRecordCapOption","loadIdoCollectionProperties","idoPropertyOptions","addItemID","setIdoOperation","previousMethod","hasItemID","hasRowPointer","propertyType","isReadOnly","currentShownIdName","onToggleParameterSetting","addRequiredParameters","addPrimaryParameters","localIdoDataservice","datagridItem","getValueType","datatype","DATE","onOperationChange","onRecordCapChange","optionId","idName","toggleParameterSettings","eirLocalIdoDataserviceElement","slideToggle","textElement","preliminaryDataservice","getTestDialogType","serverDesc","accessAs","cachedOperationProperties","importComposites","compositeComponentsToImport","compositesToAdd","deleteComposites","addComposites","composites","addedCompositeComponents","compositeComponentsToValidate","CompositeTabCtrl","dataTypes","isValidPropertyName","isValidNumber","isValidPropertyLength","onChangeDataType","clearOptions","tempDecimalLength","clearPropertyError","setSqlDataType","onPrimaryKeyChange","sqlDataType","IdoPropertyCtrl","includeDefaultProperties","setIdoDefaultProperties","datasetToDisplay","defaultIdoProperties","BaseDatagridCtrl","IdoPropertyDatagridCtrl","BaseDatagridComponent","onChangesObject","getDatagridApi","toolbarOptions","rightAligned","maxVisibleButtons","collectionProperties","loadIDOs","idoCollections","collectionData","today","collectionDesc","idoDescription","createDate","removeDeleted","ido","namesString","failedItems","successfulItems","IdoTabCtrl","columnNames","saveForm","initDatagrid","_event","gridApi","addRow","updateNextDisabled","outputParams","selectedColumn","initOnEdit","frozenColumns","gridOptions","summaryDatagridOptions","InlineListDataserviceSummaryDatagridCtrl","AppLauncher","RuntimeCanvasDirective","runtimeService","windowResizeHandler","initProjectUrlVariables","$onDestroy","runtimeManifest","myList","getCanvasWidth","deferredError","windowResizeTimerPromise","FIFTY","loadApplication","RuntimeCanvasCtrl","hasDatasource","onAddDialog","ADD","onEditDialog","emptyContent","onDialogResult","contents","getDatasets","ChartContentSettingsCtrl","availableChartTypes","Radar","getAnimationEnabled","hasNoAnimation","animationCheckboxDisabled","onChangeValue","settingsMeta","ChartStyleSettingsCtrl","DatagridContentSettingsDirective","newDatagrid","DatagridContentSettingsCtrl","eirDatagridContentSettingsCtrl","updateTemplateComponent","settingTemplate","onChangeTemplate","ListStyleSettingsCtrl","LookupContentSettingsDirective","lookupSettings","setLookupOutputOptions","updateLookupColumns","lookupOutputSetting","fieldSetting","lookupApi","LookupContentSettingsCtrl","eirLookupContentSettingsCtrl","RadioButtonContentSettingsDirective","newRadioButton","componentRadioButton","getComponentRadioButton","addRadioButton","radiobuttonIds","editRadioButton","updateRadioButton","deleteRadioButton","deletedRadioButton","disableDelete","editedRadioButton","RadioButtonContentSettingsCtrl","TabsContentSettingsDirective","newTabs","getComponentTabs","openTab","chosenTab","openEditTabDialog","tabResult","TabsContentSettingsCtrl","initiationMaskProcess","openMaskSettings","onChangeProcess","settingMask","TextboxStyleSettingsCtrl","$stateService","viewState","TILE","searchString","filterEnum","filterContainer","selectedProjects","finishedLoadingProjects","ONE_THOUSAND","dashboardLoading","Expander","rows","expandableRow","onExpandRow","rowTemplate","tagElement","publishProject","deleteProjects","unSelectAllRows","DashboardCtrl","oldName","DONOTHING","importTitle","allProjectsToolbar","setState","CREATE","importProjectFile","replaceOption","importedProject","onLoadProjects","validateData","handleImportError","importIdConflict","conflictingManifest","importDisplayName","importDisplayNameConflict","conflictedManifest","onSearch","_index","pixel","HALF","showImportProjectErrorMessage","reasonMessage","isProjectChanged","deleteProject","onStartEditProjectName","editingManifest","editingManifestOldDisplayName","onDoneEditProjectName","isProjectDisplayNameEditMode","onKeyUpEvent","onAbortEditProjectName","newProjectBinding","projectDescription","templateNumber","selectTemplate","newProject","showCreateProjectErrorMessage","newProjectDatabearer","prepareNewProject","newProjectDefinition","headerTranslations","newIDs","TWO","generateIds","buildTemplate","THREE","FOUR","SIX","SEVEN","EIGHT","NINE","ELEVEN","THIRTEEN","numberOfCells","cells","numberOfIds","watchChange","setLabel","showLabelEmpty","ComponentValueController","attribute","originalComponentDirective","canvasStyle","initUnsubscribers","openProject","initCanvas","getCanvasStyle","updateCanvas","newMode","backgroundImage","compileComponent","renderComponentsTimeout","newScope","onComponentDestroyed","CanvasCtrl","initDraggable","positionCanvasResizer","dragCanvasWidth","ui","drag","start","containment","scroll","snap","addBoundaryMarker","showStandardBoundariesDialog","oldBoundaryIds","addedboundaries","notAddedBoundaries","standardBoundary","projectBoundary","standardBoundariesDialogResult","onMaxBoundariesReached","CanvasSliderCtrl","getAvailableBindings","currentSourceAlias","setSourceName","aliasElement","new","addError","old","removeError","onChangeAlias","aliases","oldAlias","newAlias","changeSourceAlias","onBuildLink","onRemoveSource","removeSource","addSourceValue","UrlSourceFieldCtrl","showEditor","resetProjectState","rootContainer","EditorCtrl","designerElement","selectedNewComponent","selectDrag","bodyClickListener","unsubscriber","selectClick","resetToSelectionMode","componentSettingsClass","NewComponentCtrl","compositeComponentManagementService","selectedManifest","compositeComponentManifests","createComposite","deleteComposite","getCompositeComponentById","redirectInteraction","redirectExpression","addedInteractions","interactionCopy","expressionCopy","NewCompositeCtrl","NewComponentTabsCtrl","initBoundaryDraggable","onCurrentProjectChanged","TWO_HUNDRED","convertOldStandardBoundariesToNormalBoundaries","boundaryClick","isSingleClick","selectBoundary","boundaryDblClick","boundaryMarkerEditor","toggleDefaultBoundary","helper","oldOffsetX","round","setBoundaryMarker","contains","textContent","deleteBoundaryMarker","RulerCtrl","max","hotkeyService","isComponentNameEditMode","actionKeys","COMPOSITE","setOrientationIcon","flexOrientation","updateOrientationMenuVisibility","setSelectionBoxOptions","isLayoutComponentWithNoDataservice","keyHandler","componentNameForm","$rollbackViewValue","updateSize","contextActions","checkOrientationOnFlexbox","actionMethod","changeOrientation","submenu","isFlexboxWithFlexChildren","disabled","getSelectionOptionDisabledStatus","checkPopupPosition","menuElement","popupElement","showOrientationAction","getContextAction","actionItem","onBlur","onDoubleClick","SelectionBoxCtrl","updateStatusbar","updateSave","isApplicationComponent","applicationParent","outValue","currentTime","toTimeString","saveUpdate","isApplication","StatusbarCtrl","OverlayStateEnum","hotKeyService","overlayState","overlayStateEnum","isRuntime","initiateSubscribers","openExpressions","titlebarChanged","updateStringHeader","selectedIsChanged","newString","subscribers","FINDER_OVERLAY","OVERLAY","hasClipboardComponent","updateSaveState","saveBase","BASE","changeLanguage","toggleRuntimeMode","reload","showProjectSettings","showKeyboardShortcuts","keydialog","saveError","screenshotCanvas","displayClipboardName","typeDefClipboard","showClipboard","openNewComponent","showSidebar","openSettings","openUrlSettings","isUndoActionAvailable","isRedoActionAvailable","projectSaveState","TopbarCtrl","transclude","settingIncludeDatasources","settingIncludeInteractions","settingIncludeTranslations","settingIncludeExpressions","settingIncludeBoundaries","onComponentSelected","onChangeCompositeName","settingCompositeName","datasourceIds","getComponentIdBySourceId","componentExpressions","discardOutOfReachBindings","valueName","newCompositeComponent","defaultBoundarySettings","settingTitle","borderType","INDIVIDUAL","borderAllValue","onChangeBorderType","onChangeBorder","checkForNull","setBorderValues","register","BorderSettingsCtrl","CheckboxSettingsCtrl","isColorPicker","initColorpicker","DropdownSettingsCtrl","marginType","marginAllValue","onChangeMarginType","onChangeMargin","setMarginValues","MarginSettingsCtrl","radioSetting","RadiobuttonSettingsCtrl","isSwitched","SwitchSettingsCtrl","textSetting","TextSettingsCtrl","bindableFieldDefinitions","bField","AttributeSettingsCtrl","addComponentSettingsSwitches","contentSettingsTemplate","styleSettingsTemplate","contentSettingDirectiveName","styleSettingDirectiveName","commonContentSettingsTemplate","commonStyleSettingsTemplate","filteredValue","createBindings","expandableSetting","onSave","targetFieldMetadata","onSourceChanged","settingStaticValue","onStaticValueChanged","initInputElement","inputElement","$saveTranslations","resetSources","settingSource","settingSourceField","unregisterPossibleBindings","okButton","isNil","createSettingSource","targetContextComponent","bindingType","setSettingSource","bindingValueValid","setAvailableBindings","setSelectedBinding","updateBinding","updatePreviewValue","setAvailableBindingsByComponentMetaData","onSourceFieldChanged","updateCurrentSource","onUrlValueChanged","myUrlVariable","urlVariable","updateBindingValues","openUrlDialog","newSourceField","oldSourceKey","isUrlBinding","setTranslation","trimmedValue","checkGlobalValue","createNewString","parentListComponent","editBinding","buttonOK","isValueChanged","ValuesourceSettingsCtrl","WizardTick","WizardStates","maxTick","initializeUnsubscribers","dialogElement","parents","distance","exitWizard","gotoWizardTick","currentTick","updateDisabled","stepNumber","setWizardTick","tickNumber","TRIGGER_EVENT","checkWizardStates","ACTION","DATA_MAPPING","refreshDataMappingSummaryItems","CLOSE_WIZARD","isSummaryPage","SOURCE_COMPONENT","FOCUSED","TARGET_COMPONENT","RESTING","makeDataMappingSummaryItems","summaryItems","dataMappingSummaryItems","promisedSummaryItems","makeDataMappingSummaryItem","makeStaticDataMappingSummaryItem","makeComponentBindingDataMappingSummaryItem","makeContextBindingDataMappingSummaryItem","targetField","sourceContext","isAddAvailable","metadataLoading","onInteractionTargetActionChanged","onNewInteractionSelected","getUnusedParameters","availableTargetFields","availableTargetField","foundParameter","createParameter","userNote","onChangeTargetField","checkForMandatoryParameter","parametersList","newTarget","sourceComponentInAvailableSources","availableSource","newParameterInstance","ParameterCtrl","DeveloperToolCtrl","isDeveloper","isIonProxyActive","removeItem","filterAcceptanceTestItems","acceptanceTestProjectIdList","dataservices","acceptanceTestDataserviceIdList","progressApi","progress","loadCurrentProjectDatabearer","deleteAllAcceptanceTestProjects","isProcessing","processed","update","deleteAllAcceptanceTestDataservices","onEnableIonProxy","onLaunchAppWithAngular","saveSetting","setSize","unparsedDateValue","dataserviceMetadata","newValueSource","dropdownDatabearer","newvalueSource","registerSourceBindings","newCustom","editCustom","customComponentId","deleteCustom","updateDialogUi","getCustomComponents","newBindable","bindableFields","splitCSV","customComponents","scDefsIds","getAvailableSources","updateAlias","oldSourceAlias","oldAliasExists","newSourceAlias","myLink","addSource","newSourceName","newNumber","newTypeValue","indexToRemove","initSelectEvent","selectedFields","rowItems","availableTextPlacement","BEFORE","AFTER","availableAlignment","LEFT","RIGHT","columnFormatters","BASIC","HYPERLINK","accordionApiList","setAvailableDataservices","initSourceFields","setColumn","initSelectedListSource","initSelectedSubstitutionSource","isDataGrid","initAccordionElements","availableDataservices","selectedSubstituteSource","substituteSourceOutputParameters","selectedParameter","selectedFromSubstituteOutput","selectedToSubstituteOutput","setSelectedSubstitutionSource","selectedFormatter","selectedSourceField","selectedListSource","listSourceOutputParameters","selectedListOutput","updateSubstitute","toggleSubstitution","onSelectColumnFormatter","setSelectedListOutput","setSelectedListSource","openLinkDialog","cleanColumn","toggleSummaryRow","onSelectColumnOption","Editable","Resizable","Sortable","getColumnOptions","supportedOption","onFieldSelected","closeDropdown","availableComponents","getAvailableComponents","setOperators","setAvailableSourceFields","setAvailableTargetFields","operators","onTargetFieldChanged","setCurrentBinding","filterSources","removedComposites","openMapper","dataserviceIds","getDataserviceIdsToRemove","dataserviceToRemove","removeInteractionsConnectedWithDataservice","removedDatasources","idToDelete","selectedDataserviceIds","getComponentsUsingDataservice","idsToRemove","componentsUsingDataservice","promptConfirmWhenDataserviceUsed","numberOfComponentsUsedIn","createLocalDatasource","populateUserInformation","isNew","changedBy","changedByDisplayName","changedDate","addToProject","isDeleteDisabled","fields","onChangeTabName","AVAILABLE_FORMATS","maskSetting","onChangeMask","openMaskHelp","TranslationTabEnum","usedLanguages","deletedLanguages","addedLanguages","isChanged","invalidPositions","validPositions","selectedFilterLanguage","originalComponent","initComponentGridOptions","buildGlobalDataset","initGlobalGridOptions","selectedGlobalLocale","currentLanguageDisplayName","saveToProject","openLanguage","reloadGlobalStringDatagrid","toggleAllTranslations","reloadComponentDatagrid","filterLanguage","localeKey","usedLanguage","deletedLanguage","updateLanguageLists","isExpanded","addNewString","alreadyAddedItem","globalDataset","globalDatagridOptions","saveString","deleteGlobalString","deletedString","selectedGlobalString","deleteStringFromDataset","addedLanguage","datasetIndex","componentDatagridOptions","filteredDataset","filterDatasetOnLocale","modifiedString","cellElement","tagExistsOld","tagExistsNew","existsInArray","updatedInvalids","updateSaveButton","invalidPosition","saveButtonElement","errorTextElement","updatedLanguage","firstLanguageList","secondLanguageList","ScopeInfo","ScopeType","hidden","syncDataset","updateTranslationChange","correctComponent","correctProperty","datagridArgs","existingValue","tagsChanged","newTags","originalManifest","rootId","exception","errorOnSave","settingLimitX","getNewLimitX","parsedNumber","initQuestionsData","selectedQuestion","projectQuestions","datasetQuestion","getTypeName","questionSetting","availableTypes","availableComponentSettings","getAvailableComponentSettings","getType","typeName","onTypeChange","availableSettings","prettyPrint","word","newVariable","newDescription","saveDisabled","oldVariables","updateSaveDisabled","addVariable","clearInput","removeVariable","oldVariable","saveVariables","isNameUnique","upgrade","ngDoBootstrap","bootstrap","NgModule","imports","BrowserModule","UpgradeModule","UIRouterUpgradeModule","forRoot","states","AppLauncherModule","declarations","entryComponents","CommonModule","ComponentsModule","AppLauncherComponent","RuntimeCanvasComponent","ngOnChanges","projectIdChanges","IWidgetSize","_app","widgetSize","currentBrowserWidth","app","APPLICATION_PARENT_DATABEARER","createSpoofElement","HttpClientModule","FormsModule","SohoComponentsModule","ChildrenComponentContainer","ComponentContainer","TitlebarComponent","RemoveHostDirective","providers","firstChild","insertBefore","Directive","EventEmitter","parentChildren","numberOfChildren","emit","ILayoutComponent","Output","totalChildren","setComponentContainerProperties","attachComponent","newComponentChange","setAttachedComponentProperties","IJsonComponent","IContext","ViewContainerRef","HostBinding","personalize","queryList","onChangeTheme","IJsonDesignerManifest","ViewChildren","SohoPersonalizeDirective","QueryList"],"mappings":"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N,UA7BA,GAAa,QAAA3B,sB,iMC7nBb,wBAMC,kBAAmBvuB,OAAA,KAAAA,YAEpB,OAPe,SAAAmwB,OAAS,IAAIC,SAAS,UACtB,SAAAC,UAAY,IAAID,SAAS,aACzB,SAAAxqB,WAAa,IAAIwqB,SAAS,cAC1B,SAAAlqB,MAAQ,IAAIkqB,SAAS,SAIpC,SARA,GAAa,QAAAA,kBAUb,SAAYlN,aACX,iDACA,qCACA,0CACA,0CACA,wCACA,sCACA,0CACA,kDACA,4CACA,0CACA,8CACA,kDACA,sCACA,wCACA,oDACA,gDACA,sDACA,oDACA,4CACA,4CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,kDACA,oDACA,4CACA,gDACA,gDACA,gDACA,gDACA,iDACA,iDACA,iDACA,iDACA,iDACA,iDACA,iDACA,uCACA,iDACA,+CACA,6CACA,qCACA,qCACA,qCACA,qCACA,qCACA,qCACA,qCACA,qCACA,qCACA,uCACA,uCACA,uCACA,iDACA,uDACA,mDACA,6CACA,2CACA,yCACA,6CACA,2DACA,yDACA,yDACA,qDACA,2DACA,yDACA,mDApGD,CAAY,QAAAA,cAAA,QAAAA,YAAW,M,6PCjBvB,uDACA,2CAEA,yCAUA,4CACA,wBA8BA,yBAEA,sCAIA,yCAEA,yBACA,qCACA,yCAMA,iCAEA,yBACA,yBAEA,sCAKA,yBACA,sCAEA,wBACA,yBACA,yBACA,yBACA,yBAEA,kDACA,oCACA,mCACA,gCACA,kCACA,uCACA,qCAEA,yBAkEC,uBACSlG,GACAsT,YACAC,gBACAC,iBACAC,yBACAC,YACAC,eAPT,eACS,KAAA3T,MACA,KAAAsT,wBACA,KAAAC,gCACA,KAAAC,kCACA,KAAAC,kDACA,KAAAC,wBACA,KAAAC,4BAvEF,KAAAC,wBAA0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","file":"designer.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t3: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"scripts/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([581,8,9,1,6,0,2,4,5,7,10]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\n\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport type { IGridUser } from \"ng2/common/model/environment-settings.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IMingleLanguage, IMongooseString } from \"ng2/common/model/language.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nexport enum CanvasModeEnum { RUNTIME, SELECTION, INSERT, FINDER, WIZARD }\r\nexport enum AppStatus { OFFLINE, ONLINE }\r\nexport enum DashboardStates { LIST, CREATE }\r\nexport enum DashboardViewStates { TILE , GRID }\r\nexport enum ReplaceEnum { DONOTHING, OVERWRITE, COPYNEW }\r\nexport const availableDatasourceTypes = [\r\n\t{ name: \"IDM\", value: DatasourceTypeEnum.IDM },\r\n\t{ name: \"M3\", value: DatasourceTypeEnum.M3 },\r\n\t{ name: \"MONGOOSE\", value: DatasourceTypeEnum.MONGOOSE },\r\n\t{ name: \"Generic\", value: DatasourceTypeEnum.generic },\r\n\t{ name: \"Static List\", value: DatasourceTypeEnum.INLINE_LIST }\r\n];\r\n\r\nexport class IdoProperties {\r\n\tstatic ITEM_ID = \"ItemID\";\r\n\tstatic RECORD_DATE = \"RecordDate\";\r\n\tstatic ROW_POINTER = \"RowPointer\";\r\n}\r\n\r\nexport enum BuildEnvTypes {\r\n\tDEV = \"DEV\",\r\n\tPROD = \"PROD\",\r\n\tCI = \"CI\"\r\n}\r\nexport type BuildEnvType = BuildEnvTypes.DEV | BuildEnvTypes.PROD | BuildEnvTypes.CI;\r\n\r\nexport enum AppEnvTypes {\r\n\tRUNTIME = \"RUNTIME\",\r\n\tDESIGNER = \"DESIGNER\",\r\n}\r\nexport type AppEnvType = AppEnvTypes.DESIGNER | AppEnvTypes.RUNTIME;\r\n\r\nexport enum ChartTypeEnum {\r\n\tArea = (\"Area\") as any,\r\n\tBar = (\"Bar\") as any,\r\n\tBarGrouped = (\"BarGrouped\") as any,\r\n\tBarStacked = (\"BarStacked\") as any,\r\n\tColumn = (\"Column\") as any,\r\n\tColumnGrouped  = (\"ColumnGrouped\") as any,\r\n\tColumnStacked = (\"ColumnStacked\") as any,\r\n\tDonut = (\"Donut\") as any,\r\n\tLine = (\"Line\") as any,\r\n\tPie = (\"Pie\") as any,\r\n\tRadar = (\"Radar\") as any,\r\n\tProfile = (\"Profile\") as any, // backwards compatibility, legacy type\r\n\tStackedLine = (\"StackedLine\") as any, // backwards compatibility, legacy type\r\n\tStackedColumn = (\"StackedColumn\") as any, // backwards compatibility, legacy type\r\n}\r\n\r\nexport enum Numbers {\r\n\tHALF = 0.5,\r\n\tZERO = 0,\r\n\tONE = 1,\r\n\tTWO = 2,\r\n\tTHREE = 3,\r\n\tFOUR = 4,\r\n\tFIVE = 5,\r\n\tSIX = 6,\r\n\tSEVEN = 7,\r\n\tTEN = 10,\r\n\tTWENTY = 20,\r\n\tTWENTYFIVE = 25,\r\n\tFIFTY = 50,\r\n\tSEVENTYFIVE = 75,\r\n\tHUNDRED = 100,\r\n\tTWO_HUNDRED = 200,\r\n\tTHREE_HUNDRED = 300,\r\n\tFOUR_HUNDRED = 400,\r\n\tSIX_HUNDRED = 600,\r\n\tONE_THOUSAND = 1000,\r\n\tFIVE_THOUSAND = 5000,\r\n\tMILLION = 1000000\r\n}\r\n\r\nexport enum ProjectLayout {\r\n\tONE = 1,\r\n\tTWO = 2,\r\n\tTHREE = 3,\r\n\tFOUR = 4,\r\n\tFIVE = 5,\r\n\tSIX = 6,\r\n\tSEVEN = 7,\r\n\tEIGHT = 8,\r\n\tNINE = 9,\r\n\tTEN = 10,\r\n\tELEVEN = 11,\r\n\tTWELVE = 12,\r\n\tTHIRTEEN = 13\r\n}\r\n\r\n/**\r\n * Enums for datagrid page sizes\r\n *\r\n * @export\r\n * @enum {number}\r\n */\r\nexport enum DatagridPageSizesEnum {\r\n\tOPTION1 = (Numbers.TEN) as any,\r\n\tOPTION2 = (Numbers.TWENTYFIVE) as any,\r\n\tOPTION3 = (Numbers.FIFTY) as any,\r\n\tOPTION4 = (Numbers.SEVENTYFIVE) as any,\r\n}\r\n\r\nexport enum ColumnFormatterType { BASIC, LIST, HYPERLINK }\r\n\r\nexport enum HorizontalAlignmentEnum { LEFT = 1, CENTER = 2, RIGHT = 3 }\r\nexport enum DirectionEnum { RIGHT = 1, LEFT = 2, UP = 3, DOWN = 4, AUTO = 5 }\r\n/**\r\n * TODO: Reorder or change values of the enums as it has an awkward sequence\r\n * Remember to also that these are stored in the DB and changing the values on\r\n * these will affect how the data from the DB is interpreted.\r\n */\r\nexport enum ThemeEnum {\r\n\tDEFAULT = 0,\r\n\tLIGHT = 1,\r\n\tDARK = 2,\r\n\tHIGH_CONTRAST = 3,\r\n\tLIGHT_TRANSPARENT = 4,\r\n\tDARK_TRANSPARENT = 5,\r\n}\r\nexport enum FlexSizeTypeEnum { PIXELS = 1, FLEX = 2 }\r\nexport enum FlexOverflowEnum { HIDDEN = 1, WRAP = 2, SCROLL = 3 }\r\nexport enum WizardFocusEnum { FOCUSED = 1, RESTING = 2, UNFOCUSED = 3 }\r\nexport enum AlignmentEnum { FLEX_START = 1, CENTER = 2, FLEX_END = 3 }\r\nexport enum SortEnum {\r\n\tSELECTED_SORT_ORDER,\r\n\tSELECTED_SORT_PROPERTY,\r\n\tFILTER_USER_NAME,\r\n\tFILTER_NAME,\r\n\tSORT_DEFINITION,\r\n\tFILTER_STATUS\r\n}\r\n\r\n// tslint:disable:no-magic-numbers\r\nexport enum SaveFlagsEnum {\r\n\tMANIFEST = (2 ** 0),\r\n\tCANVAS_COMPONENTS = (2 ** 1),\r\n\tINTERACTIONS = (2 ** 2),\r\n\tDATASOURCES = (2 ** 3),\r\n\tSCREENSHOT = (2 ** 4),\r\n\tCUSTOMCOMPONENTS = (2 ** 5),\r\n\tCOMPOSITE_COMPONENTS = (2 ** 6),\r\n\tTRANSLATIONS = (2 ** 7),\r\n\tTAGS = (2 ** 8),\r\n\tURL_VARIABLES = (2 ** 9),\r\n\tEXPRESSIONS = (2 ** 10),\r\n\tQUESTIONS = (2 ** 11),\r\n\tPROJECT = (\r\n\t\tMANIFEST +\r\n\t\tCANVAS_COMPONENTS +\r\n\t\tINTERACTIONS +\r\n\t\tDATASOURCES +\r\n\t\tCOMPOSITE_COMPONENTS +\r\n\t\tTRANSLATIONS +\r\n\t\tTAGS +\r\n\t\tURL_VARIABLES +\r\n\t\tEXPRESSIONS\r\n\t)\r\n}\r\n//tslint:enable:no-magic-numbers\r\n\r\nexport enum SaveProjectSettingEnum {\r\n\tINFO = 1,\r\n\tROLES = 2,\r\n\tALL = 3\r\n}\r\n\r\nexport enum MGPlatform {\r\n\tWEB = \"Web\",\r\n\tWIN_FORMS = \"WinForms\"\r\n}\r\n\r\nexport class DeveloperConstants {\r\n\tstatic readonly ION_PROXY = \"dev-ion-proxy\";\r\n\tstatic readonly ION_TOKEN = \"dev-ion-token\";\r\n\tstatic readonly LAUNCH_WITH_ANGULAR = \"dev-launch-with-angular\";\r\n}\r\n\r\nexport enum ProjectTypeEnum {\r\n\tAPP,\r\n\tBASE\r\n}\r\n\r\nexport class Config {\r\n\t/* APP_ROOT and REST_ROOT are set from common/module.ts, by running the method window.setContextRoots.\r\n\tBecause they need to be set before common and component modules are initialized,\r\n\tbut use different paths depending on builder or runtime. These are defaulted to empty string to detect errors */\r\n\tstatic APP_ROOT = \"\";\r\n\tstatic REST_ROOT = \"\";\r\n\tstatic APP_BUILDER_ROOT = \"/appbuilder/\";\r\n\tstatic APP_BUILDER_REST_ROOT = \"/appbuilderrest/\";\r\n\tstatic APP_RUNTIME_ROOT = \"/appruntime/\";\r\n\tstatic APP_RUNTIME_REST_ROOT = \"/appruntimerest/\";\r\n\tstatic ION_API_ROOT = \"/ionapi\";\r\n\tstatic ION_API_URL = \"\";\r\n\tstatic ION_API_TOKEN = localStorage.getItem(DeveloperConstants.ION_TOKEN);\r\n\tstatic ION_API_PROXY_PORT = \"8083\";\r\n\tstatic TENANT_ID = \"\";\r\n\tstatic IS_DEV = false;\r\n\tstatic IS_BASE_BUILDER = false;\r\n\tstatic IS_FIRST_LOAD = true;\r\n\r\n\tstatic IS_CONFIG_LOADED = false;\r\n\t//0 because it will get the real values from server.\r\n\tstatic MAX_PROJECTS = 0;\r\n\tstatic MAX_DATASOURCES = 0;\r\n\tstatic MAX_COMPOSITES = 0;\r\n\tstatic MAX_APPS = 0;\r\n\tstatic RUN_PATH = \"run/\";\r\n\tstatic RUN_ROOT = Config.APP_BUILDER_ROOT + Config.RUN_PATH;\r\n\tstatic RUN_RUNTIME_ROOT = Config.APP_RUNTIME_ROOT + Config.RUN_PATH;\r\n\tstatic USER: IGridUser;\r\n\tstatic LOCALE: string;\r\n\tstatic MG_FORM_NAME = \"\";\r\n\tstatic MG_FORM_ONLY = false;\r\n\tstatic MG_PLATFORM = \"\";\r\n\tstatic MG_CONFIG_NAME = \"\";\r\n\tstatic MG_HELP_BASE_URL = \"\";\r\n}\r\n\r\nexport class ServerPaths {\r\n\t// REST paths\r\n\tstatic readonly PROJECT = \"project/\";\r\n\tstatic readonly ADMINISTRATION = \"administration/\";\r\n\tstatic readonly RUNTIME = \"runtime/\";\r\n\tstatic readonly SETTINGS = \"settings/\";\r\n\tstatic readonly SWITCHABLE_FEATURES = \"switchableFeatures/\";\r\n\tstatic readonly REPOSITORY = \"repository/\";\r\n\tstatic readonly COMPOSITE_COMPONENTS = \"compositeComponents/\";\r\n\tstatic readonly DATASOURCES = \"datasources/\";\r\n\tstatic readonly IDO = \"ido/\";\r\n\tstatic readonly LOCAL_IDO = \"local-ido/\";\r\n\tstatic readonly DESIGNER = \"designer/\";\r\n\t// Application paths\r\n\tstatic readonly ADMIN = \"admin/\";\r\n}\r\n\r\nexport enum AppTypeEnum {\r\n\tADMIN_PREVIEW = \"ADMIN_PREVIEW\",\r\n\tRUNTIME = \"RUNTIME\",\r\n\tDESIGNER_PREVIEW = \"DESIGNER_PREVIEW\",\r\n\tAPPHUB = \"APPHUB\"\r\n}\r\n\r\nexport class SettingTypes {\r\n\tstatic SOURCE = \"wizard-source\";\r\n\tstatic TARGET = \"wizard-target\";\r\n}\r\n\r\nexport class BindingTypes {\r\n\tstatic STATIC = \"<static>\";\r\n\tstatic CONTEXT = \"<target>\";\r\n\tstatic URL = \"<url>\";\r\n}\r\n\r\nexport class EventTypes {\r\n\tstatic CLICK = \"click\";\r\n\tstatic DRAGEND = \"dragend\";\r\n\tstatic DRAGLEAVE = \"dragleave\";\r\n\tstatic DRAGOVER = \"dragover\";\r\n\tstatic DRAGSTART = \"dragstart\";\r\n\tstatic DROP = \"drop\";\r\n\tstatic KEYDOWN = \"keydown\";\r\n\tstatic KEYUP = \"keyup\";\r\n\tstatic MOUSEUP = \"mouseup\";\r\n}\r\n\r\nexport class CssConstantKeys {\r\n\tstatic DISPLAY = \"display\";\r\n\tstatic POINTER_EVENTS = \"pointer-events\";\r\n\tstatic CURSOR = \"cursor\";\r\n\tstatic BACKGROUND_COLOR = \"background-color\";\r\n}\r\n\r\nexport class CssConstantValues {\r\n\tstatic CURSOR_NODROP = \"no-drop\";\r\n\tstatic CURSOR_POINTER = \"pointer\";\r\n\tstatic AUTO = \"auto\";\r\n\tstatic NONE = \"none\";\r\n\tstatic INLINE_BLOCK = \"inline-block\";\r\n}\r\n\r\nexport class Operators {\r\n\tstatic EQUALS = \"=\";\r\n\tstatic NOT_EQUALS = \"<>\";\r\n\tstatic GREATER = \">\";\r\n\tstatic SAME_GREATER = \">=\";\r\n\tstatic LOWER = \"<\";\r\n\tstatic SAME_LOWER = \"<=\";\r\n\tstatic INCLUDES = \"*\";\r\n}\r\n\r\nexport class ConditionType {\r\n\tstatic ALL = \"all\";\r\n\tstatic DISABLE = \"disable\";\r\n\tstatic HIDE = \"hide\";\r\n}\r\n\r\nexport class InsertEventTypes {\r\n\tstatic MOVE = \"move\";\r\n\tstatic COPY = \"copy\";\r\n}\r\n\r\nexport class ComponentSizeTypes {\r\n\tstatic SMALL = \"small-component\";\r\n\tstatic LARGE = \"big-component\";\r\n}\r\n\r\nexport class ComponentConstants {\r\n\tstatic COPY_SUFFIX = \"_Copy\";\r\n}\r\n\r\nexport class OrientationTypes {\r\n\tstatic HORIZONTAL = \"Horizontal\";\r\n\tstatic VERTICAL = \"Vertical\";\r\n\tstatic PAGE = \"Page\";\r\n}\r\n\r\nexport class SidebarTabTypes {\r\n\tstatic CONTENT = \"content\";\r\n\tstatic INTERACTION = \"interaction\";\r\n\tstatic STYLE = \"style\";\r\n}\r\n\r\nexport class SettingInputKeys {\r\n\tstatic CHECKBOX = \"checkbox\";\r\n\tstatic DROPDOWN = \"dropdown\";\r\n\tstatic MARGIN = \"margin\";\r\n\tstatic BORDER = \"border\";\r\n\tstatic NUMBER = \"number\";\r\n\tstatic RADIO = \"radiobutton\";\r\n\tstatic SWITCH = \"switch\";\r\n\tstatic TEXT = \"text\";\r\n\tstatic COLOR_PICKER = \"color-picker\";\r\n}\r\n\r\nexport class InjectNames {\r\n\tstatic ADMINISTRATION_SERVICE = \"eirAdminisrationService\";\r\n\tstatic APP_ENV_CONSTANT = \"APP_ENV\";\r\n\tstatic BINDING_MANAGEMENT_SERVICE = \"eirBindingManagementService\";\r\n\tstatic BOUNDARY_MANAGEMENT_SERVICE = \"eirBoundaryManagementService\";\r\n\tstatic BUILD_ENV_CONSTANT = \"BUILD_ENV\";\r\n\tstatic COMMON_SERVICE = \"eirCommonService\";\r\n\tstatic COMPOSITE_COMPONENT_MANAGEMENT_SERVICE = \"eirCompositeComponentService\";\r\n\tstatic CONFLICT_RESOLUTION_SERVICE = \"eirConflictResolutionService\";\r\n\tstatic DATASOURCE_SERVICE = \"eirDatasourceService\";\r\n\tstatic DESIGNER_COMPONENT_SERVICE = \"eirFrameworkService\";\r\n\tstatic DESIGNER_SERVICE = \"eirDesignerService\";\r\n\tstatic DIALOG_SERVICE = \"eirDialogService\";\r\n\tstatic EDITOR_SERVICE = \"eirEditorService\";\r\n\tstatic EXPRESSION_SERVICE = \"eirExpressionService\";\r\n\tstatic FEATURE_SWITCH_SERVICE = \"eirFeatureSwitchService\";\r\n\tstatic FRAMEWORK_SERVICE = \"eirFrameworkService\";\r\n\tstatic HASH_SERVICE = \"eirHashService\";\r\n\tstatic HOTKEY_SERVICE = \"eirHotkeyService\";\r\n\tstatic HTTP_SERVICE = \"eirHttpService\";\r\n\tstatic HUB_SERVICE = \"eirHubService\";\r\n\tstatic INSERT_COMPONENT_SERVICE = \"eirInsertComponentService\";\r\n\tstatic INTERACTION_MANAGEMENT_SERVICE = \"eirInteractionManagementService\";\r\n\tstatic ION_API_SERVICE = \"eirIonApiService\";\r\n\tstatic ION_METADATA_SERVICE = \"eirIonMetadataService\";\r\n\tstatic LANGUAGE_SERVICE = \"eirLanguageService\";\r\n\tstatic LOCAL_IDO_SERVICE = \"eirLocalIdoService\";\r\n\tstatic MINGLE_SERVICE = \"eirMingleService\";\r\n\tstatic NO_CACHE_INTERCEPTOR = \"noCacheInterceptor\";\r\n\tstatic PROJECT_SERVICE = \"eirProjectService\";\r\n\tstatic REPOSITORY_SERVICE = \"eirRepositoryService\";\r\n\tstatic RUNTIME_SERVICE = \"eirRuntimeService\";\r\n\tstatic SAVE_SERVICE = \"eirSaveService\";\r\n\tstatic TAG_SERVICE = \"eirTagService\";\r\n\tstatic THEME_SERVICE = \"eirThemeService\";\r\n\tstatic TRANSLATION_MANAGEMENT_SERVICE = \"eirTranslationManagementService\";\r\n\tstatic UNDO_SERVICE = \"eirUndoService\";\r\n}\r\n\r\nexport class ProjectFileKeys {\r\n\tstatic ROOT_COMPONENT = \"rootcomponent\";\r\n\tstatic DATASOURCE = \"datasources\";\r\n\tstatic INTERACTION = \"interactions\";\r\n\tstatic CUSTOM_COMPONENT = \"customcomponents\";\r\n\tstatic COMPOSITE_COMPONENTS = \"compositecomponents\";\r\n\tstatic TRANSLATIONS = \"translations\";\r\n\r\n}\r\n\r\nexport class MimeTypes {\r\n\tstatic COMPONENT = \"component\";\r\n\tstatic DATASOURCE = \"datasources\";\r\n\tstatic INTERACTION = \"interactions\";\r\n\tstatic CUSTOM_COMPONENT = \"customcomponents\";\r\n\tstatic COMPOSITE_COMPONENTS = \"compositecomponents\";\r\n\tstatic TRANSLATIONS = \"translations\";\r\n}\r\n\r\nexport enum InteractionActionEnum {\r\n\tADD_TEXT = \"AddText\",\r\n\tDISABLE = \"Disable\",\r\n\tGET = \"Get\",\r\n\tLIST = \"List\",\r\n\tSET_CURRENT_ITEM = \"SetCurrentItem\",\r\n\tCLEAR = \"Clear\"\r\n}\r\n\r\nexport enum InteractionTriggerEnum {\r\n\tAPPLY = \"Apply\",\r\n\tBROADCAST = \"Broadcast\",\r\n\tBROWSE = \"Browse\",\r\n\tCLEAR = \"Clear\",\r\n\tCLICK = \"Click\",\r\n\tCHANGED = \"Changed\",\r\n\tCHECKED = \"IsChecked\",\r\n\tCLOSE = \"Close\",\r\n\tCREATE = \"Create\",\r\n\tCURRENT_ITEM_CHANGED = \"CurrentItemChanged\",\r\n\tCURRENT_ITEM_UPDATED = \"CurrentItemUpdated\",\r\n\tDELETE = \"Delete\",\r\n\tFILL_FORM = \"FillForm\",\r\n\tGO_TO_PAGE = \"GoToPage\",\r\n\tINITIALIZED = \"Initialized\",\r\n\tKEY_PRESS = \"KeyPress\",\r\n\tNEXT_PAGE = \"NextPage\",\r\n\tNONE = \"None\",\r\n\tON_LOAD = \"OnLoad\",\r\n\tON_COLUMN_UPDATED = \"OnColumnUpdated\",\r\n\tOPEN = \"Open\",\r\n\tPREV_PAGE = \"PrevPage\",\r\n\tREAD = \"Read\",\r\n\tRECEIVED = \"Received\",\r\n\tREFRESH = \"Refresh\",\r\n\tRIGHT_CLICK = \"RightClick\",\r\n\tRUNNING = \"Running\",\r\n\tSEND = \"Send\",\r\n\tSTARTUP = \"Startup\",\r\n\tTIME_RELAPSED = \"Elapsed\",\r\n\tTIMER_START = \"Start\",\r\n\tTIMER_STOP = \"Stop\",\r\n\tUNCHECKED = \"IsUnChecked\",\r\n\tUPDATE = \"Update\",\r\n\tUPDATE_COMPLETE = \"UpdateComplete\"\r\n}\r\n\r\nexport class ContextKeys {\r\n\tstatic DETAIL_RESULT = \"DetailResult\";\r\n\tstatic LIST_RESULT = \"ListResult\";\r\n}\r\n\r\nexport enum DirectionType {\r\n\tNONE = \"none\",\r\n\tBACK = \"back\",\r\n\tDIRECTIONAL = \"directional\"\r\n}\r\n\r\n// MUPS-1534: This is where we define ID:s for switched features\r\nexport enum FeatureIdEnum {\r\n\tShowFeatureCatalog = \"ShowFeatureCatalog\",\r\n\tTranslationService = \"TranslationService\"\r\n}\r\n\r\nexport const DEFAULT_BOUNDARY: IBoundary = {\r\n\tid: \"Default\",\r\n\tdisplayName: \"Default\",\r\n};\r\n\r\nexport class SettingKeys {\r\n\t// IJsonComponentSettings\r\n\tstatic readonly HEIGHT = \"height\";\r\n\tstatic readonly MARGIN = \"margin\";\r\n\tstatic readonly VISIBILITY = \"visibility\";\r\n\tstatic readonly WIDTH = \"width\";\r\n\tstatic readonly SHOW_ERROR = \"showError\";\r\n\t// IJsonFlexboxSettings\r\n\tstatic readonly SIZE = \"size\";\r\n\tstatic readonly SIZE_TYPE = \"sizeType\";\r\n\tstatic readonly ORIENTATION = \"orientation\";\r\n\tstatic readonly ALIGNMENT_HORIZONTAL = \"horizontalAlignment\";\r\n\tstatic readonly ALIGNMENT_VERTICAL = \"verticalAlignment\";\r\n\tstatic readonly OVERFLOW = \"overflow\";\r\n\t// IJsonListSettings\r\n\tstatic ITEM_TEMPLATE = \"itemTemplate\";\r\n\tstatic KEEP_SELECTED = \"keepSelected\";\r\n\tstatic readonly SEARCH = \"search\";\r\n\t// IJsonChartSettings\r\n\tstatic CHART_VIEW = \"chartView\";\r\n\tstatic readonly CHART_TYPE = \"chartType\";\r\n\tstatic readonly CHART_LEGEND_DISPLAY = \"legendDisplay\";\r\n\tstatic readonly CHART_STARTUP_ANIMATION_ENABLE = \"startupAnimationEnable\";\r\n\tstatic readonly CHART_TITLE = \"title\";\r\n\tstatic readonly CHART_AXIS_CATEGORY_TITLE = \"axisCategoryTitle\";\r\n\tstatic readonly CHART_AXIS_CATEGORY_UNITS = \"axisCategoryUnits\";\r\n\tstatic readonly CHART_AXIS_VALUES_TITLE = \"axisValuesTitle\";\r\n\tstatic readonly CHART_AXIS_VALUES_UNITS = \"axisValuesUnits\";\r\n\t// IJsonLookupSettings\r\n\tstatic readonly LOOKUP_OUTPUT_ID = \"lookupOutputId\";\r\n\t// IJsonTextAreaSettings\r\n\tstatic readonly IS_RESIZABLE = \"resizable\";\r\n\tstatic readonly MAX_LENGTH = \"maxLength\";\r\n\t// IJsonDatagridSettings\r\n\tstatic readonly ROW_HEIGHT = \"rowHeight\";\r\n\tstatic readonly USE_PAGING = \"usePaging\";\r\n\tstatic readonly PAGE_SIZE = \"pageSize\";\r\n\tstatic readonly SUMMARY_ROW = \"summaryRow\";\r\n\tstatic readonly ROW_COUNT = \"rowCount\";\r\n\tstatic readonly FILTER_BAR = \"filterBar\";\r\n\tstatic readonly ENABLE_EXPORT = \"enableExport\";\r\n\tstatic readonly ROW_COUNT_OUTPUT = \"rowCountOutput\";\r\n\tstatic readonly SUMMARY_OUTPUT = \"summaryOutput\";\r\n\t// IJsonDatepicker\r\n\tstatic readonly DATE_FORMAT_SHOW = \"dateFormatShow\";\r\n\tstatic readonly DATE_FORMAT_BINDING = \"dateFormatBinding\";\r\n\tstatic readonly DATE_FORMAT_INPUT = \"dateFormatInput\";\r\n\tstatic readonly DATE_FORMATTED = \"dateFormatted\";\r\n\tstatic readonly DATE_VALUE = \"dateValue\";\r\n\tstatic readonly DATE_TODAY = \"isDefaultTodayDate\";\r\n\t//TextBox\r\n\tstatic readonly BOX_WIDTH = \"boxWidth\";\r\n\t//IJsonTimepicker\r\n\tstatic readonly TIME_FORMAT = \"timeFormat\";\r\n\tstatic readonly ENABLE_SECONDS = \"enableSeconds\";\r\n\tstatic readonly TIME_VALUE = \"timeValue\";\r\n\r\n\t// ApplicationParent\r\n\tstatic readonly LANGUAGE = \"language\";\r\n\tstatic readonly LANGUAGE_SHORT = \"languageShort\";\r\n\tstatic readonly USER_NAME = \"userName\";\r\n\tstatic readonly USER_DESCRIPTION = \"userDescription\";\r\n\tstatic readonly TIMESTAMP = \"timestamp\";\r\n\tstatic readonly APPLICATION_HEADER = \"applicationHeader\";\r\n\r\n\t//Settings\r\n\tstatic readonly BACKGROUND_COLOR = \"backgroundColor\";\r\n\tstatic readonly BORDER = \"border\";\r\n\tstatic readonly BORDER_COLOR = \"borderColor\";\r\n\tstatic readonly CHECK_STATE = \"checkboxState\";\r\n\tstatic readonly COLOR = \"color\";\r\n\tstatic readonly CONTENT = \"content\";\r\n\tstatic readonly CURRENT_ITEM = \"currentItem\";\r\n\tstatic readonly CURRENT_ITEM_NAME = \"currentItemName\";\r\n\tstatic readonly CURRENT_ITEM_VALUE = \"currentItemValue\";\r\n\tstatic readonly DISPLAY_VALUE = \"displayValue\";\r\n\tstatic readonly DIRECTION = \"direction\";\r\n\tstatic readonly FONT_STYLE = \"fontStyle\";\r\n\tstatic readonly FONT_CHAR = \"fontChar\";\r\n\tstatic readonly IS_DEFAULT = \"isDefault\";\r\n\tstatic readonly IS_DRILLBACK = \"isDrillback\";\r\n\tstatic readonly IS_LIST = \"isList\";\r\n\tstatic readonly IS_READONLY = \"isReadonly\";\r\n\tstatic readonly LABEL = \"label\";\r\n\tstatic readonly LINK_VALUE = \"link\";\r\n\tstatic readonly MULTI_SELECT = \"multiSelect\";\r\n\tstatic readonly PLACEHOLDER = \"placeholder\";\r\n\tstatic readonly POSITION = \"position\";\r\n\tstatic readonly SELECTED_ITEM = \"selectedItem\";\r\n\r\n\tstatic readonly DIRTY_ITEMS = \"dirtyItems\";\r\n\tstatic readonly SHOW_LABEL = \"showLabel\";\r\n\tstatic readonly SOURCE = \"source\";\r\n\tstatic readonly STYLE = \"style\";\r\n\tstatic readonly TEXT = \"text\";\r\n\tstatic readonly TOOLTIP = \"toolTip\";\r\n}\r\n\r\nexport class DateFormat {\r\n\tstatic FORMAT_1 = \"MM/dd/yyyy\";\r\n\tstatic FORMAT_2 = \"yyyy/MM/dd\";\r\n\tstatic FORMAT_3 = \"dd-MM-yyyy\";\r\n\tstatic FORMAT_4 = \"dd/MM/yyyy hh:mm\";\r\n\tstatic ISO8601 = \"yyyy-MM-dd\";\r\n\tstatic M3 = \"yyyyMMdd\";\r\n\tstatic AUTOMATIC = \"AUTO\";\r\n\tstatic RAW = \"RAW\";\r\n}\r\n\r\nexport class LanguageConsts {\r\n\t/*static UNSUPPORTED_LANGUAGES = [\r\n\t\t\"ar-SA\",\r\n\t\t\"he-IL\",\r\n\t\t\"zh-TW\",\r\n\t\t\"pt-BR\"\r\n\t];*/\r\n\r\n\tstatic readonly SUPPORTED_LANGUAGES = [\r\n\t\t{ key: \"ar-SA\", value: \"Arabic (Saudi Arabia)\" },\r\n\t\t{ key: \"zh-CN\", value: \"Chinese (S)\" },\r\n\t\t{ key: \"zh-TW\", value: \"Chinese (T)\" },\r\n\t\t{ key: \"cs-CZ\", value: \"Czech (Czech Republic)\" },\r\n\t\t{ key: \"da-DK\", value: \"Danish (Denmark)\" },\r\n\t\t{ key: \"nl-NL\", value: \"Dutch (Netherlands)\" },\r\n\t\t{ key: \"en-US\", value: \"English (United States)\" },\r\n\t\t{ key: \"fi-FI\", value: \"Finnish (Finland)\" },\r\n\t\t{ key: \"fr-FR\", value: \"French (France)\" },\r\n\t\t{ key: \"de-DE\", value: \"German (Germany)\" },\r\n\t\t{ key: \"he-IL\", value: \"Hebrew (Israel)\" },\r\n\t\t{ key: \"hu-HU\", value: \"Hungarian (Hungary)\" },\r\n\t\t{ key: \"it-IT\", value: \"Italian (Italy)\" },\r\n\t\t{ key: \"ja-JP\", value: \"Japanese (Japan)\" },\r\n\t\t{ key: \"nb-NO\", value: \"Norwegian (Norway)\" },\r\n\t\t{ key: \"pl-PL\", value: \"Polish (Poland)\" },\r\n\t\t{ key: \"pt-BR\", value: \"Portuguese (Brazil)\" },\r\n\t\t{ key: \"ru-RU\", value: \"Russian (Russia)\" },\r\n\t\t{ key: \"es-ES\", value: \"Spanish (Spain)\" },\r\n\t\t{ key: \"sv-SE\", value: \"Swedish (Sweden)\" },\r\n\t\t{ key: \"th-TH\", value: \"Thai (Thailand)\" },\r\n\t\t{ key: \"tr-TR\", value: \"Turkish (Turkey)\" },\r\n\t\t{ key: \"vi-VN\", value: \"Vietnamese (Vietnam)\" },\r\n\t\t{ key: \"el-GR\", value: \"Greek (Greece)\" },\r\n\t\t{ key: \"af-ZA\", value: \"Afrikaans (South Africa)\" },\r\n\t\t{ key: \"pt-PT\", value: \"Portuguese (Portugal)\" },\r\n\t\t{ key: \"uk-UA\", value: \"Ukrainian (Ukraine)\" }\r\n\t] as IMingleLanguage[];\r\n\r\n\t//tslint:disable:no-magic-numbers\r\n\tstatic DEFAULT = LanguageConsts.SUPPORTED_LANGUAGES[6] as IMingleLanguage;\r\n\t//tslint:enable:no-magic-numbers\r\n}\r\n\r\nexport class MinInterval {\r\n\tstatic ONE = 1;\r\n\tstatic FIVE = 5;\r\n\tstatic TEN = 10;\r\n\tstatic FIFTEEN = 15;\r\n}\r\n\r\nexport class HourMode {\r\n\tstatic TWELVE = \"h:mm a\";\r\n\tstatic TWENTYFOUR = \"HH:mm\";\r\n}\r\n\r\nexport interface IRowHeight {\r\n\tname: string;\r\n\tvalue: string;\r\n}\r\n\r\nexport class ButtonStyle {\r\n\tstatic PRIMARY = \"primary\";\r\n\tstatic SECONDARY = \"secondary\";\r\n\tstatic TERTIARY = \"tertiary\";\r\n\tstatic FILL = \"full-width\";\r\n}\r\n\r\nexport class SubstitutionTags {\r\n\tstatic readonly VALUE = \"{$value}\";\r\n}\r\n\r\nexport class ValueObject {\r\n\tstatic TARGET_CONTEXT = \"{In Context Value}\";\r\n\tstatic STATIC_VALUE = \"{Static Value}\";\r\n\tstatic URL_VALUE = \"{URL Value}\";\r\n}\r\n\r\nexport class InteractionPairOperation {\r\n\tstatic readonly CLEAR: IDataPair = { name: \"Clear\", value: InteractionActionEnum.CLEAR };\r\n\tstatic readonly GET: IDataPair = { name: \"Get\", value: InteractionActionEnum.GET };\r\n\tstatic readonly LIST: IDataPair = { name: \"List\", value: InteractionActionEnum.LIST };\r\n\tstatic readonly ON_LOAD: IDataPair = { name: \"On Load\", value: InteractionTriggerEnum.ON_LOAD };\r\n\tstatic readonly ON_ITEM_CHANGED: IDataPair = {\r\n\t\tname: \"On Selection Changed\", value: InteractionTriggerEnum.CURRENT_ITEM_CHANGED\r\n\t};\r\n\tstatic readonly ON_ITEM_UPDATED: IDataPair = {\r\n\t\tname: \"On Row Updated\", value: InteractionTriggerEnum.CURRENT_ITEM_UPDATED\r\n\t};\r\n\tstatic readonly ON_STARTUP: IDataPair = { name: \"On Startup\", value: InteractionTriggerEnum.STARTUP };\r\n\tstatic readonly ON_CLOSE: IDataPair = { name: \"On Close\", value: InteractionTriggerEnum.CLOSE };\r\n\tstatic readonly ON_CLICK: IDataPair = { name: \"On Click\", value: InteractionTriggerEnum.CLICK };\r\n\tstatic readonly ON_CHANGED: IDataPair = { name: \"On Changed\", value: InteractionTriggerEnum.CHANGED };\r\n\tstatic readonly IS_CHECKED: IDataPair = { name: \"On Checked\", value: InteractionTriggerEnum.CHECKED };\r\n\tstatic readonly IS_UNCHECKED: IDataPair = { name: \"On Not Checked\", value: InteractionTriggerEnum.UNCHECKED };\r\n\tstatic readonly NONE: IDataPair = { name: \"None\", value: \"\" };\r\n\tstatic readonly SET_CURRENT_ITEM: IDataPair = {\r\n\t\tname: \"Set Selection\",\r\n\t\tvalue: InteractionActionEnum.SET_CURRENT_ITEM\r\n\t};\r\n}\r\n\r\nexport class RowHeight {\r\n\tstatic SHORT = \"short\";\r\n\tstatic MEDIUM = \"medium\";\r\n\tstatic TALL = \"tall\";\r\n}\r\n\r\nexport class MaskProcess {\r\n\tstatic NONE = \"none\";\r\n\tstatic NUMBER = \"number\";\r\n\tstatic DATE_TIME = \"date\";\r\n\tstatic STRING = \"string\";\r\n\tstatic PASSWORD = \"password\";\r\n}\r\n\r\nexport interface IFilter {\r\n\tname: string;\r\n\tdefaultValue: any;\r\n}\r\n\r\nexport interface INewProject {\r\n\tprojectName: string;\r\n\tprojectDescription: string;\r\n\ttemplateNumber: number;\r\n\ttags?: IJsonTag[];\r\n}\r\n\r\nexport enum ImagePositions {\r\n\tFILL = \"fill\",\r\n\tFIT = \"fit\",\r\n\tCENTER = \"center\"\r\n}\r\n\r\nexport interface IWizardFocusType {\r\n\tfocus: number;\r\n\tcomponent: IJsonComponent;\r\n\tsetting: string;\r\n}\r\n\r\nexport enum MarginType {\r\n\tALL = 1,\r\n\tINDIVIDUAL = 2\r\n}\r\nexport enum BorderType {\r\n\tALL = 1,\r\n\tINDIVIDUAL = 2\r\n}\r\nexport interface IChanged {\r\n\tsavedComponentStrings: IComponentTranslation[];\r\n\tsavedGlobalStrings: IMap<IMongooseString[]>;\r\n\tdeletedGlobalStrings: IMap<IMongooseString[]>;\r\n}\r\n\r\nexport interface IComponentTranslation {\r\n\tcomponent: string;\r\n\treference: string;\r\n\tnewValue: string;\r\n}\r\n\r\n/* tslint:disable:max-line-length */\r\nexport class ImageBase64 {\r\n\tstatic DEFAULT = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAAGiQbecAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFEUExURQAAAFtbW1tbW1paWlxcXFtbW1paWlhYWFxcXFpaWlxcXFlZWVtbW11dXVtbW1paWl1dXVlZWV1dXVtbW1xcXFpaWllZWf///2RkZFxcXFtbW11dXV1dXVxcXFtbW0hISFpaWqqqqlpaWltbW1xcXFtbW1lZWVtbW1xcXF1dXVpaWlxcXF1dXVxcXFlZWVxcXFxcXFpaWlpaWlpaWl5eXl5eXltbW19fX1lZWVRUVFtbW39/f1xcXF5eXltbW1tbW3FxcVxcXFpaWlpaWltbW1tbW11dXVtbW1paWktLS1tbW1paWlpaWltbW1lZWVxcXFpaWl9fX2FhYVtbW1VVVVpaWmBgYF9fX1hYWFtbW19fX1tbW1paWltbW1paWltbW1xcXFtbW11dXVxcXFlZWVlZWVpaWmZmZl1dXVtbW1VVVVtbW8YYTK4AAABsdFJOUwCDxJ5Ci6Y0+u/n9xlSyU9taojRo5jhARwWcin/2bMHzgPpegu7b1SoOd6VJoKlw7Dm0z4bNlkI0BL2AnQrTv4JfHGyQ8W9880R4Lro+1tmrzAVnAwiHTgX+FORx5m0hu0yv9r9FLwKc5YG17qYuwUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAItSURBVFhH7ZjpW9NAEMbXW/HEuzoV8UJFxWor9UJRwFsoqBUUwQPP//+7s5M36SapOVsefJ75fejO7My7s0k3x8YUhSywGcccd+xwWsjpH1LGryPtgphe5JnrUMhZh7kVoTOtX2gBB16ZH9byDwN4R8NsjwbqPkfQo+RlE84tsxNdHs7yCa8k8WhfYAawd+duYDqQ/QvXlqpiulDDq8xr9V+BZnQo/OP1tXDgK/KZAXQpSlmwpKIg2oVOrLUNBt/QMgm+0T1Y6QI7iTfcvpOuNEFFJs3Yq311jK6mCYLLL2Aur6CZLOgKooqiKBuf4d24c4WZRDhOFRlREI5To3lYLomCt7DMyn4YGQWjTlYmwc08glt0wZjfXo8lTWCfVcvWq0hfquCinMgZY3bRDjNkexMFxz9KPtHpJ/zziOhhiiB4iAbcziuwL8IIx1kPwXu8PDskCV5i0CgIx7mChAhTCCuKoiiKomxszp29XMvKQflwnY8TeDvKRoGvmmdYNjuRiRecClUOaqwKdhvJLPSswMmjRIuv4XToXYEt3EeH4HToQYGRmUFpJ66dGjwmlkvZAsMHFtmmD7yR6U65AuOjD+zwlk/elqx942lLDJ8yBSrXZWif6ftmRDbXq3tN/Tv99FKLF6hcsoMlsWz3jCUKxD+Bxviyp88F6E+/CzRLFJhvyxDJVAsWGGDVUqOVzuf240IFDtvZZeY5VHlobMbTJJ3zW6FRFEVR/kuM+QtaNbQNSNPAaQAAAABJRU5ErkJggg==\";\r\n}\r\n/* tslint:enable:max-line-length */\r\n\r\nexport enum ListTemplateIdEnum {\r\n\tOneLabelFlexbox = \"OneLabelFlexbox\",\r\n\tTwoVerticalLabels = \"TwoVerticalLabels\",\r\n\tImageAndLabels = \"ImageAndLabels\",\r\n\tOneHyperlink = \"OneHyperlink\",\r\n\tOneHyperlinkAndLabel = \"OneHyperlinkAndLabel\",\r\n\tImageLabelAndHyperlink = \"ImageLabelAndHyperlink\"\r\n}\r\n\r\n/**\r\n * Class contain limit setting for max datasource, and composite component in project\r\n *\r\n * @export\r\n * @class ProjectLimit\r\n */\r\nexport class ProjectLimit {\r\n\tstatic readonly MAX_BOUNDARIES: number = 11; //10 + default boundary\r\n\tprivate static maxDatasource = 50;\r\n\tstatic get MAX_DATASOURCES(): number { return this.maxDatasource; }\r\n\r\n\tprivate static maxCompositeComponent = 50;\r\n\tstatic get MAX_COMPOSITE_COMPONENTS(): number { return this.maxCompositeComponent; }\r\n\r\n\tprivate static errorMessage(item: string): string {\r\n\t\treturn \"The maximum amount of \" + item + \" has been reached. Please delete \" + item + \"(s) before adding new ones.\";\r\n\t}\r\n\r\n\tprivate static importErrorMessage(item: string): string {\r\n\t\treturn \"Import would exceed allowed \" + item + \". Please delete \" + item + \"(s) before importing new ones.\";\r\n\t}\r\n\r\n\tstatic get COMPOSITE_COMPONENT_ERROR_MESSAGE(): string { return this.errorMessage(\"composite components\"); }\r\n\tstatic get COMPOSITE_COMPONENT_IMPORT_ERROR_MESSAGE(): string {\r\n\t\treturn this.importErrorMessage(\"composite component\");\r\n\t}\r\n\r\n\tstatic get DATASOURCE_ERROR_MESSAGE(): string { return this.errorMessage(\"data services\"); }\r\n\tstatic get DATASOURCE_IMPORT_ERROR_MESSAGE(): string {\r\n\t\treturn this.importErrorMessage(\"data service\");\r\n\t}\r\n}\r\n\r\n/**\r\n * The different subcodes that the server gives.\r\n *\thttps://wiki.infor.com/confluence/display/IAB/Server+error+types\r\n\t*\r\n\t* @export\r\n\t* @class Subcodes\r\n\t*/\r\nexport class Subcodes {\r\n\tstatic readonly CONTACT_SYSTEM_ADMIN = \"Please contact system administrator\";\r\n\r\n\tstatic readonly GENERIC_ERROR = 4000;\r\n\tstatic readonly UNABLE_TO_UNZIP_ERROR = 4001;\r\n\tstatic readonly GENERIC_ID_ERROR = 4100;\r\n\tstatic readonly PROJECT_ID_CONFLICT = 4101;\r\n\tstatic readonly PROJECT_DISPLAYNAME_CONFLICT = 4102;\r\n\tstatic readonly PROJECT_IMPORT_ERROR = 4103;\r\n\tstatic readonly DATA_SERVICE_ERROR = 4104;\r\n}\r\n\r\nexport class StatusCodes {\r\n\tstatic success = [\r\n\t\t\"200\",\r\n\t\t\"201\",\r\n\t\t\"202\",\r\n\t\t\"203\",\r\n\t\t\"204\",\r\n\t\t\"205\",\r\n\t\t\"206\"\r\n\t];\r\n}\r\n\r\nexport class FileExtensions {\r\n\tstatic readonly PROJECT = \"iap\";\r\n\tstatic readonly DATA_SERVICE = \"iads\";\r\n\tstatic readonly COMPOSITE_COMPONENT = \"iac\";\r\n}\r\n\r\nexport enum CSSClasses {\r\n\tmashupRootContainer = \"mashupRootContainer\",\r\n}\r\n\r\nexport enum ElementDataKeys {\r\n\tisMashupReady = \"isMashupReady\",\r\n\tmanageCompositesCtrl = \"manageCompositesCtrl\",\r\n\tcompositeTabCtrl = \"compositeTabCtrl\",\r\n\tallProjectsToolbar = \"allProjectsToolbar\"\r\n}\r\n\r\nexport class ComponentClassNames {\r\n\tstatic readonly EDITOR_COMPONENT_PREFIX = \"editor-\";\r\n\tstatic readonly COMPONENT = \"Component\";\r\n}\r\n\r\n//#region Mongoose Constant\r\nexport class ABFormScriptMethod {\r\n\tstatic readonly SHOW_OPEN_FILE_DIALOG = \"ShowOpenFileDialog\";\r\n\tstatic readonly SHOW_SAVE_FILE_DIALOG = \"ShowSaveFileDialog\";\r\n\tstatic readonly TOKEN = \"token\";\r\n\tstatic readonly APPBUILDER_REST = \"appbuilderrest\";\r\n}\r\n//#endregion\r\n\r\nexport class RegexStrings {\r\n\tstatic GLOBALSTRING = \"\\{([^)]+)\\}\";\r\n\r\n\t/* tslint:disable-next-line:max-line-length */\r\n\tstatic EMAIL = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n\tstatic SPECIAL_CHARACTERS = /[?!@#\\$%\\^\\&*\\)\\(+=._-]+/;\r\n\tstatic NUMERIC = /^-?[0-9]+$/;\r\n\tstatic NO_NUMERIC = /\\d+/g;\r\n\tstatic NUMERIC_NO_NEGATIVE = /^[0-9]+$/;\r\n\tstatic NEW_LINES = /(\\r\\n|\\n|\\r)/gm;\r\n\tstatic STARTS_WITH_NUMBER = /^\\d/;\r\n\tstatic NO_SPECIAL = /[^a-zA-Z0-9-_.]/g;\r\n\tstatic TIME = /(?:(?:0?[0-9]|1[0-2]):[0-5][0-9](:[0-5][0-9])? [aApP][mM]|(?:[01][0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?)$/;\r\n\tstatic FIRST_CHAR_LETTER = /^[a-zA-Z]/;\r\n}\r\n\r\nexport enum  GridAggregators {\r\n\tSUM = \"sum\",\r\n}\r\n\r\nexport enum  SummaryTextPlacement {\r\n\tBEFORE = \"before\",\r\n\tAFTER = \"after\",\r\n}\r\n\r\nexport enum TextAlignment {\r\n\tLEFT = \"left\",\r\n\tRIGHT = \"right\",\r\n\tCENTER = \"center\"\r\n}\r\n\r\nexport class DatagridExportTypes {\r\n\tstatic readonly EXCEL = \"excel\";\r\n\tstatic readonly CSV = \"csv\";\r\n}\r\n\r\nexport class IdoDataType {\r\n\tstatic readonly file = \"File\";\r\n\tstatic readonly boolean = \"Boolean\";\r\n\tstatic readonly date = \"Date\";\r\n\tstatic readonly decimal = \"Decimal\";\r\n\tstatic readonly integer = \"Integer\";\r\n\tstatic readonly string = \"String\";\r\n}\r\n\r\nexport class ComponentNames {\r\n\tstatic readonly Chart = \"Chart\"\r\n\tstatic readonly Datagrid = \"Datagrid\"\r\n\tstatic readonly Dropdown = \"Dropdown\"\r\n\tstatic readonly Flexbox = \"Flexbox\"\r\n\tstatic readonly List = \"List\"\r\n\tstatic readonly Lookup = \"Lookup\"\r\n\tstatic readonly RadioButton = \"RadioButton\"\r\n\tstatic readonly Tabs = \"Tabs\"\r\n\tstatic readonly TabPanel = \"TabPanel\"\r\n\tstatic readonly TextBox = \"TextBox\"\r\n}\r\n","export class AngularConstants {\r\n\tpublic static readonly CACHE_FACTORY = \"$cacheFactory\";\r\n\tpublic static readonly COMPILE = \"$compile\";\r\n\tpublic static readonly CONTROLLER = \"$controller\";\r\n\tpublic static readonly DESTROY = \"$destroy\";\r\n\tpublic static readonly ELEMENT = \"$element\";\r\n\tpublic static readonly FILTER = \"$filter\";\r\n\tpublic static readonly HTTP = \"$http\";\r\n\tpublic static readonly INTERVAL = \"$interval\";\r\n\tpublic static readonly Q = \"$q\";\r\n\tpublic static readonly ROOT_SCOPE = \"$rootScope\";\r\n\tpublic static readonly ROUTE = \"$route\";\r\n\tpublic static readonly SCOPE = \"$scope\";\r\n\tpublic static readonly STATE_PARAMS = \"$stateParams\";\r\n\tpublic static readonly STATE_SERVICE = \"$state\";\r\n\tpublic static readonly TEMPLATE_CACHE = \"$templateCache\";\r\n\tpublic static readonly TIMEOUT = \"$timeout\";\r\n\tpublic static readonly WINDOW = \"$window\";\r\n}\r\n","// TODO: Fix the so that contextualactionpanel is in JQuery global\r\nimport angular from \"angular\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { EventTypes, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { AngularConstants } from \"../angular-constants\";\r\nimport { IDialogBaseScope, KeyCodeEnum } from \"../defines\";\r\nimport { Helper } from \"../helper\";\r\n\r\n// Treating dialog-service as an asset\r\n/* tslint:disable */\r\n/**\r\n* UI utility functions.\r\n*/\r\nexport class Util {\r\n\tprivate static chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\r\n\r\n\t/**\r\n\t* Removes all popupmenus from the given element.\r\n\t* @param element Element from which to search for and remove xi-popupmenus\r\n\t*/\r\n\tpublic static removePopupMenus(element: JQuery): void {\r\n\t\tconst popupMenus = element.find(\".btn-menu[aria-haspopup]\");\r\n\t\tfor (let i = 0; i < popupMenus.length; i++) {\r\n\t\t\tconst data = $(popupMenus[i]).data(\"popupmenu\");\r\n\t\t\tif (data) {\r\n\t\t\t\tdata.close();\r\n\t\t\t\tdata.destroy();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a string with random uppercase letters and numbers.\r\n\t * The default length is 16 if the stringLength parameter is omitted.\r\n\t */\r\n\tpublic static random(stringLength: number = 16): string {\r\n\t\tconst chars = this.chars;\r\n\t\tlet randomstring = \"\";\r\n\t\tfor (let i = 0; i < stringLength; i++) {\r\n\t\t\tconst rnum = Math.floor(Math.random() * chars.length);\r\n\t\t\trandomstring += chars.substring(rnum, rnum + 1);\r\n\t\t}\r\n\t\treturn randomstring;\r\n\t}\r\n}\r\n\r\n/**\r\n * Represents options for a toast message.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IToastOptions {\r\n\t/**\r\n\t * Gets or sets the toast title.\r\n\t */\r\n\ttitle: string;\r\n\r\n\t/**\r\n\t * Gets or sets the toast message.\r\n\t */\r\n\tmessage: string;\r\n\r\n\t/**\r\n\t * Sting that stated where the toast should be displayed\r\n\t *\r\n\t * Possible values: top right, top left, bottom left, bottom right\r\n\t */\r\n\tposition?: string;\r\n\r\n\t/**\r\n\t * States whether the notification should be audible only.\r\n\t */\r\n\taudibleOnly?: boolean;\r\n\r\n\t/**\r\n\t * States whether or not to display a progress bar.\r\n\t */\r\n\tprogressBar?: boolean;\r\n\r\n\t/**\r\n\t * States for how long the toast should be visible (milliseconds).\r\n\t */\r\n\ttimeout?: number;\r\n}\r\n\r\nexport type MessageDialogStatus = \"error\" | \"alert\" | \"success\";\r\n/**\r\n * Represents options for a message dialog.\r\n *\r\n * Use either the buttons or standardButtons property.\r\n *\r\n * Example options for a message with the standrad buttons Yes and No:\r\n *\r\n *\t\tlet options: lm.IMessageDialogOptions = {\r\n *\t\t\ttitle: \"Confirm Delete\",\r\n\t*\t\t\tmessage: \"Are you sure that you want to delete the selected item?\",\r\n\t*\t\t\tstandardButtons: s.StandardDialogButtons.YesNo\r\n\t*\t\t}\r\n\t*\r\n\t* Example options for a message with custom buttons:\r\n\t*\r\n\t*\t\tlet options: lm.IMessageDialogOptions = {\r\n\t*\t\t\ttitle: \"Remove Widget\",\r\n\t*\t\t\tmessage: \"Are you sure that you want to remove the widget?\",\r\n\t*\t\t\tbuttons: [{\r\n\t*\t\t\t\ttext: \"Remove it!\",\r\n\t*\t\t\t\tvalue: \"Yes\",\r\n\t*\t\t\t\tisDefault: true\r\n\t*\t\t\t}, {\r\n\t*\t\t\t\t\ttext: \"Keep it!\",\r\n\t*\t\t\t\t\tvalue: \"No\",\r\n\t*\t\t\t\t\tisDefault: false\r\n\t*\t\t\t\t}]\r\n\t*\t\t}\r\n\t*\r\n\t* @since 1.0\r\n\t*/\r\nexport interface IMessageDialogOptions {\r\n\t/**\r\n\t * Gets or sets the dialog title.\r\n\t */\r\n\ttitle: string;\r\n\r\n\t/**\r\n\t * Gets or sets the dialog message.\r\n\t */\r\n\tmessage: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional array of dialog buttons.\r\n\t *\r\n\t * Use this property or the standardButtons property.\r\n\t */\r\n\tbuttons?: IDialogButton[];\r\n\r\n\t/**\r\n\t * Gets or sets an optional stanard button configuration.\r\n\t *\r\n\t * Use this property or the buttons property.\r\n\t */\r\n\tstandardButtons?: StandardDialogButtons;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if this is an error message.\r\n\t *\r\n\t * If this property is set to true the message dialog title will be shown with the error styling.\r\n\t */\r\n\tisError?: boolean;\r\n\t/**\r\n\t * Pass a status to style icon and title color ('error', 'alert', 'success')\r\n\t */\r\n\tstatus?: MessageDialogStatus;\r\n\t/**\r\n\t * String to include in message title that is strictly audible.\r\n\t */\r\n\taudibleLabel?: string;\r\n\r\n\t/**\r\n\t * Sets css class on modal.\r\n\t */\r\n\tcssClass?: string;\r\n\r\n\t/**\r\n\t * Specifies wether or not to automatically set primary button styling.\r\n\t *\r\n\t * True is default.\r\n\t */\r\n\thasPrimaryButton?: boolean;\r\n}\r\n\r\n/**\r\n * Defines standard button combinations for a message dialog.\r\n *\r\n * @since 1.0\r\n */\r\nexport enum StandardDialogButtons {\r\n\t/**\r\n\t * Shows an OK button (1).\r\n\t */\r\n\tOk = 1,\r\n\t/**\r\n\t * Shows an OK button and a Cancel button (2).\r\n\t */\r\n\tOkCancel = 2,\r\n\t/**\r\n\t * Shows a Yes and a No button (3).\r\n\t */\r\n\tYesNo = 3,\r\n\t/**\r\n\t * Shows a Yes, No and a Cancel button (4).\r\n\t */\r\n\tYesNoCancel = 4,\r\n}\r\n\r\n/**\r\n * Represents options for a dialog.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialogOptions<ParameterType> {\r\n\t/**\r\n\t * Gets or sets the dialog title.\r\n\t */\r\n\ttitle: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional parameter.\r\n\t *\r\n\t * If this property is set when showing a dialog it will be available on the[[IDialog]] instance.\r\n\t */\r\n\tparameter?: ParameterType;\r\n\r\n\t/**\r\n\t * Gets or sets an optional parent scope.\r\n\t */\r\n\tscope?: ng.IScope;\r\n\r\n\t/**\r\n\t * Gets or sets an optional AngularJS template.\r\n\t */\r\n\ttemplate?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional AngularJS template URL.\r\n\t */\r\n\ttemplateUrl?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional array of dialog buttons.\r\n\t *\r\n\t * This property should not be set if custom buttons are added in the dialog template.\r\n\t */\r\n\tbuttons?: IDialogButton[];\r\n\r\n\t/**\r\n\t * Gets or sets an optional style string that will be applied to the modal dialog instance.\r\n\t */\r\n\tstyle?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional CSS class that will be applied to the modal dialog instance.\r\n\t */\r\n\tcssClass?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional ID of the modal dialog instance.\r\n\t */\r\n\tid?: string;\r\n\r\n\t//Hides the overlay when true. Used in wizard-interaction\r\n\thideOverlay?: boolean;\r\n\tdraggable?: true;\r\n}\r\n\r\n/**\r\n * Represents a dialog button.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialogButton {\r\n\t/**\r\n\t * Gets or sets the text to display on the button.\r\n\t */\r\n\ttext: string;\r\n\r\n\t/**\r\n\t * Gets or sets the type of button defined in [[DialogButtonType]].\r\n\t */\r\n\ttype?: any;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value object that will be returned in the [[IDialogResult]] if set.\r\n\t */\r\n\tvalue?: any;\r\n\r\n\t/**\r\n\t * Gets or sets an optional ID for the button.\r\n\t */\r\n\tid?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if the button is a link.\r\n\t */\r\n\tisLink?: boolean;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if the button is the default button.\r\n\t */\r\n\tisDefault?: boolean;\r\n\r\n\t/**\r\n\t * Gets or sets an optional svg icon path for the button\r\n\t */\r\n\ticon?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional css class for the dialog button\r\n\t */\r\n\tcssClass?: string;\r\n\r\n\t/**\r\n\t * FIXME: Do not use this attribute to set a function on your button. This does not work\r\n\t * Rather, set a type on the button and switch on different types in the resolved\r\n\t * promise.\r\n\t */\r\n\tclick?: Function;\r\n}\r\n\r\n/**\r\n * Represents the result from a closed dialog.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialogResult<ResultType> {\r\n\t/**\r\n\t * Gets or sets the type of button clicked, defined in [[DialogButtonType]].\r\n\t *\r\n\t * This property might not be set depending on how the dialog was dismissed.\r\n\t */\r\n\tbutton?: DialogButtonType;\r\n\r\n\t/**\r\n\t * Gets or sets an optional result value.\r\n\t *\r\n\t * This property can be used for a result value object of any type in custom dialog scenarios.\r\n\t */\r\n\tvalue?: ResultType;\r\n}\r\n\r\n/**\r\n * Defines the different types of buttons that can be used in dialogs.\r\n *\r\n * @since 1.0\r\n */\r\nexport enum DialogButtonType {\r\n\t/**\r\n\t * No button is used or the button is unknown (1).\r\n\t */\r\n\tNone = 1,\r\n\t/**\r\n\t * OK button (2).\r\n\t */\r\n\tOk = 2,\r\n\t/**\r\n\t * Cancel button (3).\r\n\t */\r\n\tCancel = 3,\r\n\t/**\r\n\t * Yes button (4).\r\n\t */\r\n\tYes = 4,\r\n\t/**\r\n\t * No button (5).\r\n\t */\r\n\tNo = 5,\r\n\t/**\r\n\t * Custom button (6).\r\n\t */\r\n\tCustom = 6,\r\n\t/**\r\n\t * Back button (7).\r\n\t */\r\n\tBack = 7\r\n}\r\n\r\nexport interface IContextualActionPanelOptions {\r\n\ttitle: string;\r\n\ttemplate?: string;\r\n\ttemplateUrl?: string;\r\n}\r\n\r\n/**\r\n* @internal\r\n*/\r\ninterface IDialogButtonEx extends IDialogButton {\r\n\tclick: Function;\r\n}\r\n\r\nexport class DialogService {\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.ROOT_SCOPE,\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.Q\r\n\t];\r\n\r\n\tprivate dialogOptions: IDialogOptions<any>;\r\n\r\n\tconstructor(private $rootScope: ng.IScope, private $compile: ng.ICompileService, private $q: ng.IQService) { }\r\n\r\n\tpublic show<ParameterType, ResultType>(options: IDialogOptions<ParameterType>): ng.IPromise<IDialogResult<ResultType>> {\r\n\t\tconst deferred = this.$q.defer();\r\n\r\n\t\tlet title: any = null;\r\n\t\tif (options) {\r\n\t\t\ttitle = options.title;\r\n\t\t\tthis.dialogOptions = options;\r\n\t\t}\r\n\t\tif (!title) {\r\n\t\t\ttitle = \"\";\r\n\t\t}\r\n\r\n\t\tconst dialog = new Dialog(deferred);\r\n\r\n\t\tconst modalScope = (options.scope || this.$rootScope).$new() as IDialogBaseScope<ParameterType>;\r\n\t\tif (options && options.parameter) {\r\n\t\t\tdialog.parameter = options.parameter;\r\n\t\t}\r\n\t\tmodalScope.eirDialog = dialog;\r\n\r\n\t\tlet contentTemplate = options.template;\r\n\t\tif (!contentTemplate) {\r\n\t\t\tconst url = options.templateUrl;\r\n\t\t\tif (!url) {\r\n\t\t\t\tthrow \"One of the template and templateUrl properties must be set\";\r\n\t\t\t}\r\n\t\t\tcontentTemplate = \"<div ng-include=\\\"'\" + url + \"'\\\"></div>\";\r\n\t\t}\r\n\r\n\t\t// TODO: Add support for standard buttons\r\n\t\t// TODO: Default style\r\n\r\n\t\tconst style = options.style || \"\";\r\n\t\tconst cssClass = options.cssClass || \"\";\r\n\t\tconst draggable = !!options.draggable;\r\n\t\tconst id = options.id || Util.random(8);\r\n\t\tconst template = `\r\n\t\t<div class=\"modal lm-scroll-no-y ${cssClass} ${options.draggable ? \"draggable-dialog\" : \"\"}\" id=\"${id}\" style=\"${style}\">\r\n\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t<div class=\"modal-header\"></div>\r\n\t\t\t\t<div class=\"modal-body\">${contentTemplate}</div>`;\r\n\r\n\t\tconst element = $(template);\r\n\r\n\t\t// Modify the template slightly depending if it's a regular modal or contextual action panel modal\r\n\t\tconst headerElement = element.find(\".modal-header\");\r\n\t\theaderElement.append($(`<h1 class=\"modal-title\">${ title }<h1>`));\r\n\r\n\t\tconst compiledTemplate = this.$compile(element)(modalScope);\r\n\t\tif (draggable) { // Draggable dialog gets a position: relative added after compile. thus needs to be removed\r\n\t\t\tcompiledTemplate.css(\"position\", \"\");\r\n\t\t}\r\n\r\n\t\t$(\"body\").append(compiledTemplate);\r\n\r\n\t\tif (this.hasHideOverlayOption()) {\r\n\t\t\tthis.toggleOverlay();\r\n\t\t}\r\n\r\n\t\tlet buttons: IDialogButtonEx[] = null;\r\n\t\tif (options.buttons) {\r\n\t\t\tbuttons = this.setSpecificButtons(options.buttons, deferred, dialog);\r\n\t\t}\r\n\t\t/*\r\n\t\t\tTODO: fix for multiple ng-includes and no includes\r\n\t\tmaybe like this: http://www.competa.com/blog/2013/12/how-to-detect-when-all-your-nested-ng-includes-have-loaded-their-content-in-angularjs/\r\n\t\t*/\r\n\t\t//\t\t\tif (options.template && options.template.indexOf(\"ng-include\") === -1) {\r\n\t\t//\t\t\t\tthis.createAndOpenModal(element, dialog, title, buttons, modalScope);\r\n\t\t//\t\t\t} else { // If templateUrl, wait for included content\r\n\t\t//\t\t\t}\r\n\t\tconst unsubscribe = modalScope.$on(\"$includeContentLoaded\", () => {\r\n\t\t\tthis.createAndOpenModal(element, dialog, title, buttons, modalScope);\r\n\t\t\tunsubscribe();\r\n\t\t});\r\n\t\tif (isUndefined(options.templateUrl) && !isUndefined(options.template)) {\r\n\t\t\tthis.createAndOpenModal(element, dialog, title, buttons, modalScope);\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate createAndOpenModal(element: JQuery, dialog: Dialog, title: string, buttons: IDialogButtonEx[], modalScope: ng.IScope): void {\r\n\r\n\t\t/* Fix for SVG icons in IE11 on Windows10\r\n\t\t\trelated articles:\r\n\t\t\thttp://stackoverflow.com/questions/33040911/svg-icons-dissapears-in-windows-10-ie-11-using-jquery-sortable\r\n\t\t\thttp://jira/browse/SOHO-3069\r\n\t\t*/\r\n\t\tif (Helper.isIE()) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\telement.find(\"use\").each((idx: number, elem: Element) => {\r\n\t\t\t\t\telem.setAttribute(\"xlink:href\", elem.getAttribute(\"xlink:href\"));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst modal = (<any>element).modal({\r\n\t\t\ttitle: title,\r\n\t\t\tbuttons: buttons\r\n\t\t});\r\n\t\tdialog.init(modal);\r\n\r\n\t\tif (!buttons) { // To calculate width of included buttons\r\n\t\t\tmodal.modal(\"addButtons\");\r\n\t\t}\r\n\r\n\t\t// Destroy the modal scope when the modal is closing.\r\n\t\tmodal.one(\"beforeclose\", () => {\r\n\t\t\tmodalScope.$destroy();\r\n\t\t\tUtil.removePopupMenus(element);\r\n\t\t\tif (this.hasHideOverlayOption()) {\r\n\t\t\t\tthis.toggleOverlay();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tmodal.modal(\"open\");\r\n\t}\r\n\r\n\tprivate hasHideOverlayOption<T>(options?: IDialogOptions<T>): boolean {\r\n\t\tconst dialogOptions = this.dialogOptions;\r\n\r\n\t\treturn dialogOptions && dialogOptions.hideOverlay ? true : false;\r\n\t}\r\n\r\n\tpublic showContextualActionPanel(options: IContextualActionPanelOptions): void {\r\n\t\tconst template = options.template || `<div ng-include=\"'${options.templateUrl}'\"></div>`;\r\n\t\tconst element: any = $(template);\r\n\r\n\t\t($(\"body\") as any).contextualactionpanel({\r\n\t\t\ttitle: options.title,\r\n\t\t\tcontent: this.$compile(element)(this.$rootScope.$new()),\r\n\t\t\ttrigger: \"immediate\",\r\n\t\t\tbuttons: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: \"Close\",\r\n\t\t\t\t\tcssClass: \"btn\",\r\n\t\t\t\t\ticon: \"#icon-close\",\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t});\r\n\t}\r\n\r\n\tpublic showMessage(options: IMessageDialogOptions): ng.IPromise<IDialogResult<any>> {\r\n\t\tconst deferred = this.$q.defer();\r\n\t\tconst element: any = $(\"body\");\r\n\t\tthis.dialogOptions = options;\r\n\r\n\t\tif (!options.buttons && !options.standardButtons) {\r\n\t\t\toptions.standardButtons = StandardDialogButtons.Ok;\r\n\t\t}\r\n\r\n\t\tif (options.standardButtons !== null) {\r\n\t\t\toptions.buttons = this.setDefaultButtons(options.standardButtons, deferred, options.hasPrimaryButton === undefined || options.hasPrimaryButton);\r\n\t\t} else if (options.buttons) {\r\n\t\t\toptions.buttons = this.setSpecificButtons(options.buttons, deferred, null);\r\n\t\t}\r\n\r\n\t\telement.message(options);\r\n\r\n\t\tconst isChildDialog = this.hasHideOverlayOption();\r\n\t\tif (isChildDialog) {\r\n\t\t\tthis.toggleOverlay();\r\n\t\t}\r\n\t\treturn deferred.promise.finally(() => {\r\n\t\t\tif (isChildDialog) {\r\n\t\t\t\tthis.toggleOverlay();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic showError(title: string, message: string): ng.IPromise<IDialogResult<void>> {\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: `<span>${title}</span>`,\r\n\t\t\tmessage: message,\r\n\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\tisError: true, //This will change to status: \"error\" in later SoHo Update to support status: \"warning\",\r\n\t\t\tstatus: \"error\",\r\n\t\t\taudibleLabel: \"Error\",\r\n\t\t};\r\n\t\t//if error dialog already exist do not show\r\n\t\tconst errorDialogExists = angular.element(\".is-error.modal-title\");\r\n\t\tif (errorDialogExists.length === 0) {\r\n\t\t\treturn this.showMessage(options);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic showYesNo(\r\n\t\ttitle: string,\r\n\t\tmessage: string,\r\n\t\tcssClass?: string\r\n\t): ng.IPromise<IDialogResult<void>> {\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: title,\r\n\t\t\tmessage: message,\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo,\r\n\t\t\tcssClass: cssClass\r\n\t\t};\r\n\t\treturn this.showMessage(options);\r\n\t}\r\n\r\n\tprivate toggleOverlay(): void {\r\n\t\t$(\"body\").toggleClass(\"no-overlay\");\r\n\t}\r\n\r\n\t/**\r\n\t* Shows a toast notification with the specified options.\r\n\t*\r\n\t* Defaults position to \"bottom right\" and timeout to 3000 if not set.\r\n\t*/\r\n\tpublic showToast(options: IToastOptions): void {\r\n\t\tif (!options.position) {\r\n\t\t\toptions.position = \"bottom right\";\r\n\t\t}\r\n\t\tif (!options.timeout) {\r\n\t\t\toptions.timeout = 3000;\r\n\t\t}\r\n\t\t$(\"body\")[\"toast\"](options);\r\n\t}\r\n\r\n\tprivate setDefaultButtons(defaults: StandardDialogButtons, deferred: ng.IDeferred<any>, hasPrimaryButton: boolean): IDialogButtonEx[] {\r\n\t\tconst buttons: IDialogButtonEx[] = [];\r\n\t\tif (defaults === StandardDialogButtons.OkCancel || defaults === StandardDialogButtons.YesNoCancel) {\r\n\t\t\tbuttons.push({\r\n\t\t\t\ttext: \"Cancel\",\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t\tdeferred.resolve({ button: DialogButtonType.Cancel });\r\n\t\t\t\t},\r\n\t\t\t\tisDefault: false\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (defaults === StandardDialogButtons.Ok || defaults === StandardDialogButtons.OkCancel) {\r\n\t\t\tbuttons.push({\r\n\t\t\t\ttext: \"OK\",\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t\tdeferred.resolve({ button: DialogButtonType.Ok });\r\n\t\t\t\t},\r\n\t\t\t\tisDefault: hasPrimaryButton\r\n\t\t\t});\r\n\t\t} else if (defaults === StandardDialogButtons.YesNo || defaults === StandardDialogButtons.YesNoCancel) {\r\n\t\t\tbuttons.push({\r\n\t\t\t\ttext: \"No\",\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t\tdeferred.resolve({ button: DialogButtonType.No });\r\n\t\t\t\t},\r\n\t\t\t\tisDefault: false\r\n\t\t\t});\r\n\t\t\tbuttons.push({\r\n\t\t\t\ttext: \"Yes\",\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t\tdeferred.resolve({ button: DialogButtonType.Yes });\r\n\t\t\t\t},\r\n\t\t\t\tisDefault: hasPrimaryButton\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn buttons;\r\n\t}\r\n\r\n\tprivate setSpecificButtons(specificButtons: IDialogButton[], deferred: ng.IDeferred<IDialogResult<any>>, dialog: IDialog<any>): IDialogButtonEx[] {\r\n\t\tconst buttons: IDialogButtonEx[] = [];\r\n\t\tspecificButtons.forEach((button: IDialogButtonEx, index: any) => {\r\n\t\t\tbutton.click = function () {\r\n\t\t\t\tif (dialog) {\r\n\t\t\t\t\tdialog.close();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t}\r\n\t\t\t\tlet result: any;\r\n\t\t\t\tif (dialog) {\r\n\t\t\t\t\tresult = dialog.result || {};\r\n\t\t\t\t\tresult.button = button.type;\r\n\t\t\t\t\tdeferred.resolve(result);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = { button: button.type };\r\n\t\t\t\t}\r\n\t\t\t\tdeferred.resolve(result);\r\n\t\t\t};\r\n\t\t\tbuttons.push(button);\r\n\t\t});\r\n\r\n\t\treturn buttons;\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule) {\r\n\t\tngModule.service(InjectNames.DIALOG_SERVICE, DialogService);\r\n\t}\r\n}\r\n\r\n/**\r\n * Represents a dialog event.\r\n *\r\n * An instance of this type will be a parameter to the closing and closed events on the [[IDialog]].\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialogEvent<T> {\r\n\t/**\r\n\t * Gets or sets the dialog instance that is the source of the event.\r\n\t */\r\n\tdialog: IDialog<T>;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if the event should be cancelled.\r\n\t *\r\n\t * Note that only the closing event can currently be cancelled.\r\n\t */\r\n\tcancel?: boolean;\r\n}\r\n\r\n/**\r\n * Represents a modal dialog instance.\r\n *\r\n * The dialog instance can be retrieved from the scope in a dialog controller using the name \"lmDialog\".\r\n *\r\n * TODO: Add <ResultType> generic type variable.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialog<ParameterType> {\r\n\t/**\r\n\t * Closes the dialog.\r\n\t *\r\n\t * @param result Optional dialog result. The result property will be set if a value is provided.\r\n\t */\r\n\tclose(result?: IDialogResult<any>): void;\r\n\r\n\t/**\r\n\t * Gets or sets a function that will be called when the dialog is closing.\r\n\t *\r\n\t * The closing of the dialog can be cancelled by setting the cancel property to true on the event parameter.\r\n\t */\r\n\tclosing: (e: IDialogEvent<any>) => void;\r\n\r\n\t/**\r\n\t * Gets or sets a function that will be called when the dialog is closed.\r\n\t */\r\n\tclosed: (e: IDialogEvent<any>) => void;\r\n\r\n\t/**\r\n\t * Gets or sets a function that will be called when the dialog is opened.\r\n\t */\r\n\topened: (e: IDialogEvent<any>) => void;\r\n\r\n\t/**\r\n\t * Hides dialog in background without closing it.\r\n\t */\r\n\thide: () => void;\r\n\r\n\t/**\r\n\t * Unhides dialog which previously was hidden.\r\n\t */\r\n\tshow: () => void;\r\n\r\n\t/**\r\n\t * Get promise to hook up any interactions when result is given\r\n\t * TODO: rm this solution when soho has fixed it.\r\n\t * #MUPS-1124\r\n\t */\r\n\tgetPromise: () => ng.IPromise<any>;\r\n\r\n\t/**\r\n\t * Gets or sets an optional parameter.\r\n\t *\r\n\t * This property will have the value set on the [[IDialogOptions]] instance when showing the dialog.\r\n\t */\r\n\tparameter?: ParameterType;\r\n\r\n\t/**\r\n\t * Gets or sets the dialog result.\r\n\t */\r\n\tresult?: IDialogResult<any>;\r\n}\r\n\r\nclass Dialog implements IDialog<any> {\r\n\tpublic closing: (e: IDialogEvent<any>) => void;\r\n\tpublic closed: (e: IDialogEvent<any>) => void;\r\n\tpublic opened: (e: IDialogEvent<any>) => void;\r\n\r\n\tpublic parameter: any;\r\n\tpublic result: IDialogResult<any>;\r\n\r\n\tprivate modal: JQuery;\r\n\tprivate canClose = false;\r\n\r\n\tconstructor(private deferred: ng.IDeferred<any>) { }\r\n\r\n\tprivate resolve(): void {\r\n\t\tconst modal = this.modal;\r\n\t\tif (modal) {\r\n\t\t\t// SOHO FIX MUPS-1107\r\n\t\t\t// Removing excessive nodes: modal-wrapper & modal-page-container when a dialog is closed\r\n\t\t\tconst modalParent = modal.parent();\r\n\t\t\tconst modalGrandParent = modalParent.parent();\r\n\t\t\tif (modalParent.hasClass(\"modal-wrapper\") && modalGrandParent.hasClass(\"modal-page-container\")) {\r\n\t\t\t\tmodalGrandParent.remove();\r\n\t\t\t\tmodalParent.remove();\r\n\t\t\t}\r\n\t\t\tmodal.remove();\r\n\t\t\tthis.modal = null;\r\n\t\t}\r\n\t\tconst result = this.result || {};\r\n\t\tthis.deferred.resolve(result);\r\n\t}\r\n\r\n\tpublic init(modal: JQuery): void {\r\n\t\tthis.modal = modal;\r\n\r\n\t\t// TODO: rm this solution when soho has fixed it.\r\n\t\t// #MUPS-1124\r\n\t\tconst closeOnEscape = ($event: JQueryEventObject) => {\r\n\t\t\tif ($event.keyCode === KeyCodeEnum.ESCAPE) {\r\n\t\t\t\tconst result: IDialogResult<KeyCodeEnum> = { value: KeyCodeEnum.ESCAPE };\r\n\t\t\t\tthis.close(result);\r\n\t\t\t}\r\n\t\t};\r\n\t\tangular.element(\"body\").on(EventTypes.KEYDOWN + \".dialog\", closeOnEscape);\r\n\r\n\t\tmodal.one(\"beforeclose\", () => {\r\n\t\t\tangular.element(\"body\").off(EventTypes.KEYDOWN + \".dialog\", closeOnEscape);\r\n\t\t\tconst closing = this.closing;\r\n\t\t\tif (closing) {\r\n\t\t\t\tconst e = <IDialogEvent<any>>{ dialog: this };\r\n\t\t\t\tclosing(e);\r\n\t\t\t\treturn e.cancel ? false : true;\r\n\t\t\t} else {\r\n\t\t\t\treturn this.canClose;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tmodal.one(\"afterclose\", () => {\r\n\t\t\tconst closed = this.closed;\r\n\t\t\tif (closed) {\r\n\t\t\t\tconst e = <IDialogEvent<any>>{ dialog: this };\r\n\t\t\t\tclosed(e);\r\n\t\t\t}\r\n\t\t\tthis.resolve();\r\n\t\t});\r\n\r\n\t\tmodal.one(\"open\", () => {\r\n\t\t\tconst opened = this.opened;\r\n\r\n\t\t\tmodal.attr(\"dialog-id\", Helper.generateUniqueId());\r\n\t\t\t$(\".overlay:not([id])\").attr(\"id\", modal.attr(\"dialog-id\"));\r\n\t\t\tif (opened) {\r\n\t\t\t\tconst e = <IDialogEvent<any>>{ dialog: this };\r\n\t\t\t\topened(e);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// TODO: rm this solution when soho has fixed it.\r\n\t// #MUPS-1124\r\n\tpublic getPromise(): ng.IPromise<any> {\r\n\t\treturn this.deferred.promise;\r\n\t}\r\n\r\n\tpublic close(result?: IDialogResult<any>): void {\r\n\t\tthis.canClose = true;\r\n\t\tif (result) {\r\n\t\t\tthis.result = result;\r\n\t\t}\r\n\r\n\t\tconst modal = this.modal;\r\n\t\tif (modal) {\r\n\t\t\t(<any>modal).modal(\"close\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tthis.modal.hide();\r\n\t\t$(`div#${this.modal.attr(\"dialog-id\")}.overlay`).hide();\r\n\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tthis.modal.show();\r\n\t\t$(`div#${this.modal.attr(\"dialog-id\")}.overlay`).show();\r\n\t}\r\n}\r\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\r\n// TODO: Fix the so that documentMode is in document global\r\nimport angular from \"angular\";\r\nimport filter from \"lodash-es/filter\";\r\nimport find from \"lodash-es/find\";\r\nimport union from \"lodash-es/union\";\r\n\r\nimport type { ILayoutComponent } from \"./interface/ilayout-component\";\r\n\r\nimport type { IListComponent } from \"./interface/ilist-component\";\r\n\r\nimport {\r\n\tComponentConstants,\r\n\tCSSClasses,\r\n\tElementDataKeys,\r\n\tNumbers,\r\n\tRegexStrings,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport type { IProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nexport enum RegExpMatchCandidate { BASE_NAME = 1, IS_COPY = 2, NUMBER = 3 }\r\n\r\nexport class Helper {\r\n\r\n\t/**\r\n\t * Gets the date based on the format param\r\n\t * Supported formats:\r\n\t *\r\n\t *\t* yyyy-mm-dd\r\n\t\t*\r\n\t\t* Defaults to yyyy-mm-ddThh:mm\r\n\t\t*\r\n\t\t* @static\r\n\t\t* @param {(\"yyyy-mm-dd\" | undefined)} format\r\n\t\t* @returns {string}\r\n\t\t* @memberof Helper\r\n\t\t*/\r\n\tstatic getFormattedDate(format = \"yyyy-mm-dd\"): string {\r\n\t\t//tslint:disable:no-magic-numbers\r\n\t\tconst date = new Date();\r\n\t\tconst year = date.getFullYear();\r\n\r\n\t\tconst month = (date.getMonth() + 1).toString();\r\n\t\tconst formattedMonth = month.padStart(2, \"0\");\r\n\r\n\t\tconst day = date.getDate().toString();\r\n\t\tconst formattedDay = day.padStart(2, \"0\");\r\n\r\n\t\tconst hour = date.getHours().toString();\r\n\t\tconst formattedHour = hour.padStart(2, \"0\");\r\n\r\n\t\tconst minute = date.getMinutes().toString();\r\n\t\tconst formattedMinute = minute.padStart(2, \"0\");\r\n\r\n\t\tconst second = date.getSeconds().toString();\r\n\t\tconst formattedSecond = second.padStart(2, \"0\");\r\n\r\n\t\tconst millisecond = date.getMilliseconds().toString();\r\n\t\tconst formattedMilleSecond = millisecond.padStart(3, \"0\");\r\n\t\t//tslint:enable:no-magic-numbers\r\n\r\n\t\t//tslint:disable:max-line-length\r\n\t\tswitch (format) {\r\n\t\t\tcase \"yyyy-mm-dd\":\r\n\t\t\t\treturn `${year}-${formattedMonth}-${formattedDay}`;\r\n\t\t\tcase \"yyyymmdd HH:mm:ss.fff\":\r\n\t\t\t\treturn `${year}${formattedMonth}${formattedDay} ${formattedHour}:${formattedMinute}:${formattedSecond}.${formattedMilleSecond}`;\r\n\t\t\tdefault: //YYYY-MM-DDTHH:mm\r\n\t\t\t\treturn `${year}-${formattedMonth}-${formattedDay}T${formattedHour}:${formattedMinute}`;\r\n\t\t}\r\n\t\t//tslint:enable:max-line-length\r\n\t}\r\n\r\n\tstatic become(obj: any, newClass: any): void {\r\n\t\tobj.__proto__ = ((new newClass())).__proto__;\r\n\t}\r\n\r\n\tstatic getDeepValue(obj: any, paths: string): any | null {\r\n\t\tfor (let i = 0, path = paths.split(\".\"), len = path.length; i < len; i++) {\r\n\t\t\tif (!this.isUndefinedOrNull(obj[path[i]])) {\r\n\t\t\t\tobj = obj[path[i]];\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tstatic setDeepValue(obj: any, paths: string, newValue: any): void {\r\n\t\tfor (var i = 0, path = paths.split(\".\"), secondToLast = path.length - 1; i < secondToLast; i++) {\r\n\t\t\tif (!obj[path[i]]) {\r\n\t\t\t\tobj[path[i]] = {};\r\n\t\t\t}\r\n\t\t\tobj = obj[path[i]];\r\n\t\t}\r\n\t\tobj[path[i]] = newValue;\r\n\t}\r\n\r\n\tstatic stringReplace(str: string, context: IMap<string>): string {\r\n\t\tconst reg = /({\\w+})/g;\r\n\t\treturn str.replace(reg, (match: string, $1: any, $2: any) => {\r\n\t\t\tconst trimmed = /{(\\w+)}/.exec(match)[1];\r\n\r\n\t\t\treturn context[trimmed];\r\n\t\t});\r\n\t}\r\n\r\n\tstatic getStringParameters(str: string): string[] {\r\n\t\tconst reg = /({\\w+})/g;\r\n\t\tconst match = str.match(reg);\r\n\t\tif (match) {\r\n\t\t\treturn match.map((hit) => {\r\n\t\t\t\treturn hit.match(/\\w+/g)[0];\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn [];\r\n\t}\r\n\r\n\tstatic isUndefined(anyObject: any): boolean {\r\n\t\treturn typeof anyObject === \"undefined\";\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if object is undefined or null\r\n\t * @param anyObject\r\n\t */\r\n\tstatic isUndefinedOrNull(anyObject: any): boolean {\r\n\t\treturn anyObject === undefined || anyObject === null;\r\n\t}\r\n\r\n\tstatic isFloat(value: string | number): boolean {\r\n\t\treturn !this.isInt(value);\r\n\t}\r\n\r\n\tstatic isInt(value: string | number): boolean {\r\n\t\treturn Number(value) % 1 === 0;\r\n\t}\r\n\r\n\tprivate static chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\r\n\r\n\t/**\r\n\t * Creates a string with random uppercase letters and numbers.\r\n\t * The default length is 16 if the stringLength parameter is omitted.\r\n\t */\r\n\tstatic random(stringLength = 16): string {\r\n\t\tconst chars = this.chars;\r\n\t\tlet randomstring = \"\";\r\n\t\tfor (let i = 0; i < stringLength; i++) {\r\n\t\t\tconst rnum = Math.floor(Math.random() * chars.length);\r\n\t\t\trandomstring += chars.substring(rnum, rnum + 1);\r\n\t\t}\r\n\r\n\t\treturn randomstring;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if string is undefined, null or empty\r\n\t *\r\n\t * @static\r\n\t * @param {string} item\r\n\t * @returns {string}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic isUndefinedEmpty(item: string): boolean {\r\n\t\treturn (item === undefined || item === null || item === \"\") ? true : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a list of strings by regex\r\n\t *\r\n\t * @static\r\n\t * @param {string} regex\r\n\t * @param {string} myString\r\n\t * @returns {string[]}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic getListByRegex(regex: string, myString: string): string[] {\r\n\t\tconst group = 2;\r\n\t\tconst cleanedString = myString.match(regex)[group];\r\n\t\tconst readyList = cleanedString.substring(1, cleanedString.length - 1).split(\",\");\r\n\t\treturn readyList;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a query parameter string with same key for all values\r\n\t *\r\n\t * @param {string[]} values\r\n\t * @param {string} key\r\n\t */\r\n\tstatic createQueryParameters(values: string[], key: string): string {\r\n\t\treturn values.map((value) => {\r\n\t\t\treturn key + \"=\" + value;\r\n\t\t}).join(\"&\");\r\n\t}\r\n\r\n\t/**\r\n\t * Deep trim trailing whitespace in object\r\n\t *\r\n\t * @param {string[]} array\r\n\t * @returns {string[]}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic deepObjectTrim(objectToTrim: Object): Object {\r\n\t\tconst deepTrim = (object: any) => {\r\n\t\t\tconst properties = Object.keys(object);\r\n\t\t\tproperties.forEach((property: string) => {\r\n\t\t\t\tif (typeof object[property] === \"string\") {\r\n\t\t\t\t\tobject[property] = object[property].trim();\r\n\t\t\t\t} else if (typeof object[property] === \"object\") {\r\n\t\t\t\t\tdeepTrim(object[property]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tdeepTrim(objectToTrim);\r\n\t\treturn objectToTrim;\r\n\t}\r\n\r\n\tstatic getListFromMap<T>(list: IMap<T[]>): T[] {\r\n\t\tlet arrayList: T[] = [];\r\n\t\tfor (const key in list) {\r\n\t\t\tarrayList = arrayList.concat(list[key]);\r\n\t\t}\r\n\t\treturn arrayList;\r\n\t}\r\n\r\n\t/**\r\n\t * Sorts an object based on selected property\r\n\t *\r\n\t * @static\r\n\t * @template T\r\n\t * @param {any[]} object\r\n\t * @param {string} property\r\n\t * @returns {any[]}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic sortObjectByProperty(object: any[], property: string, reverse = false): any[] {\r\n\t\tconst output = reverse ? [1, -1] : [-1, 1];\r\n\t\treturn object.sort((a, b): number => {\r\n\t\t\tif (a[property] < b[property]) {\r\n\t\t\t\treturn output[0];\r\n\t\t\t}\r\n\t\t\tif (a[property] > b[property]) {\r\n\t\t\t\treturn output[1];\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t}\r\n\r\n\tstatic sortObjectKeys<T>(unordered: IMap<T>, doNotSortKey?: string): IMap<T> {\r\n\t\tconst ordered: IMap<T> = {};\r\n\t\tconst sortedKeys = Object.keys(unordered).sort();\r\n\r\n\t\tif (doNotSortKey) {\r\n\t\t\tsortedKeys.splice(sortedKeys.indexOf(doNotSortKey), 1);\r\n\t\t\tsortedKeys.unshift(doNotSortKey);\r\n\t\t}\r\n\r\n\t\tsortedKeys.forEach(key => {\r\n\t\t\tordered[key] = unordered[key];\r\n\t\t});\r\n\r\n\t\treturn ordered;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if object has property with value\r\n\t *\r\n\t * @static\r\n\t * @template T\r\n\t * @param {*} object\r\n\t * @param {T} value\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic objectHasValue<T>(object: any, value: T): boolean {\r\n\t\tconst keys = Object.keys(object);\r\n\t\treturn keys.some((key: string) => {\r\n\t\t\treturn object[key] === value;\r\n\t\t});\r\n\t}\r\n\r\n\tstatic objectHasKey<T>(object: any, value: string): boolean {\r\n\t\tconst keys = Object.keys(object);\r\n\t\treturn keys.some((key: string) => {\r\n\t\t\treturn key === value;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Compares one or two lists if its total exceeds limit\r\n\t *\r\n\t * @static\r\n\t * @param {number} limit\r\n\t * @param {any[]} listA\r\n\t * @param {any[]} [listB]\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic exceedAllowed(limit: number, listA: any[], listB?: any[]): boolean {\r\n\t\tconst numberOfNewDatasource = listB ? listB.length : 1;\r\n\t\tconst totalDatasources = listA.length + numberOfNewDatasource;\r\n\r\n\t\treturn totalDatasources > limit;\r\n\t}\r\n\r\n\t/**\r\n\t * Wrap key(s) in brackets. Good to use if property contains spaces\r\n\t *\r\n\t * @static\r\n\t * @param {string} key\r\n\t * @returns {string}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic wrapKeyInBrackets(key: string): string {\r\n\t\tconst wrapInBrackets = (item: string) => { return \"['\" + item + \"']\"; };\r\n\t\tlet sanitizedSourceKey = [];\r\n\t\tif (key.indexOf(\" \") && key.indexOf(\".\")) {\r\n\t\t\tsanitizedSourceKey = key.split(\".\").map(wrapInBrackets);\r\n\t\t} else {\r\n\t\t\tsanitizedSourceKey.push(wrapInBrackets(key));\r\n\t\t}\r\n\t\treturn sanitizedSourceKey.join(\"\");\r\n\t}\r\n\r\n\tstatic cleanNulls(obj: IMap<any>): void {\r\n\t\tfor (const propName in obj) {\r\n\t\t\tif (obj[propName] === null || obj[propName] === undefined) {\r\n\t\t\t\tdelete obj[propName];\r\n\t\t\t} else if (typeof obj[propName] === \"object\") {\r\n\t\t\t\tHelper.cleanNulls(obj[propName]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a string clean from new lines and tabs caused by using template literal\r\n\t * @param templateLiteral\r\n\t */\r\n\tstatic cleanTemplateLiteral(templateLiteral: string): string {\r\n\t\treturn templateLiteral\r\n\t\t\t.replace(/(\\r\\n\\t|\\n|\\r\\t)/gm, \"\")\r\n\t\t\t.replace(/[\\t]+/gm, \"\");\r\n\t}\r\n\r\n\t/**\r\n\t * Method to HTML encode any string so it can safely be used in UI\r\n\t * @param value\r\n\t * @returns HTML encoded value\r\n\t */\r\n\tstatic htmlEncode(value: string): string {\r\n\t\treturn $(\"<div/>\").text(value).html();\r\n\t}\r\n\r\n\t/**\r\n\t * Method to HTML decode any string, reverse method of htmlEncode\r\n\t * @param value\r\n\t * @returns HTML value\r\n\t */\r\n\tstatic htmlDecode(value: string): string {\r\n\t\treturn $(\"<div/>\").html(value).text();\r\n\t}\r\n\r\n\tstatic isMobile(): boolean {\r\n\t\treturn /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n\t}\r\n\r\n\t/** Generate unique id. The ID is calculated by current time + a random number\r\n\t*\r\n\t* @return A unique ID\r\n\t*/\r\n\tstatic generateUniqueId(): string {\r\n\t\treturn (new Date()).getTime() + \"\" + Math.floor((Math.random() * Numbers.MILLION) + 1);\r\n\t}\r\n\r\n\t/**\r\n\t * Add the suffix \"_copy\" and a number, depending on the conflicting candidates\r\n\t * As the items in conflictingCandidates can be anything now, this function also checks\r\n\t * that this is a proper string\r\n\t *\r\n\t * @param {string} oldDisplayName\r\n\t * @param {string[]} conflictingCandidates\r\n\t *\r\n\t */\r\n\tstatic generateNewDisplayName(oldDisplayName: string, conflictingCandidates: Array<any> = []): string {\r\n\t\tif (!oldDisplayName) {\r\n\t\t\treturn \"Lasagna al forno\";\r\n\t\t}\r\n\t\tconst splitCopyNumber = /(.+?)(_[Cc]opy(\\d*))?$/;\r\n\t\tlet newDisplayName: string;\r\n\t\tconst splitOldDisplayName = oldDisplayName.match(splitCopyNumber);\r\n\t\tconst oldDisplayNameBase = splitOldDisplayName[1];\r\n\t\tconst numbers: number[] = [];\r\n\t\tconflictingCandidates.filter((maybeString: any) => {\r\n\t\t\treturn (typeof maybeString === \"string\") ? true : false;\r\n\t\t}).forEach((conflictCandidate: string) => {\r\n\t\t\tconst matches = conflictCandidate.match(splitCopyNumber);\r\n\t\t\tconst candidateBaseName = matches[RegExpMatchCandidate.BASE_NAME];\r\n\t\t\tconst candidateIsCopy = Boolean(matches[RegExpMatchCandidate.IS_COPY]);\r\n\t\t\tconst candidateNumber = parseInt(matches[RegExpMatchCandidate.NUMBER]);\r\n\r\n\t\t\tif (oldDisplayNameBase === candidateBaseName && candidateIsCopy) {\r\n\t\t\t\tif (candidateNumber) {\r\n\t\t\t\t\tnumbers.push(parseInt(matches[RegExpMatchCandidate.NUMBER]));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnumbers.push(1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tnewDisplayName = oldDisplayNameBase + ComponentConstants.COPY_SUFFIX;\r\n\t\tif (numbers.length > 0) {\r\n\t\t\tconst highestNum = numbers.sort((a: number, b: number) => {\r\n\t\t\t\treturn a - b;\r\n\t\t\t}).pop();\r\n\t\t\tnewDisplayName += (highestNum + 1);\r\n\t\t}\r\n\t\treturn newDisplayName;\r\n\t}\r\n\r\n\t/**\r\n\t* Can be used for any array with a name-property in it to\r\n\t* populate a list with only the names.\r\n\t*\r\n\t* @param {any[]} items\r\n\t* @returns {string[]}\r\n\t* @memberof Helper\r\n\t*\r\n\t*/\r\n\tstatic getListNames(items: any[]): string[] {\r\n\t\tconst itemNames: string[] = [];\r\n\t\titems.forEach((item) => {\r\n\t\t\titemNames.push((item as any).name);\r\n\t\t});\r\n\t\treturn itemNames;\r\n\t}\r\n\r\n\tstatic getProposedNewDisplayName(projectName: string, projects: IProjectInfo[], exceptID?: string): string {\r\n\t\tlet proposedName = projectName;\r\n\t\tconst recursiveInnerFunction = (counter: number): string => {\r\n\r\n\t\t\tfor (const index in projects) {\r\n\t\t\t\tif (exceptID && exceptID === projects[index].manifest.id) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (projects[index].manifest.displayName === proposedName) {\r\n\t\t\t\t\tproposedName = projectName + counter;\r\n\t\t\t\t\treturn recursiveInnerFunction(counter + 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn proposedName;\r\n\t\t};\r\n\r\n\t\treturn recursiveInnerFunction(1);\r\n\t}\r\n\r\n\tstatic joinWithDefauldEmptyString(stringArray: string[], joinChar: string): string {\r\n\t\tif (this.isUndefined(joinChar)) {\r\n\t\t\tjoinChar = \"\";\r\n\t\t}\r\n\t\treturn stringArray.join(joinChar);\r\n\t}\r\n\r\n\tstatic appIsReadyForSelenium(): void {\r\n\t\tangular.element(\".\" + CSSClasses.mashupRootContainer).data(ElementDataKeys.isMashupReady, true);\r\n\t}\r\n\r\n\t/**\r\n\t *\tParse query string key-value pairs into a dictionary.\r\n\t\t* @param query a query-string, e.g '?a=1&b=2' or 'x=y'\r\n\t\t*/\r\n\tstatic parseQueryString(query: string): IMap<string> {\r\n\t\tconst rPlus = /\\+/g;\r\n\t\tconst rQueryParameter = /([^&=]+)=?([^&]*)/g;\r\n\t\tconst decode = (uriEncodedText: string) => decodeURIComponent(uriEncodedText.replace(rPlus, \" \"));\r\n\t\tconst urlParams: IMap<string> = {};\r\n\r\n\t\tlet match = rQueryParameter.exec(query);\r\n\t\twhile (match) {\r\n\t\t\tconst nameIndex = 1;\r\n\t\t\tconst valueIndex = 2;\r\n\t\t\tconst name = decode(match[nameIndex]);\r\n\t\t\tconst value = decode(match[valueIndex]);\r\n\t\t\turlParams[name] = value;\r\n\t\t\tmatch = rQueryParameter.exec(query);\r\n\t\t}\r\n\t\treturn urlParams;\r\n\t}\r\n\r\n\t/**\r\n\t * Will trim value if it is string and return it\r\n\t * @param value\r\n\t */\r\n\tstatic trimIfPossible(value: any): string {\r\n\t\tif (typeof value === \"string\") {\r\n\t\t\tvalue = value.trim(); // Trim used to fix MI problem\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if Safari\r\n\t *\r\n\t * @static\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic isSafari(): boolean {\r\n\t\tconst myWindow: any = window;\r\n\t\tconst isChrome = !!myWindow.chrome && !!myWindow.chrome.webstore;\r\n\t\treturn (Object.prototype.toString.call(myWindow.HTMLElement).indexOf(\"Constructor\") > 0 ||\r\n\t\t\t!isChrome && myWindow.webkitAudioContext !== undefined);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if Edge\r\n\t *\r\n\t * @static\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic isEdge(): boolean {\r\n\t\treturn window.navigator.userAgent.indexOf(\"Edge\") > -1;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if IE\r\n\t *\r\n\t * @static\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic isIE(): boolean {\r\n\t\treturn /*@cc_on!@*/false || !!(document as any).documentMode;\r\n\t}\r\n\r\n\tstatic convertBase64ToSaveableBlob(base64String: string, type: { type: string }): SmartBlob {\r\n\t\tconst byteString = atob(base64String);\r\n\t\tconst arrayBuffer = new ArrayBuffer(byteString.length);\r\n\t\tconst ia = new Uint8Array(arrayBuffer);\r\n\r\n\t\tfor (let i = 0; i < byteString.length; i++) {\r\n\t\t\tia[i] = byteString.charCodeAt(i);\r\n\t\t}\r\n\r\n\t\treturn new SmartBlob([arrayBuffer], type);\r\n\t}\r\n\r\n\tstatic getBase64FileExtension(value: string): string {\r\n\t\t//tslint:disable-next-line:no-magic-numbers\r\n\t\tconst data = value.substring(0, 5);\r\n\r\n\t\tswitch (data.toUpperCase()) {\r\n\t\t\tcase \"IVBOR\":\r\n\t\t\t\treturn \"png\";\r\n\t\t\tcase \"/9J/4\":\r\n\t\t\t\treturn \"jpeg\";\r\n\t\t\tcase \"R0lGO\":\r\n\t\t\t\treturn \"gif\";\r\n\t\t\tcase \"UklGR\":\r\n\t\t\t\treturn \"webp\";\r\n\t\t\tcase \"AAAAF\":\r\n\t\t\t\treturn \"mp4\";\r\n\t\t\tcase \"JVBER\":\r\n\t\t\t\treturn \"pdf\";\r\n\t\t\tcase \"AAABA\":\r\n\t\t\t\treturn \"ico\";\r\n\t\t\tcase \"UMFYI\":\r\n\t\t\t\treturn \"rar\";\r\n\t\t\tcase \"E1XYD\":\r\n\t\t\t\treturn \"rtf\";\r\n\t\t\tcase \"U1PKC\":\r\n\t\t\t\treturn \"txt\";\r\n\t\t\tcase \"MQOWM\":\r\n\t\t\tcase \"77U/M\":\r\n\t\t\t\treturn \"srt\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tstatic parseBase64(value: string): string {\r\n\t\tif (value.indexOf(\"data\") === -1) {\r\n\t\t\tconst extension = this.getBase64FileExtension(value);\r\n\r\n\t\t\treturn `data:image/${extension};base64,${value}`\r\n\t\t\t\t.replace(RegexStrings.NEW_LINES, \"\");\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if two arrays of objects are different.\r\n\t *\r\n\t * @static\r\n\t * @param array1 First Array\r\n\t * @param array2 Second Array\r\n\t * @return True if the arrays are different, otherwise false.\r\n\t */\r\n\tstatic isDifferent(array1: any[], array2: any[]): boolean {\r\n\t\tfunction compare(x: any[], y: any[]): any[] {\r\n\t\t\treturn filter(x, (object) => {\r\n\t\t\t\treturn !find(y, object);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn union(compare(array1, array2), compare(array2, array1)).length > 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove an item from list by index number.\r\n\t * This is a mutable change\r\n\t */\r\n\tstatic removeItemFromListByIndex(list: any[], index: number): void {\r\n\t\tlist.splice(index, 1);\r\n\t}\r\n\r\n\tstatic instanceOfLayoutComponent(object: any): object is ILayoutComponent {\r\n\t\treturn \"children\" in object;\r\n\t}\r\n\r\n\tstatic instanceOfListComponent(object: any): object is IListComponent {\r\n\t\treturn \"children\" in object;\r\n\t}\r\n\r\n\tstatic isFirstCharLetter(string: string): boolean {\r\n\t\treturn RegexStrings.FIRST_CHAR_LETTER.test(string);\r\n\t}\r\n}\r\n\r\nexport class SmartBlob {\r\n\tprivate smartBlob: Blob;\r\n\r\n\tconstructor(blobParts?: any[], type?: BlobPropertyBag) {\r\n\t\tthis.smartBlob = new Blob(blobParts, type);\r\n\t}\r\n\r\n\t/**\r\n\t * Save Blob to disk\r\n\t * @param fileName\r\n\t */\r\n\tsaveAs(fileName: string): void {\r\n\t\tif (Helper.isIE() || window.navigator.msSaveOrOpenBlob) {\r\n\t\t\twindow.navigator.msSaveOrOpenBlob(this.smartBlob, fileName);\r\n\t\t} else {\r\n\t\t\tconst url = URL.createObjectURL(this.smartBlob);\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = fileName;\r\n\t\t\tdocument.body.appendChild(a);\r\n\t\t\ta.click();\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tdocument.body.removeChild(a);\r\n\t\t\t\twindow.URL.revokeObjectURL(url);\r\n\t\t\t}, 0);\r\n\r\n\t\t}\r\n\t}\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDialog } from \"./services/dialog-service\";\r\n\r\nexport interface IDialogBaseScope<ParameterType> extends ng.IScope {\r\n\teirDialog: IDialog<ParameterType>;\r\n}\r\n\r\nexport class ViewEnum {\r\n\tpublic static EDITOR = new ViewEnum(\"editor\");\r\n\tpublic static DASHBOARD = new ViewEnum(\"dashboard\");\r\n\tpublic static REPOSITORY = new ViewEnum(\"repository\");\r\n\tpublic static ADMIN = new ViewEnum(\"admin\");\r\n\r\n\tconstructor(public value: string) {\r\n\t}\r\n}\r\n\r\nexport enum KeyCodeEnum {\r\n\tBACKSPACE = 8,\r\n\tTAB = 9,\r\n\tENTER = 13,\r\n\tSHIFT = 16,\r\n\tCTRL = 17,\r\n\tALT = 18,\r\n\tPAUSE = 19,\r\n\tCAPS_LOCK = 20,\r\n\tESCAPE = 27,\r\n\tSPACE = 32,\r\n\tPAGE_UP = 33,\r\n\tPAGE_DOWN = 34,\r\n\tEND = 35,\r\n\tHOME = 36,\r\n\tLEFT_ARROW = 37,\r\n\tUP_ARROW = 38,\r\n\tRIGHT_ARROW = 39,\r\n\tDOWN_ARROW = 40,\r\n\tINSERT = 45,\r\n\tDELETE = 46,\r\n\tKEY_0 = 48,\r\n\tKEY_1 = 49,\r\n\tKEY_2 = 50,\r\n\tKEY_3 = 51,\r\n\tKEY_4 = 52,\r\n\tKEY_5 = 53,\r\n\tKEY_6 = 54,\r\n\tKEY_7 = 55,\r\n\tKEY_8 = 56,\r\n\tKEY_9 = 57,\r\n\tKEY_A = 65,\r\n\tKEY_B = 66,\r\n\tKEY_C = 67,\r\n\tKEY_D = 68,\r\n\tKEY_E = 69,\r\n\tKEY_F = 70,\r\n\tKEY_G = 71,\r\n\tKEY_H = 72,\r\n\tKEY_I = 73,\r\n\tKEY_J = 74,\r\n\tKEY_K = 75,\r\n\tKEY_L = 76,\r\n\tKEY_M = 77,\r\n\tKEY_N = 78,\r\n\tKEY_O = 79,\r\n\tKEY_P = 80,\r\n\tKEY_Q = 81,\r\n\tKEY_R = 82,\r\n\tKEY_S = 83,\r\n\tKEY_T = 84,\r\n\tKEY_U = 85,\r\n\tKEY_V = 86,\r\n\tKEY_W = 87,\r\n\tKEY_X = 88,\r\n\tKEY_Y = 89,\r\n\tKEY_Z = 90,\r\n\tLEFT_META = 91,\r\n\tRIGHT_META = 92,\r\n\tSELECT = 93,\r\n\tNUMPAD_0 = 96,\r\n\tNUMPAD_1 = 97,\r\n\tNUMPAD_2 = 98,\r\n\tNUMPAD_3 = 99,\r\n\tNUMPAD_4 = 100,\r\n\tNUMPAD_5 = 101,\r\n\tNUMPAD_6 = 102,\r\n\tNUMPAD_7 = 103,\r\n\tNUMPAD_8 = 104,\r\n\tNUMPAD_9 = 105,\r\n\tMULTIPLY = 106,\r\n\tADD = 107,\r\n\tSUBTRACT = 109,\r\n\tDECIMAL = 110,\r\n\tDIVIDE = 111,\r\n\tF1 = 112,\r\n\tF2 = 113,\r\n\tF3 = 114,\r\n\tF4 = 115,\r\n\tF5 = 116,\r\n\tF6 = 117,\r\n\tF7 = 118,\r\n\tF8 = 119,\r\n\tF9 = 120,\r\n\tF10 = 121,\r\n\tF11 = 122,\r\n\tF12 = 123,\r\n\tNUM_LOCK = 144,\r\n\tSCROLL_LOCK = 145,\r\n\tSEMICOLON = 186,\r\n\tEQUALS = 187,\r\n\tCOMMA = 188,\r\n\tDASH = 189,\r\n\tPERIOD = 190,\r\n\tFORWARD_SLASH = 191,\r\n\tGRAVE_ACCENT = 192,\r\n\tOPEN_BRACKET = 219,\r\n\tBACK_SLASH = 220,\r\n\tCLOSE_BRACKET = 221,\r\n\tSINGLE_QUOTE = 222,\r\n\tLESS_THAN = 226\r\n}\r\n\r\nexport interface IComponentStyle extends JQLiteCssProperties {\r\n\twidth: string;\r\n\theight: string;\r\n\tmargin?: string;\r\n\tdisplay?: string;\r\n}\r\n\r\nexport interface ILayoutComponentStyle extends IComponentStyle {\r\n\tpadding?: string;\r\n}\r\n\r\nexport interface ITabStyle extends ILayoutComponentStyle {\r\n\r\n}\r\n\r\nexport interface IFlexboxStyle extends ILayoutComponentStyle {\r\n\tbackgroundColor?: string;\r\n\tflexGrow?: number;\r\n\tflexShrink?: number;\r\n\tflexBasis?: string;\r\n}\r\n\r\nexport interface IComponentElement extends ng.IAugmentedJQuery {\r\n\t// scope: () => IComponentScope;\r\n}\r\n\r\nexport interface IAvailableSourceField extends IMap<string> {\r\n\tvisibleName: string;\r\n\tsourceKey: string;\r\n\tsourceKeyShort: string;\r\n\tcurrentValue?: any;\r\n\ttype?: string;\r\n}\r\n\r\nexport interface IJQueryScrollEventObject extends JQueryEventObject {\r\n\tcurrentTarget: HTMLElement;\r\n}\r\n\r\nexport interface IJQueryDragEventObject extends JQueryEventObject {\r\n\toriginalEvent: DragEvent;\r\n}\r\n\r\nexport interface IJQueryMouseEventObject extends JQueryInputEventObject {\r\n\tbutton: number;\r\n\tclientX: number;\r\n\tclientY: number;\r\n\toffsetX: number;\r\n\toffsetY: number;\r\n\toriginalEvent: MouseEvent;\r\n\tpageX: number;\r\n\tpageY: number;\r\n\tscreenX: number;\r\n\tscreenY: number;\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport {\r\n\tCanvasModeEnum,\r\n\tComponentConstants,\r\n\tIComponentTranslation,\r\n\tInjectNames,\r\n\tIWizardFocusType,\r\n\tSaveFlagsEnum,\r\n\tSettingKeys,\r\n\tThemeEnum,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\n\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport type { IJsonDatagrid } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJsonList } from \"ng2/common/model/databearer/components/json-list.model\";\r\nimport type { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport type { IJsonLanguageComponent, ILanguage } from \"ng2/common/model/language.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\n\r\nimport type { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type {\r\n\tIJsonRadioButtons,\r\n\tIRadioButton\r\n} from \"common/model/component/radiobutton.model\";\r\nimport type { IJsonTabs } from \"common/model/component/tabs.model\";\r\nimport type { IAlias } from \"editor/component-settings/build-link-dialog/build-link-dialog\";\r\n\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\n\r\nimport {\r\n\tIAvailableSourceField,\r\n\tViewEnum\r\n} from \"common/defines\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\n\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\nimport { Helper } from \"common/helper\";\r\nimport {\r\n\tDialogButtonType,\r\n\tDialogService,\r\n\tIDialogOptions,\r\n\tIDialogResult,\r\n} from \"common/services/dialog-service\";\r\nimport { ComponentsHelper } from \"components/helper\";\r\n\r\nimport { IFinderModeOptions } from \"designer/defines\";\r\nimport { EditorApplicationParent } from \"editor/components/editor-application-parent\";\r\nimport type { IEditorLayoutComponent } from \"editor/components/editor-layout-component\";\r\nimport {\r\n\tISidebarView,\r\n\tSidebarViewEnum\r\n} from \"editor/defines\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { Defines } from \"components/defines\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\nimport { DesignerService } from \"designer/services/designer-service\";\r\nimport { SaveService } from \"editor/services/save-service\";\r\nimport { UndoService } from \"editor/services/undo-service\";\r\nimport { BindingManagementService } from \"editor/services/binding-management-service\";\r\n\r\nimport { ApplicationParent } from \"components/application-parent\";\r\nimport { Datagrid } from \"components/datagrid/datagrid\";\r\nimport { Flexbox } from \"components/flexbox/flexbox\";\r\nimport { List } from \"components/list/list\";\r\nimport { Lookup } from \"components/lookup/lookup\";\r\nimport { RadioButton } from \"components/radiobutton/radiobutton\";\r\nimport { TabPanel } from \"components/tabs/tab-panel\";\r\n\r\nexport class EditorService {\r\n\tpublic multiInsert: boolean;\r\n\tpublic translationChangedEvent = new InstanceEvent<IComponentTranslation>();\r\n\tpublic projectBoundariesChangedEvent = new InstanceEvent<IBoundary[]>();\r\n\tpublic finderComponentSelectedEvent = new InstanceEvent<IEditorComponent>();\r\n\tpublic canvasModeChangedEvent = new InstanceEvent<CanvasModeEnum>();\r\n\r\n\tpublic sidebarViewChangedEvent = new InstanceEvent<ISidebarView>();\r\n\tpublic sidebarChangedEvent = new InstanceEvent<boolean>();\r\n\tprivate currentSidebarTab: string = \"style\";\r\n\r\n\tpublic selectedComponentChangedEvent = new InstanceEvent<IEditorComponent>();\r\n\tpublic selectedInteractionChangedEvent = new InstanceEvent<IInteraction>();\r\n\tpublic selectedDatasourceChangedEvent = new InstanceEvent<IDatasource>();\r\n\r\n\t//This is needed to refresh the orientation-setting when changed somewhere else.\r\n\tpublic refreshSettingEvent = new InstanceEvent<string>();\r\n\r\n\tpublic currentFlexOrientationChangedEvent = new InstanceEvent<OrientationEnum>();\r\n\tpublic currentFlexIsParentChangedEvent = new InstanceEvent<boolean>();\r\n\r\n\tpublic triggerSourceComponentChangedEvent = new InstanceEvent<IEditorComponent>();\r\n\tpublic targetActionComponentChangedEvent = new InstanceEvent<IEditorComponent>();\r\n\tpublic wizardFocusComponentChangedEvent = new InstanceEvent<IWizardFocusType>();\r\n\tpublic finderModeChangedEvent = new InstanceEvent<boolean>();\r\n\tpublic wizardSetFinderModeEvent = new InstanceEvent<string>();\r\n\tpublic wizardCloseEvent = new InstanceEvent();\r\n\tpublic wizardTickChangedEvent = new InstanceEvent<number>();\r\n\tpublic newWizardInteractionEvent = new InstanceEvent<IInteraction>();\r\n\tpublic isWizardChangedEvent = new InstanceEvent<boolean>();\r\n\tpublic setSourceTriggerEvent = new InstanceEvent<IDataPair>();\r\n\tpublic setTargetActionEvent = new InstanceEvent<IDataPair>();\r\n\tpublic removeSelectedInteractionEvent = new InstanceEvent<Interaction>();\r\n\tpublic cancelInsertEvent = new InstanceEvent<void>();\r\n\r\n\tpublic compositeComponentsChangedEvent = new InstanceEvent<IJsonCompositeComponent[]>();\r\n\r\n\tpublic currentBoundaryChangedEvent: InstanceEvent<IBoundary>;\r\n\tpublic currentCanvasThemeChangedEvent: InstanceEvent<ThemeEnum>;\r\n\r\n\tpublic toggleCanvasChangedEvent = new InstanceEvent<boolean>();\r\n\r\n\tpublic projectSettingsChangedEvent = new InstanceEvent<IDesignerManifest>();\r\n\tpublic hyperlinkAliasChangedEvent = new InstanceEvent<IAlias>();\r\n\r\n\tpublic urlVariableChangedEvent = new InstanceEvent<void>();\r\n\r\n\tprivate canvasMode: CanvasModeEnum;\r\n\tprivate finderModeOptions: IFinderModeOptions;\r\n\tprivate sidebarView = SidebarViewEnum.NEW_COMPONENT;\r\n\tprivate isSidebarVisible = true;\r\n\tprivate selectedComponent: IEditorComponent;\r\n\tprivate hoveredComponent: IEditorComponent;\r\n\tprivate finderComponent: IEditorComponent;\r\n\tprivate idCounter = 0;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.SAVE_SERVICE,\r\n\t\tInjectNames.DESIGNER_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.BINDING_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.UNDO_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate saveService: SaveService,\r\n\t\tprivate designerService: DesignerService,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate bindingManagementService: BindingManagementService,\r\n\t\tprivate undoService: UndoService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\r\n\t\tthis.projectSettingsChangedEvent = designerService.projectSettingsChangedEvent;\r\n\t\tthis.currentBoundaryChangedEvent = designerService.currentBoundaryChangedEvent;\r\n\t\tthis.currentCanvasThemeChangedEvent = designerService.currentCanvasThemeChangedEvent;\r\n\r\n\t\tthis.currentBoundaryChangedEvent.on((boundary) => {\r\n\t\t\tif (this.selectedComponent &&\r\n\t\t\t\tthis.selectedComponent.getTypedef() === Flexbox.name\r\n\t\t\t) {\r\n\t\t\t\tconst currentOrientation =\r\n\t\t\t\t\tthis.selectedComponent.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, boundary.id);\r\n\t\t\t\tthis.currentFlexOrientationChangedEvent.raise(currentOrientation);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.sidebarChangedEvent.on((value: boolean) => {\r\n\t\t\tthis.setSidebarVisibility(value);\r\n\t\t});\r\n\r\n\t\tthis.selectedComponentChangedEvent.on((component) => {\r\n\t\t\tif (component) {\r\n\t\t\t\tthis.setSidebarView(SidebarViewEnum.SETTINGS);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setSidebarView(SidebarViewEnum.NEW_COMPONENT);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.projectSettingsChangedEvent.on((manifest: IDesignerManifest) => {\r\n\t\t\tif (manifest) {\r\n\t\t\t\tthis.designerService.setCanvasTheme(manifest.defaultTheme ? manifest.defaultTheme : ThemeEnum.LIGHT);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic loadProject(projectId: string, canvasWidth: number): ng.IPromise<DesignerMashup> {\r\n\t\treturn this.designerService.loadProject(projectId, canvasWidth)\r\n\t\t\t.then((project: DesignerMashup) => {\r\n\t\t\t\tconst ids: string[] = [];\r\n\r\n\t\t\t\tthis.forEachComponent(project.rootComponent, (component) => {\r\n\t\t\t\t\t// removing this for now, this interups the translation feature quite heavily\r\n\t\t\t\t\t// and as we don't fully support MG -> AB yet I don't see this as a major issue\r\n\t\t\t\t\t// MUPS-2419\r\n\t\t\t\t\t//this.syncComponentTranslations(component);\r\n\t\t\t\t\tids.push(component.id);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.idCounter = ComponentsHelper.nextNumber(ids);\r\n\r\n\t\t\t\tids.sort();\r\n\t\t\t\tfor (var index = 0; index < ids.length; index++) {\r\n\t\t\t\t\tif (ids[index] === ids[index + 1]) {\r\n\t\t\t\t\t\tconsole.warn(\"[EditorService] Duplicate ids on components\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn project;\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic setView(): void {\r\n\t\tthis.designerService.setView(ViewEnum.EDITOR);\r\n\t}\r\n\r\n\tpublic setCurrentSidebarTab(tabView: string): void {\r\n\t\tthis.currentSidebarTab = tabView;\r\n\t}\r\n\r\n\tpublic getCurrentSidebarTab(): string {\r\n\t\treturn this.currentSidebarTab;\r\n\t}\r\n\r\n\tpublic unloadProject(): void {\r\n\t\tthis.designerService.unloadProject();\r\n\t}\r\n\r\n\tpublic updateCurrentBoundary(canvasWidth: number): void {\r\n\t\tthis.designerService.updateCurrentBoundary(canvasWidth);\r\n\t}\r\n\r\n\tpublic clearIdCounter(): void {\r\n\t\tthis.idCounter = 0;\r\n\t}\r\n\r\n\tpublic generateId(componentTypeName: string): string {\r\n\t\tconst newId = componentTypeName + this.idCounter++;\r\n\t\tconst components = this.getAllComponents();\r\n\t\tfor (const component in components) {\r\n\t\t\tif (components[component].getId() === newId) {\r\n\t\t\t\treturn this.generateId(componentTypeName);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newId;\r\n\t}\r\n\r\n\tpublic setTriggerSourceComponent(component: IEditorComponent): void {\r\n\t\tthis.triggerSourceComponentChangedEvent.raise(component);\r\n\t}\r\n\r\n\tpublic setTargetActionComponent(component: IEditorComponent): void {\r\n\t\tthis.targetActionComponentChangedEvent.raise(component);\r\n\t}\r\n\r\n\tpublic setFinderActivity(value: boolean): void {\r\n\t\tthis.finderModeChangedEvent.raise(value);\r\n\t}\r\n\r\n\tpublic setSourceTrigger(sourceTrigger: IDataPair): void {\r\n\t\tthis.setSourceTriggerEvent.raise(sourceTrigger);\r\n\t}\r\n\r\n\tpublic setTargetAction(targetAction: IDataPair): void {\r\n\t\tthis.setTargetActionEvent.raise(targetAction);\r\n\t}\r\n\r\n\tpublic setWizardFocusComponent(focus: number, component: IJsonComponent, setting: string): void {\r\n\t\tconst focusSettings: IWizardFocusType = {\r\n\t\t\tfocus: focus,\r\n\t\t\tcomponent: component,\r\n\t\t\tsetting: setting\r\n\t\t};\r\n\t\tthis.wizardFocusComponentChangedEvent.raise(focusSettings);\r\n\t}\r\n\r\n\tpublic deselectComponent(): void {\r\n\t\tthis.setSelectedComponent(null);\r\n\t}\r\n\r\n\tpublic isRuntimeMode(): boolean {\r\n\t\treturn this.getCanvasMode() === CanvasModeEnum.RUNTIME;\r\n\t}\r\n\r\n\tpublic saveCanvas(): ng.IPromise<void> {\r\n\t\tconst project = this.getCurrentProject();\r\n\t\tthis.addUndoStack(project);\r\n\t\treturn this.saveService.save(project, SaveFlagsEnum.CANVAS_COMPONENTS);\r\n\t}\r\n\r\n\tpublic addUndoStack(project: DesignerMashup): void {\r\n\t\tthis.undoService.pushUndoAction(project);\r\n\t}\r\n\r\n\tpublic saveCurrent(flags: SaveFlagsEnum): ng.IPromise<void> {\r\n\t\tconst canvasMode = this.getCanvasMode();\r\n\t\tif (canvasMode === CanvasModeEnum.WIZARD) {\r\n\t\t\treturn this.getNewDeferred<void>().promise;\r\n\t\t}\r\n\t\tif (flags === SaveFlagsEnum.INTERACTIONS) {\r\n\t\t\tthis.refreshLatestUndoStack();\r\n\t\t}\r\n\t\treturn this.saveService.save(this.getCurrentProject(), flags);\r\n\t}\r\n\r\n\tprivate refreshLatestUndoStack(): void {\r\n\t\tthis.undoService.pop();\r\n\t\tthis.undoService.pushUndoAction(this.getCurrentProject());\r\n\t}\r\n\r\n\tpublic renameProject(id: string, newDisplayName: string): ng.IPromise<IJsonManifest> {\r\n\t\treturn this.saveService.renameProject(id, newDisplayName);\r\n\t}\r\n\r\n\tpublic setSidebarView(view: SidebarViewEnum): void {\r\n\t\tif (this.sidebarView !== view) {\r\n\t\t\tthis.sidebarView = view;\r\n\t\t\tthis.raiseSidebarViewChanged();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setSidebarVisibility(isSidebarVisible: boolean): void {\r\n\t\tif (isSidebarVisible !== this.isSidebarVisible) {\r\n\t\t\tthis.isSidebarVisible = isSidebarVisible;\r\n\t\t\tthis.raiseSidebarViewChanged();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate raiseSidebarViewChanged(): void {\r\n\t\tthis.sidebarViewChangedEvent.raise(this.getSidebarView());\r\n\t}\r\n\r\n\tpublic getSidebarView(): ISidebarView {\r\n\t\treturn angular.copy({ view: this.sidebarView, isSidebarVisible: this.isSidebarVisible });\r\n\t}\r\n\r\n\tpublic setSelectedComponent(component: IEditorComponent): void {\r\n\t\tthis.setHoveredComponent();\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.selectedComponent.setIsSelected(false);\r\n\t\t}\r\n\r\n\t\tif (component) {\r\n\t\t\tcomponent.setIsSelected(true);\r\n\t\t\tcomponent.refreshMetaSettings();\r\n\t\t}\r\n\r\n\t\tthis.selectedComponent = component;\r\n\t\tthis.selectedComponentChangedEvent.raise(component);\r\n\t}\r\n\r\n\tpublic getSelectedComponent(): IEditorComponent {\r\n\t\treturn this.selectedComponent;\r\n\t}\r\n\r\n\tpublic setFinderComponent(component?: IEditorComponent): void {\r\n\t\tconst finderComponent = this.finderComponent;\r\n\t\tif (finderComponent) {\r\n\t\t\tfinderComponent.setIsFinder(false);\r\n\t\t}\r\n\r\n\t\tif (!component) {\r\n\t\t\tthis.finderComponent = null;\r\n\t\t} else if (this.canvasMode === CanvasModeEnum.FINDER) {\r\n\t\t\tcomponent.setIsFinder(true);\r\n\t\t\tthis.finderComponent = component;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Will return true or false if the given component can be Cut\r\n\t * If called without a component the current selected component is checked.\r\n\t * @param {IEditorComponent} component\r\n\t * @return {boolean} true/false\r\n\t */\r\n\tpublic canCut(component?: IEditorComponent): boolean {\r\n\t\tif (!component) {\r\n\t\t\tcomponent = this.getSelectedComponent();\r\n\t\t}\r\n\t\treturn component.canCut;\r\n\t}\r\n\r\n\t/**\r\n\t * Will return true or false if the given component can be Copied\r\n\t * If called without a component the current selected component is checked.\r\n\t * @param {IEditorComponent} component\r\n\t * @return {boolean} true/false\r\n\t */\r\n\tpublic canCopy(component?: IEditorComponent): boolean {\r\n\t\tif (!component) {\r\n\t\t\tcomponent = this.getSelectedComponent();\r\n\t\t}\r\n\t\treturn component.canCopy;\r\n\t}\r\n\r\n\t/**\r\n\t * Will return true or false if the given component can be Moved at all.\r\n\t * Currently checks for three cases:\r\n\t *\r\n\t * 1. If component exists.\r\n\t * 2. If component.parent is not an application parent.\r\n\t * 3. If component.isGenerated is false.\r\n\t *\r\n\t * If called without a component the current selected component is checked.\r\n\t * @param {IEditorComponent} component\r\n\t * @return {boolean} true/false\r\n\t */\r\n\tpublic isMovable(component?: IEditorComponent): boolean {\r\n\t\tif (!component) {\r\n\t\t\tcomponent = this.getSelectedComponent();\r\n\t\t}\r\n\t\treturn component && !(component.parent instanceof ApplicationParent) && !component.isGenerated;\r\n\t}\r\n\r\n\tpublic selectFinderComponent(component: IEditorComponent): void {\r\n\t\tif (component.setIsFinder) {\r\n\t\t\tcomponent.setIsFinder(false);\r\n\t\t}\r\n\t\tthis.finderComponentSelectedEvent.raise(component);\r\n\r\n\t\tif (this.finderModeOptions.closeOnSelect) {\r\n\t\t\tthis.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\t}\r\n\t}\r\n\r\n\t// Set currently hovered component, if no component is given the value is reset.\r\n\tpublic setHoveredComponent(component?: IEditorComponent): void {\r\n\t\tconst hoveredComponent = this.hoveredComponent;\r\n\t\tif (hoveredComponent) {\r\n\t\t\thoveredComponent.setIsHovered(false);\r\n\t\t}\r\n\t\tif (!component) {\r\n\t\t\tthis.hoveredComponent = null;\r\n\t\t} else if (this.canvasMode === CanvasModeEnum.SELECTION) {\r\n\t\t\tcomponent.setIsHovered(true);\r\n\t\t\tthis.hoveredComponent = component;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic startFinderMode(options: IFinderModeOptions): ng.IPromise<IEditorComponent> {\r\n\t\tconst defaultOptions: IFinderModeOptions = {\r\n\t\t\ttitle: \"\",\r\n\t\t\thideCancel: false,\r\n\t\t\tcloseOnSelect: true\r\n\t\t};\r\n\t\tconst previousMode = this.getCanvasMode();\r\n\r\n\t\tthis.finderModeOptions = angular.extend(defaultOptions, options);\r\n\r\n\t\tthis.finderModeOptions.cancel = () => {\r\n\t\t\tthis.setCanvasMode(previousMode);\r\n\t\t\tif (options.cancel) {\r\n\t\t\t\toptions.cancel();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.setCanvasMode(CanvasModeEnum.FINDER);\r\n\t\tconst deferred = this.$q.defer<IEditorComponent>();\r\n\r\n\t\tconst unsubscribeFinderComponent = this.finderComponentSelectedEvent.on((component: IEditorComponent) => {\r\n\t\t\tif (component) {\r\n\t\t\t\tdeferred.resolve(component);\r\n\t\t\t} else {\r\n\t\t\t\tdeferred.reject(null);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// To capture cancel events and make sure the events always are unregistered correctly\r\n\t\tconst unsubscribeCanvasMode = this.canvasModeChangedEvent.on((mode: CanvasModeEnum) => {\r\n\t\t\tif (mode !== CanvasModeEnum.FINDER) {\r\n\t\t\t\tunsubscribeCanvasMode();\r\n\t\t\t\tunsubscribeFinderComponent();\r\n\t\t\t\tdeferred.reject(null);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tpublic getFinderModeOptions(): IFinderModeOptions {\r\n\t\treturn this.finderModeOptions;\r\n\t}\r\n\r\n\t/**\r\n\t * Removes the finder component\r\n\t *\r\n\t * @memberof EditorService\r\n\t */\r\n\tpublic removeFinderComponent(): void {\r\n\t\tthis.setFinderComponent();\r\n\t}\r\n\r\n\tpublic setCanvasMode(newCanvasMode: CanvasModeEnum): void {\r\n\t\tconst canvasModeChanged = this.canvasMode !== newCanvasMode;\r\n\t\tconst isSelectionMode = newCanvasMode === CanvasModeEnum.SELECTION;\r\n\t\tconst isFinderMode = newCanvasMode === CanvasModeEnum.FINDER;\r\n\t\tconst isWizardMode = newCanvasMode === CanvasModeEnum.WIZARD;\r\n\r\n\t\tif (canvasModeChanged) {\r\n\t\t\tthis.canvasMode = newCanvasMode;\r\n\t\t\tthis.canvasModeChangedEvent.raise(newCanvasMode);\r\n\r\n\t\t\t// Deselect component if leaving selection or finder mode\r\n\t\t\tif (\r\n\t\t\t\tthis.selectedComponent\r\n\t\t\t\t&& isSelectionMode === false\r\n\t\t\t\t&& isFinderMode === false\r\n\t\t\t\t&& isWizardMode === false\r\n\t\t\t) {\r\n\t\t\t\tthis.deselectComponent();\r\n\t\t\t}\r\n\r\n\t\t\t// Reset the finder component when there is a component and mode is not findermode\r\n\t\t\tif (this.selectedComponent && isFinderMode === false) {\r\n\t\t\t\tthis.removeFinderComponent();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getCanvasMode(): CanvasModeEnum {\r\n\t\treturn this.canvasMode;\r\n\t}\r\n\r\n\tpublic triggerDatasourceChanged(datasource?: IDatasource): void {\r\n\t\tthis.selectedDatasourceChangedEvent.raise(datasource);\r\n\t}\r\n\r\n\tpublic getCurrentProject(): DesignerMashup {\r\n\t\treturn this.designerService.getCurrentProject() as DesignerMashup;\r\n\t}\r\n\r\n\tpublic getCurrentBoundary(): IBoundary {\r\n\t\treturn this.designerService.getCurrentBoundary();\r\n\t}\r\n\r\n\tpublic setCurrentBoundary(boundary: IBoundary): void {\r\n\t\tthis.designerService.setCurrentBoundary(boundary);\r\n\t}\r\n\r\n\tpublic getCurrentRootComponentInstance(): IEditorLayoutComponent {\r\n\t\treturn this.designerService.getCurrentRootComponentInstance() as IEditorLayoutComponent;\r\n\t}\r\n\r\n\tpublic setCurrentRootComponentInstance(component: ILayoutComponent): void {\r\n\t\tthis.designerService.setCurrentRootComponentInstance(component);\r\n\t}\r\n\r\n\tpublic setManifest(manifest: IDesignerManifest): void {\r\n\t\tthis.designerService.getCurrentProject().manifest = manifest;\r\n\t\tthis.projectSettingsChangedEvent.raise(manifest);\r\n\t}\r\n\r\n\tpublic getCurrentCanvasTheme(): ThemeEnum {\r\n\t\treturn this.designerService.getCanvasTheme();\r\n\t}\r\n\r\n\tpublic getApplicationParent(): EditorApplicationParent {\r\n\t\treturn (this.getCurrentRootComponentInstance().parent as EditorApplicationParent);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns all components or a subset of them if a filter function is provided\r\n\t *\r\n\t * @param filterFn a function that will be run for each component\r\n\t */\r\n\tpublic getAllComponents(filterFn?: (component: IEditorComponent) => boolean): IEditorComponent[] {\r\n\t\tconst componentList: IEditorComponent[] = [];\r\n\t\tif (!filterFn) {\r\n\t\t\tfilterFn = () => true;\r\n\t\t}\r\n\t\tthis.getCurrentRootComponentInstance().forEachChild((child: IEditorComponent) => {\r\n\t\t\tif (filterFn(child)) {\r\n\t\t\t\tcomponentList.push(child);\r\n\t\t\t}\r\n\t\t}, true);\r\n\t\treturn componentList;\r\n\t}\r\n\r\n\tpublic openURLDialog(): void {\r\n\t\tconst dialogOptions: IDialogOptions<void> = {\r\n\t\t\ttemplate: require(\"../url-settings/url-variable-dialog.html\"),\r\n\t\t\ttitle: \"Manage URL Variables\",\r\n\t\t\tcssClass: \"url-variable-dialog\"\r\n\t\t};\r\n\t\tthis.dialogService.show(dialogOptions).then((result: IDialogResult<IJsonUrlVariable[]>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.setUrlVariables(result.value).then(() => {\r\n\t\t\t\t\tthis.saveCurrent(SaveFlagsEnum.URL_VARIABLES);\r\n\t\t\t\t\tthis.urlVariableChangedEvent.raise();\r\n\t\t\t\t\tthis.initializeUrlBindings();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic initializeUrlBindings(newValue?: string, sourceKey?: string): void {\r\n\t\tthis.getAllComponents().forEach((component) => {\r\n\t\t\tlet hasUrlBinding = false;\r\n\t\t\tcomponent.forEachBindable( bindable => {\r\n\t\t\t\tconst field = component.getBindableField(bindable.ref);\r\n\t\t\t\tif (field && field.Type === BindingTypeEnum.URL_BINDING) {\r\n\t\t\t\t\tif (newValue && sourceKey && sourceKey === field.sourceKey) {\r\n\t\t\t\t\t\tfield.value = newValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\thasUrlBinding = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (hasUrlBinding) {\r\n\t\t\t\tcomponent.initializeBindings();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a list of components which can be used in interactions\r\n\t *\r\n\t * @returns {IEditorComponent[]}\r\n\t *\r\n\t * @memberOf EditorService\r\n\t */\r\n\tpublic getAllInteractiveComponents(): IEditorComponent[] {\r\n\t\tconst generatedIdsIterated: string[] = [];\r\n\t\treturn [this.getApplicationParent() as any].concat(this.getAllComponents((component) => {\r\n\t\t\tif (component.isGenerated) {\r\n\t\t\t\tif (generatedIdsIterated.indexOf(component.getId()) >= 0) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgeneratedIdsIterated.push(component.getId());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst componentClass = Defines.allComponents[component.getTypedef()].class;\r\n\t\t\tif (component.getDatasource() ||\r\n\t\t\t\tcomponentClass.SOURCE_TRIGGERS.length > 0 ||\r\n\t\t\t\tcomponentClass.TARGET_ACTIONS.length > 0\r\n\t\t\t) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}));\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a list of components which have bindable settings\r\n\t *\r\n\t * @returns {IEditorComponent[]}\r\n\t *\r\n\t * @memberOf EditorService\r\n\t */\r\n\tpublic getAllBindableComponents(): IEditorComponent[] {\r\n\t\treturn [this.getApplicationParent() as any].concat(this.getAllComponents((component) => {\r\n\t\t\treturn typeof component.exposesReadableBindables === \"function\"\r\n\t\t\t\t&& !component.isGenerated && component.exposesReadableBindables();\r\n\t\t}));\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a list of components which have translatable settings\r\n\t *\r\n\t * @returns {IEditorComponent[]}\r\n\t *\r\n\t * @memberOf EditorService\r\n\t */\r\n\tpublic getAllTranslatableComponents(): IEditorComponent[] {\r\n\t\treturn [this.getApplicationParent() as any].concat(this.getAllComponents((component) => {\r\n\t\t\treturn !component.isGenerated && component.exposesLocalizedBindables();\r\n\t\t}));\r\n\t}\r\n\r\n\t/**\r\n\t * Will copy a component with a given suffix or the default '_Copy'\r\n\t * Can also copy a layoutComponent\r\n\t * Will copy a component tree and generate new IDs for all components in the tree.\r\n\t * Top component will get the given suffix appended to its displayName (defaults to '_Copy')\r\n\t * Any collisions of the displayname will be resolved with a number\r\n\t *\r\n\t * Will fill the oldToNowIdMap with mappings from old ids to new\r\n\t *\r\n\t * @param {IJsonLayoutComponent} componentObject\r\n\t * @param {IMap<string>} oldToNewIdMap\r\n\t * @param {string} suffix\r\n\t * @return {IJsonLayoutComponent}\r\n\t */\r\n\tpublic copy<T extends IJsonComponent>(\r\n\t\tcomponentObject: T,\r\n\t\toldToNewIdMap: IMap<string> = {},\r\n\t\tsuffix: string = ComponentConstants.COPY_SUFFIX\r\n\t): T {\r\n\t\tconst copiedComponent = angular.copy(componentObject);\r\n\r\n\t\t//Tabpanel is not a tabpanel when you copy it. Set correct typedef\r\n\t\tif (copiedComponent.typedef === \"TabPanel\") {\r\n\t\t\tcopiedComponent.typedef = \"Flexbox\";\r\n\t\t}\r\n\r\n\t\tangular.extend(oldToNewIdMap, this.generateNewIdsForTree(copiedComponent));\r\n\t\t// Mapping Application -> Application\r\n\t\toldToNewIdMap[ApplicationParent.applicationParentDatabearer.id] =\r\n\t\t\tApplicationParent.applicationParentDatabearer.id;\r\n\t\tif (suffix !== \"\") { // Only generate new if a suffix is given\r\n\t\t\tcopiedComponent.displayName = this.getNewDisplayName(copiedComponent.displayName);\r\n\t\t}\r\n\r\n\t\tthis.redirectBindings(copiedComponent, oldToNewIdMap);\r\n\r\n\t\treturn copiedComponent;\r\n\t}\r\n\r\n\t// If there is a change in Mongoose it needs to be updated in the languageComponent as well.\r\n\tprivate syncComponentTranslations(component: IJsonComponent): void {\r\n\t\tthis.forEachBindable(component, (bindableField, currValueSource) => {\r\n\t\t\tif (currValueSource) {\r\n\t\t\t\tconst value = this.frameworkService.getTranslatableStringByProperty(component.id, bindableField.ref);\r\n\t\t\t\tif (value !== undefined && value !== currValueSource.value) {\r\n\t\t\t\t\tconst updatedTranslation: ILanguage = {\r\n\t\t\t\t\t\tlocale: this.frameworkService.getSelectedLocale(),\r\n\t\t\t\t\t\tvalue: currValueSource.value\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.frameworkService.setTranslatableStringByProperty(component.id, bindableField.ref, updatedTranslation);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate redirectBindings(newComponent: IJsonLayoutComponent, oldToNewIdMap: IMap<string>): void {\r\n\t\tthis.forEachComponent(newComponent, (component, index) => {\r\n\t\t\tthis.frameworkService.forEachBindable(component, (field, currentValueSource) => {\r\n\t\t\t\tif (currentValueSource && currentValueSource.Type === BindingTypeEnum.BINDING &&\r\n\t\t\t\t\toldToNewIdMap.hasOwnProperty(currentValueSource.sourceName)) {\r\n\t\t\t\t\tcurrentValueSource.sourceName = oldToNewIdMap[currentValueSource.sourceName];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getNameBase(displayName: string): string {\r\n\t\tif (displayName.match(/_[Cc]opy/)) {\r\n\t\t\tconst strLength = displayName.lastIndexOf(ComponentConstants.COPY_SUFFIX);\r\n\t\t\tdisplayName = displayName.substr(0, strLength);\r\n\t\t}\r\n\t\treturn displayName;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a new displayname based on different criterias\r\n\t *\r\n\t * @private\r\n\t * @param {IJsonLayoutComponent} componentObject\r\n\t * @returns {string}\r\n\t * @memberof EditorService\r\n\t */\r\n\tprivate getNewDisplayName(oldDisplayName: string): string {\r\n\t\tconst copyRegexExpression = ComponentConstants.COPY_SUFFIX + \"\\\\d*\";\r\n\t\tconst copyRegex = new RegExp(copyRegexExpression + \"$\");\r\n\t\tconst replaceSuffixRegex = new RegExp(\"(\" + copyRegexExpression + \")?$\");\r\n\t\tlet suffix = ComponentConstants.COPY_SUFFIX;\r\n\t\tconst nameBase = this.getNameBase(oldDisplayName);\r\n\t\tconst conflictingNames: string[] = [];\r\n\t\tthis.getAllComponents((component) => {\r\n\t\t\tconst componentNameBase = this.getNameBase(component.getDisplayName());\r\n\t\t\tif (nameBase === componentNameBase) {\r\n\t\t\t\tconflictingNames.push(component.getDisplayName());\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\tif (conflictingNames.length) {\r\n\t\t\t// Take all conflicting that \"are copies\"\r\n\t\t\tlet nextHighestNumber = ComponentsHelper.nextNumber(\r\n\t\t\t\tconflictingNames.filter((displayName) => {\r\n\t\t\t\t\treturn displayName.match(copyRegex);\r\n\t\t\t\t})\r\n\t\t\t);\r\n\r\n\t\t\t// Humans like the second copy to have suffix _Copy2\r\n\t\t\tif (nextHighestNumber === 1) {\r\n\t\t\t\t// tslint:disable-next-line\r\n\t\t\t\tnextHighestNumber = 2;\r\n\t\t\t}\r\n\r\n\t\t\tsuffix += nextHighestNumber !== 0 ? nextHighestNumber : \"\";\r\n\t\t}\r\n\t\t// Replace old if exists\r\n\t\treturn oldDisplayName.replace(replaceSuffixRegex, suffix);\r\n\t}\r\n\r\n\tprivate generateNewIdsForTree(parentComponent: IJsonComponent): IMap<string> {\r\n\t\tconst oldToNewIdMap: IMap<string> = {};\r\n\t\tthis.forEachComponent(parentComponent, (component, parent) => {\r\n\t\t\tconst oldId = component.id;\r\n\t\t\tconst newId = this.generateId(component.typedef);\r\n\t\t\tcomponent.id = newId;\r\n\t\t\toldToNewIdMap[oldId] = newId;\r\n\r\n\t\t\tswitch (component.typedef) {\r\n\t\t\t\tcase RadioButton.name:\r\n\t\t\t\t\t// If it's a radiobutton component. Then we need to make sure to change the ID's of each radiobutton\r\n\t\t\t\t\t(component as IJsonRadioButtons).componentRadioButtons.forEach((radioButton: IRadioButton) => {\r\n\t\t\t\t\t\tconst oldRadioButtonId = radioButton.id;\r\n\t\t\t\t\t\tradioButton.id = radioButton.id.replace(oldId, newId);\r\n\t\t\t\t\t\toldToNewIdMap[oldRadioButtonId] = radioButton.id;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase List.name:\r\n\t\t\t\t\tconst listComponent: IJsonList = component as IJsonList;\r\n\t\t\t\t\tfor (const boundaryId in listComponent.boundarySettings) {\r\n\t\t\t\t\t\tif (listComponent.boundarySettings[boundaryId].itemTemplate) {\r\n\t\t\t\t\t\t\tthis.generateNewIdsForTree(listComponent.boundarySettings[boundaryId].itemTemplate);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase TabPanel.name:\r\n\t\t\t\t\t(parent as IJsonTabs).componentTabs.find((componentTab) => {\r\n\t\t\t\t\t\treturn componentTab.id === oldId;\r\n\t\t\t\t\t}).id = newId;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Lookup.name:\r\n\t\t\t\tcase Datagrid.name:\r\n\t\t\t\t\t(component as IJsonDatagrid|IJsonLookup).columns.forEach((column) => {\r\n\t\t\t\t\t\tconst newId = this.generateId(component.typedef + \"column\");\r\n\t\t\t\t\t\toldToNewIdMap[column.id] = newId;\r\n\t\t\t\t\t\tcolumn.id = newId;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// Add more cases for other special cases\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn oldToNewIdMap;\r\n\t}\r\n\r\n\tpublic updateClassesAndSizes(): void {\r\n\t\tconst currentRootComponentInstance = this.getCurrentRootComponentInstance();\r\n\t\tcurrentRootComponentInstance.newBoundaryEntered(this.getCurrentBoundary().id);\r\n\t}\r\n\r\n\tpublic setDefaultBindings(component: IJsonComponent, availOutput: IMetaDataField[]): void {\r\n\t\tthis.bindingManagementService.setDefaultBindings(component, availOutput);\r\n\t}\r\n\r\n\tpublic getComponentInstanceById(id: string): IEditorComponent {\r\n\t\treturn this.frameworkService.getComponentInstance(id) as IEditorComponent;\r\n\t}\r\n\r\n\tpublic getNewDeferred<T>(): ng.IDeferred<T> {\r\n\t\treturn this.frameworkService.getNewDeferred<T>();\r\n\t}\r\n\r\n\tpublic onAllPromises(promises: ng.IPromise<any>[]): ng.IPromise<any> {\r\n\t\treturn this.$q.all(promises);\r\n\t}\r\n\r\n\tpublic forEachBindable(\r\n\t\tcomponent: IJsonComponent, fn: (field: IJsonBindableField, curr: IJsonValueSource) => void): void {\r\n\t\treturn this.frameworkService.forEachBindable(component, fn);\r\n\t}\r\n\r\n\tpublic forEachComponent(\r\n\t\tcomponent: IJsonComponent, fn: (component: IJsonComponent, parent: IJsonLayoutComponent) => void\r\n\t): void {\r\n\t\treturn this.frameworkService.forEachComponent(component, fn);\r\n\t}\r\n\r\n\tpublic getDatasourceObject(id: string): IDatasource {\r\n\t\treturn this.frameworkService.getDatasourceObject(id);\r\n\t}\r\n\r\n\tpublic updateDatasourceOnComponents(datasource: IJsonDatasource): void {\r\n\t\tconst allComponents: IEditorComponent[] = this.getAllComponents();\r\n\t\tallComponents.forEach((component) => {\r\n\t\t\tif (component.datasource && component.datasource.id === datasource.id) {\r\n\t\t\t\tconst datasourceObject = this.getDatasourceObject(datasource.id);\r\n\t\t\t\tcomponent.setDatasource(datasourceObject);\r\n\t\t\t\tcomponent.refreshMetaSettings();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getTranslationsFromComponentTree(component: IJsonComponent): IMap<IJsonLanguageComponent[]> {\r\n\t\tconst languageComponents: IMap<IJsonLanguageComponent[]> = {};\r\n\t\tthis.forEachComponent(component, (componentChild: IJsonComponent) => {\r\n\t\t\tconst componentTranslations = this.getCurrentProject().getTranslation(componentChild.id);\r\n\t\t\tif (componentTranslations) {\r\n\t\t\t\tlanguageComponents[componentChild.id] = angular.copy(componentTranslations);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn languageComponents;\r\n\t}\r\n\r\n\t/**\r\n\t *\tUtility function to find ONE component in tree according to predicate\r\n\t\t*\r\n\t\t* @param parent Top of tree\r\n\t\t* @param predicate Function that\r\n\t\t*/\r\n\tpublic findInComponentTree(\r\n\t\tparent: IJsonComponent,\r\n\t\tpredicate: (child: IJsonComponent) => boolean\r\n\t): IJsonComponent {\r\n\r\n\t\tlet foundChild: IJsonComponent;\r\n\t\tthis.forEachComponent(parent, (child) => {\r\n\t\t\tif (predicate(child)) {\r\n\t\t\t\tfoundChild = child;\r\n\t\t\t\t// TODO: Add way to break this recursive loop\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn foundChild;\r\n\t}\r\n\r\n\tpublic copyTranslationsToCurrentProject(\r\n\t\tlanguageComponents: IMap<IJsonLanguageComponent[]>,\r\n\t\toldToNewIdMap: IMap<string>,\r\n\t\tnewComponentTree: IJsonComponent\r\n\t): void {\r\n\t\tHelper.getListFromMap(angular.copy(languageComponents)).forEach((componentTranslation: IJsonLanguageComponent) => {\r\n\t\t\tconst isCopy = oldToNewIdMap ? true : false;\r\n\t\t\tif (isCopy) {\r\n\t\t\t\tthis.copyTranslationByMapList(componentTranslation, oldToNewIdMap, newComponentTree);\r\n\t\t\t} // else cut\r\n\t\t\tthis.getCurrentProject().addTranslation(componentTranslation);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate copyTranslationByMapList(\r\n\t\tcomponentTranslation: IJsonLanguageComponent,\r\n\t\tidMap: IMap<string>,\r\n\t\tnewComponentTree: IJsonComponent\r\n\t): IJsonLanguageComponent {\r\n\t\tcomponentTranslation.id = Helper.generateUniqueId();\r\n\t\tcomponentTranslation.componentId = idMap[componentTranslation.componentId];\r\n\t\tconst foundChild: IJsonComponent = this.findInComponentTree(newComponentTree, (child) => {\r\n\t\t\treturn child.id === componentTranslation.componentId;\r\n\t\t});\r\n\t\t// If translation.property is not a bindable reference\r\n\t\tconst bindableRefs: string[] = [];\r\n\t\tthis.forEachBindable(foundChild, (bindable) => {\r\n\t\t\tbindableRefs.push(bindable.ref);\r\n\t\t});\r\n\t\tif (bindableRefs.indexOf(componentTranslation.property) === -1) {\r\n\t\t\tcomponentTranslation.property = idMap[componentTranslation.property];\r\n\t\t}\r\n\t\treturn componentTranslation;\r\n\t}\r\n\r\n\tpublic createLanguageComponentFromOldComponents(): void {\r\n\t\tthis.frameworkService.createLanguageComponentFromOldComponents();\r\n\t}\r\n\r\n\t/**\r\n\t * Method to change the SohoXI theme\r\n\t * @param theme\r\n\t */\r\n\tpublic setCanvasTheme(theme: ThemeEnum): void {\r\n\t\tthis.designerService.setCanvasTheme(theme);\r\n\t}\r\n\r\n\tpublic updateTranslatables(): void {\r\n\t\tthis.getAllTranslatableComponents().forEach(component => {\r\n\t\t\tcomponent.initializeBindings();\r\n\t\t});\r\n\t\tthis.saveCurrent(SaveFlagsEnum.TRANSLATIONS);\r\n\t}\r\n\r\n\tpublic syncTranslations(newTranslations: IMap<IJsonLanguageComponent[]>): void {\r\n\t\tconst currentProject = this.getCurrentProject();\r\n\t\tconst newTranslationList = Helper.getListFromMap(newTranslations);\r\n\t\tconst addTranslations = newTranslationList.length > currentProject.getTranslationsList().length;\r\n\t\tconst removeTranslations = newTranslationList.length < currentProject.getTranslationsList().length;\r\n\r\n\t\tif (addTranslations) {\r\n\t\t\tnewTranslationList.forEach((translation) => {\r\n\t\t\t\tif (!currentProject.getTranslation(translation.componentId)) {\r\n\t\t\t\t\tcurrentProject.addTranslation(translation);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else if (removeTranslations) {\r\n\t\t\tcurrentProject.getTranslationsList().forEach((translation) => {\r\n\t\t\t\tif (!newTranslations[translation.componentId]) {\r\n\t\t\t\t\tcurrentProject.removeTranslation(translation.componentId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else { //same length, value is the only change (DO NOT change the languages used)\r\n\t\t\t// TODO: MUPS-1693, too many forEach(), fix this when translations is Map-structure\r\n\t\t\tcurrentProject.getTranslationsList().forEach((projectLanguageComponent, index) => {\r\n\t\t\t\tnewTranslationList[index].translations.forEach((undoTranslation) => {\r\n\t\t\t\t\tconst projectTranslations = projectLanguageComponent.translations;\r\n\t\t\t\t\tfor (let i = 0; i < projectTranslations.length; i++) {\r\n\t\t\t\t\t\tif (projectTranslations[i].locale === undoTranslation.locale) {\r\n\t\t\t\t\t\t\tprojectTranslations[i].value = undoTranslation.value;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic readValueSource(valueSource: IJsonValueSource, context: IContext): string {\r\n\t\treturn this.frameworkService.readValueSource(valueSource, context);\r\n\t}\r\n\r\n\tpublic getUrlMetaData(): IAvailableSourceField[] {\r\n\t\treturn this.frameworkService.getUrlMetaData();\r\n\t}\r\n\r\n\tpublic setUrlMetaData(newUrlMetaData: IAvailableSourceField[]): void {\r\n\t\tthis.frameworkService.setUrlMetaData(newUrlMetaData);\r\n\t}\r\n\r\n\tpublic setUrlVariables(variables: IJsonUrlVariable[]): ng.IPromise<DesignerMashup> {\r\n\t\tthis.getCurrentProject().setUrlVariables(variables);\r\n\t\treturn this.frameworkService.generateUrlMetaData();\r\n\t}\r\n\r\n\tpublic getUrlValue(sourceKey: string): string {\r\n\t\treturn this.frameworkService.getUrlValue(sourceKey);\r\n\t}\r\n\r\n\tpublic removeCacheObject(projectId: string): void {\r\n\t\tthis.frameworkService.removeCacheObject(projectId);\r\n\t}\r\n\r\n\tpublic getTimeout(): ng.ITimeoutService {\r\n\t\treturn this.frameworkService.getTimeout();\r\n\t}\r\n\r\n\tpublic getActiveUrlBindings(): IJsonValueSource[] {\r\n\t\tconst urlBindings: IJsonValueSource [] = [];\r\n\t\tconst components = this.getAllComponents(component => {\r\n\t\t\treturn component.getTypedef() !== Flexbox.name;\r\n\t\t});\r\n\r\n\t\tcomponents.forEach(component => {\r\n\t\t\tcomponent.forEachBindable(bindable => {\r\n\t\t\t\tconst valueSource = component.getBindableField(bindable.ref);\r\n\t\t\t\tif (valueSource && valueSource.Type === BindingTypeEnum.URL_BINDING) {\r\n\t\t\t\t\turlBindings.push(valueSource);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn urlBindings;\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.EDITOR_SERVICE, EditorService);\r\n\t}\r\n}\r\n","export enum ValueTypeEnum {\r\n\tSTRING = 1,\r\n\tBOOLEAN,\r\n\tNUMBER,\r\n\tOBJECT,\r\n\tLIST,\r\n\tBINARY,\r\n\tLOCALIZED_STRING,\r\n\tDATE\r\n}\r\n","import angular, { IPromise } from \"angular\";\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport isNil from \"lodash-es/isNil\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport {\r\n\tCSSClasses, DEFAULT_BOUNDARY, InjectNames, InteractionTriggerEnum, RegexStrings,\r\n\tSettingKeys, SubstitutionTags, ThemeEnum, ComponentNames\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { ICustomComponentDefinition } from \"ng2/common/model/components/custom-component-definition.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\nimport { ILanguage } from \"ng2/common/model/language.model\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport {\tIAvailableSourceField } from \"common/defines\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"common/services/dialog-service\";\r\nimport { Defines } from \"components/defines\";\r\n\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { IRadioButtonComponent } from \"common/interface/iradiobutton-component\";\r\nimport { ITabsComponent } from \"common/interface/itabs-component\";\r\n\r\nimport { Component } from \"components/component\";\r\n\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport { ExpressionService } from \"common/services/expression-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\nimport { MingleService } from \"common/services/mingle-service\";\r\nimport { DatasourceService } from \"components/services/datasource-service\";\r\nimport { TranslationManagementService } from \"components/services/translation-management-service\";\r\nimport { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\n\r\n/**\r\n * Service used by components in runtime to communicate with our Framework\r\n */\r\nexport class FrameworkService {\r\n\r\n\tdatasourceChangedEvent = new InstanceEvent<string>();\r\n\tcurrentCanvasThemeChangedEvent: InstanceEvent<ThemeEnum>;\r\n\tprojectSettingsChangedEvent: InstanceEvent<DesignerManifest>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.WINDOW,\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.DATASOURCE_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.MINGLE_SERVICE,\r\n\t\tInjectNames.EXPRESSION_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $window: ng.IWindowService,\r\n\t\tprivate $compile: ng.ICompileService,\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $cacheFactoryService: ng.ICacheFactoryService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate datasourceService: DatasourceService,\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tprivate mingleService: MingleService,\r\n\t\tprivate expressionService: ExpressionService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tthis.currentCanvasThemeChangedEvent = commonService.currentCanvasThemeChangedEvent;\r\n\t\tthis.projectSettingsChangedEvent = commonService.projectSettingsChangedEvent;\r\n\r\n\t\tcommonService.currentBoundaryChangedEvent.on((newBoundary) => {\r\n\t\t\tconst rootComponent = commonService.getCurrentRootComponentInstance();\r\n\t\t\tif (rootComponent) {\r\n\t\t\t\trootComponent.newBoundaryEntered(newBoundary.id);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\topenComponentDialog(options: IDialogOptions<any>): IPromise<IDialogResult<any>> {\r\n\t\treturn this.dialogService.show(options);\r\n\t}\r\n\r\n\t/**\r\n\t* Backwards compatibility, checks all components if they have a languageComponent\r\n\t* if not, one is created for that component\r\n\t* @private\r\n\t* @memberof FrameworkService\r\n\t*/\r\n\tcreateLanguageComponentFromOldComponents(): void {\r\n\t\tconst rootComponent = this.commonService.getCurrentRootComponentInstance();\r\n\t\t// TODO: for applicationHeader, remove when header is a component\r\n\t\tconst currentManifest = this.getCurrentProject().getManifest();\r\n\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\trootComponent.getId(),\r\n\t\t\tSettingKeys.APPLICATION_HEADER,\r\n\t\t\tcurrentManifest.title\r\n\t\t);\r\n\r\n\t\tthis.projectSettingsChangedEvent.raise(currentManifest);\r\n\t\trootComponent.forEachChild((componentInstance) => {\r\n\t\t\tcomponentInstance.forEachBindable((binding, currentValueSource) => {\r\n\t\t\t\tconst isLocalized = binding.valueType === ValueTypeEnum.LOCALIZED_STRING;\r\n\t\t\t\tif (isLocalized) {\r\n\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\tbinding.ref,\r\n\t\t\t\t\t\tcurrentValueSource.value\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tswitch (componentInstance.getTypedef()) {\r\n\t\t\t\tcase ComponentNames.Tabs:\r\n\t\t\t\t\t(componentInstance as ITabsComponent).componentTabs.forEach((tab) => {\r\n\t\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\t\ttab.id,\r\n\t\t\t\t\t\t\ttab.name\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ComponentNames.RadioButton:\r\n\t\t\t\t\t(componentInstance as IRadioButtonComponent)\r\n\t\t\t\t\t\t.radioButtons.forEach((radiobutton) => {\r\n\t\t\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\t\t\tradiobutton.id,\r\n\t\t\t\t\t\t\t\tradiobutton.name\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ComponentNames.Datagrid:\r\n\t\t\t\t\t(componentInstance as any).datagridOptions.columns\r\n\t\t\t\t\t\t.forEach((column: IExtendedDataGridColumn) => {\r\n\t\t\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\t\t\tcolumn.id,\r\n\t\t\t\t\t\t\t\tcolumn.name\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tif (column.text) {\r\n\t\t\t\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\t\t\t\tcolumn.id + \"CellText\",\r\n\t\t\t\t\t\t\t\t\tcolumn.text\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t// TODO: other cases\r\n\t\t\t}\r\n\t\t}, false);\r\n\t}\r\n\r\n\topenWindow(url: string): void {\r\n\t\tthis.$window.open(url, \"_blank\");\r\n\t}\r\n\r\n\t/**\r\n\t * get the current language\r\n\t *\r\n\t * @public\r\n\t * @memberof FrameworkService\r\n\t */\r\n\tgetCurrentLanguage(): string {\r\n\t\treturn this.translationManagementService.getCurrentLanguage();\r\n\t}\r\n\r\n\tgetSelectedLocale(): string {\r\n\t\treturn this.translationManagementService.getSelectedLocale();\r\n\t}\r\n\r\n\t/**\r\n\t * Get the translatable string by the current language.\r\n\t * Used in component.ts therefore in this service.\r\n\t *\r\n\t * @param {string} componentId\r\n\t * @param {string} property\r\n\t *\t@param {string} currentLanguageKey\r\n\t\t*\r\n\t\t* @memberof FrameworkService\r\n\t\t*/\r\n\tgetTranslatableStringByProperty(componentId: string, property: string): string {\r\n\t\treturn this.translationManagementService.getTranslatableStringByProperty(componentId, property);\r\n\t}\r\n\r\n\tsetTranslatableStringByProperty(\r\n\t\tcomponentId: string,\r\n\t\tproperty: string,\r\n\t\tupdatedValue: ILanguage\r\n\t): void {\r\n\t\tthis.translationManagementService.setTranslatableStringByProperty(componentId, property, updatedValue);\r\n\t}\r\n\r\n\tsendDrillbackMessage(message: string): void {\r\n\t\tthis.mingleService.sendDrillbackMessage(message);\r\n\t}\r\n\r\n\tgetGlobalValue(value: string, component: IComponent): string | null {\r\n\t\tlet stringValue = null;\r\n\t\tif (!isNil(value) && typeof (value) !== \"boolean\") {\r\n\t\t\tconst trimmedValue = value.replace(SubstitutionTags.VALUE, \"\");\r\n\t\t\tconst cleanedValue = trimmedValue.match(RegexStrings.GLOBALSTRING);\r\n\t\t\tif (cleanedValue && cleanedValue[1]) {\r\n\t\t\t\tconst globalValue = this.languageService.getGlobalString(cleanedValue[1]);\r\n\t\t\t\tif (globalValue) {\r\n\t\t\t\t\tstringValue = value.replace(cleanedValue[0], globalValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.translationManagementService.openNewStringDialog(cleanedValue[1]).then((result) => {\r\n\t\t\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\t\tthis.translationManagementService.addGlobalString(result.value).then(() => {\r\n\t\t\t\t\t\t\t\tcomponent.initializeBindings();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn stringValue;\r\n\t}\r\n\r\n\t/**\r\n\t* get the translatable string on the header via translation management service\r\n\t* TODO: Remove when header is a component\r\n\t*\r\n\t* @returns {string}\r\n\t* @memberof FrameworkService\r\n\t*/\r\n\tgetTranslatableHeaderString(): string {\r\n\t\treturn this.translationManagementService.getTranslatableHeaderString();\r\n\t}\r\n\r\n\tgetCurrentProject(): DesignerMashup {\r\n\t\treturn this.commonService.getCurrentProject() as DesignerMashup;\r\n\t}\r\n\r\n\tgetUrlMetaData(): IAvailableSourceField[] {\r\n\t\treturn this.commonService.getUrlMetaData();\r\n\t}\r\n\r\n\tsetUrlMetaData(newUrlMetaData: IAvailableSourceField[]): void {\r\n\t\treturn this.commonService.setUrlMetaData(newUrlMetaData);\r\n\t}\r\n\r\n\tgenerateUrlMetaData(): ng.IPromise<DesignerMashup> {\r\n\t\tconst project = this.commonService.getCurrentProject();\r\n\t\treturn this.commonService.generateUrlMetaData(project) as ng.IPromise<DesignerMashup>;\r\n\t}\r\n\r\n\tgetUrlValue(sourceKey: string): string {\r\n\t\tlet value = \"\";\r\n\t\tconst metaData = this.getUrlMetaData();\r\n\t\tconst result = metaData.find( data => data.sourceKey === sourceKey);\r\n\r\n\t\tif (result && result.currentValue) {\r\n\t\t\tvalue = result.currentValue;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tgetTimeout(): ng.ITimeoutService {\r\n\t\treturn this.$timeout;\r\n\t}\r\n\r\n\tgetProjectCacheObject(): ng.ICacheObject {\r\n\t\tconst cacheId  = `${this.getCurrentProject().getId()}`;\r\n\t\treturn this.getCacheObject(cacheId);\r\n\t}\r\n\r\n\tgetCacheObject(cacheId?: string): ng.ICacheObject {\r\n\t\tcacheId = cacheId !== undefined ?\r\n\t\t\tcacheId : `${this.getCurrentProject().getId()}`;\r\n\r\n\t\tconst cacheObject = this.$cacheFactoryService.get(cacheId);\r\n\r\n\t\treturn !cacheObject ?\r\n\t\t\tthis.$cacheFactoryService(cacheId) : cacheObject;\r\n\t}\r\n\r\n\tremoveCacheObject(cacheId: string): void {\r\n\t\tconst cacheObject = this.getCacheObject(cacheId);\r\n\r\n\t\tcacheObject.destroy();\r\n\t}\r\n\r\n\tcheckIfListTemplate(componentId: string): boolean {\r\n\t\tif (componentId === \"TwoHorizontalLabels\" || componentId === \"ImageAndLabels\" || componentId === \"Stack\") {\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tforEachBindable(\r\n\t\tcomponent: IJsonComponent, fn: (field: IJsonBindableField, curr: IJsonValueSource) => void\r\n\t): void {\r\n\t\tDefines\r\n\t\t\t.allComponents[component.typedef]\r\n\t\t\t.class\r\n\t\t\t.BINDABLE_FIELDS_2.forEach((field: any) => {\r\n\t\t\t\tfn(field, (component as any)[field.ref]);\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Recursively iterate through all the components and run a function with the component\r\n\t * as an input\r\n\t *\r\n\t * @param {IJsonComponent} component\r\n\t * @param {(component: IJsonComponent, parent: IJsonLayoutComponent) => void} fn\r\n\t *\r\n\t * @memberof FrameworkService\r\n\t */\r\n\tforEachComponent(\r\n\t\tcomponent: IJsonComponent,\r\n\t\tfn: (component: IJsonComponent, parent: IJsonLayoutComponent) => void,\r\n\t\tparent: IJsonLayoutComponent = null\r\n\t): void {\r\n\t\tfn(component, parent);\r\n\t\tif (Defines.allComponents[component.typedef].isLayoutComponent) {\r\n\t\t\t(component as IJsonLayoutComponent).children.forEach((child: IJsonComponent) => {\r\n\t\t\t\tthis.forEachComponent(child, fn, component);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tgetNextProjectBoundary(boundaryId: string): IBoundary {\r\n\t\tif (boundaryId === DEFAULT_BOUNDARY.id) {\r\n\t\t\treturn DEFAULT_BOUNDARY;\r\n\t\t}\r\n\t\tconst projectBoundaries = this.getCurrentProject().manifest.mashupBoundaries;\r\n\r\n\t\tif (projectBoundaries) {\r\n\t\t\t// Sort the array, could be method?\r\n\t\t\tprojectBoundaries.sort((a, b) => {\r\n\t\t\t\tif (\"Default\" === a.id) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t} else if (\"Default\" === b.id) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else if (a.limitX < b.limitX) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else if (b.limitX < a.limitX) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn 0;\r\n\t\t\t});\r\n\r\n\t\t\tfor (let i = 0; i < projectBoundaries.length; i++) {\r\n\t\t\t\tif (projectBoundaries[i].id === boundaryId) {\r\n\t\t\t\t\treturn projectBoundaries[i + 1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn DEFAULT_BOUNDARY;\r\n\t}\r\n\r\n\ttriggerExpressions(): void {\r\n\t\tconst components = this.getAllComponentInstances();\r\n\t\tthis.expressionService.trigger(components);\r\n\t}\r\n\r\n\tsetCanvasTheme(theme: ThemeEnum): void {\r\n\t\tthis.commonService.setCanvasTheme(theme, this.isDesigner());\r\n\t}\r\n\r\n\tgetCurrentBoundary(): IBoundary {\r\n\t\treturn this.commonService.getCurrentBoundary();\r\n\t}\r\n\r\n\tgetTranslatableFieldDisplayName(componentId: string, reference: string): string {\r\n\r\n\t\tlet displayName = \"\";\r\n\t\tconst componentInstance = this.getComponentInstance(componentId);\r\n\r\n\t\tif (componentInstance) {\r\n\t\t\tswitch (componentInstance.getTypedef()) {\r\n\t\t\t\tcase ComponentNames.Tabs: {\r\n\t\t\t\t\tconst newTabIndex = ((componentInstance as ITabsComponent)\r\n\t\t\t\t\t\t.componentTabs\r\n\t\t\t\t\t\t.findIndex((tab) => {\r\n\t\t\t\t\t\t\treturn tab.id === reference;\r\n\t\t\t\t\t\t}) + 1); // Index starting on 1 for humans\r\n\t\t\t\t\tdisplayName = \"Tab \" + newTabIndex;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase ComponentNames.RadioButton:\r\n\t\t\t\t\tif (reference === SettingKeys.LABEL) {\r\n\t\t\t\t\t\tdisplayName = this.getBindableDisplayName(reference, componentId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst newRadioIndex = ((componentInstance as IRadioButtonComponent).radioButtons\r\n\t\t\t\t\t\t\t.findIndex((radiobutton) => {\r\n\t\t\t\t\t\t\t\treturn radiobutton.id === reference;\r\n\t\t\t\t\t\t\t}) + 1); // Index starting on 1 for humans\r\n\t\t\t\t\t\tdisplayName = \"Radio Button \" + newRadioIndex;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ComponentNames.Datagrid: {\r\n\t\t\t\t\tif (reference === SettingKeys.LABEL) {\r\n\t\t\t\t\t\tdisplayName = this.getBindableDisplayName(reference, componentId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet cellName = \"\";\r\n\t\t\t\t\t\tif (reference.includes(\"CellText\")) {\r\n\t\t\t\t\t\t\tcellName = \" Cell Text\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst newColumnIndex = (componentInstance as any).datagridOptions.columns\r\n\t\t\t\t\t\t\t.findIndex((column: IExtendedDataGridColumn) => {\r\n\t\t\t\t\t\t\t\treturn column.id + cellName.replace(/\\s+/g, \"\") === reference;\r\n\t\t\t\t\t\t\t}) + 1; // Index starting on 1 for humans\r\n\t\t\t\t\t\tdisplayName = \"Column \" + newColumnIndex + cellName;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase \"Lookup\": {\r\n\t\t\t\t\tif (reference === SettingKeys.LABEL) {\r\n\t\t\t\t\t\tdisplayName = this.getBindableDisplayName(reference, componentId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst newColumnIndex = (componentInstance.getDatabearer() as IJsonLookup).columns\r\n\t\t\t\t\t\t\t.findIndex((column) => {\r\n\t\t\t\t\t\t\t\treturn column.id === reference;\r\n\t\t\t\t\t\t\t}) + 1; // Index starting on 1 for humans\r\n\t\t\t\t\t\tdisplayName = \"Column \" + newColumnIndex;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t//  more cases\r\n\t\t\t}\r\n\r\n\t\t\tif (!displayName) {\r\n\t\t\t\tdisplayName = this.getBindableDisplayName(reference, componentId);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn displayName;\r\n\t}\r\n\r\n\tprivate getBindableDisplayName(reference: string, componentId: string): string {\r\n\t\tlet displayName = \"\";\r\n\t\tconst componentInstance = this.getComponentInstance(componentId);\r\n\t\tconst staticClass = Defines.allComponents[componentInstance.getTypedef()].class;\r\n\t\tconst bindables: IJsonBindableField[] = staticClass.BINDABLE_FIELDS_2;\r\n\t\tif (bindables.length > 0) {\r\n\t\t\tconst maybeDefinition = bindables.find((bindableDefinition) => {\r\n\t\t\t\treturn bindableDefinition.ref === reference;\r\n\t\t\t});\r\n\t\t\tdisplayName = maybeDefinition ? maybeDefinition.name : displayName;\r\n\t\t}\r\n\t\treturn displayName;\r\n\t}\r\n\r\n\t/**\r\n\t * Get component instance with given componentID\r\n\t *\r\n\t * @param componentId\r\n\t * @param fromRoot (optional) if not given will default to ApplicationParent\r\n\t */\r\n\tgetComponentInstance(componentId: string, fromRoot?: IComponent): IComponent {\r\n\t\tif (!componentId) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst recursive = (component: IComponent) => {\r\n\t\t\tlet foundChild: IComponent;\r\n\t\t\tif (component.getId() === componentId) {\r\n\t\t\t\treturn component;\r\n\t\t\t} else if (Helper.instanceOfLayoutComponent(component)) {\r\n\t\t\t\tfor (const index in component.children) {\r\n\t\t\t\t\tfoundChild = recursive(component.children[index]);\r\n\t\t\t\t\tif (foundChild) {\r\n\t\t\t\t\t\treturn foundChild;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (Helper.instanceOfListComponent(component)) {\r\n\t\t\t\tfor (const index in component.children) {\r\n\t\t\t\t\tfoundChild = recursive(component.children[index]);\r\n\t\t\t\t\tif (foundChild) { // Return first one of the generated instances\r\n\t\t\t\t\t\treturn foundChild;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t};\r\n\t\tif (!fromRoot) {\r\n\t\t\tconst rootComponent = this.commonService.getCurrentRootComponentInstance();\r\n\t\t\tfromRoot = rootComponent.parent;\r\n\t\t}\r\n\t\treturn recursive(fromRoot);\r\n\t}\r\n\r\n\t/*\r\n\t\t* Get all component instances that the attribute has the specified value\r\n\t*/\r\n\tgetComponentInstances(attrName: string, attrValue: string, fromRoot?: IComponent): IComponent[] {\r\n\t\tconst components: IComponent[] = [];\r\n\t\tif (!fromRoot) {\r\n\t\t\tfromRoot = this.commonService.getCurrentRootComponentInstance();\r\n\t\t}\r\n\t\tfromRoot.forEachChild((child) => {\r\n\t\t\tif (Helper.getDeepValue(child, attrName) === attrValue) {\r\n\t\t\t\tcomponents.push(child);\r\n\t\t\t}\r\n\t\t}, true);\r\n\t\treturn components;\r\n\t}\r\n\r\n\t/*\r\n\t\t* Get all component instances\r\n\t*/\r\n\tgetAllComponentInstances(): IComponent[] {\r\n\t\tconst components: IComponent[] = [];\r\n\t\tconst rootComponent = this.commonService.getCurrentRootComponentInstance();\r\n\t\trootComponent.forEachChild((child) => {\r\n\t\t\tcomponents.push(child);\r\n\t\t}, true);\r\n\t\treturn components;\r\n\t}\r\n\r\n\tgetCustomComponentDefinition(customId: string): ICustomComponentDefinition {\r\n\t\treturn this.commonService.getCurrentProject().getCustomComponentDefinitions()[customId];\r\n\t}\r\n\r\n\tgetNewDeferred<T>(): ng.IDeferred<T> {\r\n\t\treturn this.$q.defer<T>();\r\n\t}\r\n\r\n\tisRuntimeMode(): boolean {\r\n\t\t// MUPS-495 should be applied here:\r\n\t\t// A better way to get the runtimeMode would be to save it something global, eg.the rootscope\r\n\t\tconst container = angular.element(\".\" + CSSClasses.mashupRootContainer);\r\n\t\treturn container.length === 0 || container.hasClass(\"runtimeMode\");\r\n\t}\r\n\r\n\tisDesigner(): boolean {\r\n\t\treturn this.commonService.isDesigner();\r\n\t}\r\n\r\n\tgetDatasource(datasourceId: string): IJsonDatasource {\r\n\t\treturn this.commonService.getCurrentProject().getDatasource(datasourceId);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param {string} datasourceId\r\n\t * @returns {IDatasource}\r\n\t *\r\n\t * @memberOf FrameworkService\r\n\t */\r\n\tgetDatasourceObject(datasourceId: string): IDatasource {\r\n\t\tconst datasourceObject: IJsonDatasource = this.commonService.getCurrentProject().getDatasource(datasourceId);\r\n\t\tlet datasourceInstance: IDatasource;\r\n\t\tif (datasourceObject) {\r\n\t\t\tdatasourceInstance = this.datasourceService.parseDatasourceToTS(datasourceObject);\r\n\t\t}\r\n\t\treturn datasourceInstance;\r\n\t}\r\n\r\n\treadParameters(\r\n\t\tparameters: IInteractionParameter[],\r\n\t\tcontext: IMap<string>\r\n\t): IMap<any> {\r\n\t\tconst values: IMap<any> = {};\r\n\t\tparameters.forEach((parameter) => {\r\n\t\t\tconst value = this.readValueSource(parameter.valueSource, context);\r\n\t\t\tif (value) {\r\n\t\t\t\t//Assume %% is a delimiter\r\n\t\t\t\tconst multipleValue = value.split(\"%%\");\r\n\t\t\t\tif (multipleValue.length > 1 && parameter.valueSource.Type !== BindingTypeEnum.STATIC_VALUE) {\r\n\t\t\t\t\tfor (let i = 0; i < multipleValue.length; i++) {\r\n\t\t\t\t\t\tmultipleValue[i] = Helper.trimIfPossible(multipleValue[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalues[parameter.targetKey] = multipleValue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalues[parameter.targetKey] = Helper.trimIfPossible(value); // Trim used to fix MI problem\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvalues[parameter.targetKey] = \"\";\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn values;\r\n\t}\r\n\r\n\tsetParameter<T>(parameter: IInteractionParameter, newValue: T): void {\r\n\t\tconst valueSource = parameter.valueSource;\r\n\t\tconst sourceComponent = this.getComponentInstance(valueSource.sourceName);\r\n\t\tconst path = valueSource.sourceKey;\r\n\r\n\t\tHelper.setDeepValue(sourceComponent, path, newValue);\r\n\t}\r\n\r\n\t/**\r\n\t * Method for applying string concatenation formatter on Binding and Context type bindings\r\n\t *\r\n\t * @param valuesourceObject\r\n\t * @param value\r\n\t * @returns valuesourceObject.value with {$value} substitution of value parameter\r\n\t */\r\n\tprivate applyValuesourceFormatter(value: string, newValue: string): string {\r\n\t\t// Fallback for old projects that (unnessesarily) saved current value in the \"value\"-property\r\n\t\tif (value && value.indexOf(SubstitutionTags.VALUE) > -1) {\r\n\t\t\treturn Helper.joinWithDefauldEmptyString(\r\n\t\t\t\tvalue.split(SubstitutionTags.VALUE),\r\n\t\t\t\tnewValue\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn newValue;\r\n\t\t}\r\n\t}\r\n\r\n\treadValueSource(valueSource: IJsonValueSource, context: IMap<string>): string | null {\r\n\t\tlet value: string;\r\n\t\tif (valueSource.Type === BindingTypeEnum.BINDING) {\r\n\t\t\tconst sourceComponent = this.getComponentInstance(valueSource.sourceName);\r\n\t\t\tif (sourceComponent && valueSource.sourceKey) {\r\n\t\t\t\tconst result = sourceComponent.getValue(valueSource.sourceKey);\r\n\t\t\t\tvalue = result === null ? \"\" : result;\r\n\t\t\t\tvalue = this.applyValuesourceFormatter(valueSource.value, value);\r\n\t\t\t} else {\r\n\t\t\t\tif (!sourceComponent) {\r\n\t\t\t\t\tconsole.error(\"[DatasourceService] BINDING failed, source component not found\");\r\n\t\t\t\t}\r\n\t\t\t\tif (!valueSource.sourceKey) {\r\n\t\t\t\t\tconsole.error(\"[DatasourceService] BINDING failed, source key not set\");\r\n\t\t\t\t}\r\n\t\t\t\tvalue = null;\r\n\t\t\t}\r\n\t\t} else if (valueSource.Type === BindingTypeEnum.CONTEXT_BINDING) {\r\n\t\t\tif (context) {\r\n\t\t\t\tvalue = context[valueSource.sourceKey];\r\n\t\t\t\tvalue = this.applyValuesourceFormatter(valueSource.value, value);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error(\"[DatasourceService] BINDING failed, no context for CONTEXT_BINDING\");\r\n\t\t\t}\r\n\t\t} else if (valueSource.Type === BindingTypeEnum.URL_BINDING) {\r\n\t\t\tif (this.isRuntimeMode()) {\r\n\t\t\t\tvalue = this.getUrlValue(valueSource.sourceKey);\r\n\t\t\t} else {\r\n\t\t\t\tvalue = valueSource.value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Static value\r\n\t\t\tvalue = valueSource.value;\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\tprivate activeBindings: IMap<Function> = {};\r\n\r\n\tgetActiveBinding(): IMap<Function> {\r\n\t\treturn this.activeBindings;\r\n\t}\r\n\r\n\tregisterContextBinding(\r\n\t\ttargetComponent: IComponent,\r\n\t\ttargetKey: string,\r\n\t\tsourceKey: string,\r\n\t\tvalue: string\r\n\t): void {\r\n\t\tconst targetComponentScope = targetComponent.getScope();\r\n\t\tif (targetComponentScope) {\r\n\t\t\tconst targetComponentId = targetComponent.isGenerated ?\r\n\t\t\t\ttargetComponent.generatedId : targetComponent.getId();\r\n\r\n\t\t\tconst bindingId = this.getContextBindingId(targetComponentId, targetKey, sourceKey);\r\n\t\t\tif (this.activeBindings[bindingId]) {\r\n\t\t\t\tthis.activeBindings[bindingId]();\r\n\t\t\t}\r\n\t\t\tconst dereg = targetComponentScope.$watch(\r\n\t\t\t\t\"context[\\\"\" + sourceKey + \"\\\"]\",\r\n\t\t\t\t(newValue: string) => {\r\n\t\t\t\t\tnewValue = this.applyValuesourceFormatter(value, newValue);\r\n\t\t\t\t\ttargetComponent.setBindableValue(targetKey, newValue ? newValue : \"\");\r\n\t\t\t\t});\r\n\t\t\tthis.activeBindings[bindingId] = dereg;\r\n\r\n\t\t\ttargetComponentScope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\t\tdereg();\r\n\t\t\t\tdelete this.activeBindings[bindingId];\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[FrameworkService] No element/scope on target component, CONTEXT_BINDING not registered\");\r\n\t\t}\r\n\t}\r\n\r\n\tgetBindingId(targetComponentId: string, targetKey: string, valueSourceObject: IJsonValueSource): string {\r\n\t\tconst sourceName = valueSourceObject.sourceName;\r\n\t\tconst sourceKey = valueSourceObject.sourceKey;\r\n\t\treturn sourceName + sourceKey + targetComponentId + targetKey;\r\n\t}\r\n\r\n\tgetContextBindingId(targetComponentId: string, targetKey: string, sourceKey: string): string {\r\n\t\treturn \"context\" + sourceKey + targetComponentId + targetKey;\r\n\t}\r\n\r\n\tregisterBinding(\r\n\t\ttargetComponent: IComponent,\r\n\t\ttargetKey: string,\r\n\t\tvaluesourceObject: IJsonValueSource,\r\n\t\tvalue: string\r\n\t): void {\r\n\t\tconst sourceComponentId = valuesourceObject.sourceName;\r\n\t\tconst sourceComponentKey = valuesourceObject.sourceKey;\r\n\t\tconst isLayoutComponentWithDatasource = (component: IComponent) => {\r\n\t\t\treturn component.isLayoutComponent() && component.getDatasource() !== undefined;\r\n\t\t};\r\n\t\tconst sourceComponent = this.getComponentInstance(sourceComponentId);\r\n\t\tif (sourceComponent) {\r\n\t\t\tconst bindingId = this.getBindingId(targetComponent.getId(), targetKey, valuesourceObject);\r\n\t\t\tif (this.activeBindings[bindingId]) {\r\n\t\t\t\tthis.activeBindings[bindingId]();\r\n\t\t\t}\r\n\t\t\tlet sourcePath = Helper.wrapKeyInBrackets(sourceComponentKey);\r\n\t\t\tsourcePath = isLayoutComponentWithDatasource(sourceComponent) ?\r\n\t\t\t\t\".scope.context\" + sourcePath : sourcePath;\r\n\t\t\tconst watchKey = \"componentInstance\" + sourcePath;\r\n\t\t\tconst dereg = sourceComponent.getScope().$watch(\r\n\t\t\t\twatchKey,\r\n\t\t\t\t(newValue: string) => {\r\n\t\t\t\t\tif (newValue === undefined || newValue === null) {\r\n\t\t\t\t\t\tnewValue = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnewValue = this.applyValuesourceFormatter(value, newValue);\r\n\t\t\t\t\ttargetComponent.setBindableValue(targetKey, newValue);\r\n\t\t\t\t\ttargetComponent.onUpdateValue();\r\n\t\t\t\t});\r\n\r\n\t\t\tthis.activeBindings[bindingId] = dereg;\r\n\t\t\tsourceComponent.getScope().$on(AngularConstants.DESTROY, () => {\r\n\t\t\t\tdereg();\r\n\t\t\t\tdelete this.activeBindings[bindingId];\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.warn(`[FrameworkService] Dead binding on component id: ${targetComponent.getId()}`);\r\n\t\t}\r\n\t}\r\n\r\n\ttrigger(source: Component, triggerName: string): void {\r\n\t\tthis.commonService.getCurrentProject().getInteractions().forEach((interaction) => {\r\n\t\t\tif (interaction.sourceName === source.getId() &&\r\n\t\t\t\tinteraction.sourceTriggerName === triggerName\r\n\t\t\t) {\r\n\t\t\t\tthis.runInteraction(interaction);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\trunInteraction(interaction: Interaction): void {\r\n\t\tif (interaction.targetName && interaction.targetActionName) {\r\n\t\t\tconst targetCtrls = this.getComponentInstances(\"databearer.id\", interaction.targetName);\r\n\t\t\ttargetCtrls.forEach((component: IComponent) => {\r\n\t\t\t\tcomponent.loadInteraction(interaction);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[FrameworkService] Interaction: \" + interaction.getId() +\r\n\t\t\t\t\" did not run, not all prerequisites were present\");\r\n\t\t}\r\n\t}\r\n\r\n\trunStartupInteractions(): void {\r\n\t\tconst startupInteraction = this.commonService.getCurrentProject().getInteractions().filter((ev) => {\r\n\t\t\treturn (ev.sourceTriggerName === InteractionTriggerEnum.STARTUP);\r\n\t\t});\r\n\r\n\t\tstartupInteraction.forEach((ev) => {\r\n\t\t\tthis.runInteraction(ev);\r\n\t\t});\r\n\t}\r\n\r\n\tconvertImageUrlToBase64(url: string): ng.IPromise<string> {\r\n\t\treturn this.commonService.convertImageUrlToBase64(url);\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.FRAMEWORK_SERVICE, FrameworkService);\r\n\t}\r\n}\r\n","//Keeping this for applicationParent\r\nexport enum SizeTypeEnum {\r\n\tPIXELS = 1,\r\n\tPERCENT = 2,\r\n\tAUTO = 3\r\n} //, Fractions = 4, Calculate = 5}\r\n","export enum BindingTypeEnum {\r\n\tSTATIC_VALUE = 1,\r\n\tBINDING = 2,\r\n\tCONTEXT_BINDING = 3,\r\n\tURL_BINDING = 4\r\n}\r\n","import { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonComponent extends IMap<any> {\r\n\ttypedef: TypeDef;\r\n\tid: string;\r\n\tgeneratedId?: string; // ID for component with generated child components e.g. List\r\n\tdisplayName: string;\r\n\tisReadonly: boolean;\r\n\tdatasource?: string;\r\n\tboundarySettings: IMap<IJsonComponentSettings>;\r\n}\r\n\r\nexport interface IJsonComponentSettings {\r\n\twidth?: IJsonSize;\r\n\theight?: IJsonSize;\r\n\tvisibility?: boolean;\r\n\tmargin?: IJsonMargin;\r\n\tshowError?: boolean;\r\n}\r\n\r\nexport interface IJsonSize {\r\n\tsizeType: SizeTypeEnum;\r\n\tvalue?: number;\r\n}\r\n\r\nexport interface IJsonMargin extends IMap<number> {\r\n\ttop: number;\r\n\tright: number;\r\n\tbottom: number;\r\n\tleft: number;\r\n}\r\n\r\nexport type TypeDef =\r\n\t\"ApplicationParent\" |\r\n\t\"Button\" |\r\n\t\"Chart\" |\r\n\t\"Checkbox\" |\r\n\t\"Datagrid\" |\r\n\t\"Datepicker\" |\r\n\t\"Dropdown\" |\r\n\t\"Flexbox\" |\r\n\t\"Hyperlink\" |\r\n\t\"Image\" |\r\n\t\"Label\" |\r\n\t\"List\" |\r\n\t\"Lookup\" |\r\n\t\"RadioButton\" |\r\n\t\"Tabs\" |\r\n\t\"TabPanel\" |\r\n\t\"Textarea\" |\r\n\t\"Textbox\" |\r\n\t\"TextBox\";\r\n","export interface IComponentRendered {\r\n\tid?: string;\r\n\tapi: any;\r\n}\r\nexport enum SelectableEnum {\r\n\tSingle = \"single\",\r\n\tMultiple = \"multiple\",\r\n\tMixed = \"mixed\",\r\n\tSiblings = \"siblings\",\r\n}\r\n\r\n// datagrid formatters\r\nexport enum FormatterEnum {\r\n\tText = \"text\",\r\n\tEllipsis = \"ellipsis\",\r\n\tPassword = \"password\",\r\n\tDate = \"date\",\r\n\tAutocomplete = \"autocomplete\",\r\n\tLookup = \"lookup\",\r\n\tDecimal = \"decimal\",\r\n\tInteger = \"integer\",\r\n\tHyperlink = \"hyperlink\",\r\n\tTemplate = \"template\",\r\n\tDrilldown = \"drilldown\",\r\n\tCheckbox = \"checkbox\",\r\n\tSelectionCheckbox = \"selectionCheckbox\",\r\n\tActions = \"actions\",\r\n\tTextarea = \"textarea\",\r\n\tExpander = \"expander\",\r\n\tClassRange = \"classRanger\",\r\n\tBadge = \"badge\",\r\n\tTag = \"tag\",\r\n\tAlert = \"alert\",\r\n\tImage = \"image\",\r\n\tColor = \"color\",\r\n\tButton = \"button\",\r\n\tDropdown = \"dropdown\",\r\n\tFavorite = \"favorite\",\r\n\tStatus = \"status\",\r\n\tTree = \"tree\",\r\n\r\n\t// Custom\r\n\tDatetime = \"datetime\",\r\n\tTime = \"time\",\r\n\tAbsoluteValue= \"absolutevalue\",\r\n}\r\n\r\nexport enum ColumnOptionEnum {\r\n\tEditable = \"editable\",\r\n\tSortable = \"sortable\",\r\n\tResizable = \"resizable\",\r\n}\r\n\r\nexport enum DateFormatEnum {\r\n\tDatetime = \"datetime\",\r\n\tLong = \"long\",\r\n\tShort = \"short\",\r\n\tTimestamp = \"timestamp\",\r\n\tTimeformat = \"timeFormat\",\r\n}\r\n","import { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { HttpAcceptEnum } from \"ng2/common/enums/http-accept-enum\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { ILocalIdoParameterObject, IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport * as sw from \"ng2/common/model/swagger.model\";\r\n\r\nexport interface IDatasourceDataset {\r\n\tname: string;\r\n\tdescription: string;\r\n}\r\n\r\nexport interface IJsonDatasource {\r\n\ttypedef?: DatasourceTypeEnum;\r\n\tversion?: number;\r\n\tid?: string;\r\n\tdisplayName?: string;\r\n\tdescription?: string;\r\n\t// Set on server\r\n\tauthor?: string;\r\n\tauthorDisplayName?: string;\r\n\tcreationDate?: number;\r\n\tchangedBy?: string;\r\n\tchangedByDisplayName?: string;\r\n\tchangedDate?: number;\r\n\theaders?: IHttpHeader;\r\n}\r\n\r\nexport interface IJsonGenericDatasource extends IJsonDatasource {\r\n\t// suite, endpoint and resource will together construct a Url\r\n\tsuite?: string;\r\n\tendpoint?: string;\r\n\tresource?: string;\r\n\r\n\tmethod?: HttpVerbEnum;\r\n\t// bodyParameters are used only when method are not GET\r\n\tbodyParameters?: string;\r\n\r\n\t/* Key Value object where containing \"query variable of {}s\" */\r\n\tinputParameters?: IMap<string>;\r\n\t// TODO: change datatype in future\r\n\toutputParameters?: string;\r\n\r\n\tisOutputFile?: boolean;\r\n}\r\n\r\nexport interface IJsonGenericDatasource2 extends IJsonDatasource {\r\n\t// suite, endpoint and resource will together construct a Url\r\n\tsuite: string;\r\n\tendpoint: string;\r\n\tresource: string;\r\n\r\n\tmethod: HttpVerbEnum;\r\n\r\n\tinputSchema?: sw.ISchemaObject;\r\n\toutputSchema?: sw.ISchemaObject;\r\n\toriginalSchema?: sw.ISchemaObject;\r\n\tinputParameters?: IParameterObject[];\r\n\toutputParameters?: IParameterObject[];\r\n\tbodyTemplate?: string;\r\n\toutputRootElement?: string;\r\n\tinputRootElement?: string;\r\n\toutputJson?: string;\r\n\r\n\tisOutputFile?: boolean;\r\n\tobjectIdPath?: string;\r\n}\r\n\r\nexport interface IJsonLocalIdoDatasource extends IJsonGenericDatasource2 {\r\n\torderBy?: string;\r\n\trecordCap: IRecordCapOption;\r\n\tinputParameters: ILocalIdoParameterObject[];\r\n\toutputParameters: ILocalIdoParameterObject[];\r\n}\r\n\r\nexport interface IJsonInlineListDatasource extends IJsonDatasource {\r\n\tsuite: string;\r\n\toutputParameters: IJsonInlineListParameter[];\r\n\tdataset: IListDataItem[];\r\n}\r\n\r\nexport interface IJsonInlineListParameter {\r\n\tid: string;\r\n\tkey: string;\r\n\tfield: string;\r\n}\r\n\r\nexport interface IRecordCapOption {\r\n\tname: string;\r\n\tid: string;\r\n\tlimit?: number;\r\n}\r\n\r\nexport interface IJsonM3Datasource extends IJsonGenericDatasource {\r\n\toperations: IJsonM3Operation[];\r\n}\r\n\r\nexport interface IJsonM3Operation {\r\n\tdataParameters: IMap<any>;\r\n}\r\n\r\nexport interface IJsonM3CloudData{\r\n\tresults: [\r\n\t\t{\r\n\t\t\ttransaction: string,\r\n\t\t\trecords: any[],\r\n\t\t\terrorMessage: string,\r\n\t\t\terrorType: string\r\n\t\t}\r\n\t],\r\n\twasTerminated: boolean,\r\n\tnrOfSuccessfullTransactions: number,\r\n\tnrOfFailedTransactions: number,\r\n}\r\n\r\nexport interface IJsonLNDatasource extends IJsonDatasource {\r\n\tSoapEnvelope: string;\r\n\tRelativeURL: string;\r\n\tResultPath: string;\r\n\tAttrPrefix: string;\r\n\tAttributes: string[];\r\n\tFilter: IJsonLNComparison[];\r\n\tMaxNoObjects: number;\r\n}\r\n\r\nexport interface IJsonLNComparison {\r\n\tOperator: string;\r\n\tAttribute: string;\r\n\tValue: string;\r\n}\r\n\r\nexport interface IHttpHeader {\r\n\t// Informs the server about the types of data that can be sent back.\r\n\tAccept?: HttpAcceptEnum;\r\n\t// Contains the credentials to authenticate a user-agent with a server.\r\n\tAuthorization?: string;\r\n\t\"X-Infor-MongooseConfig\"?: string;\r\n\t\"Content-Type\"?: ContentType;\r\n}\r\nexport type ContentType = \"application/json\" | \"text/plain\";\r\n","// import { IMap } from \"ng2/common/model/imap.model\";\r\n// import { ValueType } from \"ng2/common/enums/value-type.enum\";\r\n// import { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonValueSource extends IMap<any>  {\r\n\t//Should be lower case\r\n\tType: BindingTypeEnum;\r\n\tvalue?: any;\r\n\tsourceName?: string;\r\n\tsourceKey?: string;\r\n\tvisibleName?: string;\r\n}\r\n\r\nexport interface IJsonBindableField {\r\n\tname: string;\r\n\tref: string;\r\n\tvalueType: ValueTypeEnum;\r\n\twrite: boolean;\r\n\tread: boolean;\r\n\tdefaultValue?: IJsonValueSource;\r\n\tcondition?: string;\r\n}\r\n","export enum OrientationEnum {\r\n\tHORIZONTAL = 1,\r\n\tVERTICAL = 2,\r\n\tPAGE = 3\r\n}\r\n","import angular from \"angular\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport {\r\n\tBindingTypes, DEFAULT_BOUNDARY, IdoProperties, InteractionActionEnum, InteractionTriggerEnum,\r\n\tNumbers, SettingInputKeys, SettingKeys, SidebarTabTypes } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IComponentSettings } from \"ng2/common/model/components/settings/component-settings.model\";\r\nimport type { IJsonComponent, IJsonMargin, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport type { IComponentStyle } from \"common/defines\";\r\nimport type { IErrorResponse } from \"common/error-response\";\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { IComponentScope } from \"common/interface/icomponent-scope\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type { ISizeObject } from \"common/ISizeObject\";\r\n\r\nimport { Defines } from \"components/defines\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\nimport { ISourceItem } from \"common/model/component/hyperlink.model\";\r\n\r\nexport abstract class Component implements IComponent {\r\n\r\n\t// TODO: View variables, could probably be private\r\n\tprotected cssHeight: string;\r\n\tprotected cssWidth: string;\r\n\tcssClasses: string;\r\n\tisVisible = true;\r\n\tisReadonly: boolean;\r\n\tisShowError = true;\r\n\tisLoading: boolean;\r\n\terrorTooltip: string;\r\n\r\n\t// TODO: Member variables that should be methods\r\n\tcanCut = true;\r\n\tcanCopy = true;\r\n\r\n\t// TODO: Member variables that should be protected / private\r\n\tprotected databearer: IJsonComponent;\r\n\tdatasource: IDatasource;\r\n\telement: ng.IAugmentedJQuery;\r\n\tgeneratedId: string;\r\n\tisGenerated = false;\r\n\tparent: ILayoutComponent;\r\n\r\n\tprotected cache: ng.ICacheObject;\r\n\tprotected scope: IComponentScope;\r\n\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t[\r\n\t\t{\r\n\t\t\ttitle: \"Margin\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Margin\",\r\n\t\t\t\tref: SettingKeys.MARGIN,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.MARGIN,\r\n\t\t\t\tdefaultValue: { left: 0, top: 0, right: 0, bottom: 0 }\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Visibility\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Component\",\r\n\t\t\t\tref: SettingKeys.VISIBILITY,\r\n\t\t\t\tinputType: SettingInputKeys.SWITCH,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-preview\",\r\n\t\t\t\t\ttooltip: \"Hide Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t},\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Show Error\",\r\n\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Error\",\r\n\t\t\t\tref: SettingKeys.SHOW_ERROR,\r\n\t\t\t\tinputType: SettingInputKeys.SWITCH,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t\tboundarySetting: true\r\n\t\t\t}]\r\n\t\t}\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tdatabearer: IJsonComponent,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tprotected frameworkService: FrameworkService\r\n\t) {\r\n\t\tthis.databearer = databearer;\r\n\t\tif (databearer.datasource) {\r\n\t\t\tthis.datasource = frameworkService.getDatasourceObject(databearer.datasource);\r\n\t\t\tif (this.datasource) {\r\n\t\t\t\tthis.datasource.usedBy.push(this);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn(\"[Component] Missing data service unsetting the property\");\r\n\t\t\t\tdatabearer.datasource = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.element = $element;\r\n\t\tthis.scope = this.element.data(\"eir-scope\");\r\n\t\tthis.parent = parent;\r\n\t\tif (databearer && databearer.typedef !== \"Datagrid\") {\r\n\t\t\tthis.isReadonly = databearer.isReadonly;\r\n\t\t}\r\n\t\tthis.updateClassesAndStyle();\r\n\t\t// Flexbox gives the generatedId on the scope\r\n\t\tif (this.scope.generatedId) {\r\n\t\t\tthis.setGenerated(this.scope.generatedId);\r\n\t\t// While the List gives the generatedId to the child databearers\r\n\t\t} else if (this.databearer.generatedId) {\r\n\t\t\tthis.setGenerated(this.databearer.generatedId);\r\n\t\t}\r\n\r\n\t\tthis.createCacheObject();\r\n\t}\r\n\r\n\tcanDelete(): boolean {\r\n\t\tif (this.isGenerated) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetScope(): IComponentScope {\r\n\t\treturn this.scope;\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonComponent {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tgetTypedef(): string {\r\n\t\treturn this.databearer.typedef;\r\n\t}\r\n\r\n\tgetId(): string {\r\n\t\treturn this.databearer.id;\r\n\t}\r\n\r\n\tgetDisplayName(): string {\r\n\t\treturn this.databearer.displayName;\r\n\t}\r\n\r\n\tgetDatasource(): IDatasource {\r\n\t\treturn this.datasource;\r\n\t}\r\n\r\n\tsetGenerated(generatedId: string): void {\r\n\t\tthis.isGenerated = true;\r\n\t\tthis.generatedId = generatedId;\r\n\t}\r\n\r\n\tis(classs: any): boolean {\r\n\t\treturn this instanceof classs;\r\n\t}\r\n\r\n\t/**\r\n\t * To be called when new boundary is entered\r\n\t * Could be called when you need component trees to update their values\r\n\t */\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tthis.updateClassesAndStyle();\r\n\t}\r\n\r\n\tcalcNewSizes(): void {\r\n\t\tthis.calcNewWidth();\r\n\t\tthis.calcNewHeight();\r\n\t}\r\n\r\n\tcalcNewWidth(): void {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tthis.cssWidth = this.calcNewSize(\r\n\t\t\tthis.getBoundarySetting<IJsonSize>(SettingKeys.WIDTH),\r\n\t\t\tOrientationEnum.HORIZONTAL, margin.left + margin.right\r\n\t\t);\r\n\t}\r\n\r\n\tcalcNewHeight(): void {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tthis.cssHeight = this.calcNewSize(\r\n\t\t\tthis.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT),\r\n\t\t\tOrientationEnum.VERTICAL, margin.top + margin.bottom\r\n\t\t);\r\n\t}\r\n\r\n\tprotected calcNewSize(sizeObject: IJsonSize, orientation: OrientationEnum, margin = 0): string {\r\n\t\tlet retSize = \"\";\r\n\t\tif (this.parent.hasIndividualChildSizes(orientation)) {\r\n\t\t\tif (sizeObject.sizeType === SizeTypeEnum.PERCENT) {\r\n\t\t\t\tconst pxPerPercentComponent = this.parent.getPxPerPercentComponent(orientation, sizeObject.value);\r\n\t\t\t\tretSize = \"calc(\" + (sizeObject.value || Numbers.HUNDRED) + \"% - \" + (pxPerPercentComponent + margin) + \"px)\";\r\n\t\t\t} else if (sizeObject.sizeType === SizeTypeEnum.PIXELS) {\r\n\t\t\t\tretSize = \"calc(\" + sizeObject.value + \"px)\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn retSize;\r\n\t}\r\n\r\n\tsetBoundarySettingIfChanged<T>(settingId: string): void {\r\n\t\tconst value = this.getBoundarySetting<T>(settingId);\r\n\t\tif (!Helper.isUndefinedOrNull(value) && (this as any)[settingId] !== value) {\r\n\t\t\t(this as any)[settingId] = value;\r\n\t\t}\r\n\t}\r\n\r\n\tgetBoundarySetting<T>(settingId: string, boundaryId?: string, noTraverse?: boolean): T {\r\n\t\tconst frameworkService = this.frameworkService;\r\n\t\tconst componentBoundarySettings = this.databearer.boundarySettings;\r\n\r\n\t\tif (!boundaryId) {\r\n\t\t\tboundaryId = frameworkService.getCurrentBoundary().id;\r\n\t\t}\r\n\t\tif (noTraverse) {\r\n\t\t\t//Should return a copy, List needs some work\r\n\t\t\treturn (componentBoundarySettings[boundaryId] as IMap<T>)[settingId];\r\n\t\t}\r\n\r\n\t\tlet boundarySettings: IComponentSettings;\r\n\t\twhile (!boundarySettings) {\r\n\t\t\tif (!componentBoundarySettings[boundaryId] ||\r\n\t\t\t\t(componentBoundarySettings[boundaryId] as IMap<T>)[settingId] === undefined ||\r\n\t\t\t\t(componentBoundarySettings[boundaryId] as IMap<T>)[settingId] === null) {\r\n\t\t\t\tboundaryId = frameworkService.getNextProjectBoundary(boundaryId).id;\r\n\t\t\t\tif (boundaryId === DEFAULT_BOUNDARY.id) {\r\n\t\t\t\t\tboundarySettings = componentBoundarySettings[DEFAULT_BOUNDARY.id];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tboundarySettings = componentBoundarySettings[boundaryId];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn (boundarySettings as IMap<T>)[settingId];\r\n\t}\r\n\r\n\tgetBindableValue(bindableReference: string): any {\r\n\t\tconst bindablevalue = (this as any)[bindableReference];\r\n\t\treturn bindablevalue;\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, value: any): void {\r\n\t\tif (bindableReference === SettingKeys.TOOLTIP) {\r\n\t\t\t// always encode tooltip bindables\r\n\t\t\t(this as any)[bindableReference] = Helper.htmlEncode(value);\r\n\t\t} else {\r\n\t\t\t(this as any)[bindableReference] = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Those components with changable values in runtime triggers this.\r\n\t */\r\n\tonUpdateValue(): void {\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\t}\r\n\r\n\tisLayoutComponent(): boolean {\r\n\t\treturn Defines.allComponents[this.getTypedef()].isLayoutComponent;\r\n\t}\r\n\r\n\tisTranslatableComponent(): boolean {\r\n\t\treturn this.getTypedef() !== Image.name\r\n\t\t\t&& !this.isLayoutComponent();\r\n\t}\r\n\r\n\t/**\r\n\t * All update methods is to be called on three occations:\r\n\t * - On startup (via newBoundaryEntered)\r\n\t * - On change setting (when changing a setting that affects the classes)\r\n\t * - On change currentBoundary (via newBoundary Entered)\r\n\t */\r\n\tupdateClasses(): void {\r\n\t\tthis.element.removeClass(this.cssClasses);\r\n\t\tthis.cssClasses = this.getClassList().join(\" \");\r\n\t\tthis.element.addClass(this.cssClasses);\r\n\t}\r\n\r\n\tprotected updateInlineStyle(): void {\r\n\t\tthis.calcNewSizes();\r\n\t\tconst style = this.getInlineStyle();\r\n\t\tthis.element.css(style);\r\n\t}\r\n\r\n\tupdateVisibility(): void {\r\n\t\tthis.isVisible = this.getBoundarySetting<boolean>(SettingKeys.VISIBILITY);\r\n\t}\r\n\r\n\tupdateShowError(): void {\r\n\t\tthis.isShowError = this.getBoundarySetting<boolean>(SettingKeys.SHOW_ERROR);\r\n\t}\r\n\r\n\t/**\r\n\t * Reload all component values\r\n\t * - Boundary settings\r\n\t * - Static settings\r\n\t *\r\n\t */\r\n\tupdateClassesAndStyle(): void {\r\n\t\tthis.updateClasses();\r\n\t\tthis.updateInlineStyle();\r\n\t\tthis.updateVisibility();\r\n\t\tthis.updateShowError();\r\n\t}\r\n\r\n\tprotected getClassList(): string[] {\r\n\t\tconst classList = [\r\n\t\t\t\"eir-component\",\r\n\t\t\t\"eir\" + this.databearer.typedef\r\n\t\t];\r\n\t\tif (this.isGenerated) {\r\n\t\t\tclassList.push(\"generatedComponent\");\r\n\t\t}\r\n\t\treturn classList;\r\n\t}\r\n\r\n\tprotected getInlineStyle(): IComponentStyle {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\treturn {\r\n\t\t\twidth: this.cssWidth,\r\n\t\t\theight: this.cssHeight,\r\n\t\t\tmargin: `${margin.top}px ${margin.right}px ${margin.bottom}px ${margin.left}px`,\r\n\t\t};\r\n\t}\r\n\r\n\tgetGeneratingParent(): ILayoutComponent {\r\n\t\tif (this.parent.isGenerated) {\r\n\t\t\treturn this.parent.getGeneratingParent();\r\n\t\t}\r\n\t\treturn this.parent;\r\n\t}\r\n\r\n\tgetValue(key: string): any {\r\n\t\tlet value = Helper.getDeepValue(this, key);\r\n\t\t// cover case of Flexbox which has values inside scope.context\r\n\t\tif (Helper.isUndefinedOrNull(value) && this.getContext()) {\r\n\t\t\tconst path = \"scope.context.\" + key;\r\n\t\t\tvalue = Helper.getDeepValue(this, path);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Used for resetting the layout of a component. The following is currently reset:\r\n\t *\r\n\t * 1. Error tooltip\r\n\t * 2. Loading is set to false\r\n\t *\r\n\t * @memberof Component\r\n\t */\r\n\tresetLayout(): void {\r\n\t\tthis.setErrorTooltip(null);\r\n\t\tthis.stopLoading();\r\n\t}\r\n\r\n\tsetErrorTooltip(errorMessage?: string): void {\r\n\t\tthis.errorTooltip = errorMessage\r\n\t\t\t? errorMessage\r\n\t\t\t: null;\r\n\t}\r\n\r\n\tprivate startLoading(): void {\r\n\t\tthis.isLoading = true;\r\n\t}\r\n\r\n\tprivate stopLoading(): void {\r\n\t\tthis.isLoading = false;\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst deferred = this.frameworkService.getNewDeferred<any>();\r\n\t\tthis.resetLayout();\r\n\t\tthis.startLoading();\r\n\t\tconst dataserviceAction = this.isDataserviceAction(interaction);\r\n\r\n\t\tif (dataserviceAction && this.datasource) {\r\n\t\t\tconst parameters = this.frameworkService.readParameters(\r\n\t\t\t\tinteraction.getParameters(),\r\n\t\t\t\tthis.getContext()\r\n\t\t\t);\r\n\r\n\t\t\tswitch (interaction.targetActionName) {\r\n\t\t\t\tcase InteractionActionEnum.LIST:\r\n\t\t\t\t\tthis.datasource.getListData(parameters).then((listResult) => {\r\n\t\t\t\t\t\tthis.getContext().ListResult = listResult;\r\n\t\t\t\t\t\tdeferred.resolve(listResult);\r\n\t\t\t\t\t}).catch((errResponse: IErrorResponse) => {\r\n\t\t\t\t\t\tthis.resetContext();\r\n\t\t\t\t\t\tdeferred.reject(errResponse);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase InteractionActionEnum.GET:\r\n\t\t\t\t\tthis.datasource.getDetailData(parameters).then((detailData: any) => {\r\n\t\t\t\t\t\tthis.setDetailResultForGetAction(detailData);\r\n\t\t\t\t\t\tthis.updateItemID(detailData, interaction);\r\n\r\n\t\t\t\t\t\tconst detailResult = this.getContext().DetailResult;\r\n\t\t\t\t\t\tif (detailResult) {\r\n\t\t\t\t\t\t\tdeferred.resolve(detailResult);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdeferred.reject({\r\n\t\t\t\t\t\t\t\tmessage: \"Nothing in response\"\r\n\t\t\t\t\t\t\t} as IErrorResponse);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Timeout needed so that interaction doesn't run before parameters been fully set\r\n\t\t\t\t\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\t\t\t\t\tthis.trigger(InteractionTriggerEnum.ON_LOAD);\r\n\t\t\t\t\t\t\tthis.refreshBindings();\r\n\t\t\t\t\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t\t\t\t\t}, Numbers.TEN);\r\n\r\n\t\t\t\t\t}).catch((errResponse: IErrorResponse) => {\r\n\t\t\t\t\t\tthis.resetContext();\r\n\t\t\t\t\t\tdeferred.reject(errResponse);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.warn(\"[Component] Invalid interaction action\");\r\n\t\t\t}\r\n\t\t} else if (!dataserviceAction) {\r\n\t\t\tthis.runComponentAction(interaction);\r\n\t\t\tdeferred.resolve();\r\n\t\t} else {\r\n\t\t\tconst errorTooltip = `No Data Service available on component: ${this.databearer.displayName}`;\r\n\t\t\tthis.setErrorTooltip(errorTooltip);\r\n\t\t\tconst errorResponse: IErrorResponse = {\r\n\t\t\t\tmessage: errorTooltip,\r\n\t\t\t\tdetail: errorTooltip\r\n\t\t\t};\r\n\t\t\tdeferred.reject(errorResponse);\r\n\t\t}\r\n\t\tdeferred.promise\r\n\t\t\t.catch((errorResponse) => {\r\n\t\t\t\tthis.setErrorTooltip(errorResponse.message);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.stopLoading();\r\n\t\t\t});\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\t/**\r\n\t * Builds a link address from a link string and a sources array\r\n\t * Used by datagrid and hyperlink for their build-link-dialog\r\n\t * @param link - the link string to interpret\r\n\t * @param sources - an array of ISourceItem\r\n\t * @return {string} - link address string\r\n\t */\r\n\tbuildLink(link: string, sources: ISourceItem[]): string {\r\n\t\tlet renderedLink = angular.copy(link);\r\n\t\tsources.forEach((source) => {\r\n\t\t\tlet value = \"\";\r\n\t\t\tconst component = this.frameworkService.getComponentInstance(source.type);\r\n\t\t\tif (component) {\r\n\t\t\t\tif (component.getDatasource()) {\r\n\t\t\t\t\tvalue = component.getValue(source.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue = component.getBindableValue(source.value);\r\n\t\t\t\t}\r\n\t\t\t\tif (Helper.isUndefinedOrNull(value)) {\r\n\t\t\t\t\tvalue = \"\";\r\n\t\t\t\t}\r\n\t\t\t} else if (source.type === BindingTypes.CONTEXT) {\r\n\t\t\t\tconst valuesource: IJsonValueSource = {\r\n\t\t\t\t\tType: BindingTypeEnum.CONTEXT_BINDING,\r\n\t\t\t\t\tsourceKey: source.value\r\n\t\t\t\t};\r\n\t\t\t\tvalue = this.frameworkService.readValueSource(valuesource, this.getContext());\r\n\t\t\t}\r\n\t\t\trenderedLink = renderedLink.replace(new RegExp(`{${source.alias}}`, \"gi\"), value);\r\n\t\t});\r\n\t\treturn renderedLink;\r\n\t}\r\n\r\n\t/**\r\n\t * Refreshes potential values inherited from parent component via context bindings and regular bindings\r\n\t * if value has changed.\r\n\t */\r\n\tprivate refreshBindings(): void {\r\n\t\tif (!isUndefined(this.getContext().DetailResult)) {\r\n\t\t\tthis.forEachChild((child) => {\r\n\t\t\t\tchild.forEachBindable((bindable, valueSource) => {\r\n\t\t\t\t\tif (valueSource) {\r\n\t\t\t\t\t\tconst isBinding =\r\n\t\t\t\t\t\t\tvalueSource.sourceName === this.getId() && valueSource.Type === BindingTypeEnum.BINDING;\r\n\t\t\t\t\t\tconst isContextBinding =\r\n\t\t\t\t\t\t\tvalueSource.sourceName === BindingTypes.CONTEXT &&\r\n\t\t\t\t\t\t\tvalueSource.Type === BindingTypeEnum.CONTEXT_BINDING;\r\n\r\n\t\t\t\t\t\tif (isBinding || isContextBinding) {\r\n\t\t\t\t\t\t\tconst newValue = this.getContext().DetailResult[valueSource.sourceKey];\r\n\t\t\t\t\t\t\tconst oldValue = child.getBindableValue(bindable.ref);\r\n\t\t\t\t\t\t\tif (!isUndefined(oldValue) && !isUndefined(newValue) && (newValue !== oldValue)) {\r\n\t\t\t\t\t\t\t\tchild.setBindableValue(bindable.ref, newValue);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}, false);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Updates current selectedItem's ItemID\r\n\t * if the data services is an local IDO using method PUT\r\n\t * @param detailData\r\n\t * @param interaction\r\n\t */\r\n\tprivate updateItemID(detailData: any, interaction: IInteraction): void {\r\n\t\tconst generic2Databearer = this.datasource.getDatabearer() as IJsonGenericDatasource2;\r\n\r\n\t\tif (generic2Databearer.typedef === DatasourceTypeEnum.IDO &&\r\n\t\t\tgeneric2Databearer.method === HttpVerbEnum.PUT\r\n\t\t) {\r\n\t\t\tconst itemIdParameter = generic2Databearer.inputParameters\r\n\t\t\t\t.find(parameter => parameter.key === IdoProperties.ITEM_ID);\r\n\r\n\t\t\tif (!Helper.isUndefined(itemIdParameter) &&\r\n\t\t\t\t!Helper.isUndefined(detailData[itemIdParameter.id])) {\r\n\t\t\t\tconst interactionParameter = interaction.getParameter(itemIdParameter.id);\r\n\r\n\t\t\t\tthis.frameworkService.setParameter(\r\n\t\t\t\t\tinteractionParameter,\r\n\t\t\t\t\tdetailData[itemIdParameter.id]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttrigger(triggerName: string): void {\r\n\t\tthis.frameworkService.trigger(this, triggerName);\r\n\t}\r\n\r\n\tgetContext(): IContext {\r\n\t\tif (this.getScope()) {\r\n\t\t\treturn this.getScope().context;\r\n\t\t} else {\r\n\t\t\t// TODO: Find out what case this is, tell Anton if found\r\n\t\t\treturn this.parent.getScope().context;\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tthis.forEachBindable((bindableField, currentValueSource) => {\r\n\t\t\tif (currentValueSource && bindableField.write) {\r\n\t\t\t\tlet value = \"\";\r\n\t\t\t\tif (currentValueSource.Type !== BindingTypeEnum.URL_BINDING) {\r\n\t\t\t\t\tconst currentStringValue = this.getComponentTranslation(bindableField, currentValueSource.value);\r\n\t\t\t\t\tvalue = this.frameworkService.getGlobalValue(currentStringValue, this);\r\n\t\t\t\t\tif (!value) {\r\n\t\t\t\t\t\tcurrentValueSource.value = value = currentStringValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tswitch (currentValueSource.Type) {\r\n\t\t\t\t\tcase BindingTypeEnum.CONTEXT_BINDING:\r\n\t\t\t\t\t\tthis.frameworkService.registerContextBinding(\r\n\t\t\t\t\t\t\tthis,\r\n\t\t\t\t\t\t\tbindableField.ref,\r\n\t\t\t\t\t\t\tcurrentValueSource.sourceKey,\r\n\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.BINDING:\r\n\t\t\t\t\t\tthis.frameworkService.registerBinding(this, bindableField.ref, currentValueSource, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.STATIC_VALUE:\r\n\t\t\t\t\t\tthis.setBindableValue(bindableField.ref, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.URL_BINDING:\r\n\t\t\t\t\t\tvalue = this.frameworkService.getUrlValue(currentValueSource.sourceKey);\r\n\t\t\t\t\t\tif (value === \"\" && !this.frameworkService.isRuntimeMode()) {\r\n\t\t\t\t\t\t\tvalue = currentValueSource.value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.setBindableValue(bindableField.ref, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.warn(\"[Component] Invalid valueSource type\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setDetailResultForGetAction(detailData: any): void {\r\n\t\tconst databearer2 = this.datasource.getDatabearer() as IJsonGenericDatasource2;\r\n\r\n\t\tconst localContext = this.getContext();\r\n\t\tif (detailData && typeof detailData === \"object\") {\r\n\t\t\tangular.extend(localContext, detailData);\r\n\t\t}\r\n\r\n\t\tif (databearer2.isOutputFile) {\r\n\t\t\tlocalContext.DetailResult = detailData[databearer2.outputParameters[0].id];\r\n\t\t} else {\r\n\t\t\tlocalContext.DetailResult = detailData;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate runComponentAction(interaction: IInteraction): void {\r\n\t\tswitch (interaction.targetActionName) {\r\n\t\t\tcase InteractionActionEnum.CLEAR:\r\n\t\t\t\tthis.clear();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t//Do nothing\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isDataserviceAction(interaction: IInteraction): boolean {\r\n\t\tswitch (interaction.targetActionName) {\r\n\t\t\tcase InteractionActionEnum.CLEAR:\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getComponentTranslation(field: IJsonBindableField, value: string): string {\r\n\t\tlet translationValue;\r\n\t\tif (field.valueType === ValueTypeEnum.LOCALIZED_STRING) {\r\n\t\t\tconst newValue = this.frameworkService.getTranslatableStringByProperty(this.getId(), field.ref);\r\n\t\t\tif (newValue || newValue === \"\") {\r\n\t\t\t\ttranslationValue = newValue;\r\n\t\t\t} else {\r\n\t\t\t\ttranslationValue = value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttranslationValue = value;\r\n\t\t}\r\n\t\treturn translationValue;\r\n\t}\r\n\r\n\tforEachParent(fn: (parent: ILayoutComponent) => void): void {\r\n\t\tthis.parent.forEachParent(fn);\r\n\t}\r\n\r\n\tgetPredictedSize(): ISizeObject {\r\n\t\tconst sizes: ISizeObject = {};\r\n\t\tlet sizePredicter: JQuery;\r\n\r\n\t\tif (this.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT).sizeType === SizeTypeEnum.AUTO) {\r\n\t\t\t//let dummyText = this.Content ? this.Content : \"My dummystring\";\r\n\t\t\tsizePredicter = $(\"<div class='sizePredicter'></div>\").appendTo(\"body\");\r\n\t\t\tsizePredicter.append(this.element.clone());\r\n\t\t\tsizes.height = sizePredicter.outerHeight(true);\r\n\r\n\t\t\tsizePredicter.remove();\r\n\t\t}\r\n\r\n\t\treturn sizes;\r\n\t}\r\n\r\n\tforEachBindable(fn: (field: IJsonBindableField, curr: IJsonValueSource) => void): void {\r\n\t\tDefines.allComponents[this.databearer.typedef].class.BINDABLE_FIELDS_2\r\n\t\t\t.forEach((field: any) => {\r\n\r\n\t\t\t\tconst valueSource: IJsonValueSource = (this.databearer as any)[field.ref] ?\r\n\t\t\t\t\t(this.databearer as any)[field.ref] :\r\n\t\t\t\t\t(this as any)[field.ref]; // Quickfix for currentItem\r\n\t\t\t\tfn(field, valueSource);\r\n\t\t\t});\r\n\t}\r\n\r\n\tforEachFieldSetting(fn: (field: IComponentFieldSetting) => void): void {\r\n\t\tDefines.allComponents[this.databearer.typedef].class.SETTING_FIELDS.forEach((field: any) => {\r\n\t\t\tfn(field);\r\n\t\t});\r\n\t}\r\n\r\n\t// To be able to call forEachChild on arbitrary component\r\n\tforEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void {\r\n\t\tfn(this);\r\n\t}\r\n\r\n\tresetContext(): void {\r\n\t\tconst context = this.getContext();\r\n\t\tfor (const key in context) {\r\n\t\t\tdelete context[key];\r\n\t\t}\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\t//Do cool stuff in the future\r\n\t}\r\n\r\n\tprivate createCacheObject(): void {\r\n\t\tthis.cache = this.frameworkService.getProjectCacheObject();\r\n\t}\r\n}\r\n","export class Utils {\r\n\r\n\t/**\r\n\t * Util class containing convenience methods related to SohoXi Controls.\r\n\t */\r\n\tstatic getData(element: ng.IAugmentedJQuery, key: string): any {\r\n\t\treturn element.data(key);\r\n\t}\r\n}\r\n","export interface IErrorResponse {\r\n\tmessage: string;\r\n\tdetail?: string;\r\n\tcode?: number;\r\n\tsubcode?: number;\r\n\tsuccessfulItems?: string[];\r\n\tfailedItems?: string[];\r\n}\r\n\r\nexport class ErrorResponse implements IErrorResponse {\r\n\tmessage: string;\r\n\tdetail?: string;\r\n\tcode: number;\r\n\r\n\tconstructor(message: string, code: number = -1, stack: string = \"No-stacktrace/details\") {\r\n\t\tthis.message = message;\r\n\t\tthis.detail = stack;\r\n\t\tthis.code = code;\r\n\t}\r\n}\r\n","import { InteractionPairOperation } from \"ng2/common/constants/common.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\n\r\nexport class InteractionDefines {\r\n\tpublic static readonly SOURCE_TRIGGERS: IDataPair[] = [InteractionPairOperation.ON_LOAD];\r\n\tpublic static readonly TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.GET];\r\n}\r\n","export enum DatasourceTypeEnum {\r\n\tIDM = \"IDM\",\r\n\tIDO = \"IDO\",\r\n\tM3 = \"M3\",\r\n\tMINGLE = \"MINGLE\",\r\n\tMONGOOSE = \"MONGOOSE\",\r\n\tgeneric = \"generic\",\r\n\tINLINE_LIST = \"INLINE_LIST\",\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport {\r\n\tCanvasModeEnum,\r\n\tConditionType,\r\n\tComponentClassNames,\r\n\tComponentNames,\r\n\tContextKeys,\r\n\tCssConstantKeys,\r\n\tCssConstantValues,\r\n\tEventTypes,\r\n\tInjectNames,\r\n\tInsertEventTypes,\r\n\tInteractionActionEnum,\r\n\tNumbers,\r\n\tSettingKeys,\r\n\tWizardFocusEnum,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport type { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IAvailableTargetField } from \"ng2/common/model/interaction/available-target-field.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport type {\r\n\tIAvailableSourceField,\r\n\tIJQueryDragEventObject,\r\n\tIJQueryMouseEventObject\r\n} from \"common/defines\";\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { IComponentScope } from \"common/interface/icomponent-scope\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IListComponent } from \"common/interface/ilist-component\";\r\nimport { Defines } from \"components/defines\";\r\nimport type { IEditorList } from \"editor/component-settings/list/list-style-settings\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\nimport type { IEditorLayoutComponent } from \"editor/components/editor-layout-component\";\r\n\r\nimport { ComponentsHelper } from \"components/helper\";\r\nimport { EditorHelper } from \"editor/helper\";\r\n\r\nimport type { DialogService, IDialogOptions } from \"common/services/dialog-service\";\r\nimport type { TranslationManagementService } from \"components/services/translation-management-service\";\r\nimport type { BindingManagementService } from \"editor/services/binding-management-service\";\r\nimport type { EditorService } from \"editor/services/editor-service\";\r\nimport type { InsertComponentService } from \"editor/services/insert-component-service\";\r\nimport type { InteractionManagementService } from \"editor/services/interaction-management-service\";\r\n\r\nexport interface IEditorComponentScope extends IComponentScope {\r\n\tcomponentInstance: IEditorComponent;\r\n\teirEditorComponent: EditorComponentCtrl;\r\n}\r\n\r\nexport interface IExpressionData {\r\n\tcomponent: IEditorComponent;\r\n\toption: string;\r\n}\r\n\r\nexport class EditorComponentCtrl {\r\n\tprotected component: IEditorComponent;\r\n\r\n\t// State variables, used by ng-class\r\n\tisHovered: boolean;\r\n\tisFinder: boolean;\r\n\tisInsertChild: boolean;\r\n\tisInsertParent: boolean;\r\n\tisSelected: boolean;\r\n\twizardFocusType: WizardFocusEnum;\r\n\tisDraggable = true;\r\n\r\n\tprivate dragstartTimer: ng.IPromise<void>;\r\n\r\n\t// Keeping the dragEnterCounter here as a reminder on how it works\r\n\t// http://stackoverflow.com/questions/7110353/html5-dragleave-fired-when-hovering-a-child-element\r\n\tstatic dragEnterCounter = 0;\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(ComponentClassNames.EDITOR_COMPONENT_PREFIX + ComponentClassNames.COMPONENT, EditorComponentCtrl);\r\n\t}\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.BINDING_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.INSERT_COMPONENT_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: IEditorComponentScope,\r\n\t\tprotected $element: ng.IAugmentedJQuery,\r\n\t\tprotected $compile: ng.ICompileService,\r\n\t\tprotected $timeout: ng.ITimeoutService,\r\n\t\tprotected editorService: EditorService,\r\n\t\tprotected interactionManagementService: InteractionManagementService,\r\n\t\tprotected bindingManagementService: BindingManagementService,\r\n\t\tprotected insertComponentService: InsertComponentService,\r\n\t\tprotected translationManagementService: TranslationManagementService,\r\n\t\tprotected dialogService: DialogService\r\n\t) {\r\n\t\tconst unsubscribe = $scope.$watch(\"componentInstance\", (component: IEditorComponent) => {\r\n\t\t\tconst selectionBox = this.$compile(\r\n\t\t\t\t\"<eir-selection-box data-html2canvas-ignore ng-if='eirEditorComponent.isSelected'></eir-selection-box>\"\r\n\t\t\t)($scope);\r\n\t\t\tthis.init(component);\r\n\t\t\tthis.$element.prepend(selectionBox);\r\n\t\t\tcomponent.updateClasses();\r\n\t\t\tunsubscribe();\r\n\t\t});\r\n\t}\r\n\r\n\texposesReadableBindables(): boolean {\r\n\t\tconst component = this.component;\r\n\t\tlet exposesBindables: boolean;\r\n\r\n\t\texposesBindables = Defines\r\n\t\t\t.allComponents[component.getTypedef()]\r\n\t\t\t.class\r\n\t\t\t.BINDABLE_FIELDS_2\r\n\t\t\t.some((bindableField) => {\r\n\t\t\t\treturn bindableField.read;\r\n\t\t\t});\r\n\t\tif (component.getDatasource()) { // Assuming a datasource always have output fields\r\n\t\t\texposesBindables = true;\r\n\t\t}\r\n\t\treturn exposesBindables;\r\n\t}\r\n\r\n\texposesLocalizedBindables(): boolean {\r\n\t\tconst component = this.component;\r\n\t\tconst translatableBindables: boolean =\r\n\t\t\tDefines\r\n\t\t\t\t.allComponents[component.getTypedef()]\r\n\t\t\t\t.class\r\n\t\t\t\t.BINDABLE_FIELDS_2\r\n\t\t\t\t.some((bindableField) => {\r\n\t\t\t\t\treturn bindableField.valueType === ValueTypeEnum.LOCALIZED_STRING;\r\n\t\t\t\t});\r\n\r\n\t\treturn translatableBindables;\r\n\t}\r\n\r\n\tprotected init(component: IEditorComponent): void {\r\n\t\t//Helper methods\r\n\t\tcomponent.exposesLocalizedBindables = this.exposesLocalizedBindables.bind(this);\r\n\t\tcomponent.exposesReadableBindables = this.exposesReadableBindables.bind(this);\r\n\r\n\t\t// View methods\r\n\t\tcomponent.onClick = this.onClick.bind(this);\r\n\t\tcomponent.onDragenter = (e) => { EditorComponentCtrl.dragEnterCounter++; this.onMouseOver(e); };\r\n\t\tcomponent.onDragleave = (e) => { EditorComponentCtrl.dragEnterCounter--; this.onMouseLeave(e); };\r\n\t\tcomponent.onDragover = this.onMouseMove.bind(this);\r\n\t\tcomponent.onDragstart = this.onDragstart.bind(this);\r\n\t\tcomponent.onDrop = this.onClick.bind(this);\r\n\t\tcomponent.onMouseLeave = this.onMouseLeave.bind(this);\r\n\t\tcomponent.onMouseMove = this.onMouseMove.bind(this);\r\n\t\tcomponent.onMouseOver = (e) => { this.onMouseOver(e); };\r\n\t\tcomponent.resizableHeight = this.resizableHeight.bind(this);\r\n\t\tcomponent.resizableWidth = this.resizableWidth.bind(this);\r\n\t\tcomponent.setIsFinder = this.setIsFinder.bind(this);\r\n\t\tcomponent.setIsHovered = this.setIsHovered.bind(this);\r\n\t\tcomponent.setIsInsertChild = this.setIsInsertChild.bind(this);\r\n\t\tcomponent.setIsInsertParent = this.setIsInsertParent.bind(this);\r\n\t\tcomponent.setIsSelected = this.setIsSelected.bind(this);\r\n\t\tcomponent.setIsWizardFocus = this.setIsWizardFocus.bind(this);\r\n\t\tcomponent.wizardFocusType = WizardFocusEnum.UNFOCUSED;\r\n\r\n\t\t// Metadata\r\n\t\tcomponent.getBindingMetaData = this.getBindingMetaData.bind(this);\r\n\t\tcomponent.getContextMetaData = this.getContextMetaData.bind(this);\r\n\t\tcomponent.getLocalContextMetaData = this.getLocalContextMetaData.bind(this);\r\n\t\tcomponent.getParameterMetadata = this.getParameterMetadata.bind(this);\r\n\t\tcomponent.getFieldSettings = this.getFieldSettings.bind(this);\r\n\t\tcomponent.getSourceTriggers = this.getSourceTriggers.bind(this);\r\n\t\tcomponent.getTargetActions = this.getTargetActions.bind(this);\r\n\t\tcomponent.getDefaultAction = this.getDefaultAction.bind(this);\r\n\t\tcomponent.getDefaultTrigger = this.getDefaultTrigger.bind(this);\r\n\r\n\t\t// Data manipulative methods\r\n\t\tcomponent.detach = this.detach.bind(this);\r\n\t\tcomponent.setProperty = this.setProperty.bind(this);\r\n\t\tcomponent.setDatasource = this.setDatasource.bind(this);\r\n\t\tcomponent.removeDatasource = this.removeDatasource.bind(this);\r\n\r\n\t\t//Settings\r\n\t\tcomponent.getBindableField = this.getBindableField.bind(this);\r\n\t\tcomponent.setSetting = this.setSetting.bind(this);\r\n\t\tcomponent.setBoundarySetting = this.setBoundarySetting.bind(this);\r\n\t\tcomponent.getSettingCategories = this.getCurrentComponentFieldSettings.bind(this);\r\n\t\tcomponent.refreshMetaSettings = this.refreshMetaSettings.bind(this);\r\n\t\tcomponent.openDialog = this.openDialog.bind(this);\r\n\r\n\t\tthis.component = component;\r\n\t\tif (this.insertComponentService.getInsertComponent() === component.getDatabearer()) {\r\n\t\t\tthis.isInsertChild = true;\r\n\t\t}\r\n\r\n\t\tif (this.editorService.getCanvasMode() === CanvasModeEnum.SELECTION) {\r\n\t\t\tthis.isDraggable = true;\r\n\t\t}\r\n\t\tthis.editorService.canvasModeChangedEvent.on((canvasMode: CanvasModeEnum) => {\r\n\t\t\tif (canvasMode === CanvasModeEnum.SELECTION) {\r\n\t\t\t\tthis.isDraggable = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.isDraggable = false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\topenDialog(settingKey: string): ng.IPromise<void> {\r\n\t\tconst deferred = this.editorService.getNewDeferred<void>();\r\n\t\tlet options: IDialogOptions<IExpressionData>;\r\n\t\tconst style = \"width: 780px;\";\r\n\r\n\t\tif (settingKey === SettingKeys.IS_READONLY) {\r\n\t\t\toptions = {\r\n\t\t\t\tstyle,\r\n\t\t\t\ttitle: \"Component Expression - Disable When\",\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\tcomponent: this.component,\r\n\t\t\t\t\toption: ConditionType.DISABLE\r\n\t\t\t\t},\r\n\t\t\t\ttemplate: require(\"../component-settings/expression-dialog/expression-dialog.html\")\r\n\t\t\t};\r\n\t\t} else if (settingKey === SettingKeys.VISIBILITY) {\r\n\t\t\toptions = {\r\n\t\t\t\tstyle,\r\n\t\t\t\ttitle: \"Component Expression - Hide When\",\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\tcomponent: this.component,\r\n\t\t\t\t\toption: ConditionType.HIDE\r\n\t\t\t\t},\r\n\t\t\t\ttemplate: require(\"../component-settings/expression-dialog/expression-dialog.html\")\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (options) {\r\n\t\t\tthis.dialogService.show(options);\r\n\t\t}\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tsetSetting(settingMeta: IComponentFieldSetting, newSettingValue: any): void {\r\n\t\tconst component = this.component;\r\n\t\tconst settingReference = settingMeta.ref;\r\n\r\n\t\tif (component.isGenerated) {\r\n\t\t\t// Update original template\r\n\t\t\tconst generatingParent = component.getGeneratingParent();\r\n\t\t\tif (generatingParent.getTypedef() === ComponentNames.List) {\r\n\t\t\t\tconst generatingList: IEditorList = generatingParent as any;\r\n\t\t\t\tthis.editorService.forEachComponent(\r\n\t\t\t\t\t(generatingList as any).currentTemplate, // TODO: MUPS-2682 Remove this any\r\n\t\t\t\t\t(subComponent) => {\r\n\t\t\t\t\t\tif (subComponent.id === component.getId()) {\r\n\t\t\t\t\t\t\tif (settingMeta.boundarySetting) {\r\n\t\t\t\t\t\t\t\tconst currentBoundaryId = this.editorService.getCurrentBoundary().id;\r\n\t\t\t\t\t\t\t\tthis.setBoundarySettingOnDatabearer(subComponent, settingReference, newSettingValue, currentBoundaryId);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t(subComponent as IMap<any>)[settingReference] = newSettingValue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t\tgeneratingList.refresh();\r\n\t\t\t} else {\r\n\t\t\t\t// We only have List as generating parent so far\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (settingMeta.boundarySetting) {\r\n\t\t\t\tthis.setBoundarySetting<any>(settingReference, newSettingValue);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setProperty(settingReference, newSettingValue);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (settingReference === SettingKeys.VISIBILITY) {\r\n\t\t\tcomponent.updateVisibility();\r\n\t\t} else if (settingReference === SettingKeys.SHOW_ERROR) {\r\n\t\t\tcomponent.updateShowError();\r\n\t\t}\r\n\t}\r\n\r\n\tdetach(): IJsonComponent {\r\n\t\tif (this.component.parent.isLayoutComponent()) {\r\n\t\t\treturn this.component.parent.detachChild(this.component.getId());\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tsetBoundarySetting<T>(settingId: string, settingValue: T, boundaryId?: string): void {\r\n\t\tconst componentBoundarySettings = this.component.getDatabearer().boundarySettings;\r\n\t\tconst currentBoundaryId = this.editorService.getCurrentBoundary().id;\r\n\r\n\t\tif (!boundaryId) {\r\n\t\t\tboundaryId = currentBoundaryId;\r\n\t\t}\r\n\t\tthis.setBoundarySettingOnDatabearer(this.component.getDatabearer(), settingId, settingValue, boundaryId);\r\n\t\tif (boundaryId === currentBoundaryId) {\r\n\t\t\tthis.component.newBoundaryEntered(boundaryId);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setBoundarySettingOnDatabearer<T>(\r\n\t\tdatabearer: IJsonComponent,\r\n\t\tsettingId: string,\r\n\t\tsettingValue: T,\r\n\t\tboundaryId: string): void {\r\n\t\tconst componentBoundarySettings = databearer.boundarySettings;\r\n\t\tif (!componentBoundarySettings[boundaryId]) {\r\n\t\t\tcomponentBoundarySettings[boundaryId] = {};\r\n\t\t}\r\n\t\t(componentBoundarySettings[boundaryId] as IMap<T>)[settingId] = settingValue;\r\n\t}\r\n\r\n\tprivate onClick(event: IJQueryMouseEventObject | IJQueryDragEventObject): void {\r\n\t\tconst editorService = this.editorService;\r\n\t\tconst canvasMode = editorService.getCanvasMode();\r\n\t\tlet component = this.component;\r\n\t\tswitch (canvasMode) {\r\n\t\t\tcase CanvasModeEnum.SELECTION:\r\n\t\t\t\t// Toggle component selection\r\n\t\t\t\tif (this.isSelected) {\r\n\t\t\t\t\teditorService.deselectComponent();\r\n\t\t\t\t} else {\r\n\t\t\t\t\teditorService.setSelectedComponent(component);\r\n\t\t\t\t}\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tbreak;\r\n\t\t\tcase CanvasModeEnum.FINDER:\r\n\t\t\t\tif (component.wizardFocusType !== WizardFocusEnum.UNFOCUSED) {\r\n\t\t\t\t\t//Must include editorService\r\n\t\t\t\t\tcomponent = EditorHelper.getUnderlyingComponent(component, event, editorService) as IEditorComponent;\r\n\t\t\t\t}\r\n\t\t\t\tthis.editorService.selectFinderComponent(component);\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\tbreak;\r\n\t\t\tcase CanvasModeEnum.INSERT:\r\n\t\t\t\tthis.$timeout.cancel(this.dragstartTimer);\r\n\t\t\t\tif (component.isLayoutComponent() && !component.isGenerated) {\r\n\t\t\t\t\tthis.insertComponentService.finishInsert(event, (component as IEditorFlexbox));\r\n\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Propagate for regular components\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t// Do nothing\r\n\t\t}\r\n\t\t// Triggers dropdown and popover to close (soho xi)\r\n\t\tangular.element(\"body\").click();\r\n\t}\r\n\r\n\tprivate onMouseLeave(e: IJQueryDragEventObject | IJQueryMouseEventObject): void {\r\n\t\tconst editorService = this.editorService;\r\n\t\tconst canvasMode = editorService.getCanvasMode();\r\n\t\tswitch (canvasMode) {\r\n\t\t\tcase CanvasModeEnum.SELECTION:\r\n\t\t\t\teditorService.setHoveredComponent();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\tbreak;\r\n\t\t\tcase CanvasModeEnum.FINDER:\r\n\t\t\t\teditorService.setFinderComponent();\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\tbreak;\r\n\t\t\tcase CanvasModeEnum.INSERT:\r\n\t\t\t\tif (this.component.isLayoutComponent() && !this.component.isGenerated) {\r\n\t\t\t\t\tif (e.type === EventTypes.DRAGLEAVE) {\r\n\t\t\t\t\t\t// When leaving the canvas\r\n\t\t\t\t\t\tif (EditorComponentCtrl.dragEnterCounter === 0) {\r\n\t\t\t\t\t\t\tthis.insertComponentService.setInsertParent(null);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.insertComponentService.setInsertParent(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t\te.stopPropagation();\r\n\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t// Do nothing\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onDragstart(event: IJQueryDragEventObject): void {\r\n\t\tevent.stopPropagation();\r\n\t\tconst canvasMode = this.editorService.getCanvasMode();\r\n\t\tswitch (canvasMode) {\r\n\t\t\tcase CanvasModeEnum.SELECTION:\r\n\t\t\t\tconst component = this.component;\r\n\t\t\t\tconst editorService = this.editorService;\r\n\t\t\t\tthis.$timeout.cancel(this.dragstartTimer);\r\n\t\t\t\tif (!component.isLayoutComponent() && !component.isGenerated) {\r\n\t\t\t\t\t// Deselect text\r\n\t\t\t\t\twindow.getSelection().removeAllRanges();\r\n\r\n\t\t\t\t\tevent.originalEvent.dataTransfer.effectAllowed = \"move\";\r\n\r\n\t\t\t\t\t// Using timeout because Chrome cancels drag-event on some dom manipulations\r\n\t\t\t\t\tthis.dragstartTimer = this.$timeout(() => {\r\n\t\t\t\t\t\tcomponent.detach();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Setting pointer-events: auto, to override insertMode {pointe-events: none; }\r\n\t\t\t\t\tcomponent.element.css(CssConstantKeys.POINTER_EVENTS, CssConstantValues.AUTO);\r\n\t\t\t\t\tconst originIndex = component.parent.getDatabearer().children.indexOf(component.getDatabearer());\r\n\r\n\t\t\t\t\tthis.insertComponentService.startInserting(component.getDatabearer(), InsertEventTypes.MOVE)\r\n\t\t\t\t\t\t.then((newParent: IEditorFlexbox) => {\r\n\t\t\t\t\t\t\teditorService.saveCanvas();\r\n\t\t\t\t\t\t}).catch(() => {\r\n\t\t\t\t\t\t\tcomponent.parent.insert(component.getDatabearer(), originIndex);\r\n\t\t\t\t\t\t}).finally(() => {\r\n\t\t\t\t\t\t\teditorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase CanvasModeEnum.FINDER:\r\n\t\t\tcase CanvasModeEnum.INSERT:\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t// Do nothing\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onMouseMove(event: IJQueryMouseEventObject | IJQueryDragEventObject): void {\r\n\t\tconst canvasMode = this.editorService.getCanvasMode();\r\n\t\tswitch (canvasMode) {\r\n\t\t\tcase CanvasModeEnum.SELECTION:\r\n\t\t\tcase CanvasModeEnum.FINDER:\r\n\t\t\t\tbreak;\r\n\t\t\tcase CanvasModeEnum.INSERT:\r\n\t\t\t\tconst insertComponent = this.insertComponentService.getInsertComponent();\r\n\t\t\t\tif (\r\n\t\t\t\t\tinsertComponent\r\n\t\t\t\t\t&& this.component.isLayoutComponent()\r\n\t\t\t\t\t&& !this.component.isGenerated\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis.insertComponentService.insertIteration(event, (this.component as IEditorFlexbox));\r\n\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t// Do nothing\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onMouseOver(e: IJQueryDragEventObject | IJQueryMouseEventObject): void {\r\n\t\tconst component = this.component;\r\n\t\tconst editorService = this.editorService;\r\n\t\tconst canvasMode = editorService.getCanvasMode();\r\n\t\tswitch (canvasMode) {\r\n\t\t\tcase CanvasModeEnum.SELECTION:\r\n\t\t\t\teditorService.setHoveredComponent(this.isSelected ? null : component);\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\tbreak;\r\n\t\t\tcase CanvasModeEnum.FINDER:\r\n\t\t\t\teditorService.setFinderComponent(component);\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\tbreak;\r\n\t\t\tcase CanvasModeEnum.INSERT:\r\n\t\t\t\tif (component.isLayoutComponent() && !component.isGenerated) {\r\n\t\t\t\t\tthis.insertComponentService.setInsertParent(component as IEditorFlexbox);\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t// Do nothing\r\n\t\t}\r\n\t}\r\n\r\n\tresizableHeight(): boolean {\r\n\t\tconst component = this.component;\r\n\t\tconst height = component.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT);\r\n\t\tif (!height) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tconst heightType = height.sizeType;\r\n\t\tif ((heightType === SizeTypeEnum.PIXELS || heightType === SizeTypeEnum.PERCENT) &&\r\n\t\t\tcomponent.parent.resizableChildren(OrientationEnum.VERTICAL) &&\r\n\t\t\t!component.isGenerated) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tresizableWidth(): boolean {\r\n\t\tconst component = this.component;\r\n\t\tconst width = component.getBoundarySetting<IJsonSize>(SettingKeys.WIDTH);\r\n\t\tif (!width) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tconst widthType = width.sizeType;\r\n\t\tif ((widthType === SizeTypeEnum.PIXELS || widthType === SizeTypeEnum.PERCENT) &&\r\n\t\t\tcomponent.parent.resizableChildren(OrientationEnum.HORIZONTAL) &&\r\n\t\t\t!component.isGenerated) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate setIsFinder(isFinder: boolean): void {\r\n\t\tthis.isFinder = isFinder;\r\n\t}\r\n\r\n\tprivate setIsHovered(isHovered: boolean): void {\r\n\t\tthis.isHovered = isHovered;\r\n\t}\r\n\r\n\tprivate setIsInsertChild(isInsertChild: boolean): void {\r\n\t\tthis.isInsertChild = isInsertChild;\r\n\t}\r\n\r\n\tprivate setIsInsertParent(isInsertParent: boolean): void {\r\n\t\tthis.isInsertParent = isInsertParent;\r\n\t}\r\n\r\n\tprivate setIsSelected(isSelected: boolean): void {\r\n\t\tthis.isSelected = isSelected;\r\n\t}\r\n\r\n\tprivate setIsWizardFocus(isWizardFocusEnum: WizardFocusEnum): void {\r\n\t\tthis.wizardFocusType = isWizardFocusEnum;\r\n\t\tthis.component.wizardFocusType = isWizardFocusEnum;\r\n\t}\r\n\r\n\tprivate setProperty(propertyName: string, newValue: any): void {\r\n\t\t(this.component as any)[propertyName] = newValue;\r\n\t\t(this.component.getDatabearer() as any)[propertyName] = newValue;\r\n\t\t// TODO: Maybe this is too general. Could run updateClasses, updateInlineStyle depending on the need\r\n\t\tthis.component.updateClassesAndStyle();\r\n\t}\r\n\r\n\tprivate getCurrentComponentFieldSettings(): IComponentSettingCategory[] {\r\n\t\treturn this.component.getFieldSettings();\r\n\t}\r\n\r\n\tsetDatasource(newDatasource: IDatasource | null): ng.IPromise<void> {\r\n\t\tconst component = this.component;\r\n\t\tconst deferred = this.editorService.getNewDeferred<void>();\r\n\r\n\t\tcomponent.resetLayout();\r\n\r\n\t\tif (component.datasource) {\r\n\t\t\tcomponent.datasource.usedBy.forEach((usedByComponent, index, list) => {\r\n\t\t\t\tif (usedByComponent === component) {\r\n\t\t\t\t\tlist.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (newDatasource) {\r\n\t\t\tcomponent.datasource = newDatasource;\r\n\t\t\tcomponent.getDatabearer().datasource = newDatasource.id;\r\n\t\t\tnewDatasource.usedBy.push(component);\r\n\r\n\t\t\tif (component.isGenerated) {\r\n\t\t\t\tthis.refreshGeneratedComponents(component);\r\n\t\t\t}\r\n\r\n\t\t\tnewDatasource.getMetaData()\r\n\t\t\t\t.catch(() => {\r\n\t\t\t\t\tconsole.error(\"[EdtiorComponent] Problem getting datasourceMetadata\");\r\n\t\t\t\t\tthis.clearData();\r\n\t\t\t\t\tdeferred.reject();\r\n\t\t\t\t})\r\n\t\t\t\t.finally(() => {\r\n\t\t\t\t\tdeferred.resolve();\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.removeDatasource();\r\n\t\t\t// Finished unsetting\r\n\t\t\tdeferred.resolve();\r\n\t\t}\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate refreshGeneratedComponents(component: IEditorComponent): void {\r\n\t\tconst parent = component.getGeneratingParent() as IComponent;\r\n\t\tif (parent.getTypedef() === ComponentNames.List) {\r\n\t\t\t(parent as IListComponent).refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected clearData(): void {\r\n\t\tconst component = this.component;\r\n\t\tcomponent.resetContext();\r\n\t\tif (component.isGenerated) {\r\n\t\t\tconst generatingParent = component.getGeneratingParent();\r\n\t\t\t(generatingParent as any as IListComponent).refresh();\r\n\t\t}\r\n\t}\r\n\r\n\trefreshMetaSettings(showDialog?: boolean): void {\r\n\t\t// Override this method\r\n\t}\r\n\r\n\tremoveDatasource(): void {\r\n\t\tconst component = this.component;\r\n\t\tthis.clearData();\r\n\r\n\t\t// Reset datasource\r\n\t\tcomponent.datasource = null;\r\n\t\tcomponent.getDatabearer().datasource = null;\r\n\t\tthis.refreshMetaSettings();\r\n\r\n\t\t// Reset the layout to remove any extra error tooltips etc\r\n\t\tcomponent.resetLayout();\r\n\t}\r\n\r\n\t/**\r\n\t * Get metadata about available parameters for a given Action\r\n\t * Most cases are reliant on datasource metadata, and therefore returns a promise\r\n\t *\r\n\t * @param action{InteractionActionEnum}\r\n\t */\r\n\tgetParameterMetadata(action: InteractionActionEnum): ng.IPromise<IAvailableTargetField[]> {\r\n\t\tconst component = this.component;\r\n\t\tconst deferred = this.editorService.getNewDeferred<IAvailableTargetField[]>();\r\n\t\tif (component.datasource) {\r\n\t\t\treturn component.datasource.getMetaData().then((metaData) => {\r\n\t\t\t\treturn metaData.inputFields.map((inputField) => {\r\n\t\t\t\t\tconst isMandatory = inputField.MAND === \"1\";\r\n\t\t\t\t\tconst availableTargetField: IAvailableTargetField = {\r\n\t\t\t\t\t\tvisibleName: inputField.FLDS + \" (\" + (isMandatory ? \"Required\" : \"Optional\") + \")\",\r\n\t\t\t\t\t\ttargetKey: inputField.FLNM,\r\n\t\t\t\t\t\tisMandatory: isMandatory,\r\n\t\t\t\t\t\tMeta: {\r\n\t\t\t\t\t\t\tname: inputField.FLDS,\r\n\t\t\t\t\t\t\tref: inputField.FLNM,\r\n\t\t\t\t\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\t\t\t\t\twrite: true,\r\n\t\t\t\t\t\t\tread: true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn availableTargetField;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tdeferred.reject();\r\n\t\t}\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tgetLocalContextMetaData(): ng.IPromise<IAvailableSourceField[]> {\r\n\t\tconst deferred = this.editorService.getNewDeferred<IAvailableSourceField[]>();\r\n\t\tconst meta: IAvailableSourceField[] = [];\r\n\t\tconst datasource = this.component.getDatasource();\r\n\t\tif (datasource) {\r\n\t\t\t// Only add the ListData and SingleData on generic version 1\r\n\t\t\tif (datasource.typedef === DatasourceTypeEnum.generic && datasource.version === 1) {\r\n\t\t\t\tmeta.push({\r\n\t\t\t\t\tvisibleName: datasource.displayName + \"(ListData)\",\r\n\t\t\t\t\tsourceKey: ContextKeys.LIST_RESULT,\r\n\t\t\t\t\tsourceKeyShort: ContextKeys.LIST_RESULT,\r\n\t\t\t\t\tcurrentValue: \"\"\r\n\t\t\t\t});\r\n\r\n\t\t\t\tmeta.push({\r\n\t\t\t\t\tvisibleName: datasource.displayName + \"(SingleData)\",\r\n\t\t\t\t\tsourceKey: ContextKeys.DETAIL_RESULT,\r\n\t\t\t\t\tsourceKeyShort: ContextKeys.DETAIL_RESULT,\r\n\t\t\t\t\tcurrentValue: \"\"\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tdatasource.getMetaData()\r\n\t\t\t\t.then((metaData: IMetaData) => {\r\n\t\t\t\t\tmetaData.outputFields.map((outputField: IMetaDataField) => {\r\n\t\t\t\t\t\tmeta.push({\r\n\t\t\t\t\t\t\tvisibleName: outputField.FLDS.trim(),\r\n\t\t\t\t\t\t\tsourceKey: outputField.FLNM,\r\n\t\t\t\t\t\t\tsourceKeyShort: outputField.FLNM,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tdeferred.resolve(meta);\r\n\t\t\t\t});\r\n\r\n\t\t} else {\r\n\t\t\tdeferred.resolve([]);\r\n\t\t}\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tgetContextMetaData(): ng.IPromise<IAvailableSourceField[]> {\r\n\t\tconst deferred = this.editorService.getNewDeferred<IAvailableSourceField[]>();\r\n\t\tconst promiseList: ng.IPromise<IAvailableSourceField[]>[] = [];\r\n\t\tlet availableSourceField: IAvailableSourceField[] = [];\r\n\r\n\t\tthis.component.forEachParent((parent: IEditorLayoutComponent) => {\r\n\t\t\tconst promise = parent.getLocalContextMetaData();\r\n\t\t\tpromise.then((parentMeta) => {\r\n\t\t\t\tavailableSourceField = availableSourceField.concat(parentMeta);\r\n\t\t\t});\r\n\t\t\tpromiseList.push(promise);\r\n\t\t});\r\n\r\n\t\tconst promise = this.getLocalContextMetaData();\r\n\t\tpromiseList.push(promise);\r\n\t\tpromise.then((metadata) => {\r\n\t\t\tavailableSourceField = availableSourceField.concat(metadata);\r\n\t\t});\r\n\r\n\t\tthis.editorService.onAllPromises(promiseList).then(() => {\r\n\r\n\t\t\t// Removing duplicates. http://stackoverflow.com/a/32238830/304894\r\n\t\t\tconst values: any = {};\r\n\t\t\tavailableSourceField = availableSourceField.filter((item: any) => {\r\n\t\t\t\tconst key = \"sourceKey\";\r\n\t\t\t\tconst val = item[key];\r\n\t\t\t\tconst exists = values[val];\r\n\t\t\t\tvalues[val] = true;\r\n\t\t\t\treturn !exists;\r\n\t\t\t});\r\n\r\n\t\t\tavailableSourceField.forEach((contextField) => {\r\n\t\t\t\tconst context = this.component.getContext();\r\n\t\t\t\tconst maxLength = Numbers.TWENTY;\r\n\t\t\t\tconst key = contextField.sourceKeyShort;\r\n\t\t\t\tif (context[key]) {\r\n\t\t\t\t\tif (key === ContextKeys.DETAIL_RESULT) {\r\n\t\t\t\t\t\tcontextField.currentValue = \"size: \" + context[key].length;\r\n\t\t\t\t\t} else if (key === ContextKeys.LIST_RESULT) {\r\n\t\t\t\t\t\tcontextField.currentValue = \"length: \" + context[key].length;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcontextField.currentValue = ComponentsHelper.truncate(context[key], maxLength);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdeferred.resolve(availableSourceField);\r\n\t\t});\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tgetBindingMetaData(): ng.IPromise<IAvailableSourceField[]> {\r\n\t\tconst promises: ng.IPromise<void>[] = [];\r\n\t\tconst component = this.component;\r\n\t\tlet availableBindings: IAvailableSourceField[] = [];\r\n\r\n\t\tif (component.getDatasource() && !this.hasBindableFields()) {\r\n\t\t\tconst deferred = this.editorService.getNewDeferred<void>();\r\n\t\t\tthis.getContextMetaData().then((availableSourceFields: IAvailableSourceField[]) => {\r\n\t\t\t\tavailableBindings = availableSourceFields;\r\n\t\t\t\tdeferred.resolve();\r\n\t\t\t});\r\n\t\t\tpromises.push(deferred.promise);\r\n\t\t} else {\r\n\t\t\tthis.component.forEachBindable((bindableFieldDefinition, currentValueSource: IJsonValueSource) => {\r\n\t\t\t\tconst deferred = this.editorService.getNewDeferred<void>();\r\n\t\t\t\tif (bindableFieldDefinition.valueType === ValueTypeEnum.OBJECT) {\r\n\t\t\t\t\tthis.getMetaData(bindableFieldDefinition.ref, (objectMetaData: IMetaDataField[]) => {\r\n\t\t\t\t\t\tobjectMetaData.forEach((currentItemMetaData) => {\r\n\t\t\t\t\t\t\tconst currentValue: string = currentValueSource ?\r\n\t\t\t\t\t\t\t\tcurrentValueSource[currentItemMetaData.FLNM] : null;\r\n\t\t\t\t\t\t\tconst fldsName = currentItemMetaData.FLDS ? \" [\" + currentItemMetaData.FLDS + \"]\" : \"\";\r\n\t\t\t\t\t\t\tconst currentVisibleName =\r\n\t\t\t\t\t\t\t\tbindableFieldDefinition.name + fldsName;\r\n\r\n\t\t\t\t\t\t\tavailableBindings.push({\r\n\t\t\t\t\t\t\t\tvisibleName: currentVisibleName,\r\n\t\t\t\t\t\t\t\tsourceKey: bindableFieldDefinition.ref + \".\" + currentItemMetaData.FLNM,\r\n\t\t\t\t\t\t\t\tsourceKeyShort: currentItemMetaData.FLNM,\r\n\t\t\t\t\t\t\t\tcurrentValue: currentValue\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdeferred.resolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tpromises.push(deferred.promise);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (bindableFieldDefinition.read) {\r\n\t\t\t\t\t\tavailableBindings.push({\r\n\t\t\t\t\t\t\tvisibleName: bindableFieldDefinition.name,\r\n\t\t\t\t\t\t\tsourceKey: bindableFieldDefinition.ref,\r\n\t\t\t\t\t\t\tsourceKeyShort: bindableFieldDefinition.ref,\r\n\t\t\t\t\t\t\tcurrentValue: (this as any)[bindableFieldDefinition.ref]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tconst deferred = this.editorService.getNewDeferred<IAvailableSourceField[]>();\r\n\t\tthis.editorService.onAllPromises(promises).then(() => {\r\n\t\t\tdeferred.resolve(availableBindings);\r\n\t\t});\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\t// Method for components with bindable value type \"Object\"\r\n\tgetMetaData(fieldRef: string, onSuccess: Function): void {\r\n\t\tconsole.warn(\"[Component] Unimplemented method getMetaData()\");\r\n\t}\r\n\r\n\tgetBindableField(bindableReference: string): IJsonValueSource {\r\n\t\treturn (this.component.getDatabearer() as any)[bindableReference];\r\n\t}\r\n\r\n\tgetFieldSettings(): IComponentSettingCategory[] {\r\n\t\treturn Defines.allComponents[this.component.getTypedef()].class.SETTING_FIELDS;\r\n\t}\r\n\r\n\tgetSourceTriggers(): IDataPair[] {\r\n\t\treturn Defines.allComponents[this.component.getTypedef()].class.SOURCE_TRIGGERS;\r\n\t}\r\n\r\n\tgetTargetActions(): IDataPair[] {\r\n\t\treturn Defines.allComponents[this.component.getTypedef()].class.TARGET_ACTIONS;\r\n\t}\r\n\r\n\tgetDefaultAction(): IDataPair {\r\n\t\treturn Defines.allComponents[this.component.getTypedef()].class.DEFAULT_ACTION;\r\n\t}\r\n\r\n\tgetDefaultTrigger(): IDataPair {\r\n\t\treturn Defines.allComponents[this.component.getTypedef()].class.DEFAULT_TRIGGER;\r\n\t}\r\n\r\n\tprivate hasBindableFields(): boolean {\r\n\t\tconst bindableFields = Defines.allComponents[this.component.getDatabearer().typedef].class.BINDABLE_FIELDS_2;\r\n\t\treturn bindableFields.length > 0;\r\n\t}\r\n}\r\n\r\nexport class EditorComponentDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirEditorComponent\", () => {\r\n\t\t\treturn {\r\n\t\t\t\trestrict: \"A\",\r\n\t\t\t\tcontroller: \"@\",\r\n\t\t\t\tcontrollerAs: \"eirEditorComponent\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IFieldSettingButton } from \"ng2/common/model/components/settings/field-setting-button.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../services/editor-service\";\r\n\r\nexport abstract class SettingsBase {\r\n\tprotected selectedComponent: IEditorComponent;\r\n\tprotected button: IFieldSettingButton;\r\n\tprotected settingsRef: string;\r\n\tprotected currentBoundary: IBoundary;\r\n\tprotected unsubscribers: Function[] = [];\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: ng.IScope,\r\n\t\tprotected editorService: EditorService\r\n\t) {\r\n\t\tthis.unsubscribers.push(editorService.selectedComponentChangedEvent.on((newComponent) => {\r\n\t\t\tif (newComponent) {\r\n\t\t\t\tthis.onComponentChanged(newComponent);\r\n\t\t\t} else {\r\n\t\t\t\tthis.onComponentChanged(null);\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(editorService.currentBoundaryChangedEvent.on((newBoundary: IBoundary) => {\r\n\t\t\tthis.onBoundaryChanged(newBoundary);\r\n\t\t}));\r\n\t\tthis.selectedComponent = this.editorService.getSelectedComponent();\r\n\t\tthis.currentBoundary = this.editorService.getCurrentBoundary();\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t//Setting value type varies\r\n\tpublic onChangeSetting(settingMeta: IComponentFieldSetting, settingValue: any): void {\r\n\t\tthis.selectedComponent.setSetting(settingMeta, settingValue);\r\n\t\tthis.editorService.saveCanvas();\r\n\t}\r\n\r\n\tpublic onIconClick(): void {\r\n\t\tif (this.button && this.button.dialog) {\r\n\t\t\tthis.selectedComponent.openDialog(this.settingsRef).then(() => {\r\n\t\t\t\tthis.refresh();\r\n\t\t\t\t// tslint:disable-next-line:no-bitwise\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.CANVAS_COMPONENTS | SaveFlagsEnum.MANIFEST);\r\n\t\t\t});\r\n\t\t} //else add more functions?\r\n\t}\r\n\r\n\tprotected refresh(): void {\r\n\t\t// overriden\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(newBoundary: IBoundary): void {\r\n\t\tthis.currentBoundary = newBoundary;\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\t// If selected component or newComponent is null -\r\n\t\t// the current setting view is destructing and a new component will be selected through the new settings construct\r\n\t\tif (!(this.selectedComponent && newComponent) || this.selectedComponent.getTypedef() === newComponent.getTypedef()) {\r\n\t\t\tthis.selectedComponent = newComponent;\r\n\t\t} else {\r\n\t\t\tthis.selectedComponent = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected readSettingValue<T>(setting: IComponentFieldSetting): T {\r\n\t\tconst component = this.selectedComponent;\r\n\t\tconst reference = setting.ref;\r\n\t\tlet value: T = undefined;\r\n\t\tif (setting.boundarySetting) {\r\n\t\t\tvalue = component.getBoundarySetting<T>(reference, this.currentBoundary.id);\r\n\t\t\tif (value === null) {\r\n\t\t\t\tvalue = setting.defaultValue;\r\n\t\t\t}\r\n\t\t} else if ((component as IMap<any>)[reference] !== undefined) {\r\n\t\t\tvalue = (component as IMap<any>)[reference];\r\n\t\t} else if ((component.getDatabearer() as IMap<any>)[reference] !== undefined) {\r\n\t\t\t//Datagrids isList is only accessable via databearer due to refresh-datagrid\r\n\t\t\tvalue = (component.getDatabearer() as IMap<any>)[reference];\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n}\r\n","import isEmpty from \"lodash-es/isEmpty\";\r\nimport isNil from \"lodash-es/isNil\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport {\r\n\tButtonStyle,\r\n\tChartTypeEnum,\r\n\tDEFAULT_BOUNDARY,\r\n\tValueObject,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonButton } from \"ng2/common/model/databearer/components/json-button.model\";\r\nimport type { IJsonChart, IJsonChartDataset } from \"ng2/common/model/databearer/components/json-chart.model\";\r\nimport type { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJSonMaskSettings, IJsonTextBox } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\nimport type { IHttpHeader } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\n\r\nimport { HttpAcceptEnum } from \"ng2/common/enums/http-accept-enum\";\r\n\r\nexport class BackwardCompatible {\r\n\tstatic setDataServiceHeader(headers: IHttpHeader): IHttpHeader {\r\n\t\treturn !isUndefined(headers) && !isEmpty(headers) ? headers : {\r\n\t\t\tAccept: HttpAcceptEnum.APPLICATION_JSON,\r\n\t\t};\r\n\t}\r\n\r\n\tstatic tryUpdateUrlName(manifest: IJsonRuntimeManifest): boolean {\r\n\t\tif (manifest.urlName === \"url\") { // backward compatbility\r\n\t\t\tconst newUrlName = `(SETVARVALUES(InitURL=run/${manifest.id}))`;\r\n\t\t\tmanifest.urlName = newUrlName;\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tstatic tryGetMask(obj: IJsonTextBox): IJSonMaskSettings {\r\n\t\tif (obj.mask) { // backward compatbility\r\n\t\t\treturn obj.mask;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tprocess: \"none\"\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Check if showlabel is legacy format or not.\r\n\t * Parameter is any beacuse it can be any component\r\n\t * @param obj\r\n\t */\r\n\r\n\tstatic getShowLabel(obj: any): boolean {\r\n\t\tconst defaultBoundary = obj.boundarySettings[DEFAULT_BOUNDARY.id];\r\n\t\tif (!isNil(defaultBoundary.showLabel)) {\r\n\t\t\treturn defaultBoundary.showLabel;\r\n\t\t} else {\r\n\t\t\tif (obj.showLabel) {\r\n\t\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].showLabel = obj.showLabel.value;\r\n\t\t\t} else {\r\n\t\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].showLabel = true;\r\n\t\t\t}\r\n\t\t\treturn obj.boundarySettings[DEFAULT_BOUNDARY.id].showLabel;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic tryGetBoxWidth(width: string): string {\r\n\t\tif (width) {\r\n\t\t\treturn width;\r\n\t\t} else {\r\n\t\t\treturn \"input-default\";\r\n\t\t}\r\n\t}\r\n\r\n\tstatic tryUpdateButtonStyle(obj: IJsonButton): string {\r\n\t\tlet style: string;\r\n\r\n\t\tif (!obj.style) {\r\n\t\t\tif (obj.isDefault) {\r\n\t\t\t\tstyle = ButtonStyle.PRIMARY;\r\n\t\t\t} else {\r\n\t\t\t\tstyle = ButtonStyle.SECONDARY;\r\n\t\t\t}\r\n\t\t\tconsole.warn(\"Deprecated property found in Button component\");\r\n\t\t} else {\r\n\t\t\tstyle = obj.style;\r\n\t\t}\r\n\t\treturn style;\r\n\t}\r\n\r\n\tstatic getHref(rowData: any, column: IExtendedDataGridColumn): string {\r\n\t\tlet hrefString = \"\";\r\n\t\tif (column.hyperlinkOptions) {\r\n\t\t\tif (column.field === ValueObject.STATIC_VALUE) {\r\n\t\t\t\threfString = column.hyperlinkOptions.value.replace(\"{$value}\", column.text);\r\n\t\t\t} else {\r\n\t\t\t\threfString = column.hyperlinkOptions.value.replace(\"{$value}\", rowData[column.field]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (column.field === ValueObject.STATIC_VALUE) {\r\n\t\t\t\threfString = column.text;\r\n\t\t\t} else {\r\n\t\t\t\threfString = rowData[column.field];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn hrefString;\r\n\t}\r\n\r\n\tstatic tryConvertLegacyChart(databearer: IJsonChart, obj: IJsonChart): void {\r\n\t\tconst defaultBoundary = obj.boundarySettings[DEFAULT_BOUNDARY.id];\r\n\t\tif (this.isLegacyChart(databearer)) {\r\n\t\t\tif (this.isLegacyChartType(defaultBoundary.chartType) || !defaultBoundary.chartType) {\r\n\t\t\t\tlet newType: ChartTypeEnum;\r\n\t\t\t\tswitch (defaultBoundary.chartType) {\r\n\t\t\t\t\tcase ChartTypeEnum.StackedColumn:\r\n\t\t\t\t\t\tnewType = ChartTypeEnum.ColumnStacked;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase ChartTypeEnum.Profile:\r\n\t\t\t\t\tcase ChartTypeEnum.StackedLine:\r\n\t\t\t\t\t\tnewType = ChartTypeEnum.Line;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: // unknown legacy chartType\r\n\t\t\t\t\t\tnewType = ChartTypeEnum.Bar;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].chartType = newType;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.hasLegacyChartData(databearer)) {\r\n\t\t\t\tthis.convertToNewChartFormat(databearer);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//Add default values if missing\r\n\t\tif (isNil(defaultBoundary.legendDisplay)) {\r\n\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].legendDisplay = true;\r\n\t\t}\r\n\t\tif (isNil(defaultBoundary.startupAnimationEnable)) {\r\n\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].startupAnimationEnable = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static isLegacyChart(databearer: IJsonChart): boolean {\r\n\t\treturn this.hasLegacyChartData(databearer) ||\r\n\t\t\tthis.isLegacyChartType(databearer.boundarySettings[DEFAULT_BOUNDARY.id].chartType) ||\r\n\t\t\t!databearer.boundarySettings[DEFAULT_BOUNDARY.id].chartType;\r\n\t}\r\n\r\n\tprivate static hasLegacyChartData(databearer: IJsonChart): boolean {\r\n\t\treturn databearer.categories && databearer.categories.length > 0;\r\n\t}\r\n\r\n\tprivate static isLegacyChartType(chartType: ChartTypeEnum): boolean {\r\n\t\treturn [ChartTypeEnum.Profile, ChartTypeEnum.StackedColumn, ChartTypeEnum.StackedLine].includes(chartType);\r\n\t}\r\n\r\n\tprivate static convertToNewChartFormat(databearer: IJsonChart): void {\r\n\t\tdatabearer.categories.forEach((category, i) => {\r\n\t\t\tlet newDataset: IJsonChartDataset;\r\n\t\t\tif (databearer.series[i]) {\r\n\t\t\t\tnewDataset = {\r\n\t\t\t\t\tname: category.name,\r\n\t\t\t\t\tcategories: category.field,\r\n\t\t\t\t\tseries: databearer.series[i].field,\r\n\t\t\t\t};\r\n\t\t\t\tdatabearer.datasets.push(newDataset); // push new format\r\n\t\t\t}\r\n\t\t});\r\n\t\tdatabearer.series = null; // remove legacy format\r\n\t\tdatabearer.categories = null; // remove legacy format\r\n\t}\r\n}\r\n","import { BindingTypes, ValueObject, ComponentNames } from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { ChartSettingsCtrl } from \"./component-settings/chart/chart-settings\";\r\nimport { DatagridSettings } from \"./component-settings/datagrid/datagrid-settings\";\r\nimport { FlexboxSettings } from \"./component-settings/flexbox/flexbox-settings\";\r\nimport { ListSettings } from \"./component-settings/list/list-settings\";\r\nimport { LookupSettings } from \"./component-settings/lookup/lookup-settings\";\r\nimport { RadioButtonSettings } from \"./component-settings/radiobutton/radiobutton-settings\";\r\nimport { TabPanelSettings } from \"./component-settings/tabs/tab-panel-settings\";\r\nimport { TabsSettings } from \"./component-settings/tabs/tabs-settings\";\r\nimport { TextboxSettings } from \"./component-settings/textbox/textbox-settings\";\r\n\r\nexport interface IInsertPoints {\r\n\torientation: OrientationEnum;\r\n\tpoints: number[];\r\n\tlength: number;\r\n\tposition: number;\r\n}\r\n\r\nexport interface ISettingsClassInstance {\r\n\tcreate(id: string): IJsonComponent;\r\n\tcontentSettingsDirective?: ng.IDirective;\r\n\tstyleSettingsDirective?: ng.IDirective;\r\n}\r\n\r\nexport interface ISettingsClass {\r\n\tnew (): ISettingsClassInstance;\r\n\tgetInstance(): ISettingsClassInstance;\r\n}\r\n\r\nexport interface ISettingsComponentListEntry {\r\n\tsettingsClass: ISettingsClass;\r\n}\r\n\r\nexport class SourceComponent {\r\n\tpublic static STATIC_VALUE_OBJECT = {\r\n\t\tid: BindingTypes.STATIC,\r\n\t\tname: ValueObject.STATIC_VALUE,\r\n\t\tisComponent: false\r\n\t};\r\n\tpublic static TARGET_CONTEXT_OBJECT = {\r\n\t\tid: BindingTypes.CONTEXT,\r\n\t\tname: ValueObject.TARGET_CONTEXT,\r\n\t\tisComponent: false\r\n\t};\r\n\tpublic static URL_VALUE_OBJECT = {\r\n\t\tid: BindingTypes.URL,\r\n\t\tname: ValueObject.URL_VALUE,\r\n\t\tisComponent: false\r\n\t};\r\n}\r\n\r\nexport interface ISourceComponent {\r\n\tid: string;\r\n\tname: string;\r\n\tisComponent: boolean;\r\n}\r\n\r\nexport class Defines {\r\n\tstatic get allSettingsComponents(): IMap<ISettingsComponentListEntry> {\r\n\t\tconst settingsComponentsList: IMap<ISettingsComponentListEntry> = {};\r\n\t\tsettingsComponentsList[ComponentNames.Chart] = {\r\n\t\t\tsettingsClass: ChartSettingsCtrl\r\n\t\t};\r\n\t\tsettingsComponentsList[ComponentNames.Datagrid] = {\r\n\t\t\tsettingsClass: DatagridSettings\r\n\t\t};\r\n\t\tsettingsComponentsList[ComponentNames.Flexbox] = {\r\n\t\t\tsettingsClass: FlexboxSettings\r\n\t\t};\r\n\t\tsettingsComponentsList[ComponentNames.List] = {\r\n\t\t\tsettingsClass: ListSettings\r\n\t\t};\r\n\t\tsettingsComponentsList[ComponentNames.Lookup] = {\r\n\t\t\tsettingsClass: LookupSettings\r\n\t\t};\r\n\t\tsettingsComponentsList[ComponentNames.RadioButton] = {\r\n\t\t\tsettingsClass: RadioButtonSettings\r\n\t\t};\r\n\t\tsettingsComponentsList[ComponentNames.Tabs] = {\r\n\t\t\tsettingsClass: TabsSettings\r\n\t\t};\r\n\t\tsettingsComponentsList[ComponentNames.TabPanel] = {\r\n\t\t\tsettingsClass: TabPanelSettings\r\n\t\t};\r\n\t\tsettingsComponentsList[ComponentNames.TextBox] = {\r\n\t\t\tsettingsClass: TextboxSettings\r\n\t\t};\r\n\t\treturn settingsComponentsList;\r\n\t}\r\n\r\n}\r\n\r\nexport class SidebarViewEnum {\r\n\tconstructor(public value: string) { }\r\n\r\n\tpublic toString(): string {\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\tstatic NEW_COMPONENT = new SidebarViewEnum(\"newcomponent\");\r\n\tstatic SETTINGS = new SidebarViewEnum(\"settings\");\r\n\tstatic BOTH = new SidebarViewEnum(\"both\");\r\n}\r\n\r\nexport interface ISidebarView {\r\n\tview: SidebarViewEnum;\r\n\tisSidebarVisible: boolean;\r\n}\r\n","import { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport { IComponentScope } from \"./interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"./interface/ilayout-component\";\r\nimport { ISizeObject } from \"./ISizeObject\";\r\nimport { ISourceItem } from \"./model/component/hyperlink.model\";\r\n\r\nexport interface IComponent {\r\n\tcssClasses: string;\r\n\tisVisible: boolean;\r\n\tisReadonly: boolean;\r\n\telement: ng.IAugmentedJQuery;\r\n\tparent: ILayoutComponent;\r\n\tisGenerated: boolean;\r\n\t//copy-paste stuff\r\n\tcanCopy: boolean;\r\n\tcanCut: boolean;\r\n\tcanDelete(): boolean;\r\n\tgeneratedId: string;\r\n\terrorTooltip: string;\r\n\tdatasource: IDatasource;\r\n\t// \"is\" component methods/vars\r\n\tisLoading: boolean;\r\n\tisLayoutComponent(): boolean;\r\n\tisTranslatableComponent(): boolean;\r\n\t// Getters for databearer\r\n\tgetDatabearer(): IJsonComponent;\r\n\tgetDatasource(): IDatasource;\r\n\tgetDisplayName(): string;\r\n\tgetId(): string;\r\n\tgetTypedef(): string;\r\n\tis(classs: any): boolean;\r\n\t// Void methods\r\n\tcalcNewHeight(): void;\r\n\tcalcNewWidth(): void;\r\n\tcalcNewSizes(): void;\r\n\tforEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void;\r\n\tforEachBindable(fn: (field: IJsonBindableField, curr: IJsonValueSource) => void): void;\r\n\tforEachFieldSetting(fn: (field: IComponentFieldSetting) => void): void;\r\n\tforEachParent(fn: (parent: ILayoutComponent) => void): void;\r\n\tinitializeBindings(): void;\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]>;\r\n\tclear(): void;\r\n\tnewBoundaryEntered(boundaryId: string): void;\r\n\tupdateClasses(): void;\r\n\tupdateClassesAndStyle(): void;\r\n\tupdateShowError(): void;\r\n\tupdateVisibility(): void;\r\n\tresetLayout(): void;\r\n\tresetContext(): void;\r\n\t// Getters\r\n\tgetBindableValue(bindableReference: string): any;\r\n\tgetBoundarySetting<T>(settingId: string, boundaryId?: string, noTraverse?: boolean): T;\r\n\tgetContext(): IContext;\r\n\tgetGeneratingParent(): ILayoutComponent;\r\n\tgetPredictedSize(): ISizeObject;\r\n\tgetScope(): IComponentScope;\r\n\tgetSohoXiApi?(): any;\r\n\tgetValue(key: string): any;\r\n\t// Setters\r\n\tsetBindableValue(bindableReference: string, value: any): void;\r\n\tsetGenerated(id: string): void;\r\n\tsetErrorTooltip(errorMessage?: string): void;\r\n\t// on value updated\r\n\tonUpdateValue(): void;\r\n\t// build link\r\n\tbuildLink(link: string, sources: ISourceItem[]): string;\r\n}\r\n","/**\r\n * KEEP IN NOTE!\r\n * This helper class will eventually be replaced with the Component Service\r\n * found in the new App Launcher\r\n */\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { IComponent } from \"../common/IComponent\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\nimport { ApplicationParent } from \"./application-parent\";\r\nimport { Component } from \"./component\";\r\nimport { Defines, IStaticComponent } from \"./defines\";\r\nimport { FrameworkService } from \"./services/framework-service\";\r\n\r\nexport class ComponentsHelper {\r\n\r\n\tpublic static instantiateComponent<T extends IComponent>(\r\n\t\tobj: IJsonComponent,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparentInstance: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t): T {\r\n\t\tlet componentClass: IStaticComponent;\r\n\t\tlet instance: IComponent;\r\n\t\tif (obj) {\r\n\t\t\tif (Defines.allComponents[obj.typedef]) {\r\n\t\t\t\tcomponentClass = Defines.allComponents[obj.typedef].class;\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"Unknown class \" + obj.typedef);\r\n\t\t\t}\r\n\r\n\t\t\tinstance = new componentClass(obj, $element, parentInstance, frameworkService);\r\n\t\t}\r\n\t\treturn instance as T;\r\n\t}\r\n\r\n\t// public static getStaticClass(className: string): IStaticComponent {\r\n\t// \treturn Defines.allComponents[className].class;\r\n\t// }\r\n\r\n\t// public static getClassNameFromInstance(classInst: IComponent): string {\r\n\t// \tconst funcNameRegex = /function (.{1,}?)\\(/;\r\n\t// \tconst results = (funcNameRegex).exec(classInst.constructor.toString());\r\n\t// \treturn (results && results.length > 1) ? results[1] : \"\";\r\n\t// }\r\n\r\n\t// public static getClassNameFromClass(staticClass: IStaticComponent): string {\r\n\t// \tconst funcNameRegex = /function (.{1,}?)\\(/;\r\n\t// \tconst results = (funcNameRegex).exec(staticClass.toString());\r\n\t// \treturn (results && results.length > 1) ? results[1] : \"\";\r\n\t// }\r\n\r\n\tpublic static getComponentDisplayName(className: string): string {\r\n\t\tconst clazz = Defines.allComponents[className];\r\n\t\treturn (clazz.displayName ? clazz.displayName : className);\r\n\t}\r\n\r\n\t// public static isLayoutType(type: string): boolean {\r\n\t// \treturn Defines.allComponents[type].isLayoutComponent;\r\n\t// \t// return type === this.getClassNameFromClass(Flexbox)\r\n\t// \t// \t|| type === this.getClassNameFromClass(TabPanel)\r\n\t// \t// \t|| type === this.getClassNameFromClass(Tabs);\r\n\t// }\r\n\r\n\tpublic static isApplicationParent(component: IComponent | IJsonComponent): boolean {\r\n\t\tconst typedef = component instanceof Component ?\r\n\t\t\t(component as IComponent).getTypedef() :\r\n\t\t\t(component as IJsonComponent).typedef;\r\n\t\treturn typedef === ApplicationParent.name;\r\n\t}\r\n\r\n\t/**\r\n\t * Parse end of string in the list for last number and increase it by one\r\n\t *\r\n\t * @static\r\n\t * @param {string[]} names\r\n\t * @returns {number}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tpublic static nextNumber(names: string[]): number {\r\n\t\tlet highestNumber: number = 0;\r\n\r\n\t\tif (names && names.length) {\r\n\t\t\tnames.forEach((name: string) => {\r\n\t\t\t\t// Extract number at end of the string\r\n\t\t\t\tconst lastNumberMatch: RegExpMatchArray = name.match(/\\d+$/);\r\n\t\t\t\tif (lastNumberMatch) {\r\n\t\t\t\t\tconst suffixNumber: number = parseInt(lastNumberMatch[0]);\r\n\r\n\t\t\t\t\t// Remember highest number of the list\r\n\t\t\t\t\tif (suffixNumber > highestNumber) {\r\n\t\t\t\t\t\thighestNumber = suffixNumber;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\thighestNumber++; // Next number\r\n\t\t}\r\n\t\treturn highestNumber; // Keeping zero if no names given\r\n\t}\r\n\r\n\t/**\r\n\t * Sorts an array of {IComponent} in natural order\r\n\t *\r\n\t * @static\r\n\t * @param {IComponent[]} componentList\r\n\t * @returns {IComponent[]}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tpublic static sortComponentList(componentList: IComponent[]): IComponent[] {\r\n\t\treturn componentList.sort((a: IComponent, b: IComponent): number => {\r\n\t\t\treturn this.naturalCompare(a.getDisplayName(), b.getDisplayName());\r\n\t\t});\r\n\t}\r\n\r\n\t// Natural compare http://stackoverflow.com/a/15479354/445600\r\n\tprivate static naturalCompare(a: any, b: any): number {\r\n\t\tconst ax: any = [], bx: any = [];\r\n\t\ta.replace(/(\\d+)|(\\D+)/g, (_: any, $1: any, $2: any) => {\r\n\t\t\tax.push([$1 || Infinity, $2 || \"\"]);\r\n\t\t});\r\n\t\tb.replace(/(\\d+)|(\\D+)/g, (_: any, $1: any, $2: any) => {\r\n\t\t\tbx.push([$1 || Infinity, $2 || \"\"]);\r\n\t\t});\r\n\r\n\t\twhile (ax.length && bx.length) {\r\n\t\t\tconst an = ax.shift();\r\n\t\t\tconst bn = bx.shift();\r\n\t\t\tconst nn = (an[0] - bn[0]) || an[1].localeCompare(bn[1]);\r\n\t\t\tif (nn) {\r\n\t\t\t\treturn nn;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ax.length - bx.length;\r\n\t}\r\n\r\n\t/**\r\n\t * Verify if input is base64\r\n\t *\r\n\t * @static\r\n\t * @param {string} newValue\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tpublic static isBase64(newValue: string): boolean {\r\n\t\tlet base64Str = newValue;\r\n\t\tif (newValue.indexOf(\"data\") !== -1) {\r\n\t\t\tbase64Str = newValue.substr(newValue.indexOf(\",\") + 1, newValue.length);\r\n\t\t}\r\n\t\ttry {\r\n\t\t\twindow.atob(base64Str);\r\n\t\t\treturn true;\r\n\t\t} catch (e) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generates an ID unique among the occupiedStrings\r\n\t *\r\n\t * @param {string} prefix - The prefix of new ID\r\n\t * @param {string[]} occupiedStrings - The list of occupied IDs\r\n\t */\r\n\tpublic static generateId(prefix: string, occupiedStrings: string[], idCounter: number = 0): string {\r\n\t\tconst newId = prefix + idCounter;\r\n\t\tif (occupiedStrings.some((possibleConflict) => { return possibleConflict === newId; })) {\r\n\t\t\treturn this.generateId(prefix, occupiedStrings, idCounter + 1);\r\n\t\t} else {\r\n\t\t\treturn newId;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Will return the index by itemID, if itemID does not exists then return -1\r\n\t * If result is more than one return null to indicate that the choosen object id is not unique\r\n\t * @param listResults\r\n\t * @param itemId\r\n\t */\r\n\tpublic static findItemIndexById(listResults: IListDataItem[], itemId: string): number | null {\r\n\t\tlet index = null;\r\n\t\tif (itemId) {\r\n\t\t\tconst mylist = listResults.filter(item => item.id === itemId);\r\n\t\t\tif (mylist.length === 1) {\r\n\t\t\t\tindex = listResults.findIndex((item) => {\r\n\t\t\t\t\treturn item.id && item.id === itemId;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tindex = -1;\r\n\t\t}\r\n\t\treturn index;\r\n\t}\r\n\r\n\t/**\r\n\t * Add one to index if new item is added\r\n\t *\r\n\t * @param index\r\n\t * @param newItem\r\n\t * @param previousItem\r\n\t * @param outputParameters\r\n\t */\r\n\tpublic static incrementIndex(\r\n\t\tindex: number,\r\n\t\tcontext: IContext,\r\n\t\tpreviousItem: any,\r\n\t\tdatasource: IDatasource\r\n\t): number {\r\n\t\tconst newItem = context.ListResult[index];\r\n\t\tconst outputParameters = (datasource.getDatabearer() as IJsonGenericDatasource2).outputParameters;\r\n\r\n\t\tlet newIndex = index;\r\n\t\tif (newItem !== null) {\r\n\t\t\tconst itemAdded = outputParameters.some((params) => {\r\n\t\t\t\treturn previousItem[params.id] !== newItem[params.id];\r\n\t\t\t});\r\n\t\t\tif (itemAdded) {\r\n\t\t\t\tindex += 1;\r\n\t\t\t\tnewIndex = index;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newIndex;\r\n\t}\r\n\r\n\t/**\r\n\t * * Get default component setting value on ref for setting category with title\r\n\t * @param settingCategories\r\n\t * @param title\r\n\t * @param ref\r\n\t */\r\n\tpublic static getDefaultComponentSettingValue<T>(\r\n\t\tsettingCategories: IComponentSettingCategory[], ref: string, title: string\r\n\t): T {\r\n\t\tconst componentCategory =\r\n\t\t\tsettingCategories.find(category => category.title === title);\r\n\r\n\t\tlet componentFieldSetting: IComponentFieldSetting;\r\n\t\tif (componentCategory.settings.length > 0) {\r\n\t\t\tcomponentFieldSetting = componentCategory.settings.find(setting => setting.ref === ref);\r\n\t\t}\r\n\t\treturn componentFieldSetting.defaultValue;\r\n\t}\r\n\r\n\t/**\r\n\t *\tTruncate string and add ellipsis if necessary\r\n\t\t*\r\n\t\t* @param str\r\n\t\t* @param maxlength\r\n\t\t*/\r\n\tpublic static truncate(str: string, maxlength: number): string {\r\n\t\treturn (str.length > maxlength) ? str.substr(0, maxlength - 1) + \"...\" : str;\r\n\t}\r\n}\r\n","import isNil from \"lodash-es/isNil\";\r\n\r\nimport {\r\n\tConfig,\r\n\tDEFAULT_BOUNDARY,\r\n\tInjectNames,\r\n\tMGPlatform,\r\n\tSaveFlagsEnum,\r\n\tServerPaths,\r\n\tThemeEnum,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonMashup, IJsonRuntimeMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IEnvironmentSettings } from \"ng2/common/model/environment-settings.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IDesignerMashup } from \"ng2/common/model/project/mashup/designer-mashup.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport type { IAvailableSourceField } from \"common/defines\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { Mashup } from \"ng2/common/project/mashup\";\r\nimport type { IProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nimport { Helper, SmartBlob } from \"common/helper\";\r\n\r\nimport { HttpService } from \"common/services/http-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\nimport { ThemeService } from \"common/services/theme-service\";\r\nimport { DatasourceService } from \"components/services/datasource-service\";\r\n\r\nexport interface IRootScope extends ng.IRootScopeService {\r\n\tcurrentProject: IDesignerMashup;\r\n}\r\n\r\nexport class CommonService {\r\n\tprojectSettingsChangedEvent = new InstanceEvent<DesignerManifest>();\r\n\tcurrentBoundaryChangedEvent = new InstanceEvent<IBoundary>();\r\n\tcurrentCanvasThemeChangedEvent = new InstanceEvent<ThemeEnum>();\r\n\tonDuplicateProjectChangedEvent = new InstanceEvent<void>();\r\n\tprivate urlMetaData: IAvailableSourceField[] = [];\r\n\tprivate currentProject: Mashup;\r\n\tprivate currentRootComponentInstance: ILayoutComponent;\r\n\tprivate currentCanvasTheme: ThemeEnum;\r\n\tprivate currentBoundary: IBoundary = DEFAULT_BOUNDARY;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.DATASOURCE_SERVICE,\r\n\t\tInjectNames.THEME_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tpublic $timeout: ng.ITimeoutService,\r\n\t\tpublic httpService: HttpService,\r\n\t\tprivate datasourceService: DatasourceService,\r\n\t\tprivate themeService: ThemeService,\r\n\t\tprivate languageService: LanguageService\r\n\t) { }\r\n\r\n\tloadProjects(): ng.IPromise<IProjectInfo[]> {\r\n\t\treturn this.httpService.executeGet(`${ServerPaths.PROJECT}`);\r\n\t}\r\n\r\n\tloadActivatedApps(): ng.IPromise<IJsonRuntimeManifest[]> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.RUNTIME + \"active\");\r\n\t}\r\n\r\n\tloadProject(projectId: string, canvasWidth?: number): ng.IPromise<IJsonMashup> {\r\n\t\treturn this.httpService.executeGet<IJsonMashup>(ServerPaths.PROJECT + projectId);\r\n\t}\r\n\r\n\tloadPublishedProject(projectId: string, canvasWidth: number): ng.IPromise<IJsonRuntimeMashup> {\r\n\t\tconst lastLanguageCharIndex = 2;\r\n\t\tconst locale = this.languageService.getLanguage().substring(0, lastLanguageCharIndex);\r\n\t\treturn this.httpService.executeGet<IJsonRuntimeMashup>(\r\n\t\t\tServerPaths.RUNTIME + projectId,\r\n\t\t\t{\r\n\t\t\t\tlocale: locale\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tloadPublishedProjectNoConstraints(\r\n\t\tprojectId: string,\r\n\t\tcanvasWidth: number\r\n\t): ng.IPromise<IJsonRuntimeMashup> {\r\n\t\treturn this.httpService.executeGet<IJsonRuntimeMashup>(\r\n\t\t\tServerPaths.ADMINISTRATION + ServerPaths.PROJECT + projectId);\r\n\t}\r\n\r\n\tsetUrlMetaData(newUrlMetaData: IAvailableSourceField[]): void {\r\n\t\tthis.urlMetaData = newUrlMetaData;\r\n\t}\r\n\r\n\tgetUrlMetaData(): IAvailableSourceField[] {\r\n\t\treturn this.urlMetaData;\r\n\t}\r\n\r\n\tprivate cleanOldDataservices(project: Mashup): void {\r\n\t\tfor (const datasourceId in project.datasources) {\r\n\t\t\tconst datasourceInstance = this.datasourceService.parseDatasourceToTS(project.datasources[datasourceId]);\r\n\t\t\tif (!datasourceInstance) {\r\n\t\t\t\tproject.removeDatasource(datasourceId);\r\n\t\t\t\tconsole.info(\"Removed invalid data service from project\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tloadEnvironmentSettings(): ng.IPromise<IEnvironmentSettings> {\r\n\t\tconst path = DEV_SERVER ?\r\n\t\t\tServerPaths.SETTINGS + \"config/\" :\r\n\t\t\tServerPaths.SETTINGS;\r\n\r\n\t\treturn this.httpService.executeGet(path);\r\n\t}\r\n\r\n\tloadDBVersions(): ng.IPromise<string> {\r\n\t\treturn this.httpService.executeGet<string>(ServerPaths.SETTINGS + \"dbversions\");\r\n\t}\r\n\r\n\tloadLicensesHtml(): ng.IPromise<string> {\r\n\t\treturn this.httpService.executeGet<string>(ServerPaths.RUNTIME + \"about/licenses\");\r\n\t}\r\n\r\n\tloadApplicationVersion(): ng.IPromise<string> {\r\n\t\treturn this.httpService.executeGet<string>(ServerPaths.SETTINGS + \"version\");\r\n\t}\r\n\r\n\tunloadProject(): void {\r\n\t\tthis.currentProject = null;\r\n\t\tthis.currentRootComponentInstance = null;\r\n\t}\r\n\r\n\tgetCurrentProject(): Mashup {\r\n\t\treturn this.currentProject;\r\n\t}\r\n\r\n\tsetCurrentProject(newCurrentProject: Mashup, updateTheme: boolean = true): void {\r\n\t\tthis.currentProject = newCurrentProject;\r\n\t\tif (updateTheme) {\r\n\t\t\tconst defaultTheme = this.currentProject.manifest.defaultTheme;\r\n\t\t\tthis.setCanvasTheme(defaultTheme, this.isDesigner());\r\n\t\t}\r\n\t}\r\n\r\n\tbuildPrerequisites(mashup: Mashup, canvasWidth: number): ng.IPromise<Mashup> {\r\n\t\treturn this.generateUrlMetaData(mashup).then((mashup) => {\r\n\t\t\tthis.setCurrentProject(mashup);\r\n\t\t\tthis.updateCurrentBoundary(canvasWidth);\r\n\t\t\tthis.cleanOldDataservices(mashup);\r\n\t\t\treturn mashup;\r\n\t\t});\r\n\t}\r\n\r\n\tgenerateUrlMetaData(mashup: Mashup): ng.IPromise<Mashup> {\r\n\t\tconst deferred: ng.IDeferred<Mashup> = this.$q.defer();\r\n\t\tthis.urlMetaData = [];\r\n\t\tconst urlAlias = mashup.getUrlVariables();\r\n\t\tif (urlAlias && urlAlias.length > 0) {\r\n\t\t\turlAlias.forEach( (urlVar: IJsonUrlVariable) => {\r\n\t\t\t\tWSForm.getVarValue(urlVar.name, (value: string) => {\r\n\t\t\t\t\tconst sourceField: IAvailableSourceField = {\r\n\t\t\t\t\t\tvisibleName: urlVar.name,\r\n\t\t\t\t\t\tsourceKey: urlVar.name,\r\n\t\t\t\t\t\tsourceKeyShort: urlVar.name,\r\n\t\t\t\t\t\tcurrentValue: value,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.urlMetaData.push(sourceField);\r\n\r\n\t\t\t\t\tif (this.urlMetaData.length === urlAlias.length) {\r\n\t\t\t\t\t\tdeferred.resolve(mashup);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tdeferred.resolve(mashup);\r\n\t\t}\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tgetCurrentBoundary(): IBoundary {\r\n\t\treturn this.currentBoundary;\r\n\t}\r\n\r\n\tsetCurrentBoundary(boundary: IBoundary): void {\r\n\t\tthis.currentBoundary = boundary;\r\n\t\tthis.currentBoundaryChangedEvent.raise(boundary);\r\n\t}\r\n\r\n\tsetCurrentRootComponentInstance(componentInstance: ILayoutComponent): void {\r\n\t\tthis.currentRootComponentInstance = componentInstance;\r\n\t\tcomponentInstance.forEachChild((child) => {\r\n\t\t\tchild.initializeBindings();\r\n\t\t}, true);\r\n\t}\r\n\r\n\tgetCurrentRootComponentInstance(): ILayoutComponent {\r\n\t\treturn this.currentRootComponentInstance;\r\n\t}\r\n\r\n\tgetCurrentTheme(): ThemeEnum {\r\n\t\treturn this.currentCanvasTheme;\r\n\t}\r\n\r\n\tsetCanvasTheme(newTheme: ThemeEnum, isDesigner: boolean): void {\r\n\t\tif (this.currentCanvasTheme !== newTheme) {\r\n\t\t\tthis.currentCanvasTheme = newTheme;\r\n\t\t\tthis.themeService.changeThemeCss(newTheme, isDesigner).finally(() => {\r\n\t\t\t\tthis.currentCanvasThemeChangedEvent.raise(newTheme);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tupdateCurrentBoundary(canvasWidth: number): void {\r\n\t\tconst newBoundary: IBoundary = this.getBoundaryForWidth(canvasWidth);\r\n\t\tif (this.getCurrentBoundary() !== newBoundary) {\r\n\t\t\tthis.setCurrentBoundary(newBoundary);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getBoundaryForWidth(width: number): IBoundary {\r\n\t\tconst projectBoundaries = this.currentProject.manifest.mashupBoundaries;\r\n\r\n\t\tif (projectBoundaries && !isNil(width)) {\r\n\t\t\t// Sort the array, could be method?\r\n\t\t\tprojectBoundaries.sort((a, b) => {\r\n\t\t\t\tif (a.limitX < b.limitX) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else if (b.limitX < a.limitX) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn 0;\r\n\t\t\t});\r\n\r\n\t\t\tfor (const index in projectBoundaries) {\r\n\t\t\t\tconst boundary = projectBoundaries[index];\r\n\t\t\t\tif (boundary.limitX && width <= boundary.limitX) {\r\n\t\t\t\t\treturn boundary;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn DEFAULT_BOUNDARY;\r\n\t}\r\n\r\n\tisDesigner(): boolean {\r\n\t\treturn location.hash.indexOf(\"#!/editor\") === 0;\r\n\t\t//return window.location.pathname.indexOf(\"/appbuilder/editor\") === 0;\r\n\t}\r\n\r\n\texportProjectContent(\r\n\t\tcontentIds: string[],\r\n\t\tfilePath: string,\r\n\t\tsaveFlagEnum: SaveFlagsEnum,\r\n\t\tprojectId: string = undefined,\r\n\t): void {\r\n\t\tconst resourcePathForContentToSave =\r\n\t\t\tthis.getProjectContentResourcePath(projectId, saveFlagEnum);\r\n\r\n\t\tconst resourceName = resourcePathForContentToSave\r\n\t\t\t.concat(Helper.createQueryParameters(contentIds, \"id\"));\r\n\t\tthis.httpService\r\n\t\t\t.executeGet<IJsonGenericDatasource2[]>(resourceName, filePath)\r\n\t\t\t.then(response => {\r\n\t\t\t\tif (Config.MG_PLATFORM === MGPlatform.WEB) {\r\n\t\t\t\t\tconst rawJson = JSON.stringify(response);\r\n\t\t\t\t\tconst smartBlob = new SmartBlob(\r\n\t\t\t\t\t\t[rawJson], { type: \"application/json\" });\r\n\t\t\t\t\tsmartBlob.saveAs(filePath);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * convertImageUrlToBase64\r\n\t */\r\n\tconvertImageUrlToBase64(url: string): ng.IPromise<string> {\r\n\t\treturn this.httpService\r\n\t\t\t.executeGet<{base64: string, contentType: string}>(`${ServerPaths.DESIGNER}base64/?urlname=${url}`)\r\n\t\t\t.then(result => {\r\n\t\t\t\tconst filteredBase64 = result.base64.replace(/url\\(['\"]{0,}|['\"]{0,}\\)$/ig, \"\");\r\n\t\t\t\treturn `data:${result.contentType};base64,${filteredBase64}`;\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate getProjectContentResourcePath(\r\n\t\tprojectId: string,\r\n\t\tsaveFlagEnum: SaveFlagsEnum\r\n\t): string {\r\n\t\tswitch (saveFlagEnum) {\r\n\t\t\tcase SaveFlagsEnum.DATASOURCES:\r\n\t\t\t\treturn projectId ?\r\n\t\t\t\t\t`${ServerPaths.PROJECT}${projectId}/datasources/export/?` :\r\n\t\t\t\t\t`${ServerPaths.REPOSITORY}datasources/export/?`;\r\n\t\t\tcase SaveFlagsEnum.COMPOSITE_COMPONENTS:\r\n\t\t\t\treturn projectId ?\r\n\t\t\t\t\t`${ServerPaths.PROJECT}${projectId}/compositeComponents/export/?` :\r\n\t\t\t\t\t`${ServerPaths.REPOSITORY}compositeComponents/export/?`;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(`SaveFlagsEnum '${saveFlagEnum}' not handled`);\r\n\t\t}\r\n\t}\r\n\r\n\tgetLanguage(): string {\r\n\t\treturn this.languageService.getLanguage();\r\n\t}\r\n\r\n\topenHelp(): void {\r\n\t\twindow.open(`${Config.MG_HELP_BASE_URL}/default.html?helpcontent=mgabahug/cover.html#`, \"_blank\");\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.COMMON_SERVICE, CommonService);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport {\r\n\tIChanged,\r\n\tInjectNames,\r\n\tLanguageConsts,\r\n\tSettingKeys,\r\n\tComponentNames,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport {\r\n\tIJsonLanguageComponent, ILanguage, IMingleLanguage, IMongooseString\r\n} from \"ng2/common/model/language.model\";\r\nimport { IComponent } from \"common/IComponent\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\n\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonDatagrid } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport { IJsonRadioButtons } from \"common/model/component/radiobutton.model\";\r\nimport { IJsonTabs } from \"common/model/component/tabs.model\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport {\r\n\tDialogService, IDialogOptions, IDialogResult\r\n} from \"common/services/dialog-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\n\r\nimport { IAutoCompleteOptions } from \"common/model/sohoxi/sohoxi-autocomplete.model\";\r\nimport { ILookupOptions } from \"common/model/sohoxi/sohoxi-lookup.model\";\r\n\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IDataGridColumn } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport { IPageRequest } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\nimport { DatagridHelper } from \"common/sohoxi/datagrid-helper\";\r\nimport { Defines } from \"components/defines\";\r\n\r\nexport interface IComponentProperty {\r\n\tcomponent: IComponent;\r\n\tproperty: string;\r\n}\r\n\r\nexport class TranslationManagementService {\r\n\tprivate lookupOptions: ILookupOptions;\r\n\tpublic onTranslationsChangedEvent = new InstanceEvent<IMap<IJsonLanguageComponent[]>>();\r\n\tpublic static $inject = [\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tthis.initLookupOptions();\r\n\t}\r\n\r\n\t/**\r\n\t* Open the translation dialog with component as parameter\r\n\t* This returns a promise with a value that contain a status change and a new value if the\r\n\t* selected component was changed.\r\n\t*\r\n\t* @public\r\n\t* @param {EditorComponent} component\r\n\t* @returns {ng.IPromise<IDialogResult<IChanged>>}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic openTranslations(component?: IComponent, property?: string): ng.IPromise<IDialogResult<IChanged>> {\r\n\t\tconst dialogOptions: IDialogOptions<IComponentProperty> = {\r\n\t\t\ttemplate: require(\"../../designer/editor/component-settings/valuesource-settings/translation-dialog.html\"),\r\n\t\t\ttitle: \"Translations\",\r\n\t\t\tcssClass: \"language-dialog\",\r\n\t\t\tstyle: \"min-width: 1050px; max-width: 1050px;\",\r\n\t\t\tparameter: {\r\n\t\t\t\tcomponent: component,\r\n\t\t\t\tproperty: property\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn this.dialogService.show(dialogOptions);\r\n\t}\r\n\r\n\tpublic openNewStringDialog(value?: string): ng.IPromise<IDialogResult<IMongooseString>> {\r\n\t\tconst options: IDialogOptions<string> = {\r\n\t\t\ttitle: \"Add New String\",\r\n\t\t\ttemplate: require(\"../../common/dialogs/add-string/add-string.html\"),\r\n\t\t\tparameter: value\r\n\t\t};\r\n\t\treturn this.dialogService.show(options);\r\n\t}\r\n\r\n\tpublic addGlobalString(globalString: IMongooseString): ng.IPromise<void> {\r\n\t\treturn this.languageService.addGlobalString(globalString);\r\n\t}\r\n\r\n\tpublic getGlobalString(name: string): string {\r\n\t\treturn this.languageService.getGlobalString(name);\r\n\t}\r\n\r\n\tpublic fetchGlobalStrings(locale?: string): ng.IPromise<IMap<IMongooseString>> {\r\n\t\treturn this.languageService.fetchGlobalStrings(locale);\r\n\t}\r\n\r\n\tpublic getCurrentStringsList(): IMongooseString[] {\r\n\t\tconst currentStringList = [];\r\n\t\tconst currentStringDictionary = this.languageService.getCurrentStrings();\r\n\t\tfor (const key in currentStringDictionary) {\r\n\t\t\tif (currentStringDictionary.hasOwnProperty(key) && typeof currentStringDictionary[key] !== \"string\") {\r\n\t\t\t\tcurrentStringList.push(currentStringDictionary[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn currentStringList;\r\n\t}\r\n\r\n\tpublic saveGlobalTranslations(globalStrings: IMap<IMongooseString[]>): ng.IPromise<void> {\r\n\t\treturn this.languageService.saveGlobalStrings(globalStrings).then(() => {\r\n\t\t\tthis.languageService.loadGlobalStrings();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic deleteGlobalTranslations(globalStrings: IMap<IMongooseString[]>): ng.IPromise<void> {\r\n\t\treturn this.languageService.deleteGlobalStrings(globalStrings).then(() => {\r\n\t\t\tthis.languageService.loadGlobalStrings();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getSelectedLocale(): string {\r\n\t\tconst existNewDefault = this.getProjectLanguages().some((language) => {\r\n\t\t\treturn this.localeEquals(language.key, this.getCurrentLanguage());\r\n\t\t});\r\n\t\treturn existNewDefault ? this.getCurrentLanguage() : this.getDefaultLanguage();\r\n\t}\r\n\r\n\tpublic getCurrentLanguage(): string {\r\n\t\treturn this.languageService.getLanguage();\r\n\t}\r\n\r\n\t/**\r\n\t * Removes translation from current project\r\n\t * Either all translations for a component (to be used when removing a component)\r\n\t * Or remove a specific property's translations\r\n\t *\r\n\t * @public\r\n\t * @param {string} componentId\r\n\t * @param {string} propertyId\r\n\t *\r\n\t */\r\n\tpublic removeTranslation(\r\n\t\tcomponentId: string,\r\n\t\tpropertyId?: string,\r\n\t\ttriggerEvent: boolean = true,\r\n\t): void {\r\n\t\tconst currentProject = this.commonService.getCurrentProject();\r\n\t\tif (!propertyId) {\r\n\t\t\tcurrentProject.removeTranslation(componentId);\r\n\t\t} else {\r\n\t\t\tconst translations = currentProject.getTranslation(componentId);\r\n\t\t\tconst index = translations.findIndex((translation) => {\r\n\t\t\t\treturn translation.property === propertyId;\r\n\t\t\t});\r\n\t\t\ttranslations.splice(index, 1);\r\n\t\t}\r\n\r\n\t\tif (triggerEvent) {\r\n\t\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Get supported languages\r\n\t*\r\n\t* @public\r\n\t* @returns {IMingleLanguage[]}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getSupportedLanguages(): IMingleLanguage[] {\r\n\t\treturn this.languageService.getSupportedLanguages();\r\n\t}\r\n\r\n\t/**\r\n\t* Add new language to all languageComponents.\r\n\t* This method can also take a value as argument instead of the default value\r\n\t*\r\n\t* @public\r\n\t* @param {IMingleLanguage} newLanguage\r\n\t* @param {string} translatedValue\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic addLanguage(newLanguage: IMingleLanguage, translatedValue?: string): void {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\tconst newComponentLanguage = {\r\n\t\t\t\tlocale: newLanguage.key,\r\n\t\t\t\tvalue: translatedValue ? translatedValue : componentLanguage.translations[0].value\r\n\t\t\t};\r\n\t\t\tcomponentLanguage.translations.push(angular.copy(newComponentLanguage));\r\n\t\t});\r\n\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t}\r\n\r\n\t/**\r\n\t* Delete a language on all languageComponents\r\n\t*\r\n\t* @public\r\n\t* @param {IMingleLanguage} deletedlanguage\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic deleteLanguage(deletedlanguage: IMingleLanguage): void {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\tcomponentLanguage.translations.forEach((language, index) => {\r\n\t\t\t\tif (this.localeEquals(language.locale, deletedlanguage.key)) {\r\n\t\t\t\t\tcomponentLanguage.translations.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t}\r\n\r\n\t/**\r\n\t* Checks whether the locale keys is equal\r\n\t*\r\n\t* @public\r\n\t* @param {string} locale1\r\n\t* @param {string} locale2\r\n\t* @returns {boolean}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic localeEquals(locale1: string, locale2: string): boolean {\r\n\t\t// Some keys is only the two first characters\r\n\t\tconst stringLength = 3;\r\n\t\tif (locale1.length < stringLength || locale2.length < stringLength) {\r\n\t\t\tconst endIndex = 2;\r\n\t\t\treturn locale1.substring(0, endIndex) === locale2.substring(0, endIndex);\r\n\t\t} else {\r\n\t\t\treturn locale1 === locale2;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Checks whether the component has a corresponding languageComponent\r\n\t*\r\n\t* @public\r\n\t* @param {string} componentId\r\n\t* @returns {boolean}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic hasLanguageComponent(componentId: string, reference: string): boolean {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslations()[componentId];\r\n\t\tlet hasTranslations: boolean = false;\r\n\t\tif (currentTranslations && reference) {\r\n\t\t\thasTranslations = currentTranslations.some((translation) => {\r\n\t\t\t\treturn translation.property === reference;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn hasTranslations;\r\n\t}\r\n\r\n\t/**\r\n\t* Set a new value to the languageComponent with the right component & property\r\n\t*\r\n\t* @public\r\n\t* @param {string} componentId\r\n\t* @param {string} property\r\n\t* @param {ILanguage} updatedTranslation\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic setTranslatableStringByProperty(\r\n\t\tcomponentId: string,\r\n\t\tproperty: string,\r\n\t\tupdatedTranslation: ILanguage,\r\n\t\ttriggerEvent: boolean = true,\r\n\t): void {\r\n\t\tconst componentTranslations = this.commonService.getCurrentProject().getTranslations()[componentId];\r\n\t\tcomponentTranslations.forEach((componentLanguage) => {\r\n\t\t\tif (componentLanguage.property === property) {\r\n\t\t\t\tcomponentLanguage.translations.forEach((language) => {\r\n\t\t\t\t\tif (this.localeEquals(language.locale, updatedTranslation.locale)) {\r\n\t\t\t\t\t\tlanguage.value = updatedTranslation.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (triggerEvent) {\r\n\t\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setTranslatableStringByTranslationIndex(\r\n\t\tcomponentIndex: number,\r\n\t\ttranslationIndex: number,\r\n\t\tnewValue: string\r\n\t): void {\r\n\t\tconst projectLanguageComponents = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tconst oldValue =  projectLanguageComponents[componentIndex].translations[translationIndex].value;\r\n\t\tif (oldValue !== newValue) { //if not changed, do nothing.\r\n\t\t\tprojectLanguageComponents[componentIndex].translations[translationIndex].value = newValue;\r\n\t\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* returns the default language\r\n\t*\r\n\t* @public\r\n\t* @returns {string}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getDefaultLanguage(): string {\r\n\t\treturn this.languageService.getDefaultLanguage();\r\n\t}\r\n\r\n\t/**\r\n\t* returns the translated value from component & property.\r\n\t* The method can also take in a locale-argument if you want to prioritize on a specific language\r\n\t*\r\n\t* @public\r\n\t* @param {string} componentId\r\n\t* @param {string} property\r\n\t* @param {string} locale\r\n\t* @returns {string}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getTranslatableStringByProperty(componentId: string, property: string, locale?: string): string {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslation(componentId);\r\n\t\tlet currentLanguageKey = this.languageService.getLanguage();\r\n\t\tlet languageValue;\r\n\t\tif (!currentTranslations) {\r\n\t\t\treturn languageValue;\r\n\t\t}\r\n\t\t// first priority is the locale added\r\n\t\t// if not included check if current language is used.\r\n\t\tif (locale) {\r\n\t\t\tcurrentLanguageKey = locale;\r\n\t\t} else if (!this.projectHasLanguage(currentLanguageKey)) {\r\n\t\t\tcurrentLanguageKey = this.getDefaultLanguage();\r\n\t\t}\r\n\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\tif (componentLanguage.property === property) {\r\n\t\t\t\tlanguageValue = this.setTranslationFromComponentLanguage(\r\n\t\t\t\t\tcomponentLanguage.translations,\r\n\t\t\t\t\tcurrentLanguageKey,\r\n\t\t\t\t\tcomponentId,\r\n\t\t\t\t\tproperty\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn languageValue;\r\n\t}\r\n\r\n\t/**\r\n\t* returns the translated value on the header.\r\n\t* TODO: remove when header is a component\r\n\t* The method can also take in a locale-argument if you want to prioritize on a specific language\r\n\t*\r\n\t* @public\r\n\t* @param {string} locale\r\n\t* @returns {string}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getTranslatableHeaderString(locale?: string): string {\r\n\t\tconst project = this.commonService.getCurrentProject();\r\n\t\tlet languageValue;\r\n\t\tconst currentTranslations = project.getTranslations()[project.rootComponent.id];\r\n\t\tif (currentTranslations) {\r\n\t\t\tlet currentLanguageKey = this.languageService.getLanguage();\r\n\t\t\t// first priority is the locale added\r\n\t\t\t// if not included check if current language is used.\r\n\t\t\tif (locale) {\r\n\t\t\t\tcurrentLanguageKey = locale;\r\n\t\t\t} else if (!this.projectHasLanguage(currentLanguageKey)) {\r\n\t\t\t\tcurrentLanguageKey = this.getDefaultLanguage();\r\n\t\t\t}\r\n\t\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\t\tif (componentLanguage.property === SettingKeys.APPLICATION_HEADER) {\r\n\t\t\t\t\tfor (let i = 0; i < componentLanguage.translations.length; i++) {\r\n\t\t\t\t\t\tconst languageComponent = componentLanguage.translations[i];\r\n\t\t\t\t\t\tif (this.localeEquals(languageComponent.locale, currentLanguageKey)) {\r\n\t\t\t\t\t\t\tif (languageComponent.value === \"\" && languageComponent.locale !== LanguageConsts.DEFAULT.key) {\r\n\t\t\t\t\t\t\t\t//if value is empty and not default language, run this again with default language\r\n\t\t\t\t\t\t\t\tlanguageValue = this.getTranslatableHeaderString(LanguageConsts.DEFAULT.key);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tlanguageValue = languageComponent.value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn languageValue;\r\n\t}\r\n\r\n\t/**\r\n\t* set the translated value to the languageComponent by id\r\n\t*\r\n\t* @public\r\n\t* @param {string} Id\r\n\t* @param {ILanguage} updatedTranslation\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic setTranslatableStringById(id: string, updatedTranslation: ILanguage): void {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\tif (componentLanguage.id === id) {\r\n\t\t\t\tcomponentLanguage.translations.forEach((language) => {\r\n\t\t\t\t\tif (this.localeEquals(language.locale, updatedTranslation.locale)) {\r\n\t\t\t\t\t\tlanguage.value = updatedTranslation.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t}\r\n\r\n\t/**\r\n\t* checks whether the language is used or not\r\n\t*\r\n\t* @public\r\n\t* @param {string} locale\r\n\t* @returns {boolean}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic projectHasLanguage(locale: string): boolean {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tif (currentTranslations.length === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t// Need only to look at first\r\n\t\treturn currentTranslations[0].translations.some((translation) => {\r\n\t\t\treturn this.localeEquals(translation.locale, locale);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t* returns all the used languages\r\n\t*\r\n\t* @public\r\n\t* @returns {IMingleLanguage[]}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getProjectLanguages(): IMingleLanguage[] {\r\n\t\tconst projectLanguages: IMingleLanguage[] = [LanguageConsts.DEFAULT];\r\n\t\tconst firstTranslation: IJsonLanguageComponent = this.commonService.getCurrentProject().getTranslationsList()[0];\r\n\t\tif (firstTranslation) {\r\n\t\t\tfirstTranslation.translations.forEach((language) => {\r\n\t\t\t\tif (!this.localeEquals(language.locale, LanguageConsts.DEFAULT.key)) {\r\n\t\t\t\t\tprojectLanguages.push({\r\n\t\t\t\t\t\tkey: language.locale,\r\n\t\t\t\t\t\tvalue: this.getLocaleDisplayName(language.locale)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn projectLanguages;\r\n\t}\r\n\r\n\t/**\r\n\t* returns the corresponding displayname from locale if any\r\n\t* or else return default.\r\n\t*\r\n\t* @public\r\n\t* @param {string} locale\r\n\t* @returns {string}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getLocaleDisplayName(locale: string): string {\r\n\t\tconst localeDisplayName = this.getSupportedLanguages().find((language) => {\r\n\t\t\treturn this.localeEquals(language.key, locale);\r\n\t\t});\r\n\t\treturn localeDisplayName ? localeDisplayName.value : LanguageConsts.DEFAULT.value;\r\n\t}\r\n\r\n\tpublic createGeneralLanguageComponent(\r\n\t\tcomponentId: string,\r\n\t\treference: string,\r\n\t\tvalue: string,\r\n\t\ttriggerEvent: boolean = true,\r\n\t): void {\r\n\t\tconst newId = Helper.generateUniqueId();\r\n\t\tconst languageComponent: IJsonLanguageComponent = {\r\n\t\t\tid: newId,\r\n\t\t\tcomponentId: componentId,\r\n\t\t\tproperty: reference,\r\n\t\t\ttranslations: []\r\n\t\t};\r\n\t\tif (this.hasLanguageComponent(componentId, reference)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.getProjectLanguages().forEach((language) => {\r\n\t\t\tconst newComponentLanguage: ILanguage = {\r\n\t\t\t\tlocale: language.key,\r\n\t\t\t\tvalue: value\r\n\t\t\t};\r\n\t\t\tlanguageComponent.translations.push(newComponentLanguage);\r\n\t\t});\r\n\t\tthis.commonService.getCurrentProject().addTranslation(languageComponent);\r\n\r\n\t\tif (triggerEvent) {\r\n\t\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t\t}\r\n\t}\r\n\r\n\tpublic createDefaultLanguageComponents(component: IJsonComponent): void {\r\n\t\tthis.createLanguageComponentFromBindableField(component);\r\n\t\tswitch (component.typedef) {\r\n\t\t\tcase ComponentNames.Tabs:\r\n\t\t\t\t(component as IJsonTabs).componentTabs.forEach((tab) => {\r\n\t\t\t\t\tthis.createGeneralLanguageComponent(component.id, tab.id, tab.name);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase ComponentNames.RadioButton:\r\n\t\t\t\t(component as IJsonRadioButtons).componentRadioButtons.forEach((radioButton) => {\r\n\t\t\t\t\tthis.createGeneralLanguageComponent(component.id, radioButton.id, radioButton.name);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase ComponentNames.Lookup:\r\n\t\t\tcase ComponentNames.Datagrid:\r\n\t\t\t\t(component as IJsonDatagrid|IJsonLookup).columns.forEach((column) => {\r\n\t\t\t\t\tthis.createGeneralLanguageComponent(component.id, column.id, column.name);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t// Add new cases\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getLookupOptions(): ILookupOptions {\r\n\t\treturn this.lookupOptions;\r\n\t}\r\n\r\n\tpublic getAutoOptions(): IAutoCompleteOptions {\r\n\t\tconst autoOptions: IAutoCompleteOptions = {\r\n\t\t\tsource: (searchInput: string, done: Function) => {\r\n\t\t\t\tif (searchInput.charAt(0) === \"{\" && searchInput.length > 1) {\r\n\t\t\t\t\tconst autoCompleteGlobalStrings: string[] = [];\r\n\t\t\t\t\tconst maxItemsToShow = 11;\r\n\t\t\t\t\tconst trimmedInput = searchInput.replace(\"{\", \"\");\r\n\r\n\t\t\t\t\tconst filteredList = this.getCurrentStringsList().filter((item) => {\r\n\t\t\t\t\t\treturn item.Name.substring(0, trimmedInput.length) === trimmedInput;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tconst maxItems = filteredList.length < maxItemsToShow ? filteredList.length : maxItemsToShow;\r\n\t\t\t\t\tfor (let i = 0; i < maxItems; i++) {\r\n\t\t\t\t\t\tautoCompleteGlobalStrings.push(filteredList[i].Name);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdone(trimmedInput, autoCompleteGlobalStrings);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn autoOptions;\r\n\t}\r\n\r\n\tprivate initLookupOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Name\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"Name\",\r\n\t\t\twidth: 250,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Value\",\r\n\t\t\tname: \"Value\",\r\n\t\t\tfield: \"Value\",\r\n\t\t\twidth: 250,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\r\n\t\tthis.lookupOptions = {\r\n\t\t\ttitle: \"Select Item\",\r\n\t\t\tfield: (selectedRow: IMap<string>) => {\r\n\t\t\t\tconst propertyName = \"Name\";\r\n\t\t\t\treturn \"{\" + selectedRow[propertyName] + \"}\";\r\n\t\t\t},\r\n\t\t\tmatch: () => {\r\n\t\t\t\t// fake function to bypass an issue on soho-code.\r\n\t\t\t},\r\n\t\t\toptions: {\r\n\t\t\t\tpaging: true,\r\n\t\t\t\tpagesize: 10,\r\n\t\t\t\tcolumns: columns,\r\n\t\t\t\tdataset: [],\r\n\t\t\t\tsource: (request: IPageRequest, done: Function) => {\r\n\t\t\t\t\tconst stringList = this.getCurrentStringsList();\r\n\t\t\t\t\trequest.total = stringList.length;\r\n\t\t\t\t\tlet datasetCopy = angular.copy(stringList);\r\n\t\t\t\t\tif (request.filterExpr && request.filterExpr[0]) {\r\n\t\t\t\t\t\tdatasetCopy = DatagridHelper.getSearchResultOnPaths(datasetCopy, request.filterExpr[0], \"Name\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (request.sortId) {\r\n\t\t\t\t\t\tdatasetCopy = DatagridHelper.sortDatasetByField(datasetCopy, request.sortField, request.sortAsc);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst page = DatagridHelper.getPage(datasetCopy, request);\r\n\t\t\t\t\tdone(page, request);\r\n\t\t\t\t},\r\n\t\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\t\ttoolbar: {\r\n\t\t\t\t\tkeywordFilter: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tprivate setTranslationFromComponentLanguage(\r\n\t\ttranslations: ILanguage[],\r\n\t\tlocale: string,\r\n\t\tcomponentId: string,\r\n\t\treference: string\r\n\t): string {\r\n\t\tlet languageValue: string;\r\n\t\tfor (let i = 0; i < translations.length; i++) {\r\n\t\t\tconst languageComponent = translations[i];\r\n\t\t\tconst localeEquals = this.localeEquals(languageComponent.locale, locale);\r\n\t\t\tif (localeEquals) {\r\n\t\t\t\tconst localeNotDefault = languageComponent.locale !== LanguageConsts.DEFAULT.key;\r\n\t\t\t\tif (languageComponent.value === \"\" && localeNotDefault) {\r\n\t\t\t\t\t//if value is empty and not default language, run this again with default language\r\n\t\t\t\t\tlanguageValue = this.getTranslatableStringByProperty(componentId, reference, LanguageConsts.DEFAULT.key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlanguageValue = languageComponent.value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn languageValue;\r\n\t}\r\n\r\n\t/**\r\n\t* create a new language component either by existing values or default values.\r\n\t*\r\n\t* @public\r\n\t* @param {cp.IStaticComponent} componentClass\r\n\t* @param {IJsonComponent} component\r\n\t* @param {string[]} values\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tprivate createLanguageComponentFromBindableField(component: IJsonComponent): void {\r\n\t\tconst componentClass = Defines.allComponents[component.typedef].class;\r\n\t\tcomponentClass.BINDABLE_FIELDS_2.forEach((bindable, index) => {\r\n\t\t\tif (bindable.valueType === ValueTypeEnum.LOCALIZED_STRING) {\r\n\t\t\t\tconst value: string = ((component as any)[bindable.ref] as IJsonValueSource).value;\r\n\t\t\t\tthis.createGeneralLanguageComponent(\r\n\t\t\t\t\tcomponent.id,\r\n\t\t\t\t\tbindable.ref,\r\n\t\t\t\t\tvalue ? value : bindable.defaultValue.value\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.TRANSLATION_MANAGEMENT_SERVICE, TranslationManagementService);\r\n\t}\r\n}\r\n","// TODO: This will be replaced when enterprise-ng datagrid is finished\r\n\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IPagerApi, IPagerInfo, IPagerSource } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nexport interface IDataItem {\r\n\r\n\t/**\r\n\t * Soho private property\r\n\t */\r\n\tisFiltered?: boolean;\r\n\r\n\t/**\r\n\t * Soho private property\r\n\t */\r\n\t_isFilteredOut?: boolean;\r\n\r\n\t/**\r\n\t * Soho private property\r\n\t */\r\n\t_selected?: boolean;\r\n}\r\n\r\n/**\r\n * Interface for the Data Grid Directive\r\n */\r\nexport interface IDataGridOptions<DataItem> {\r\n\t/**\r\n\t * If actionableMode is \"true, tab and shift tab behave like left and right arrow key,\r\n\t*/\r\n\tactionableMode?: boolean;\r\n\t/**\r\n\t * If cellNavigation is \"false, will show border around whole row on focus\r\n\t */\r\n\tcellNavigation?: boolean;\r\n\t/**\r\n\t * If rowNavigation is \"false, will NOT show border around the row\r\n\t */\r\n\trowNavigation?: boolean;\r\n\t/**\r\n\t * Sets shading for readonly grids\r\n\t * Default value: false\r\n\t */\r\n\talternateRowShading?: boolean;\r\n\t/**\r\n\t * Column properties\r\n\t */\r\n\tcolumns?: IDataGridColumn[];\r\n\t/**\r\n\t * Data set to populate the grid\r\n\t */\r\n\tdataset: DataItem[];\r\n\t/**\r\n\t * Allow Column reorder\r\n\t */\r\n\tcolumnReorder?: boolean;\r\n\t/**\r\n\t * Save Column Reorder and resize\r\n\t */\r\n\tsaveColumns?: boolean;\r\n\t/**\r\n\t * Enable cell editing\r\n\t * Default value: false\r\n\t */\r\n\teditable?: boolean;\r\n\t/**\r\n\t * Make a readonly \"list\"\r\n\t * Default value: false\r\n\t */\r\n\tisList?: boolean;\r\n\t/**\r\n\t * Id to link a right click context menu element\r\n\t */\r\n\tmenuId?: string;\r\n\t/**\r\n\t * Unique ID to use as local storage reference and internal variable names\r\n\t */\r\n\tuniqueId?: string;\r\n\t/**\r\n\t * Row height, possbile values: \"short\", \"medium\" or \"tall\"\r\n\t * Default value: \"medium\"\r\n\t */\r\n\trowHeight?: string;\r\n\t/**\r\n\t * Selectable rows, possbile values: \"single\" or \"multiple\"\r\n\t * Default value: false\r\n\t */\r\n\tselectable?: SelectableEnum | boolean;\r\n\t/**\r\n\t * Controls fields to use for data grouping Use Data grouping fx.\r\n\t * {fields: ['incidentId'], supressRow: true, aggregator: 'list', aggregatorOptions: ['unitName1']}\r\n\t */\r\n\tgroupable?: Object;\r\n\t/**\r\n\t * Controls if using a selection mode if you can click the rows to select\r\n\t * Default value: true\r\n\t */\r\n\tclickToSelect?: boolean;\r\n\t/**\r\n\t * Show toolbar. False or toolbar object\r\n\t * Default value: false\r\n\t */\r\n\ttoolbar?: IDataGridToolbarOptions;\r\n\t/**\r\n\t * Set to false if you will initialize the toolbar yourself\r\n\t */\r\n\tinitializeToolbar?: boolean;\r\n\t/**\r\n\t * Enable paging mode\r\n\t * Default value: false\r\n\t */\r\n\tpaging?: boolean;\r\n\t/**\r\n\t * Number of rows per page\r\n\t * Default value: 25\r\n\t */\r\n\tpagesize?: number;\r\n\t/**\r\n\t * Array of page sizes to show in the page size dropdown.\r\n\t * Default value: [10, 25, 50, 75]\r\n\t */\r\n\tpagesizes?: number[];\r\n\t/**\r\n\t * Disable the ability to go to a specific page when paging.\r\n\t * Default value: false\r\n\t */\r\n\tindeterminate?: boolean;\r\n\t/**\r\n\t * Callback function for paging\r\n\t */\r\n\tsource?: IPagerSource;\r\n\t/**\r\n\t * If true, hides the pager if there's only one page worth of results.\r\n\t */\r\n\thidePagerOnOnePage?: boolean;\r\n\t/**\r\n\t * Enable Column Filtering, This will require column filterTypes as well.\r\n\t */\r\n\tfilterable?: boolean;\r\n\t/**\r\n\t * Disable Filter Logic client side and let your server do it\r\n\t */\r\n\tdisableClientFilter?: boolean;\r\n\t/**\r\n\t * Disable Sort Logic client side and let your server do it\r\n\t */\r\n\tdisableClientSort?: boolean;\r\n\t/**\r\n\t * Can provide a custom function to adjust results text on the toolbar\r\n\t */\r\n\tresultsText?: string;\r\n\t/**\r\n\t * If set you can reorder rows. Requires rowReorder formatter\r\n\t */\r\n\trowReorder?: boolean;\r\n\t/**\r\n\t * If true the dirty indicator will be shown on the rows\r\n\t */\r\n\tshowDirty?: boolean;\r\n\t/**\r\n\t * Controls if you cna expand more than one expandable row.\r\n\t */\r\n\tallowOneExpandedRow?: boolean;\r\n\t/**\r\n\t * Process tooltip logic at a cost of performance\r\n\t */\r\n\tenableTooltips?: boolean;\r\n\t/**\r\n\t * If a row is activated the user should not be able to deactivate it by clicking on the activated row\r\n\t */\r\n\tdisableRowDeactivation?: boolean;\r\n\t/**\r\n\t * If true make all the columns equal width\r\n\t */\r\n\tsizeColumnsEqually?: boolean;\r\n\t/**\r\n\t * If true we append an expandable row area without the rowTemplate feature being needed.\r\n\t */\r\n\texpandableRow?: boolean;\r\n\t/**\r\n\t * If set to false we skip redraw logic on the resize of the page.\r\n\t */\r\n\tredrawOnResize?: boolean;\r\n\t/**\r\n\t * If true a tree grid is expected so addition calculations will be used to calculate of the row children\r\n\t */\r\n\ttreeGrid?: any;\r\n\t/**\r\n\t * Allows you to provide a row template\r\n\t */\r\n\trowTemplate?: string;\r\n\t/**\r\n\t * When using set the column id for the columns you want to freeze. Id is required for this to work.\r\n\t */\r\n\tfrozenColumns?: any;\r\n\t/**\r\n\t * Enable or disable a summary row at the bottom of the data-grid.\r\n\t */\r\n\tsummaryRow?: boolean;\r\n\t/**\r\n\t * Allows you to provide a function so you can set some rows to disabled base on data or row index.\r\n\t */\r\n\tisRowDisabled?: (idx: number, item: any) => boolean;\r\n\r\n\t/**\r\n\t * A callback function that fires when expanding rows. To be used. when expandableRow is true.\r\n\t * The function gets eventData about the row and grid and a response function callback.\r\n\t * Call the response function with markup to append and delay opening the row.\r\n\t */\r\n\tonExpandRow?: (e: any, response: Function) => void;\r\n\r\n\t/***************************************\r\n\t * Custom property outside of IDS framework.\r\n\t ***************************************/\r\n\r\n\t/**\r\n\t * This property is used to trigger Datagrid.updated in our datagrid directive.\r\n\t * Set property to true to update datagrid\r\n\t */\r\n\tupdateDatagrid?: boolean;\r\n\r\n\t/**\r\n\t * Allow to hide the checkbox header (true to show, false to hide)\r\n\t */\r\n\tshowSelectAllCheckBox?: boolean;\r\n\r\n\t/**\r\n\t * Optional to give datagrid a unique id\r\n\t */\r\n\tid?: string;\r\n}\r\n\r\nexport interface IDataGridToolbarOptions {\r\n\ttitle?: string;\r\n\tresults?: boolean;\r\n\tdateFilter?: boolean;\r\n\tkeywordFilter?: boolean;\r\n\tadvancedFilter?: boolean;\r\n\tactions?: boolean;\r\n\tviews?: boolean;\r\n\trowHeight?: boolean;\r\n\tmaxVisibleButtons?: number;\r\n\tcollapsibleFilter?: boolean;\r\n\texportToExcel?: boolean;\r\n}\r\n\r\nexport interface IDataGridRow<T> {\r\n\tcell: number;\r\n\trow: number;\r\n\titem: T;\r\n\toriginalEvent: JQueryEventObject;\r\n}\r\n\r\nexport interface IDataGridColumn {\r\n\t/**\r\n\t * ID of column\r\n\t */\r\n\tid: string;\r\n\t/**\r\n\t * Name displayed in the column header\r\n\t */\r\n\tname?: string;\r\n\t/**\r\n\t * Property in dataset to show in the column field\r\n\t */\r\n\tfield?: string;\r\n\t/**\r\n\t * Show\\hide\r\n\t */\r\n\thidden?: boolean;\r\n\t/**\r\n\t * Alignment\r\n\t */\r\n\talign?: string;\r\n\t/**\r\n\t * Width of column\r\n\t */\r\n\twidth?: number|string;\r\n\t/**\r\n\t\t * Minimum width of the column\r\n\t\t */\r\n\tminWidth?: number;\r\n\t/**\r\n\t * Maximum width of the column\r\n\t */\r\n\tmaxWidth?: number;\r\n\t/**\r\n\t * Formatter\r\n\t */\r\n\tformatter?: IFormatterFunction;\r\n\t/**\r\n\t * Editor\r\n\t */\r\n\teditor?: IEditorFunction;\r\n\t/**\r\n\t * On click method (hyperlink)\r\n\t */\r\n\tclick?: (event: JQueryEventObject, rowsSelected: IDataGridRow<any>[]|IDataGridRow<any>) => void;\r\n\r\n\t/**\r\n\t * Used with Date formatters and editors.\r\n\t * You can use it to specify the display format for date values.\r\n\t * fx yyyy-MM-dd. See locale for date formatting patterns.\r\n\t */\r\n\tdateFormat?: string;\r\n\r\n\t/**\r\n\t *  Used with Time and 'Date' + Time formatters and editors.\r\n\t *  You can use it to specify the display format for date values.\r\n\t *  fx HH;mm See locale for time formatting patterns.\r\n\t */\r\n\ttimeFormat?: string;\r\n\r\n\t/**\r\n\t * Number format\r\n\t */\r\n\tnumberFormat?: string;\r\n\r\n\teditorOptions?: any;\r\n\t/**\r\n\t * Sortable\r\n\t */\r\n\tsortable?: boolean;\r\n\t/**\r\n\t * Resizeable\r\n\t */\r\n\tresizable?: boolean;\r\n\t/**\r\n\t * Text overflow\r\n\t * Can be set to 'ellipsis'.\r\n\t */\r\n\ttextOverflow?: string;\r\n\t/**\r\n\t* Tooltip\r\n\t* Set a manual tooltip.\r\n\t*/\r\n\ttooltip?: any;\r\n\trequired?: boolean;\r\n\tvalidate?: string;\r\n\tisEditable?: IIsEditableFunction;\r\n\treadonly?: boolean;\r\n\tsummaryRowFormatter?: IFormatterFunction;\r\n\taggregator?: string;\r\n\t/**\r\n\t * Setting text for buttons\r\n\t *\r\n\t */\r\n\ttext?: string;\r\n\thref?: any;\r\n\ttarget?: string;\r\n\toptions?: IColumnOptions[];\r\n\ticon?: string;\r\n\tcssClass?: string;\r\n\tisChecked?: (value: string | number) => boolean;\r\n}\r\n\r\nexport interface IColumnOptions {\r\n\tid: string;\r\n\tvalue: string;\r\n\tlabel: string;\r\n}\r\n\r\nexport interface IDatagridColumnArgs<T> {\r\n\t/**\r\n\t * The cell value.\r\n\t */\r\n\tvalue: string;\r\n\r\n\t/**\r\n\t * The previous cell value.\r\n\t */\r\n\toldValue: string;\r\n\r\n\t/**\r\n\t * An array of selected rows.\r\n\t */\r\n\trow: number;\r\n\r\n\t/**\r\n\t * An array of selected rows.\r\n\t */\r\n\tcell: number;\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\trowData: T;\r\n\r\n\t/**\r\n\t * The cell html element that was entered.\r\n\t */\r\n\ttarget: JQuery;\r\n\r\n\t/**\r\n\t * The column object\r\n\t */\r\n\tcolumn: IDataGridColumn;\r\n}\r\n\r\nexport interface IDatagridSettings {\r\n\tsortOrder: ISortOrderSetting;\r\n\tactivePage: number;\r\n}\r\n\r\nexport interface ISortOrderSetting {\r\n\tsortField: string;\r\n\tsortAsc: boolean;\r\n\tsortId: string;\r\n}\r\n\r\nexport interface IDatagridApi {\r\n\t/**\r\n\t * Private IDS method\r\n\t */\r\n\tafterPaging(pagingInfo: IPagerInfo): void;\r\n\r\n\t/**\r\n\t *  IDS Pager component API.\r\n\t */\r\n\tpagerAPI: IPagerApi;\r\n\r\n\telement: any;\r\n\r\n\temptyMessage: any;\r\n\r\n\t/**\r\n\t * Get the column index from the col's id\r\n\t * @param id\r\n\t * @returns The corresponding columns current position.\r\n\t */\r\n\tcolumnIdxById(id: number): IDatagridColumnArgs<any>;\r\n\r\n\t/**\r\n\t * Return all of the currently dirty rows by row index.\r\n\t * @returns array: An array of dirty rows.\r\n\t */\r\n\tdirtyRows(): any[];\r\n\r\n\t/**\r\n\t * Clear all dirty cells.\r\n\t */\r\n\tclearDirty(): void;\r\n\r\n\t/**\r\n\t * Toggle selection on a single row\r\n\t * @param idx\r\n\t * @param nosync\r\n\t * @param noTrigger\r\n\t */\r\n\tselectRow(idx: number, nosync?: boolean, noTrigger?: boolean): void;\r\n\r\n\t/**\r\n\t * Get the currently selected rows.\r\n\t * @returns array: An array containing the selected rows\r\n\t */\r\n\tselectedRows(): any[];\r\n\t/**\r\n\t * Set the selected rows by passing the row index or an array of row indexes.\r\n\t * @param idx\r\n\t * @param nosync\r\n\t * @param noTrigger\r\n\t * @param forceSelect\r\n\t */\r\n\tselectRows(idx: number | number[], nosync?: boolean, noTrigger?: boolean, forceSelect?: boolean): void;\r\n\r\n\t/**\r\n\t * Returns an array of row numbers for the rows containing the value for the specified field.\r\n\t * @param fieldName\r\n\t * @param value\r\n\t * @returns array: an array of row numbers.\r\n\t */\r\n\tfindRowsByValue(fieldName: string, value: any): number[];\r\n\r\n\t/**\r\n\t * Unwrap the grid back to a simple div, and destory all events and pointers.\r\n\t * @returns object: The plugin api for chaining.\r\n\t */\r\n\tdestroy(): object;\r\n\r\n\t/**\r\n\t * Deselect all rows that are currently selected.\r\n\t */\r\n\tunSelectAllRows(): void;\r\n\r\n\t/**\r\n\t * Select all rows. If serverside paging, this will be only the current page.\r\n\t * For client side paging, all rows across all pages are selected.\r\n\t */\r\n\tselectAllRows(): void;\r\n\r\n\t/**\r\n\t * Given a new column set update the rows and reload\r\n\t * @param columns\r\n\t * @param columnGroups\r\n\t */\r\n\tupdateColumns(columns: IDataGridColumn[], columnGroups?: any): void;\r\n\r\n\t/**\r\n\t * Update the datagrid and optionally apply new settings.\r\n\t * The datagrid api for chaining.\r\n\t * @param settings\r\n\t */\r\n\tupdated(settings?: IDataGridOptions<any>): IDatagridApi;\r\n\r\n\t/**\r\n\t * Send in a new data set to display in the datagrid in the lookup.\r\n\t * This will work whether or not the lookup is open or closed.\r\n\t * @param {object} dataset The array of data to show in the datagridgrid.\r\n\t * @param {object} pagerInfo The extra pager info object with information like activePage and pagesize.\r\n\t */\r\n\tupdateDataset(dataset: any[], pagerInfo: IPagerInfo): IDatagridApi;\r\n\r\n\t/**\r\n\t * Render or render both the header and row area.\r\n\t * @param isToggleFilter\r\n\t * @param pagerInfo\r\n\t */\r\n\trender(isToggleFilter: string, pagerInfo: IPagerInfo): void;\r\n\r\n\t/**\r\n\t * Remove all selected rows from the grid and dataset.\r\n\t */\r\n\tremoveSelected(): void;\r\n\r\n\t/**\r\n\t * Show the cell errors.\r\n\t * @param row\r\n\t * @param cell\r\n\t * @param message\r\n\t * @param type\r\n\t */\r\n\tshowCellError(row: number, cell: number, message: string, type: string): void;\r\n\r\n\t/**\r\n\t * Get or Set the row height.\r\n\t * @param height\r\n\t */\r\n\trowHeight(height: string): void;\r\n\r\n\t/**\r\n\t * Deselect all rows that are currently selected.\r\n\t */\r\n\tdeSelectAllRows(): void;\r\n\r\n\t/**\r\n\t* Run throught the array and remark the idx's after a row reorder.\r\n\t*/\r\n\tsyncSelectedRowsIdx(): void;\r\n\r\n\t/**\r\n\t * Set the current datagrid sort column\r\n\t * @param id\r\n\t * @param ascending\r\n\t */\r\n\tsetSortColumn(id: string, ascending: boolean): void;\r\n\r\n\t/**\r\n\t * Run validation for the column, for a particular cell.\r\n\t */\r\n\tvalidateCell?: (row: number, cell: number) => void;\r\n\r\n\t/**\r\n\t * Export datagrid to csv\r\n\t * @param name\r\n\t */\r\n\texportToCsv(name: string): void;\r\n\r\n\t/**\r\n\t * Export datagrid to excel\r\n\t * @param name\r\n\t */\r\n\texportToExcel(name: string): void;\r\n}\r\n\r\n/**\r\n * Data Grid Directive\r\n *\r\n * Example:\r\n *\r\n * scope[\"options\"] = {\r\n\t\tdataset: [\r\n\t\t\t{ name: \"Name #1\", age: 12, phone: \"12345\" },\r\n\t\t\t{ name: \"Name #2\", age: 22, phone: \"1234567\" },\r\n\t\t\t{ name: \"Name #3\", age: 32, phone: \"1234589\" }\r\n\t\t]\r\n\t}\r\n\t* <div xi-datagrid=\"ctrl.options\"></div>\r\n\t*/\r\n\r\nexport interface IFormatterFunction {\r\n\t(\r\n\t\trow: number,\r\n\t\tcell: number,\r\n\t\tvalue: string | number,\r\n\t\tcol: IDataGridColumn,\r\n\t\titem: any,\r\n\t\tdatagrid: IDatagridApi\r\n\t): string;\r\n}\r\n\r\nexport interface IEditorFunction {\r\n\t(\r\n\t\trow: number,\r\n\t\tcell: number,\r\n\t\tvalue: string,\r\n\t\tcontainer: any,\r\n\t\tcolumn: IDataGridColumn,\r\n\t\te: any,\r\n\t\tapi: any,\r\n\t\titem: any\r\n\t): string;\r\n}\r\n\r\nexport interface IIsEditableFunction {\r\n\t(\r\n\t\trow: number,\r\n\t\tcell: number,\r\n\t\tvalue: string,\r\n\t\tcol: IDataGridColumn,\r\n\t\titem: any\r\n\t): boolean;\r\n}\r\n","import { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonComponent, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IComponent } from \"common/IComponent\";\r\nimport { IComponentScope } from \"common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"common/interface/ilayout-component\";\r\n\r\nimport { ApplicationParent } from \"components/application-parent\";\r\nimport { Button } from \"components/button/button\";\r\nimport { Chart } from \"components/chart/chart\";\r\nimport { Checkbox } from \"components/checkbox/checkbox\";\r\nimport { Datagrid } from \"components/datagrid/datagrid\";\r\nimport { Datepicker } from \"components/datepicker/datepicker\";\r\nimport { Dropdown } from \"components/dropdown/dropdown\";\r\nimport { Flexbox } from \"components/flexbox/flexbox\";\r\nimport { Hyperlink } from \"components/hyperlink/hyperlink\";\r\nimport { Image } from \"components/image/image\";\r\nimport { Label } from \"components/label/label\";\r\nimport { LayoutComponent } from \"components/layout-component\";\r\nimport { List } from \"components/list/list\";\r\nimport { Lookup } from \"components/lookup/lookup\";\r\nimport { RadioButton } from \"components/radiobutton/radiobutton\";\r\nimport { TabPanel } from \"components/tabs/tab-panel\";\r\nimport { Tabs } from \"components/tabs/tabs\";\r\nimport { TextArea } from \"components/textarea/textarea\";\r\nimport { TextBox } from \"components/textbox/textbox\";\r\nimport { Timepicker } from \"components/timepicker/timepicker\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport interface IStaticComponent {\r\n\tnew(\r\n\t\tobj: IJsonComponent,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparentInstance: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t): IComponent;\r\n\tdirective: any[];\r\n\r\n\tBINDABLE_FIELDS_2: IJsonBindableField[];\r\n\tSETTING_FIELDS: IComponentSettingCategory[];\r\n\tDEFAULT_WIDTH: IJsonSize;\r\n\tDEFAULT_HEIGHT: IJsonSize;\r\n\r\n\tSOURCE_TRIGGERS?: IDataPair[];\r\n\tTARGET_ACTIONS?: IDataPair[];\r\n\r\n\tDEFAULT_TRIGGER?: IDataPair;\r\n\tDEFAULT_ACTION?: IDataPair;\r\n}\r\n\r\nexport interface IComponentListEntry {\r\n\tclass: IStaticComponent;\r\n\tdisplayName?: string;\r\n\tavailable: boolean;\r\n\tisLayoutComponent: boolean;\r\n}\r\n\r\nexport class Defines {\r\n\tstatic get allComponents(): IMap<IComponentListEntry> {\r\n\t\tconst componentList: IMap<IComponentListEntry> = {};\r\n\t\tcomponentList[ApplicationParent.name] = {\r\n\t\t\tclass: ApplicationParent,\r\n\t\t\tavailable: false,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Button.name] = {\r\n\t\t\tclass: Button,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Chart.name] = {\r\n\t\t\tclass: Chart,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Checkbox.name] = {\r\n\t\t\tclass: Checkbox,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Datagrid.name] = {\r\n\t\t\tclass: Datagrid,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Datepicker.name] = {\r\n\t\t\tclass: Datepicker,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Dropdown.name] = {\r\n\t\t\tclass: Dropdown,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Flexbox.name] = {\r\n\t\t\tclass: Flexbox,\r\n\t\t\tavailable: false,\r\n\t\t\tisLayoutComponent: true,\r\n\t\t};\r\n\t\tcomponentList[Hyperlink.name] = {\r\n\t\t\tclass: Hyperlink,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Image.name] = {\r\n\t\t\tclass: Image,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Label.name] = {\r\n\t\t\tclass: Label,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[List.name] = {\r\n\t\t\tclass: List,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Lookup.name] = {\r\n\t\t\tclass: Lookup,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[RadioButton.name] = {\r\n\t\t\tclass: RadioButton,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Tabs.name] = {\r\n\t\t\tclass: Tabs,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: true,\r\n\t\t};\r\n\t\tcomponentList[TabPanel.name] = {\r\n\t\t\tclass: TabPanel,\r\n\t\t\tavailable: false,\r\n\t\t\tisLayoutComponent: true,\r\n\t\t};\r\n\t\tcomponentList[TextBox.name] = {\r\n\t\t\tclass: TextBox,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[TextArea.name] = {\r\n\t\t\tclass: TextArea,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Timepicker.name] = {\r\n\t\t\tclass: Timepicker,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\treturn componentList;\r\n\t}\r\n\r\n\tstatic addComponents(m: ng.IModule): void {\r\n\t\tfor (const key in Defines.allComponents) {\r\n\t\t\tif (Defines.allComponents.hasOwnProperty(key)) {\r\n\t\t\t\tconst componentName = key.toLowerCase();\r\n\t\t\t\tconst componentClass: IStaticComponent = Defines.allComponents[key].class;\r\n\t\t\t\tconst method = componentClass.directive[0];\r\n\t\t\t\t// Fix for incorrect directive definition in chart.ts\r\n\t\t\t\tif (typeof method === \"function\") {\r\n\t\t\t\t\tconst directive = componentClass.directive[0]();\r\n\t\t\t\t\t// Only append link functions to real components\r\n\t\t\t\t\tif (directive && (directive.templateUrl || directive.template) && !directive.link) {\r\n\t\t\t\t\t\tthis.appendLinkFunction(directive);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tm.directive(\"d\" + componentName, [() => {\r\n\t\t\t\t\t\treturn directive;\r\n\t\t\t\t\t}]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Appends a link function to a component directive to get more accurate componentReady\r\n\tprivate static appendLinkFunction(directive: any): void {\r\n\t\tdirective.link = ($scope: IComponentScope) => {\r\n\t\t\tif (!($scope.componentInstance instanceof LayoutComponent)) {\r\n\t\t\t\t$scope.componentReady({ componentInstance: $scope.componentInstance });\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tstatic get CustomComponentType(): string { return \"CustomComponent\"; }\r\n}\r\n","import angular from \"angular\";\r\nimport isArray from \"lodash-es/isArray\";\r\n\r\nimport {\r\n\tABFormScriptMethod,\r\n\tConfig,\r\n\tInjectNames,\r\n\tSubcodes,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { Debugger } from \"common/debugger\";\r\nimport { ErrorResponse, IErrorResponse } from \"common/error-response\";\r\nimport { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nexport interface IMashupRestResponse<DataType> {\r\n\tdata?: DataType;\r\n\tsuccess: boolean;\r\n\terror?: IErrorResponse;\r\n}\r\n\r\nexport class HttpService {\r\n\tprivate overrideUrl: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.HTTP,\r\n\t\tAngularConstants.Q\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate http: ng.IHttpService,\r\n\t\tprivate q: ng.IQService\r\n\t) { }\r\n\r\n\tgetUrl(path?: string): string {\r\n\t\tif (path) {\r\n\t\t\treturn this.getBaseUrl() + Config.REST_ROOT + path;\r\n\t\t}\r\n\t\treturn this.getBaseUrl() + Config.REST_ROOT;\r\n\t}\r\n\r\n\tsetOverrideUrl(url: string): void {\r\n\t\tthis.overrideUrl = url;\r\n\t}\r\n\r\n\t/**\r\n\t * Execute a GET request\r\n\t * @param resource URL resource path\r\n\t * @param params optional parameters to be sent in the request\r\n\t * @param external pass true if GET request not goes to Mongoose internally\r\n\t */\r\n\texecuteGet<T>(resource: string, params?: any, external?: boolean): ng.IPromise<T> {\r\n\t\treturn this.execute<T>(resource, HttpVerbEnum.GET, null, params, external);\r\n\t}\r\n\r\n\texecutePost<T>(resource: string, data?: any, params?: any): ng.IPromise<T> {\r\n\t\treturn this.execute<T>(resource, HttpVerbEnum.POST, data, params);\r\n\t}\r\n\r\n\texecutePut<T>(resource: string, data: any, params?: any): ng.IPromise<T> {\r\n\t\treturn this.execute<T>(resource, HttpVerbEnum.PUT, data, params);\r\n\t}\r\n\r\n\texecuteDelete(resource: string, params?: any): ng.IPromise<void> {\r\n\t\treturn this.execute<void>(resource, HttpVerbEnum.DELETE, null, params);\r\n\t}\r\n\r\n\texecuteRequest<T>(requestConfig: ng.IRequestConfig): ng.IPromise<ng.IHttpPromiseCallbackArg<T>> {\r\n\t\tthis.debug(\"Executing \" + requestConfig.method + \" \" + requestConfig.url);\r\n\t\tconst deferred: ng.IDeferred<ng.IHttpPromiseCallbackArg<T>> = this.q.defer();\r\n\t\t// Special case for the ION API Token\r\n\t\tif (!DEV_SERVER &&\r\n\t\t\t(requestConfig.url.indexOf(Config.REST_ROOT + \"dev/token\") === 0 ||\r\n\t\t\t\trequestConfig.url.indexOf(\"/grid/rest/security/sessions/oauth\") === 0)) {\r\n\t\t\tWSForm.call({\r\n\t\t\t\tname: ABFormScriptMethod.TOKEN,\r\n\t\t\t\tparameters: [JSON.stringify(requestConfig)],\r\n\t\t\t\tonCompleted: (response) => {\r\n\t\t\t\t\t//const response: T = JSON.parse(responseJson);\r\n\t\t\t\t\t//deferred.resolve(response.data);\r\n\t\t\t\t\tconst httpResponse: ng.IHttpPromiseCallbackArg<T> = {\r\n\t\t\t\t\t\tdata: response\r\n\t\t\t\t\t} as any;\r\n\t\t\t\t\tif (!Helper.isUndefinedEmpty(response)) {\r\n\t\t\t\t\t\tdeferred.resolve(httpResponse);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst error = new ErrorResponse(\r\n\t\t\t\t\t\t\t`Could not retrieve ION token. ${Subcodes.CONTACT_SYSTEM_ADMIN}`,\r\n\t\t\t\t\t\t\tSubcodes.GENERIC_ERROR);\r\n\t\t\t\t\t\tdeferred.reject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn deferred.promise;\r\n\t\t}\r\n\r\n\t\treturn this.executeHttp<T>(requestConfig);\r\n\t}\r\n\r\n\tupload<T>(\r\n\t\tresource: string,\r\n\t\tfiles: File[],\r\n\t\tformFields?: IMap<string>): ng.IPromise<ng.IHttpPromiseCallbackArg<IMashupRestResponse<T>>> {\r\n\r\n\t\tconst deferred = this.q.defer<ng.IHttpPromiseCallbackArg<IMashupRestResponse<T>>>();\r\n\t\tconst url = this.getBaseUrl() + Config.REST_ROOT + resource;\r\n\t\tconst formData = new FormData();\r\n\r\n\t\tfor (let i = 0; i < files.length; i++) {\r\n\t\t\tformData.append(\"file\", files[i]);\r\n\t\t}\r\n\r\n\t\tif (formFields) {\r\n\t\t\tfor (const key in formFields) {\r\n\t\t\t\t// Dont send null since it will be interpreted as the string \"null\" by the server\r\n\t\t\t\tif (formFields[key] !== null) {\r\n\t\t\t\t\tformData.append(key, formFields[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst params = {\r\n\t\t\t// Let the browser decide Content-Type\r\n\t\t\theaders: ({ \"Content-Type\": undefined } as any),\r\n\t\t\ttransformRequest: angular.identity\r\n\t\t};\r\n\r\n\t\tthis.http.post<IMashupRestResponse<T>>(encodeURI(url), formData, params).then((httpResponse) => {\r\n\t\t\tthis.debug(\"[HttpService] Completed \", httpResponse);\r\n\t\t\tdeferred.resolve(httpResponse);\r\n\t\t}).catch((httpResponse: ng.IHttpPromiseCallbackArg<IMashupRestResponse<void> | any>) => {\r\n\t\t\tlet errorPayload: IMashupRestResponse<void> = httpResponse.data;\r\n\t\t\tif (!(errorPayload && errorPayload.error)) {\r\n\t\t\t\terrorPayload = {\r\n\t\t\t\t\tsuccess: false,\r\n\t\t\t\t\terror: {\r\n\t\t\t\t\t\tcode: httpResponse.status,\r\n\t\t\t\t\t\tmessage: httpResponse.statusText,\r\n\t\t\t\t\t\tdetail: httpResponse.statusText,\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tdeferred.reject(errorPayload.error);\r\n\t\t});\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\t/**\r\n\t * Sequentially resolves a list of promises.\r\n\t * @param promises\r\n\t */\r\n\treduce(promises: ng.IPromise<any>[]): ng.IPromise<any> {\r\n\t\treturn this.q.all(promises);\r\n\t}\r\n\r\n\tprivate execute<T>(\r\n\t\tresource: string, method: HttpVerbEnum, data?: any, params?: any, outside?: boolean\r\n\t): ng.IPromise<T> {\r\n\t\tconst deferred: ng.IDeferred<T> = this.q.defer();\r\n\t\tconst url = DEV_SERVER ?\r\n\t\t\t`${ Config.REST_ROOT }/${ resource }` :\r\n\t\t\t`${ Config.REST_ROOT }${ resource }`;\r\n\t\tthis.debug(\"Executing \" + method + \" \" + url);\r\n\r\n\t\tconst requestConfig: angular.IRequestConfig = {\r\n\t\t\tmethod,\r\n\t\t\turl,\r\n\t\t\tdata,\r\n\t\t\tparams,\r\n\t\t\tcache: false\r\n\t\t};\r\n\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tthis.executeHttp<T>(requestConfig).then((result) => {\r\n\t\t\t\tif (result.data && isArray(result.data)) {\r\n\t\t\t\t\tdeferred.resolve(result.data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst response = (result.data as any).data;\r\n\t\t\t\t\tdeferred.resolve(response);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (!outside) {\r\n\t\t\t\tWSForm.call({\r\n\t\t\t\t\tname: ABFormScriptMethod.APPBUILDER_REST,\r\n\t\t\t\t\tparameters: [JSON.stringify(requestConfig)],\r\n\t\t\t\t\tonCompleted: (rawJson) => {\r\n\t\t\t\t\t\tif (rawJson !== \"\") {\r\n\t\t\t\t\t\t\tconst response: IMashupRestResponse<T> = JSON.parse(rawJson);\r\n\t\t\t\t\t\t\tif (response.success) {\r\n\t\t\t\t\t\t\t\tdeferred.resolve(response.data);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdeferred.reject(response.error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdeferred.reject(`Response from '${requestConfig.url}', contains invalid JSON`);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (outside) {\r\n\t\t\t\tthis.executeHttp<T>(requestConfig).then((result) => {\r\n\t\t\t\t\tif (result.data) {\r\n\t\t\t\t\t\tdeferred.resolve(result.data);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tdeferred.reject(\"Failed due to: WSForm not available.\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate executeHttp<T>(requestConfig: ng.IRequestConfig): ng.IPromise<ng.IHttpPromiseCallbackArg<T>> {\r\n\t\tconst deferred: ng.IDeferred<ng.IHttpPromiseCallbackArg<T>> = this.q.defer();\r\n\t\tthis.http<T>(requestConfig).then((httpResponse: ng.IHttpPromiseCallbackArg<any>) => {\r\n\t\t\tdeferred.resolve(httpResponse);\r\n\t\t}).catch((httpResponse: ng.IHttpPromiseCallbackArg<any>) => {\r\n\t\t\tconst modifiedHttpResponse = {\r\n\t\t\t\t...httpResponse\r\n\t\t\t};\r\n\r\n\t\t\t//Sanitize error message for veracode scan\r\n\t\t\t//https://stackoverflow.com/questions/44949254/how-to-fix-veracode-cwe-117-improper-output-neutralization-for-logs\r\n\t\t\tconst logMessage = `\r\n\t\t\t\t[HttpService] Failed to ${requestConfig.method} ${requestConfig.url},\r\n\t\t\t\tResponse: ${angular.toJson(modifiedHttpResponse)}\r\n\t\t\t`;\r\n\t\t\tlogMessage.replace(\"\\n\", \"_\").replace(\"\\r\", \"_\");\r\n\t\t\tconsole.error(logMessage);\r\n\t\t\t/*\r\n\t\t\t* Check if the response status is -1. Found no documentation on this but through emperical research\r\n\t\t\t* we found that most of the times, the reason is:\r\n\t\t\t* - You're Offline\r\n\t\t\t* - The http request timed out\r\n\t\t\t* - CORS options http request failed for some reason\r\n\t\t\t*/\r\n\t\t\tif (modifiedHttpResponse.status === -1) {\r\n\t\t\t\tconst possibleReasons = [\r\n\t\t\t\t\t\"You're Offline\",\r\n\t\t\t\t\t\"The http request timed out\",\r\n\t\t\t\t\t\"CORS options http request failed for some reason\"\r\n\t\t\t\t];\r\n\t\t\t\tconsole.error(`Status -1 was returned from angular httpService, this could mean multiple things:\r\n\t\t\t\t\t${possibleReasons.map(reason => `\\n- ${reason}`).join()}\r\n\t\t\t\t`);\r\n\t\t\t\tconst newStatusText = `\r\n\t\t\t\t\tThis could mean multiple things:\r\n\t\t\t\t\t${possibleReasons.map(reason => `<br>- ${reason}`).join()}\r\n\t\t\t\t`;\r\n\t\t\t\tmodifiedHttpResponse.statusText = modifiedHttpResponse.statusText\r\n\t\t\t\t\t? modifiedHttpResponse.statusText\r\n\t\t\t\t\t: newStatusText;\r\n\t\t\t}\r\n\r\n\t\t\tdeferred.reject(modifiedHttpResponse);\r\n\t\t});\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate getBaseUrl(): string {\r\n\t\treturn (this.overrideUrl ? this.overrideUrl : \"\");\r\n\t}\r\n\r\n\tprivate debug(message: string, data?: any): void {\r\n\t\tif (Config.IS_DEV && Debugger.isEnabled()) {\r\n\t\t\tdata ? console.debug(\"[HttpService] \" + message, data) : console.debug(\"[HttpService] \" + message);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.HTTP_SERVICE, HttpService);\r\n\t}\r\n}\r\n","import { FeatureIdEnum, InjectNames, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { AngularConstants } from \"../angular-constants\";\r\nimport { HttpService } from \"./http-service\";\r\n\r\nexport interface IFeature {\r\n\treadonly id: FeatureIdEnum;\r\n\treadonly description: string;\r\n\treadonly defaultFromDate: number;\r\n\treadonly isInternal: boolean;\r\n\treadonly togglable: boolean;\r\n\treadonly status?: IFeatureStatus;\r\n}\r\n\r\nexport interface IFeatureStatus {\r\n\treadonly id: FeatureIdEnum;\r\n\treadonly enabled: boolean;\r\n\treadonly lastChangedBy: string;\r\n\treadonly lastChangedByDisplayName: string;\r\n\treadonly lastChangedDate: number;\r\n}\r\n\r\n/**\r\n * This service is used to read/update information about feature switches.\r\n * It will synchronize with the backend upon injection, and whenever something is expected\r\n * to change (e.g enabling/disabling a feature).\r\n *\r\n * Use this service to check whether a feature is enabled or not.\r\n *\r\n * Administrators can use it to enable/disable features.\r\n */\r\nexport class FeatureSwitchService {\r\n\tprivate readonly features: IFeature[] = [];\r\n\tstatic $inject = [\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tAngularConstants.Q\r\n\t];\r\n\r\n\tconstructor(private httpService: HttpService, private $q: ng.IQService) {\r\n\t\tthis.fetchFeatures()\r\n\t\t\t.catch(error => {\r\n\t\t\t\t// Could happen, but how should it be displayed?\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate fetchFeatures(): ng.IPromise<void> {\r\n\t\tconst path = ServerPaths.SETTINGS + ServerPaths.SWITCHABLE_FEATURES;\r\n\t\treturn this.httpService.executeGet<IFeature[]>(path)\r\n\t\t\t.then(fetchedFeatures => {\r\n\t\t\t\tthis.features.splice(0, this.features.length);\r\n\t\t\t\tfetchedFeatures.forEach(feature => {\r\n\t\t\t\t\tthis.features.push(feature);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic getFeatures(): IFeature[] {\r\n\t\treturn this.features;\r\n\t}\r\n\r\n\t/**\r\n\t * Get the feature with a given id.\r\n\t *\r\n\t * Returns undefined if feature does not exist, i.e it wasn't one of the features retrieved from the backend.\r\n\t */\r\n\tpublic getFeature(id: FeatureIdEnum): (IFeature | undefined) {\r\n\t\tconst feature = this.features.find(feature => feature.id === id);\r\n\t\treturn feature;\r\n\t}\r\n\r\n\tpublic isFeatureEnabled(id: FeatureIdEnum): boolean {\r\n\t\tconst feature = this.getFeature(id);\r\n\t\treturn feature && feature.status && feature.status.enabled;\r\n\t}\r\n\r\n\tpublic toggleFeatureStatus(id: FeatureIdEnum): ng.IPromise<void> {\r\n\t\tconst feature = this.getFeature(id);\r\n\t\tif (!feature) {\r\n\t\t\treturn this.$q.reject(`Feature with id '${id}' does not exist`);\r\n\t\t}\r\n\t\tconst enable = !this.isFeatureEnabled(id);\r\n\t\tconst path = ServerPaths.SETTINGS + ServerPaths.SWITCHABLE_FEATURES + id + \"/status\";\r\n\t\treturn this.httpService.executePost(path, undefined, { enable }).then(() => {\r\n\t\t\treturn this.fetchFeatures();\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.FEATURE_SWITCH_SERVICE, FeatureSwitchService);\r\n\t}\r\n}\r\n","/**\r\n* Defines an instance event.\r\n*\r\n* An instance event can be used for lightweight events when you can have\r\n* an object reference to the source of the event. In cases when you can't\r\n* use object references refer to IEvent and IEventService instead.\r\n*/\r\nexport interface IInstanceEvent<T> {\r\n\t/**\r\n\t* Registers an event handler function.\r\n\t* @param handler The event handler function to register.\r\n\t* @returns A function that can be used to unsubscribe to the event.\r\n\t* Calling this function will have the same effect as calling the off function.\r\n\t*/\r\n\ton(handler: { (data?: T): void }): Function;\r\n\r\n\t/**\r\n\t* Unregisters an existing event handler function.\r\n\t* @param handler The event handler function to unregister.\r\n\t*/\r\n\toff(handler: { (data?: T): void }): void;\r\n}\r\n\r\n/**\r\n* Instance event implementation.\r\n*\r\n* Use this class to defined your own instance event.\r\n* If you just want to consume instance events refer to IInstanceEvent.\r\n*/\r\nexport class InstanceEvent<T> implements IInstanceEvent<T> {\r\n\r\n\tprivate handlers: { (data?: T): void; }[] = [];\r\n\r\n\t/**\r\n\t* Registers an event handler function.\r\n\t* @param handler The event handler function to register.\r\n\t*/\r\n\tpublic on(handler: { (data?: T): void }): Function {\r\n\t\tthis.handlers.push(handler);\r\n\t\treturn () => {\r\n\t\t\tthis.off(handler);\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t* Unregisters an existing event handler function.\r\n\t* @param handler The event handler function to unregister.\r\n\t*/\r\n\tpublic off(handler: { (data?: T): void }): void {\r\n\t\tthis.handlers = this.handlers.filter(h => h !== handler);\r\n\t}\r\n\r\n\t/**\r\n\t* Raises an event.\r\n\t* @param data The event data.\r\n\t*/\r\n\tpublic raise(data?: T): void {\r\n\t\tif (this.handlers) {\r\n\t\t\ttry {\r\n\t\t\t\tthis.handlers.slice(0).forEach(h => h(data));\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"[InstanceEvent] Exception in raise\", e);\r\n\t\t\t\tthrow e;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Clears all event handlers for this event.\r\n\t*/\r\n\tpublic clear(): void {\r\n\t\tthis.handlers = [];\r\n\t}\r\n}\r\n","import { Helper } from \"../helper\";\r\n\r\nimport { CustomFormatters } from \"./custom-formatters\";\r\nimport { LocaleHelper } from \"./locale-helper\";\r\n\r\nimport { GridAggregators } from \"ng2/common/constants/common.constant\";\r\nimport { DateFormatEnum, FormatterEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type {\r\n\tIColumnOptions,\r\n\tIDataGridColumn,\r\n\tIDatagridColumnArgs,\r\n\tIDataItem,\r\n} from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport type { IFilterExpression, IPageRequest } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\n\r\nexport interface IExpandedRowItem<T> {\r\n\titem: T;\r\n}\r\nexport interface IRowItem<T> {\r\n\tdata: T;\r\n\telem: any; // JQuery Element\r\n\tidx: number;\r\n}\r\n\r\nexport class DatagridHelper {\r\n\tstatic getPage<T>(dataset: T[], pageRequest: IPageRequest): T[] {\r\n\t\tpageRequest.total = dataset.length;\r\n\t\tif (dataset.length > pageRequest.pagesize) {\r\n\t\t\treturn dataset.slice(\r\n\t\t\t\t(pageRequest.activePage - 1) * pageRequest.pagesize, pageRequest.activePage * pageRequest.pagesize);\r\n\t\t} else {\r\n\t\t\tpageRequest.total = dataset.length;\r\n\t\t\treturn dataset;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static normalizeValue(value: any): string {\r\n\t\tif (value) {\r\n\t\t\treturn value.toString().toLowerCase();\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tstatic sortDatasetByField<T>(dataset: T[], sortField: string, sortAsc: boolean): T[] {\r\n\t\tdataset = dataset.sort((itemA: T, itemB: T) => {\r\n\t\t\tconst a = this.normalizeValue(Helper.getDeepValue(itemA, sortField));\r\n\t\t\tconst b = this.normalizeValue(Helper.getDeepValue(itemB, sortField));\r\n\t\t\tif (a < b) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tif (a > b) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\treturn sortAsc ? dataset : dataset.reverse();\r\n\t}\r\n\r\n\t/**\r\n\t * Filters dataset on path\r\n\t * @param dataset\r\n\t * @param filterExpression\r\n\t * @param paths\r\n\t */\r\n\tstatic getSearchResultOnPaths<T>(\r\n\t\tdataset: T[],\r\n\t\tfilterExpression: IFilterExpression,\r\n\t\tpaths: string\r\n\t): T[] {\r\n\r\n\t\tdataset.forEach(DatagridHelper.clearSohoProperties);\r\n\r\n\t\treturn dataset.filter((item: T) => {\r\n\t\t\tconst deepValue = Helper.getDeepValue(item, paths);\r\n\t\t\tif (deepValue) {\r\n\t\t\t\treturn deepValue.toLowerCase().indexOf(filterExpression.value) !== -1;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Filters dataset on keyword\r\n\t * @param dataset\r\n\t * @param filterExpression\r\n\t */\r\n\tstatic getSearchResultOnKeyword<T>(\r\n\t\tdataset: T[],\r\n\t\tfilterExpression: IFilterExpression\r\n\t): T[] {\r\n\r\n\t\tconst result = dataset.filter((item: T) => {\r\n\t\t\tfor (const key in item) {\r\n\t\t\t\tconst value = item[key];\r\n\t\t\t\tif (typeof value === \"string\" &&\r\n\t\t\t\t\tvalue.toLowerCase().indexOf(filterExpression.value) !== -1\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Sometime Soho adds properties to row items which should not tag along.\r\n\t * This method will remove those properties.\r\n\t * @param item item\r\n\t */\r\n\tstatic clearSohoProperties(item: IDataItem): void {\r\n\t\tdelete item.isFiltered;\r\n\t\tdelete item._selected;\r\n\t\tdelete item._isFilteredOut;\r\n\t}\r\n\r\n\tstatic setEditableOnColumn(\r\n\t\tcolumn: IExtendedDataGridColumn,\r\n\t\tlocale?: string\r\n\t): void {\r\n\t\tif (column.editable) {\r\n\t\t\tdelete column.editorOptions;\r\n\r\n\t\t\tswitch (column.formatterName) {\r\n\t\t\t\tcase FormatterEnum.Checkbox:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Checkbox;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Date:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Date;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Time:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Time;\r\n\t\t\t\t\tcolumn.editorOptions = {\r\n\t\t\t\t\t\ttimeFormat: Soho.Locale.cultures[locale].calendars[0].dateFormat.timestamp,\r\n\t\t\t\t\t\tminuteInterval: 5,\r\n\t\t\t\t\t\tsecondInterval: 5,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Datetime:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Date;\r\n\t\t\t\t\tcolumn.editorOptions = {\r\n\t\t\t\t\t\ttimeFormat: column.timeFormat,\r\n\t\t\t\t\t\tdateFormat: column.dateFormat,\r\n\t\t\t\t\t\tshowTime: true,\r\n\t\t\t\t\t} as any;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Hyperlink:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Input;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Textarea:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Textarea;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Button:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Button;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Dropdown:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Dropdown;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Autocomplete:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Autocomplete;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Lookup:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Lookup;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Input;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcolumn.editor = null;\r\n\t\t}\r\n\t\tcolumn.isEditable = () => {\r\n\t\t\treturn column.editable;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic setColumnSettings(\r\n\t\tcolumn: IExtendedDataGridColumn,\r\n\t\tlocale: string,\r\n\t): void {\r\n\t\t// reset column\r\n\t\tdelete column.dateFormat;\r\n\t\tdelete column.href;\r\n\t\tdelete column.click;\r\n\t\tdelete column.editorOptions;\r\n\t\tdelete column.options;\r\n\t\tcolumn.textOverflow = FormatterEnum.Ellipsis;\r\n\r\n\t\tthis.setFormatterOnColumns(column, locale);\r\n\t\tthis.setEditableOnColumn(column, locale);\r\n\t}\r\n\r\n\tstatic setFormatterOnColumns(\r\n\t\tcolumn: IExtendedDataGridColumn,\r\n\t\tlocale: string): void {\r\n\t\tif (column.formatterName) {\r\n\t\t\tswitch (column.formatterName) {\r\n\t\t\t\tcase FormatterEnum.Checkbox:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Checkbox;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Checkbox;\r\n\t\t\t\t\tcolumn.isChecked = (value: string | number | boolean) => {\r\n\t\t\t\t\t\tif (jQuery.isNumeric(value) && typeof value === \"string\") {\r\n\t\t\t\t\t\t\treturn parseInt(value, 10) === 1;\r\n\t\t\t\t\t\t} else if (typeof value === \"boolean\") {\r\n\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t} else if (typeof value === \"string\") {\r\n\t\t\t\t\t\t\treturn value.toLowerCase() === \"true\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Date:\r\n\t\t\t\t\tcolumn.formatter = CustomFormatters.Date(locale);\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Date;\r\n\t\t\t\t\tcolumn.dateFormat = LocaleHelper.getDateFormat(DateFormatEnum.Short, locale);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Hyperlink:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Hyperlink;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Hyperlink;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Integer:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Integer;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Integer;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Decimal:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Decimal;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Decimal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Textarea:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Textarea;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Textarea;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Datetime:\r\n\t\t\t\t\tcolumn.formatter = CustomFormatters.Datetime(locale);\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Datetime;\r\n\r\n\t\t\t\t\tcolumn.dateFormat = LocaleHelper.getDateFormat(DateFormatEnum.Short, locale);\r\n\t\t\t\t\tcolumn.timeFormat = LocaleHelper.getDateFormat(DateFormatEnum.Timeformat, locale);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Time:\r\n\t\t\t\t\tcolumn.formatter = CustomFormatters.Time(locale);\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Time;\r\n\t\t\t\t\tcolumn.dateFormat = LocaleHelper.getDateFormat(DateFormatEnum.Timestamp, locale);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Button:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Button;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Button;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Dropdown:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Dropdown;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Dropdown;\r\n\t\t\t\t\tdelete column.textOverflow;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Autocomplete:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Autocomplete;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Autocomplete;\r\n\t\t\t\t\tdelete column.textOverflow;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Lookup:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Lookup;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Lookup;\r\n\t\t\t\t\tdelete column.textOverflow;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.SelectionCheckbox: //used for multi selection\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.SelectionCheckbox;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.AbsoluteValue:\r\n\t\t\t\t\tcolumn.formatter = CustomFormatters.AbsoluteValue();\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.AbsoluteValue;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error(\"Error: Formatter does not exist.\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic ToggleSummarizeOnColumn(column: IExtendedDataGridColumn): void {\r\n\t\tif (!column.summarize) {\r\n\t\t\tcolumn.summaryRowFormatter = Soho.Formatters.SummaryRow;\r\n\t\t\tcolumn.aggregator = GridAggregators.SUM;\r\n\t\t} else {\r\n\t\t\tcolumn.summaryRowFormatter = null;\r\n\t\t\tcolumn.aggregator = null;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic convertDatetimeToTicks(selectedRow: IDatagridColumnArgs<any>, locale: string): number {\r\n\t\tconst column = selectedRow.column as IExtendedDataGridColumn;\r\n\t\tconst calendar = Soho.Locale.cultures[locale].calendars[0];\r\n\t\tconst formatterName = column.formatterName;\r\n\r\n\t\tconst oldDate = DateHelper.parse(selectedRow.oldValue, formatterName, locale);\r\n\t\tconst parseOption: IFormateDateOptions = {};\r\n\t\tlet date: Date;\r\n\r\n\t\tswitch (formatterName) {\r\n\t\t\tcase FormatterEnum.Date: {\r\n\t\t\t\tconst short = \"short\";\r\n\t\t\t\tparseOption.pattern = calendar.dateFormat[short];\r\n\t\t\t\tdate = Soho.Locale.parseDate(selectedRow.value, parseOption);\r\n\t\t\t\tdate.setHours(oldDate.getHours());\r\n\t\t\t\tdate.setMinutes(oldDate.getMinutes());\r\n\t\t\t\tdate.setSeconds(oldDate.getSeconds());\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase FormatterEnum.Time: {\r\n\t\t\t\tconst timestamp = \"timestamp\";\r\n\t\t\t\tparseOption.pattern = calendar.dateFormat[timestamp];\r\n\t\t\t\tdate = Soho.Locale.parseDate(selectedRow.value, parseOption);\r\n\t\t\t\tdate.setFullYear(oldDate.getFullYear());\r\n\t\t\t\tdate.setMonth(oldDate.getMonth());\r\n\t\t\t\tdate.setDate(oldDate.getDate());\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase FormatterEnum.Datetime:\r\n\t\t\t\tparseOption.pattern = calendar.dateFormat[formatterName];\r\n\t\t\t\tdate = Soho.Locale\r\n\t\t\t\t\t.parseDate(selectedRow.value, parseOption);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t}\r\n\r\n\t\treturn date.getTime();\r\n\t}\r\n\r\n\tstatic addColumnData(column: IExtendedDataGridColumn, listResult: any[], dataservice: IDatasource): string[] {\r\n\t\tconst autocompleteSource: string[] = [];\r\n\t\tswitch (column.formatterName) {\r\n\t\t\tcase FormatterEnum.Dropdown: {\r\n\t\t\t\tconst dropdownOptions: IColumnOptions[] = [];\r\n\t\t\t\tlistResult.forEach((listItem, index) => {\r\n\t\t\t\t\tdropdownOptions.push({\r\n\t\t\t\t\t\tid: \"optionID\" + index,\r\n\t\t\t\t\t\tvalue: listItem[column.listOptions.parameterId],\r\n\t\t\t\t\t\tlabel: listItem[column.listOptions.parameterId]\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tcolumn.options = dropdownOptions;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tcase FormatterEnum.Autocomplete:\r\n\t\t\t\tlistResult.forEach((listItem) => {\r\n\t\t\t\t\tautocompleteSource.push(listItem[column.listOptions.parameterId]);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase FormatterEnum.Lookup: {\r\n\t\t\t\tconst lookupData = listResult;\r\n\t\t\t\tconst lookupColumns: IDataGridColumn[] = [];\r\n\r\n\t\t\t\tconst outputParams = (dataservice.getDatabearer() as IJsonGenericDatasource2).outputParameters;\r\n\t\t\t\toutputParams.forEach((outputParam) => {\r\n\t\t\t\t\tlookupColumns.push({\r\n\t\t\t\t\t\tid: outputParam.id,\r\n\t\t\t\t\t\tname: outputParam.key,\r\n\t\t\t\t\t\tfield: outputParam.id\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tconst lookupOptions = {\r\n\t\t\t\t\tfield: (row: IMap<string>) => {\r\n\t\t\t\t\t\tconst match = row[column.listOptions.parameterId];\r\n\t\t\t\t\t\tif (!match) {\r\n\t\t\t\t\t\t\tconsole.warn(\"Warning: No current match to dataset.\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn match;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmatch: () => {\r\n\t\t\t\t\t\t// fake method\r\n\t\t\t\t\t},\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\tcolumns: lookupColumns,\r\n\t\t\t\t\t\tdataset: lookupData,\r\n\t\t\t\t\t\tselectable: \"single\"\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tcolumn.editorOptions = lookupOptions;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tdefault:\r\n\t\t\t\t// formatter not exists, should not happen\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn autocompleteSource;\r\n\t}\r\n}\r\n","import { RegexStrings } from \"ng2/common/constants/common.constant\";\r\nimport { IParentAnnounce } from \"./notifiable-component\";\r\n\r\nimport { Helper } from \"../../helper\";\r\n\r\nexport interface IValidationResult {\r\n\tstatus: boolean;\r\n\terrorMessage?: string;\r\n}\r\n\r\nexport interface IFieldValidationResult {\r\n\tid?: string;\r\n\tstatus?: boolean;\r\n}\r\n\r\nexport interface IFieldValidationChangeObjects {\r\n\tvalidation?: angular.IChangesObject<IValidation>;\r\n\treadonly?: angular.IChangesObject<boolean>;\r\n\tid?: angular.IChangesObject<string>;\r\n\tparentAnnounce?: angular.IChangesObject<any>;\r\n\r\n}\r\nexport type ValidatorType\r\n\t= \"max-length\"\r\n\t| \"not-empty\"\r\n\t| \"min-length\"\r\n\t| \"numeric\"\r\n\t| \"numeric-no-negative\"\r\n\t| \"no-space\"\r\n\t| \"no-numeric\"\r\n\t| \"custom\";\r\n\r\nexport interface IValidator {\r\n\ttype: ValidatorType;\r\n\tvalue?: any;\r\n\tcustom?: {\r\n\t\tvalidator: Function;\r\n\t\terrorMessage: string;\r\n\t};\r\n}\r\n\r\nexport interface IValidatorError {\r\n\tid: string;\r\n\ttype: ValidatorType;\r\n\tmessage: string;\r\n\tfield: string;\r\n}\r\n\r\nexport interface IValidation {\r\n\tvalidators: IValidator[];\r\n\terrorList: IValidatorError[];\r\n}\r\n\r\nexport class FieldValidation implements ng.IController {\r\n\tpublic readonly DEFAULT_INPUT_FIELD_NAME: string = \"inputFieldName\";\r\n\r\n\t// NOTICE: Labelname should always be unique\r\n\t// bindings\r\n\tpublic id: string;\r\n\tpublic isRequired: boolean;\r\n\tpublic labelName: string;\r\n\tpublic fieldValue: string;\r\n\tpublic fieldName: string;\r\n\tpublic validation: IValidation;\r\n\r\n\tpublic parentAnnounce: IParentAnnounce[] = [];\r\n\r\n\tpublic isInvalid: boolean;\r\n\r\n\tpublic fieldSpecificErrors: IValidatorError[];\r\n\r\n\tpublic get displayStatus(): string {\r\n\t\treturn this.isInvalid ? \"block\" : \"none\";\r\n\t}\r\n\r\n\tpublic $onInit(): void {\r\n\t\t// Do something here with init\r\n\t\tif (Helper.isUndefinedEmpty(this.fieldName)) {\r\n\t\t\tthis.fieldName = this.DEFAULT_INPUT_FIELD_NAME;\r\n\t\t}\r\n\r\n\t\tif (this.validation) {\r\n\t\t\t// Set isRequired icon on label\r\n\t\t\tthis.isRequired = this.validation\r\n\t\t\t\t.validators\r\n\t\t\t\t.findIndex(item => item.type === \"not-empty\") !== -1;\r\n\r\n\t\t\tif (!Helper.isUndefinedEmpty(this.fieldValue)) {\r\n\t\t\t\tthis.validate();\r\n\t\t\t} else {\r\n\t\t\t\tthis.fieldValue = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic $onChanges(changeObjects: IFieldValidationChangeObjects): void {\r\n\t\tconst parentAnnounce = changeObjects.parentAnnounce;\r\n\t\tlet isCallback: boolean;\r\n\t\tif (\r\n\t\t\tparentAnnounce &&\r\n\t\t\t!parentAnnounce.isFirstChange() &&\r\n\t\t\tparentAnnounce.currentValue.id !== this.id // don't run it on self\r\n\t\t) {\r\n\t\t\tisCallback = true;\r\n\t\t} else if (\r\n\t\t\tparentAnnounce &&\r\n\t\t\t!parentAnnounce.isFirstChange() &&\r\n\t\t\tparentAnnounce.currentValue.id === this.id\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst currentComponentFieldError = this.fieldSpecificErrors;\r\n\t\tconst sharedError = this.validation?.errorList;\r\n\r\n\t\tif (!changeObjects.id?.isFirstChange() &&\r\n\t\t\tchangeObjects.id?.previousValue !== changeObjects.id?.currentValue) {\r\n\t\t\tthis.validate(isCallback);\r\n\t\t} else\r\n\t\t// if currentComponentFieldError is undefined it means it hasn't been validated yet\r\n\t\tif (changeObjects && changeObjects.validation && changeObjects.validation.isFirstChange() ||\r\n\t\t\t!currentComponentFieldError ||\r\n\t\t\t(currentComponentFieldError && currentComponentFieldError.length === 0)\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t// Uncomment to print debugging log\r\n\t\t// \t\t\t\tDebugger.log(this,\r\n\t\t// `$onChanges called on:\r\n\t\t// \tcurrentField=${this.fieldValue}, id=${this.id},\r\n\t\t// \tfieldError=${JSON.stringify(currentComponentFieldError)},\r\n\t\t// \tsharedError=${JSON.stringify(sharedError)}\r\n\t\t// \t\t\t\t`);\r\n\t\t\tconst customValidator = this.validation.validators\r\n\t\t\t\t.find(validator => validator.type === \"custom\");\r\n\r\n\t\t\t// if sharedList is empty means no error in any component\r\n\t\t\tif (sharedError && sharedError.length === 0) {\r\n\t\t\t\tcurrentComponentFieldError.length = 0;\r\n\t\t\t} else if (this.fieldValue !== \"\" && customValidator) {\r\n\t\t\t\t// only validate field if it's not empty and has custom validator\r\n\t\t\t\t// for now related field validation only for \"custom\" validators\r\n\t\t\t\tthis.validate(isCallback);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onComponentChange: Function;\r\n\r\n\t/**\r\n\t * Returns an error if the value cant go through the validators\r\n\t *\r\n\t * @private\r\n\t * @param {string} value\r\n\t * @param {IValidator} validator\r\n\t * @returns {(IValidatorError | undefined)}\r\n\t * @memberof FieldValidation\r\n\t */\r\n\tprivate getError(\r\n\t\tvalue: string,\r\n\t\tvalidator: IValidator,\r\n\t\tisCallback: boolean = false\r\n\t): IValidatorError | undefined {\r\n\t\tlet validatorError: IValidatorError;\r\n\t\tconst id = this.id;\r\n\r\n\t\tswitch (validator.type) {\r\n\t\t\tcase \"max-length\":\r\n\t\t\t\tif (value.length > validator.value) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Max length is \" + validator.value,\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"min-length\":\r\n\t\t\t\tif (value.length - 1 <= validator.value) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Min length is \" + validator.value,\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"not-empty\":\r\n\t\t\t\tif (value.length === 0) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Field cannot be empty\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"numeric\":\r\n\t\t\t\tif (!Helper.isUndefinedEmpty(value) &&\r\n\t\t\t\t\t!RegexStrings.NUMERIC.test(value)\r\n\t\t\t\t) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Field has to be a number\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"no-numeric\":\r\n\t\t\t\t// RegexStrings.NO_NUMERIC behaves weird here, therefore I add the regex directly\r\n\t\t\t\tif (!Helper.isUndefinedEmpty(value) && (/\\d+/g).test(value)) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Field cannot contain numbers\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"numeric-no-negative\":\r\n\t\t\t\tif (!Helper.isUndefinedEmpty(value) &&\r\n\t\t\t\t\t!RegexStrings.NUMERIC_NO_NEGATIVE.test(value)\r\n\t\t\t\t) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Field has to be a positive number\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"no-space\":\r\n\t\t\t\tif (value.indexOf(\" \") !== -1) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Name cannot contain spaces\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"custom\":\r\n\t\t\t\tlet result: boolean | IValidationResult;\r\n\t\t\t\tconst target = validator.custom.validator;\r\n\r\n\t\t\t\tif (typeof target === \"function\") {\r\n\t\t\t\t\tresult = target(value, this.id);\r\n\t\t\t\t} else if (typeof target === \"string\") {\r\n\t\t\t\t\tif (target === \"void\") {\r\n\t\t\t\t\t\tthis.onComponentChange({\r\n\t\t\t\t\t\t\t$data: {\r\n\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult = this.onComponentChange({\r\n\t\t\t\t\t\t\t$data: {\r\n\t\t\t\t\t\t\t\tvalidator: target,\r\n\t\t\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\tcallback: isCallback\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (typeof result === \"boolean\" && result === false) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName ? this.labelName : this.id,\r\n\t\t\t\t\t\tmessage: validator.custom.errorMessage,\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t} else if (this.isValidationResult(result) && result.status === false) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName ? this.labelName : this.id,\r\n\t\t\t\t\t\tmessage: result.errorMessage,\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn validatorError;\r\n\t}\r\n\r\n\t/**\r\n\t * Validate if object is IValdationResult\r\n\t * @param object\r\n\t */\r\n\tprivate isValidationResult(object: any): object is IValidationResult {\r\n\t\treturn typeof object === \"object\" &&\r\n\t\t\t\"status\" in object &&\r\n\t\t\t\"errorMessage\" in object;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove all the errors, in the shared errorlist, that are related to this component\r\n\t *\r\n\t * @private\r\n\t * @memberof FieldValidation\r\n\t */\r\n\tprivate removeFieldRelatedErrorsFromErrorList(): void {\r\n\t\tconst sharedErrors = this.validation.errorList;\r\n\t\tif (sharedErrors) {\r\n\t\t\tsharedErrors.forEach((error, index) => {\r\n\t\t\t\tif (error.id === this.id &&\r\n\t\t\t\t\t(error.field === this.labelName || error.field === this.id)\r\n\t\t\t\t) {\r\n\t\t\t\t\tsharedErrors.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Used to validate the field based on the validation object\r\n\t *\r\n\t * @memberof FieldValidation\r\n\t */\r\n\tpublic validate(isCallback: boolean = false): void {\r\n\t\t// Reset all the validator values\r\n\t\tthis.isInvalid = false;\r\n\t\tthis.fieldSpecificErrors = [];\r\n\t\tthis.removeFieldRelatedErrorsFromErrorList();\r\n\r\n\t\tconst sharedErrors = this.validation.errorList;\r\n\t\tconst hasFieldValue = !Helper.isUndefinedOrNull(this.fieldValue);\r\n\r\n\t\tif (hasFieldValue) {\r\n\t\t\tthis.validation.validators.forEach((validator: IValidator) => {\r\n\r\n\t\t\t\tconst validatorError =\r\n\t\t\t\t\tthis.getError(this.fieldValue, validator, isCallback);\r\n\t\t\t\tif (validatorError) {\r\n\t\t\t\t\tthis.fieldSpecificErrors.push(validatorError);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Do we have errors? Then this is invalid\r\n\t\tif (this.fieldSpecificErrors.length !== 0) {\r\n\t\t\tthis.isInvalid = true;\r\n\t\t}\r\n\r\n\t\t// Push all the new errors to the shared errorlist\r\n\t\tif (sharedErrors) {\r\n\t\t\tif (this.fieldSpecificErrors.length !== 0) {\r\n\t\t\t\tthis.fieldSpecificErrors.forEach((error) => {\r\n\t\t\t\t\tsharedErrors.push(error);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import { Injectable } from \"@angular/core\";\r\nimport isEmpty from \"lodash-es/isEmpty\";\r\nimport isNil from \"lodash-es/isNil\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\nimport orderBy from \"lodash-es/orderBy\";\r\nimport {\r\n\tforkJoin,\r\n\tObservable,\r\n\tthrowError\r\n} from \"rxjs\";\r\n\r\nimport { DEFAULT_BOUNDARY, InteractionTriggerEnum } from \"ng2/common/constants/common.constant\";\r\nimport { WIDGET_BOUNDARIES } from \"ng2/common/constants/standard-boundaries.constant\";\r\n\r\nimport type { IComponent } from \"ng2/common/model/components/base/component.model\";\r\nimport type { ILayoutComponent } from \"ng2/common/model/components/base/layout-component.model\";\r\nimport type { IJsonRuntimeMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IMashup } from \"ng2/common/model/project/mashup/mashup.model\";\r\n\r\nimport { RuntimeApp } from \"ng2/common/project/runtime-app\";\r\n\r\nimport { ComponentService } from \"ng2/components/services/component.service\";\r\nimport { DataServiceBuilder } from \"ng2/components/services/data-service.service\";\r\n\r\n@Injectable()\r\nexport class FrameworkService {\r\n\tconstructor(\r\n\t\tpublic componentService: ComponentService,\r\n\t\tpublic dataServiceBuilder: DataServiceBuilder,\r\n\t) {}\r\n\r\n\t//#region Boundary\r\n\tupdateCurrentBoundary(width: number): void {\r\n\r\n\t\tthis.currentBoundary = this.getBoundaryByWidth(width);\r\n\t\tthis.rootComponentInstance.onBoundaryChange(this.currentBoundary);\r\n\t}\r\n\r\n\tprivate _currentBoundary: IBoundary;\r\n\r\n\tget currentBoundary(): IBoundary {\r\n\t\treturn this._currentBoundary;\r\n\t}\r\n\r\n\tset currentBoundary(value: IBoundary) {\r\n\t\tthis._currentBoundary = value;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns boundary for widget size if exist otherwise returns DEFAULT_BOUNDARY\r\n\t *\r\n\t * @param {number} cols\r\n\t * @returns {IBoundary}\r\n\t * @memberof FrameworkService\r\n\t */\r\n\tgetBoundaryByWidgetSize(cols: number): IBoundary {\r\n\r\n\t\tconst boundaryId = WIDGET_BOUNDARIES[cols - 1].id;\r\n\t\tconst boundary = this.currentProject.manifest.mashupBoundaries\r\n\t\t\t.find(boundary => boundary.id === boundaryId);\r\n\r\n\t\treturn boundary ? boundary : DEFAULT_BOUNDARY;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns boundary for width if specified otherwise returns DEFAULT_BOUNDARY\r\n\t *\r\n\t * @returns {IBoundary}\r\n\t * @memberof FrameworkService\r\n\t */\r\n\tgetBoundaryByWidth(width?: number): IBoundary {\r\n\r\n\t\tif (isNil(width)) {\r\n\t\t\treturn DEFAULT_BOUNDARY;\r\n\t\t}\r\n\r\n\t\tconst boundaries = orderBy(\r\n\t\t\tthis.currentProject.manifest.mashupBoundaries,\r\n\t\t\t[\"limitX\"])\r\n\t\t\t.filter(boundary => !isNil(boundary.limitX));\r\n\r\n\t\tconst boundary = boundaries\r\n\t\t\t.find(boundary => width <= boundary.limitX);\r\n\r\n\t\treturn isNil(boundary) ?\r\n\t\t\tDEFAULT_BOUNDARY :\r\n\t\t\tboundary;\r\n\t}\r\n\r\n\tgetNextProjectBoundary(boundaryId: string): IBoundary {\r\n\t\tif (boundaryId === DEFAULT_BOUNDARY.id) {\r\n\t\t\treturn DEFAULT_BOUNDARY;\r\n\t\t}\r\n\t\tconst projectBoundaries = orderBy(\r\n\t\t\tthis.currentProject.manifest.mashupBoundaries,\r\n\t\t\t[\"limitX\"]\r\n\t\t);\r\n\r\n\t\tfor (let i = 0; i < projectBoundaries.length; i++) {\r\n\t\t\tif (projectBoundaries[i].id === boundaryId) {\r\n\t\t\t\treturn projectBoundaries[i + 1];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn DEFAULT_BOUNDARY;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\tprivate _currentProject: IMashup;\r\n\r\n\tget currentProject(): IMashup {\r\n\t\treturn this._currentProject;\r\n\t}\r\n\r\n\tset currentProject(value: IMashup) {\r\n\t\tthis._currentProject = value;\r\n\t}\r\n\r\n\tprivate _componentInstance: ILayoutComponent;\r\n\r\n\tget rootComponentInstance(): ILayoutComponent {\r\n\t\treturn this._componentInstance;\r\n\t}\r\n\r\n\tset rootComponentInstance(value: ILayoutComponent) {\r\n\t\tthis._componentInstance = value;\r\n\t}\r\n\r\n\trunStartupInteractions(): Observable<any> {\r\n\t\tconst startupInteraction =\r\n\t\t\tthis.getInteractionByTriggerName(InteractionTriggerEnum.STARTUP);\r\n\r\n\t\tconst observables: Observable<any>[] = [];\r\n\t\tstartupInteraction.forEach(interaction => {\r\n\t\t\tobservables.push(this.runInteraction(interaction));\r\n\t\t});\r\n\r\n\t\treturn forkJoin(observables);\r\n\t}\r\n\r\n\trunInteraction(interaction: IInteraction): Observable<any> {\r\n\t\tif (interaction.targetName && interaction.targetActionName) {\r\n\r\n\t\t\tconst observables: Observable<any>[] = [];\r\n\r\n\t\t\tthis.getComponentOnInteractionTargetName(interaction.targetName)\r\n\t\t\t\t.forEach(component =>\r\n\t\t\t\t\tobservables.push(\r\n\t\t\t\t\t\tcomponent.loadInteraction(interaction))\r\n\t\t\t\t);\r\n\r\n\t\t\treturn forkJoin(observables);\r\n\r\n\t\t} else {\r\n\t\t\treturn throwError(\r\n\t\t\t\t`[FrameworkService] Interaction: ${interaction.getId()} did not run, not all prerequisites were present`\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tgetInteractionByTriggerName(triggerName: InteractionTriggerEnum): IInteraction[] {\r\n\t\treturn this.currentProject\r\n\t\t\t.getInteractions()\r\n\t\t\t.filter(interaction => {\r\n\t\t\t\treturn interaction.sourceTriggerName === triggerName;\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate getComponentOnInteractionTargetName(targetName: string): IComponent[] {\r\n\t\tconst components: IComponent[] = [];\r\n\t\tconst attrName = \"databearer.id\";\r\n\t\tconst attrValue = \"\";\r\n\r\n\t\tthis.rootComponentInstance.forEachChild((child) => {\r\n\t\t\tif (targetName === child.id) {\r\n\t\t\t\tcomponents.push(child);\r\n\t\t\t}\r\n\t\t}, true);\r\n\r\n\t\treturn components;\r\n\t}\r\n\r\n\t/**\r\n\t * Mock stuff\r\n\t */\r\n\tloadProject(metadata?: string): RuntimeApp {\r\n\r\n\t\tlet runtimeApp;\r\n\t\tif (isUndefined(metadata) || isEmpty(metadata)) {\r\n\t\t\truntimeApp = RuntimeApp.fromObj(this.jsonRuntimeApp);\r\n\t\t} else {\r\n\t\t\truntimeApp = RuntimeApp.fromObj(JSON.parse(metadata));\r\n\t\t}\r\n\r\n\t\tthis.currentBoundary = DEFAULT_BOUNDARY;\r\n\t\t// this.currentBoundary = runtimeApp.manifest.mashupBoundaries[0];\r\n\r\n\t\tthis.currentProject = runtimeApp;\r\n\r\n\t\treturn runtimeApp;\r\n\t}\r\n\r\n\t//tslint:disable\r\n\tjsonRuntimeApp: IJsonRuntimeMashup = {\"rootComponent\":{\"children\":[],\"typedef\":\"Flexbox\",\"id\":\"AppPanel\",\"displayName\":\"AppPanel\",\"boundarySettings\":{\"Default\":{\"orientation\":2,\"size\":1,\"sizeType\":2,\"horizontalAlignment\":1,\"verticalAlignment\":1,\"overflow\":1,\"backgroundColor\":null,\"padding\":null,\"width\":{\"sizeType\":2,\"number\":0},\"height\":{\"sizeType\":3,\"number\":0},\"visibility\":true,\"margin\":{\"top\":0,\"right\":0,\"bottom\":0,\"left\":0},\"showError\":true}},\"TargetAction\":\"Get\"},\"datasources\":[],\"interactions\":[],\"translations\":[{\"id\":\"1595510938502760163\",\"componentId\":\"AppPanel\",\"property\":\"applicationHeader\",\"translations\":[{\"locale\":\"en-US\",\"value\":\"No Project Loaded\"}]}],\"compositeComponents\":[],\"expressions\":[],\"manifest\":{\"createdBy\":\"Leung\",\"createdTime\":1595510938607,\"description\":\"\",\"displayName\":\"No Project Loaded\",\"fileMetaData\":{},\"id\":\"85db9130-9510-4e40-9719-f9593cfd77f8\",\"lastChangedBy\":\"Leung\",\"lastChangedTime\":1595510938920,\"mashupBoundaries\":[{\"id\":\"Default\",\"displayName\":\"Default\"}],\"version\":\"1.0\",\"previewImg\":\"\",\"createdByDisplayName\":\"Leung Wong (site developer)\",\"lastChangedByDisplayName\":\"Leung Wong (site developer)\",\"title\":\"No Project Loaded\",\"showTitleBar\":true,\"themeSwitchEnabled\":false,\"defaultTheme\":1,\"urlVariables\":[]},\"tags\":[]} as any;\r\n\t//tslint:enable\r\n}\r\n","import {\r\n\tComponentFactoryResolver,\r\n\tComponentRef,\r\n\tInject,\r\n\tInjectable,\r\n\tViewContainerRef\r\n} from \"@angular/core\";\r\n\r\n@Injectable()\r\nexport class DynamicComponentService {\r\n\r\n\treadonly componentRefs: ComponentRef<any>[] = [];\r\n\r\n\tprivate viewContainerRef: ViewContainerRef;\r\n\r\n\tconstructor(\r\n\t\t@Inject(ComponentFactoryResolver)\r\n\t\tprivate componentFactoryResolver: ComponentFactoryResolver\r\n\t) { }\r\n\r\n\tsetRootViewContainerRef(viewContainerRef: ViewContainerRef): void {\r\n\r\n\t\tthis.viewContainerRef = viewContainerRef;\r\n\t}\r\n\r\n\taddComponent(component: any): ComponentRef<any> {\r\n\r\n\t\tconst componentFactory = this.componentFactoryResolver\r\n\t\t\t.resolveComponentFactory(component);\r\n\r\n\t\tconst newComponentRef = this.viewContainerRef.createComponent(componentFactory);\r\n\r\n\t\tthis.componentRefs.push(newComponentRef);\r\n\r\n\t\treturn newComponentRef;\r\n\t}\r\n\r\n\tdestroyComponent(): void {\r\n\r\n\t\tthis.componentRefs\r\n\t\t\t.forEach(componentRef => {\r\n\t\t\t\tcomponentRef.instance.ngOnDestroy();\r\n\t\t\t\tcomponentRef.destroy();\r\n\t\t\t});\r\n\t\tthis.componentRefs.length = 0;\r\n\t}\r\n}\r\n","import { IJsonBoundary } from \"ng2/common/model/databearer/json-boundary.model\";\r\nexport interface IBoundary extends IJsonBoundary {\r\n\tselected?: boolean; // TODO: Should not be saved to server\r\n}\r\n","import { Config, MGPlatform } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nenum DebugState {\r\n\tENABLED = \"1\",\r\n\tDISABLED = \"0\",\r\n}\r\n\r\nexport class Debugger {\r\n\tstatic readonly STORAGE_KEY = \"debug\";\r\n\r\n\tstatic $inject = [\r\n\t\t\"$routeParams\"\r\n\t]\r\n\tconstructor(\r\n\t\tprivate $routeParams: ng.route.IRouteParamsService\r\n\t) {\r\n\t\tconsole.info(\"Hello World\");\r\n\t}\r\n\r\n\tstatic isEnabled(): boolean {\r\n\t\treturn localStorage.getItem(Debugger.STORAGE_KEY) === DebugState.ENABLED;\r\n\t}\r\n\r\n\tstatic enable(): void {\r\n\t\tlocalStorage.setItem(Debugger.STORAGE_KEY, DebugState.ENABLED);\r\n\t}\r\n\r\n\tstatic disable(): void {\r\n\t\tlocalStorage.setItem(Debugger.STORAGE_KEY, DebugState.DISABLED);\r\n\t}\r\n\r\n\tstatic initialize(): void {\r\n\t\tconst url = Config.MG_PLATFORM === MGPlatform.WEB || DEV_SERVER ?\r\n\t\t\twindow.parent.location.search.substring(1) :\r\n\t\t\twindow.location.search.substring(1);\r\n\r\n\t\tconst query = Helper.parseQueryString(url);\r\n\t\tif (query.debug) {\r\n\t\t\tif (query.debug === \"true\") {\r\n\t\t\t\tDebugger.enable();\r\n\t\t\t} else {\r\n\t\t\t\tDebugger.disable();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tDebugger.disable();\r\n\t\t}\r\n\r\n\t\tif (Debugger.isEnabled()) {\r\n\t\t\tconsole.warn(\"AppBuilder is running in debug mode. This may impact performance.\");\r\n\t\t}\r\n\r\n\t\t(window as Window).Debugger = Debugger;\r\n\t}\r\n\r\n\tstatic log(classObject: any, message: any): void {\r\n\t\tconst originStyle = \"color: darkred; font-weight: bold;\";\r\n\t\tconst messageStyle = \"color: black; font-weight: bold;\";\r\n\r\n\t\tif (Debugger.isEnabled() && Config.IS_DEV) {\r\n\t\t\t/* tslint:disable:no-console */\r\n\t\t\tconsole.log(`%c[${classObject.constructor.name}] %c${message}`, originStyle, messageStyle);\r\n\t\t\t/* tslint:enable:no-console */\r\n\t\t}\r\n\t}\r\n}\r\n","export enum ParameterTypeEnum {\r\n\tPATH = 1,\r\n\tQUERY,\r\n\tBODY_PART,\r\n\tOUTPUT,\r\n\tMATRIX\r\n}\r\n","import { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport { IComponent } from \"../../IComponent\";\r\n\r\nexport interface IDatasource extends IJsonDatasource {\r\n\tusedBy: IComponent[];\r\n\tgetDatabearer(): IJsonDatasource;\r\n\tgetDetailData(params: IMap<any>): Promise<any>;\r\n\tgetListData(params: IMap<any>): Promise<any[]>;\r\n\tgetMetaData(): Promise<IMetaData>;\r\n\tgetNonParsedData(params: IMap<any>): Promise<any[]>;\r\n}\r\n","import { IFieldSettingButton } from \"ng2/common/model/components/settings/field-setting-button.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\n\r\nexport interface IComponentFieldSetting {\r\n\tref: string;\r\n\ttitle?: string;\r\n\t//subTitle?: string;\r\n\t//tab: string;\r\n\tinputType?: any;\r\n\t//url?: string;\r\n\tboundarySetting?: boolean;\r\n\tdataset?: IDataPair[];\r\n\tdefaultValue?: any;\r\n\t// Works only for textfield atm\r\n\tbutton?: IFieldSettingButton;\r\n\t// works only for checkbox atm\r\n\ttooltip?: string;\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { DEFAULT_BOUNDARY } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IJsonComponent, IJsonComponentSettings, TypeDef } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { Helper } from \"../../../common/helper\";\r\nimport { IStaticComponent } from \"../../../components/defines\";\r\n\r\nexport class ComponentSettingsCtrl {\r\n\tpublic static create<T extends IJsonComponent>(id: string, componentClass: IStaticComponent): T {\r\n\t\tconst boundarySettings: IMap<IJsonComponentSettings> = {};\r\n\t\tboundarySettings[DEFAULT_BOUNDARY.id] = {\r\n\t\t\twidth: componentClass.DEFAULT_WIDTH,\r\n\t\t\theight: componentClass.DEFAULT_HEIGHT\r\n\t\t};\r\n\t\tconst component: IJsonComponent = {\r\n\t\t\ttypedef: componentClass.name as TypeDef,\r\n\t\t\tid: id,\r\n\t\t\tdisplayName: id,\r\n\t\t\tisReadonly: false,\r\n\t\t\tboundarySettings: boundarySettings\r\n\t\t};\r\n\t\tcomponentClass.BINDABLE_FIELDS_2.forEach((field: IJsonBindableField) => {\r\n\t\t\t(component as any)[field.ref] = angular.copy(field.defaultValue);\r\n\t\t});\r\n\t\tthis.initiateDefaultValues(component, componentClass);\r\n\r\n\t\treturn component as T;\r\n\t}\r\n\r\n\tprivate static initiateDefaultValues(component: IJsonComponent, componentClass: IStaticComponent): void {\r\n\t\tcomponentClass.SETTING_FIELDS.forEach((settingCategory: IComponentSettingCategory) => {\r\n\t\t\tsettingCategory.settings.forEach((setting: IComponentFieldSetting) => {\r\n\t\t\t\tif (!Helper.isUndefinedOrNull(setting.defaultValue)) {\r\n\t\t\t\t\tif (setting.boundarySetting) {\r\n\t\t\t\t\t\t(component.boundarySettings[DEFAULT_BOUNDARY.id] as IMap<any>)[setting.ref]\r\n\t\t\t\t\t\t\t= angular.copy(setting.defaultValue);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t(component as IMap<any>)[setting.ref] = angular.copy(setting.defaultValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\t}\r\n}\r\n","import type { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport { InteractionParameter } from \"ng2/components/interaction/interaction-parameter\";\r\n\r\nexport class Interaction implements IInteraction {\r\n\tdisplayName: string; //not saved in databearer\r\n\ttriggerString: string; //not saved in databearer\r\n\ttargetString: string; //not saved in databearer\r\n\tprivate databearer: IJsonInteraction;\r\n\tprivate parameters: InteractionParameter[] = [];\r\n\r\n\tconstructor(obj: IJsonInteraction) {\r\n\t\tthis.databearer = obj;\r\n\t\tif (obj.parameters) {\r\n\t\t\tobj.parameters.forEach((parameter) => {\r\n\t\t\t\tthis.parameters.push(new InteractionParameter(parameter));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonInteraction {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tgetId(): string {\r\n\t\treturn this.databearer.id;\r\n\t}\r\n\r\n\tget sourceName(): string {\r\n\t\treturn this.databearer.sourceName;\r\n\t}\r\n\tset sourceName(sourceName: string) {\r\n\t\tthis.databearer.sourceName = sourceName;\r\n\t}\r\n\r\n\tget sourceTriggerName(): string {\r\n\t\treturn this.databearer.sourceTriggerName;\r\n\t}\r\n\tset sourceTriggerName(sourceTriggerName: string) {\r\n\t\tthis.databearer.sourceTriggerName = sourceTriggerName;\r\n\t}\r\n\r\n\tget targetName(): string {\r\n\t\treturn this.databearer.targetName;\r\n\t}\r\n\tset targetName(targetName: string) {\r\n\t\tthis.databearer.targetName = targetName;\r\n\t}\r\n\r\n\tget targetActionName(): string {\r\n\t\treturn this.databearer.targetActionName;\r\n\t}\r\n\tset targetActionName(targetActionName: string) {\r\n\t\tthis.databearer.targetActionName = targetActionName;\r\n\t}\r\n\r\n\tgetParameters(): InteractionParameter[] {\r\n\t\treturn this.parameters;\r\n\t}\r\n\r\n\tgetParameter(targetKey: string): InteractionParameter {\r\n\t\treturn this.parameters.filter((param) => {\r\n\t\t\treturn (param.targetKey === targetKey);\r\n\t\t}).pop();\r\n\t}\r\n\r\n\taddParameter(parameter: InteractionParameter): void {\r\n\t\tif (!this.databearer.parameters) {\r\n\t\t\tthis.databearer.parameters = [];\r\n\t\t}\r\n\t\tthis.databearer.parameters.push(parameter.getDatabearer());\r\n\t\tthis.parameters.push(parameter);\r\n\t}\r\n\r\n\tremoveParameter(index: number): void {\r\n\t\tthis.databearer.parameters.splice(index, 1);\r\n\t\tthis.parameters.splice(index, 1);\r\n\t}\r\n\r\n\tremoveAllParameters(): void {\r\n\t\tthis.databearer.parameters = null;\r\n\t\tthis.parameters.length = 0;\r\n\t}\r\n\r\n}\r\n","export enum HttpVerbEnum {\r\n\tGET = \"GET\",\r\n\tPOST = \"POST\",\r\n\tPUT = \"PUT\",\r\n\tDELETE = \"DELETE\",\r\n\tHEAD = \"HEAD\",\r\n\tPATCH = \"PATCH\"\r\n}\r\n","import { QuestionDefinitionsEnum } from \"../model/questions/questions.enum\";\r\nimport type { IJsonQuestion } from \"../model/questions/questions.model\";\r\n\r\nimport { MimeTypes, ProjectFileKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { ICustomComponentDefinition } from \"ng2/common/model/components/custom-component-definition.model\";\r\nimport type { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport type { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IJsonDesignerMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IDesignerMashup } from \"ng2/common/model/project/mashup/designer-mashup.model\";\r\n\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { Mashup } from \"ng2/common/project/mashup\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\nexport class DesignerMashup extends Mashup implements IDesignerMashup {\r\n\tmanifest: DesignerManifest;\r\n\tquestions?: IJsonQuestion[] = [];\r\n\r\n\tgetManifest(): DesignerManifest {\r\n\t\treturn this.manifest;\r\n\t}\r\n\r\n\t//#region /* Questions */\r\n\r\n\tdeleteQuestion(questionId: string, settingId: string): void {\r\n\t\tconst question = this.questions.find(question => question.id === questionId);\r\n\t\tif (settingId || question.settings?.length > 1) {\r\n\t\t\tquestion.settings = question.settings.filter((setting => setting.id !== settingId));\r\n\t\t} else {\r\n\t\t\tthis.questions = this.questions.filter((question => question.id !== questionId));\r\n\t\t}\r\n\t}\r\n\taddQuestion(newQuestion: IJsonQuestion): void {\r\n\t\tif (newQuestion.type === QuestionDefinitionsEnum.COMPONENT_SETTINGS) {\r\n\t\t\tconst sameQuestion = this.getQuestion(newQuestion, QuestionDefinitionsEnum.COMPONENT_SETTINGS);\r\n\t\t\tif (sameQuestion) {\r\n\t\t\t\tconst settingExist = sameQuestion.settings.some(setting => setting.key === newQuestion.settings[0].key);\r\n\t\t\t\tif (!settingExist) {\r\n\t\t\t\t\tsameQuestion.settings.push(newQuestion.settings[0]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.questions.push(newQuestion);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst foundSameQuestion = this.getQuestion(newQuestion, QuestionDefinitionsEnum.SEEKS_BINDING);\r\n\t\t\tif (!foundSameQuestion) {\r\n\t\t\t\tthis.questions.push(newQuestion);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getQuestion(newQuestion: IJsonQuestion, type: QuestionDefinitionsEnum): IJsonQuestion {\r\n\t\treturn this.questions.find((question) => {\r\n\t\t\treturn question.componentId === newQuestion.componentId && question.type === type;\r\n\t\t});\r\n\t}\r\n\tgetQuestions(): IJsonQuestion[] {\r\n\t\treturn this.questions;\r\n\t}\r\n\r\n\tsetQuestions(questions: IJsonQuestion[]): void {\r\n\t\tthis.questions = questions;\r\n\t}\r\n\r\n\tgetQuestionById(id: string): IJsonQuestion {\r\n\t\treturn this.questions.find(question => question.id === id);\r\n\t}\r\n\r\n\t////#endregion\r\n\r\n\tsetRoot(componentObject: IJsonLayoutComponent): void {\r\n\t\tsuper.setRoot(componentObject);\r\n\t\tthis.manifest.setHasFile(ProjectFileKeys.ROOT_COMPONENT, MimeTypes.COMPONENT, componentObject.id);\r\n\t}\r\n\r\n\t/* Datasources */\r\n\r\n\taddDatasource(datasource: IJsonDatasource): void {\r\n\t\tsuper.addDatasource(datasource);\r\n\t\tthis.manifest.setHasFile(ProjectFileKeys.DATASOURCE, MimeTypes.DATASOURCE, ProjectFileKeys.DATASOURCE);\r\n\t}\r\n\r\n\t/* Interactions */\r\n\r\n\taddInteraction(interaction: Interaction): void {\r\n\t\tsuper.addInteraction(interaction);\r\n\t\tthis.manifest.setHasFile(ProjectFileKeys.INTERACTION, MimeTypes.INTERACTION, ProjectFileKeys.INTERACTION);\r\n\t}\r\n\r\n\t/* Custom Components */\r\n\r\n\taddCustomComponentDefinition(customComponent: ICustomComponentDefinition): void {\r\n\t\tsuper.addCustomComponentDefinition(customComponent);\r\n\t\tthis.manifest.setHasFile(\r\n\t\t\tProjectFileKeys.CUSTOM_COMPONENT,\r\n\t\t\tMimeTypes.CUSTOM_COMPONENT,\r\n\t\t\tProjectFileKeys.CUSTOM_COMPONENT\r\n\t\t);\r\n\t}\r\n\r\n\t/* Composite Components */\r\n\r\n\taddCompositeComponent(compositeComponent: IJsonCompositeComponent): void {\r\n\t\tsuper.addCompositeComponent(compositeComponent);\r\n\t\tthis.manifest.setHasFile(\r\n\t\t\tProjectFileKeys.COMPOSITE_COMPONENTS,\r\n\t\t\tMimeTypes.COMPOSITE_COMPONENTS,\r\n\t\t\tProjectFileKeys.COMPOSITE_COMPONENTS\r\n\t\t);\r\n\t}\r\n\r\n\tstatic fromObj(obj: IJsonDesignerMashup): DesignerMashup {\r\n\t\tconst entry = Mashup.create(DesignerMashup, DesignerManifest, obj);\r\n\t\t// designer only\r\n\t\tif (obj.questions) {\r\n\t\t\tentry.questions = obj.questions;\r\n\t\t}\r\n\t\treturn entry;\r\n\t}\r\n}\r\n","import { DateFormatEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonDatasource, IJsonM3Datasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IDataGridColumn, IFormatterFunction } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\nimport { Helper } from \"../helper\";\r\n\r\nexport class CustomFormatters {\r\n\tstatic DataSourceDescription(): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: IJsonDatasource, datagrid: any) => {\r\n\t\t\tif (item.typedef === DatasourceTypeEnum.M3) {\r\n\t\t\t\tconst m3Datasource = item as IJsonM3Datasource;\r\n\t\t\t\tif (m3Datasource.operations[0]) {\r\n\t\t\t\t\tconst descriptionValue = m3Datasource.operations[0].dataParameters;\r\n\t\t\t\t\tvalue = (descriptionValue[\"MI.Program\"] + \".\" + descriptionValue[\"MI.Transaction\"]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic DataSourceParameterType(): IFormatterFunction {\r\n\t\treturn (\r\n\t\t\trow: number,\r\n\t\t\tcell: number,\r\n\t\t\tvalue: string,\r\n\t\t\tcol: IDataGridColumn,\r\n\t\t\titem: IParameterObject,\r\n\t\t\tdatagrid: any\r\n\t\t): string => {\r\n\t\t\tswitch (item.parameterType) {\r\n\t\t\t\tcase ParameterTypeEnum.BODY_PART:\r\n\t\t\t\t\treturn \"Body(jsonpath)\";\r\n\t\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\t\t\treturn \"Matrix\";\r\n\t\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\t\treturn \"Path\";\r\n\t\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\t\treturn \"Query\";\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn \"Output\";\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tstatic Multi(...formatters: IFormatterFunction[]): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any) => {\r\n\t\t\tconst result = formatters.reduce((value, formatter) => {\r\n\t\t\t\treturn formatter(row, cell, value, col, item, datagrid);\r\n\t\t\t}, value);\r\n\t\t\treturn result;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic DataPairPresenter(dataPairList: IDataPair[]): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any) => {\r\n\t\t\tconst foundItem = dataPairList.find((datapair: IDataPair) => {\r\n\t\t\t\treturn value === datapair.value;\r\n\t\t\t});\r\n\t\t\treturn foundItem ? foundItem.name : \"\";\r\n\t\t};\r\n\t}\r\n\r\n\tstatic DatasourceSuiteFormatter(): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: IJsonDatasource, datagrid: any) => {\r\n\t\t\treturn value.replace(\"/\", \"\");\r\n\t\t};\r\n\t}\r\n\r\n\tstatic RequiredFormatter(propertyName: string, checkValue: boolean = false): IFormatterFunction {\r\n\t\treturn (row, cell, value, col, item) => {\r\n\t\t\tconst empty = \"\";\r\n\t\t\tconst checked = `\r\n\t\t\t\t<svg class=\"icon\">\r\n\t\t\t\t\t<use xlink:href=\"#icon-check\"></use>\r\n\t\t\t\t</svg>\r\n\t\t\t`;\r\n\t\t\tif ((checkValue && value >= 1) || !checkValue) {\r\n\t\t\t\treturn item.hasOwnProperty(propertyName) && item[propertyName] ? checked : empty;\r\n\t\t\t}\r\n\t\t\treturn empty;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic Date(locale: string): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any): string => {\r\n\t\t\treturn CustomFormatters.Datetime(locale, DateFormatEnum.Short)(row, cell, value, col, item, datagrid);\r\n\t\t};\r\n\t}\r\n\r\n\tstatic Time(locale: string): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any): string => {\r\n\t\t\treturn CustomFormatters.Datetime(locale, DateFormatEnum.Timestamp)(row, cell, value, col, item, datagrid);\r\n\t\t};\r\n\t}\r\n\r\n\tstatic Datetime(locale: string, date: string = DateFormatEnum.Datetime): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any): string => {\r\n\t\t\tif (Helper.isUndefinedEmpty(value)) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t\tconst options: IFormateDateOptions = {\r\n\t\t\t\tdate,\r\n\t\t\t\tlocale\r\n\t\t\t};\r\n\t\t\tconst trimedValue = value.trim();\r\n\t\t\tconst datetime = DateHelper.parse(trimedValue, date, locale);\r\n\t\t\tconst result = Soho.Locale.formatDate(\r\n\t\t\t\tdatetime.toString() !== \"Invalid Date\" ? datetime : trimedValue,\r\n\t\t\t\toptions);\r\n\r\n\t\t\treturn result.indexOf(\"NaN\") === -1 ? result : trimedValue;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic AbsoluteValue(): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any) => {\r\n\t\t\tlet parsedValue = parseInt(value, 10);\r\n\r\n\t\t\tif (Helper.isUndefinedEmpty(value) || Number.isNaN(parsedValue)) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\r\n\t\t\tif (+value%1 !== 0) {\r\n\t\t\t\tparsedValue = parseFloat(value);\r\n\t\t\t}\r\n\r\n\t\t\treturn Math.abs(parsedValue).toString();\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n}\r\n","import { FeatureIdEnum } from \"ng2/common/constants/common.constant\";\r\nimport { FeatureSwitchService } from \"../../services/feature-switch-service\";\r\n\r\nexport abstract class FeatureSwitchCtrl {\r\n\r\n\tconstructor(\r\n\t\tprivate featureService: FeatureSwitchService\r\n\t) { }\r\n\r\n\tpublic isFeatureTranslationEnabled(): boolean {\r\n\t\t/*const isEnabled = this.featureService\r\n\t\t\t.isFeatureEnabled(FeatureIdEnum.TranslationService);*/\r\n\t\treturn true; //isEnabled;\r\n\t}\r\n\r\n\tpublic isFeatureCatalogEnabled(): boolean {\r\n\t\tconst isEnabled =\r\n\t\t\tthis.featureService.isFeatureEnabled(FeatureIdEnum.ShowFeatureCatalog);\r\n\t\treturn isEnabled;\r\n\t}\r\n}\r\n","/*\r\n\tTurns UserControl.js globals into importable ES modules\r\n*/\r\n\r\n//tslint:disable:no-var-requires\r\nrequire(\"./UserControl\");\r\n\r\n// Don't delete MG from window as it is used somewhere else internally in Mongoose.\r\nexport const MG = window.MG;\r\n\r\nexport const WSForm = window.WSForm;\r\ndelete window.WSForm;\r\n\r\nexport const WSUserControl = window.WSUserControl;\r\ndelete window.WSUserControl;\r\n","import isEmpty from \"lodash-es/isEmpty\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { Config, ProjectTypeEnum, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonDesignerManifest, IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\n\r\nimport { FileMetaData } from \"ng2/common/project/manifest/file-metadata\";\r\n\r\nexport class DesignerManifest implements IDesignerManifest {\r\n\tcreatedBy: string;\r\n\tcreatedByDisplayName: string;\r\n\tcreatedTime: number;\r\n\tdescription: string;\r\n\tdisplayName: string;\r\n\tfileMetaData: IMap<FileMetaData> = {};\r\n\tid: string;\r\n\tlastChangedBy: string;\r\n\tlastChangedByDisplayName: string;\r\n\tlastChangedTime: number;\r\n\tmashupBoundaries: IBoundary[];\r\n\turlVariables: IJsonUrlVariable[];\r\n\ttitle: string;\r\n\tversion: string;\r\n\r\n\tpreviewImg: string;\r\n\tshowTitleBar: boolean;\r\n\tthemeSwitchEnabled: boolean;\r\n\tdefaultTheme: ThemeEnum;\r\n\ttypeDef: ProjectTypeEnum;\r\n\r\n\tconstructor(arg1?: string | IJsonDesignerManifest, arg2?: string) {\r\n\t\tif (!arg2 && arg1 && typeof arg1 === \"object\") {\r\n\t\t\tthis.id = arg1.id;\r\n\t\t\tthis.displayName = arg1.displayName;\r\n\t\t\tthis.createdBy = arg1.createdBy;\r\n\t\t\tthis.createdByDisplayName = arg1.createdByDisplayName;\r\n\t\t\tthis.createdTime = arg1.createdTime;\r\n\t\t\tthis.lastChangedBy = arg1.lastChangedBy;\r\n\t\t\tthis.lastChangedByDisplayName = arg1.lastChangedByDisplayName;\r\n\t\t\tthis.lastChangedTime = arg1.lastChangedTime;\r\n\t\t\tthis.mashupBoundaries = arg1.mashupBoundaries;\r\n\t\t\tthis.urlVariables = arg1.urlVariables;\r\n\t\t\tthis.version = arg1.version;\r\n\t\t\tthis.description = arg1.description;\r\n\t\t\tif (arg1.fileMetaData) {\r\n\t\t\t\tthis.fileMetaData = arg1.fileMetaData;\r\n\t\t\t}\r\n\t\t\tthis.previewImg = arg1.previewImg;\r\n\t\t\tthis.showTitleBar = arg1.showTitleBar;\r\n\t\t\tthis.title = arg1.title;\r\n\t\t\tthis.themeSwitchEnabled = arg1.themeSwitchEnabled;\r\n\t\t\tthis.defaultTheme = arg1.defaultTheme;\r\n\t\t\tthis.typeDef = arg1.typeDef;\r\n\t\t} else if (arg1) {\r\n\t\t\tthis.id = \"\";\r\n\t\t\tthis.displayName = (arg1 as string);\r\n\t\t\tthis.description = arg2;\r\n\t\t\tthis.title = (arg1 as string);\r\n\t\t\tthis.showTitleBar = true;\r\n\t\t\tthis.themeSwitchEnabled = false;\r\n\t\t\tthis.defaultTheme = ThemeEnum.LIGHT;\r\n\t\t}\r\n\t}\r\n\r\n\tsetHasFile(fileKey: string, mimeType: string, visibleName: string): void {\r\n\t\tif (!this.fileMetaData[fileKey]) {\r\n\t\t\tthis.fileMetaData[fileKey] = new FileMetaData(visibleName, mimeType);\r\n\t\t}\r\n\t}\r\n\r\n\tupdateLastChangedInformation(newManifest: IJsonManifest): void {\r\n\t\tif (newManifest) {\r\n\t\t\tthis.lastChangedBy = newManifest.lastChangedBy;\r\n\t\t\tthis.lastChangedByDisplayName = newManifest.lastChangedByDisplayName;\r\n\t\t\tthis.lastChangedTime = newManifest.lastChangedTime;\r\n\t\t} else {\r\n\t\t\tthis.lastChangedBy = Config.USER.name;\r\n\t\t\tthis.lastChangedByDisplayName =\r\n\t\t\t\tisUndefined(Config.USER.displayName) || isEmpty(Config.USER.displayName) ?\r\n\t\t\t\t\tConfig.USER.name : Config.USER.displayName;\r\n\t\t\tthis.lastChangedTime = new Date().getTime();\r\n\t\t}\r\n\t}\r\n}\r\n","import { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\n\r\nexport interface IComponentSettingCategory {\r\n\ttitle: string;\r\n\ttab: string;\r\n\tcondition?: string;\r\n\tsettings: IComponentFieldSetting[];\r\n}\r\n","import { Debugger } from \"../../debugger\";\r\nimport { FeatureSwitchService } from \"../../services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"./feature-switch-ctrl\";\r\nimport { IValidationResult } from \"./field-validation\";\r\n\r\n/**\r\n * Extend this class if parent has components which needs to notify each other on changes\r\n */\r\nexport abstract class NotifiableComponent extends FeatureSwitchCtrl {\r\n\tpublic parentAnnounce: IParentAnnounce;\r\n\r\n\tpublic constructor(featureSwitchService?: FeatureSwitchService) {\r\n\t\tsuper(featureSwitchService);\r\n\t}\r\n\r\n\tprotected notify($data: IOnComponentChangeNotification): boolean | IValidationResult {\r\n\t\tconst result: boolean | IValidationResult = this.getValidation($data);\r\n\r\n\t\tif (!$data.callback) {\r\n\t\t\tDebugger.log(this, `$data.id=\"${$data.id}\" - Notify Children To Update`);\r\n\r\n\t\t\t// tell children it is from this sibling which announced.\r\n\t\t\t// so that sibling knows it doesn't have to tell its parent about it.\r\n\t\t\tthis.parentAnnounce = {\r\n\t\t\t\tid: $data.id\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected getValidation(\r\n\t\t$data: IOnComponentChangeNotification\r\n\t): boolean | IValidationResult {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport interface IOnComponentChangeNotification {\r\n\tvalidator: string;\r\n\tid: string;\r\n\tvalue: string;\r\n\tcallback: boolean;\r\n}\r\n\r\nexport interface IParentAnnounce {\r\n\tid: string;\r\n}\r\n","import { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { InstanceEvent } from \"../../common/instance-event\";\r\nimport { Designer } from \"../../designer/designer\";\r\n\r\nimport { InjectNames, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonDesignerMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { Mashup } from \"ng2/common/project/mashup\";\r\nimport { ViewEnum } from \"../../common/defines\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\n\r\nimport { CommonService } from \"../../common/services/common-service\";\r\nimport { HttpService } from \"../../common/services/http-service\";\r\nimport { ThemeService } from \"../../common/services/theme-service\";\r\n\r\nexport class DesignerService {\r\n\r\n\tpublic projectSettingsChangedEvent: InstanceEvent<DesignerManifest>;\r\n\tpublic currentBoundaryChangedEvent: InstanceEvent<IBoundary>;\r\n\tpublic currentCanvasThemeChangedEvent: InstanceEvent<ThemeEnum>;\r\n\r\n\tpublic viewChangedEvent = new InstanceEvent<ViewEnum>();\r\n\tprivate info: Designer;\r\n\tprivate view: ViewEnum;\r\n\t// Used to cache request\r\n\tprivate requestInfoPromise: ng.IPromise<Designer>;\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.THEME_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate themeService: ThemeService\r\n\t) {\r\n\t\tthis.projectSettingsChangedEvent = commonService.projectSettingsChangedEvent;\r\n\t\tthis.currentBoundaryChangedEvent = commonService.currentBoundaryChangedEvent;\r\n\t\tthis.currentCanvasThemeChangedEvent = commonService.currentCanvasThemeChangedEvent;\r\n\t}\r\n\r\n\tpublic loadProject(projectId: string, canvasWidth: number): ng.IPromise<DesignerMashup> {\r\n\t\tconst promise = this.commonService.loadProject(projectId, canvasWidth) as ng.IPromise<IJsonDesignerMashup>;\r\n\t\treturn this.parseAndSetProject(promise, canvasWidth);\r\n\t}\r\n\r\n\tpublic unloadProject(): void {\r\n\t\treturn this.commonService.unloadProject();\r\n\t}\r\n\r\n\tpublic updateCurrentBoundary(canvasWidth: number): void {\r\n\t\tthis.commonService.updateCurrentBoundary(canvasWidth);\r\n\t}\r\n\r\n\tpublic setView(view: ViewEnum): void {\r\n\t\tthis.view = view;\r\n\r\n\t\tlet theme = ThemeEnum.LIGHT;\r\n\t\tif (view === ViewEnum.EDITOR) {\r\n\t\t\tconst currentProject = this.getCurrentProject();\r\n\t\t\tif (currentProject) {\r\n\t\t\t\ttheme = currentProject.manifest.defaultTheme;\r\n\t\t\t\tthis.commonService.setCanvasTheme(theme, true);\r\n\t\t\t}\r\n\t\t\ttheme = ThemeEnum.DARK;\r\n\t\t}\r\n\r\n\t\tthis.themeService.changeThemeCss(theme, false).finally(() => {\r\n\t\t\tthis.viewChangedEvent.raise(view);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getView(): ViewEnum {\r\n\t\treturn this.view;\r\n\t}\r\n\r\n\tpublic requestInfo(): ng.IPromise<Designer> {\r\n\t\tif (!this.requestInfoPromise) {\r\n\t\t\tthis.requestInfoPromise = Designer.info(this.httpService).then((designer: Designer) => {\r\n\t\t\t\t// Cache to be used in getInfo method\r\n\t\t\t\tthis.info = designer;\r\n\t\t\t\treturn designer;\r\n\t\t\t}).catch((e: any) => {\r\n\t\t\t\t// reset request cahce\r\n\t\t\t\tthis.requestInfoPromise = null;\r\n\t\t\t\treturn e;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.requestInfoPromise;\r\n\t}\r\n\r\n\tpublic getInfo(): Designer {\r\n\t\treturn this.info;\r\n\t}\r\n\r\n\tpublic getCurrentProject(): Mashup {\r\n\t\treturn this.commonService.getCurrentProject();\r\n\t}\r\n\r\n\tpublic getCurrentBoundary(): IBoundary {\r\n\t\treturn this.commonService.getCurrentBoundary();\r\n\t}\r\n\r\n\tpublic setCurrentBoundary(boundary: IBoundary): void {\r\n\t\treturn this.commonService.setCurrentBoundary(boundary);\r\n\t}\r\n\r\n\tpublic getCurrentRootComponentInstance(): ILayoutComponent {\r\n\t\treturn this.commonService.getCurrentRootComponentInstance();\r\n\t}\r\n\r\n\tpublic setCurrentRootComponentInstance(component: ILayoutComponent): void {\r\n\t\tthis.commonService.setCurrentRootComponentInstance(component);\r\n\t}\r\n\r\n\tpublic getCanvasTheme(): ThemeEnum {\r\n\t\treturn this.commonService.getCurrentTheme();\r\n\t}\r\n\r\n\tpublic setCanvasTheme(theme: ThemeEnum): void {\r\n\t\tthis.commonService.setCanvasTheme(theme, true);\r\n\t}\r\n\r\n\tprivate parseAndSetProject(\r\n\t\tpromise: ng.IPromise<IJsonDesignerMashup>,\r\n\t\tcanvasWidth: number): ng.IPromise<DesignerMashup> {\r\n\t\treturn promise.then((jsonMashup: IJsonDesignerMashup) => {\r\n\r\n\t\t\tconst mashup = DesignerMashup.fromObj(jsonMashup);\r\n\r\n\t\t\treturn this.commonService.buildPrerequisites(mashup, canvasWidth) as ng.IPromise<DesignerMashup>;\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.DESIGNER_SERVICE, DesignerService);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { ComponentSizeTypes, CssConstantKeys, DEFAULT_BOUNDARY } from \"ng2/common/constants/common.constant\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport type{ IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport { IJQueryDragEventObject, IJQueryMouseEventObject } from \"common/defines\";\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nimport { Defines, ISettingsClassInstance } from \"editor/defines\";\r\nimport { EditorService } from \"editor/services/editor-service\";\r\n\r\nexport class EditorHelper {\r\n\tstatic getComponentSettingsClass(componentName: string): ISettingsClassInstance {\r\n\t\tlet settingsClass: ISettingsClassInstance = null;\r\n\t\tif (Defines.allSettingsComponents[componentName]) {\r\n\t\t\tsettingsClass = Defines.allSettingsComponents[componentName].settingsClass.getInstance();\r\n\t\t}\r\n\t\treturn settingsClass;\r\n\t}\r\n\r\n\tstatic updateParentComponentSizeClass(parentComponent: ILayoutComponent): void {\r\n\t\tconst parentComponentEirChildren: JQuery =\r\n\t\t\tangular.element(parentComponent.element).find(\"eir-children\").filter(() => {\r\n\t\t\t\treturn $(parentComponent.element).find(\".layoutComponent\").length === 0;\r\n\t\t\t});\r\n\t\tif (!this.containsBigComponent(parentComponent)) {\r\n\t\t\tparentComponentEirChildren.attr(\"class\", ComponentSizeTypes.SMALL);\r\n\t\t} else {\r\n\t\t\tparentComponentEirChildren.attr(\"class\", ComponentSizeTypes.LARGE);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic containsBigComponent(parentComponent: ILayoutComponent): boolean {\r\n\t\treturn parentComponent.getDatabearer().children.some((child: IJsonComponent) => {\r\n\t\t\treturn this.isBigComponent(child);\r\n\t\t});\r\n\t}\r\n\r\n\tstatic isBigComponent(jsonComponent: IJsonComponent): boolean {\r\n\t\tconst width = jsonComponent.boundarySettings[DEFAULT_BOUNDARY.id].width;\r\n\t\treturn width.sizeType === SizeTypeEnum.PERCENT;\r\n\t}\r\n\r\n\t/**\r\n\t * Will get the underlying component of an DOM-component if there is any\r\n\t * @param {component} IEditorComponent\r\n\t * @param {event} IJQueryMouseEventObject | IJQueryDragEventObject\r\n\t * @return {IComponent} IComponent\r\n\t */\r\n\tstatic getUnderlyingComponent(\r\n\t\tcomponent: IEditorComponent,\r\n\t\tevent: IJQueryMouseEventObject | IJQueryDragEventObject,\r\n\t\teditorService: EditorService\r\n\t): IComponent {\r\n\t\t//Get the underlying component by point.\r\n\t\tangular.element(\".id-\" + component.getId()).css(CssConstantKeys.DISPLAY, \"none\");\r\n\t\tconst componentElement = $(document.elementFromPoint(event.originalEvent.clientX, event.originalEvent.clientY));\r\n\t\tangular.element(\".id-\" + component.getId()).css(CssConstantKeys.DISPLAY, \"\");\r\n\t\tconst id = componentElement.attr(\"id\");\r\n\t\tif (id) {\r\n\t\t\treturn editorService.getComponentInstanceById(id);\r\n\t\t} else {\r\n\t\t\treturn component;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Will swap two items in an array\r\n\t * any because any kind of array can be used here.\r\n\t * @param {array} any\r\n\t * @param {firstIndex} number\r\n\t * @param {secondIndex} number\r\n\t */\r\n\tstatic swap(array: any[], firstIndex: number, secondIndex: number): void {\r\n\t\tconst temporaryItem = array[firstIndex];\r\n\t\tarray[firstIndex] = array[secondIndex];\r\n\t\tarray[secondIndex] = temporaryItem;\r\n\t}\r\n\r\n\t/**\r\n\t * Will move a array object from startIndex to endIndex\r\n\t * any kind of array can be used here.\r\n\t * @param {array} any\r\n\t * @param {startIndex} number\r\n\t * @param {endIndex} number\r\n\t */\r\n\tstatic moveByIndex(array: any[], startIndex: number, endIndex: number): void {\r\n\t\tconst tempItem = array[startIndex];\r\n\t\tarray.splice(startIndex, 1);\r\n\t\tarray.splice(endIndex, 0, tempItem);\r\n\t}\r\n\r\n\t/**\r\n\t * Will return index if item is found\r\n\t * @param {array} any\r\n\t * @param {itemId} string\r\n\t * @return {boolean} true/false\r\n\t */\r\n\tstatic findIndex(array: any[], itemId: string): number {\r\n\t\tfor (let index = 0; index < array.length; index++) {\r\n\t\t\tif (array[index].id === itemId) {\r\n\t\t\t\treturn index;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tstatic updateDOMTreeElement(componentId: string): void {\r\n\t\t//Trigger resize to redraw element\r\n\t\tconst element = $(\"#\" + componentId);\r\n\t\telement.trigger(\"resize\");\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if element is overflowed\r\n\t *\r\n\t * @static\r\n\t * @param {*} element\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\t// Method not used?\r\n\tstatic isOverflowed(element: any): boolean {\r\n\t\treturn element.scrollHeight > element.clientHeight || element.scrollWidth > element.clientWidth;\r\n\t}\r\n\r\n\t/**\r\n\t* Returns true if item is unique, looks first id at base then in manifest.\r\n\t*\r\n\t* @static\r\n\t* @param {targetItem} any\r\n\t* @returns {boolean}\r\n\t*\r\n\t*/\r\n\tstatic itemUnique(targetItem: any, items: any[]): boolean {\r\n\t\treturn !items.some(\r\n\t\t\t(element: any, index: number, array: any[]): boolean => {\r\n\t\t\t\tif (element.id) {\r\n\t\t\t\t\treturn (element.id.toLowerCase() === targetItem.id.toLowerCase());\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn (element.manifest.id.toLowerCase() === targetItem.manifest.id.toLowerCase());\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../angular-constants\";\r\n\r\nimport { Config, InjectNames, LanguageConsts, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IIonApiRequestOptions } from \"ng2/common/model/ion-api/ion-api.model\";\r\nimport { IMingleLanguage, IMongooseString } from \"ng2/common/model/language.model\";\r\n\r\nimport { IonApiService } from \"../../components/services/ion-api-service\";\r\nimport { Helper } from \"../helper\";\r\nimport { FeatureSwitchCtrl } from \"../shared-components/base/feature-switch-ctrl\";\r\nimport { FeatureSwitchService } from \"./feature-switch-service\";\r\nimport { HashService } from \"./hash-service\";\r\nimport { HttpService } from \"./http-service\";\r\n\r\nexport type UrlSearchParams = any;\r\n\r\ninterface ILocalStorageValue {\r\n\tlocale: string;\r\n\tusername: string;\r\n}\r\n\r\nexport class LanguageService extends FeatureSwitchCtrl {\r\n\tprivate language: string;\r\n\tprivate currentStrings: IMap<IMongooseString> = {};\r\n\tprivate supportedLanguages: IMingleLanguage[] = LanguageConsts.SUPPORTED_LANGUAGES; //This will be overwritten\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.WINDOW,\r\n\t\tInjectNames.ION_API_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.HASH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $window: ng.IWindowService,\r\n\t\tprivate ionApiService: IonApiService,\r\n\t\tfeatureSwitchService: FeatureSwitchService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate hashService: HashService,\r\n\t) {\r\n\t\tsuper(featureSwitchService);\r\n\t\t//What to do with this? Keep, discard?\r\n\t\t//this.fetchSupportedMingleLanguages();\r\n\t}\r\n\r\n\tinitializeLanguageSettings(): ng.IPromise<void> {\r\n\t\treturn this.loadSupportedLanguages().then(() => {\r\n\t\t\tthis.detectLanguage();\r\n\t\t\tthis.loadSohoLocale(this.language);\r\n\t\t}).finally(() => {\r\n\t\t\treturn this.loadGlobalStrings();\r\n\t\t});\r\n\t}\r\n\r\n\tloadGlobalStrings(language?: string): ng.IPromise<void> {\r\n\t\tconst locale = language ? language : \"\";\r\n\t\treturn this.httpService.executeGet(ServerPaths.SETTINGS + \"language/\" + locale)\r\n\t\t\t.then((strings: IMap<IMongooseString>) => {\r\n\t\t\t\tthis.currentStrings = strings;\r\n\t\t\t});\r\n\t}\r\n\r\n\tgetGlobalString(name: string): string | null {\r\n\t\tlet stringValue = null;\r\n\t\tif (this.currentStrings.hasOwnProperty(name)) {\r\n\t\t\tstringValue = this.currentStrings[name].Value;\r\n\t\t}\r\n\r\n\t\treturn stringValue;\r\n\t}\r\n\r\n\taddGlobalString(stringItem: IMongooseString): ng.IPromise<void> {\r\n\t\t//Save with current language\r\n\t\tconst savedValue: IMap<IMongooseString[]> = {};\r\n\t\tsavedValue[this.getLanguage()] = [stringItem];\r\n\t\treturn this.saveGlobalStrings(savedValue);\r\n\t}\r\n\r\n\tgetCurrentStrings(): IMap<IMongooseString> {\r\n\t\treturn this.currentStrings;\r\n\t}\r\n\r\n\tfetchGlobalStrings(locale: string): ng.IPromise<IMap<IMongooseString>> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.SETTINGS + \"language/\" + locale);\r\n\t}\r\n\r\n\tsaveGlobalStrings(modifiedStrings: IMap<IMongooseString[]>): ng.IPromise<void> {\r\n\t\tfor (const languageKey in modifiedStrings) {\r\n\t\t\tmodifiedStrings[languageKey].forEach((globalString) => {\r\n\t\t\t\tthis.currentStrings[globalString.Name] = globalString;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.httpService.executePut(ServerPaths.SETTINGS + \"translation/\", modifiedStrings);\r\n\t}\r\n\r\n\tdeleteGlobalStrings(deletedStrings: IMap<IMongooseString[]>): ng.IPromise<void> {\r\n\t\tfor (const languageKey in deletedStrings) {\r\n\t\t\tdeletedStrings[languageKey].forEach((globalString) => {\r\n\t\t\t\tdelete this.currentStrings[globalString.Name];\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.httpService.executeDelete(ServerPaths.SETTINGS + \"translation/\", deletedStrings);\r\n\t}\r\n\r\n\tchangeCurrentLanguage(locale: string): ng.IPromise<void> {\r\n\t\treturn this.httpService.executePut(ServerPaths.SETTINGS + \"language\", locale).then(() => {\r\n\t\t\tthis.language = locale;\r\n\t\t\tconst localStorageValue: ILocalStorageValue = {\r\n\t\t\t\tlocale: locale,\r\n\t\t\t\tusername: Config.USER.name\r\n\t\t\t};\r\n\t\t\tlocalStorage.setItem(\"language\", JSON.stringify(localStorageValue) );\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Detects the current language.and sets it to the singleton value\r\n\t * Run this function if the singleton language value should change\r\n\t *\r\n\t * @memberof LanguageService\r\n\t */\r\n\tdetectLanguage(): void {\r\n\t\tconst urlSearchParams = this.$window.parent.location.search;\r\n\t\tthis.language = this.getLanguageThroughSearchParams(urlSearchParams);\r\n\t}\r\n\r\n\tgetSupportedLanguages(): IMingleLanguage[] {\r\n\t\treturn this.supportedLanguages;\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the current language through the singleton value.\r\n\t *\tUse this function to get the language stored in this singleton\r\n\t\t*\tHas multiple fallbacks:\r\n\t\t*\r\n\t\t* 1. \"$language\" in url search params\r\n\t\t* 2. \"inforCurrentLanguage\" in url search params\r\n\t\t* 3. Browsers own language through window.navigator.language\r\n\t\t* 4. Default language which is en-US\r\n\t\t*\r\n\t\t* @returns {string}\r\n\t\t* @memberof LanguageService\r\n\t\t*/\r\n\tgetLanguage(): string {\r\n\t\tif (this.isFeatureTranslationEnabled()) {\r\n\t\t\tif (this.language) {\r\n\t\t\t\treturn this.language;\r\n\t\t\t}\r\n\t\t\tthis.detectLanguage();\r\n\t\t}\r\n\t\treturn this.language;\r\n\t}\r\n\r\n\t/**\r\n\t * Get language with any url search params.\r\n\t * Use this function if you want to get a new language without overriding the singleton value\r\n\t * Has multiple fallbacks:\r\n\t *\r\n\t * 1. \"$language\" in url search params\r\n\t * 2. \"inforCurrentLanguage\" in url search params\r\n\t * 3. Browsers own language through window.navigator.language\r\n\t * 4. Default language which is en-US\r\n\t *\r\n\t * @param {UrlSearchParams} urlSearchParams\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tgetLanguageThroughSearchParams(urlSearchParams: UrlSearchParams): string {\r\n\t\tlet language: string;\r\n\r\n\t\tlanguage = this.getUrlLanguage(urlSearchParams);\r\n\r\n\t\tif (this.isValid(language) === false) {\r\n\t\t\tlanguage = this.getMingleLanguage(urlSearchParams);\r\n\t\t}\r\n\r\n\t\tif (this.isValid(language) === false) {\r\n\t\t\tlanguage = this.getLocalStorageLanguage();\r\n\t\t}\r\n\r\n\t\tif (this.isValid(language) === false) {\r\n\t\t\tlanguage = Config.LOCALE; //Mongoose user-preference language\r\n\t\t}\r\n\r\n\t\tif (this.isValid(language) === false) {\r\n\t\t\tlanguage = this.getBrowserLanguage();\r\n\t\t}\r\n\r\n\t\tif (this.isValid(language) === false || this.isSupported(language) === false) {\r\n\t\t\tlanguage = this.getDefaultLanguage();\r\n\t\t}\r\n\r\n\t\treturn language;\r\n\t}\r\n\r\n\t/**\r\n\t * Loads Soho Locale without setting it\r\n\t */\r\n\tloadSohoLocale(locale: string): JQueryDeferred<any> {\r\n\t\tlet currentLanguage = this.supportedLanguages.find(language => {\r\n\t\t\treturn language.key === locale;\r\n\t\t});\r\n\r\n\t\tif (Helper.isUndefinedOrNull(currentLanguage)) {\r\n\t\t\tcurrentLanguage = this.supportedLanguages[0];\r\n\t\t}\r\n\r\n\t\treturn Soho.Locale.getLocale(currentLanguage.key, currentLanguage.filename);\r\n\t}\r\n\r\n\tprivate getLocalStorageLanguage(): string | null {\r\n\t\tlet locale: string = null;\r\n\t\tconst localStorageValue = JSON.parse(localStorage.getItem(\"language\")) as ILocalStorageValue;\r\n\t\tif (localStorageValue && Config.USER.name === localStorageValue.username) {\r\n\t\t\tlocale = localStorageValue.locale;\r\n\t\t}\r\n\r\n\t\treturn locale;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the language based on any $language in the url search params\r\n\t *\r\n\t * @private\r\n\t * @param {string} urlSearchParams\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate getUrlLanguage(urlSearchParams: string): string {\r\n\t\tconst params = Helper.parseQueryString(urlSearchParams);\r\n\t\treturn params.$language;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the language based on any url search params containing \"inforCurrentLanguage\"\r\n\t *\r\n\t * @private\r\n\t * @param {string} urlSearchParams\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate getMingleLanguage(urlSearchParams: string): string {\r\n\t\tconst params = Helper.parseQueryString(urlSearchParams);\r\n\t\treturn params.inforCurrentLanguage;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the language based on the window.navigator.language\r\n\t *\r\n\t * @private\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate getBrowserLanguage(): string {\r\n\t\tconst language = this.$window.navigator && this.$window.navigator.language;\r\n\t\treturn language;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a default languagee\r\n\t *\r\n\t * @public\r\n\t * @param {UrlSearchParams} urlSearchParams\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tgetDefaultLanguage(): string {\r\n\t\treturn LanguageConsts.DEFAULT.key;\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the language is a valid languagee\r\n\t *\r\n\t * @private\r\n\t * @param {string} languagee\r\n\t * @returns {boolean}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate isValid(language: string): boolean {\r\n\t\tif (language && /^[a-z0-9-_]+$/i.test(language)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the language is supported\r\n\t *\r\n\t * @private\r\n\t * @param {string} language\r\n\t * @returns {boolean}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate isSupported(language: string): boolean {\r\n\t\tconst supported = this.supportedLanguages.some((supportedLanguage) => {\r\n\t\t\treturn this.isEqual(supportedLanguage.key, language);\r\n\t\t});\r\n\t\t/*if (supported) {\r\n\t\t\tif (LanguageConsts.UNSUPPORTED_LANGUAGES.indexOf(language) === -1) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}*/\r\n\t\treturn supported;\r\n\t}\r\n\r\n\t/**\r\n\t * Compare two locales.\r\n\t * if browser gives two letters compare only the two first\r\n\t *\r\n\t * @private\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate isEqual(supportedLanguageKey: string, languageKey: string): boolean {\r\n\t\tconst lengthOfString = 2;\r\n\t\tif (languageKey.length === lengthOfString) {\r\n\t\t\tsupportedLanguageKey = supportedLanguageKey.substring(0, lengthOfString);\r\n\t\t}\r\n\t\treturn supportedLanguageKey === languageKey;\r\n\t}\r\n\r\n\t/**\r\n\t * fetch all supported languages from mongoose, used once.\r\n\t *\r\n\t * @public\r\n\t * @memberof LanguageService\r\n\t */\r\n\tloadSupportedLanguages(): ng.IPromise<any> {\r\n\t\treturn this.httpService\r\n\t\t\t.executeGet<IMingleLanguage[]>(ServerPaths.SETTINGS + \"supportedLanguages/\")\r\n\t\t\t.then(languages => {\r\n\t\t\t\tthis.supportedLanguages = languages;\r\n\t\t\t\tconst hashedFilenames = this.hashService.getHashMap();\r\n\r\n\t\t\t\tthis.supportedLanguages.forEach(language => {\r\n\t\t\t\t\tthis.mapFilenameToSupportedLanguages(language, hashedFilenames);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate mapFilenameToSupportedLanguages(\r\n\t\tlanguage: IMingleLanguage,\r\n\t\tcacheBustedFilenames: IMap<string>\r\n\t): void {\r\n\t\tfor (const item in cacheBustedFilenames) {\r\n\t\t\tif (cacheBustedFilenames[item].indexOf(language.key) !== -1) {\r\n\t\t\t\tconst re = new RegExp(`${language.key}.[0-9a-z]*`);\r\n\t\t\t\tconst isMatch = cacheBustedFilenames[item].match(re);\r\n\t\t\t\tif (isMatch) {\r\n\t\t\t\t\tlanguage.filename = isMatch[0];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * fetch all supported languages from ming.le, used once.\r\n\t * NOT USED, DEPRECATED\r\n\t * @private\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate fetchSupportedMingleLanguages(): ng.IPromise<any> {\r\n\t\tconst options: IIonApiRequestOptions = {\r\n\t\t\turl: \"/Mingle/Admin/System/Language\",\r\n\t\t\tmethod: HttpVerbEnum.GET,\r\n\t\t\theaders: {},\r\n\t\t};\r\n\t\treturn this.ionApiService.executeIonApiAsync(options).then((response) => {\r\n\t\t\tthis.supportedLanguages = (response.data as any).LanguageList;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * get all supported languages,\r\n\t * if IonApi is down for some reason it fall backs to static list\r\n\t *\r\n\t * @public\r\n\t * @returns {IMingleLanguage[]}\r\n\t * @memberof LanguageService\r\n\t */\r\n\t/*getSupportedMingleLanguages(): IMingleLanguage[] {\r\n\t\t// Filter to remove the unsupported languages;\r\n\t\tconst supportedLanguages = angular.copy(this.supportedLanguages);\r\n\t\tLanguageConsts.UNSUPPORTED_LANGUAGES.forEach((unsupportedLanguage) => {\r\n\t\t\tfor (let i = 0; i < supportedLanguages.length; i++) {\r\n\t\t\t\tif (unsupportedLanguage === supportedLanguages[i].key) {\r\n\t\t\t\t\tsupportedLanguages.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn supportedLanguages;\r\n\t}*/\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.LANGUAGE_SERVICE, LanguageService);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { IdoProperties, InjectNames, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport {\r\n\tIJsonGenericDatasource2,\r\n\tIJsonLocalIdoDatasource,\r\n} from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport {\r\n\tILocalIdoParameterObject,\r\n\tIParameterObject\r\n} from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\nimport { Helper } from \"../../common/helper\";\r\nimport { HttpService } from \"../../common/services/http-service\";\r\n\r\nexport interface ILocalIDOTestDataService extends IJsonLocalIdoDatasource {\r\n\tisTestIDO: boolean;\r\n}\r\n\r\n// tslint:disable-next-line:interface-name\r\nexport interface IdoProject {\r\n\tserverName: string;\r\n\tserverDesc: string;\r\n\taccessAs: string;\r\n}\r\n\r\n// tslint:disable-next-line:interface-name\r\nexport interface IdoCollection {\r\n\tcollectionName: string;\r\n\tcollectionDesc: string;\r\n\tserverName: string;\r\n\tcreatedBy: string;\r\n\tcreateDate: string;\r\n}\r\n\r\n// tslint:disable-next-line:interface-name\r\nexport interface IdoProperty {\r\n\tpropertyName: string;\r\n\tpropertyType: string;\r\n\r\n\tcolumnName: string;\r\n\r\n\tisReadOnly: boolean;\r\n\tisRequired: boolean;\r\n\r\n\tdataLength?: number;\r\n\tdataType: string;\r\n\r\n\tkeySequence: number;\r\n}\r\n\r\nexport class LocalIdoService {\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t) { }\r\n\r\n\t/**\r\n\t * Returns a list of IDO projects\r\n\t */\r\n\tpublic getIdoProjectList(): ng.IPromise<IdoProject[]> {\r\n\t\tconst path = ServerPaths.LOCAL_IDO + \"projects\";\r\n\r\n\t\treturn this.httpService.executeGet<IdoProject[]>(path);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns list of IDO collections\r\n\t * @param projectName\r\n\t * @param query\r\n\t * @param pageNo\r\n\t */\r\n\tpublic getIdoCollectionList(\r\n\t\tprojectName?: string,\r\n\t\tquery?: string,\r\n\t\tpageNo?: number\r\n\t): ng.IPromise<IdoCollection[]> {\r\n\t\tconst path = ServerPaths.LOCAL_IDO;\r\n\t\tconst parameters = {\r\n\t\t\tprojectName,\r\n\t\t\tquery,\r\n\t\t\tpageNo\r\n\t\t};\r\n\r\n\t\treturn this.httpService.executeGet<IdoCollection[]>(path, parameters);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns list of properties of an IDO\r\n\t * @param collectionName\r\n\t */\r\n\tpublic getIdoProperties(collectionName: string): ng.IPromise<IdoProperty[]> {\r\n\t\tconst path = ServerPaths.LOCAL_IDO + \"properties/?collectionName=\" +  collectionName;\r\n\r\n\t\treturn this.httpService.executeGet(path);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns data from an IDO collection\r\n\t * @param dataservice\r\n\t */\r\n\tpublic getIdoCollection(\r\n\t\tdataservice: IJsonLocalIdoDatasource,\r\n\t\tinputParameterValues?: IMap<string>\r\n\t): ng.IPromise<any[]> {\r\n\t\tconst collectionName = dataservice.resource;\r\n\t\tconst recordCap = dataservice.recordCap.limit;\r\n\t\tconst orderBy = dataservice.orderBy === \"Default Order\" ? \"\" : dataservice.orderBy;\r\n\t\tconst filterQuery = [];\r\n\t\tconst parsedParameters = this.parseParameters(inputParameterValues, dataservice.inputParameters);\r\n\t\tlet parameters = angular.copy(dataservice.outputParameters);\r\n\r\n\t\tif (!(dataservice as ILocalIDOTestDataService).isTestIDO) {\r\n\t\t\tparameters = this.initParameters(parameters);\r\n\t\t}\r\n\r\n\t\tfor (const key in parsedParameters) {\r\n\t\t\tfilterQuery.push(`${key} = '${parsedParameters[key]}'`);\r\n\t\t}\r\n\r\n\t\tlet path = `${ServerPaths.LOCAL_IDO}collection/?\r\n\t\t\tcollectionName=${collectionName}\r\n\t\t\t${filterQuery.length === 0 ? \"\" : `&filter=${encodeURIComponent(filterQuery.join(\" AND \"))}`}\r\n\t\t\t${Helper.isUndefinedOrNull(recordCap) ? \"\" : `&recordCap=${recordCap}`}\r\n\t\t\t${Helper.isUndefinedOrNull(orderBy) ? \"\" : `&orderBy=${orderBy}`}`;\r\n\r\n\t\tpath = Helper.cleanTemplateLiteral(path);\r\n\t\treturn this.httpService.executeGet(path, parameters);\r\n\t}\r\n\r\n\t/**\r\n\t * Updates an IDO Collection entry\r\n\t * @param dataservice\r\n\t * @param inputParameterValues\r\n\t */\r\n\tpublic updateIdoCollectionEntry(\r\n\t\tdataservice: IJsonGenericDatasource2,\r\n\t\tinputParameterValues?: IMap<string>\r\n\t): ng.IPromise<any[]> {\r\n\t\tconst parsedParameters =\r\n\t\t\tthis.parseParameters(inputParameterValues, dataservice.inputParameters);\r\n\r\n\t\treturn this.isValidUpsertRequest(parsedParameters)\r\n\t\t\t.then(() => {\r\n\t\t\t\tconst collectionName = dataservice.resource;\r\n\r\n\t\t\t\tlet path = `${ServerPaths.LOCAL_IDO}collection/?\r\n\t\t\t\t\tcollectionName=${collectionName}`;\r\n\t\t\t\tpath = Helper.cleanTemplateLiteral(path);\r\n\r\n\t\t\t\treturn this.httpService.executePut(path, JSON.stringify(parsedParameters));\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Inserts an IDO Collection entry\r\n\t * @param dataservice Inserts an entry to an IDO Collection\r\n\t * @param inputParameterValues\r\n\t */\r\n\tpublic insertIdoCollectionEntry(\r\n\t\tdataservice: IJsonGenericDatasource2,\r\n\t\tinputParameterValues?: IMap<string>\r\n\t): ng.IPromise<any[]> {\r\n\t\tconst parsedParameters =\r\n\t\t\tthis.parseParameters(inputParameterValues, dataservice.inputParameters);\r\n\t\tconst collectionName = dataservice.resource;\r\n\r\n\t\tlet path =\r\n\t\t\t`${ServerPaths.LOCAL_IDO}collection/?collectionName=${collectionName}`;\r\n\t\tpath = Helper.cleanTemplateLiteral(path);\r\n\r\n\t\treturn this.httpService.executePost(path, JSON.stringify(parsedParameters));\r\n\t}\r\n\r\n\tpublic deleteIdoCollectionEntry(\r\n\t\tdataservice: IJsonGenericDatasource2,\r\n\t\tinputParameterValues?: IMap<string>\r\n\t): ng.IPromise<void> {\r\n\t\tconst parsedParameters =\r\n\t\t\tthis.parseParameters(inputParameterValues, dataservice.inputParameters);\r\n\t\tconst collectionName = dataservice.resource;\r\n\r\n\t\treturn this.isValidUpsertRequest(parsedParameters)\r\n\t\t\t.then(() => {\r\n\t\t\t\tlet path =\r\n\t\t\t\t\t`${ServerPaths.LOCAL_IDO}collection/?collectionName=${collectionName}`;\r\n\t\t\t\tpath = Helper.cleanTemplateLiteral(path);\r\n\r\n\t\t\t\treturn this.httpService.executeDelete(path, JSON.stringify(parsedParameters));\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Re-maps property names to readable\r\n\t * @param parameterValues\r\n\t * @param parameterNames\r\n\t */\r\n\tprivate parseParameters(\r\n\t\tparameterValues: IMap<string>,\r\n\t\tparameterNames: IParameterObject[]\r\n\t): IMap<string> {\r\n\t\tconst result = {} as IMap<string>;\r\n\t\tfor (const key in parameterValues) {\r\n\t\t\tconst targetInput = parameterNames\r\n\t\t\t\t.find(inputParameter => inputParameter.id === key);\r\n\r\n\t\t\tif (targetInput &&\r\n\t\t\t\t!Helper.isUndefinedOrNull(parameterValues[key])\r\n\t\t\t) {\r\n\t\t\t\tresult[targetInput.key] = parameterValues[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Add rowpointer temporary if not added as output-parameter\r\n\t * used as a data id for keep selection\r\n\t * @param parameters\r\n\t */\r\n\tprivate initParameters(parameters: ILocalIdoParameterObject[]): ILocalIdoParameterObject[] {\r\n\t\tif (!parameters.some(item => item.key === IdoProperties.ROW_POINTER)) {\r\n\t\t\tconst rowPointer = {\r\n\t\t\t\tid: \"id\",\r\n\t\t\t\tkey: IdoProperties.ROW_POINTER,\r\n\t\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\t\tparameterType: ParameterTypeEnum.QUERY,\r\n\t\t\t\trequired: false,\r\n\t\t\t\talias: \"\"\r\n\t\t\t};\r\n\t\t\tparameters.push(rowPointer);\r\n\t\t}\r\n\t\treturn parameters;\r\n\t}\r\n\r\n\tprivate isValidUpsertRequest(parsedParameters: IMap<string>): ng.IPromise<void> {\r\n\t\tconst deferred = this.$q.defer<void>();\r\n\t\tconst isUndefinedEmpty = Helper.isUndefinedEmpty;\r\n\r\n\t\tif (isUndefinedEmpty(parsedParameters[IdoProperties.ITEM_ID]) &&\r\n\t\t\t(isUndefinedEmpty(parsedParameters[IdoProperties.RECORD_DATE]) &&\r\n\t\t\t\tisUndefinedEmpty(parsedParameters[IdoProperties.ROW_POINTER]))) {\r\n\t\t\tdeferred.reject(new Error(`\r\n\t\t\tUpdate request must include the ItemId property, or the RecordDate and RowPointer properties.`));\r\n\t\t} else {\r\n\t\t\tdeferred.resolve();\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.service(InjectNames.LOCAL_IDO_SERVICE, LocalIdoService);\r\n\t}\r\n}","import angular from \"angular\";\r\n\r\nimport {\r\n\tABFormScriptMethod,\r\n\tConfig,\r\n\tInjectNames,\r\n\tMGPlatform,\r\n\tReplaceEnum,\r\n\tSaveFlagsEnum,\r\n\tServerPaths\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonDesignerMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport type { IExportDialogParams } from \"common/dialogs/export/export-dialog\";\r\nimport type { IErrorResponse } from \"common/error-response\";\r\nimport { WSForm } from \"etc-assets/user-control-es\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { DesignerHelper } from \"designer/helper\";\r\n\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult,\r\n\tIMessageDialogOptions, IToastOptions, StandardDialogButtons\r\n} from \"common/services/dialog-service\";\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport class ProjectService {\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.WINDOW,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $window: ng.IWindowService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate dialogService: DialogService\r\n\t) { }\r\n\r\n\tcreateProject(project: IJsonDesignerMashup): ng.IPromise<DesignerMashup> {\r\n\r\n\t\tlet saveData;\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tconst id = Helper.generateUniqueId();\r\n\r\n\t\t\tproject.manifest.id = id;\r\n\t\t\tsaveData = { path: id, data: project };\r\n\r\n\t\t} else {\r\n\t\t\tsaveData = project;\r\n\t\t}\r\n\t\treturn this.httpService\r\n\t\t\t.executePost<IJsonDesignerMashup>(ServerPaths.PROJECT, saveData)\r\n\t\t\t.then((project) => {\r\n\t\t\t\tthis.commonService.unloadProject();\r\n\t\t\t\tconst designerMashup = DesignerMashup.fromObj(project);\r\n\t\t\t\tthis.commonService.setCurrentProject(designerMashup, false);\r\n\t\t\t\treturn designerMashup;\r\n\t\t\t});\r\n\t}\r\n\r\n\tduplicate(manifest: IJsonManifest): void {\r\n\t\tthis.commonService.loadProjects().then((projects) => {\r\n\t\t\tconst originProject: IJsonManifest = angular.copy(manifest);\r\n\t\t\tconst options: IDialogOptions<string> = {\r\n\t\t\t\ttitle: \"Duplicate Project\",\r\n\t\t\t\ttemplate: require(\"../dashboard/duplicate-dialog/duplicate-dialog.html\"),\r\n\t\t\t\t// TODO improve name proposal\r\n\t\t\t\tparameter: DesignerHelper.getProposedNewDisplayName(originProject.displayName, projects),\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.duplicateProject(originProject.id, result.value).then((newId: string) => {\r\n\t\t\t\t\t\tthis.commonService.onDuplicateProjectChangedEvent.raise();\r\n\t\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\t\tconst message =\r\n\t\t\t\t\t\t\t`Failed to duplicate project: ${options.parameter}. Reason: ${errorResponse.message}`;\r\n\t\t\t\t\t\tthis.dialogService.showError(\"Operation Failed\", message);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}).catch((error: IErrorResponse) => {\r\n\t\t\tthis.dialogService.showError(\"Did not load projects\", error.message);\r\n\t\t});\r\n\t}\r\n\r\n\tpublish(projectId: string, displayName: string): void {\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: \"Publish Project\",\r\n\t\t\tmessage: \"Make App available for selected users.\",\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo,\r\n\t\t};\r\n\r\n\t\tthis.dialogService.showMessage(options).then((result: IDialogResult<string>) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.addToRuntime(projectId)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tconst options: IToastOptions = {\r\n\t\t\t\t\t\t\ttitle: \"Published\",\r\n\t\t\t\t\t\t\tmessage: \"Successfully published \" + displayName,\r\n\t\t\t\t\t\t\tposition: \"top right\",\r\n\t\t\t\t\t\t\tprogressBar: true,\r\n\t\t\t\t\t\t\ttimeout: 3000\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.dialogService.showToast(options);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\t\tthis.dialogService.showError(\"Unsuccessful Publish\", errorResponse.message);\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tlaunchProject(projectId: string): void {\r\n\t\tDesignerHelper.openRuntime(projectId, this.$window);\r\n\t}\r\n\r\n\trenameProject(id: string, newDisplayName: string): ng.IPromise<string> {\r\n\t\treturn this.httpService.executePost(ServerPaths.PROJECT + \"rename/\" + id, newDisplayName);\r\n\t}\r\n\r\n\tdeleteByIds(projectIds: string[]): ng.IPromise<void> {\r\n\t\treturn this.httpService.executeDelete(ServerPaths.PROJECT + \"dashboard/\", projectIds).then(() => {\r\n\t\t\tconst currentProject = this.commonService.getCurrentProject();\r\n\t\t\tif (currentProject) {\r\n\t\t\t\tconst unloadCurrentProject = projectIds.find((projectId) => {\r\n\t\t\t\t\treturn projectId === currentProject.getId();\r\n\t\t\t\t});\r\n\t\t\t\tif (unloadCurrentProject) {\r\n\t\t\t\t\tthis.commonService.unloadProject();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tdeleteById(projectId: string): ng.IPromise<void> {\r\n\t\treturn this.httpService.executeDelete(ServerPaths.PROJECT + projectId).then(() => {\r\n\t\t\tconst currentProject = this.commonService.getCurrentProject();\r\n\t\t\tif (currentProject && currentProject.getId() === projectId) {\r\n\t\t\t\tthis.commonService.unloadProject();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\texport(projectId: string, displayName: string): void {\r\n\t\tif (Config.MG_PLATFORM === MGPlatform.WEB) {\r\n\t\t\tconst options: IDialogOptions<IExportDialogParams> = {\r\n\t\t\t\ttitle: \"Export Project\",\r\n\t\t\t\ttemplate: require(\"common/dialogs/export/export-dialog.html\"),\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\ttype: \"project\",\r\n\t\t\t\t\tfilename: displayName,\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.exportProject(projectId, result.value);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else { // MG_PLATFORM === WinStudio\r\n\t\t\tWSForm.call({\r\n\t\t\t\tname: ABFormScriptMethod.SHOW_SAVE_FILE_DIALOG,\r\n\t\t\t\tparameters: [\r\n\t\t\t\t\t`${displayName}.iap`, // Filename\r\n\t\t\t\t\t\"Export Filename\",  // Caption\r\n\t\t\t\t\t\"AppBuilder Project (*.iap)|*.iap\" // Filter\r\n\t\t\t\t],\r\n\t\t\t\tonCompleted: filePath => {\r\n\t\t\t\t\tthis.exportProject(projectId, filePath);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate exportProject(exportProjectId: string, exportFileName: string): void {\r\n\t\tconst resourceName = ServerPaths.PROJECT + exportProjectId + \"/export/\";\r\n\t\tthis.httpService.executeGet<{ base64: string, filename: string }>(\r\n\t\t\tresourceName, exportFileName)\r\n\t\t\t.then((exportResult: { base64: string, filename: string }) => {\r\n\t\t\t\tif (Config.MG_PLATFORM === MGPlatform.WEB) {\r\n\t\t\t\t\tconst blob = Helper.convertBase64ToSaveableBlob(\r\n\t\t\t\t\t\texportResult.base64, { type: \"application/zip\" });\r\n\r\n\t\t\t\t\tblob.saveAs(exportResult.filename);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\timportProject(\r\n\t\tprojectFilePath: string,\r\n\t\treplace: ReplaceEnum,\r\n\t\tnewName: string = null\r\n\t): ng.IPromise<IJsonDesignerMashup> {\r\n\t\tconst url = ServerPaths.PROJECT + \"import/\" + replace;\r\n\t\tconst data = { newDisplayName: newName, filePath: projectFilePath };\r\n\t\treturn this.httpService.executePost<IJsonDesignerMashup>(url, data);\r\n\t}\r\n\r\n\texportProjectContent(\r\n\t\tprojectId: string,\r\n\t\tcontentIds: string[],\r\n\t\tfilePath: string,\r\n\t\tsaveFlagEnum: SaveFlagsEnum\r\n\t): void {\r\n\t\tthis.commonService.exportProjectContent(\r\n\t\t\tcontentIds, filePath, saveFlagEnum, projectId);\r\n\t}\r\n\r\n\tcopyToForm(projectId: string, formName: string): ng.IPromise<void> {\r\n\t\tconst url = ServerPaths.PROJECT + projectId + \"/form/\";\r\n\t\treturn this.httpService.executePost<void>(url, formName);\r\n\t}\r\n\r\n\tprivate duplicateProject(originProjectId: string, newDisplayName: string): ng.IPromise<string> {\r\n\t\treturn this.httpService.executePost(ServerPaths.PROJECT + \"duplicate/\" + originProjectId, newDisplayName);\r\n\t}\r\n\r\n\tprivate addToRuntime(projectId: string): ng.IPromise<string> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.PROJECT + projectId + \"/publish/\" + 0);\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.PROJECT_SERVICE, ProjectService);\r\n\t}\r\n}\r\n","import {\tInjectNames, InteractionActionEnum, InteractionTriggerEnum, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonInteraction, IJsonInteractionParameter } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\nimport { InstanceEvent } from \"../../../common/instance-event\";\r\nimport { Component } from \"../../../components/component\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nimport { Helper } from \"../../../common/helper\";\r\nimport { DialogService, IDialogOptions } from \"../../../common/services/dialog-service\";\r\nimport { ComponentsHelper } from \"../../../components/helper\";\r\nimport { FrameworkService } from \"../../../components/services/framework-service\";\r\nimport { EditorService } from \"./editor-service\";\r\n\r\nexport class InteractionManagementService {\r\n\tprojectInteractionsChanged = new InstanceEvent<Interaction[]>();\r\n\tprivate isActive: boolean;\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t}\r\n\r\n\trunStartupInteractions(): void {\r\n\t\tthis.frameworkService.runStartupInteractions();\r\n\t}\r\n\r\n\tstartInteractionWizard(component: IEditorComponent): void {\r\n\t\tif (!this.isActive) {\r\n\t\t\tthis.isActive = true;\r\n\t\t\tconst options: IDialogOptions<IEditorComponent> = {\r\n\t\t\t\ttitle: \"Create Interaction\",\r\n\t\t\t\tparameter: component,\r\n\t\t\t\ttemplate: require(\"../component-settings/interaction/interaction-wizard.html\"),\r\n\t\t\t\tcssClass: \"interaction-wizard-dialog\",\r\n\t\t\t\tstyle: \"min-width: 450px; min-height: 595px; max-width: 450px;\",\r\n\t\t\t\thideOverlay: true,\r\n\t\t\t\tdraggable: true,\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.show(options).finally(() => {\r\n\t\t\t\tthis.isActive = false;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\trunInteraction(interaction: Interaction): void {\r\n\t\tthis.frameworkService.runInteraction(interaction);\r\n\t}\r\n\r\n\trunStartupOnComponent(component: IJsonComponent): void {\r\n\t\tconst componentInstance = this.editorService.getComponentInstanceById(component.id);\r\n\r\n\t\tthis.editorService.getCurrentProject().getInteractions().filter((ev) => {\r\n\t\t\tif (ev.targetName === componentInstance.getId() && ev.sourceTriggerName === InteractionTriggerEnum.STARTUP) {\r\n\t\t\t\tcomponentInstance.loadInteraction(ev);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\r\n\ttrigger(source: Component, triggerName: string): void {\r\n\t\tthis.editorService.getCurrentProject().getInteractions().forEach((interaction) => {\r\n\t\t\tif (interaction.sourceName === source.getId() && interaction.sourceTriggerName === triggerName) {\r\n\t\t\t\tthis.frameworkService.runInteraction(interaction);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tcreateNew(sourceComponent?: IEditorComponent, targetComponent?: IEditorComponent): Interaction {\r\n\t\tconst id = this.generateInteractionId();\r\n\t\tconst interaction = new Interaction({ id: id } as any);\r\n\t\tif (sourceComponent) {\r\n\t\t\tinteraction.sourceName = sourceComponent.getId();\r\n\t\t\tinteraction.sourceTriggerName = sourceComponent.getDefaultTrigger().value;\r\n\t\t}\r\n\t\tif (targetComponent) {\r\n\t\t\tinteraction.targetName = targetComponent.getId();\r\n\t\t\tinteraction.targetActionName = targetComponent.getDefaultAction().value;\r\n\t\t}\r\n\t\tinteraction.displayName = this.getInteractionDisplayName(interaction);\r\n\t\tthis.editorService.getCurrentProject().addInteraction(interaction);\r\n\t\tthis.projectInteractionsChanged.raise(this.editorService.getCurrentProject().getInteractions());\r\n\t\treturn interaction;\r\n\t}\r\n\r\n\tgenerateInteractionId(): string {\r\n\t\tconst interactions = this.editorService.getCurrentProject().getInteractions();\r\n\r\n\t\t// List of interaction id\r\n\t\tlet interactionIds: string[] = interactions.map((interaction: Interaction) => {\r\n\t\t\treturn interaction.getId();\r\n\t\t});\r\n\r\n\t\t// Deleted componenents still has interactions sometimes\r\n\t\tinteractionIds = interactionIds.filter((interactionId) => {\r\n\t\t\treturn interactionId;\r\n\t\t});\r\n\r\n\t\tconst newId: number = ComponentsHelper.nextNumber(interactionIds);\r\n\t\treturn \"Interaction\" + newId;\r\n\t}\r\n\r\n\tremoveInteraction(interaction: Interaction): void {\r\n\t\tthis.editorService.getCurrentProject().removeInteraction(interaction);\r\n\t\tthis.resetErrorTooltip(interaction.sourceName);\r\n\t\tthis.resetErrorTooltip(interaction.targetName);\r\n\t\tthis.projectInteractionsChanged.raise(this.editorService.getCurrentProject().getInteractions());\r\n\t}\r\n\r\n\tcreateNewOnTheFly(targetActionName: string, parameters?: IMap<any>): Interaction {\r\n\t\tconst jsonInteraction: IJsonInteraction = {\r\n\t\t\tid: \"Ontheflyevent\",\r\n\t\t\tsourceName: \"<onTheFly>\",\r\n\t\t\tsourceTriggerName: \"\",\r\n\t\t\ttargetName: \"\",\r\n\t\t\ttargetActionName: targetActionName,\r\n\t\t\tparameters: []\r\n\t\t};\r\n\t\tif (parameters) {\r\n\t\t\tfor (const key in parameters) {\r\n\t\t\t\tconst parameter: IJsonInteractionParameter = {\r\n\t\t\t\t\ttargetKey: key,\r\n\t\t\t\t\tvalueSource: { Type: BindingTypeEnum.STATIC_VALUE, value: parameters[key] }\r\n\t\t\t\t};\r\n\t\t\t\tjsonInteraction.parameters.push(parameter);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Interaction(jsonInteraction);\r\n\t}\r\n\r\n\tupdateAndSaveParameters(sourceKey: string, value: string): void {\r\n\t\tconst urlInteractions = this.getAllInteractionsWithUrlParameter(sourceKey);\r\n\t\turlInteractions.forEach((interaction) => {\r\n\t\t\tinteraction.getParameters().forEach((parameter) => {\r\n\t\t\t\tif (parameter.valueSource.Type === BindingTypeEnum.URL_BINDING) {\r\n\t\t\t\t\tparameter.valueSource.value = value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\tif (urlInteractions.length > 0) {\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t\t}\r\n\t}\r\n\r\n\tgetInteractionsWithTarget(component: IEditorComponent): Interaction[] {\r\n\t\tconst interactions = this.editorService.getCurrentProject().getInteractions();\r\n\t\tconst filteredInteractions = interactions.filter((interaction) => {\r\n\t\t\treturn interaction.targetName === component.getId();\r\n\t\t});\r\n\r\n\t\treturn filteredInteractions;\r\n\t}\r\n\r\n\t//TODO: Clean up this code to make it more readable.\r\n\tgetInteractionDisplayName(interaction: Interaction): string {\r\n\t\tconst selectedComponent = this.editorService.getSelectedComponent();\r\n\t\tconst sourceComponent = this.editorService.getComponentInstanceById(interaction.sourceName);\r\n\t\tconst targetComponent = this.editorService.getComponentInstanceById(interaction.targetName);\r\n\t\tlet triggerName: string = \"\";\r\n\t\tlet actionName: string = \"\";\r\n\t\tlet displayName: string = \"\";\r\n\r\n\t\tif (sourceComponent) {\r\n\t\t\tconst sourceTrigger = sourceComponent.getSourceTriggers().filter((sourceTrigger) => {\r\n\t\t\t\treturn sourceTrigger.value === interaction.sourceTriggerName;\r\n\t\t\t});\r\n\t\t\tif (sourceTrigger.length) {\r\n\t\t\t\ttriggerName = sourceTrigger[0].name; //get displayname instead of value.\r\n\t\t\t} else {\r\n\t\t\t\tconst errorMessage = `[${((this as any).constructor.name)}]\r\n\t\t\t\t\tCould not find display for interaction with source trigger name '${interaction.sourceTriggerName}'`;\r\n\r\n\t\t\t\tconsole.error(Helper.cleanTemplateLiteral(errorMessage));\r\n\t\t\t}\r\n\t\t\tdisplayName += (interaction.sourceName === selectedComponent.getId() ? \"this\" : sourceComponent.getDisplayName());\r\n\t\t} else {\r\n\t\t\t// TODO: Add warning for nonexisting component\r\n\t\t\ttriggerName = this.editorService.getApplicationParent().getDefaultTrigger().name;\r\n\t\t\tdisplayName += interaction.sourceName;\r\n\t\t\tdisplayName = Helper.htmlEncode(displayName);\r\n\t\t}\r\n\t\tdisplayName += \".\" + (triggerName || \"\");\r\n\t\tdisplayName += \" -> \";\r\n\t\tif (targetComponent) {\r\n\t\t\tactionName = this.getActionName(targetComponent, interaction);\r\n\t\t\tdisplayName += Helper.htmlEncode(\r\n\t\t\t\t(interaction.targetName === selectedComponent.getId() ? \"this\" : targetComponent.getDisplayName()));\r\n\t\t} else {\r\n\t\t\t// TODO: Add warning for nonexisting component\r\n\t\t\tdisplayName += interaction.targetName;\r\n\t\t}\r\n\t\tdisplayName += \".\" + (actionName || \"\");\r\n\r\n\t\treturn displayName;\r\n\t}\r\n\r\n\tprivate getAllInteractionsWithUrlParameter(urlVariableName: string): Interaction[] {\r\n\t\tconst interactions = this.editorService.getCurrentProject().getInteractions();\r\n\t\tconst filteredInteractions = interactions.filter((interaction) => {\r\n\t\t\treturn interaction.getParameters().find((parameter) => {\r\n\t\t\t\treturn parameter.valueSource.Type === BindingTypeEnum.URL_BINDING &&\r\n\t\t\t\t\tparameter.valueSource.sourceKey === urlVariableName;\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn filteredInteractions;\r\n\t}\r\n\r\n\tprivate getActionName(component: IEditorComponent, interaction: IInteraction): string {\r\n\t\tlet actionName = \"\";\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.LIST ||\r\n\t\t\tinteraction.targetActionName === InteractionActionEnum.GET) {\r\n\t\t\tactionName = component.datasource ? \"Run \" + component.datasource.displayName : \"\";\r\n\t\t} else {\r\n\t\t\tactionName = interaction.targetActionName;\r\n\t\t}\r\n\r\n\t\treturn actionName;\r\n\t}\r\n\r\n\tprivate resetErrorTooltip(componentName: string): void {\r\n\t\tconst component = this.frameworkService.getComponentInstance(componentName);\r\n\t\tif (component) {\r\n\t\t\tcomponent.setErrorTooltip();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.INTERACTION_MANAGEMENT_SERVICE, InteractionManagementService);\r\n\t}\r\n}\r\n","import { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nexport interface IParameterObject {\r\n\tid: string;\r\n\tkey: string;\r\n\tvalueType: ValueTypeEnum;\r\n\tparameterType: ParameterTypeEnum;\r\n\trequired: boolean;\r\n\talias: string;\r\n\tdataType?: string;\r\n}\r\n\r\nexport interface ILocalIdoParameterObject extends IParameterObject {\r\n}","import { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport interface IJsonInteraction {\r\n\tid: string;\r\n\tsourceName: string;\r\n\tsourceTriggerName: string;\r\n\ttargetName: string;\r\n\ttargetActionName: string;\r\n\r\n\tparameters: IJsonInteractionParameter[];\r\n}\r\n\r\nexport interface IJsonInteractionParameter {\r\n\ttargetKey: string;\r\n\tvalueSource: IJsonValueSource;\r\n}\r\n","import type { ISourceItem } from \"common/model/component/hyperlink.model\";\r\nimport { IJsonPersistentComponent } from \"ng2/common/model/databearer/components/base/json-persistent-components.model\";\r\nimport type { IJsonComponent, IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDataGridColumn, ISortOrderSetting } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nexport interface IPreviousAttributes {\r\n\trow: number;\r\n\tactivePage: number;\r\n\tsortOrder: ISortOrderSetting;\r\n}\r\n\r\n//#region saved data\r\nexport interface IJsonDatagrid extends IJsonComponent, IJsonPersistentComponent {\r\n\tisList: boolean;\r\n\tusePaging: boolean;\r\n\tpageSize?: number;\r\n\tcolumns: IExtendedDataGridColumn[];\r\n\tboundarySettings: IMap<IJsonDatagridSettings>;\r\n\tshowLabel: boolean; // Deprecated\r\n\tlabel: IJsonValueSource;\r\n\trowCount: boolean;\r\n\tfilterBar: boolean;\r\n\tenableExport: boolean;\r\n\tmultiSelect: boolean;\r\n}\r\n\r\nexport interface IJsonDatagridSettings extends IJsonComponentSettings {\r\n\trowHeight: string;\r\n\tshowLabel: boolean;\r\n}\r\n\r\nexport interface IExtendedDataGridColumn extends IDataGridColumn {\r\n\teditable?: boolean;\r\n\tformatterName?: string;\r\n\tlistOptions?: IColumnListOptions;\r\n\thyperlinkOptions?: IColumnHyperlinkOptions;\r\n\tsummarize?: boolean;\r\n\tsummaryText?: string;\r\n\tsummaryTextPlacement?: string;\r\n\tsubstitute?: boolean;\r\n\tsubstituteOptions?: IColumnSubstituteOptions;\r\n\talign?: string;\r\n\tvalue?: string; //TODO move value MUPS-3016\r\n}\r\n\r\nexport interface IColumnListOptions {\r\n\tsourceId: string;\r\n\tparameterId: string;\r\n}\r\n\r\nexport interface IColumnSubstituteOptions {\r\n\tsource: string;\r\n\tfrom: string;\r\n\tto: string;\r\n}\r\n\r\nexport interface IColumnHyperlinkOptions {\r\n\tvalue: string;\r\n\tisDrillback: boolean;\r\n\tsources?: ISourceItem[];\r\n}\r\n\r\n//#endregion\r\n","import { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nexport interface IJsonLayoutComponent extends IJsonComponent {\r\n\tchildren?: IJsonComponent[];\r\n}\r\n","import { ProjectTypeEnum, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nexport interface IJsonManifest {\r\n\tcreatedBy: string;\r\n\tcreatedByDisplayName: string;\r\n\tcreatedTime: number;\r\n\tdescription: string;\r\n\tdisplayName: string;\r\n\tid: string;\r\n\tlastChangedBy: string;\r\n\tlastChangedByDisplayName: string;\r\n\tlastChangedTime: number;\r\n\tmashupBoundaries: IBoundary[];\r\n\turlVariables: IJsonUrlVariable[];\r\n\ttitle: string;\r\n\tversion: string;\r\n\tpreviewImg: string;\r\n\tshowTitleBar: boolean;\r\n\tthemeSwitchEnabled: boolean;\r\n\tdefaultTheme: ThemeEnum;\r\n}\r\n\r\nexport interface IJsonRuntimeManifest extends IJsonManifest {\r\n\turlName: string;\r\n\tstatus: number;\r\n}\r\n\r\nexport interface IJsonDesignerManifest extends IJsonManifest {\r\n\tfileMetaData: IMap<IJsonFileMetaData>;\r\n\ttypeDef: ProjectTypeEnum;\r\n}\r\n\r\nexport interface IJsonFileMetaData {\r\n\tmimeType: string;\r\n\tvisibleName: string;\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport {\r\n\tIComponentStyle\r\n} from \"../common/defines\";\r\nimport { IComponent } from \"../common/IComponent\";\r\n\r\nimport { Config, InteractionPairOperation, SettingKeys, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IJsonComponent, IJsonComponentSettings, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\nimport { IComponentScope } from \"../common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\nimport { Component } from \"./component\";\r\nimport { LayoutComponent } from \"./layout-component\";\r\nimport { FrameworkService } from \"./services/framework-service\";\r\n\r\nexport class ApplicationParent extends LayoutComponent {\r\n\tpublic static applicationParentDatabearer: IJsonComponent = {\r\n\t\ttypedef: \"ApplicationParent\",\r\n\t\tid: \"Application\",\r\n\t\tdisplayName: \"Application\",\r\n\t\tisReadonly: false,\r\n\t\tboundarySettings: {} as IMap<IJsonComponentSettings>\r\n\t};\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Locale\",\r\n\t\tref: SettingKeys.LANGUAGE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Language Code\",\r\n\t\tref: SettingKeys.LANGUAGE_SHORT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"User Name\",\r\n\t\tref: SettingKeys.USER_NAME,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"User Description\",\r\n\t\tref: SettingKeys.USER_DESCRIPTION,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Current Timestamp\",\r\n\t\tref: SettingKeys.TIMESTAMP,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_STARTUP;\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.NONE;\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] = [InteractionPairOperation.ON_STARTUP];\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.NONE];\r\n\r\n\tpublic currentTheme: ThemeEnum = 1;\r\n\tpublic language: string;\r\n\tpublic languageShort: string;\r\n\tpublic userName: string;\r\n\tpublic userDescription: string;\r\n\tpublic timestamp: number;\r\n\tprotected databearer: IJsonComponent;\r\n\r\n\tprivate manifest: IDesignerManifest;\r\n\r\n\tconstructor(\r\n\t\tdatabearer: IJsonComponent,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService) {\r\n\t\tsuper(databearer, element, parent, frameworkService);\r\n\r\n\t\tthis.manifest = frameworkService.getCurrentProject().getManifest();\r\n\t\tthis.language = frameworkService.getCurrentLanguage();\r\n\t\tif (this.language) {\r\n\t\t\t// tslint:disable-next-line:no-magic-numbers\r\n\t\t\tthis.languageShort = this.language.substr(0, 2);\r\n\t\t}\r\n\t\tthis.userName = Config.USER.name;\r\n\t\tthis.userDescription = Config.USER.displayName;\r\n\t\tthis.timestamp = Date.now();\r\n\t\tthis.getScope().componentInstance = this;\r\n\t}\r\n\r\n\tpublic static createSpoofedElement(scope: IComponentScope): ng.IAugmentedJQuery {\r\n\t\tconst element = angular.element(\"<div></div>\");\r\n\t\telement.data(\"eir-scope\", scope);\r\n\t\treturn element;\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn this.databearer.id;\r\n\t}\r\n\r\n\tpublic addChildInstance(child: IComponent): void {\r\n\t\tthis.children[0] = child;\r\n\t}\r\n\r\n\tpublic resizableChildren(direction: OrientationEnum): boolean {\r\n\t\t// Rootcomponent is never resizeable\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic hasIndividualChildSizes(ori: OrientationEnum): boolean {\r\n\t\tif (this.manifest.showTitleBar) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic getContext(): IContext {\r\n\t\treturn {};\r\n\t}\r\n\r\n\tpublic forEachChild(fn: (ch: Component) => void, doGenerated: boolean): void {\r\n\t\t// forEachChild\r\n\t}\r\n\r\n\tpublic forEachParent(fn: (ch: ILayoutComponent) => void): void {\r\n\t\t// forEachParent\r\n\t}\r\n\r\n\tpublic calcNewSizes(orientation?: OrientationEnum): void {\r\n\t\tif (this.children && this.children.length > 0) {\r\n\t\t\tthis.children[0].calcNewHeight();\r\n\t\t\tthis.children[0].calcNewWidth();\r\n\t\t}\r\n\t}\r\n\r\n\t// Method needed for interface implementation\r\n\tpublic getPxPerPercentComponent(ori: OrientationEnum): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tpublic updateVisibility(): void {\r\n\t\t// Overloading, ApplicationParent is always invisible\r\n\t}\r\n\r\n\tpublic updateShowError(): void {\r\n\t\t// Overloading, ApplicationParent never shows error\r\n\t}\r\n\r\n\tprotected getInlineStyle(): IComponentStyle {\r\n\t\t// Overload, ApplicationParent has no size\r\n\t\treturn {\r\n\t\t\twidth: \"0\",\r\n\t\t\theight: \"0\"\r\n\t\t};\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn console.debug(\"[ApplicationParent] Rootcomponent has no directive\");\r\n\t}];\r\n}","import angular from \"angular\";\r\n\r\nimport {\r\n\tAlignmentEnum,\r\n\tComponentSizeTypes,\r\n\tDEFAULT_BOUNDARY,\r\n\tFlexOverflowEnum,\r\n\tFlexSizeTypeEnum,\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBorder, IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport type { IFlexboxStyle } from \"common/defines\";\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { IFlexboxComponent } from \"common/interface/iflexbox-component\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\n\r\nimport { Component } from \"components/component\";\r\nimport { LayoutComponent } from \"components/layout-component\";\r\n\r\nimport { ComponentsHelper } from \"components/helper\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport class Flexbox extends LayoutComponent implements IFlexboxComponent {\r\n\tstatic availableOrientations = [\r\n\t\t{ name: \"Vertical\", value: OrientationEnum.VERTICAL },\r\n\t\t{ name: \"Horizontal\", value: OrientationEnum.HORIZONTAL }\r\n\t];\r\n\tstatic availableHorizontalAlignments: IDataPair[] = [\r\n\t\t{ name: \"Left\", value: AlignmentEnum.FLEX_START },\r\n\t\t{ name: \"Center\", value: AlignmentEnum.CENTER },\r\n\t\t{ name: \"Right\", value: AlignmentEnum.FLEX_END }\r\n\t];\r\n\tstatic availableVerticalAlignments: IDataPair[] = [\r\n\t\t{ name: \"Top\", value: AlignmentEnum.FLEX_START },\r\n\t\t{ name: \"Middle\", value: AlignmentEnum.CENTER },\r\n\t\t{ name: \"Bottom\", value: AlignmentEnum.FLEX_END }\r\n\t];\r\n\tstatic availableFlexSizeTypes: IDataPair[] = [\r\n\t\t{ name: \"Relative\", value: FlexSizeTypeEnum.FLEX },\r\n\t\t{ name: \"Pixel\", value: FlexSizeTypeEnum.PIXELS }\r\n\t];\r\n\tstatic availableOverflows: IDataPair[] = [\r\n\t\t{ name: \"Hidden\", value: FlexOverflowEnum.HIDDEN },\r\n\t\t{ name: \"Wrap\", value: FlexOverflowEnum.WRAP },\r\n\t\t{ name: \"Scroll\", value: FlexOverflowEnum.SCROLL }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [];\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([\r\n\t\t{\r\n\t\t\ttitle: \"Orientation\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.ORIENTATION,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Flexbox.availableOrientations,\r\n\t\t\t\tdefaultValue: OrientationEnum.VERTICAL\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Width\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tcondition: \"parent.orientation === \" + OrientationEnum.HORIZONTAL,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.SIZE_TYPE,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Flexbox.availableFlexSizeTypes,\r\n\t\t\t\tdefaultValue: FlexSizeTypeEnum.FLEX\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Value\",\r\n\t\t\t\tref: SettingKeys.SIZE,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.TEXT,\r\n\t\t\t\tdefaultValue: 1\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Height\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tcondition: \"parent.orientation === \" + OrientationEnum.VERTICAL,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.SIZE_TYPE,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Flexbox.availableFlexSizeTypes,\r\n\t\t\t\tdefaultValue: FlexSizeTypeEnum.FLEX\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Value\",\r\n\t\t\t\tref: SettingKeys.SIZE,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.TEXT,\r\n\t\t\t\tdefaultValue: 1\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Overflow\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.OVERFLOW,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Flexbox.availableOverflows,\r\n\t\t\t\tdefaultValue: FlexOverflowEnum.HIDDEN\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Background Color\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.BACKGROUND_COLOR,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.COLOR_PICKER,\r\n\t\t\t\tdefaultValue: undefined\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Alignment\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Horizontal\",\r\n\t\t\t\t\tref: SettingKeys.ALIGNMENT_HORIZONTAL,\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tdataset: Flexbox.availableHorizontalAlignments,\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: AlignmentEnum.FLEX_START\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Vertical\",\r\n\t\t\t\t\tref: SettingKeys.ALIGNMENT_VERTICAL,\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tdataset: Flexbox.availableVerticalAlignments,\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: AlignmentEnum.FLEX_START\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}, {\r\n\t\t\ttitle: \"Border\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\tref: SettingKeys.BORDER,\r\n\t\t\t\t\tinputType: SettingInputKeys.BORDER,\r\n\t\t\t\t\tdefaultValue: { left: 0, top: 0, right: 0, bottom: 0 }\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Color\",\r\n\t\t\t\t\tref: SettingKeys.BORDER_COLOR,\r\n\t\t\t\t\tinputType: SettingInputKeys.COLOR_PICKER,\r\n\t\t\t\t\tdefaultValue: undefined\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}, {\r\n\t\t\ttitle: \"Padding\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Padding\",\r\n\t\t\t\tref: SettingKeys.MARGIN,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.MARGIN,\r\n\t\t\t\tdefaultValue: { left: 10, top: 10, right: 10, bottom: 10 }\r\n\t\t\t}]\r\n\t\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS.filter((settingCategory) => {\r\n\t\t// Removing settings \"margin\" from Component settings\r\n\t\t// It is replaced by the \"padding\" setting on flexbox\r\n\t\tif (settingCategory.settings.some((setting) => {\r\n\t\t\treturn setting.ref === SettingKeys.MARGIN;\r\n\t\t})) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}));\r\n\r\n\tprivate sizeType: FlexSizeTypeEnum;\r\n\tprivate size: number;\r\n\tprotected backgroundColor: string;\r\n\tborder: IJsonBorder;\r\n\tborderColor: string;\r\n\torientation: OrientationEnum;\r\n\tstyleOptions: IMap<string>;\r\n\tisFlexParent = false;\r\n\tchildrenClasses: string;\r\n\r\n\tprotected databearer: IJsonFlexbox;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonFlexbox,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tif (obj) {\r\n\t\t\tthis.border = obj.border ? obj.border : { left: 0, top: 0, right: 0, bottom: 0 };\r\n\t\t\tthis.borderColor = obj.borderColor;\r\n\t\t}\r\n\t\tthis.updateIsFlexParent();\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonFlexbox {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tupdateIsFlexParent(): void {\r\n\t\tthis.isFlexParent = this.databearer.children.some((child) => {\r\n\t\t\treturn child.typedef === Flexbox.name;\r\n\t\t});\r\n\t}\r\n\r\n\tisParent(): boolean {\r\n\t\treturn this.isFlexParent;\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.children.forEach((component) => {\r\n\t\t\tcomponent.clear();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getAlignment(): IMap<string> {\r\n\t\tconst horizAlignment = this.getBoundarySetting<AlignmentEnum>(SettingKeys.ALIGNMENT_HORIZONTAL);\r\n\t\tconst verticAlignment = this.getBoundarySetting<AlignmentEnum>(SettingKeys.ALIGNMENT_VERTICAL);\r\n\r\n\t\treturn {\r\n\t\t\t\"justify-content\": this.getAlignmentProperty(\r\n\t\t\t\tthis.orientation === OrientationEnum.HORIZONTAL ? horizAlignment : verticAlignment),\r\n\t\t\t\"align-items\": this.getAlignmentProperty(\r\n\t\t\t\tthis.orientation === OrientationEnum.HORIZONTAL ? verticAlignment : horizAlignment)\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getAlignmentProperty(alignment: AlignmentEnum): string {\r\n\t\tlet alignmentProperty: string;\r\n\t\tswitch (alignment) {\r\n\t\t\tcase AlignmentEnum.FLEX_START:\r\n\t\t\t\talignmentProperty = \"flex-start\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase AlignmentEnum.CENTER:\r\n\t\t\t\talignmentProperty = \"center\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase AlignmentEnum.FLEX_END:\r\n\t\t\t\talignmentProperty = \"flex-end\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[Flexbox] Invalid alignment:\" + alignment);\r\n\t\t}\r\n\t\treturn alignmentProperty;\r\n\t}\r\n\r\n\tprotected getInlineStyle(): IFlexboxStyle {\r\n\t\tconst generalComponentStyle = super.getInlineStyle();\r\n\t\t// Try to get backgroundcolor from the new boundary settings. If it doesnt exist,\r\n\t\t// try getting it from the databearer\r\n\t\tconst backgroundColor =\r\n\t\t\tthis.getBoundarySetting<string>(SettingKeys.BACKGROUND_COLOR)\r\n\t\t\t|| this.getDatabearer().backgroundColor;\r\n\r\n\t\tconst style: IFlexboxStyle = {\r\n\t\t\t...generalComponentStyle,\r\n\t\t\tbackgroundColor: backgroundColor === undefined ? \"\" : backgroundColor,\r\n\t\t\tpadding: null,\r\n\t\t\t// Width and height have default values in flexbox.less\r\n\t\t\twidth: \"\",\r\n\t\t\theight: \"\",\r\n\t\t};\r\n\r\n\t\tif (this.sizeType === FlexSizeTypeEnum.PIXELS) {\r\n\t\t\tconst value = this.size + \"px\";\r\n\t\t\tstyle.flexGrow = 0;\r\n\t\t\tstyle.flexShrink = 0;\r\n\t\t\tstyle.flexBasis = value;\r\n\t\t} else {\r\n\t\t\tstyle.flexShrink = 1;\r\n\t\t\tstyle.flexBasis = \"auto\";\r\n\t\t\tstyle.flexGrow = this.size;\r\n\t\t}\r\n\r\n\t\treturn style;\r\n\t}\r\n\r\n\tprotected getClassList(): string[] {\r\n\t\tconst wrapClass = \"overflowWrap\";\r\n\t\tconst scrollClass = \"overflowScroll\";\r\n\t\tconst classes = super.getClassList();\r\n\t\tconst overflow = this.getBoundarySetting<FlexOverflowEnum>(SettingKeys.OVERFLOW);\r\n\r\n\t\tswitch (overflow) {\r\n\t\t\tcase FlexOverflowEnum.WRAP:\r\n\t\t\t\tclasses.push(wrapClass);\r\n\t\t\t\tbreak;\r\n\t\t\tcase FlexOverflowEnum.SCROLL:\r\n\t\t\t\tclasses.push(scrollClass);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// No class needed\r\n\t\t}\r\n\t\treturn classes;\r\n\t}\r\n\r\n\tupdateChildrenClasses(): string {\r\n\t\tconst childrenHasPercentSizes = this.databearer.children.some((child) => {\r\n\t\t\treturn child.boundarySettings[DEFAULT_BOUNDARY.id].width.sizeType === SizeTypeEnum.PERCENT;\r\n\t\t});\r\n\t\tthis.childrenClasses = childrenHasPercentSizes ? ComponentSizeTypes.LARGE : ComponentSizeTypes.SMALL;\r\n\t\treturn this.childrenClasses;\r\n\t}\r\n\r\n\tresizableChildren(_ori: OrientationEnum): boolean { return false; }\r\n\r\n\tgetPxPerPercentComponent(ori: OrientationEnum, _percent: number): number {\r\n\t\tlet pixels = 0;\r\n\t\t// Only calculate for vertical (height) since flexbox doesn't allow content to be placed horizontally yet.\r\n\t\tif (ori === OrientationEnum.VERTICAL) {\r\n\t\t\tthis.children.forEach((child: IComponent) => {\r\n\t\t\t\tif (child.getBoundarySetting<boolean>(SettingKeys.VISIBILITY) &&\r\n\t\t\t\t\tchild.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT).sizeType === SizeTypeEnum.AUTO) {\r\n\t\t\t\t\tpixels += child.element.outerHeight(true);\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t}\r\n\t\treturn pixels;\r\n\t}\r\n\r\n\thasIndividualChildSizes(_ori: OrientationEnum): boolean { return true; }\r\n\r\n\tupdateClassesAndStyle(): void {\r\n\t\tconst boundaryId = this.frameworkService.getCurrentBoundary().id;\r\n\t\tthis.orientation = this.getOrientationSetting(boundaryId);\r\n\r\n\t\tthis.sizeType = this.getBoundarySetting<FlexSizeTypeEnum>(SettingKeys.SIZE_TYPE, boundaryId);\r\n\t\tthis.size = this.getBoundarySetting<number>(SettingKeys.SIZE, boundaryId);\r\n\r\n\t\tthis.styleOptions = angular.extend({}, this.getAlignment(), this.getPadding(), this.getBorder());\r\n\t\tthis.updateChildrenClasses();\r\n\r\n\t\tsuper.updateClassesAndStyle();\r\n\t}\r\n\r\n\tprivate getBorder(): IMap<string> {\r\n\t\tconst borderColor = this.borderColor ? this.borderColor : \"transparent\";\r\n\t\tconst border: IMap<string> = {\r\n\t\t\t\"border-top\": this.border?.top + \"px solid \" + borderColor,\r\n\t\t\t\"border-bottom\": this.border?.bottom + \"px solid \" + borderColor,\r\n\t\t\t\"border-right\": this.border?.right + \"px solid \" + borderColor,\r\n\t\t\t\"border-left\": this.border?.left + \"px solid \" + borderColor\r\n\t\t};\r\n\t\treturn border;\r\n\t}\r\n\r\n\tprivate getOrientationSetting(boundaryId: string): OrientationEnum {\r\n\t\tlet orientation = this.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, boundaryId);\r\n\t\tif (!orientation) {\r\n\t\t\torientation = ComponentsHelper.getDefaultComponentSettingValue<OrientationEnum>(\r\n\t\t\t\tFlexbox.SETTING_FIELDS, SettingKeys.ORIENTATION, \"Orientation\");\r\n\t\t}\r\n\t\treturn orientation;\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./flexbox.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import angular, { IPromise } from \"angular\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\n\r\nimport { InjectNames, Numbers } from \"ng2/common/constants/common.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\n\r\nimport { HttpService } from \"../../common/services/http-service\";\r\nimport { IonApiService } from \"../../components/services/ion-api-service\";\r\nimport { LocalIdoService } from \"../../components/services/local-ido-service\";\r\n\r\nimport { HttpAcceptEnum } from \"ng2/common/enums/http-accept-enum\";\r\nimport {\r\n\tIHttpHeader, IJsonDatasource, IJsonGenericDatasource2,\r\n\tIJsonInlineListDatasource, IJsonLocalIdoDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IIonApiRequestOptions } from \"ng2/common/model/ion-api/ion-api.model\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { ErrorResponse } from \"../../common/error-response\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { Generic2 } from \"../../common/project/datasource/generic2\";\r\nimport { InlineList } from \"../../common/project/datasource/inline-list\";\r\nimport { LocalIdo } from \"../../common/project/datasource/local-ido\";\r\nimport { Mongoose } from \"../../common/project/datasource/mongoose\";\r\n\r\nexport class DatasourceService {\r\n\tpublic cache: ng.ICacheObject;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.ION_API_SERVICE,\r\n\t\tInjectNames.LOCAL_IDO_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $cacheFactory: ng.ICacheFactoryService,\r\n\t\tpublic $q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate ionApiService: IonApiService,\r\n\t\tprivate localIdoService: LocalIdoService\r\n\t) {\r\n\t\tthis.cache = this.$cacheFactory(\"DatasourceService\");\r\n\t}\r\n\r\n\tpublic getDeferred<T>(): ng.IDeferred<T> {\r\n\t\treturn this.$q.defer<T>();\r\n\t}\r\n\r\n\tpublic localIdoRequest(\r\n\t\tdatasource: IJsonLocalIdoDatasource,\r\n\t\tinputParameterValues?: IMap<any>\r\n\t): ng.IPromise<any> {\r\n\r\n\t\tswitch (datasource.method) {\r\n\r\n\t\t\tcase HttpVerbEnum.PUT:\r\n\t\t\t\treturn this.localIdoService.updateIdoCollectionEntry(datasource, inputParameterValues);\r\n\t\t\tcase HttpVerbEnum.POST:\r\n\t\t\t\treturn this.localIdoService.insertIdoCollectionEntry(datasource, inputParameterValues);\r\n\t\t\tcase HttpVerbEnum.DELETE:\r\n\t\t\t\treturn this.localIdoService.deleteIdoCollectionEntry(datasource, inputParameterValues);\r\n\t\t\tcase HttpVerbEnum.GET:\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.localIdoService.getIdoCollection(datasource, inputParameterValues);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic ionApiRequest(\r\n\t\turlPath: string,\r\n\t\tisBinaryResponse: boolean = false,\r\n\t\tmethod: HttpVerbEnum = HttpVerbEnum.GET,\r\n\t\tdata: string = null,\r\n\t\theaders: IHttpHeader = {}\r\n\t): Promise<any> {\r\n\t\tconst def: ng.IDeferred<any> = this.$q.defer();\r\n\r\n\t\theaders = BackwardCompatible\r\n\t\t\t.setDataServiceHeader(headers);\r\n\r\n\t\tconst options: IIonApiRequestOptions = {\r\n\t\t\turl: urlPath,\r\n\t\t\tmethod,\r\n\t\t\theaders: angular.copy(headers),\r\n\t\t};\r\n\r\n\t\tif (isBinaryResponse) {\r\n\t\t\toptions.responseType = \"blob\";\r\n\t\t} else if (isUndefined(options.headers.Accept)) {\r\n\t\t\toptions.headers.Accept = HttpAcceptEnum.ALL;\r\n\t\t}\r\n\r\n\t\tif (method !== HttpVerbEnum.GET) {\r\n\t\t\toptions.data = data;\r\n\t\t}\r\n\t\tthis.ionApiService.executeIonApiAsync(options).then(response => {\r\n\t\t\tthis.ionApiResponse(def, response.data, isBinaryResponse);\r\n\t\t}).catch((response: ng.IHttpPromiseCallbackArg<any>) => {\r\n\t\t\tlet error: ErrorResponse;\r\n\r\n\t\t\tif (isBinaryResponse) {\r\n\t\t\t\t// Convert binary to text\r\n\t\t\t\tconst fr = new FileReader();\r\n\t\t\t\tfr.readAsText(response.data);\r\n\t\t\t\tfr.onloadend = () => {\r\n\t\t\t\t\tlet data = fr.result as string;\r\n\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tdata = JSON.parse(data);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresponse.data = data;\r\n\t\t\t\t\terror = this.ionApiResponseError(response);\r\n\t\t\t\t\tdef.reject(error);\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\terror = this.ionApiResponseError(response);\r\n\t\t\t\tdef.reject(error);\r\n\t\t\t}\r\n\t\t}).catch(error => def.reject(error));\r\n\r\n\t\treturn def.promise as Promise<any>;\r\n\t}\r\n\r\n\tprivate ionApiResponseError(response: ng.IHttpPromiseCallbackArg<any>): ErrorResponse {\r\n\t\tlet errorMessage: string = \"\";\r\n\r\n\t\tif (response.data && response.data.error && response.data.error.message) {\r\n\t\t\t// High likely to be error message from ION API\r\n\t\t\tif (response.data.source) {\r\n\t\t\t\terrorMessage += \"Source: \" + response.data.source + \"; \";\r\n\t\t\t}\r\n\r\n\t\t\terrorMessage += response.data.error.message;\r\n\t\t} else if (Numbers.FOUR_HUNDRED <= response.status && response.status < Numbers.SIX_HUNDRED) {\r\n\t\t\terrorMessage = response.status + \" \" + response.statusText;\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[Datasource service] Unknown ionApiRequest error\", response);\r\n\t\t\terrorMessage += \"[Datasource service] Unknown ionApiRequest error\";\r\n\t\t}\r\n\r\n\t\tconst error: ErrorResponse = new ErrorResponse(errorMessage, response.status);\r\n\t\treturn error;\r\n\t}\r\n\r\n\tprivate ionApiResponse(def: ng.IDeferred<any>, data: any, isBinary: boolean = false): void {\r\n\t\tif (isBinary) {\r\n\t\t\t// Reading response as dataURL to prevent tainting of canvas for html2canvas-library\r\n\t\t\tconst fr = new FileReader();\r\n\t\t\tfr.readAsDataURL(data);\r\n\t\t\tfr.onloadend = () => {\r\n\t\t\t\tdef.resolve(fr.result);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tdef.resolve(data);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic parseDatasourceToTS(datasourceDatabearer: IJsonDatasource): IDatasource {\r\n\t\t// Only accept generic version 2\r\n\t\tconst version: number = 2;\r\n\t\tconst isCorrectVersion = datasourceDatabearer.version === version;\r\n\r\n\t\tif (isCorrectVersion) {\r\n\t\t\tconst generic2Databearer =\r\n\t\t\t\tdatasourceDatabearer as IJsonGenericDatasource2;\r\n\r\n\t\t\tswitch (datasourceDatabearer.typedef) {\r\n\t\t\t\tcase DatasourceTypeEnum.generic:\r\n\t\t\t\t\treturn new Generic2(generic2Databearer, this);\r\n\t\t\t\tcase DatasourceTypeEnum.MONGOOSE:\r\n\t\t\t\t\treturn new Mongoose(generic2Databearer, this);\r\n\t\t\t\tcase DatasourceTypeEnum.IDO:\r\n\t\t\t\t\treturn new LocalIdo(\r\n\t\t\t\t\t\tdatasourceDatabearer as IJsonGenericDatasource2, this);\r\n\t\t\t\tcase DatasourceTypeEnum.INLINE_LIST:\r\n\t\t\t\t\treturn new InlineList(\r\n\t\t\t\t\t\tdatasourceDatabearer as IJsonInlineListDatasource, this);\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow Error(`Dataservice of type '${datasourceDatabearer.typedef}' is not supported`);\r\n\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[Helper] Invalid typedef on \", datasourceDatabearer);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.DATASOURCE_SERVICE, DatasourceService);\r\n\t}\r\n}\r\n","import { InjectNames, SaveFlagsEnum, ServerPaths } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport type { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport type { IExportDialogParams } from \"common/dialogs/export/export-dialog\";\r\nimport { ErrorResponse } from \"common/error-response\";\r\nimport { CollectionData } from \"designer/repository/ido/collection-data\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"common/services/dialog-service\";\r\nimport { HttpService } from \"common/services/http-service\";\r\nimport { IdoCollection, IdoProperty, LocalIdoService } from \"components/services/local-ido-service\";\r\n\r\nexport class RepositoryService {\r\n\tcacheData: any[] = [];\r\n\tcacheDatasources: IJsonDatasource[] = [];\r\n\tcacheComposites: IJsonCompositeComponent[] = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.WINDOW,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.LOCAL_IDO_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate $window: ng.IWindowService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate localIdoService: LocalIdoService, // todo move this service out from 'cp' scope\r\n\t) {\r\n\t}\r\n\r\n\t//#region Data Service Methods\r\n\tgetDatasources(): ng.IPromise<IJsonDatasource[]> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.REPOSITORY + ServerPaths.DATASOURCES)\r\n\t\t\t.then((responseData: IJsonDatasource[]) => {\r\n\t\t\t\tthis.cacheDatasources = [];\r\n\t\t\t\tthis.cacheDatasources = responseData;\r\n\t\t\t\treturn this.cacheDatasources;\r\n\t\t\t});\r\n\t}\r\n\r\n\taddDatasources(datasources: IJsonDatasource[]): ng.IPromise<IJsonDatasource[]> {\r\n\r\n\t\tconst path = ServerPaths.REPOSITORY + ServerPaths.DATASOURCES;\r\n\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tconst devDatasources: any[] = [];\r\n\t\t\tdatasources.forEach(item => {\r\n\t\t\t\titem.id = Helper.generateUniqueId();\r\n\t\t\t\tdevDatasources.push({ path: item.id, data: item });\r\n\t\t\t});\r\n\r\n\t\t\treturn this.httpService.executePost(path, devDatasources);\r\n\t\t}\r\n\r\n\t\treturn this.httpService.executePost(path, datasources);\r\n\t}\r\n\r\n\tupdateDatasource(datasource: IJsonDatasource): ng.IPromise<IJsonDatasource> {\r\n\t\treturn this.httpService.executePut(ServerPaths.REPOSITORY + ServerPaths.DATASOURCES, datasource);\r\n\t}\r\n\r\n\tdeleteDatasources(ids: string[]): ng.IPromise<void> {\r\n\t\treturn this.httpService.executeDelete(\r\n\t\t\tServerPaths.REPOSITORY + ServerPaths.DATASOURCES + \"?\" + Helper.createQueryParameters(ids, \"id\"));\r\n\t}\r\n\r\n\texportDatasources(ids: string[]): void {\r\n\t\tconst defaultFilename = Helper.getFormattedDate();\r\n\t\tconst options: IDialogOptions<IExportDialogParams> = {\r\n\t\t\ttitle: \"Export Data Services\",\r\n\t\t\ttemplate: require(\"common/dialogs/export/export-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\ttype: \"dataservice\",\r\n\t\t\t\tfilename: defaultFilename,\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.commonService.exportProjectContent(\r\n\t\t\t\t\tids, result.value, SaveFlagsEnum.DATASOURCES);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region Composite Components Methods\r\n\tloadCompositeComponents(): ng.IPromise<IJsonCompositeComponent[]> {\r\n\t\treturn this.httpService.executeGet<IJsonCompositeComponent[]>(\r\n\t\t\tServerPaths.REPOSITORY + ServerPaths.COMPOSITE_COMPONENTS);\r\n\t}\r\n\r\n\taddCompositeComponents(\r\n\t\tcompositeComponents: IJsonCompositeComponent[]): ng.IPromise<IJsonCompositeComponent[]> {\r\n\t\treturn this.httpService.executePost<IJsonCompositeComponent[]>(\r\n\t\t\tServerPaths.REPOSITORY + ServerPaths.COMPOSITE_COMPONENTS, compositeComponents);\r\n\t}\r\n\r\n\tdeleteCompositeComponents(ids: string[]): ng.IPromise<void> {\r\n\t\treturn this.httpService.executeDelete(\r\n\t\t\tServerPaths.REPOSITORY + ServerPaths.COMPOSITE_COMPONENTS + \"?\" + Helper.createQueryParameters(ids, \"id\"));\r\n\t}\r\n\r\n\tupdateCompositeComponents(compositeComponents: IJsonCompositeComponent[]): ng.IPromise<void> {\r\n\t\treturn this.httpService.executePut<void>(\r\n\t\t\tServerPaths.REPOSITORY + ServerPaths.COMPOSITE_COMPONENTS, compositeComponents);\r\n\t}\r\n\r\n\texportCompositeComponents(ids: string[]): void {\r\n\t\tconst exportDefaultName = (new Date()).toISOString().split(\"T\")[0];\r\n\t\tconst options: IDialogOptions<IExportDialogParams> = {\r\n\t\t\ttitle: \"Export Composite Components\",\r\n\t\t\ttemplate: require(\"common/dialogs/export/export-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\ttype: \"composite component\",\r\n\t\t\t\tfilename: exportDefaultName,\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.commonService.exportProjectContent(\r\n\t\t\t\t\tids, result.value, SaveFlagsEnum.COMPOSITE_COMPONENTS);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region IDO Methods\r\n\tgetIDOs(): ng.IPromise<IdoCollection[]> {\r\n\t\treturn this.localIdoService.getIdoCollectionList();\r\n\t}\r\n\r\n\tgetIdoProperties(collectionName: string): ng.IPromise<IdoProperty[]> {\r\n\t\treturn this.localIdoService.getIdoProperties(collectionName);\r\n\t}\r\n\r\n\tcreateIDO(newCollection: CollectionData): ng.IPromise<boolean> {\r\n\t\treturn this.httpService.executePost(\r\n\t\t\t`${ServerPaths.REPOSITORY}${ServerPaths.IDO}create`,\r\n\t\t\tnewCollection\r\n\t\t);\r\n\t}\r\n\r\n\tdeleteIDOs(idoNames: string[]): ng.IPromise<boolean> {\r\n\t\treturn this.httpService.executePost(\r\n\t\t\t`${ServerPaths.REPOSITORY}${ServerPaths.IDO}delete`,\r\n\t\t\tidoNames\r\n\t\t);\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region General Methods\r\n\treadJsonFile<T>(file: File): ng.IPromise<T> {\r\n\t\tconst deferredFile = this.$q.defer<T>();\r\n\t\tconst fileReader = new FileReader();\r\n\t\tfileReader.readAsText(file);\r\n\t\tfileReader.onloadend = () => {\r\n\t\t\ttry {\r\n\t\t\t\tconst parsedObject: T = JSON.parse(fileReader.result as string);\r\n\t\t\t\tdeferredFile.resolve(parsedObject);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tdeferredFile.reject(new ErrorResponse(e.message));\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tfileReader.onerror = (ev: Event) => {\r\n\t\t\tdeferredFile.reject(new ErrorResponse(\"Error reading file\" + ev.type));\r\n\t\t};\r\n\r\n\t\treturn deferredFile.promise;\r\n\t}\r\n\r\n\tonAllPromises(promises: ng.IPromise<any>[]): ng.IPromise<any[]> {\r\n\t\treturn this.$q.all(promises);\r\n\t}\r\n\r\n\tnewDeferred<T>(): ng.IDeferred<T> {\r\n\t\treturn this.$q.defer<T>();\r\n\t}\r\n\r\n\tgetDataByName<T>(serverPath: string): ng.IPromise<T[]> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.REPOSITORY + serverPath).then((responseData: T[]) => {\r\n\t\t\tthis.cacheData = [];\r\n\t\t\tthis.cacheData = responseData;\r\n\t\t\treturn this.cacheData;\r\n\t\t});\r\n\t}\r\n\r\n\tgetCurrentProject(): DesignerMashup {\r\n\t\treturn this.commonService.getCurrentProject() as DesignerMashup;\r\n\t}\r\n\r\n\tgetLanguage(): string {\r\n\t\treturn this.commonService.getLanguage();\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.REPOSITORY_SERVICE, RepositoryService);\r\n\t}\r\n}","import { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IDialogBaseScope } from \"../../../common/defines\";\r\nimport { IWizardTick } from \"../../../common/model/sohoxi/sohoxi.model\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../common/services/dialog-service\";\r\nimport { IValidationResult } from \"../../../common/shared-components/base/field-validation\";\r\nimport { IOnComponentChangeNotification, NotifiableComponent } from \"../../../common/shared-components/base/notifiable-component\";\r\n\r\nimport { FeatureSwitchService } from \"../../../common/services/feature-switch-service\";\r\n\r\nexport interface IWizardStep {\r\n\tid: string;\r\n\ttitle: string;\r\n\tuserTip: string;\r\n\ttemplate: string;\r\n}\r\n\r\nexport abstract class WizardCtrl\r\n\textends NotifiableComponent implements ng.IController {\r\n\tstatic dataKeyWizard = \"wizard\";\r\n\r\n\tisBusy: boolean;\r\n\tabstract steps: IWizardStep[];\r\n\r\n\tcurrentStep: IWizardStep;\r\n\tnextDisabled = true;\r\n\tbackDisabled = true;\r\n\r\n\tprotected dialog: IDialog<IJsonComponent>;\r\n\r\n\tprivate wizardElement: ng.IAugmentedJQuery;\r\n\r\n\terrorList: any[] = [];\r\n\tget ErrorList(): any[] {\r\n\t\tthis.nextDisabled = this.errorList.length !== 0;\r\n\t\treturn this.errorList;\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: IDialogBaseScope<any>,\r\n\t\tprotected $element: ng.IAugmentedJQuery,\r\n\t\tprotected $templateCache: ng.ITemplateCacheService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t) {\r\n\t\tsuper(featureService);\r\n\t\tthis.dialog = $scope.eirDialog;\r\n\t}\r\n\r\n\tinitWizard(): void {\r\n\t\tthis.initTemplates(this.steps);\r\n\r\n\t\tconst ticks = this.initTicks(this.steps);\r\n\t\tthis.initWizardElement(ticks);\r\n\r\n\t\tthis.setCurrentStep(this.steps[0]);\r\n\t}\r\n\r\n\tprotected initWizardElement(ticks: IWizardTick[]): void {\r\n\t\tthis.wizardElement = this.$element.find(\".wizard\");\r\n\r\n\t\tthis.$scope.$applyAsync(() => {\r\n\t\t\tthis.wizardElement.wizard({ ticks: ticks });\r\n\t\t\tthis.wizardElement.on(\"activated\", (event: JQueryEventObject, element: JQuery) => {\r\n\t\t\t\tthis.$scope.$evalAsync(() => {\r\n\t\t\t\t\tconst selectedTick: number = this.wizardElement.data(WizardCtrl.dataKeyWizard).ticks.index(element);\r\n\t\t\t\t\tthis.setCurrentStep(this.steps[selectedTick]);\r\n\t\t\t\t\tthis.onChangeCurrentStep();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tthis.wizardElement.on(\"beforeactivate\", (event, tick) => {\r\n\t\t\t\t// return false to not go to next tick;\r\n\t\t\t\treturn !this.nextDisabled ? tick : false;\r\n\t\t\t});\r\n\r\n\t\t\t// Removing href attribute from a-tags, to avoid navigating to #\r\n\t\t\t$.each(this.wizardElement.find(\"a\"), (index, element) => {\r\n\t\t\t\t$(element).removeAttr(\"href\");\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprotected setCurrentStep(step: IWizardStep): void {\r\n\t\tthis.currentStep = step;\r\n\t\tthis.updateBackDisabled();\r\n\t}\r\n\r\n\tprotected initTicks(steps: IWizardStep[]): IWizardTick[] {\r\n\t\tconst ticks: IWizardTick[] = [];\r\n\t\tsteps.forEach((step: IWizardStep, index: number) => {\r\n\t\t\tticks.push({\r\n\t\t\t\tstate: index === 0 ? \"current\" : \"\",\r\n\t\t\t\tlabel: step.title\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn ticks;\r\n\t}\r\n\r\n\tprotected initTemplates(steps: IWizardStep[]): void {\r\n\t\tsteps.forEach(step => {\r\n\t\t\tif (!this.$templateCache.get(step.id)) {\r\n\t\t\t\tthis.$templateCache.put(step.id, step.template);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tgetEndStep(): IWizardStep {\r\n\t\treturn this.steps[this.steps.length - 1];\r\n\t}\r\n\r\n\tprivate updateWizardTick(step: IWizardStep): void {\r\n\t\tconst tickIndex = this.steps.indexOf(step);\r\n\t\tthis.wizardElement.data(WizardCtrl.dataKeyWizard).select(tickIndex);\r\n\t}\r\n\r\n\tselectWizardStepByIndex(newStepIndex: number): void {\r\n\t\tif (0 <= newStepIndex && newStepIndex < this.steps.length) {\r\n\t\t\tthis.selectWizardStep(this.steps[newStepIndex]);\r\n\t\t}\r\n\t}\r\n\r\n\tselectWizardStep(step: IWizardStep): void {\r\n\t\tthis.updateWizardTick(step);\r\n\t\tthis.setCurrentStep(step);\r\n\t\tthis.onChangeCurrentStep();\r\n\t}\r\n\r\n\tupdateBackDisabled():void {\r\n\t\tthis.backDisabled = this.currentStep === this.steps[0];\r\n\t}\r\n\r\n\tprotected abstract onChangeCurrentStep(): void;\r\n\r\n\tprotected abstract getFinishParameter(): any;\r\n\r\n\tnext(): void {\r\n\t\tif (this.currentStep === this.getEndStep()) {\r\n\t\t\tconst result: IDialogResult<any> = {\r\n\t\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\t\tvalue: this.getFinishParameter()\r\n\t\t\t};\r\n\t\t\tthis.close(result);\r\n\t\t} else {\r\n\t\t\tconst nextStepIndex = this.steps.indexOf(this.currentStep) + 1;\r\n\t\t\tthis.selectWizardStep(this.steps[nextStepIndex]);\r\n\t\t}\r\n\t}\r\n\r\n\tback(): void {\r\n\t\tconst previousStepIndex = this.steps.indexOf(this.currentStep) - 1;\r\n\t\tthis.selectWizardStep(this.steps[previousStepIndex]);\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tthis.close({ button: DialogButtonType.Cancel });\r\n\t}\r\n\r\n\tclose(parameter?: IDialogResult<any>): void {\r\n\t\tthis.dialog.close(parameter);\r\n\t}\r\n\r\n\tprotected getValidation($data?: IOnComponentChangeNotification):  boolean | IValidationResult {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport class WizardDirective implements ng.IDirective {\r\n\trestrict = \"E\";\r\n\ttemplate = require(\"./wizard.html\");\r\n\tscope = true;\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirWizard\", () => new WizardDirective());\r\n\t}\r\n}\r\n","import { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\n\r\nimport type { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\n\r\nexport class DataServiceHelper {\r\n\tstatic readonly urlComponentRegex = \"[^{}/=?&;]+\";\r\n\tstatic readonly urlComponentRegexBracket = \"{\" + DataServiceHelper.urlComponentRegex + \"}\";\r\n\r\n\tprivate static id: number;\r\n\r\n\tprivate static getNextId(): string {\r\n\t\tconst id = DataServiceHelper.id++;\r\n\t\treturn id.toString();\r\n\t}\r\n\r\n\tstatic parse(resourceUrl: string): IParameterObject[] {\r\n\t\tDataServiceHelper.id = 0;\r\n\t\tconst [path, matrix, query] = DataServiceHelper.deconstructPath(resourceUrl);\r\n\r\n\t\tconst pathParameters = DataServiceHelper.getPathParameters(path);\r\n\t\tconst matrixParameters = DataServiceHelper.getSpecificParameters(matrix, ParameterTypeEnum.MATRIX);\r\n\t\tconst queryParameters = DataServiceHelper.getSpecificParameters(query, ParameterTypeEnum.QUERY);\r\n\t\treturn pathParameters.concat(matrixParameters, queryParameters);\r\n\t}\r\n\r\n\tstatic deconstructPath(resourceUrl: string): string[] {\r\n\t\tconst pathMatch = resourceUrl.match(/^\\/?[^;?]+/);\r\n\t\tconst matrixMatch = resourceUrl.match(/;[^?]+/);\r\n\t\tconst queryMatch = resourceUrl.match(/\\?[^#]+/);\r\n\t\tconst hashMatch = resourceUrl.match(/#.+/);\r\n\r\n\t\tconst restPath = pathMatch ? pathMatch[0] : \"\";\r\n\t\tconst matrixPath = matrixMatch ? matrixMatch[0] : \"\";\r\n\t\tconst queryPath = queryMatch ? queryMatch[0] : \"\";\r\n\t\tconst hashTag = hashMatch ? hashMatch[0] : \"\";\r\n\r\n\t\treturn [restPath, matrixPath, queryPath, hashTag];\r\n\t}\r\n\r\n\t/**\r\n\t *\tMethod to get substitution tag for use in urls\r\n\t\t*\r\n\t\t* @param key used as name for MATRIX and QUERY, and just the tag for PATH. It will be URL encoded.\r\n\t\t* @param paramType (optional)\r\n\t\t*/\r\n\tstatic getURLVariable(key: string, paramType?: ParameterTypeEnum): string {\r\n\t\tlet value: string;\r\n\t\tswitch (paramType) {\r\n\t\t\tcase undefined:\r\n\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\tvalue = \"{\" + encodeURIComponent(key) + \"}\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\tvalue = encodeURIComponent(key) + \"={\" + encodeURIComponent(key) + \"}\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tvalue = key;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tprivate static getPathParameters(resourceUrl: string): IParameterObject[] {\r\n\t\tconst regexp = new RegExp(\"/\" + this.urlComponentRegexBracket, \"g\");\r\n\t\tconst result = resourceUrl.match(regexp);\r\n\t\tif (!result) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst output = result.map<IParameterObject>((item) => {\r\n\t\t\treturn {\r\n\t\t\t\tid: DataServiceHelper.getNextId(),\r\n\t\t\t\tkey: decodeURIComponent(item.match(new RegExp(this.urlComponentRegex))[0]),\r\n\t\t\t\tvalueType: null,\r\n\t\t\t\tparameterType: ParameterTypeEnum.PATH,\r\n\t\t\t\trequired: true,\r\n\t\t\t\talias: \"\"\r\n\t\t\t} as any;\r\n\t\t});\r\n\t\treturn output;\r\n\t}\r\n\r\n\tprivate static getSpecificParameters(queryPath: string, type: ParameterTypeEnum): IParameterObject[] {\r\n\t\tconst regexp = new RegExp(this.urlComponentRegex + \"=\" + this.urlComponentRegexBracket, \"g\");\r\n\t\tconst result = queryPath.match(regexp);\r\n\t\tlet output: IParameterObject[] = [];\r\n\t\tif (result) {\r\n\t\t\toutput = result.map<IParameterObject>((item) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: DataServiceHelper.getNextId(),\r\n\t\t\t\t\tkey: decodeURIComponent(item.match(new RegExp(this.urlComponentRegex))[0]),\r\n\t\t\t\t\tvalueType: null,\r\n\t\t\t\t\tparameterType: type,\r\n\t\t\t\t\trequired: false,\r\n\t\t\t\t\talias: \"\"\r\n\t\t\t\t} as any;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn output;\r\n\t}\r\n\r\n\t/**\r\n\t * Validate if resource URL conforms to correct syntax\r\n\t * @param resourceUrl\r\n\t */\r\n\tstatic validate(resourceUrl: string): boolean {\r\n\t\tlet result = true;\r\n\t\tconst [path, matrix, query, hashTag] = DataServiceHelper.deconstructPath(resourceUrl);\r\n\r\n\t\tif (path.length > 0) {\r\n\t\t\tresult = DataServiceHelper.validatePath(path);\r\n\t\t}\r\n\t\tif (matrix.length > 0) {\r\n\t\t\tresult = result && DataServiceHelper.validateUrlPart(matrix, ParameterTypeEnum.MATRIX);\r\n\t\t}\r\n\t\tif (query.length > 0) {\r\n\t\t\tresult = result && DataServiceHelper.validateUrlPart(query, ParameterTypeEnum.QUERY);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate static validatePath(path: string): boolean {\r\n\t\tconst pathElements = path.split(\"/\").filter(DataServiceHelper.emptyItem);\r\n\t\tconst errorsFound = pathElements.filter(item => {\r\n\t\t\tconst pathRegex = new RegExp(\"^\" + this.urlComponentRegexBracket + \"$|^\" + this.urlComponentRegex + \"$\");\r\n\t\t\treturn item.match(pathRegex) === null;\r\n\t\t});\r\n\r\n\t\treturn errorsFound.length === 0;\r\n\t}\r\n\r\n\tprivate static validateUrlPart(query: string, type: ParameterTypeEnum): boolean {\r\n\t\tconst twoElements = 2;\r\n\t\tconst deliminator: any =\r\n\t\t\ttype === ParameterTypeEnum.MATRIX ? \";\" : new RegExp(/[?&]/);\r\n\t\tconst queryElements = query.split(deliminator).filter(DataServiceHelper.emptyItem);\r\n\t\tconst result = queryElements.filter(item => {\r\n\t\t\tif (item.indexOf(\"=\") === -1) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst elem = item.split(\"=\").filter(DataServiceHelper.emptyItem);\r\n\r\n\t\t\t// verify it is two elements\r\n\t\t\tif (elem.length !== twoElements) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\t// verify Name\r\n\t\t\tlet nameMatch = elem[0].match(\"^\" + this.urlComponentRegex + \"$\");\r\n\t\t\tif (!nameMatch) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\t// Verify Value\r\n\t\t\tnameMatch = elem[1].match(\"^\" + this.urlComponentRegexBracket + \"$\");\r\n\t\t\tif (!nameMatch) { // Static value\r\n\t\t\t\tif (elem[1].match(\"^\" + this.urlComponentRegex + \"$\") === null) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t} else { // Variable value\r\n\t\t\t\tconst pairMatch = item.match(new RegExp(\"^(\" + this.urlComponentRegex + \")={\\\\1}$\"));\r\n\t\t\t\tif (!pairMatch) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\treturn result.length === 0; // equals zero means no errors found\r\n\t}\r\n\r\n\tstatic emptyItem(item: string): boolean {\r\n\t\treturn item.length > 0;\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport isNumber from \"lodash-es/isNumber\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\nimport type { IErrorResponse } from \"../../common/error-response\";\r\nimport { Helper } from \"../../common/helper\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { DialogButtonType, IDialogOptions, IDialogResult } from \"../../common/services/dialog-service\";\r\nimport { DatagridHelper } from \"../../common/sohoxi/datagrid-helper\";\r\nimport { Component } from \"../component\";\r\nimport { ComponentsHelper } from \"../helper\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport type { IDatagridExportResult } from \"./datagrid-export-dialog-ctrl\";\r\n\r\nimport {\r\n\tDatagridExportTypes, DatagridPageSizesEnum, GridAggregators,\r\n\tInteractionActionEnum, InteractionPairOperation, InteractionTriggerEnum, Numbers,\r\n\tRegexStrings,\r\n\tRowHeight, SettingInputKeys, SettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\nimport { FormatterEnum, SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IExtendedDataGridColumn, IJsonDatagrid, IPreviousAttributes } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport type {\r\n\tIColumnOptions,\r\n\tIDatagridApi,\r\n\tIDataGridColumn,\r\n\tIDatagridColumnArgs,\r\n\tIDataGridOptions,\r\n\tIDataGridRow,\r\n\tIDatagridSettings,\r\n} from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport type { IPagerApi } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport class Datagrid extends Component {\r\n\r\n\tstatic availableRowHeights: IDataPair[] = [\r\n\t\t{ name: \"Small\", value: RowHeight.SHORT },\r\n\t\t{ name: \"Medium\", value: RowHeight.MEDIUM },\r\n\t\t{ name: \"Large\", value: RowHeight.TALL }\r\n\t];\r\n\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic AVAILABE_PAGE_SIZES = [\r\n\t\t{ name: DatagridPageSizesEnum.OPTION1, value: DatagridPageSizesEnum.OPTION1},\r\n\t\t{ name: DatagridPageSizesEnum.OPTION2, value: DatagridPageSizesEnum.OPTION2},\r\n\t\t{ name: DatagridPageSizesEnum.OPTION3, value: DatagridPageSizesEnum.OPTION3},\r\n\t\t{ name: DatagridPageSizesEnum.OPTION4, value: DatagridPageSizesEnum.OPTION4}\r\n\t];\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = [];\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.LIST,\r\n\t\tInteractionPairOperation.CLEAR,\r\n\t];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Show Header\",\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true,\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"List\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Display as List\",\r\n\t\t\tref: SettingKeys.IS_LIST,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Row Height\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Row Height\",\r\n\t\t\tref: SettingKeys.ROW_HEIGHT,\r\n\t\t\tboundarySetting: true,\r\n\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\tdataset: Datagrid.availableRowHeights\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Options\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Keep Selection\",\r\n\t\t\ttooltip: \"Keep previous selected row on reload. (With ION APIs, an object ID is preferred if using this)\",\r\n\t\t\tref: SettingKeys.KEEP_SELECTED,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true\r\n\t\t}, {\r\n\t\t\ttitle: \"Selectable\",\r\n\t\t\ttooltip: \"Enable selection\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true\r\n\t\t}, {\r\n\t\t\ttitle: \"Multi Select\",\r\n\t\t\ttooltip: \"Enable Multi selection\",\r\n\t\t\tref: SettingKeys.MULTI_SELECT,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Toolbar\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Enable Row Count\",\r\n\t\t\tref: SettingKeys.ROW_COUNT,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}, {\r\n\t\t\ttitle: \"Enable Filter Bar\",\r\n\t\t\tref: SettingKeys.FILTER_BAR,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}, {\r\n\t\t\ttitle: \"Enable Export\",\r\n\t\t\tref: SettingKeys.ENABLE_EXPORT,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Paging\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Use Paging\",\r\n\t\t\t\tref: SettingKeys.USE_PAGING,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Items per page\",\r\n\t\t\t\tref: SettingKeys.PAGE_SIZE,\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\tdataset: Datagrid.AVAILABE_PAGE_SIZES,\r\n\t\t\t\tdefaultValue: 25\r\n\t\t\t}\r\n\t\t]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Header\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Selected Item(s)\",\r\n\t\tref: SettingKeys.SELECTED_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Edited Item(s)\",\r\n\t\tref: SettingKeys.DIRTY_ITEMS,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Row Count\",\r\n\t\tref: SettingKeys.ROW_COUNT_OUTPUT,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Summary\",\r\n\t\tref: SettingKeys.SUMMARY_OUTPUT,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\r\n\tprotected databearer: IJsonDatagrid;\r\n\tset isReadonly(value: boolean) {\r\n\t\tthis.databearer.isReadonly = value;\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tset usePaging(value: boolean) {\r\n\t\tthis.databearer.usePaging = value;\r\n\t\tthis.togglePager();\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tset pageSize(value: number) {\r\n\t\tthis.databearer.pageSize = value;\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tset isList(value: boolean) {\r\n\t\tthis.databearer.isList = value;\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tset rowCount(value: boolean) {\r\n\t\tthis.databearer.rowCount = value;\r\n\t\tthis.setRowCountOutput();\r\n\t}\r\n\tget rowCount(): boolean {\r\n\t\treturn this.databearer.rowCount;\r\n\t}\r\n\tset multiSelect(value: boolean) {\r\n\t\tthis.databearer.multiSelect = value;\r\n\t\tthis.toggleMultiSelection();\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tget multiSelect(): boolean {\r\n\t\treturn this.databearer.multiSelect;\r\n\t}\r\n\r\n\tdatagridOptions: IDataGridOptions<any>;\r\n\tshowDatagrid = true;\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\trowCountOutput: IMap<any>;\r\n\tfilterBar: boolean;\r\n\tenableExport: boolean;\r\n\tpreviousAttributes: IPreviousAttributes;\r\n\tsummaryOutput: IMap<any>;\r\n\r\n\tprivate selectedItem: IMap<any>;\r\n\tprivate dirtyItems: IMap<any>;\r\n\tprivate autocompleteSource: string[];\r\n\tprivate keepSelected: boolean;\r\n\tprivate previousLength: number;\r\n\tprivate selectHandler = (e: JQueryEventObject, args: any) => {\r\n\t\tif (e.target.id === `datagrid-${this.getId()}`) {\r\n\t\t\tthis.onItemSelected(args);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate changeHandler = (e: JQueryEventObject, args: IDatagridColumnArgs<any>) => {\r\n\t\tthis.onItemChanged(args);\r\n\t}\r\n\r\n\tprivate settingsChangedHandler = (e: JQueryEventObject, args: IDatagridSettings) => {\r\n\t\tthis.onSettingsChanged(args);\r\n\t}\r\n\r\n\t/**\r\n\t * MUPS-Refactor-002:\r\n\t * This is most likely our usage of Datagrid which causes issue.\r\n\t * Lots of no needed and duplicate code which does things repeatedly.\r\n\t * Remove this part when datagrid is refactored in future\r\n\t */\r\n\tprivate rerenderTbody = (e: JQueryEventObject, args: IDatagridSettings) => {\r\n\t\tconst datagridApi = this.getSohoXiApi();\r\n\t\tconst pagerInfo = datagridApi.pagerAPI.state;\r\n\r\n\t\tdatagridApi.render(null, pagerInfo);\r\n\t\tdatagridApi.afterPaging(pagerInfo);\r\n\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonDatagrid,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tif (obj) {\r\n\t\t\tthis.keepSelected = obj.keepSelected;\r\n\t\t\tthis.rowCount = obj.rowCount || false;\r\n\t\t\tthis.filterBar = obj.filterBar;\r\n\t\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\t\tthis.enableExport = obj.enableExport || false;\r\n\t\t}\r\n\r\n\t\tthis.initiateDatagridOptions(obj);\r\n\t\tthis.getScope().$on(AngularConstants.DESTROY, () => {\r\n\t\t\tthis.detachEvents();\r\n\t\t});\r\n\t\tthis.initClasses();\r\n\t}\r\n\r\n\tsetBoundarySettingIfChanged<T>(settingId: string): void {\r\n\t\tsuper.setBoundarySettingIfChanged<T>(settingId);\r\n\r\n\t\tif (settingId === SettingKeys.SHOW_LABEL) {\r\n\t\t\tthis.toggleToolbar();\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tonChildrenReady(): void {\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tupdateValuesWithTranslations(): void {\r\n\t\tthis.databearer.columns.forEach((column) => {\r\n\t\t\tconst translatedTitle = this.frameworkService.getTranslatableStringByProperty(this.getId(), column.id);\r\n\r\n\t\t\tif (translatedTitle) {\r\n\t\t\t\tconst globalString = this.frameworkService.getGlobalValue(translatedTitle, this);\r\n\r\n\t\t\t\tif (globalString) {\r\n\t\t\t\t\tcolumn.value = translatedTitle;\r\n\t\t\t\t\tcolumn.name = Helper.htmlEncode(globalString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcolumn.name = Helper.htmlEncode(translatedTitle);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (column.text) {\r\n\t\t\t\tconst translatedCellText =\r\n\t\t\t\t\tthis.frameworkService.getTranslatableStringByProperty(this.getId(), column.id + \"CellText\");\r\n\t\t\t\tif (translatedCellText) {\r\n\t\t\t\t\tcolumn.text = translatedCellText;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.refreshSubstitutions(column);\r\n\t\t});\r\n\r\n\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\tthis.refreshDatagridTriggers();\r\n\t}\r\n\r\n\trefreshDatagrid(): void {\r\n\t\tthis.detachEvents();\r\n\t\tthis.getSohoXiApi().emptyMessage = null; // needs to be removed so it is created and append to DOM again\r\n\t\tthis.showDatagrid = false;\r\n\t\tconst databearer = this.databearer;\r\n\t\tthis.setDatagridOptions(databearer);\r\n\t\tthis.showDatagrid = true;\r\n\t\tthis.updateGrid();\r\n\t\tthis.getSohoXiApi().rowHeight(this.getBoundarySetting<string>(SettingKeys.ROW_HEIGHT));\r\n\t\tthis.attachEvents();\r\n\t\tthis.updateClassesAndStyle();\r\n\t\tthis.setSummaryRowOutput();\r\n\t\tthis.setRowCountOutput();\r\n\t}\r\n\r\n\t/**\r\n\t\t * Set the datagrid options based on IJsonDatagrid\r\n\t\t *\r\n\t\t * @public\r\n\t\t * @param {IJsonDatagrid} datagridBearer\r\n\t\t * @param {boolean} [initial=false]\r\n\t */\r\n\tsetDatagridOptions(datagridBearer: IJsonDatagrid, initial = false): void {\r\n\t\tthis.setColumnSettings();\r\n\t\tconst columnDefinitions: IDataGridColumn[] = angular.copy(datagridBearer.columns);\r\n\t\tconst hasSummaryRow = this.shouldHaveSummaryRow(datagridBearer);\r\n\t\tconst selectType = this.getSelectType(datagridBearer);\r\n\r\n\t\tconst options: IDataGridOptions<any> = {\r\n\t\t\tdataset: initial ? [] : this.datagridOptions.dataset,\r\n\t\t\tcolumns: columnDefinitions,\r\n\t\t\tsaveColumns: initial ? false : this.datagridOptions.saveColumns,\r\n\t\t\trowHeight: this.getBoundarySetting<string>(SettingKeys.ROW_HEIGHT),\r\n\t\t\tisList: datagridBearer.isList,\r\n\t\t\tpaging: datagridBearer.usePaging,\r\n\t\t\t// Give a default of 25 so it won't break\r\n\t\t\tpagesize: datagridBearer.pageSize || Numbers.TWENTYFIVE,\r\n\t\t\tselectable: selectType,\r\n\t\t\teditable: true,\r\n\t\t\tshowDirty: true,\r\n\t\t\tshowSelectAllCheckBox: false,\r\n\t\t\tenableTooltips: true,\r\n\t\t\tsummaryRow: hasSummaryRow, //needs to be true for summary to work on any column, also adds a summaryRow\r\n\t\t\ttoolbar: {\r\n\t\t\t\tresults: datagridBearer.rowCount,\r\n\t\t\t\tkeywordFilter: true\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.datagridOptions = options;\r\n\t\tthis.previousAttributes = {\r\n\t\t\trow: null,\r\n\t\t\tactivePage: null,\r\n\t\t\tsortOrder: null\r\n\t\t};\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.LIST) {\r\n\t\t\tinteractionPromise.then((listResult) => {\r\n\t\t\t\t//Wait on grid element to show\r\n\t\t\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\t\t\tthis.detachEvents();\r\n\t\t\t\t\tthis.datagridOptions.dataset = listResult;\r\n\t\t\t\t\tthis.setSummaryRowOutput();\r\n\t\t\t\t\tthis.setRowCountOutput();\r\n\t\t\t\t\tthis.updateGrid();\r\n\t\t\t\t\tthis.attachEvents();\r\n\r\n\t\t\t\t\tif (listResult.length > 0) {\r\n\t\t\t\t\t\tangular.extend(this.getContext(), listResult[0]);\r\n\t\t\t\t\t\tthis.setSelection();\r\n\t\t\t\t\t\tthis.substituteValues();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, Numbers.TEN);\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tthis.datagridOptions.dataset = [];\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\texport(): void {\r\n\t\tconst options: IDialogOptions<any> = {\r\n\t\t\ttitle: \"Export to file\",\r\n\t\t\ttemplate: require(\"./datagrid-export-dialog.html\"),\r\n\t\t};\r\n\r\n\t\tthis.frameworkService.openComponentDialog(options)\r\n\t\t\t.then((result: IDialogResult<IDatagridExportResult>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst api = this.getSohoXiApi();\r\n\t\t\t\t\tswitch (result.value.exportType) {\r\n\t\t\t\t\t\tcase DatagridExportTypes.EXCEL:\r\n\t\t\t\t\t\t\tapi.exportToExcel(result.value.exportName);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase DatagridExportTypes.CSV:\r\n\t\t\t\t\t\t\tapi.exportToCsv(result.value.exportName);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate setSummaryRowOutput(): void {\r\n\t\tthis.summaryOutput = {};\r\n\t\tconst output: any[] = [];\r\n\t\tthis.datagridOptions.columns.forEach((column: IExtendedDataGridColumn) => {\r\n\t\t\tif (column.summarize) {\r\n\t\t\t\toutput.push({\r\n\t\t\t\t\tname: column.name,\r\n\t\t\t\t\tfield: column.field,\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.datagridOptions.dataset.forEach(row => {\r\n\t\t\toutput.forEach(summary => {\r\n\t\t\t\tconst value = row[summary.field];\r\n\t\t\t\tconst parsedValue = value % 1 === 0 ? Number.parseInt(value, 10) : Number.parseFloat(value);\r\n\t\t\t\tif (!isNaN(parsedValue)) {\r\n\t\t\t\t\tsummary.value += parsedValue;\r\n\t\t\t\t\tthis.summaryOutput[summary.name] = summary.value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setRowCountOutput(): void {\r\n\t\tthis.rowCountOutput = {};\r\n\t\tif (this.rowCount && this.datagridOptions) {\r\n\t\t\tthis.rowCountOutput[\"count\"] = this.datagridOptions.dataset.length;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getSelectType(databearer: IJsonDatagrid): SelectableEnum | boolean {\r\n\t\tif (!databearer.isReadonly) {\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\treturn this.databearer.multiSelect ? SelectableEnum.Multiple : SelectableEnum.Single;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate substituteValues(): void {\r\n\t\tfor (let i = 0; i < this.databearer.columns.length; i++) {\r\n\t\t\tconst column = this.databearer.columns[i];\r\n\t\t\tthis.refreshSubstitutions(column);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate refreshSubstitutions(column: IExtendedDataGridColumn): void {\r\n\t\tif (column.substitute) {\r\n\t\t\tconst dataservice = this.frameworkService.getDatasourceObject(column.substituteOptions.source);\r\n\t\t\tif (dataservice) {\r\n\t\t\t\tthis.isLoading = true;\r\n\t\t\t\tdataservice.getListData({}).then((listResult) => {\r\n\t\t\t\t\tconst dropdownOptions: IColumnOptions[] = [];\r\n\t\t\t\t\tlistResult.forEach((listItem, index) => {\r\n\t\t\t\t\t\tdropdownOptions.push({\r\n\t\t\t\t\t\t\tid: \"substituteID\" + index,\r\n\t\t\t\t\t\t\tvalue: listItem[column.substituteOptions.from],\r\n\t\t\t\t\t\t\tlabel: listItem[column.substituteOptions.to]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tcolumn.options = dropdownOptions;\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Dropdown;\r\n\t\t\t\t\tif (column.substitute && column.formatterName !== FormatterEnum.Dropdown) {\r\n\t\t\t\t\t\tcolumn.cssClass = \"remove-icon\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcolumn.cssClass = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tthis.setErrorTooltip(errorResponse.message);\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateColumns(): void {\r\n\t\tconst columns = this.databearer.columns;\r\n\r\n\t\tif (this.datasource) {\r\n\t\t\tconst outputParameters =\r\n\t\t\t\t(this.datasource.getDatabearer() as IJsonGenericDatasource2).outputParameters;\r\n\r\n\t\t\toutputParameters.forEach(outParam => {\r\n\t\t\t\tconst alias = Helper.isUndefinedEmpty(outParam.alias) ?\r\n\t\t\t\t\toutParam.key : outParam.alias;\r\n\r\n\t\t\t\tconst column = columns.find(column => column.field === outParam.id);\r\n\t\t\t\tif (column) {\r\n\t\t\t\t\tcolumn.name = alias;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.refreshColumns(columns);\r\n\t\tthis.refreshDatagridTriggers();\r\n\t}\r\n\r\n\tprivate moveIndex(): void {\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tconst index = ComponentsHelper.findItemIndexById(listResult, this.selectedItem.id);\r\n\t\tif (isUndefined(index)) {\r\n\t\t\tthis.setErrorTooltip(\"Selection failed, Item ID is not unique.\");\r\n\t\t} else {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t}\r\n\t\tif (isNumber(index) && index !== -1) {\r\n\t\t\tthis.previousAttributes.row = index;\r\n\t\t\tthis.toggleSelected();\r\n\t\t} else if (index) { //if item id does not exists, try to find correct index\r\n\t\t\tconst currentDataLength = listResult.length;\r\n\t\t\tif (this.previousLength < currentDataLength) {\r\n\t\t\t\t//Item added.\r\n\t\t\t\tthis.previousAttributes.row = ComponentsHelper.incrementIndex(\r\n\t\t\t\t\tthis.previousAttributes.row,\r\n\t\t\t\t\tthis.getContext(),\r\n\t\t\t\t\tthis.selectedItem,\r\n\t\t\t\t\tthis.getDatasource()\r\n\t\t\t\t);\r\n\t\t\t\tthis.toggleSelected();\r\n\t\t\t} else if (this.previousLength > currentDataLength) {\r\n\t\t\t\t//item deleted.\r\n\t\t\t\tthis.syncAndDeselectAll();\r\n\t\t\t} else {\r\n\t\t\t\tthis.toggleSelected();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.syncAndDeselectAll();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate toggleSelected(): void {\r\n\t\tconst previousRow = angular.copy(this.previousAttributes.row);\r\n\t\tconst previousPage = angular.copy(this.previousAttributes.activePage);\r\n\t\tconst previousSortOrder = angular.copy(this.previousAttributes.sortOrder);\r\n\r\n\t\tthis.getSohoXiApi().deSelectAllRows();\r\n\t\tif (previousPage && this.databearer.usePaging) {\r\n\t\t\tthis.getPagerApi().setActivePage(previousPage);\r\n\t\t}\r\n\t\tif (previousSortOrder && previousSortOrder.sortId) {\r\n\t\t\tthis.getSohoXiApi().setSortColumn(previousSortOrder.sortId, previousSortOrder.sortAsc);\r\n\t\t}\r\n\t\tthis.getSohoXiApi().selectRow(previousRow, false, false);\r\n\t}\r\n\r\n\tprivate syncAndDeselectAll(clearDirty = true): void {\r\n\t\tthis.selectedItem = null;\r\n\t\tthis.getSohoXiApi().deSelectAllRows();\r\n\t\tthis.getSohoXiApi().syncSelectedRowsIdx();\r\n\r\n\t\tif (clearDirty) {\r\n\t\t\tthis.dirtyItems = null;\r\n\t\t\tthis.getSohoXiApi().clearDirty();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setSelection(): void {\r\n\t\tif (!this.keepSelected || !this.selectedItem || this.multiSelect) {\r\n\t\t\tthis.syncAndDeselectAll();\r\n\t\t} else if (this.selectedItem) {\r\n\t\t\tthis.moveIndex();\r\n\t\t}\r\n\r\n\t\t//MUPS-2736: remove when fixed in IDS\r\n\t\tthis.clearSummaryRow();\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\r\n\t\tif (this.datagridOptions.rowHeight !== this.getBoundarySetting<string>(SettingKeys.ROW_HEIGHT)) {\r\n\t\t\tthis.refreshDatagrid();\r\n\t\t}\r\n\t}\r\n\r\n\tupdateClassesAndStyle(): void {\r\n\t\tsuper.updateClassesAndStyle();\r\n\t}\r\n\r\n\tsetBindableValue(key: string, value: any): void {\r\n\t\tsuper.setBindableValue(key, value);\r\n\t\tif (key === SettingKeys.SHOW_LABEL) {\r\n\t\t\tthis.toggleToolbar();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate toggleToolbar(): void {\r\n\t\tif (this.showLabel) {\r\n\t\t\tthis.getGridElement().addClass(\"has-toolbar\");\r\n\t\t} else {\r\n\t\t\tthis.getGridElement().removeClass(\"has-toolbar\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate togglePager(): void {\r\n\t\tif (!this.databearer.usePaging) {\r\n\t\t\tthis.getGridElement().removeClass(\"paginated\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateGrid(): void {\r\n\t\tif (this.getSohoXiApi()) {\r\n\t\t\tthis.getSohoXiApi().updated(this.datagridOptions);\r\n\t\t}\r\n\t}\r\n\r\n\tgetSohoXiApi(): IDatagridApi {\r\n\t\treturn this.getGridElement().data(\"datagrid\");\r\n\t}\r\n\r\n\tprivate getGridElement(): ng.IAugmentedJQuery {\r\n\t\treturn this.element.find(\"#datagrid-\" + this.getId());\r\n\t}\r\n\r\n\tprivate getPagerApi(): IPagerApi {\r\n\t\treturn this.getSohoXiApi().pagerAPI;\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.datagridOptions.dataset = [];\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\r\n\t/**\r\n\t * Initiate the datagrid\r\n\t *\r\n\t * @private\r\n\t * @param {IJsonDatagrid} obj\r\n\t *\r\n\t * @memberof Datagrid\r\n\t */\r\n\tprivate initiateDatagridOptions(obj: IJsonDatagrid): void {\r\n\t\tthis.setDatagridOptions(obj, true);\r\n\t}\r\n\r\n\tprivate refreshColumns(columns: IExtendedDataGridColumn[]): void {\r\n\t\tconst datagridApi = this.getSohoXiApi();\r\n\t\tif (datagridApi) {\r\n\t\t\tdatagridApi.updateColumns(columns);\r\n\t\t\tcolumns = (columns as IExtendedDataGridColumn[]);\r\n\r\n\t\t\t/*\r\n\t\t\tWhen updateColumns is called with an empty columns [] sohoxi.js adds an empty item called blank\r\n\t\t\t\tPossibly a bug in IDS, and should perhaps be reported. Meanwhile this is a temporary fix\r\n\t\t\t*/\r\n\t\t\tconst blankId = columns.findIndex(column => column.id === \"blank\");\r\n\t\t\tif (blankId !== -1) {\r\n\t\t\t\tHelper.removeItemFromListByIndex(columns, blankId);\r\n\t\t\t}\r\n\r\n\t\t\t// Summary Row changes needs to be reflected on datagridOptions\r\n\t\t\tconst summaryRow: boolean = this.shouldHaveSummaryRow(this.databearer);\r\n\t\t\tif (summaryRow !== this.datagridOptions.summaryRow) {\r\n\t\t\t\tthis.datagridOptions.summaryRow = summaryRow;\r\n\t\t\t\tthis.updateGrid();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.datagridOptions.columns = columns;\r\n\r\n\t\t//MUPS-2736: remove when fixed in IDS\r\n\t\tthis.clearSummaryRow();\r\n\t}\r\n\r\n\tprivate setColumnSettings(): void {\r\n\t\tconst locale = this.frameworkService.getCurrentLanguage();\r\n\r\n\t\tfor (let i = 0; i < this.databearer.columns.length; i++) {\r\n\t\t\tconst column = this.databearer.columns[i] as IExtendedDataGridColumn;\r\n\t\t\tDatagridHelper.setEditableOnColumn(column, locale);\r\n\r\n\t\t\tif (column.summarize) {\r\n\t\t\t\tcolumn.summaryRowFormatter = Soho.Formatters.SummaryRow;\r\n\t\t\t\tcolumn.aggregator = GridAggregators.SUM;\r\n\t\t\t}\r\n\r\n\t\t\tif (!Helper.isUndefinedOrNull(column.formatterName)) {\r\n\t\t\t\tDatagridHelper.setColumnSettings(column, locale);\r\n\r\n\t\t\t\tif (column.formatterName === FormatterEnum.Button) {\r\n\t\t\t\t\tthis.addClickEvent(column);\r\n\t\t\t\t} else if (column.formatterName === FormatterEnum.Hyperlink) {\r\n\t\t\t\t\tthis.addHyperlinkEvent(column);\r\n\t\t\t\t} else if (column.formatterName === FormatterEnum.Dropdown ||\r\n\t\t\t\t\tcolumn.formatterName === FormatterEnum.Autocomplete ||\r\n\t\t\t\t\tcolumn.formatterName === FormatterEnum.Lookup) {\r\n\t\t\t\t\tthis.loadOptions(column);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate toggleMultiSelection(): void {\r\n\t\tconst checkboxExists = this.databearer.columns.find(item => item.id === \"selectionCheckbox\");\r\n\t\tif (!checkboxExists && this.databearer.multiSelect) {\r\n\t\t\tconst checkbox = {\r\n\t\t\t\tid: \"selectionCheckbox\",\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\twidth: 50,\r\n\t\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\t\tformatterName: FormatterEnum.SelectionCheckbox,\r\n\t\t\t\talign: \"center\"\r\n\t\t\t};\r\n\t\t\tthis.databearer.columns.unshift(checkbox);\r\n\t\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\t} else if (checkboxExists && !this.databearer.multiSelect) {\r\n\t\t\tthis.databearer.columns.shift();\r\n\t\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addClickEvent(column: IExtendedDataGridColumn): void {\r\n\t\tcolumn.click = (_, rowsSelected: IDataGridRow<any>[]) => {\r\n\t\t\tthis.getSohoXiApi().selectRow(rowsSelected[0].row);\r\n\t\t\tthis.selectedItem = rowsSelected[0].item;\r\n\t\t\tthis.trigger(InteractionTriggerEnum.CLICK + column.id);\r\n\t\t};\r\n\t}\r\n\r\n\tprivate addHyperlinkEvent(column: IExtendedDataGridColumn): void {\r\n\t\tcolumn.click = (_, rowsSelected: IDataGridRow<any>[]) => {\r\n\t\t\tangular.extend(this.getContext(), rowsSelected[0].item);\r\n\t\t\tif (column.hyperlinkOptions && column.hyperlinkOptions.isDrillback) {\r\n\t\t\t\tconst drillbacklink = BackwardCompatible.getHref(rowsSelected[0].item, column);\r\n\t\t\t\tthis.frameworkService.sendDrillbackMessage(drillbacklink);\r\n\t\t\t} else if (column.hyperlinkOptions) {\r\n\t\t\t\tlet hrefString = this.buildLink(column.hyperlinkOptions.value, column.hyperlinkOptions.sources);\r\n\t\t\t\tlet target = \"\";\r\n\t\t\t\tconst isEmail = RegexStrings.EMAIL.test(hrefString);\r\n\r\n\t\t\t\tif (isEmail) {\r\n\t\t\t\t\threfString = \"mailto:\" + hrefString;\r\n\t\t\t\t\ttarget = \"_self\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget = \"_blank\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\twindow.open(hrefString, target);\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\t// catch incorrect urls and stop them from throwing an error.\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tprivate attachEvents(): void {\r\n\t\tconst datagridElement = this.getGridElement();\r\n\t\tdatagridElement.on(\"selected\", this.selectHandler);\r\n\t\tdatagridElement.on(\"cellchange\", this.changeHandler);\r\n\t\tdatagridElement.on(\"settingschanged\", this.settingsChangedHandler);\r\n\r\n\t\t/**\r\n\t\t * MUPS-Refactor-002:\r\n\t\t * This is most likely our usage of Datagrid which causes issue.\r\n\t\t * Lots of no needed and duplicate code which does things repeatedly.\r\n\t\t * Remove this part when datagrid is refactored in future\r\n\t\t */\r\n\t\tdatagridElement.on(\"firstpage\", this.rerenderTbody);\r\n\t\tdatagridElement.on(\"nextpage\", this.rerenderTbody);\r\n\t\tdatagridElement.on(\"previouspage\", this.rerenderTbody);\r\n\t\tdatagridElement.on(\"lastpage\", this.rerenderTbody);\r\n\t\tdatagridElement.on(\"pagesizechange\", this.rerenderTbody);\r\n\t}\r\n\r\n\t// Wait for the grid element to render and then remove uneccessery classes\r\n\tprivate initClasses(): void {\r\n\t\tconst checkInterval = 100; // check every 100ms\r\n\t\tconst checkExist = setInterval(() => {\r\n\t\t\tif (this.getGridElement().length > 0) {\r\n\t\t\t\tthis.togglePager();\r\n\t\t\t\tthis.toggleToolbar();\r\n\t\t\t\tclearInterval(checkExist);\r\n\t\t\t}\r\n\t\t}, checkInterval);\r\n\t}\r\n\r\n\tprivate detachEvents(): void {\r\n\t\tconst datagridElement = this.getGridElement();\r\n\t\tdatagridElement.off(\"selected\", this.selectHandler);\r\n\t\tdatagridElement.off(\"cellchange\", this.changeHandler);\r\n\t\tdatagridElement.off(\"settingschanged\", this.settingsChangedHandler);\r\n\r\n\t\t/**\r\n\t\t * MUPS-Refactor-002:\r\n\t\t * This is most likely our usage of Datagrid which causes issue.\r\n\t\t * Lots of no needed and duplicate code which does things repeatedly.\r\n\t\t * Remove this part when datagrid is refactored in future\r\n\t\t */\r\n\t\tdatagridElement.off(\"firstpage\", this.rerenderTbody);\r\n\t\tdatagridElement.off(\"nextpage\", this.rerenderTbody);\r\n\t\tdatagridElement.off(\"previouspage\", this.rerenderTbody);\r\n\t\tdatagridElement.off(\"lastpage\", this.rerenderTbody);\r\n\t\tdatagridElement.off(\"pagesizechange\", this.rerenderTbody);\r\n\t}\r\n\r\n\tprivate onItemSelected(args: any): void {\r\n\t\tif (args && args.length > 0) {\r\n\t\t\tconst newItem = this.updateBindableItem(args);\r\n\r\n\t\t\tif (this.selectedItem !== newItem) {\r\n\t\t\t\tthis.getScope().$evalAsync(() => {\r\n\t\t\t\t\tthis.selectedItem = newItem;\r\n\t\t\t\t\tangular.extend(this.getContext(), newItem);\r\n\t\t\t\t\tthis.previousLength = angular.copy(this.getContext().ListResult.length);\r\n\t\t\t\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\t\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.syncAndDeselectAll(false);\r\n\t\t\tthis.previousAttributes.row = null;\r\n\t\t\tthis.getSohoXiApi().updated();\r\n\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateBindableItem(args: any): IMap<any>|null {\r\n\t\tconst newItem: IMap<any> = {};\r\n\t\tlet listData: any[] = [];\r\n\t\tlet keys: string[] = [];\r\n\t\tif (args && args.length > 0) {\r\n\t\t\tif (args[0].data) {\r\n\t\t\t\tkeys = Object.keys(args[0].data);\r\n\t\t\t\targs.forEach((arg: any) => {\r\n\t\t\t\t\tlistData.push(arg.data);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tkeys = Object.keys(args[0]);\r\n\t\t\t\tlistData = args;\r\n\t\t\t}\r\n\t\t\tlistData.forEach((argData: IMap<any>) => {\r\n\t\t\t\tkeys.forEach((key) => {\r\n\t\t\t\t\tconst data = argData[key];\r\n\t\t\t\t\tconst newData = newItem[key];\r\n\t\t\t\t\tif (key !== \"_selected\") {\r\n\t\t\t\t\t\tif (newData) {\r\n\t\t\t\t\t\t\tnewItem[key] = newData + \"%%\" + data;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnewItem[key] = data;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewItem[key] = data;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\treturn newItem;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate onItemChanged(args: IDatagridColumnArgs<any>): void {\r\n\t\tconst hasNewValue = args.value !== args.oldValue;\r\n\t\tif (hasNewValue && args.oldValue !== undefined) {\r\n\t\t\tif (this.multiSelect) {\r\n\t\t\t\tconst selectedRows = this.getSohoXiApi().selectedRows();\r\n\t\t\t\tthis.selectedItem = this.updateBindableItem(selectedRows);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setSelectedItem(args);\r\n\t\t\t}\r\n\t\t\tconst dirtyRows = this.getSohoXiApi().dirtyRows();\r\n\t\t\tthis.dirtyItems = this.updateBindableItem(dirtyRows);\r\n\t\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_UPDATED);\r\n\t\t\tthis.trigger(InteractionTriggerEnum.ON_COLUMN_UPDATED + args.column.id);\r\n\t\t}\r\n\t\tthis.datagridOptions.dataset[args.row][args.column.field] = args.value;\r\n\r\n\t\tthis.setSummaryRowOutput();\r\n\t}\r\n\r\n\tprivate onSettingsChanged(args: IDatagridSettings): void {\r\n\t\tthis.previousAttributes.activePage = args.activePage;\r\n\t\tthis.previousAttributes.sortOrder = args.sortOrder;\r\n\t}\r\n\r\n\tprivate setSelectedItem(selectedRow: IDatagridColumnArgs<any>): void {\r\n\t\tthis.selectedItem = angular.copy(selectedRow.rowData);\r\n\r\n\t\tconst column = (selectedRow.column as IExtendedDataGridColumn);\r\n\t\tconst formatterName = column.formatterName;\r\n\r\n\t\tif (!Helper.isUndefinedEmpty(selectedRow.value) &&\r\n\t\t\t(formatterName === FormatterEnum.Date ||\r\n\t\t\tformatterName === FormatterEnum.Time ||\r\n\t\t\tformatterName === FormatterEnum.Datetime)\r\n\t\t) {\r\n\t\t\tconst locale = this.frameworkService.getCurrentLanguage();\r\n\r\n\t\t\tthis.selectedItem[column.field] =\r\n\t\t\t\tDatagridHelper.convertDatetimeToTicks(selectedRow, locale);\r\n\t\t}\r\n\r\n\t\t//MUPS-2736: remove when fixed in IDS\r\n\t\tthis.clearSummaryRow();\r\n\t}\r\n\r\n\tprivate refreshDatagridTriggers(): void {\r\n\t\tDatagrid.SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t\t[\r\n\t\t\t\tInteractionPairOperation.ON_ITEM_CHANGED,\r\n\t\t\t\tInteractionPairOperation.ON_ITEM_UPDATED\r\n\t\t\t]\r\n\t\t);\r\n\t\tif (this.databearer.columns.length > 0) {\r\n\t\t\tthis.databearer.columns.forEach((column) => {\r\n\t\t\t\tif (column.editable) {\r\n\t\t\t\t\tDatagrid.SOURCE_TRIGGERS.push({\r\n\t\t\t\t\t\tname: `On Column Updated (${column.name})`,\r\n\t\t\t\t\t\tvalue: InteractionTriggerEnum.ON_COLUMN_UPDATED + column.id\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (column.formatterName === FormatterEnum.Button) {\r\n\t\t\t\t\t\tDatagrid.SOURCE_TRIGGERS.push({\r\n\t\t\t\t\t\t\tname: `On Button Clicked (${column.name})`,\r\n\t\t\t\t\t\t\tvalue: InteractionTriggerEnum.CLICK + column.id\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadOptions(column: IExtendedDataGridColumn): void {\r\n\t\tconst dataservice = this.frameworkService.getDatasourceObject(column.listOptions.sourceId);\r\n\t\tif (dataservice) {\r\n\t\t\tthis.isLoading = true;\r\n\t\t\tdataservice.getListData({}).then((listResult) => {\r\n\t\t\t\tconst autoData = DatagridHelper.addColumnData(column, listResult, dataservice);\r\n\t\t\t\t// If autocomplete then add source-setting\r\n\t\t\t\tif (column.formatterName === FormatterEnum.Autocomplete) {\r\n\t\t\t\t\tcolumn.editorOptions = { \"source\": this.SOURCE_SETTING };\r\n\t\t\t\t\tthis.autocompleteSource = autoData;\r\n\t\t\t\t}\r\n\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\tthis.setErrorTooltip(errorResponse.message);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.isLoading = false;\r\n\t\t\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate SOURCE_SETTING = (request: string, response: Function) => {\r\n\t\tconst matches: string[] = [];\r\n\t\tthis.autocompleteSource.forEach((dataItem) => {\r\n\t\t\tif (dataItem.toLowerCase().indexOf(request.toLowerCase()) !== -1) {\r\n\t\t\t\tmatches.push(dataItem);\r\n\t\t\t}\r\n\t\t});\r\n\t\tresponse(request, matches);\r\n\t}\r\n\r\n\tprivate shouldHaveSummaryRow(databearer: IJsonDatagrid): boolean {\r\n\t\treturn databearer.columns.find((column) => column.summarize) !== undefined;\r\n\t}\r\n\r\n\tprivate clearSummaryRow(): void {\r\n\t\tconst summaryRowCells = this.getGridElement().find(\".datagrid-summary-row > td\");\r\n\t\tif (summaryRowCells && summaryRowCells.length > 0) {\r\n\t\t\tthis.databearer.columns.forEach((column, index) => {\r\n\t\t\t\tif (!column.summarize) {\r\n\t\t\t\t\tconst cell = $(\".datagrid-cell-wrapper\", summaryRowCells[index]);\r\n\t\t\t\t\tif (cell.length > 0) {\r\n\t\t\t\t\t\tcell.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./datagrid.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { Helper } from \"../../common/helper\";\r\nimport type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { ILookupApi, ILookupOptions } from \"../../common/model/sohoxi/sohoxi-lookup.model\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tInteractionActionEnum, InteractionPairOperation, InteractionTriggerEnum, SettingInputKeys,\r\n\tSettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport class Lookup extends Component {\r\n\tstatic AVAILABLE_WIDTHS: IDataPair[] = [\r\n\t\t{ name: \"Small\", value: \"input-sm\" },\r\n\t\t{ name: \"Medium\", value: \"input-mm\" },\r\n\t\t{ name: \"Large\", value: \"input-default\" }\r\n\t];\r\n\tstatic OUTPUT_SETTING_TITLE = \"Dialog Output Value\";\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = [\r\n\t\tInteractionPairOperation.ON_CLICK\r\n\t];\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_CLICK;\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] =\r\n\t[{\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Text\",\r\n\t\tref: SettingKeys.TEXT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Selected Item\",\r\n\t\tref: SettingKeys.SELECTED_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true,\r\n\t}];\r\n\r\n\tstatic SETTING_FIELDS =\r\n\t\t([\r\n\t\t\t{\r\n\t\t\t\ttitle: Lookup.OUTPUT_SETTING_TITLE,\r\n\t\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\tdataset: [],\r\n\t\t\t\t\ttitle: \"\",\r\n\t\t\t\t\tref: SettingKeys.LOOKUP_OUTPUT_ID,\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Width\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.BOX_WIDTH,\r\n\t\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\t\tdataset: Lookup.AVAILABLE_WIDTHS,\r\n\t\t\t\t\tdefaultValue: \"input-default\",\r\n\t\t\t\t}]\r\n\t\t\t}\r\n\t\t] as IComponentSettingCategory[])\r\n\t\t\t.concat(Component.SETTING_FIELDS);\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\ttext: string;\r\n\tlookupOptions: ILookupOptions;\r\n\tboxWidth: string;\r\n\tprotected databearer: IJsonLookup;\r\n\tprivate lookupCallback: Function;\r\n\tprivate selectedItem: IMap<any>;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonLookup,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\tthis.initLookupOptions();\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\tthis.setBoundarySettingIfChanged<string>(SettingKeys.BOX_WIDTH);\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.text = \"\";\r\n\t\tthis.selectedItem = null;\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tonChildrenReady(): void {\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tprivate initLookupOptions(): void {\r\n\t\tthis.lookupOptions = {\r\n\t\t\ttitle: \"Select Item\",\r\n\t\t\tfield: (selectedRow: IMap<string>) => {\r\n\t\t\t\tthis.selectedItem = selectedRow;\r\n\t\t\t\tconst selectedOutput = selectedRow[this.databearer.lookupOutputId];\r\n\t\t\t\treturn selectedOutput;\r\n\t\t\t},\r\n\t\t\tbeforeShow: (lookup: any, callback: Function) => {\r\n\t\t\t\tif (Helper.isUndefinedOrNull(this.datasource)) {\r\n\t\t\t\t\tthis.setErrorTooltip(`No data service available on component: ${this.getDisplayName()}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.lookupCallback = callback;\r\n\t\t\t\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmatch: () => {\r\n\t\t\t\t// fake function to bypass an issue on soho-code.\r\n\t\t\t},\r\n\t\t\toptions: {\r\n\t\t\t\tpaging: true,\r\n\t\t\t\tpagesize: 10,\r\n\t\t\t\tcolumns: this.databearer.columns,\r\n\t\t\t\tdataset: [],\r\n\t\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\t\ttoolbar: {\r\n\t\t\t\t\tkeywordFilter: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tupdateValuesWithTranslations(): void {\r\n\t\tthis.databearer.columns.forEach((column) => {\r\n\t\t\tconst translatedTitle = this.frameworkService.getTranslatableStringByProperty(\r\n\t\t\t\tthis.getId(),\r\n\t\t\t\tcolumn.id\r\n\t\t\t);\r\n\r\n\t\t\tif (translatedTitle) {\r\n\t\t\t\tconst globalString = this.frameworkService.getGlobalValue(translatedTitle, this);\r\n\r\n\t\t\t\tif (globalString) {\r\n\t\t\t\t\tcolumn.value = translatedTitle;\r\n\t\t\t\t\tcolumn.name = Helper.htmlEncode(globalString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcolumn.name = Helper.htmlEncode(translatedTitle);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tconst listData = this.getContext().ListResult;\r\n\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.CLEAR) {\r\n\t\t\treturn interactionPromise;\r\n\t\t}\r\n\r\n\t\tif (!listData) {\r\n\t\t\tinteractionPromise.then(dataset => this.openLookupDialog(dataset, interaction));\r\n\t\t} else {\r\n\t\t\tthis.openLookupDialog(listData, interaction);\r\n\t\t}\r\n\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tgetSohoXiApi(): ILookupApi {\r\n\t\treturn this.element.find(`#${this.getDatabearer().id}`).data(\"lookup\");\r\n\t}\r\n\r\n\tprivate openLookupDialog(dataset: any, interaction: IInteraction): void {\r\n\t\tif (interaction.sourceTriggerName === InteractionTriggerEnum.CLICK) {\r\n\t\t\tthis.lookupOptions.options.dataset = angular.copy(dataset);\r\n\t\t\tthis.getSohoXiApi().updated(this.lookupOptions);\r\n\t\t\tthis.getScope().$applyAsync(() => {\r\n\t\t\t\tthis.lookupCallback();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./lookup.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import { Flexbox } from \"../flexbox/flexbox\";\r\nimport { Tabs } from \"./tabs\";\r\n\r\nimport { DEFAULT_BOUNDARY, SettingInputKeys, SettingKeys, SidebarTabTypes } from \"ng2/common/constants/common.constant\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport type { IJsonTabPanel } from \"../../common/model/component/tabs.model\";\r\n\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class TabPanel extends Flexbox {\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] = Flexbox.SETTING_FIELDS\r\n\t\t.filter((settingCategory) => {\r\n\t\t\tconst toBeRemoved = settingCategory.settings.some((setting) => {\r\n\t\t\t\tswitch (setting.ref) {\r\n\t\t\t\t\tcase SettingKeys.SIZE:\r\n\t\t\t\t\tcase SettingKeys.VISIBILITY:\r\n\t\t\t\t\tcase SettingKeys.MARGIN:\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst removeSetting = false;\r\n\t\t\tconst keepSetting = true;\r\n\t\t\treturn toBeRemoved ? removeSetting : keepSetting;\r\n\t\t}).concat({\r\n\t\t\ttitle: \"Padding\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Padding\",\r\n\t\t\t\tref: SettingKeys.MARGIN,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.MARGIN,\r\n\t\t\t\tdefaultValue: { left: 0, top: 10, right: 0, bottom: 0 }\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Visibility\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tcondition: \"hide\",\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Component\",\r\n\t\t\t\tref: SettingKeys.VISIBILITY,\r\n\t\t\t\tinputType: SettingInputKeys.SWITCH,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tdefaultValue: true\r\n\t\t\t}] //Hide setting but getting the default value\r\n\t\t});\r\n\r\n\tparent: Tabs;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTabPanel,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: Tabs,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj as IJsonFlexbox, $element, parent, frameworkService);\r\n\t\tthis.newBoundaryEntered(frameworkService.getCurrentBoundary().id);\r\n\t\tthis.parent = parent;\r\n\r\n\t\tthis.canCut = !this.tabsParent();\r\n\r\n\t\tif (obj) {\r\n\t\t\tthis.backgroundColor = obj.backgroundColor;\r\n\t\t}\r\n\t}\r\n\r\n\tcanDelete(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate tabsParent(): boolean {\r\n\t\treturn this.parent.getTypedef() === Tabs.name;\r\n\t}\r\n\r\n\tupdateVisibility(): void {\r\n\t\tsuper.updateVisibility();\r\n\r\n\t\tif (this.tabsParent()) {\r\n\t\t\tconst isVisible: boolean = this.getId() === this.parent.currentTab.id;\r\n\t\t\tthis.isVisible = isVisible;\r\n\t\t\tthis.databearer.boundarySettings[DEFAULT_BOUNDARY.id].visibility = isVisible;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./tab-panel.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import {\r\n\tNg1StateDeclaration,\r\n\tStateProvider,\r\n\tUrlRouterProvider,\r\n} from \"@uirouter/angularjs\";\r\n\r\nimport { AppTypeEnum, Config } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nexport class AppState {\r\n\tstatic HOME: Ng1StateDeclaration = {\r\n\t\turl: \"/\",\r\n\t\tname: \"home\",\r\n\t\ttemplate: \"<eir-dashboard></eir-dashboard>\",\r\n\t\treloadOnSearch: false,\r\n\t};\r\n\r\n\tstatic EDITOR: Ng1StateDeclaration = {\r\n\t\turl: \"/editor/:id/:reloadProject?\",\r\n\t\tname: \"editor\",\r\n\t\ttemplate: \"<eir-editor></eir-editor>\",\r\n\t\treloadOnSearch: false,\r\n\t};\r\n\r\n\tstatic APP_LAUNCHER: Ng1StateDeclaration = {\r\n\t\turl: \"/\" + Config.RUN_PATH + \":id\",\r\n\t\tname: \"appLauncher\",\r\n\t\tcomponent: \"eirAppLauncher\",\r\n\t\treloadOnSearch: false,\r\n\t\tresolve: {\r\n\t\t\tappType: (): AppTypeEnum => AppTypeEnum.DESIGNER_PREVIEW,\r\n\t\t\tprojectId: [\r\n\t\t\t\tAngularConstants.STATE_PARAMS,\r\n\t\t\t\t($stateParams: ng.ui.IStateParamsService): void => $stateParams.id\r\n\t\t\t],\r\n\t\t}\r\n\t};\r\n\r\n\tstatic REPOSITORY: Ng1StateDeclaration = {\r\n\t\turl: \"/repository\",\r\n\t\tname: \"repository\",\r\n\t\ttemplate: \"<eir-repository></eir-repository>\",\r\n\t};\r\n\r\n\tstatic DEVELOPER: Ng1StateDeclaration = {\r\n\t\turl: \"/developer\",\r\n\t\tname: \"developer\",\r\n\t\ttemplate: \"<eir-developer-tool></eir-developer-tool>\",\r\n\t};\r\n\r\n\tstatic REFRESH: Ng1StateDeclaration = {\r\n\t\turl: \"/refresh\",\r\n\t\tname: \"refresh\",\r\n\t\ttemplate: \"\",\r\n\t\treloadOnSearch: false,\r\n\t};\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.config([\r\n\t\t\t\"$stateProvider\",\r\n\t\t\t\"$urlRouterProvider\", (\r\n\t\t\t\t$stateProvider: StateProvider,\r\n\t\t\t\t$urlRouterProvider: UrlRouterProvider,\r\n\t\t\t) => {\r\n\t\t\t\t$urlRouterProvider.otherwise(\"/\");\r\n\r\n\t\t\t\t$stateProvider\r\n\t\t\t\t\t.state(AppState.HOME)\r\n\t\t\t\t\t.state(AppState.EDITOR)\r\n\t\t\t\t\t.state(AppState.APP_LAUNCHER)\r\n\t\t\t\t\t.state(AppState.REPOSITORY)\r\n\t\t\t\t\t.state(AppState.REFRESH)\r\n\t\t\t\t\t.state(AppState.DEVELOPER);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\nimport { InstanceEvent } from \"../../../common/instance-event\";\r\n\r\nexport interface IUndoAction {\r\n\tstateRootComponent: IJsonComponent;\r\n\tstateInteractions: Interaction[];\r\n\tstateTranslations: IMap<IJsonLanguageComponent[]>;\r\n}\r\n\r\nexport class UndoService {\r\n\tpublic undoActionEvent = new InstanceEvent<IUndoAction>();\r\n\tprivate undoStack: IUndoAction[];\r\n\tprivate currentIndex: number;\r\n\tprivate maxUndoCount = 11;\r\n\r\n\tconstructor() {\r\n\t\tthis.initialize();\r\n\t}\r\n\r\n\tprivate initialize(): void {\r\n\t\tthis.undoStack = [];\r\n\t\tthis.currentIndex = 0;\r\n\t}\r\n\r\n\tpublic pop(): void {\r\n\t\tthis.undoStack.pop();\r\n\t}\r\n\r\n\tpublic getCurrentUndo(): IUndoAction {\r\n\t\treturn this.undoStack[this.currentIndex - 1];\r\n\t}\r\n\r\n\tpublic undoAction(): void {\r\n\t\tif (this.currentIndex > 0) {\r\n\t\t\tthis.currentIndex -= 1;\r\n\t\t}\r\n\r\n\t\t// fire undo event\r\n\t\tthis.undoActionEvent.raise(angular.copy(this.undoStack[this.currentIndex]));\r\n\t}\r\n\r\n\tpublic redoAction(): void {\r\n\t\tif (this.currentIndex < this.undoStack.length - 1) {\r\n\t\t\tthis.currentIndex += 1;\r\n\t\t}\r\n\r\n\t\t// fire redo event\r\n\t\tthis.undoActionEvent.raise(angular.copy(this.undoStack[this.currentIndex]));\r\n\t}\r\n\r\n\tpublic pushUndoAction(project: DesignerMashup): void {\r\n\t\tconst undoAction = {\r\n\t\t\tstateRootComponent: project.rootComponent,\r\n\t\t\tstateInteractions: project.getInteractions(),\r\n\t\t\tstateTranslations: project.getTranslations()\r\n\t\t};\r\n\t\tthis.undoStack.splice(this.currentIndex + 1, this.undoStack.length - 1, angular.copy(undoAction));\r\n\r\n\t\t// if stacklength > max -> remove first undo action\r\n\t\tif (this.undoStack.length > this.maxUndoCount) {\r\n\t\t\tthis.undoStack.shift();\r\n\t\t}\r\n\r\n\t\t// always point to the end of the stack\r\n\t\tthis.currentIndex = this.undoStack.length - 1;\r\n\t}\r\n\r\n\tpublic clearActions(): void {\r\n\t\tthis.initialize();\r\n\t}\r\n\r\n\tpublic isUndoAvailable(): boolean {\r\n\t\treturn this.currentIndex > 0;\r\n\t}\r\n\r\n\tpublic isRedoAvailable(): boolean {\r\n\t\treturn this.currentIndex < this.undoStack.length - 1;\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.UNDO_SERVICE, UndoService);\r\n\t}\r\n}\r\n","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../services/editor-service\";\r\nimport { SettingsBase } from \"./settings-base\";\r\n\r\nexport interface IGenericSettingsScope extends ng.IScope {\r\n\tsettingsTab: string;\r\n}\r\n\r\nexport interface ISettingController {\r\n\trefresh: () => void;\r\n}\r\n\r\nexport interface IGenericSettingScope extends ng.IScope {\r\n\tsettingMeta: IComponentFieldSetting;\r\n\tregister: (obj: {settingCtrl: ISettingController, settingRef: string}) => void;\r\n}\r\n\r\nexport class GenericSettingsCtrl extends SettingsBase {\r\n\tpublic relevantSettings: IComponentSettingCategory[];\r\n\r\n\tprivate settingInstances: IMap<ISettingController> = {};\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: IGenericSettingsScope,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t\tthis.unsubscribers.push(this.editorService.refreshSettingEvent.on((settingRef) => {\r\n\t\t\tif (this.settingInstances[settingRef]) {\r\n\t\t\t\tthis.settingInstances[settingRef].refresh();\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\r\n\tpublic registerSetting(settingCtrl: ISettingController, settingRef: string): void {\r\n\t\tthis.settingInstances[settingRef] = settingCtrl;\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tthis.selectedComponent = newComponent;\r\n\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tconst settingFields = newComponent.getSettingCategories();\r\n\t\t\tthis.relevantSettings = settingFields.filter(setting => {\r\n\t\t\t\tconst hasRelevantTab = setting.tab === this.$scope.settingsTab;\r\n\t\t\t\tlet conditionPassed = true;\r\n\t\t\t\tif (hasRelevantTab && setting.condition) {\r\n\t\t\t\t\tconditionPassed = this.$scope.$eval(`eirGenericSettingsCtrl.selectedComponent.${setting.condition}`) === true;\r\n\t\t\t\t}\r\n\t\t\t\treturn hasRelevantTab && conditionPassed;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class GenericSettingsDirective {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirGenericSettings\", () => {\r\n\t\t\treturn {\r\n\t\t\t\ttemplate: require(\"./generic-settings.html\"),\r\n\t\t\t\tscope: {\r\n\t\t\t\t\tsettingsTab: \"=\"\r\n\t\t\t\t},\r\n\t\t\t\tcontroller: GenericSettingsCtrl,\r\n\t\t\t\tcontrollerAs: \"eirGenericSettingsCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","import {\r\n\tAfterViewChecked,\r\n\tAfterViewInit,\r\n\tChangeDetectorRef,\r\n\tElementRef,\r\n\tOnDestroy,\r\n\tOnInit,\r\n\tRenderer2,\r\n\tViewChild\r\n} from \"@angular/core\";\r\nimport {\r\n\tSohoBusyIndicatorDirective,\r\n\tSohoMessageService,\r\n} from \"ids-enterprise-ng\";\r\nimport get from \"lodash-es/get\";\r\nimport isNull from \"lodash-es/isNull\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\nimport { forkJoin, Observable, of, Subscription } from \"rxjs\";\r\nimport { Subject } from \"rxjs/internal/Subject\";\r\nimport { take } from \"rxjs/operators\";\r\n\r\nimport {\r\n\tDEFAULT_BOUNDARY,\r\n\tInteractionActionEnum,\r\n\tInteractionTriggerEnum,\r\n\tNumbers,\r\n\tSettingKeys,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IComponentStyleProperties } from \"ng2/common/model/components/base/component-style.model\";\r\nimport type { IComponent } from \"ng2/common/model/components/base/component.model\";\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { ILayoutComponent } from \"ng2/common/model/components/base/layout-component.model\";\r\nimport type { IComponentSettings } from \"ng2/common/model/components/settings/component-settings.model\";\r\nimport type {\r\n\tIJsonComponent,\r\n\tIJsonComponentSettings,\r\n\tIJsonMargin,\r\n\tIJsonSize,\r\n\tTypeDef,\r\n} from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IDataService } from \"ng2/common/model/dataservice/data-service.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nimport { ButtonMetadata } from \"ng2/components/button/button.metadata\";\r\nimport { ListMetadata } from \"ng2/components/list/list.metadata\";\r\nimport { TextboxMetadata } from \"ng2/components/textbox/textbox.metadata\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\nexport abstract class BaseComponent implements\r\n\tAfterViewChecked,\r\n\tAfterViewInit,\r\n\tIComponent,\r\n\tOnDestroy,\r\n\tOnInit {\r\n\r\n\t//#region component base properties\r\n\ttypedef: TypeDef;\r\n\tid: string;\r\n\tgeneratedId?: string;\r\n\tdisplayName: string;\r\n\tboundarySettings: IMap<IJsonComponentSettings>;\r\n\r\n\tprivate _dataservice: IDataService;\r\n\tget datasource(): IDataService {\r\n\r\n\t\tconst dataserviceId = this.databearer.datasource;\r\n\t\tif (!isUndefined(dataserviceId) &&\r\n\t\t\tisUndefined(this._dataservice)\r\n\t\t) {\r\n\t\t\tconst dataserviceDatabearer = this.frameworkService.currentProject\r\n\t\t\t\t.getDatasources()[dataserviceId];\r\n\r\n\t\t\tthis._dataservice = this.frameworkService.dataServiceBuilder\r\n\t\t\t\t.create(dataserviceDatabearer);\r\n\t\t}\r\n\t\treturn this._dataservice;\r\n\t}\r\n\r\n\telement: any;\r\n\tparent: ILayoutComponent;\r\n\tcontext: IContext;\r\n\tdatabearer: IJsonComponent;\r\n\t//#endregion\r\n\r\n\t//#region component-boundary properties\r\n\tboundaryChange$ = new Subject<any>();\r\n\t//#endregion\r\n\r\n\t//#region component-status properties\r\n\tcomponentReady$ = new Subject<IComponent>();\r\n\tisLoading = false;\r\n\r\n\tisVisible = true;\r\n\tisReadonly = false;\r\n\t//#endregion\r\n\r\n\t//#region component-style properties\r\n\tcssHeight: string;\r\n\tcssWidth: string;\r\n\t//#endregion\r\n\r\n\t//#region component-interactio properties\r\n\tcontextData$: Observable<any>;\r\n\tsubscriptions: Subscription[] = [];\r\n\t//#endregion\r\n\r\n\t@ViewChild(SohoBusyIndicatorDirective, {\r\n\t\tstatic: true\r\n\t}) busyIndicator: SohoBusyIndicatorDirective;\r\n\r\n\tconstructor(\r\n\t\tprotected elementRef: ElementRef,\r\n\t\tprotected renderer: Renderer2,\r\n\t\tprotected changeDetectorRef: ChangeDetectorRef,\r\n\t\tprotected frameworkService: FrameworkService,\r\n\t\tprotected dynamicComponentService: DynamicComponentService,\r\n\t\tprotected sohoMessageService: SohoMessageService,\r\n\t) { }\r\n\r\n\tngOnInit(): void {\r\n\t\tthis.parent.element = this.elementRef.nativeElement.parentElement;\r\n\t\tthis.onInitComponent();\r\n\t}\r\n\r\n\tngAfterViewInit(): void {\r\n\t\tthis.setInitialSohoComponentSettings();\r\n\t\tconsole.info(`ID: ${this.displayName}, TYPEDEF: ${this.typedef}: ngAfterViewInit`);\r\n\r\n\t\tthis.componentReady$.next(this);\r\n\t}\r\n\r\n\tngAfterViewChecked(): void {\r\n\t\t// Need otherwise Homepages SDK throws exception\r\n\t\tthis.changeDetectorRef.detectChanges();\r\n\t}\r\n\r\n\tngOnDestroy(): void {\r\n\r\n\t\tconsole.info(`ID: ${this.displayName}, TYPEDEF: ${this.typedef}: ngOnDestroy`);\r\n\r\n\t\tthis.componentReady$.unsubscribe();\r\n\t\tthis.boundaryChange$.unsubscribe();\r\n\r\n\t\tthis.subscriptions\r\n\t\t\t.forEach(subscription => subscription.unsubscribe());\r\n\t}\r\n\r\n\tonInitComponent(): void {\r\n\t\tconsole.info(`ID: ${this.displayName}, TYPEDEF: ${this.typedef}: onInitComponent`);\r\n\t\tthis.updateClassesAndInlineStyles();\r\n\t}\r\n\r\n\tcalcNewSizes(): void {\r\n\t\tthis.calcNewWidth();\r\n\t\tthis.calcNewHeight();\r\n\t}\r\n\r\n\tcalcNewWidth(): void {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tthis.cssWidth = this.calcNewSize(\r\n\t\t\tthis.getBoundarySetting<IJsonSize>(SettingKeys.WIDTH),\r\n\t\t\tOrientationEnum.HORIZONTAL, margin.left + margin.right\r\n\t\t);\r\n\t}\r\n\r\n\tcalcNewHeight(): void {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tthis.cssHeight = this.calcNewSize(\r\n\t\t\tthis.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT),\r\n\t\t\tOrientationEnum.VERTICAL, margin.top + margin.bottom\r\n\t\t);\r\n\t}\r\n\r\n\tprotected calcNewSize(sizeObject: IJsonSize, orientation: OrientationEnum, margin = 0): string {\r\n\t\tlet retSize = \"\";\r\n\t\tif (this.parent.hasIndividualChildSizes) {\r\n\t\t\tif (sizeObject.sizeType === SizeTypeEnum.PERCENT) {\r\n\t\t\t\tconst pxPerPercentComponent = this.parent.getPxPerPercentComponent(orientation, sizeObject.value);\r\n\t\t\t\tretSize = `calc(${sizeObject.value || Numbers.HUNDRED}% - ${pxPerPercentComponent + margin}px)`;\r\n\t\t\t} else if (sizeObject.sizeType === SizeTypeEnum.PIXELS) {\r\n\t\t\t\tretSize = \"calc(\" + sizeObject.value + \"px)\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn retSize;\r\n\t}\r\n\r\n\tgetInlineStyles(): IComponentStyleProperties {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\treturn {\r\n\t\t\twidth: this.cssWidth,\r\n\t\t\theight: this.cssHeight,\r\n\t\t\tmargin: `${margin.top}px ${margin.right}px ${margin.bottom}px ${margin.left}px`,\r\n\t\t};\r\n\t}\r\n\r\n\tsetStyles(styles: IComponentStyleProperties): void {\r\n\t\tfor (const propertyName in styles) {\r\n\t\t\tif (styles.hasOwnProperty(propertyName)) {\r\n\t\t\t\tconst propertyValue = styles[propertyName];\r\n\t\t\t\tthis.renderer.setStyle(\r\n\t\t\t\t\tthis.parent.element,\r\n\t\t\t\t\tpropertyName,\r\n\t\t\t\t\t!isNull(propertyValue) ? propertyValue : \"\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tupdateClassesAndInlineStyles(): void {\r\n\r\n\t\tconsole.info(`ID: ${this.displayName}, TYPEDEF: ${this.typedef}: updateClassesAndInlineStyles`);\r\n\r\n\t\tthis.updateClassNames();\r\n\t\tthis.updateInlineStyles();\r\n\t}\r\n\r\n\tupdateClassNames(): void { }\r\n\r\n\tupdateInlineStyles(): void {\r\n\r\n\t\tthis.calcNewSizes();\r\n\r\n\t\tconst componentStyleProperties = this.getInlineStyles();\r\n\r\n\t\tthis.setStyles(componentStyleProperties);\r\n\t}\r\n\r\n\tgetBoundarySetting<T>(\r\n\t\tsettingId: string,\r\n\t\tboundaryId?: string,\r\n\t\tnoTraverse?: boolean\r\n\t): T {\r\n\t\tconst componentBoundarySettings = this.databearer.boundarySettings;\r\n\r\n\t\tif (!boundaryId) {\r\n\t\t\tboundaryId = this.frameworkService.currentBoundary.id;\r\n\t\t}\r\n\t\tif (noTraverse) {\r\n\t\t\t//Should return a copy, List needs some work\r\n\t\t\treturn (componentBoundarySettings[boundaryId] as IMap<T>)[settingId];\r\n\t\t}\r\n\r\n\t\tlet boundarySettings: IComponentSettings;\r\n\t\twhile (!boundarySettings) {\r\n\t\t\tif (!componentBoundarySettings[boundaryId] ||\r\n\t\t\t\t(componentBoundarySettings[boundaryId] as IMap<T>)[settingId] === undefined ||\r\n\t\t\t\t(componentBoundarySettings[boundaryId] as IMap<T>)[settingId] === null\r\n\t\t\t) {\r\n\t\t\t\tboundaryId = this.frameworkService.getNextProjectBoundary(boundaryId).id;\r\n\r\n\t\t\t\tif (boundaryId === DEFAULT_BOUNDARY.id) {\r\n\t\t\t\t\tboundarySettings = componentBoundarySettings[DEFAULT_BOUNDARY.id];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\tboundarySettings = componentBoundarySettings[boundaryId];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn (boundarySettings as IMap<T>)[settingId];\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonComponent {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): Observable<any> {\r\n\r\n\t\tconst isDataserviceAction = (targetActionName: string) => {\r\n\t\t\tswitch (targetActionName) {\r\n\t\t\t\tcase InteractionActionEnum.CLEAR:\r\n\t\t\t\t\treturn false;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t};\r\n\t\tif (isDataserviceAction(interaction.targetActionName)) {\r\n\t\t\treturn this.runComponentDataService(interaction);\r\n\t\t} else {\r\n\t\t\treturn this.runComponentAction(interaction);\r\n\t\t}\r\n\t}\r\n\r\n\trunComponentAction(interaction: IInteraction): Observable<any> {\r\n\t\tswitch (interaction.targetActionName) {\r\n\t\t\tcase InteractionActionEnum.CLEAR:\r\n\t\t\t\tthis.clear();\r\n\t\t\t\treturn of(true);\r\n\t\t\tdefault:\r\n\t\t\t\treturn Observable.throw(\"Unknown action\");\r\n\t\t}\r\n\t}\r\n\r\n\trunComponentDataService(interaction: IInteraction): Observable<any> {\r\n\r\n\t\tthis.busyIndicator.activated = true;\r\n\t\tconst parameters = interaction.getParameters();\r\n\t\tlet newObservable: Observable<any>;\r\n\r\n\t\tswitch (interaction.targetActionName) {\r\n\t\t\tcase InteractionActionEnum.LIST:\r\n\r\n\t\t\t\tnewObservable = this.datasource\r\n\t\t\t\t\t.getListData(parameters)\r\n\t\t\t\t\t.pipe(take(1));\r\n\r\n\t\t\t\tnewObservable.subscribe(\r\n\t\t\t\t\tdata => this.context.ListResult = data,\r\n\t\t\t\t\t(error) => this.dataServiceError(this, error),\r\n\t\t\t\t\t() => this.dataServiceCompleted(this)\r\n\t\t\t\t);\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase InteractionActionEnum.GET:\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tnewObservable = this.datasource\r\n\t\t\t\t\t.getListData(parameters)\r\n\t\t\t\t\t.pipe(take(1));\r\n\r\n\t\t\t\tnewObservable.subscribe(\r\n\t\t\t\t\tdata => this.context.DetailResult = data,\r\n\t\t\t\t\t(error) => this.dataServiceError(this, error),\r\n\t\t\t\t\t() => this.dataServiceCompleted(this)\r\n\t\t\t\t);\r\n\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn newObservable;\r\n\t}\r\n\r\n\tdataServiceError(component: any, error: Error): void {\r\n\t\tthis.busyIndicator.activated = false;\r\n\r\n\t\tthis.showErrorDialog(error.message);\r\n\t}\r\n\r\n\tdataServiceCompleted(component: any): void {\r\n\t\tcomponent.busyIndicator.activated = false;\r\n\t\tthis.trigger(InteractionTriggerEnum.ON_LOAD);\r\n\t}\r\n\r\n\t// To be able to call forEachChild on arbitrary component\r\n\tforEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void {\r\n\t\tfn(this);\r\n\t}\r\n\r\n\tinitializeBinding(componentDatabearer: IJsonComponent): void {\r\n\r\n\t}\r\n\r\n\tupdateBindings(): void {\r\n\r\n\t\tthis.dynamicComponentService\r\n\t\t\t.componentRefs\r\n\t\t\t.forEach(componentRef => {\r\n\r\n\t\t\t\tconst componentInstance = componentRef.instance;\r\n\r\n\t\t\t\tlet componentMetaData: IJsonBindableField[];\r\n\t\t\t\tswitch (componentInstance.typedef) {\r\n\t\t\t\t\tcase \"Button\":\r\n\t\t\t\t\t\tcomponentMetaData = ButtonMetadata.BINDABLE_FIELDS_2;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase \"Dropdown\":\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase \"Flexbox\":\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase \"List\":\r\n\t\t\t\t\t\tcomponentMetaData = ListMetadata.BINDABLE_FIELDS_2;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase \"Textbox\":\r\n\t\t\t\t\tcase \"TextBox\":\r\n\t\t\t\t\t\tcomponentMetaData = TextboxMetadata.BINDABLE_FIELDS_2;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tthrow Error(\"Invalid component\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcomponentMetaData?.forEach(bindable => {\r\n\t\t\t\t\tconst sourceKey =\r\n\t\t\t\t\t\tcomponentInstance.databearer[bindable.ref]?.sourceKey;\r\n\r\n\t\t\t\t\tif (sourceKey) {\r\n\t\t\t\t\t\tconst value = get(this, sourceKey);\r\n\r\n\t\t\t\t\t\tcomponentInstance[bindable.ref] = value;\r\n\t\t\t\t\t\tconsole.info(\"sourceKey: \" + sourceKey + \", value: \" + value);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t});\r\n\t}\r\n\r\n\tsetInitialSohoComponentSettings(): void {\r\n\t\tthis.busyIndicator.displayDelay = 0;\r\n\t}\r\n\r\n\tclear(): void {\r\n\r\n\t}\r\n\r\n\ttrigger(interactionTrigger: InteractionTriggerEnum): Observable<any> {\r\n\r\n\t\tconst interactions = this.frameworkService\r\n\t\t\t.getInteractionByTriggerName(interactionTrigger)\r\n\t\t\t.filter(interaction => interaction.sourceName === this.id);\r\n\r\n\t\tconst observables: Observable<any>[] = [];\r\n\r\n\t\tinteractions.forEach(interaction => {\r\n\t\t\tobservables.push(\r\n\t\t\t\tthis.frameworkService.runInteraction(interaction));\r\n\t\t});\r\n\r\n\t\treturn forkJoin(observables);\r\n\t}\r\n\r\n\tshowErrorDialog(message: string): void {\r\n\r\n\t\tconst buttons = [\r\n\t\t\t{\r\n\t\t\t\ttext: \"OK\",\r\n\t\t\t\tclick: (_: JQuery.TriggeredEvent, modal: SohoModalStatic) => modal.close(true),\r\n\t\t\t\tisDefault: true\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tthis.sohoMessageService\r\n\t\t\t.error()\r\n\t\t\t.title(\"Error\")\r\n\t\t\t.buttons(buttons)\r\n\t\t\t.message(message)\r\n\t\t\t.open();\r\n\t}\r\n\r\n\tonBoundaryChange(boundary: IBoundary): Observable<void> {\r\n\r\n\t\tthis.updateClassesAndInlineStyles();\r\n\r\n\t\tthis.isVisible = this.getBoundarySetting<boolean>(\r\n\t\t\tSettingKeys.VISIBILITY,\r\n\t\t\tboundary.id\r\n\t\t);\r\n\t\tconst componentELement = this.elementRef.nativeElement;\r\n\r\n\t\t!this.isVisible ?\r\n\t\t\tthis.renderer.addClass(componentELement, \"is-hidden\") :\r\n\t\t\tthis.renderer.removeClass(componentELement, \"is-hidden\");\r\n\r\n\t\tthis.boundaryChange$.next(this);\r\n\t\tthis.changeDetectorRef.detectChanges();\r\n\r\n\t\t// TODO: fix so it maybe returns a BoundaryResponse?\r\n\t\treturn of();\r\n\t}\r\n}\r\n","import {\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\n\r\nexport class BaseComponentMetadata {\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] = [\r\n\t\t{\r\n\t\t\ttitle: \"Margin\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Margin\",\r\n\t\t\t\t\tref: SettingKeys.MARGIN,\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tinputType: SettingInputKeys.MARGIN,\r\n\t\t\t\t\tdefaultValue: { left: 0, top: 0, right: 0, bottom: 0 },\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Visibility\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Show Component\",\r\n\t\t\t\t\tref: SettingKeys.VISIBILITY,\r\n\t\t\t\t\tinputType: SettingInputKeys.SWITCH,\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-preview\",\r\n\t\t\t\t\t\ttooltip: \"Hide Component When...\",\r\n\t\t\t\t\t\tdialog: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Show Error\",\r\n\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Show Error\",\r\n\t\t\t\t\tref: SettingKeys.SHOW_ERROR,\r\n\t\t\t\t\tinputType: SettingInputKeys.SWITCH,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t},\r\n\t];\r\n}\r\n","\r\nimport type { IJsonRuntimeMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IRuntimeManifest } from \"ng2/common/model/project/mashup/runtime-manifest.model\";\r\n\r\nimport { RuntimeManifest } from \"ng2/common/project/manifest/runtime-manifest\";\r\nimport { Mashup } from \"ng2/common/project/mashup\";\r\n\r\nexport class RuntimeApp extends Mashup {\r\n\tmanifest: IRuntimeManifest;\r\n\r\n\tgetManifest(): IRuntimeManifest {\r\n\t\treturn this.manifest;\r\n\t}\r\n\r\n\tstatic fromObj(obj: IJsonRuntimeMashup): RuntimeApp {\r\n\t\tconst runtimeApp = Mashup.create(RuntimeApp, RuntimeManifest, obj);\r\n\r\n\t\treturn runtimeApp;\r\n\t}\r\n}\r\n","import type { ICustomComponentDefinition } from \"ng2/common/model/components/custom-component-definition.model\";\r\nimport type { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport type { IJsonCustomComponentDefinition } from \"ng2/common/model/databearer/components/json-custom-component-def.model\";\r\nimport type { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonBoundary } from \"ng2/common/model/databearer/json-boundary.model\";\r\nimport type { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport type { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\nimport type { IMashup } from \"ng2/common/model/project/mashup/mashup.model\";\r\n\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\n/**\r\n * Possibly refactor so that Mashup corresponds to the actual metadata of the Application\r\n */\r\nexport abstract class Mashup implements IMashup {\r\n\tmanifest: IJsonManifest;\r\n\trootComponent: IJsonLayoutComponent;\r\n\tdatabearer: IJsonMashup;\r\n\r\n\tdatasources: IMap<IJsonDatasource> = {};\r\n\tinteractions: Interaction[] = [];\r\n\tcustomComponentDefinitions: IMap<IJsonCustomComponentDefinition> = {};\r\n\tcompositeComponents: IJsonCompositeComponent[] = [];\r\n\ttranslations: IMap<IJsonLanguageComponent[]> = {};\r\n\ttags: IJsonTag[] = [];\r\n\texpressions?: IJsonExpression[] = [];\r\n\r\n\tgetManifest(): IJsonManifest {\r\n\t\treturn this.manifest;\r\n\t}\r\n\r\n\tgetId(): string {\r\n\t\treturn this.manifest.id;\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonMashup {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tsetRoot(componentObject: IJsonLayoutComponent): void {\r\n\t\tthis.rootComponent = componentObject;\r\n\t}\r\n\r\n\t//#region /* Expressions */\r\n\tgetExpressions(): IJsonExpression[] {\r\n\t\treturn this.expressions;\r\n\t}\r\n\r\n\tgetExpressionsByComponentId(componentId: string): IJsonExpression[] {\r\n\t\treturn this.expressions.filter((expression) => {\r\n\t\t\treturn expression.usedBy === componentId;\r\n\t\t});\r\n\t}\r\n\r\n\taddExpression(expression: IJsonExpression): void {\r\n\t\tthis.expressions.push(expression);\r\n\t}\r\n\r\n\tdeleteExpression(deletedExpression: IJsonExpression): void {\r\n\t\tthis.expressions = this.expressions.filter((expression) => {\r\n\t\t\treturn expression.id !== deletedExpression.id;\r\n\t\t});\r\n\t}\r\n\r\n\tremoveExpression(componentId: string): void {\r\n\t\tthis.expressions = this.expressions.filter((expression) => {\r\n\t\t\treturn expression.source !== componentId && expression.target !== componentId;\r\n\t\t});\r\n\t}\r\n\r\n\tsaveExpression(savedExpression: IJsonExpression): void {\r\n\t\tconst expressionIndex = this.expressions.findIndex((expression) => {\r\n\t\t\treturn expression.id === savedExpression.id;\r\n\t\t});\r\n\t\tthis.expressions[expressionIndex] = savedExpression;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Datasources */\r\n\tgetDatasources(): IMap<IJsonDatasource> {\r\n\t\treturn this.datasources;\r\n\t}\r\n\r\n\tgetDatasource(dsName: string): IJsonDatasource {\r\n\t\treturn this.datasources[dsName];\r\n\t}\r\n\r\n\tgetDatasourceDatabearers(): IJsonDatasource[] {\r\n\t\tconst datasourceDatabearers: IJsonDatasource[] = [];\r\n\t\tfor (const key in this.datasources) {\r\n\t\t\tdatasourceDatabearers.push(this.datasources[key]);\r\n\t\t}\r\n\t\treturn datasourceDatabearers;\r\n\t}\r\n\r\n\taddDatasource(datasource: IJsonDatasource): void {\r\n\t\tthis.datasources[datasource.id] = datasource;\r\n\t}\r\n\r\n\tremoveDatasource(datasourceId: string): IJsonDatasource {\r\n\t\tconst removedDataservice = this.datasources[datasourceId];\r\n\t\tdelete this.datasources[datasourceId];\r\n\t\treturn removedDataservice;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Interactions */\r\n\tgetInteractions(): Interaction[] {\r\n\t\treturn this.interactions;\r\n\t}\r\n\r\n\tgetInteractionDatabearers(): IJsonInteraction[] {\r\n\t\treturn this.interactions.map<IJsonInteraction>((interaction) => {\r\n\t\t\treturn interaction.getDatabearer();\r\n\t\t});\r\n\t}\r\n\r\n\tsetInteractions(interactions: Interaction[]): void {\r\n\t\tthis.interactions = interactions;\r\n\t}\r\n\r\n\taddInteraction(interaction: Interaction): void {\r\n\t\tthis.interactions.push(interaction);\r\n\t}\r\n\r\n\tremoveInteraction(toRemoveInteraction: Interaction): void {\r\n\t\tconst index = this.interactions\r\n\t\t\t.findIndex(interaction => interaction.getId() === toRemoveInteraction.getId());\r\n\t\tthis.interactions.splice(index, 1);\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Custom Components */\r\n\tgetCustomComponentDefinitions(): IMap<ICustomComponentDefinition> {\r\n\t\treturn this.customComponentDefinitions;\r\n\t}\r\n\r\n\taddCustomComponentDefinition(customComponent: ICustomComponentDefinition): void {\r\n\t\tthis.customComponentDefinitions[customComponent.id] = customComponent;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Composite Components */\r\n\tgetCompositeComponents(): IJsonCompositeComponent[] {\r\n\t\treturn this.compositeComponents;\r\n\t}\r\n\r\n\taddCompositeComponent(compositeComponent: IJsonCompositeComponent): void {\r\n\t\tthis.compositeComponents.push(compositeComponent);\r\n\t}\r\n\r\n\tgetCompositeComponent(compositeId: string): IJsonCompositeComponent {\r\n\t\treturn this.compositeComponents.filter((cmp) => {\r\n\t\t\treturn cmp.manifest.id === compositeId;\r\n\t\t})[0];\r\n\t}\r\n\r\n\tremoveCompositeComponent(compositeId: string): IJsonCompositeComponent {\r\n\t\tconst compositeToDelete = this.getCompositeComponent(compositeId);\r\n\t\treturn this.compositeComponents.splice(this.compositeComponents.indexOf(compositeToDelete), 1).pop();\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Tags */\r\n\tgetTags(): IJsonTag[] {\r\n\t\treturn this.tags;\r\n\t}\r\n\r\n\tsetTags(tags: IJsonTag[]): void {\r\n\t\tthis.tags = tags;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* URL Variables */\r\n\tgetUrlVariables(): IJsonUrlVariable[] {\r\n\t\treturn this.manifest.urlVariables;\r\n\t}\r\n\r\n\tsetUrlVariables(variables: IJsonUrlVariable[]): void {\r\n\t\tthis.manifest.urlVariables = variables;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region Boundaries\r\n\tgetBoundaries(): IJsonBoundary[] {\r\n\t\treturn this.manifest.mashupBoundaries;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Translations */\r\n\tsetTranslations(translations: IMap<IJsonLanguageComponent[]>): void {\r\n\t\tthis.translations = translations;\r\n\t}\r\n\r\n\tgetTranslations(): IMap<IJsonLanguageComponent[]> {\r\n\t\treturn this.translations;\r\n\t}\r\n\r\n\tgetTranslationsList(): IJsonLanguageComponent[] {\r\n\t\tlet translationList: IJsonLanguageComponent[] = [];\r\n\t\tfor (const key in this.translations) {\r\n\t\t\ttranslationList = translationList.concat(this.translations[key]);\r\n\t\t}\r\n\t\treturn translationList;\r\n\t}\r\n\r\n\tgetTranslation(componentId: string): IJsonLanguageComponent[] {\r\n\t\treturn this.translations[componentId];\r\n\t}\r\n\r\n\tremoveTranslation(componentId: string): void {\r\n\t\tdelete this.translations[componentId];\r\n\t}\r\n\r\n\t/**\r\n\t* Mapping the translations on componentId.\r\n\t* One componentId can have several translations so need to check if on exists before\r\n\t* adding new, if exists push to same.\r\n\t*\r\n\t* @\t* @param {IJsonLanguageComponent} translation\r\n\t* @returns {void}\r\n\t* @memberof DesignerMashup\r\n\t*/\r\n\taddTranslation(translation: IJsonLanguageComponent): void {\r\n\t\tif (this.getTranslation(translation.componentId)) {\r\n\t\t\tthis.translations[translation.componentId].push(translation);\r\n\t\t} else {\r\n\t\t\tthis.translations[translation.componentId] = [translation];\r\n\t\t}\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region Other\r\n\tsetPreviewImage(base64Img: string): void {\r\n\t\tthis.manifest.previewImg = base64Img;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\tstatic create<AppType extends Mashup, ManifestType extends IJsonManifest>(\r\n\t\tappType: (new () => AppType),\r\n\t\tmanifestType: (new (obj: any) => ManifestType),\r\n\t\tobj: IJsonMashup,\r\n\t): AppType {\r\n\r\n\t\tconst entry = new appType();\r\n\t\tentry.manifest = new manifestType(obj.manifest);\r\n\r\n\t\tif (obj.datasources) {\r\n\t\t\tobj.datasources.forEach((datasource: IJsonDatasource) => {\r\n\t\t\t\tentry.addDatasource(datasource);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (obj.rootComponent) {\r\n\t\t\tentry.setRoot(obj.rootComponent);\r\n\t\t}\r\n\r\n\t\tif (obj.interactions) {\r\n\t\t\tobj.interactions.forEach((interaction) => {\r\n\t\t\t\tconst newInteraction = new Interaction(interaction);\r\n\t\t\t\tentry.addInteraction(newInteraction);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (obj.translations) {\r\n\t\t\tobj.translations.forEach((translation: IJsonLanguageComponent) => {\r\n\t\t\t\tentry.addTranslation(translation);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (obj.customComponentDefinitions) {\r\n\t\t\tentry.customComponentDefinitions = obj.customComponentDefinitions;\r\n\t\t}\r\n\r\n\t\tif (obj.compositeComponents) {\r\n\t\t\tentry.compositeComponents = obj.compositeComponents;\r\n\t\t}\r\n\r\n\t\tif (obj.tags) {\r\n\t\t\tentry.tags = obj.tags;\r\n\t\t}\r\n\r\n\t\tif (obj.expressions) {\r\n\t\t\tentry.expressions = obj.expressions;\r\n\t\t}\r\n\r\n\t\treturn entry;\r\n\t}\r\n}\r\n","import jsonpath from \"jsonpath\";\r\nimport isEmpty from \"lodash-es/isEmpty\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type * as sw from \"ng2/common/model/swagger.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\n\r\nexport class JsonHelper {\r\n\t/**\r\n\t * Generate a sample object from a Swagger (JSON-) Schema.\r\n\t * Useful for displaying minimal information about a schema.\r\n\t *\r\n\t * Returns null if the schema type is invalid.\r\n\t * @param schema\r\n\t */\r\n\tstatic generateSample(schema: sw.ISchemaObject, swaggerDoc?: sw.IDocument, ref?: string): any {\r\n\t\tif (schema && !isEmpty(schema)) {\r\n\t\t\tlet tempSchema = schema;\r\n\t\t\tlet currentRef = ref;\r\n\t\t\tlet path: string;\r\n\r\n\t\t\tif (schema.$ref) {\r\n\t\t\t\tswitch (schema.$ref[0]) {\r\n\t\t\t\t\tcase \"#\": //local reference\r\n\t\t\t\t\t\tpath = schema.$ref.split(\"/\")[2]; //assume $ref is \"#/definitions/someName\"\r\n\t\t\t\t\t\tif (!path) {\r\n\t\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\t\"Schema reference error. <br/><br/> Reference not found.\"\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttempSchema = swaggerDoc.definitions[path];\r\n\t\t\t\t\t\tcurrentRef = schema.$ref;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: //TODO: add support for remote and URL references.\r\n\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\"Schema reference error. <br/><br/> Remote and URL references are not supported in App Builder.\"\r\n\t\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (!tempSchema) {\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"Schema reference error. <br/><br/> Reference not found.\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.getSchemaType(tempSchema)) {\r\n\t\t\t\tcase \"integer\":\r\n\t\t\t\t\treturn tempSchema.default || 1;\r\n\t\t\t\tcase \"number\":\r\n\t\t\t\t\treturn tempSchema.default || 1.0;\r\n\t\t\t\tcase \"string\":\r\n\t\t\t\t\tswitch (tempSchema.format) {\r\n\t\t\t\t\t\tcase \"byte\":\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"SGVsbG8gV29ybGQ=\";\r\n\t\t\t\t\t\tcase \"date\":\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"1985-04-12\";\r\n\t\t\t\t\t\tcase \"date-time\":\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"1985-04-12T23:20:50.52Z\";\r\n\t\t\t\t\t\tcase \"binary\":\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"10101010\";\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"text\";\r\n\t\t\t\t\t}\r\n\t\t\t\tcase \"boolean\":\r\n\t\t\t\t\treturn tempSchema.default || true;\r\n\t\t\t\tcase \"array\":\r\n\t\t\t\t\tif (Array.isArray(tempSchema.items)) {\r\n\t\t\t\t\t\treturn tempSchema.items.map((item) => JsonHelper.generateSample(item, swaggerDoc, currentRef));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (currentRef && currentRef === ref) {\r\n\t\t\t\t\t\t\treturn [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn [JsonHelper.generateSample(tempSchema.items, swaggerDoc, currentRef)];\r\n\t\t\t\t\t}\r\n\t\t\t\tcase \"object\":\r\n\t\t\t\t\tconst sample: any = {};\r\n\t\t\t\t\tfor (const key in tempSchema.properties) {\r\n\t\t\t\t\t\tif (tempSchema.properties[key].$ref && currentRef\r\n\t\t\t\t\t\t\t&& tempSchema.properties[key].$ref === currentRef) {\r\n\t\t\t\t\t\t\tsample[key] = {};\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsample[key] = JsonHelper.generateSample(tempSchema.properties[key], swaggerDoc, currentRef);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn sample;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"Unknown schema type. <br/><br/> Review your swagger documentation & try again.\"\r\n\t\t\t\t\t);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Schema is missing. <br/><br/> Be sure that your ION API Method has a swagger document.\"\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static getSchemaType(schema: sw.ISchemaObject): string | string[] {\r\n\t\tif(schema.type) {\r\n\t\t\treturn schema.type;\r\n\t\t}\r\n\r\n\t\t//Try to auto-correct missing schema type\r\n\t\tif (schema.properties) {\r\n\t\t\treturn \"object\";\r\n\t\t} else if (schema.items) {\r\n\t\t\treturn \"array\";\r\n\t\t} else if (schema.format) {\r\n\t\t\tswitch (schema.format) {\r\n\t\t\t\tcase \"float\":\r\n\t\t\t\tcase \"double\":\r\n\t\t\t\t\treturn \"number\";\r\n\t\t\t\tcase \"int32\":\r\n\t\t\t\tcase \"int64\":\r\n\t\t\t\t\treturn \"integer\";\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn \"string\";\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t//default to string to ensure a type\r\n\t\t\treturn \"string\";\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generate a very simple Swagger schema for a given object.\r\n\t * Throws a TypeError if the given object cannot be mapped to a valid JSONSchema type.\r\n\t *\r\n\t * If given an array, it will only interpret the type of the first element.\r\n\t * @param {number | boolean} sample asd\r\n\t */\r\n\r\n\tstatic generateSchema(\r\n\t\tsample: number | boolean | string | IMap<any> | Array<any>\r\n\t): sw.ISchemaObject {\r\n\t\tconst schema: sw.ISchemaObject = {};\r\n\t\tif (typeof sample === \"number\") {\r\n\t\t\tschema.type = \"number\";\r\n\t\t\tschema.default = sample;\r\n\t\t} else if (typeof sample === \"string\") {\r\n\t\t\tschema.type = \"string\";\r\n\t\t\tschema.default = sample;\r\n\t\t\tconst format = this.getPropertyFormat(sample);\r\n\t\t\tif (format !== undefined) {\r\n\t\t\t\tschema.format = format;\r\n\t\t\t}\r\n\t\t} else if (typeof sample === \"boolean\") {\r\n\t\t\tschema.type = \"boolean\";\r\n\t\t\tschema.default = sample;\r\n\t\t} else if (Array.isArray(sample)) {\r\n\t\t\tschema.type = \"array\";\r\n\t\t\tif (sample.length > 1) {\r\n\t\t\t\tschema.items = sample.map((item) => JsonHelper.generateSchema(item));\r\n\t\t\t} else {\r\n\t\t\t\tschema.items = JsonHelper.generateSchema(sample[0]);\r\n\t\t\t}\r\n\t\t} else if (typeof sample === \"object\" && sample !== null) {\r\n\t\t\tschema.type = \"object\";\r\n\t\t\tschema.properties = {};\r\n\t\t\tfor (const key in sample) {\r\n\t\t\t\tschema.properties[key] = JsonHelper.generateSchema(sample[key]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthrow new TypeError(\"Cannot map \" + sample + \" to a valid type\");\r\n\t\t}\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tprivate static getPropertyFormat(value: string): string {\r\n\t\tconst date = DateHelper.parse(value);\r\n\t\tif (date.toString() !== \"Invalid Date\") {\r\n\t\t\tif (date.getHours() !== 0) {\r\n\t\t\t\treturn \"date-time\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tstatic getPropertyType(\r\n\t\tschema: sw.ISchemaObject,\r\n\t\tpropertyName: string\r\n\t): string {\r\n\t\t// remove special characters\r\n\t\tconst propertyNameMatch = propertyName.match(/[a-zA-Z0-9]+/);\r\n\r\n\t\tconst jsonQuery =\r\n\t\t\tpropertyNameMatch !== null ? `$..${propertyNameMatch}` : \"\";\r\n\r\n\t\tif (isUndefined(jsonQuery) || isEmpty(jsonQuery)) {\r\n\t\t\tthrow new TypeError(\"\");\r\n\t\t}\r\n\r\n\t\tconst propertyType = jsonpath.query(schema, jsonQuery);\r\n\r\n\t\treturn propertyType[0].type;\r\n\t}\r\n\r\n\t/**\r\n\t * Detects if JSON object is cyclic\r\n\t * https://stackoverflow.com/a/14962496\r\n\t * @param obj JSON object\r\n\t */\r\n\r\n\tstatic isCyclic(obj: object): boolean {\r\n\t\tconst seenObjects: object[] = [];\r\n\r\n\t\tconst detect = (item: IMap<any>): boolean => {\r\n\t\t\tif (item && typeof item === \"object\") {\r\n\t\t\t\tif (seenObjects.indexOf(item) !== -1) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tseenObjects.push(item);\r\n\t\t\t\tfor (const key in item) {\r\n\t\t\t\t\tif (item.hasOwnProperty(key) && detect(item[key])) {\r\n\t\t\t\t\t\t// Debugger.log(item, \"cycle at \" + key);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\treturn detect(obj);\r\n\t}\r\n\r\n\t/**\r\n\t * Fixes cyclic references if any\r\n\t * https://stackoverflow.com/a/11616993\r\n\t * @param obj JSON object\r\n\t */\r\n\r\n\tstatic fixCyclic(obj: object): object {\r\n\t\tlet cache: object[] = [];\r\n\t\tconst result = JSON.stringify(obj, (key, value) => {\r\n\t\t\tif (typeof value === \"object\" && value !== null) {\r\n\t\t\t\tif (cache.indexOf(value) !== -1) {\r\n\t\t\t\t\t// Duplicate reference found\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// If this value does not reference a parent it can be deduped\r\n\t\t\t\t\t\treturn JSON.parse(JSON.stringify(value));\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t// discard key if value cannot be deduped\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Store value in our collection\r\n\t\t\t\tcache.push(value);\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t});\r\n\t\tcache = null; // Enable garbage collection\r\n\r\n\t\treturn result ? JSON.parse(result) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Prettify JSON string\r\n\t * @param jsonString\r\n\t * @param spaces\r\n\t */\r\n\r\n\tstatic prettify(jsonString: object, spaces: number = 2): string {\r\n\t\treturn JSON.stringify(jsonString, null, spaces);\r\n\t}\r\n\r\n\t/**\r\n\t * Tests if a path is invalid json\r\n\t * @param root String representing the json path\r\n\t * @returns Return true if the path is invalid otherwise false\r\n\t */\r\n\tstatic isInvalidJsonPath(root: string): boolean {\r\n\t\tlet result = false;\r\n\t\ttry {\r\n\t\t\tjsonpath.parse(root);\r\n\t\t} catch (e) {\r\n\t\t\tresult = true;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}\r\n","export class DateHelper {\r\n\tprivate static MAX_TIMESTAMP = 8640000000000000;\r\n\tprivate static MIN_TIMESTAMP = -8640000000000000;\r\n\r\n\tstatic parse(value: string, date?: string, locale?: string): Date {\r\n\t\tlet datetime: Date;\r\n\r\n\t\tif (/\\d{8}\\s{1}\\d{2}:\\d{2}:\\d{2}.\\d{3}/g.exec(value)) {\r\n\t\t\t// IDO DateTime pattern\r\n\t\t\tconst datetimeParts = value.split(\" \");\r\n\t\t\tconst date = Soho.Locale.parseDate(datetimeParts[0], {\r\n\t\t\t\tpattern: \"yyyyMMdd\",\r\n\t\t\t});\r\n\t\t\tconst time = Soho.Locale.parseDate(datetimeParts[1], {\r\n\t\t\t\tpattern: \"HH:mm:ss.SSS\",\r\n\t\t\t});\r\n\t\t\tdatetime = new Date(\r\n\t\t\t\tdate.getFullYear(),\r\n\t\t\t\tdate.getMonth(),\r\n\t\t\t\tdate.getDate(),\r\n\t\t\t\ttime.getHours(),\r\n\t\t\t\ttime.getMinutes(),\r\n\t\t\t\ttime.getSeconds(),\r\n\t\t\t\ttime.getMilliseconds()\r\n\t\t\t);\r\n\t\t} else if (/\\/Date\\(\\d+\\+?\\d{4}\\)\\//.exec(value)) {\r\n\t\t\t// Mingle DateTime pattern\r\n\t\t\tconst milliseconds = /\\d+/.exec(value)[0];\r\n\t\t\tdatetime = new Date(parseInt(milliseconds));\r\n\t\t} else if (/^[0-9]{8}$/.exec(value)) {\r\n\t\t\t// M3 DateTime pattern\r\n\t\t\tdatetime = Soho.Locale.parseDate(value, { pattern: \"yyyyMMdd\" });\r\n\t\t} else if (/^\\d+$/.exec(value)) {\r\n\t\t\t// possibly milliseconds\r\n\t\t\tdatetime = new Date(parseFloat(value));\r\n\t\t} else {\r\n\t\t\tdatetime = new Date(value);\r\n\t\t}\r\n\r\n\t\treturn datetime;\r\n\t}\r\n\r\n\tstatic isValidMillisecondTimestamp(value: number): boolean {\r\n\t\treturn value < this.MAX_TIMESTAMP && value > this.MIN_TIMESTAMP;\r\n\t}\r\n\r\n\tstatic isValidDate(date: Date): boolean {\r\n\t\treturn !isNaN(date.getTime());\r\n\t}\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IListDataItem extends IMap<any> {\r\n\tid?: string;\r\n}\r\n","import { Numbers, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { IJsonComponent, IJsonMargin, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { ILayoutComponentStyle } from \"../common/defines\";\r\nimport { IComponent } from \"../common/IComponent\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\nimport { Component } from \"./component\";\r\n\r\nexport abstract class LayoutComponent extends Component implements ILayoutComponent {\r\n\r\n\tpublic abstract getPxPerPercentComponent(ori: OrientationEnum, percent: number): number;\r\n\r\n\tpublic abstract hasIndividualChildSizes(ori: OrientationEnum): boolean;\r\n\r\n\tpublic abstract resizableChildren(direction: OrientationEnum): boolean;\r\n\r\n\tpublic children: IComponent[] = [];\r\n\tprotected databearer: IJsonLayoutComponent;\r\n\r\n\tpublic addChild(child: IJsonComponent, index: number): void {\r\n\t\tthis.databearer.children.splice(index, 0, child);\r\n\t}\r\n\r\n\tpublic onChildrenReady(): void {\r\n\t\t// onChildReady\r\n\t}\r\n\r\n\t// Generic addFunction for all LayoutComponent\r\n\tpublic addChildInstance(child: IComponent): void {\r\n\t\tthis.children.push(child);\r\n\t}\r\n\r\n\tpublic generateId(index: number): string {\r\n\t\tif (this.isGenerated) {\r\n\t\t\treturn this.generatedId + \"index\" + index;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getPadding(): IMap<string> {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tconst padding: IMap<string> = {\r\n\t\t\tpadding: margin.top + \"px \" + margin.right + \"px \" + margin.bottom + \"px \" + margin.left + \"px\"\r\n\t\t};\r\n\t\treturn padding;\r\n\t}\r\n\r\n\tpublic newBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\r\n\t\tthis.children.forEach((child) => {\r\n\t\t\tchild.newBoundaryEntered(boundaryId);\r\n\t\t});\r\n\t}\r\n\r\n\tprotected getClassList(): string[] {\r\n\t\tconst classList = super.getClassList();\r\n\t\tclassList.push(\"layoutComponent\");\r\n\t\tclassList.push(\"col-md4\");\r\n\t\treturn classList;\r\n\t}\r\n\r\n\tprotected getInlineStyle(): ILayoutComponentStyle {\r\n\t\tconst style: ILayoutComponentStyle = super.getInlineStyle();\r\n\t\tstyle.padding = style.margin;\r\n\t\tstyle.margin = null;\r\n\t\treturn style;\r\n\t}\r\n\r\n\tprotected calcNewSize(sizeObject: IJsonSize, orientation: OrientationEnum, margin: number = 0): string {\r\n\t\t// Overloading because of margin calculation\r\n\t\tlet retSize = \"\";\r\n\t\tif (this.parent.hasIndividualChildSizes(orientation)) {\r\n\t\t\tif (sizeObject.sizeType === SizeTypeEnum.PERCENT) {\r\n\t\t\t\tconst pxPerPercentComponent = this.parent.getPxPerPercentComponent(orientation, sizeObject.value);\r\n\t\t\t\tretSize = \"calc(\" + (sizeObject.value || Numbers.HUNDRED) + \"% - \" + (pxPerPercentComponent) + \"px)\";\r\n\t\t\t} else if (sizeObject.sizeType === SizeTypeEnum.PIXELS) {\r\n\t\t\t\tretSize = \"calc(\" + sizeObject.value + \"px)\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn retSize;\r\n\t}\r\n\r\n\t// Overriding calcNewSizes in Component, important for inheritance\r\n\tpublic calcNewSizes(orientation?: OrientationEnum): void {\r\n\t\tsuper.calcNewSizes();\r\n\t}\r\n\r\n\tpublic forEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void {\r\n\t\tsuper.forEachChild(fn, doGenerated);\r\n\t\tthis.children.forEach((ch) => {\r\n\t\t\tch.forEachChild(fn, doGenerated);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic forEachParent(fn: (parent: ILayoutComponent) => void): void {\r\n\t\tsuper.forEachParent(fn);\r\n\t\tfn(this as any);\r\n\t}\r\n\r\n}","import angular from \"angular\";\r\nimport isNil from \"lodash-es/isNil\";\r\nimport isNumber from \"lodash-es/isNumber\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport {\r\n\tInteractionActionEnum,\r\n\tInteractionPairOperation,\r\n\tInteractionTriggerEnum,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport type { IJsonLabel } from \"ng2/common/model/databearer/components/json-label.model\";\r\nimport type { IJsonList } from \"ng2/common/model/databearer/components/json-list.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type { IListComponent } from \"common/interface/ilist-component\";\r\nimport { Component } from \"components/component\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nimport { ComponentsHelper } from \"components/helper\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport class List extends Component implements IListComponent {\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.LIST];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic SETTING_FIELDS =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Show Header\",\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true,\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Options\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Keep Selection\",\r\n\t\t\ttooltip: \"Keep previous selected row on reload. (With ION APIs, an object ID is preferred if using this)\",\r\n\t\t\tref: SettingKeys.KEEP_SELECTED,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Search Field\",\r\n\t\t\tref: SettingKeys.SEARCH,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Selected Item\",\r\n\t\tref: SettingKeys.CURRENT_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Header\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\tstatic readonly SCROLLABLE_PAGE_FACTOR = 2;\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tcurrentItem: IListDataItem; // Used in binding framework\r\n\tselectedGeneratedId: string; // Used in template\r\n\tchildren: IMap<ILayoutComponent> = {};\r\n\tchildrenDatabearers: IJsonComponent[] = [];\r\n\tcurrentTemplate: IJsonLayoutComponent;\r\n\tinfiniteScrollEnabled: boolean;\r\n\tfilterValue: string;\r\n\tprotected databearer: IJsonList;\r\n\tprivate currentTemplateHeight: number;\r\n\tprivate childrenReadyDeferred: ng.IDeferred<void>;\r\n\tprivate keepSelected: boolean;\r\n\tprivate search: boolean;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonList,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tif (obj) {\r\n\t\t\tthis.keepSelected = obj.keepSelected;\r\n\t\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\t\tthis.search = obj.search || false;\r\n\t\t}\r\n\t\tthis.filterValue = \"\";\r\n\t}\r\n\r\n\tclearSearch(): void {\r\n\t\tthis.filterValue = \"\";\r\n\t\tthis.refresh();\r\n\t}\r\n\r\n\tgetFilteredList(): IJsonComponent[] {\r\n\t\tif (this.getScope()) {\r\n\t\t\treturn this.filterList(angular.copy(this.scope.context.ListResult));\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.currentTemplate = this.getBoundarySetting<IJsonLayoutComponent>(SettingKeys.ITEM_TEMPLATE);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\tthis.refresh();\r\n\t}\r\n\r\n\trefresh(): void {\r\n\t\t// Some settings affect the height of the templates\r\n\t\tthis.updateCurrentTemplateHeight();\r\n\t\tthis.renderChildren();\r\n\t}\r\n\r\n\tsetCurrentItem(generatedId: string): void {\r\n\t\tconst realIndex = this.getRealIndexFromGeneratedId(generatedId);\r\n\t\tconst listResults = this.getFilteredList();\r\n\t\tconst currItem = listResults ? listResults[realIndex] : null;\r\n\t\tif (currItem !== null && currItem !== this.currentItem) {\r\n\t\t\tthis.selectedGeneratedId = currItem? generatedId: null;\r\n\t\t\tthis.currentItem = currItem;\r\n\t\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t}\r\n\t}\r\n\r\n\tforEachItemTemplate(fn: (view: IJsonComponent) => void): void {\r\n\t\tfor (const boundaryId in this.databearer.boundarySettings) {\r\n\t\t\tif (this.databearer.boundarySettings[boundaryId].itemTemplate) {\r\n\t\t\t\tfn(this.databearer.boundarySettings[boundaryId].itemTemplate);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.LIST) {\r\n\t\t\tinteractionPromise.then((data: any[]) => {\r\n\t\t\t\tif (data.length <= 0) {\r\n\t\t\t\t\tthis.selectedGeneratedId = null;\r\n\t\t\t\t\tthis.onLoad();\r\n\t\t\t\t}\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.renderChildren().then(() => {\r\n\t\t\t\t\tthis.onLoad();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tonComponentReady(childInstance: ILayoutComponent, generatedId: string): void {\r\n\t\tthis.children[generatedId] = childInstance;\r\n\t\tchildInstance.forEachChild((subChild) => {\r\n\t\t\tsubChild.initializeBindings();\r\n\t\t}, true);\r\n\t\tif (Object.keys(this.children).length === this.childrenDatabearers.length) {\r\n\t\t\tthis.updateCurrentTemplateHeight();\r\n\t\t\tthis.loadFillOptimal();\r\n\t\t\tthis.childrenReadyDeferred.resolve();\r\n\t\t}\r\n\t}\r\n\r\n\tgetChildContext(generatedId: string): IContext {\r\n\t\tif (this.getFilteredList()) {\r\n\t\t\tconst realIndex = this.getRealIndexFromGeneratedId(generatedId);\r\n\t\t\treturn $.extend({}, this.getContext(), this.getFilteredList()[realIndex]);\r\n\t\t} else {\r\n\t\t\t// Dummy context\r\n\t\t\treturn this.getContext();\r\n\t\t}\r\n\t}\r\n\r\n\tcalcNewHeight(): void {\r\n\t\tthis.calcNewSizes();\r\n\t}\r\n\r\n\tcalcNewWidth(): void {\r\n\t\tthis.calcNewSizes();\r\n\t}\r\n\r\n\tresizableChildren(direction: OrientationEnum): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetPxPerPercentComponent(ori: OrientationEnum, percent: number): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\thasIndividualChildSizes(ori: OrientationEnum): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tcalcNewSizes(orientation?: OrientationEnum): void {\r\n\t\tsuper.calcNewWidth();\r\n\t\tsuper.calcNewHeight();\r\n\t\t// children are null on startup\r\n\t\tif (this.children) {\r\n\t\t\tObject.keys(this.children).forEach((childKey) => {\r\n\t\t\t\tconst child = this.children[childKey];\r\n\t\t\t\tchild.calcNewWidth();\r\n\t\t\t\tchild.calcNewHeight();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tforEachParent(fn: (parent: ILayoutComponent) => void): void {\r\n\t\tsuper.forEachParent(fn);\r\n\t\tfn(this as any);\r\n\t}\r\n\r\n\tforEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void {\r\n\t\tsuper.forEachChild(fn, doGenerated);\r\n\t\tif (doGenerated) {\r\n\t\t\tfor (const key in this.children) {\r\n\t\t\t\tthis.children[key].forEachChild(fn, doGenerated);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetBindableValue(key: string, value: any): void {\r\n\t\tsuper.setBindableValue(key, value);\r\n\t\tif (key === SettingKeys.SHOW_LABEL) {\r\n\t\t\tthis.updateClasses();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t *\tMethod to tell the list to load more rows, either in the bottom or the top, depending on the \"down\" parameter.\r\n\t\t*\r\n\t\t* @param down True if scrolling down\r\n\t\t*/\r\n\tloadMore(down: boolean): void {\r\n\t\tif (!this.infiniteScrollEnabled || !this.childrenDatabearers.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst pageFactor = 0.5;\r\n\t\tconst listData = this.getFilteredList();\r\n\t\tlet newRowCount = Math.floor(this.getRowsPerPage() * pageFactor);\r\n\t\t// make sure that newRowCount is atleast 1 for lists that have low height.\r\n\t\tnewRowCount = newRowCount === 0 ? 1 : newRowCount;\r\n\t\tif (down) { // Scrolling down\r\n\t\t\tconst realIndexMax = this.getRealIndexFromGeneratedId(\r\n\t\t\t\tthis.childrenDatabearers[this.childrenDatabearers.length - 1].generatedId\r\n\t\t\t);\r\n\t\t\tconst remainingSlots = listData.length - (realIndexMax + 1);\r\n\t\t\tif (remainingSlots < newRowCount) {\r\n\t\t\t\tnewRowCount = remainingSlots;\r\n\t\t\t}\r\n\t\t\tthis.childrenDatabearers.splice(0, newRowCount).forEach((deletedChild) => {\r\n\t\t\t\tdelete this.children[deletedChild.generatedId];\r\n\t\t\t});\r\n\t\t\tfor (let i = 0; i < newRowCount; i++) {\r\n\t\t\t\tthis.childrenDatabearers.push(this.getNewGeneratedComponent(realIndexMax + 1 + i));\r\n\t\t\t}\r\n\t\t} else { // Scrolling up\r\n\t\t\tconst realIndexMin = this.getRealIndexFromGeneratedId(\r\n\t\t\t\tthis.childrenDatabearers[0].generatedId\r\n\t\t\t);\r\n\t\t\tconst remainingSlots = realIndexMin;\r\n\t\t\tif (remainingSlots < newRowCount) {\r\n\t\t\t\tnewRowCount = remainingSlots;\r\n\t\t\t}\r\n\t\t\tthis.childrenDatabearers.splice(-newRowCount, newRowCount).forEach((deletedChild) => {\r\n\t\t\t\tdelete this.children[deletedChild.generatedId];\r\n\t\t\t});\r\n\t\t\tfor (let i = 0; i < newRowCount; i++) {\r\n\t\t\t\tthis.childrenDatabearers.unshift(this.getNewGeneratedComponent(realIndexMin - 1 - i));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected getClassList(): string[] {\r\n\t\tconst classList = super.getClassList();\r\n\t\tif (!this.getBoundarySetting<boolean>(SettingKeys.SHOW_LABEL)) {\r\n\t\t\tclassList.push(\"hide-header\");\r\n\t\t}\r\n\t\treturn classList;\r\n\t}\r\n\r\n\tprivate filterList(list: any[]): any[] {\r\n\t\tif(list) {\r\n\t\t\tconst activeFields = this.getActiveFieldsFromTemplate();\r\n\t\t\treturn list.filter((values) => {\r\n\t\t\t\treturn this.checkObjectforFilterMatch(values, activeFields);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn list;\r\n\t}\r\n\r\n\tprivate getActiveFieldsFromTemplate(): string[] {\r\n\t\tconst activeIDs: string[] = [];\r\n\t\tconst breakdown = (child: IJsonComponent): void => {\r\n\t\t\tlet component;\r\n\t\t\tswitch (child.typedef) {\r\n\t\t\t\tcase \"Flexbox\":\r\n\t\t\t\t\tcomponent = child as IJsonFlexbox;\r\n\t\t\t\t\tcomponent.children.forEach((child: IJsonComponent) => {\r\n\t\t\t\t\t\tbreakdown(child);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Label\":\r\n\t\t\t\t\tcomponent = child as IJsonLabel;\r\n\t\t\t\t\tif (component.content.Type === BindingTypeEnum.CONTEXT_BINDING) {\r\n\t\t\t\t\t\tif (activeIDs.indexOf(component.content.sourceKey) === -1) {\r\n\t\t\t\t\t\t\tactiveIDs.push(component.content.sourceKey);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (component.toolTip.Type === BindingTypeEnum.CONTEXT_BINDING) {\r\n\t\t\t\t\t\tif (activeIDs.indexOf(component.toolTip.sourceKey) === -1) {\r\n\t\t\t\t\t\t\tactiveIDs.push(component.toolTip.sourceKey);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//Possible components to search\r\n\t\t\t\tcase \"Image\":\r\n\t\t\t\tcase \"Hyperlink\":\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.currentTemplate.children.forEach(child => {\r\n\t\t\tbreakdown(child);\r\n\t\t});\r\n\r\n\t\treturn activeIDs;\r\n\t}\r\n\r\n\tprivate checkObjectforFilterMatch(objectValues: any, activeFields: string[]): boolean {\r\n\t\tif (isNil(this.filterValue)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tlet match = false;\r\n\r\n\t\tObject.entries(objectValues).some(([key, value]) => {\r\n\t\t\tif (activeFields.indexOf(key) !== -1) {\r\n\t\t\t\tif ((value as string).toLowerCase().indexOf(this.filterValue.toLowerCase()) !== -1) {\r\n\t\t\t\t\tmatch = true;\r\n\t\t\t\t\treturn match;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn match;\r\n\t}\r\n\r\n\tprivate updateCurrentTemplateHeight(): void {\r\n\t\tconst firstLiElement = this.element.find(\"li\").first();\r\n\t\tif (firstLiElement.length) {\r\n\t\t\tthis.currentTemplateHeight = firstLiElement.children().first().height();\r\n\t\t} else {\r\n\t\t\tthis.currentTemplateHeight = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onLoad(): void {\r\n\t\tthis.trigger(InteractionTriggerEnum.ON_LOAD);\r\n\t\tthis.setSelection();\r\n\t}\r\n\r\n\tprivate setSelection(): void {\r\n\t\tif (this.selectedGeneratedId && this.keepSelected) {\r\n\t\t\tthis.moveIndex();\r\n\t\t\tthis.goToPage();\r\n\t\t\tthis.moveScroll();\r\n\t\t\tthis.setCurrentItem(this.selectedGeneratedId);\r\n\t\t} else {\r\n\t\t\tthis.setCurrentItem(Object.keys(this.children)[0]);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate moveIndex(): void {\r\n\t\tconst listresult = this.getFilteredList();\r\n\t\tconst index = ComponentsHelper.findItemIndexById(listresult, this.currentItem.id);\r\n\t\tif (isUndefined(index)) {\r\n\t\t\tthis.setErrorTooltip(\"Selection failed, Item ID is not unique.\");\r\n\t\t} else {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t}\r\n\r\n\t\tif (isNumber(index) && index !== -1) {\r\n\t\t\tthis.selectedGeneratedId = this.getGeneratedPrefix() + index;\r\n\t\t} else if (index) { //if item id does not exists, try to find correct index\r\n\t\t\tconst index = this.getRealIndexFromGeneratedId(this.selectedGeneratedId);\r\n\t\t\tthis.selectedGeneratedId = this.getGeneratedPrefix() +\r\n\t\t\t\tComponentsHelper.incrementIndex(\r\n\t\t\t\t\tindex,\r\n\t\t\t\t\tthis.getContext(),\r\n\t\t\t\t\tthis.currentItem,\r\n\t\t\t\t\tthis.getDatasource()\r\n\t\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.setCurrentItem(Object.keys(this.children)[0]);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate goToPage(): void {\r\n\t\tif (this.selectedGeneratedId) {\r\n\t\t\tconst listData = this.getFilteredList();\r\n\t\t\tconst offset = 5;\r\n\t\t\tlet generatedIndex = this.getRealIndexFromGeneratedId(this.selectedGeneratedId) - offset;\r\n\t\t\tif (generatedIndex < 0) {\r\n\t\t\t\tgeneratedIndex = 0;\r\n\t\t\t}\r\n\t\t\tthis.childrenDatabearers = [];\r\n\t\t\tlet optimalRowCount = Math.floor(this.getRowsPerPage() * List.SCROLLABLE_PAGE_FACTOR);\r\n\t\t\tif (optimalRowCount > listData.length) {\r\n\t\t\t\toptimalRowCount = listData.length;\r\n\t\t\t}\r\n\t\t\tconst remainingSlots = listData.length - (generatedIndex + 1);\r\n\t\t\tif (remainingSlots < optimalRowCount) {\r\n\t\t\t\tgeneratedIndex = listData.length - optimalRowCount;\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < optimalRowCount; i++) {\r\n\t\t\t\tthis.childrenDatabearers.push(this.getNewGeneratedComponent(generatedIndex + i));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate moveScroll(): void {\r\n\t\tconst rowCount = Math.floor(this.getRowsPerPage()) + 1;\r\n\t\tconst realIndex = this.getFilteredList().length - this.getRealIndexFromGeneratedId(this.selectedGeneratedId);\r\n\t\tif (realIndex < rowCount) {\r\n\t\t\tconst listElement = this.element.find(\".listview\")[0];\r\n\t\t\tlistElement.scrollTop = listElement.scrollHeight;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadFillOptimal(): void {\r\n\t\tconst optimalRowCount = Math.floor(this.getRowsPerPage() * List.SCROLLABLE_PAGE_FACTOR);\r\n\t\tconst dataLength = this.getFilteredList() ? this.getFilteredList().length : 0;\r\n\t\tconst remainingTilOptimaleCount = optimalRowCount - this.childrenDatabearers.length;\r\n\t\tconst remainingDataLength = dataLength - this.childrenDatabearers.length;\r\n\t\tif (remainingTilOptimaleCount > 0) {\r\n\t\t\tconst newRowCount = Math.min(\r\n\t\t\t\tremainingTilOptimaleCount, // Remaining til optimal count\r\n\t\t\t\tremainingDataLength\r\n\t\t\t);\r\n\t\t\tif (this.childrenDatabearers.length > 0) {\r\n\t\t\t\tconst realIndexMax = this.getRealIndexFromGeneratedId((\r\n\t\t\t\t\tthis.childrenDatabearers[this.childrenDatabearers.length - 1]).generatedId);\r\n\t\t\t\tfor (let i = 0; i < newRowCount; i++) {\r\n\t\t\t\t\tthis.childrenDatabearers.push(this.getNewGeneratedComponent(realIndexMax + 1 + i));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Disable infinite scroll when not able to fill optimal space\r\n\t\t} else if (remainingTilOptimaleCount < 0) {\r\n\t\t\t// TODO: remove elements for optimization\r\n\t\t}\r\n\t\tif (optimalRowCount > this.childrenDatabearers.length) {\r\n\t\t\tthis.infiniteScrollEnabled = false;\r\n\t\t} else {\r\n\t\t\tthis.infiniteScrollEnabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getGeneratedPrefix(): string {\r\n\t\treturn this.getId() + \"_row\";\r\n\t}\r\n\r\n\tprivate updateView(): void {\r\n\t\tthis.currentTemplate = this.getBoundarySetting<IJsonLayoutComponent>(SettingKeys.ITEM_TEMPLATE);\r\n\t\tthis.currentTemplateHeight = null;\r\n\t}\r\n\r\n\tprivate getRealIndexFromGeneratedId(generatedId: string): number {\r\n\t\tlet returnNumber = -1;\r\n\t\tconst reg = new RegExp(this.getGeneratedPrefix() + \"(\\\\d+)\");\r\n\t\tconst match = reg.exec(generatedId);\r\n\t\tif (match) {\r\n\t\t\treturnNumber = parseInt(match[1]);\r\n\t\t}\r\n\t\treturn returnNumber;\r\n\t}\r\n\r\n\tprivate getRowsPerPage(): number {\r\n\t\tconst paddingTopAndBottom = 33;\r\n\t\tconst eachHeight = this.currentTemplateHeight + paddingTopAndBottom;\r\n\t\tconst availableSpace = this.element.find(\".listview\").height();\r\n\t\treturn availableSpace / eachHeight;\r\n\t}\r\n\r\n\tprivate getNewGeneratedComponent(realIndex: number): IJsonComponent {\r\n\t\tconst currentTemplate = this.currentTemplate;\r\n\t\tconst generatedId = this.getGeneratedPrefix() + realIndex;\r\n\t\treturn {\r\n\t\t\t...currentTemplate,\r\n\t\t\tgeneratedId\r\n\t\t};\r\n\t}\r\n\r\n\tprivate renderChildren(): ng.IPromise<void> {\r\n\t\t// Arbitrary timeout to wait for rendering of list\r\n\t\tconst RENDER_TIMEOUT = 10;\r\n\t\tthis.childrenReadyDeferred = this.frameworkService.getNewDeferred<void>();\r\n\t\tthis.getScope().$evalAsync(() => {\r\n\t\t\tthis.childrenDatabearers = [];\r\n\t\t\tthis.children = {};\r\n\t\t});\r\n\r\n\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\tconst listResults = this.getFilteredList();\r\n\t\t\tconst hasListResults = !!listResults;\r\n\t\t\tconst hasData = hasListResults && listResults.length !== 0;\r\n\t\t\tconst noData = hasListResults && listResults.length === 0;\r\n\r\n\t\t\t// init all children with a child. Leave the loadFillOptimal to fill the list\r\n\t\t\tthis.childrenDatabearers = [this.getNewGeneratedComponent(0)];\r\n\r\n\t\t\t// Empty dataset when there is no data in listresults\r\n\t\t\t// An uninitialized list will have hasListResults as undefined\r\n\t\t\tif (this.frameworkService.isDesigner() && noData && !hasListResults) {\r\n\t\t\t\tthis.childrenDatabearers = [];\r\n\t\t\t}\r\n\t\t\t// Empty dataset when there is no data in listresults and listresults eq undefined\r\n\t\t\tif (this.frameworkService.isRuntimeMode() && !hasData) {\r\n\t\t\t\tthis.childrenDatabearers = [];\r\n\t\t\t}\r\n\t\t\t// Needed if interaction exists within a list child\r\n\t\t\tthis.loadFillOptimal();\r\n\r\n\t\t}, RENDER_TIMEOUT);\r\n\r\n\t\treturn this.childrenReadyDeferred.promise;\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./list.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import {\r\n\tInteractionPairOperation,\r\n\tNumbers,\r\n\tSidebarTabTypes,\r\n\tSettingKeys,\r\n\tSettingInputKeys\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IJsonTabComponent, IJsonTabPanel, IJsonTabs } from \"common/model/component/tabs.model\";\r\nimport type { ITab } from \"common/model/sohoxi/sohoxi-tabs.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport type { ITabStyle } from \"common/defines\";\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type { ITabsComponent } from \"common/interface/itabs-component\";\r\n\r\nimport { Component } from \"components/component\";\r\nimport { LayoutComponent } from \"components/layout-component\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport class Tabs extends LayoutComponent implements ITabsComponent {\r\n\tstatic availableOrientations = [\r\n\t\t{ name: \"Horizontal\", value: OrientationEnum.HORIZONTAL },\r\n\t\t{ name: \"Vertical\", value: OrientationEnum.VERTICAL }\r\n\t];\r\n\tstatic DEFAULT_ORIENTAION = OrientationEnum.HORIZONTAL;\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [];\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t(<IComponentSettingCategory[]>[\r\n\t\t{\r\n\t\t\ttitle: \"Orientation\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.ORIENTATION,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Tabs.availableOrientations,\r\n\t\t\t\tdefaultValue: Tabs.DEFAULT_ORIENTAION\r\n\t\t\t}]\r\n\t\t},\r\n\t]).concat(Component.SETTING_FIELDS);\r\n\r\n\tcomponentTabs: IJsonTabComponent[];\r\n\tcurrentTab: IJsonTabComponent;\r\n\tchildrenDatabearers: IJsonTabPanel[];\r\n\torientation: OrientationEnum;\r\n\r\n\tprotected databearer: IJsonTabs;\r\n\r\n\tprivate readyChildrenCount = 0;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTabs,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tthis.childrenDatabearers = this.databearer.children;\r\n\t\tthis.componentTabs = this.databearer.componentTabs;\r\n\t\tthis.currentTab = this.componentTabs[0];\r\n\t\tthis.orientation = obj.orientation || Tabs.DEFAULT_ORIENTAION;\r\n\t}\r\n\r\n\t// Wait for the tab element to exist before rendering\r\n\tprivate updateWhenExist(): void {\r\n\t\tconst checkInterval = 100; // check every 100ms\r\n\t\tconst checkExist = setInterval(() => {\r\n\t\t\tif (this.element.length > 0) {\r\n\t\t\t\tclearInterval(checkExist);\r\n\t\t\t\tthis.element.children().children(\".tab-container\").tabs({\r\n\t\t\t\t\tchangeTabOnHashChange: true,\r\n\t\t\t\t\thashChangeCallback: this.onChangeTab.bind(this),\r\n\t\t\t\t} as any);\r\n\t\t\t\tthis.initializeBindings();\r\n\t\t\t\tthis.updatePanels();\r\n\r\n\t\t\t\tthis.forEachChild((child => {\r\n\t\t\t\t\tchild.initializeBindings();\r\n\t\t\t\t}), true);\r\n\t\t\t}\r\n\t\t}, checkInterval);\r\n\t}\r\n\r\n\tprivate initializeTabs(): void {\r\n\t\tthis.getScope().$applyAsync(() => {\r\n\t\t\tthis.updateWhenExist();\r\n\t\t});\r\n\t}\r\n\r\n\tonComponentReady(component: IComponent): void {\r\n\t\tthis.addChildInstance(component);\r\n\t\tthis.readyChildrenCount++;\r\n\t\tif (this.readyChildrenCount === this.componentTabs.length) {\r\n\t\t\tthis.getScope().onChildrenReady();\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tonChildrenReady(): void {\r\n\t\tthis.initializeTabs();\r\n\t}\r\n\r\n\tisLayoutComponent(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\tresizableChildren(direction: OrientationEnum): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\tgetPxPerPercentComponent(ori: OrientationEnum, percent: number): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\thasIndividualChildSizes(ori: OrientationEnum): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tonChangeTab(selectedId: string): void {\r\n\t\tconst selectedTab = this.componentTabs.find((tab) => {\r\n\t\t\treturn \"#\"+tab.id === selectedId;\r\n\t\t});\r\n\t\tthis.currentTab = selectedTab || this.componentTabs[0];\r\n\t\tthis.updatePanels();\r\n\t}\r\n\r\n\tonOrientationChanged(): void {\r\n\t\tconst tabAPI: ITab = this.element.find(\".tab-container\").data(\"tabs\");\r\n\t\tif (tabAPI) {\r\n\t\t\ttabAPI.destroy();\r\n\t\t\tthis.currentTab = this.componentTabs[0];\r\n\t\t\tthis.updateWhenExist();\r\n\t\t}\r\n\t}\r\n\r\n\tupdatePanels(): void {\r\n\t\tthis.children.forEach((tabPanel: IComponent) => {\r\n\t\t\ttabPanel.updateVisibility();\r\n\r\n\t\t\tif (tabPanel.isVisible) {\r\n\t\t\t\ttabPanel.forEachChild((innerChild) => {\r\n\t\t\t\t\tinnerChild.updateVisibility();\r\n\t\t\t\t}, false);\r\n\r\n\t\t\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected getInlineStyle(): ITabStyle {\r\n\t\tconst style: ITabStyle = super.getInlineStyle();\r\n\t\t// Shifting back padding to margin\r\n\t\tstyle.margin = style.padding;\r\n\t\tstyle.padding = null;\r\n\t\treturn style;\r\n\t}\r\n\r\n\tprotected calcNewSize(sizeObject: IJsonSize, orientation: OrientationEnum, margin = 0): string {\r\n\t\t// Overloading because of margin calculation\r\n\t\tlet retSize = \"\";\r\n\t\tif (this.parent.hasIndividualChildSizes(orientation)) {\r\n\t\t\tif (sizeObject.sizeType === SizeTypeEnum.PERCENT) {\r\n\t\t\t\tconst pxPerPercentComponent = this.parent.getPxPerPercentComponent(orientation, sizeObject.value);\r\n\t\t\t\tretSize = \"calc(\" + (sizeObject.value || Numbers.HUNDRED) + \"% - \" + (pxPerPercentComponent + margin) + \"px)\";\r\n\t\t\t} else if (sizeObject.sizeType === SizeTypeEnum.PIXELS) {\r\n\t\t\t\tretSize = \"calc(\" + sizeObject.value + \"px)\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn retSize;\r\n\t}\r\n\r\n\tupdateValuesWithTranslations(): void {\r\n\t\tthis.componentTabs.forEach((tab: IJsonTabComponent) => {\r\n\t\t\tconst translatedTitle =\r\n\t\t\t\tthis.frameworkService.getTranslatableStringByProperty(this.getId(), tab.id);\r\n\t\t\tif (translatedTitle) {\r\n\t\t\t\tconst globalString = this.frameworkService.getGlobalValue(translatedTitle, this);\r\n\r\n\t\t\t\tif (globalString) {\r\n\t\t\t\t\ttab.value = globalString;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttab.name = translatedTitle;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./tabs.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// import { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\n// import { IMap } from \"ng2/common/model/imap.model\";\r\n// import { IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\n// import { FlexSizeTypeEnum, FlexOverflowEnum, AlignmentEnum } from \"ng2/common/constants/common.constant\";\r\n// import { OrientationEnum } from \"\"ng2/common/enums/orientation.enum\"\";\r\n\r\nimport { AlignmentEnum, FlexOverflowEnum, FlexSizeTypeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonFlexbox extends IJsonLayoutComponent {\r\n\tbackgroundColor?: string;\r\n\tborder?: IJsonBorder;\r\n\tborderColor?: string;\r\n\tboundarySettings: IMap<IJsonFlexboxSettings>;\r\n}\r\n\r\nexport interface IJsonFlexboxSettings extends IJsonComponentSettings {\r\n\torientation: OrientationEnum;\r\n\tsize: number;\r\n\tsizeType: FlexSizeTypeEnum;\r\n\toverflow: FlexOverflowEnum;\r\n\thorizontalAlignment: AlignmentEnum;\r\n\tverticalAlignment: AlignmentEnum;\r\n}\r\n\r\nexport interface IJsonFlexboxAlignments {\r\n\thorizontalAlignment: AlignmentEnum;\r\n\tverticalAlignment: AlignmentEnum;\r\n}\r\n\r\nexport interface IAvailableFlexSize {\r\n\tdisplayName: string;\r\n\tvalue: FlexSizeTypeEnum;\r\n}\r\n\r\nexport interface IAvailableAlignments {\r\n\tname: string;\r\n\tvalue: AlignmentEnum;\r\n}\r\n\r\nexport interface IJsonBorder extends IMap<number> {\r\n\ttop: number;\r\n\tright: number;\r\n\tbottom: number;\r\n\tleft: number;\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IdoProperties, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport {\r\n\tIJsonDatasource,\r\n\tIJsonGenericDatasource2,\r\n} from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope, KeyCodeEnum } from \"../../defines\";\r\nimport { IErrorResponse } from \"../../error-response\";\r\n\r\nimport { JsonHelper } from \"ng2/common/helpers/json.helper\";\r\nimport { DatasourceService } from \"../../../components/services/datasource-service\";\r\nimport { Helper } from \"../../helper\";\r\nimport { DialogService, IDialog } from \"../../services/dialog-service\";\r\n\r\nexport enum TestDataserviceDialogType {\r\n\tUNFORMATTED = \"UNFORMATTED\",\r\n\tFORMATTED = \"FORMATTED\",\r\n}\r\nexport type TTestDataserviceDialogType\r\n\t= typeof TestDataserviceDialogType.FORMATTED\r\n\t| typeof TestDataserviceDialogType.UNFORMATTED;\r\n\r\nexport interface ITestParameter {\r\n\tid: string;\r\n\tkey: string;\r\n\tvalue: string;\r\n\tmandatory: boolean;\r\n}\r\n\r\nexport interface ITestDataserviceParameters {\r\n\ttype: TTestDataserviceDialogType;\r\n\tdataservice: IJsonDatasource;\r\n}\r\n\r\nexport class TestDataserviceDialogCtrl {\r\n\tpublic dataservice: IJsonDatasource;\r\n\tpublic datagridOptions: IDataGridOptions<any>;\r\n\tpublic parameters: ITestParameter[]; // The inputparams in the dialog\r\n\tpublic responseData: string = \"\";\r\n\tpublic type: TTestDataserviceDialogType;\r\n\tpublic fetching: boolean = false;\r\n\r\n\tprivate dialog: IDialog<IErrorResponse>;\r\n\tprivate testDialogTypes = TestDataserviceDialogType;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.DATASOURCE_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<any>,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate datasourceService: DatasourceService,\r\n\t\tprivate dialogService: DialogService,\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\r\n\t\tif (!dialog.parameter.dataservice) {\r\n\t\t\t// This is to make sure that the errordialog shows up AFTER the normal dialog.\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\tthis.handleError(new Error(\"Could not find the data service\")).finally(() => this.close());\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.dataservice = angular.copy(dialog.parameter.dataservice);\r\n\t\tthis.type = dialog.parameter.type;\r\n\t\tthis.datagridOptions = this.initDatagridOptions();\r\n\t\tthis.initGenericState(this.dataservice as IJsonGenericDatasource2);\r\n\t}\r\n\r\n\tpublic runApi(): void {\r\n\t\tif (!this.fetching) {\r\n\t\t\tthis.fetching = true;\r\n\t\t\tconst request: ng.IPromise<any> = this.runGenericApi(this.dataservice as IJsonGenericDatasource2);\r\n\r\n\t\t\trequest\r\n\t\t\t\t// Need to bind this as the unit tests doesnt like the scope otherwise\r\n\t\t\t\t.catch(this.handleError.bind(this))\r\n\t\t\t\t.finally(() => this.fetching = false);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic copyToClipboard(): void {\r\n\t\tangular.element(\"#testDataserviceTextareaField\").select();\r\n\t\ttry {\r\n\t\t\tconst successful = document.execCommand(\"copy\");\r\n\t\t\tif (!successful) {\r\n\t\t\t\tthrow new Error(\"Was not able to copy\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tthis.handleError(error);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic onKeyPress($event: JQueryEventObject): void {\r\n\t\tif ($event.which === KeyCodeEnum.ENTER) {\r\n\t\t\tthis.runApi();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initGenericState(dataservice: IJsonGenericDatasource2): void {\r\n\t\tif (dataservice.inputParameters) {\r\n\t\t\tthis.parameters = dataservice.inputParameters.map((param) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: param.id,\r\n\t\t\t\t\tkey: param.key,\r\n\t\t\t\t\tvalue: \"\",\r\n\t\t\t\t\tmandatory: param.required,\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate runGenericApi(dataservice: IJsonGenericDatasource2): ng.IPromise<any> {\r\n\t\tlet paramForInput = [];\r\n\t\tif (this.parameters) {\r\n\t\t\tparamForInput = this.parameters.reduce((acc: any, param) => {\r\n\t\t\t\tacc[param.id] = param.value;\r\n\t\t\t\treturn acc;\r\n\t\t\t}, {});\r\n\t\t}\r\n\r\n\t\tswitch (this.type) {\r\n\t\t\tcase TestDataserviceDialogType.UNFORMATTED:\r\n\t\t\t\treturn this.getUnFormattedData(dataservice, paramForInput);\r\n\t\t\tcase TestDataserviceDialogType.FORMATTED:\r\n\t\t\t\treturn this.getFormattedData(dataservice, paramForInput);\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.$q.reject(new Error(\"Request format is not supported\"));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getFormattedData(dataservice: IJsonGenericDatasource2, parameters: any): ng.IPromise<any> {\r\n\r\n\t\tconst formatResults = (result: any) => {\r\n\t\t\t// As we are using getDetailData, this always returns result as a object?\r\n\t\t\tif (dataservice.outputParameters.length === 0) {\r\n\t\t\t\tthrow Error(\"No output parameter(s) specified.\");\r\n\t\t\t}\r\n\r\n\t\t\tconst formattedResult = Object.keys(result).map((key) => {\r\n\t\t\t\tconst maybeNewKey = dataservice.outputParameters.find((outputParam) => outputParam.id === key);\r\n\t\t\t\tlet newKey = key;\r\n\t\t\t\tif (maybeNewKey) {\r\n\t\t\t\t\tnewKey = !!maybeNewKey.alias ? maybeNewKey.alias : maybeNewKey.key;\r\n\t\t\t\t}\r\n\t\t\t\treturn { name: newKey, value: result[key] };\r\n\t\t\t});\r\n\t\t\treturn formattedResult;\r\n\t\t};\r\n\r\n\t\tconst setResults = (result: any) => {\r\n\t\t\tthis.fillResponseData(result);\r\n\t\t\tthis.datagridOptions.dataset = result;\r\n\t\t\treturn result;\r\n\t\t};\r\n\r\n\t\treturn this.datasourceService\r\n\t\t\t.parseDatasourceToTS(dataservice)\r\n\t\t\t.getDetailData(parameters)\r\n\t\t\t.then(result => formatResults(result))\r\n\t\t\t.then(setResults);\r\n\t}\r\n\r\n\tprivate getUnFormattedData(dataservice: IJsonGenericDatasource2, parameters: any): ng.IPromise<any> {\r\n\t\tconst setResults = (result: any) => {\r\n\t\t\tif (dataservice.typedef === DatasourceTypeEnum.IDO) {\r\n\t\t\t\tconst hasRowPointer = dataservice.outputParameters.find((item => item.key === IdoProperties.ROW_POINTER));\r\n\t\t\t\tif (!hasRowPointer) {\r\n\t\t\t\t\tfor (let i = 0; i < result.length; i++) {\r\n\t\t\t\t\t\tdelete result[i][IdoProperties.ROW_POINTER];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.fillResponseData(result);\r\n\t\t};\r\n\r\n\t\treturn this.datasourceService\r\n\t\t\t.parseDatasourceToTS(dataservice)\r\n\t\t\t.getNonParsedData(parameters)\r\n\t\t\t.then(setResults);\r\n\t}\r\n\r\n\tprivate fillResponseData(result: any): void {\r\n\t\tthis.$timeout(() => {\r\n\t\t\tthis.responseData = JsonHelper.prettify(result);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handleError(error: Error): ng.IPromise<any> {\r\n\t\tthis.responseData = Helper.cleanTemplateLiteral(error.message);\r\n\t\tconsole.error(error.message);\r\n\t\treturn this.dialogService.showError(\"Error\", error.message);\r\n\t}\r\n\r\n\tprivate initDatagridOptions(): IDataGridOptions<any> {\r\n\t\tconst columns = [\r\n\t\t\t{\r\n\t\t\t\tid: \"name\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"name\",\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"description\",\r\n\t\t\t\tname: \"Description\",\r\n\t\t\t\tfield: \"value\",\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t];\r\n\t\treturn {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [{}],\r\n\t\t};\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirTestDataserviceCtrl\", TestDataserviceDialogCtrl);\r\n\t}\r\n}\r\n","import cloneDeep from \"lodash-es/cloneDeep\";\r\nimport isEqual from \"lodash-es/isEqual\";\r\n\r\nimport { IComponentRendered } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { DatagridHelper } from \"../../sohoxi/datagrid-helper\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport const DATAGRID_RENDERED = \"finishedDatagridCreation\";\r\n/**\r\n * Data Grid Directive\r\n *\r\n * Example:\r\n *\r\n * scope[\"options\"] = {\r\n * \tdataset: [\r\n * \t\t{ name: \"Name #1\", age: 12, phone: \"12345\" },\r\n * \t\t{ name: \"Name #2\", age: 22, phone: \"1234567\" },\r\n * \t\t{ name: \"Name #3\", age: 32, phone: \"1234589\" }\r\n * \t]\r\n * }\r\n *\r\n * <div xi-datagrid=\"ctrl.options\"></div>\r\n */\r\nexport class DatagridDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiDatagrid\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options: IDataGridOptions<any> =\r\n\t\t\tscope.$eval(attributes[DatagridDirective.DIRECTIVE_NAME]);\r\n\r\n\t\tif (options.dataset) {\r\n\t\t\tif (!options.columns) {\r\n\t\t\t\t// Generate \"simple\" default columns based on dataset properties, if no columns provided\r\n\t\t\t\tconst columns = [];\r\n\t\t\t\t// ReSharper disable once MissingHasOwnPropertyInForeach\r\n\t\t\t\tfor (const propertyName in options.dataset[0]) {\r\n\t\t\t\t\tconst columnName =\r\n\t\t\t\t\t\tpropertyName[0].toUpperCase() + propertyName.substring(1);\r\n\t\t\t\t\tconst column = {\r\n\t\t\t\t\t\tid: propertyName,\r\n\t\t\t\t\t\tname: columnName,\r\n\t\t\t\t\t\tfield: propertyName,\r\n\t\t\t\t\t\twidth: 150\r\n\t\t\t\t\t};\r\n\t\t\t\t\tcolumns.push(column);\r\n\t\t\t\t}\r\n\t\t\t\toptions.columns = columns;\r\n\t\t\t}\r\n\r\n\t\t\telement.datagrid(options);\r\n\r\n\t\t\tconst api = Utils.getData(element, \"datagrid\");\r\n\r\n\t\t\tif (options.id !== undefined) {\r\n\t\t\t\tconst finishedResult: IComponentRendered = {\r\n\t\t\t\t\tid: options.id,\r\n\t\t\t\t\tapi\r\n\t\t\t\t};\r\n\t\t\t\telement.trigger(DATAGRID_RENDERED, finishedResult);\r\n\t\t\t}\r\n\r\n\t\t\tconst isDatasetEqual = (a: any, b: any): boolean => {\r\n\t\t\t\t// temp fix on equality check\r\n\t\t\t\tconst newDataset = cloneDeep(a);\r\n\t\t\t\tconst oldDataset = cloneDeep(b);\r\n\t\t\t\tnewDataset.forEach(DatagridHelper.clearSohoProperties);\r\n\t\t\t\toldDataset.forEach(DatagridHelper.clearSohoProperties);\r\n\r\n\t\t\t\treturn isEqual(newDataset, oldDataset);\r\n\t\t\t};\r\n\r\n\t\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\t\tattributes[DatagridDirective.DIRECTIVE_NAME],\r\n\t\t\t\t(\r\n\t\t\t\t\tnewOptions: IDataGridOptions<any>,\r\n\t\t\t\t\toldOptions: IDataGridOptions<any>\r\n\t\t\t\t) => {\r\n\t\t\t\t\tif (!isDatasetEqual(newOptions.dataset, oldOptions.dataset)) {\r\n\t\t\t\t\t\tapi.loadData(newOptions.dataset, {\r\n\t\t\t\t\t\t\tpreserveSelected: true // kept so selected is not fired\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (newOptions.updateDatagrid) {\r\n\t\t\t\t\t\tdelete newOptions.updateDatagrid;\r\n\t\t\t\t\t\tapi.updated(newOptions);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\t// Tear down\r\n\t\t\telement.on(\"$destroy\", () => {\r\n\t\t\t\tunbindWatcher();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(DatagridDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new DatagridDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=export-dialog ng-controller=\\\"eirExportProjectCtrl as ctrl\\\"> <div class=field> <div class=filename> <eir-input-field-component class=input-field-component label-name=\\\"Name of the exported file\\\" field-value=ctrl.exportFileName validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tvalidator: ctrl.validate,\\r\\n\\t\\t\\t\\t\\t\\t\\t\\terrorMessage: 'Valid characters are A-Z a-z 0-9 . _ -'\\r\\n\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t\\t\\t{type: 'not-empty'}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t}\\\"/> </div> <div class=extension> <p><b>{{:: \\\".\\\" + ctrl.fileExtension}}</b></p> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-click=ctrl.export() ng-disabled=ctrl.isInvalid> Export </button> </div> </div>\";\n// Exports\nmodule.exports = code;","import jsonpath from \"jsonpath\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport type { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { ITestDataserviceParameters, TestDataserviceDialogType, TTestDataserviceDialogType } from \"../../../../common/dialogs/test-dataservice/test-dataservice-dialog\";\r\n\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport type { IOperation } from \"../../../../common/model/ion-metadata.model\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogEvent, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport type { FeatureSwitchService } from \"../../../../common/services/feature-switch-service\";\r\nimport type { IFieldValidationResult } from \"../../../../common/shared-components/base/field-validation\";\r\nimport type { IonMetadataService } from \"../../../../components/services/ion-metadata-service\";\r\nimport { IWizardStep, WizardCtrl } from \"../../../editor/wizard/wizard-ctrl\";\r\nimport { RepositoryHelper } from \"../../repository-helper\";\r\n\r\nimport { DatasourceWizardHelper } from \"./datasource-wizard-helper\";\r\nimport type { IViewJsonDialogParameters } from \"./view-json-dialog/view-json-dialog-ctrl\";\r\n\r\nimport { Config, InjectNames, StatusCodes, Subcodes } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IHttpHeader, IJsonDatasource, IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport * as sw from \"ng2/common/model/swagger.model\";\r\n\r\nimport { HttpAcceptEnum } from \"ng2/common/enums/http-accept-enum\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nimport { DataServiceHelper } from \"ng2/common/helpers/data-service.helper\";\r\nimport { JsonHelper } from \"ng2/common/helpers/json.helper\";\r\n\r\nexport interface IDatasourceWizardParameter {\r\n\tdatasource?: IJsonGenericDatasource2;\r\n\tswaggerDocument?: sw.IDocument;\r\n\tfocusedOperation?: IOperation;\r\n}\r\n\r\nexport enum DatasourceCreateModeEnum {\r\n\tEDIT, FROM_SWAGGER, FROM_SCRATCH\r\n}\r\n\r\nexport class DatasourceWizardCtrl extends WizardCtrl {\r\n\r\n\tget httpMethods(): any {\r\n\t\treturn HttpVerbEnum;\r\n\t}\r\n\r\n\tswaggerDoc: sw.IDocument;\r\n\tfocusedOperation: IOperation;\r\n\r\n\tget swaggerOperation(): sw.IOperationObject {\r\n\t\treturn (this.focusedOperation && this.swaggerDoc) ?\r\n\t\t\tRepositoryHelper.getSwaggerOperation(this.focusedOperation, this.swaggerDoc) :\r\n\t\t\tnull;\r\n\t}\r\n\r\n\tget restUrl(): string {\r\n\t\treturn Config.ION_API_URL + \"/\" + Config.TENANT_ID +\r\n\t\t\tthis.datasource.suite + this.datasource.endpoint + this.datasource.resource;\r\n\t}\r\n\r\n\tsteps: IWizardStep[] = [\r\n\t\t{\r\n\t\t\tid: \"datasource-wizard-inputparameters.html\",\r\n\t\t\ttitle: \"Input Parameters\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./datasource-wizard-inputparameters.html\")\r\n\t\t}, {\r\n\t\t\tid: \"datasource-wizard-outputparameters.html\",\r\n\t\t\ttitle: \"Output Parameters\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./datasource-wizard-outputparameters.html\")\r\n\t\t}, {\r\n\t\t\tid: \"datasource-wizard-description.html\",\r\n\t\t\ttitle: \"Name &amp; Description\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./datasource-wizard-description.html\")\r\n\t\t}, {\r\n\t\t\tid: \"datasource-wizard-summary.html\",\r\n\t\t\ttitle: \"Summary\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./datasource-wizard-summary.html\")\r\n\t\t}\r\n\t];\r\n\r\n\toutputRootElementInvalid = false;\r\n\tinputRootElementInvalid = false;\r\n\tobjectIdInvalid = false;\r\n\thasRequestBody = false;\r\n\tdatasource: IJsonGenericDatasource2;\r\n\tprivate eirDialog: IDialog<IDatasourceWizardParameter>;\r\n\tprivate datasourceCreateMode: DatasourceCreateModeEnum;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TEMPLATE_CACHE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t\tInjectNames.ION_METADATA_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: IDialogBaseScope<IDatasourceWizardParameter>,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$templateCache: ng.ITemplateCacheService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t\tprivate ionMetadataService: IonMetadataService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\t$scope,\r\n\t\t\t$element,\r\n\t\t\t$templateCache,\r\n\t\t\tfeatureService\r\n\t\t);\r\n\t\tthis.initWizard();\r\n\r\n\t\tthis.nextDisabled = false;\r\n\r\n\t\tthis.eirDialog = $scope.eirDialog;\r\n\t\tconst parameter = this.eirDialog.parameter;\r\n\t\tthis.focusedOperation = this.eirDialog.parameter.focusedOperation;\r\n\t\tthis.swaggerDoc = this.eirDialog.parameter.swaggerDocument;\r\n\r\n\t\tif (false && // temporary disable\r\n\t\t\tparameter.datasource &&\r\n\t\t\t(!this.focusedOperation || !this.swaggerDoc)\r\n\t\t) {\r\n\t\t\tthis.datasource = parameter.datasource;\r\n\t\t\tthis.isBusy = true;\r\n\t\t\tthis.loadSwaggerOperation()\r\n\t\t\t\t.then(() => this.isBusy = false)\r\n\t\t\t\t.finally(() => this.runWizard());\r\n\t\t} else {\r\n\t\t\tthis.runWizard();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate runWizard(): void {\r\n\t\tif (this.eirDialog.parameter.datasource) { // Edit existing datasource\r\n\t\t\tthis.editDataservice();\r\n\t\t} else if (this.focusedOperation) {\r\n\t\t\tthis.newDataserviceFromSwaggerDocument();\r\n\t\t} else {\r\n\t\t\tthis.newDataserviceFromScratch();\r\n\t\t}\r\n\t\tthis.onChangeRequestMethod();\r\n\t}\r\n\r\n\tprivate editDataservice(): void {\r\n\t\tthis.datasourceCreateMode = DatasourceCreateModeEnum.EDIT;\r\n\t\tthis.datasource = this.eirDialog.parameter.datasource;\r\n\r\n\t\tthis.datasource.headers = BackwardCompatible\r\n\t\t\t.setDataServiceHeader(this.datasource.headers);\r\n\t}\r\n\r\n\tprivate loadSwaggerOperation(): ng.IPromise<sw.IDocument>  {\r\n\t\treturn this.ionMetadataService\r\n\t\t\t.searchOperations(this.datasource.suite, this.datasource.displayName)\r\n\t\t\t.then(operation => {\r\n\t\t\t\tthis.focusedOperation = operation[0];\r\n\t\t\t\treturn this.focusedOperation.swaggerJsonFilePath;\r\n\t\t\t})\r\n\t\t\t.then(operationPath => this.ionMetadataService.getSwaggerDoc(operationPath))\r\n\t\t\t.then(swaggerDoc => this.swaggerDoc = swaggerDoc);\r\n\t}\r\n\r\n\tprivate newDataserviceFromScratch(): void {\r\n\t\tthis.datasourceCreateMode = DatasourceCreateModeEnum.FROM_SCRATCH;\r\n\t\tthis.datasource = {\r\n\t\t\tdisplayName: \"Default\",\r\n\t\t\tmethod: HttpVerbEnum.GET,\r\n\t\t\tresource: \"/\",\r\n\t\t\ttypedef: DatasourceTypeEnum.generic,\r\n\t\t\tendpoint: \"\",\r\n\t\t\tsuite: \"\",\r\n\t\t\tversion: 2,\r\n\t\t\toutputRootElement: \"$\",\r\n\t\t\tinputRootElement: \"$\",\r\n\t\t\tbodyTemplate: \"\",\r\n\t\t\tisOutputFile: false,\r\n\t\t\tinputParameters: [],\r\n\t\t\toutputParameters: [],\r\n\t\t\toutputJson: \"\",\r\n\t\t\theaders: {},\r\n\t\t};\r\n\t}\r\n\r\n\tprivate newDataserviceFromSwaggerDocument(): void {\r\n\t\tthis.datasourceCreateMode = DatasourceCreateModeEnum.FROM_SWAGGER;\r\n\t\tconst deconstructPaths = RepositoryHelper.deconstructPath(this.focusedOperation);\r\n\t\tlet outputRootElement = \"$\";\r\n\t\tlet outputSchema = this.getResponseSchema();\r\n\t\tconst inputSchemaFetch = this.getRequestBodySchema();\r\n\t\tlet inputSchema = null;\r\n\t\tif (inputSchemaFetch) {\r\n\t\t\tinputSchema = inputSchemaFetch.schema;\r\n\t\t}\r\n\t\t// Special cases for M3\r\n\t\tif (deconstructPaths.suite === \"/M3\" && !$.isEmptyObject(outputSchema.properties)) {\r\n\t\t\tif (deconstructPaths.version === \"v1\") {\r\n\t\t\t\toutputRootElement = \"$.MIRecord[*]\";\r\n\t\t\t\toutputSchema = this.autoCorrectM3(outputSchema);\r\n\t\t\t} else { //version2\r\n\t\t\t\toutputRootElement = \"$.results[0].records[*]\";\r\n\t\t\t\toutputSchema = this.autoCorrectM3Version2(outputSchema);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet outputJson = \"{}\";\r\n\t\tlet sample: any;\r\n\t\ttry {\r\n\t\t\tsample = JsonHelper.generateSample(outputSchema, this.swaggerDoc);\r\n\t\t} catch (error) {\r\n\t\t\tthis.dialog.opened = (dialogEvent?: IDialogEvent<any>) => {\r\n\t\t\t\tlet messageOutput: string;\r\n\t\t\t\tconsole.warn(\"Schema has error:\", error);\r\n\t\t\t\tif (error instanceof Error) {\r\n\t\t\t\t\tmessageOutput = error.message;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessageOutput = \"Ops, something went wrong. See Console for details.\";\r\n\t\t\t\t}\r\n\t\t\t\tthis.dialogService.showError(\"Warning\", messageOutput);\r\n\t\t\t\treturn dialogEvent;\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (sample) {\r\n\t\t\toutputJson = JSON.stringify(sample, null, \"  \");\r\n\t\t}\r\n\t\tthis.datasource = {\r\n\t\t\tdisplayName: this.focusedOperation.operationSummary,\r\n\t\t\tmethod: this.focusedOperation.method.toUpperCase() as HttpVerbEnum,\r\n\t\t\tresource: this.configureResourcePath(deconstructPaths.resource),\r\n\t\t\ttypedef: this.getTypeDef(deconstructPaths.suite),\r\n\t\t\tendpoint: deconstructPaths.endpoint,\r\n\t\t\tsuite: deconstructPaths.suite,\r\n\t\t\tversion: 2,\r\n\t\t\toutputRootElement: outputRootElement,\r\n\t\t\tinputRootElement: \"$\",\r\n\t\t\tbodyTemplate: this.generateRequestBodyTemplate(),\r\n\t\t\tinputParameters: this.generateInputParameterObjects(),\r\n\t\t\toutputParameters: [],\r\n\t\t\theaders: this.generateRequestHeaders(deconstructPaths.suite),\r\n\t\t\tisOutputFile: false,\r\n\t\t\toutputJson,\r\n\t\t\tinputSchema,\r\n\t\t\toutputSchema,\r\n\t\t\toriginalSchema: outputSchema,\r\n\t\t};\r\n\t\t// Special cases for M3\r\n\t\tif (this.datasource.suite === \"/M3\") {\r\n\t\t\tthis.generateOutputParameters(this.datasource);\r\n\r\n\t\t\t//Add right trim as optional parameter in version 1 M3\r\n\t\t\tif (deconstructPaths.version === \"v1\" && this.datasource.method === HttpVerbEnum.GET) {\r\n\t\t\t\tthis.datasource.inputParameters.push({\r\n\t\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\t\tkey: \"righttrim\",\r\n\t\t\t\t\tparameterType: ParameterTypeEnum.QUERY,\r\n\t\t\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\t\t\trequired: false,\r\n\t\t\t\t\talias: \"\"\r\n\t\t\t\t});\r\n\t\t\t\tthis.datasource.resource += \"&righttrim={righttrim}\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getTypeDef(suite: string): DatasourceTypeEnum {\r\n\t\t// remove leading '/'\r\n\t\tconst slashIndex = suite.indexOf(\"/\");\r\n\t\tif (slashIndex === 0) {\r\n\t\t\tsuite = suite.substring(1, suite.length);\r\n\t\t}\r\n\r\n\t\tswitch (suite) {\r\n\t\t\tcase DatasourceTypeEnum.MONGOOSE:\r\n\t\t\t\treturn DatasourceTypeEnum.MONGOOSE;\r\n\t\t\tdefault:\r\n\t\t\t\treturn DatasourceTypeEnum.generic;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate autoCorrectM3(schema: sw.ISchemaObject): sw.ISchemaObject {\r\n\t\tconst json = { MIRecord: [] } as any;\r\n\t\t// TODO Refactor MUPS-2369\r\n\t\tif (!schema.properties.MIRecord) { // onprem\r\n\t\t\tconst records = [{\r\n\t\t\t\tRowIndex: \"string\",\r\n\t\t\t\tNameValue: [] as any,\r\n\t\t\t}];\r\n\t\t\tconst values = [] as any;\r\n\r\n\t\t\tObject.entries(schema.properties).forEach(([key, value]: any) => { // all m3 key-value pair\r\n\t\t\t\tvalues.push({\r\n\t\t\t\t\t\"Name\": key,\r\n\t\t\t\t\t\"Value\": value.type\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\trecords[0].NameValue = values;\r\n\t\t\tjson.MIRecord = records;\r\n\t\t\treturn JsonHelper.generateSchema(json);\r\n\t\t} else if (!$.isEmptyObject((schema.properties.MIRecord.items as sw.ISchemaObject).properties.NameValue.example)) {\r\n\t\t\t// Multi tenant cloud\r\n\t\t\tconst records = [{\r\n\t\t\t\tRowIndex: \"string\",\r\n\t\t\t\tNameValue: [] as any,\r\n\t\t\t}];\r\n\t\t\trecords[0].NameValue = (schema.properties.MIRecord.items as sw.ISchemaObject).properties.NameValue.example;\r\n\t\t\tjson.MIRecord = records;\r\n\t\t\treturn JsonHelper.generateSchema(json);\r\n\t\t}\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tprivate autoCorrectM3Version2(schema: sw.ISchemaObject): sw.ISchemaObject {\r\n\t\tconst baseProperties = schema.properties.results.items as sw.ISchemaObject;\r\n\t\tconst recordItems = baseProperties.properties.records.items as sw.ISchemaObject;\r\n\t\tconst exampleData = recordItems.example;\r\n\t\tconst json = {\r\n\t\t\tresults: [{\r\n\t\t\t\trecords: [exampleData]\r\n\t\t\t}]\r\n\t\t} as any;\r\n\t\treturn JsonHelper.generateSchema(json);\r\n\t}\r\n\r\n\tprivate configureResourcePath(resourcePath: string): string {\r\n\t\tif (this.swaggerOperation.parameters) {\r\n\t\t\tthis.swaggerOperation.parameters.forEach((item) => {\r\n\t\t\t\tif (item.in === \"query\") {\r\n\t\t\t\t\tresourcePath += (resourcePath.indexOf(\"?\") === -1 ? \"?\" : \"&\") +\r\n\t\t\t\t\t\tDataServiceHelper.getURLVariable(item.name, ParameterTypeEnum.QUERY);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn resourcePath;\r\n\t}\r\n\r\n\tonChangeRequestMethod(): void {\r\n\t\tif (this.datasource.method === HttpVerbEnum.GET) {\r\n\t\t\tthis.hasRequestBody = false;\r\n\t\t} else {\r\n\t\t\tthis.hasRequestBody = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonChangeOutputType(): void {\r\n\t\tif (this.datasource.isOutputFile) {\r\n\t\t\tthis.datasource.outputParameters = [{\r\n\t\t\t\tid: \"0\",\r\n\t\t\t\tkey: \"blob\",\r\n\t\t\t\tvalueType: ValueTypeEnum.BINARY,\r\n\t\t\t\tparameterType: ParameterTypeEnum.OUTPUT,\r\n\t\t\t\trequired: false,\r\n\t\t\t\talias: \"File\"\r\n\t\t\t}];\r\n\r\n\t\t\tthis.nextDisabled = false;\r\n\t\t} else {\r\n\t\t\tthis.datasource.outputParameters = [];\r\n\t\t}\r\n\t}\r\n\r\n\tonChangeOutputRootElement(): void {\r\n\t\tthis.outputRootElementInvalid = JsonHelper.isInvalidJsonPath(this.datasource.outputRootElement);\r\n\t}\r\n\r\n\tonChangeInputRootElement(): void {\r\n\t\tthis.inputRootElementInvalid = JsonHelper.isInvalidJsonPath(this.datasource.inputRootElement);\r\n\t}\r\n\r\n\tonChangeObjectIdPath(): void {\r\n\t\ttry {\r\n\t\t\tjsonpath.parse(this.datasource.outputRootElement + this.datasource.objectIdPath);\r\n\t\t\tconst foundMatch = jsonpath.query(\r\n\t\t\t\tJSON.parse(this.datasource.outputJson), this.datasource.outputRootElement + this.datasource.objectIdPath);\r\n\t\t\tif (foundMatch.length === 1) {\r\n\t\t\t\tthis.objectIdInvalid = false;\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error();\r\n\t\t\t}\r\n\t\t} catch {\r\n\t\t\tthis.objectIdInvalid = true;\r\n\t\t}\r\n\t}\r\n\r\n\topenTestDataserviceDialog(): ng.IPromise<IDialogResult<string>> {\r\n\t\tlet testDialogType: TTestDataserviceDialogType;\r\n\t\tconst inputParamStep = 0;\r\n\t\tconst outputParamStep = 1;\r\n\r\n\t\tswitch (this.steps.indexOf(this.currentStep)) {\r\n\t\t\tcase inputParamStep:\r\n\t\t\t\ttestDialogType = TestDataserviceDialogType.UNFORMATTED;\r\n\t\t\t\tbreak;\r\n\t\t\tcase outputParamStep:\r\n\t\t\t\ttestDialogType = TestDataserviceDialogType.FORMATTED;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\ttestDialogType = TestDataserviceDialogType.UNFORMATTED;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tconst options: IDialogOptions<ITestDataserviceParameters> = {\r\n\t\t\ttitle: \"Test Data Service\",\r\n\t\t\ttemplate: require(\"../../../../common/dialogs/test-dataservice/test-dataservice-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tdataservice: this.datasource,\r\n\t\t\t\ttype: testDialogType,\r\n\t\t\t},\r\n\t\t};\r\n\t\treturn this.dialogService.show<ITestDataserviceParameters, string>(options);\r\n\t}\r\n\r\n\topenInputJsonDialog(): void {\r\n\t\tif (this.focusedOperation && !this.datasource.inputSchema) {\r\n\t\t\tthis.datasource.inputSchema = this.getRequestBodySchema().schema;\r\n\t\t}\r\n\t\tthis.viewJsonDialog(this.datasource, true, this.onOpenJsonHelp.bind(this)).then(result => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.datasource.bodyTemplate = result.value.json;\r\n\t\t\t\tthis.datasource.inputSchema = result.value.schema;\r\n\t\t\t\tthis.datasource.inputRootElement = result.value.root;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\topenOutputJsonDialog(): void {\r\n\t\tif (this.focusedOperation && !this.datasource.outputSchema) {\r\n\t\t\tthis.datasource.outputSchema = this.getResponseSchema();\r\n\t\t}\r\n\t\tthis.viewJsonDialog(this.datasource, false, this.onOpenJsonHelp.bind(this))\r\n\t\t\t.then(result => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.datasource.outputJson = result.value.json;\r\n\t\t\t\t\tthis.datasource.outputSchema = result.value.schema;\r\n\t\t\t\t\tthis.datasource.outputRootElement = result.value.root;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tonOpenJsonHelp(): void {\r\n\t\tconst options: IDialogOptions<void> = {\r\n\t\t\ttitle: \"JSON Help\",\r\n\t\t\ttemplate: require(\"./jsonpath-help-dialog/jsonpath-help-dialog.html\")\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(options);\r\n\t}\r\n\r\n\tgenerateInputParameters(datasource: IJsonGenericDatasource2): void {\r\n\t\tconst pathParameters = this.generateInputParameterObjects();\r\n\t\tconst bodyParameters = DatasourceWizardHelper.generateParameters(datasource, true);\r\n\t\tthis.datasource.inputParameters = [...pathParameters, ...bodyParameters];\r\n\r\n\t}\r\n\r\n\tgenerateOutputParameters(datasource: IJsonGenericDatasource2): void {\r\n\t\tthis.datasource.outputParameters =\r\n\t\t\tDatasourceWizardHelper.generateParameters(datasource, false);\r\n\t}\r\n\r\n\tprivate getResponseSchema(): sw.ISchemaObject {\r\n\t\tconst responses = RepositoryHelper\r\n\t\t\t.getSwaggerOperation(\r\n\t\t\t\tthis.focusedOperation,\r\n\t\t\t\tthis.swaggerDoc)\r\n\t\t\t.responses;\r\n\r\n\t\tconst result = this.getResponseObject(responses);\r\n\t\tif (result && result.schema && JsonHelper.isCyclic(result.schema)) {\r\n\t\t\tresult.schema = JsonHelper.fixCyclic(result.schema);\r\n\t\t}\r\n\r\n\t\tif(result.schema) {\r\n\t\t\treturn this.verifyResponseSchema(result.schema);\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\r\n\tprivate verifyResponseSchema(schema: sw.ISchemaObject): sw.ISchemaObject {\r\n\r\n\t\tif (schema.allOf) {\r\n\t\t\tconst jsonSchema = schema.allOf\r\n\t\t\t\t.filter(schema => isUndefined(schema.xml));\r\n\r\n\t\t\tif (jsonSchema.length > 1) {\r\n\t\t\t\tthis.dialogService.showError(\"Error\",\r\n\t\t\t\t\t`Too many schemas was found.<br /><br />${Subcodes.CONTACT_SYSTEM_ADMIN} if problems happens during creation.`\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\treturn jsonSchema[0];\r\n\t\t}\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tprivate getResponseObject(responses: sw.IResponsesObject): sw.IResponseObject & sw.IReferenceObject {\r\n\t\tlet response: sw.IResponseObject & sw.IReferenceObject;\r\n\t\tconst successCodes = StatusCodes.success;\r\n\t\tfor (let i = 0; i < successCodes.length; i++) {\r\n\t\t\tif (successCodes[i] in responses) {\r\n\t\t\t\tconst code = successCodes[i];\r\n\t\t\t\tresponse = responses[code];\r\n\t\t\t}\r\n\t\t}\r\n\t\t// if no code is found try default\r\n\t\tif (isUndefined(response) && responses.default) {\r\n\t\t\tresponse = responses.default;\r\n\t\t} else if (isUndefined(response)) {\r\n\t\t\t// if no valid response is found, throw error and close wizard\r\n\t\t\tthis.showBadResponseError(successCodes);\r\n\t\t\tresponse = { schema: {}, description: \"\" };\r\n\t\t}\r\n\r\n\t\treturn response;\r\n\t}\r\n\r\n\tprivate showBadResponseError(successCodes: string[]): void {\r\n\t\tlet codeString: string;\r\n\t\tsuccessCodes.forEach((successCode, index) => {\r\n\t\t\tif (index === 0) {\r\n\t\t\t\tcodeString = successCode;\r\n\t\t\t} else if (index !== successCodes.length - 1) {\r\n\t\t\t\tcodeString += \", \" + successCode;\r\n\t\t\t} else {\r\n\t\t\t\tcodeString += \" & \" + successCode;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.dialogService.showError(\"Error\",\r\n\t\t\t`Method has no valid success response. <br/><br/>\r\n\t\t\tValid response status is any of ${codeString}.`\r\n\t\t);\r\n\t\tthis.dialog.opened = (dialogEvent?: IDialogEvent<any>) => {\r\n\t\t\tthis.cancel();\r\n\t\t\treturn dialogEvent;\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getRequestBodySchema(): sw.IParameterObject {\r\n\t\tconst swaggerParameter = RepositoryHelper\r\n\t\t\t.getSwaggerOperation(this.focusedOperation, this.swaggerDoc)\r\n\t\t\t.parameters;\r\n\r\n\t\tlet result = null;\r\n\t\tif (swaggerParameter) {\r\n\t\t\tresult = swaggerParameter.find(p => p.in === \"body\");\r\n\t\t}\r\n\t\tif (result && result.schema && JsonHelper.isCyclic(result.schema)) {\r\n\t\t\tresult.schema = JsonHelper.fixCyclic(result.schema);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate viewJsonDialog(\r\n\t\tdataservice: IJsonGenericDatasource2,\r\n\t\tisInput: boolean,\r\n\t\tshowHelp?: Function,\r\n\t): ng.IPromise<IDialogResult<any>> {\r\n\t\tconst options: IDialogOptions<IViewJsonDialogParameters> = {\r\n\t\t\ttitle: \"JSON Preview\",\r\n\t\t\ttemplate: require(\"./view-json-dialog/view-json-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tdataservice,\r\n\t\t\t\tisInput,\r\n\t\t\t\tshowHelp,\r\n\t\t\t},\r\n\t\t};\r\n\t\treturn this.dialogService.show<IViewJsonDialogParameters, object>(options);\r\n\t}\r\n\r\n\tprotected onChangeCurrentStep(): void {\r\n\t\t// filter out any outputparam that has key === emptyString\r\n\t\tthis.datasource.outputParameters = this.datasource.outputParameters.filter((param) => {\r\n\t\t\treturn !!param.key;\r\n\t\t});\r\n\t}\r\n\r\n\tprotected getFinishParameter(): IJsonDatasource {\r\n\t\treturn this.datasource;\r\n\t}\r\n\r\n\tnext(): void {\r\n\t\tif (this.currentStep === this.getEndStep()) {\r\n\t\t\tif (this.validate(this.datasource)) {\r\n\t\t\t\tconst result: IDialogResult<any> = {\r\n\t\t\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\t\t\tvalue: this.getFinishParameter()\r\n\t\t\t\t};\r\n\t\t\t\tthis.close(result);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst nextStepIndex = this.steps.indexOf(this.currentStep) + 1;\r\n\t\t\tthis.selectWizardStep(this.steps[nextStepIndex]);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate validate(datasource: IJsonDatasource): boolean {\r\n\t\tlet errorMessage = \"\";\r\n\t\tlet isValidated = true;\r\n\t\tconst maxLength = 128;\r\n\t\tif (datasource.displayName === \"\") {\r\n\t\t\terrorMessage = \"Name cannot be empty, please add a name.\";\r\n\t\t\tisValidated = false;\r\n\t\t}\r\n\t\tif (datasource.displayName.length > maxLength) {\r\n\t\t\terrorMessage = \"Name is too long, maximum length is 128 characters.\";\r\n\t\t\tisValidated = false;\r\n\t\t}\r\n\r\n\t\tif (!isValidated) {\r\n\t\t\tthis.dialogService.showError(\"Error\", errorMessage);\r\n\t\t}\r\n\t\treturn isValidated;\r\n\t}\r\n\r\n\tprivate generateInputParameterObjects(): IParameterObject[] {\r\n\t\tconst parameters: IParameterObject[] = [];\r\n\t\tif (this.swaggerOperation && this.swaggerOperation.parameters) {\r\n\t\t\tthis.swaggerOperation.parameters.forEach((swaggerParam) => {\r\n\t\t\t\tlet paramType: ParameterTypeEnum;\r\n\t\t\t\tconst nameValue: string = swaggerParam.name;\r\n\t\t\t\tif (swaggerParam.in === \"path\") {// Only generate for path and query\r\n\t\t\t\t\tparamType = ParameterTypeEnum.PATH;\r\n\t\t\t\t} else if (swaggerParam.in === \"query\") {\r\n\t\t\t\t\tparamType = ParameterTypeEnum.QUERY;\r\n\t\t\t\t}\r\n\t\t\t\tif (paramType) {\r\n\t\t\t\t\tparameters.push({\r\n\t\t\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\t\t\tkey: nameValue,\r\n\t\t\t\t\t\tparameterType: paramType,\r\n\t\t\t\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\t\t\t\trequired: swaggerParam.required,\r\n\t\t\t\t\t\talias: \"\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn parameters;\r\n\t}\r\n\r\n\tprivate generateRequestBodyTemplate(): null | string {\r\n\t\tconst schema = this.getRequestBodySchema();\r\n\t\tlet bodyTemplate;\r\n\t\tif (schema) {\r\n\t\t\tconst bodySchema = schema.schema;\r\n\t\t\tconst sample = JsonHelper.generateSample(bodySchema, this.swaggerDoc);\r\n\t\t\tbodyTemplate = JSON.stringify(sample, null, \"  \");\r\n\t\t}\r\n\t\treturn bodyTemplate;\r\n\t}\r\n\r\n\tprivate generateRequestHeaders(suite?: string): IHttpHeader {\r\n\t\tconst swaggerOperation = RepositoryHelper\r\n\t\t\t.getSwaggerOperation(this.focusedOperation, this.swaggerDoc);\r\n\r\n\t\tlet headers: IHttpHeader = {};\r\n\t\tconst swaggerParameter = swaggerOperation.parameters;\r\n\r\n\t\tif (swaggerParameter) {\r\n\t\t\theaders = swaggerParameter\r\n\t\t\t\t.reduce((map: IMap<string>, obj: sw.IParameterObject) => {\r\n\t\t\t\t\tif ((obj.in === \"header\" && obj.required) ||\r\n\t\t\t\t\t\t// X-Infor-MongooseConfig is actually Required, but Swagger says otherwise.\r\n\t\t\t\t\t\t// Let's pray that other Infor products have more or less correct Swagger definitions :)\r\n\t\t\t\t\t\tobj.name === \"X-Infor-MongooseConfig\"\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tmap[obj.name] = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn map;\r\n\t\t\t\t}, {});\r\n\r\n\t\t\tif (headers[\"X-Infor-MongooseConfig\"] === \"\") {\r\n\t\t\t\theaders[\"X-Infor-MongooseConfig\"] = Config.MG_CONFIG_NAME;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/* Produce is the response MIME-type, and the value of it defines what the Accept header should be set to\r\n\t\tFor now the solution is to set Accept to Produce if it's of length 1,\r\n\t\totherwise Accept is set to accept all MIME-types */\r\n\t\tif (!isUndefined(swaggerOperation.produces)) {\r\n\t\t\theaders.Accept = this.getAcceptValue(swaggerOperation.produces);\r\n\t\t} else if (!isUndefined(this.swaggerDoc.produces)) {\r\n\t\t\theaders.Accept = this.getAcceptValue(this.swaggerDoc.produces);\r\n\t\t} else {\r\n\t\t\tif (suite && suite === \"/M3\") { // M3 always need to accept application/json.\r\n\t\t\t\theaders.Accept = HttpAcceptEnum.APPLICATION_JSON;\r\n\t\t\t} else {\r\n\t\t\t\theaders.Accept = HttpAcceptEnum.ALL;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn headers;\r\n\t}\r\n\r\n\tprivate getAcceptValue(produces: string[]): HttpAcceptEnum {\r\n\t\t// AB prefers and can only work with JSON response.\r\n\t\tif (produces.find(mime => mime === HttpAcceptEnum.APPLICATION_JSON.toString())) {\r\n\t\t\treturn HttpAcceptEnum.APPLICATION_JSON;\r\n\t\t}\r\n\t\t// But if there isn't then Accept is set to accept anything. However not guaranteed it will work with AB\r\n\t\treturn HttpAcceptEnum.ALL;\r\n\t}\r\n\r\n\terrorList: IFieldValidationResult[] = [];\r\n\r\n\tget ErrorList(): IFieldValidationResult[] {\r\n\t\tconst filteredErrorList = this.errorList\r\n\t\t\t.filter((item: any) => item.status === undefined);\r\n\t\tthis.nextDisabled = filteredErrorList.length !== 0;\r\n\r\n\t\treturn this.errorList;\r\n\t}\r\n\r\n\tsetNextDisabled($item: IFieldValidationResult): void {\r\n\t\tconst indexOfItem =\r\n\t\t\tthis.errorList.findIndex(item => item.id === $item.id);\r\n\r\n\t\tif (indexOfItem === -1) {\r\n\t\t\tthis.errorList.push($item);\r\n\t\t} else {\r\n\t\t\tthis.errorList[indexOfItem] = $item;\r\n\t\t}\r\n\r\n\t\tthis.nextDisabled = this.errorList\r\n\t\t\t.filter(item => item.status === true).length > 0;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirDatasourceWizardCtrl\", DatasourceWizardCtrl);\r\n\t}\r\n}\r\n","import {\r\n\tComponentClassNames,\r\n\tComponentNames,\r\n\tFlexSizeTypeEnum,\r\n\tInteractionActionEnum,\r\n\tSettingKeys,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\n\r\nimport type { IInsertPoints } from \"editor/defines\";\r\nimport type { IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IChildScope } from \"common/interface/ichild-scope\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IFlexboxComponent } from \"common/interface/iflexbox-component\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\n\r\nimport { EditorLayoutComponentCtrl, IEditorLayoutComponent } from \"editor/components/editor-layout-component\";\r\n\r\nexport interface IEditorFlexbox extends IEditorLayoutComponent, IFlexboxComponent {\r\n\tchildren: IEditorComponent[];\r\n\tparent: IEditorLayoutComponent;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonFlexbox;\r\n}\r\n\r\nexport class EditorFlexboxCtrl extends EditorLayoutComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + ComponentNames.Flexbox,\r\n\t\t\tEditorFlexboxCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorFlexbox;\r\n\r\n\tprotected init(component: IEditorFlexbox): void {\r\n\t\tsuper.init(component);\r\n\r\n\t\tcomponent.insert = this.insert.bind(this);\r\n\t\tcomponent.getInsertPoints = this.getInsertPoints.bind(this);\r\n\t\tcomponent.removeChild = this.removeChild.bind(this);\r\n\t\tcomponent.getChildIndex = this.getChildIndex.bind(this);\r\n\t\tcomponent.detachChild = this.detachChild.bind(this);\r\n\t}\r\n\r\n\tpublic setDatasource(newDatasource: IDatasource | null): ng.IPromise<void> {\r\n\t\tconst promise = super.setDatasource(newDatasource);\r\n\t\tif (newDatasource) {\r\n\t\t\tthis.component.loadInteraction(this.interactionManagementService.createNewOnTheFly(InteractionActionEnum.GET));\r\n\t\t}\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tpublic getInsertPoints(): IInsertPoints {\r\n\t\tconst flexbox = this.component;\r\n\t\tconst thisElement = flexbox.element;\r\n\t\tconst defaultPadding = 10;\r\n\t\tconst length = thisElement.width() - defaultPadding;\r\n\t\tconst margin = 9;\r\n\t\tconst isVertical = flexbox.orientation === OrientationEnum.VERTICAL;\r\n\t\tlet position = 0;\r\n\t\tlet offset = 0;\r\n\t\tlet ghostOffset = 0;\r\n\r\n\t\tconst getPosition = (element: ng.IAugmentedJQuery) => {\r\n\t\t\tconst rootElement = \"#insideRuler\";\r\n\t\t\treturn isVertical\r\n\t\t\t\t? element.offset().left - $(rootElement).offset().left + margin\r\n\t\t\t\t: element.offset().top - $(rootElement).offset().top + margin;\r\n\t\t};\r\n\t\tconst getOffset = (element: ng.IAugmentedJQuery) => {\r\n\t\t\treturn isVertical\r\n\t\t\t\t? element.offset().top - thisElement.offset().top\r\n\t\t\t\t: element.offset().left - thisElement.offset().left;\r\n\t\t};\r\n\r\n\t\t// Rm any ghostComponents that should not be included in the calculation\r\n\t\tconst nonGhostChildren = flexbox.children.filter((childInstance: IEditorComponent, index: number) => {\r\n\t\t\tconst childElement = childInstance.element;\r\n\t\t\tconst isGhost = childElement.hasClass(\"isInsertChild\");\r\n\r\n\t\t\tif (isGhost) {\r\n\t\t\t\tghostOffset = isVertical\r\n\t\t\t\t\t? childElement.outerHeight(true)\r\n\t\t\t\t\t: childElement.outerWidth(true);\r\n\t\t\t}\r\n\r\n\t\t\treturn isGhost === false;\r\n\t\t});\r\n\r\n\t\t// When we have no children we do not need to calculate with Alignments\r\n\t\tif (nonGhostChildren.length) {\r\n\t\t\t// We recalculate and assume the 0-xy point based on where the first child offset are placed\r\n\t\t\t// Assuming first child are always at top left\r\n\t\t\tconst firstChildElement = nonGhostChildren[0].element;\r\n\t\t\tposition = getPosition(firstChildElement);\r\n\t\t\toffset = getOffset(firstChildElement);\r\n\r\n\t\t\t// Sometimes, the firstchild is not the actual first child. need to recalc\r\n\t\t\t// the offset and position then.This happens for example when we move the\r\n\t\t\t// first component instead of inserting a new component\r\n\t\t\tnonGhostChildren.forEach((childInstance) => {\r\n\t\t\t\tconst childElement = childInstance.element;\r\n\t\t\t\tconst childPosition = getPosition(childElement);\r\n\t\t\t\tconst childOffset = getOffset(childElement);\r\n\r\n\t\t\t\tif (Math.abs(position) > Math.abs(childPosition)) {\r\n\t\t\t\t\tposition = childPosition;\r\n\t\t\t\t}\r\n\t\t\t\tif (Math.abs(offset) > Math.abs(childOffset)) {\r\n\t\t\t\t\toffset = childOffset;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// the ghostoffset is contained inside the current offset. Remove it\r\n\t\t\tif (offset > ghostOffset) {\r\n\t\t\t\toffset -= ghostOffset;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet leftOffsetToAdd = 0;\r\n\t\tconst points = flexbox.children.map((childInstance: IEditorComponent) => {\r\n\t\t\t// extraOffset here take in to calculation the 1px border on both sides.\r\n\t\t\tconst extraOffset = 2;\r\n\t\t\tconst childElement = childInstance.element;\r\n\r\n\t\t\t// Check if we need to take the width or take the height\r\n\t\t\t// Depends on orientation\r\n\t\t\t// only take half the width to start the insertion closer to the true insertpoint\r\n\t\t\tconst half = 0.5;\r\n\t\t\tconst offsetToAdd = isVertical\r\n\t\t\t\t? childElement.outerHeight(true) * half + extraOffset\r\n\t\t\t\t: childElement.outerWidth(true) * half + extraOffset;\r\n\r\n\t\t\toffset += leftOffsetToAdd + offsetToAdd;\r\n\t\t\t// give the rest of the half to the next component to add\r\n\t\t\tleftOffsetToAdd = offsetToAdd;\r\n\t\t\treturn offset;\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\t// fallback orientation to vertical\r\n\t\t\torientation: flexbox.orientation || OrientationEnum.VERTICAL,\r\n\t\t\tlength: length,\r\n\t\t\tposition: position,\r\n\t\t\tpoints: points\r\n\t\t} as IInsertPoints;\r\n\t}\r\n\r\n\tpublic insert(\r\n\t\tcomponent: IJsonComponent,\r\n\t\tindex: number = this.component.getDatabearer().children.length,\r\n\t\tisFinalInsert: boolean\r\n\t): Function {\r\n\t\tconst flexboxDatabearer = this.component.getDatabearer();\r\n\r\n\t\tconst eirChildrenNode = this.$element.find(\"> .childCage > eir-children\");\r\n\t\tconst template = EditorLayoutComponentCtrl.createTemplate(component.typedef);\r\n\r\n\t\tconst childScope = this.$scope.$new() as IChildScope;\r\n\t\tchildScope.component = component;\r\n\t\tchildScope.parent = this.component as any as ILayoutComponent;\r\n\t\tchildScope.context = this.$scope.context;\r\n\t\tchildScope.index = index;\r\n\t\tlet insertedElement: ng.IAugmentedJQuery;\r\n\t\tthis.isFinalInsert = isFinalInsert;\r\n\t\tthis.$compile(template)(childScope, (clone) => {\r\n\t\t\tconst childAtGivenIndex = eirChildrenNode.children(\":nth(\" + index + \")\");\r\n\t\t\tif (childAtGivenIndex.length > 0) {\r\n\t\t\t\tchildAtGivenIndex.before(clone);\r\n\t\t\t} else { // Insert last\r\n\t\t\t\teirChildrenNode.append(clone);\r\n\t\t\t}\r\n\t\t\tinsertedElement = clone;\r\n\t\t});\r\n\r\n\t\tflexboxDatabearer.children.splice(index, 0, component);\r\n\t\treturn () => {\r\n\t\t\tflexboxDatabearer.children.splice(index, 1);\r\n\t\t\tinsertedElement.remove();\r\n\t\t\tthis.removePossibleChildInstance(index, component.id);\r\n\t\t};\r\n\t}\r\n\r\n\tpublic removeChild(childId: string): void {\r\n\t\tthis.detachChild(childId);\r\n\t}\r\n\r\n\tpublic detachChild(childId: string): IJsonComponent {\r\n\t\tconst indexToDetach = this.getChildIndex(childId);\r\n\t\tif (indexToDetach !== -1) {\r\n\t\t\tconst childDatabearer = this.component.getDatabearer().children.splice(indexToDetach, 1).pop();\r\n\t\t\tthis.removePossibleChildInstance(indexToDetach, childDatabearer.id);\r\n\r\n\t\t\treturn childDatabearer;\r\n\t\t} else {\r\n\t\t\tthrow new Error(\"[EditorFlexbox] Trying to detach nonexistent component\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setSetting(settingMeta: IComponentFieldSetting, newSettingValue: any): void {\r\n\t\tconst component = this.component;\r\n\t\tconst settingReference = settingMeta.ref;\r\n\t\tlet previousValue: any;\r\n\t\tif (settingMeta.boundarySetting) {\r\n\t\t\tpreviousValue = component.getBoundarySetting(settingReference);\r\n\t\t} else {\r\n\t\t\tpreviousValue = (component as any)[settingReference];\r\n\t\t}\r\n\t\tsuper.setSetting(settingMeta, newSettingValue);\r\n\t\tswitch (settingReference) {\r\n\t\t\tcase SettingKeys.ORIENTATION:\r\n\t\t\t\t//For orientation menu in canvas\r\n\t\t\t\tthis.editorService.currentFlexOrientationChangedEvent.raise(newSettingValue);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SettingKeys.SIZE_TYPE:\r\n\t\t\t\tlet sizeSetting: number;\r\n\t\t\t\tif (newSettingValue === FlexSizeTypeEnum.PIXELS) {\r\n\t\t\t\t\tconst defaultPixelSize = 100;\r\n\t\t\t\t\tsizeSetting = defaultPixelSize;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsizeSetting = 1;\r\n\t\t\t\t}\r\n\t\t\t\t//Size needs to update when size type is changed\r\n\t\t\t\tthis.setBoundarySetting<number>(SettingKeys.SIZE, sizeSetting);\r\n\t\t\t\tthis.editorService.refreshSettingEvent.raise(SettingKeys.SIZE);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SettingKeys.SIZE:\r\n\t\t\t\tconst radixBase = 10;\r\n\t\t\t\tconst parsed = parseInt(newSettingValue, radixBase);\r\n\t\t\t\tif (isNaN(parsed)) {\r\n\t\t\t\t\tthis.setBoundarySetting<any>(settingReference, previousValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setBoundarySetting<any>(settingReference, parsed);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// Other specific settings\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getChildIndex(childId: string): number {\r\n\t\treturn this.component.getDatabearer().children.findIndex(\r\n\t\t\t(component: IJsonComponent) => {\r\n\t\t\t\treturn component.id === childId;\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tprivate removePossibleChildInstance(index: number, childId: string): void {\r\n\t\tif (this.component.children[index] && this.component.children[index].getId() === childId) {\r\n\t\t\tconst childInstance = this.component.children.splice(index, 1).pop();\r\n\t\t\tchildInstance.getScope().$destroy(); // Will remove DOM element\r\n\t\t} else {\r\n\t\t\t// Happens sometimes when component is moved within same parent,\r\n\t\t\t// Keeping it until we have other solution to make sure we're not deleting wrong instance\r\n\t\t\tconsole.info(\"[EditorFlexbox] Did not remove instance\");\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\n\r\nexport interface IJsonCompositeComponent {\r\n\tmanifest: IJsonCompositeComponentManifest;\r\n\tcomponent: IJsonLayoutComponent;\r\n\tdatasources?: IJsonDatasource[];\r\n\tinteractions?: IJsonInteraction[];\r\n\ttranslations?: IMap<IJsonLanguageComponent[]>;\r\n\texpressions?: IJsonExpression[];\r\n}\r\n\r\nexport interface IJsonCompositeComponentManifest {\r\n\tid: string;\r\n\tdisplayName: string;\r\n\tauthor: string;\r\n\tauthorDisplayName?: string;\r\n\tcreationDate: number;\r\n\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { EditorComponentCtrl } from \"editor/components/editor-component\";\r\n\r\nimport { DesignerService } from \"../../services/designer-service\";\r\nimport { EditorService } from \"editor/services/editor-service\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { EditorHelper } from \"editor/helper\";\r\n\r\nimport {\r\n\tCanvasModeEnum,\r\n\tCssConstantKeys,\r\n\tCssConstantValues,\r\n\tEventTypes,\r\n\tInjectNames,\r\n\tInsertEventTypes,\r\n\tNumbers,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { IJQueryDragEventObject, IJQueryMouseEventObject, ViewEnum } from \"common/defines\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\nimport { Defines } from \"components/defines\";\r\nimport { SidebarViewEnum } from \"editor/defines\";\r\n\r\ninterface IMousePosition {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nexport class InsertComponentService {\r\n\tprivate currentIndex: number;\r\n\tprivate currentParent: IEditorComponent;\r\n\tprivate lastMousePosition: IMousePosition;\r\n\tprivate timerPromise: ng.IPromise<any>;\r\n\tprivate undoFunction: Function;\r\n\r\n\tprivate insertComponent: IJsonComponent;\r\n\tprivate insertType: string;\r\n\tprivate clipboardComponent: IJsonComponent;\r\n\tprivate insertParent: IEditorFlexbox;\r\n\r\n\tprivate previousInsertParent: IEditorFlexbox;\r\n\tprivate finishedDeferred: ng.IDeferred<IEditorFlexbox>;\r\n\r\n\tpublic clipboardComponentChangedEvent = new InstanceEvent<IJsonComponent>();\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DESIGNER_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate designerService: DesignerService\r\n\t) {\r\n\r\n\t\tdesignerService.viewChangedEvent.on((view: ViewEnum) => {\r\n\t\t\tif (view !== ViewEnum.EDITOR) {\r\n\t\t\t\t// Clear selection when navigating from editor\r\n\t\t\t\tthis.clearSelection();\r\n\t\t\t\tthis.cancelInserting();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(document).on(EventTypes.DRAGEND, (event) => {\r\n\t\t\tEditorComponentCtrl.dragEnterCounter = 0;\r\n\t\t\tthis.cancelInserting();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic clearSelection(): void {\r\n\t\tthis.editorService.deselectComponent();\r\n\t\tthis.editorService.setSidebarView(SidebarViewEnum.NEW_COMPONENT);\r\n\t\tthis.setClipboardComponent(null);\r\n\t}\r\n\r\n\tpublic setClipboardComponent(component: IJsonComponent): void {\r\n\t\tthis.clipboardComponent = component;\r\n\t\tthis.clipboardComponentChangedEvent.raise(component);\r\n\t}\r\n\r\n\tpublic getClipboardComponent(): IJsonComponent {\r\n\t\treturn this.clipboardComponent;\r\n\t}\r\n\r\n\tpublic getInsertComponent(): IJsonComponent {\r\n\t\treturn this.insertComponent;\r\n\t}\r\n\r\n\tprivate setInsertComponent(component?: IJsonComponent): void {\r\n\t\tif (component) {\r\n\t\t\t// Workaround to reset the counter when inserting\r\n\t\t\tEditorComponentCtrl.dragEnterCounter = 0;\r\n\t\t}\r\n\t\tthis.insertComponent = component;\r\n\t}\r\n\r\n\tpublic setInsertParent(newInsertParent?: IEditorFlexbox): void {\r\n\t\tconst oldInsertParent = this.insertParent;\r\n\t\tif (oldInsertParent) {\r\n\t\t\toldInsertParent.setIsInsertParent(false);\r\n\t\t\tthis.insertHandlerOut(oldInsertParent);\r\n\t\t}\r\n\t\tif (newInsertParent) {\r\n\t\t\tnewInsertParent.setIsInsertParent(true);\r\n\t\t} else {\r\n\t\t\tthis.showCursorNoDrop(true);\r\n\t\t}\r\n\t\tthis.insertParent = newInsertParent;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets canvas in INSERT-mode and returns a promise that,\r\n\t * when resolved, returns the new parent for the inserted component\r\n\t */\r\n\tpublic startInserting(\r\n\t\tcomponent: IJsonComponent,\r\n\t\tinsertType: string = InsertEventTypes.COPY\r\n\t): ng.IPromise<IEditorComponent> {\r\n\t\tif (this.finishedDeferred) {\r\n\t\t\tthis.finishedDeferred.reject();\r\n\t\t}\r\n\t\tthis.finishedDeferred = this.$q.defer<IEditorFlexbox>();\r\n\t\tthis.insertType = insertType;\r\n\t\tthis.setInsertComponent(component);\r\n\t\tthis.editorService.setCanvasMode(CanvasModeEnum.INSERT);\r\n\t\treturn this.finishedDeferred.promise;\r\n\t}\r\n\r\n\tpublic cancelInserting(): void {\r\n\t\tthis.resetVariables();\r\n\r\n\t\tif (this.finishedDeferred) {\r\n\t\t\tthis.finishedDeferred.reject();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic finishInsert(\r\n\t\tevent: IJQueryMouseEventObject | IJQueryDragEventObject,\r\n\t\tfinalParent: IEditorFlexbox\r\n\t): void {\r\n\t\tif (this.canInsertAt(finalParent, event)) {\r\n\t\t\tthis.cancelTimer();\r\n\t\t\t// Using original event to work with both drag and click\r\n\t\t\tconst newMousePosition = { x: event.originalEvent.offsetX, y: event.originalEvent.offsetY };\r\n\t\t\tconst foundIndex = this.currentIndex;\r\n\t\t\tconst isFinalInsert = true;\r\n\t\t\tthis.updateGhostPosition(finalParent, this.insertComponent, foundIndex, isFinalInsert);\r\n\t\t\tthis.resetVariables();\r\n\t\t\t//finalParent.updateClassesAndStyle();\r\n\t\t\tthis.finishedDeferred.resolve(finalParent);\r\n\t\t} else {\r\n\t\t\tthis.cancelInserting();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic insertIteration(\r\n\t\tevent: IJQueryMouseEventObject | IJQueryDragEventObject,\r\n\t\tnewParent: IEditorFlexbox\r\n\t): void {\r\n\t\t// Using original event to work with both drag and click\r\n\t\tconst newMousePosition = {\r\n\t\t\tx: event.originalEvent.offsetX,\r\n\t\t\ty: event.originalEvent.offsetY\r\n\t\t};\r\n\r\n\t\tif (!this.canInsertAt(newParent, event)) {\r\n\t\t\tthis.lastMousePosition = newMousePosition;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// console.log(\"insertIteartion\");\r\n\r\n\t\tthis.cancelTimer();\r\n\r\n\t\tconst TIME_UNTIL_REGISTER_NEXT_MOUSE_POSITION = 16;\r\n\t\tthis.timerPromise = this.$timeout(() => {\r\n\t\t\t// console.log(\"insidetimer\");\r\n\t\t\tif (!this.movedFarEnough(newParent, newMousePosition)) {\r\n\t\t\t\t// To update cursor\r\n\t\t\t\tthis.canInsertAt(newParent, event);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.lastMousePosition = newMousePosition;\r\n\t\t\tconst foundIndex = this.getInsertIndex(newParent, newMousePosition);\r\n\t\t\tconst updateGhostPosition =\r\n\t\t\t\tthis.currentParent !== newParent || foundIndex !== this.currentIndex;\r\n\r\n\t\t\tif (updateGhostPosition) {\r\n\t\t\t\tthis.currentIndex = foundIndex;\r\n\t\t\t\tthis.currentParent = newParent;\r\n\r\n\t\t\t\tthis.updateGhostPosition(newParent, this.insertComponent, foundIndex);\r\n\t\t\t}\r\n\t\t}, TIME_UNTIL_REGISTER_NEXT_MOUSE_POSITION);\r\n\t}\r\n\r\n\tpublic canInsertAt(parentComponent: IEditorFlexbox, event: any): boolean {\r\n\t\t// Can insert when parent doesnt contain big component and\r\n\t\tlet canInsert = !EditorHelper.containsBigComponent(parentComponent) &&\r\n\t\t\t// insertComponent is not big component or\r\n\t\t\t(!EditorHelper.isBigComponent(this.insertComponent) ||\r\n\t\t\t\t// parent doesn't have any children and insertComponent is big component or\r\n\t\t\t\t(!this.hasParentChildren(parentComponent) && EditorHelper.isBigComponent(this.insertComponent)) ||\r\n\t\t\t\t// except parent doesnt have child and insertComponent is layout component\r\n\t\t\t\t(!this.hasParentChildren(parentComponent) &&\r\n\t\t\t\t\tDefines.allComponents[this.insertComponent.typedef].isLayoutComponent));\r\n\r\n\t\tif (!canInsert) {\r\n\t\t\tcanInsert = parentComponent.getDatabearer().children[0] === this.insertComponent;\r\n\t\t}\r\n\r\n\t\tthis.showCursorNoDrop(!canInsert, event);\r\n\r\n\t\treturn canInsert;\r\n\t}\r\n\r\n\tprivate showCursorNoDrop(enable: boolean, event?: IJQueryDragEventObject): void {\r\n\t\tconst insideRulerElement = angular.element(\"body\");\r\n\r\n\t\tconst newCursorValue = (enable) ? CssConstantValues.CURSOR_NODROP : this.insertType;\r\n\t\tif (event && event.type === EventTypes.DRAGOVER) {\r\n\t\t\t// Changing cursor during drag is only supported in Safari and Edge\r\n\t\t\t// It creates flickering in IE11, it makes no difference in Chrome\r\n\t\t\tif (Helper.isSafari() || Helper.isEdge()) {\r\n\t\t\t\t// Existing components\r\n\t\t\t\tinsideRulerElement.css(CssConstantKeys.CURSOR, newCursorValue);\r\n\t\t\t\t// New components\r\n\t\t\t\t$(\".componentIconOverlay\").css(CssConstantKeys.CURSOR, newCursorValue);\r\n\t\t\t}\r\n\t\t\tif (enable) {\r\n\t\t\t\t(event.originalEvent as any).dataTransfer.dropEffect = \"none\";\r\n\t\t\t} else {\r\n\t\t\t\t(event.originalEvent as any).dataTransfer.dropEffect = this.insertType;\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t} else { // for click-click insert\r\n\t\t\tinsideRulerElement.css(CssConstantKeys.CURSOR, newCursorValue);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate hasParentChildren(parentComponent: IEditorFlexbox): boolean {\r\n\t\treturn parentComponent.getDatabearer().children.length > 0;\r\n\t}\r\n\r\n\tprivate movedFarEnough(newParent: IEditorFlexbox, newMousePosition: IMousePosition): boolean {\r\n\t\tconst lastMousePosition = this.lastMousePosition;\r\n\r\n\t\tif (!lastMousePosition) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tconst availableInsertPoints = newParent.getInsertPoints();\r\n\t\tconst orientation = availableInsertPoints ? availableInsertPoints.orientation : null;\r\n\t\tconst notNewParent = this.currentParent !== newParent;\r\n\t\tconst isVertical = orientation === OrientationEnum.VERTICAL;\r\n\t\tconst axis = isVertical ? \"y\" : \"x\";\r\n\t\tconst movedEnough = Math.abs(lastMousePosition[axis] - newMousePosition[axis]) > Numbers.TEN;\r\n\r\n\t\treturn notNewParent || movedEnough;\r\n\t}\r\n\r\n\tprivate updateGhostPosition(\r\n\t\tparentComponent: IEditorFlexbox,\r\n\t\tnewComponent: IJsonComponent,\r\n\t\tfoundIndex: number,\r\n\t\tisFinalInsert?: boolean\r\n\t): void {\r\n\t\tif (this.undoFunction) {\r\n\t\t\tthis.undoFunction();\r\n\t\t\tEditorHelper.updateParentComponentSizeClass(this.previousInsertParent);\r\n\t\t}\r\n\t\tif (newComponent) {\r\n\t\t\tthis.undoFunction = parentComponent.insert(newComponent, foundIndex, isFinalInsert);\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[InsertComponentService] Tried to insert null component\");\r\n\t\t}\r\n\r\n\t\tparentComponent.updateClassesAndStyle();\r\n\t\tparentComponent.updateIsFlexParent();\r\n\r\n\t\tEditorHelper.updateParentComponentSizeClass(parentComponent);\r\n\t\tthis.previousInsertParent = parentComponent;\r\n\t}\r\n\r\n\tprivate getInsertIndex(newParent: IEditorFlexbox, mousePosition: IMousePosition): number {\r\n\t\tconst availableInsertPoints = newParent.getInsertPoints();\r\n\t\tconst isHorizontal = availableInsertPoints.orientation === OrientationEnum.HORIZONTAL;\r\n\t\tconst isVertical = availableInsertPoints.orientation === OrientationEnum.VERTICAL;\r\n\t\tlet foundIndex: number;\r\n\r\n\t\tif (isHorizontal || isVertical) {\r\n\t\t\tconst positionToCompare = isVertical\r\n\t\t\t\t? mousePosition.y\r\n\t\t\t\t: mousePosition.x;\r\n\r\n\t\t\tfor (let index = 0; index < availableInsertPoints.points.length; index++) {\r\n\t\t\t\tif (positionToCompare < availableInsertPoints.points[index]) {\r\n\t\t\t\t\tfoundIndex = index;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[InsertHandler] Unsupported orientation\");\r\n\t\t}\r\n\r\n\t\treturn foundIndex;\r\n\t}\r\n\r\n\tpublic insertHandlerOut(parentComponent: IEditorFlexbox): void {\r\n\t\tthis.cancelTimer();\r\n\t\tif (this.undoFunction) {\r\n\t\t\tthis.undoFunction();\r\n\t\t\tif (parentComponent) {\r\n\t\t\t\tEditorHelper.updateParentComponentSizeClass(parentComponent);\r\n\t\t\t}\r\n\t\t\tthis.undoFunction = null;\r\n\t\t}\r\n\t\tthis.currentParent = null;\r\n\t}\r\n\r\n\tprivate cancelTimer(): void {\r\n\t\tconst promise = this.timerPromise;\r\n\t\tif (promise) {\r\n\t\t\tthis.$timeout.cancel(promise);\r\n\t\t\tthis.timerPromise = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate resetVariables(): void {\r\n\t\tthis.lastMousePosition = null;\r\n\t\tthis.undoFunction = null;\r\n\t\tthis.currentIndex = null;\r\n\t\tthis.currentParent = null;\r\n\t\tthis.setInsertComponent(null);\r\n\t\tif (this.insertParent) {\r\n\t\t\tthis.insertParent.forEachChild((child: IEditorComponent) => {\r\n\t\t\t\tif (child.getScope().eirEditorComponent.isInsertChild) {\r\n\t\t\t\t\tchild.setIsInsertChild(false);\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t}\r\n\t\tthis.setInsertParent(null);\r\n\t\tangular.element(\"body\").css(CssConstantKeys.CURSOR, \"\");\r\n\t\tangular.element(\".componentIconOverlay\").css(CssConstantKeys.CURSOR, CssConstantValues.CURSOR_POINTER);\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.INSERT_COMPONENT_SERVICE, InsertComponentService);\r\n\t}\r\n}\r\n","import type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nexport const STANDARD_ID_PREFIX = \"standardBoundary_\";\r\n\r\nexport const WIDGET_BOUNDARIES: IBoundary[] = [\r\n\t{ id: STANDARD_ID_PREFIX + \"5\", displayName: \"Homepage Widget S\", limitX: 358 },\r\n\t{ id: STANDARD_ID_PREFIX + \"6\", displayName: \"Homepage Widget M\", limitX: 738 },\r\n\t{ id: STANDARD_ID_PREFIX + \"7\", displayName: \"Homepage Widget L\", limitX: 1118 },\r\n\t{ id: STANDARD_ID_PREFIX + \"8\", displayName: \"Homepage Widget XL\", limitX: 1498 }\r\n];\r\n\r\nexport const STANDARD_BOUNDARIES: IBoundary[] = [\r\n\t{ id: STANDARD_ID_PREFIX + \"1\", displayName: \"Mobile\", limitX: 688 },\r\n\t{ id: STANDARD_ID_PREFIX + \"2\", displayName: \"Tablet\", limitX: 992 },\r\n\t{ id: STANDARD_ID_PREFIX + \"3\", displayName: \"Small Display\", limitX: 1312 },\r\n\t{ id: STANDARD_ID_PREFIX + \"4\", displayName: \"Large Display\", limitX: 1920 },\r\n\t...WIDGET_BOUNDARIES\r\n];\r\n","export enum HttpAcceptEnum {\r\n\tAPPLICATION_JSON = \"application/json\",\r\n\tALL = \"*/*\"\r\n}\r\n","import { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nexport interface IMetaData {\r\n\tinputFields: IMetaDataField[];\r\n\toutputFields: IMetaDataField[];\r\n}\r\n","import { IJsonComponent, IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonLookup extends IJsonComponent {\r\n\tlabel: IJsonValueSource;\r\n\tshowLabel: IJsonValueSource;\r\n\ttext: IJsonValueSource;\r\n\tcolumns: IExtendedDataGridColumn[];\r\n\tboundarySettings: IMap<IJsonLookupSettings>;\r\n\tlookupOutputId: string;\r\n}\r\n\r\nexport interface IJsonLookupSettings extends IJsonComponentSettings {\r\n\trowHeight: string;\r\n\tboxWidth: string;\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport {\r\n\tChartTypeEnum, InteractionActionEnum, InteractionPairOperation, SettingKeys,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonChart, IJsonChartDataset } from \"ng2/common/model/databearer/components/json-chart.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nimport { IChartDataItem, IChartDataset } from \"../../common/model/sohoxi/sohoxi-chart.model\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\n\r\nexport class Chart extends Component {\r\n\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.LIST];\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Header\",\r\n\t\tref: SettingKeys.CHART_TITLE,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Category axis title\",\r\n\t\tref: SettingKeys.CHART_AXIS_CATEGORY_TITLE,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Value axis title\",\r\n\t\tref: SettingKeys.CHART_AXIS_VALUES_TITLE,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tprotected databearer: IJsonChart;\r\n\t// Bindable2\r\n\tpublic title: string;\r\n\tpublic showLabel: boolean;\r\n\tpublic axisCategoryTitle: string;\r\n\tpublic axisValuesTitle: string;\r\n\tpublic textType: any;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonChart,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService,\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tif (!this.databearer.datasets) {\r\n\t\t\tthis.databearer.datasets = [];\r\n\t\t}\r\n\r\n\t\tBackwardCompatible.tryConvertLegacyChart(this.databearer, obj);\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\r\n\t\tthis.updateWhenExist();\r\n\t}\r\n\r\n\t// Wait for the chart element to exist before rendering\r\n\tprivate updateWhenExist(): void {\r\n\t\tconst checkInterval = 100; // check every 100ms\r\n\t\tconst checkExist = setInterval(() => {\r\n\t\t\tif ($(`#chart-${this.getId()}`).length > 0) {\r\n\t\t\t\tthis.updateChart();\r\n\t\t\t\tclearInterval(checkExist);\r\n\t\t\t}\r\n\t\t}, checkInterval);\r\n\t}\r\n\r\n\tpublic newBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\tthis.updateChart();\r\n\t}\r\n\r\n\tpublic updateVisibility(): void {\r\n\t\tsuper.updateVisibility();\r\n\t\tthis.updateWhenExist();\r\n\t}\r\n\r\n\tpublic loadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.LIST) {\r\n\t\t\tinteractionPromise.then(() => {\r\n\t\t\t\tthis.updateChart();\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tpublic datasourceChanged(newDatasource: IDatasource): void {\r\n\t\tif (!newDatasource) {\r\n\t\t\tthis.datasource = undefined;\r\n\t\t\tthis.getDatabearer().datasets = [];\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setBindableValue(bindableReference: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\tthis.updateChart();\r\n\t}\r\n\r\n\tpublic getDatabearer(): IJsonChart {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tprivate getSohoChartType(chartEnum: ChartTypeEnum): string {\r\n\t\tconst sohoString = chartEnum.toString().split(/(?=[A-Z])/)\r\n\t\t\t.map((s) => s.charAt(0).toLowerCase() + s.substring(1))\r\n\t\t\t.join(\"-\");\r\n\t\treturn sohoString;\r\n\t}\r\n\r\n\tprivate getExampleData(): IChartDataset[] {\r\n\t\tconst exampleDatasets: IChartDataset[] = [\r\n\t\t\t{\r\n\t\t\t\tname: \"Component A\",\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"Jan\",\r\n\t\t\t\t\t\tvalue: 12,\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Feb\",\r\n\t\t\t\t\t\tvalue: 11\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Mar\",\r\n\t\t\t\t\t\tvalue: 14\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Apr\",\r\n\t\t\t\t\t\tvalue: 10\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"May\",\r\n\t\t\t\t\t\tvalue: 14\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Jun\",\r\n\t\t\t\t\t\tvalue: 8\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: \"Component B\",\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"Jan\",\r\n\t\t\t\t\t\tvalue: 22,\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Feb\",\r\n\t\t\t\t\t\tvalue: 21\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Mar\",\r\n\t\t\t\t\t\tvalue: 24\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Apr\",\r\n\t\t\t\t\t\tvalue: 20\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"May\",\r\n\t\t\t\t\t\tvalue: 24\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Jun\",\r\n\t\t\t\t\t\tvalue: 28\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: \"Component C\",\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"Jan\",\r\n\t\t\t\t\t\tvalue: 32,\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Feb\",\r\n\t\t\t\t\t\tvalue: 31\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Mar\",\r\n\t\t\t\t\t\tvalue: 34\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Apr\",\r\n\t\t\t\t\t\tvalue: 30\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"May\",\r\n\t\t\t\t\t\tvalue: 34\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Jun\",\r\n\t\t\t\t\t\tvalue: 38\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t}\r\n\t\t];\r\n\t\treturn exampleDatasets;\r\n\t}\r\n\r\n\tprivate getDataset(list: any[]): IChartDataset[] {\r\n\t\tconst datasets: IChartDataset[] = [];\r\n\t\tif (list) {\r\n\t\t\tconst datasetsMetadata: IJsonChartDataset[] = this.getDatabearer().datasets;\r\n\t\t\tconst sohoDatasetMaxSize = 20;\r\n\t\t\tlist.splice(sohoDatasetMaxSize, list.length); // soho dataset size limit\r\n\r\n\t\t\tdatasetsMetadata.forEach(datasetMetadata => {\r\n\t\t\t\tconst dataset: IChartDataset = {\r\n\t\t\t\t\tname: datasetMetadata.name,\r\n\t\t\t\t\tdata: [],\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlist.forEach(row => {\r\n\t\t\t\t\tconst keys = Object.keys(row);\r\n\t\t\t\t\tconst dataItem: IChartDataItem = { name: \"\", value: 0 };\r\n\t\t\t\t\tkeys.forEach(key => {\r\n\t\t\t\t\t\tif (key === datasetMetadata.categories) {\r\n\t\t\t\t\t\t\tdataItem.name = row[key];\r\n\t\t\t\t\t\t} else if (key === datasetMetadata.series) {\r\n\t\t\t\t\t\t\tlet value = row[key];\r\n\t\t\t\t\t\t\tif (typeof value !== \"number\") {\r\n\t\t\t\t\t\t\t\tvalue = parseInt(value, 10);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdataItem.value = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!isNaN(dataItem.value) && dataItem.name) {\r\n\t\t\t\t\t\tdataset.data.push(dataItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tdatasets.push(dataset);\r\n\t\t\t});\r\n\r\n\t\t\tswitch (this.getBoundarySetting(SettingKeys.CHART_TYPE)) {\r\n\t\t\t\tcase ChartTypeEnum.Bar:\r\n\t\t\t\tcase ChartTypeEnum.Column:\r\n\t\t\t\tcase ChartTypeEnum.Donut:\r\n\t\t\t\tcase ChartTypeEnum.Pie:\r\n\t\t\t\t\tdatasets.splice(1, datasets.length); // splice down to one dataset\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ChartTypeEnum.BarGrouped:\r\n\t\t\t\tcase ChartTypeEnum.BarStacked:\r\n\t\t\t\tcase ChartTypeEnum.ColumnGrouped:\r\n\t\t\t\tcase ChartTypeEnum.ColumnStacked:\r\n\t\t\t\t\tif (datasets.length === 1) { // soho needs at least 2 datasets\r\n\t\t\t\t\t\tdatasets.push({ name: \"\", data: [] } as IChartDataset); // dummy dataset\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (datasets.length > 0) {\r\n\t\t\treturn datasets;\r\n\t\t} else if (this.getDatabearer().datasets.length > 0) {\r\n\t\t\treturn [];\r\n\t\t} else {\r\n\t\t\treturn this.getExampleData();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic updateChart(): void {\r\n\t\tconst chartElement = $(`#chart-${this.getId()}`);\r\n\t\tif (chartElement.length > 0 && chartElement.parent().height() > 0) {\r\n\t\t\tlet dataset: IChartDataset[] = [];\r\n\t\t\tconst listResult = angular.copy(this.getContext().ListResult);\r\n\t\t\tdataset = this.getDataset(listResult);\r\n\t\t\tchartElement.removeClass();\r\n\t\t\tchartElement.addClass(\"chart-container\");\r\n\t\t\tconst hasLabel = this.getBoundarySetting<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\t\tconst chartWrapper = $(\"div.chart > div.widget-content\");\r\n\t\t\t$(\"header.application-header\").length > 0 ?\r\n\t\t\t\tchartWrapper.addClass(\"has-header\") :\r\n\t\t\t\tchartWrapper.removeClass(\"has-header\");\r\n\t\t\thasLabel ? chartWrapper.addClass(\"has-title\") : chartWrapper.removeClass(\"has-title\");\r\n\t\t\tconst chartType = this.getBoundarySetting(SettingKeys.CHART_TYPE) as ChartTypeEnum;\r\n\t\t\tchartElement.chart({\r\n\t\t\t\ttype: this.getSohoChartType(chartType),\r\n\t\t\t\tdataset,\r\n\t\t\t\taxisLabels: {\r\n\t\t\t\t\tleft: this.axisValuesTitle,\r\n\t\t\t\t\tbottom: this.axisCategoryTitle,\r\n\t\t\t\t},\r\n\t\t\t\tshowLegend: this.getBoundarySetting(SettingKeys.CHART_LEGEND_DISPLAY),\r\n\t\t\t\tanimate: this.getBoundarySetting(SettingKeys.CHART_STARTUP_ANIMATION_ENABLE),\r\n\t\t\t\tisArea: chartType === ChartTypeEnum.Area,\r\n\t\t\t\tisDonut: chartType === ChartTypeEnum.Donut,\r\n\t\t\t\t// TODO: Fix this MUPS-2682\r\n\t\t\t\tisGrouped: (chartType as any).includes(\"grouped\"),\r\n\t\t\t\tisStacked: (chartType as any).includes(\"stacked\"),\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./chart.html\"),\r\n\t\t\treplace: true,\r\n\t\t};\r\n\t}];\r\n}\r\n","import { ChartTypeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonComponent, IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonChart extends IJsonComponent {\r\n\ttitle: IJsonValueSource;\r\n\tshowLabel: boolean; // Deprecated\r\n\taxisCategoryTitle: IJsonValueSource;\r\n\taxisValuesTitle: IJsonValueSource;\r\n\tdatasets: IJsonChartDataset[];\r\n\tcontent: IJsonValueSource;\r\n\tboundarySettings: IMap<IJsonChartBoundarySettings>;\r\n\tcategories: IJsonChartCategories[];  // backwards compatibility, legacy format\r\n\tseries: IJsonChartSerie[];  // backwards compatibility, legacy format\r\n}\r\n\r\nexport interface IJsonChartDataset {\r\n\tname: string;\r\n\tcategories: string;\r\n\tseries: string;\r\n}\r\n\r\nexport interface IJsonChartBoundarySettings extends IJsonComponentSettings {\r\n\tchartType: ChartTypeEnum;\r\n\tlegendDisplay: boolean;\r\n\tstartupAnimationEnable: boolean;\r\n\tshowLabel: boolean;\r\n}\r\n\r\n//#region backwards compatibility, legacy formats\r\nexport interface IJsonChartContent {\r\n\tname: string;\r\n\tfield: string;\r\n}\r\n\r\nexport interface IJsonChartCategories extends IJsonChartContent {\r\n}\r\n\r\nexport interface IJsonChartSerie extends IJsonChartContent {\r\n\tchartType: ChartTypeEnum;\r\n}\r\n//#endregion\r\n","import type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { IJsonRadioButtons, IRadioButton } from \"../../common/model/component/radiobutton.model\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tInteractionPairOperation, InteractionTriggerEnum, SettingInputKeys,\r\n\tSettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport type { IRadioButtonComponent } from \"common/interface/iradiobutton-component\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport class RadioButton extends Component implements IRadioButtonComponent {\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS.concat([\r\n\t\tInteractionPairOperation.LIST,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t]);\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Show Label\",\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true,\r\n\t\t}, {\r\n\t\t\ttitle: \"Disabled\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false,\r\n\t\t\tbutton: {\r\n\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\tdialog: true\r\n\t\t\t}\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Selected Item Value\",\r\n\t\tref: SettingKeys.CURRENT_ITEM_VALUE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true,\r\n\t}, {\r\n\t\tname: \"Selected Item Name\",\r\n\t\tref: SettingKeys.CURRENT_ITEM_NAME,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true,\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tradioButtons: IRadioButton[];\r\n\tselectedRadioButtonId: string;\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tcurrentItemValue: string;\r\n\tcurrentItemName: string;\r\n\tprotected databearer: IJsonRadioButtons;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonRadioButtons,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.radioButtons = this.databearer.componentRadioButtons;\r\n\t\tif (this.radioButtons.length ) {\r\n\t\t\tthis.selectedRadioButtonId = this.radioButtons[0].id;\r\n\t\t\tthis.currentItemName = this.radioButtons[0].name;\r\n\t\t\tthis.currentItemValue = this.radioButtons[0].field;\r\n\t\t}\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.selectedRadioButtonId = this.radioButtons[0].id;\r\n\t\tthis.currentItemName = this.radioButtons[0].name;\r\n\t\tthis.currentItemValue = this.radioButtons[0].field;\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tsetCurrentItem(selected: IRadioButton): void {\r\n\t\tthis.currentItemValue = selected.field;\r\n\t\tthis.currentItemName = selected.name;\r\n\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\t}\r\n\r\n\tupdateValuesWithTranslations(): void {\r\n\t\tthis.radioButtons.forEach((radioButton) => {\r\n\t\t\tconst translatedTitle = this.frameworkService.getTranslatableStringByProperty(this.getId(), radioButton.id);\r\n\r\n\t\t\tif (translatedTitle) {\r\n\t\t\t\tconst globalString = this.frameworkService.getGlobalValue(radioButton.name, this);\r\n\t\t\t\tradioButton.name = translatedTitle;\r\n\r\n\t\t\t\tif (globalString) {\r\n\t\t\t\t\tradioButton.value = globalString;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.selectedRadioButtonId === radioButton.id) {\r\n\t\t\t\t\tthis.currentItemName = translatedTitle;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./radiobutton.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import { Config, DeveloperConstants, InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\n\r\nimport type { IJsonM3CloudData } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type {\r\n\tIIonApiContext,\r\n\tIIonApiOptions,\r\n\tIIonApiRequestOptions,\r\n} from \"ng2/common/model/ion-api/ion-api.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { HttpUtil } from \"common/services/http-utils\";\r\n\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport class IonApiContext implements IIonApiContext {\r\n\tconstructor(\r\n\t\tprivate url: string,\r\n\t\tprivate tenantId: string,\r\n\t\tprivate token: string\r\n\t) { }\r\n\r\n\tgetUrl(setTenant = true): string {\r\n\t\tif (setTenant) {\r\n\t\t\treturn this.url + \"/\" + this.tenantId;\r\n\t\t} else {\r\n\t\t\treturn this.url + Config.ION_API_ROOT;\r\n\t\t}\r\n\t}\r\n\r\n\tgetToken(): string {\r\n\t\treturn this.token;\r\n\t}\r\n\r\n\tsetToken(token: string): void {\r\n\t\tthis.token = token;\r\n\t}\r\n\r\n\tsetUrl(url: string): void {\r\n\t\tthis.url = url;\r\n\t}\r\n\r\n\tgetHeaderName(): string {\r\n\t\treturn \"Authorization\";\r\n\t}\r\n\r\n\tgetHeaderValue(): string {\r\n\t\treturn \"Bearer \" + this.token;\r\n\t}\r\n}\r\n\r\nexport class IonApiService {\r\n\r\n\tprivate get isDeveloperModeActive(): boolean {\r\n\t\treturn Config.IS_DEV && localStorage.getItem(DeveloperConstants.ION_PROXY) === \"true\";\r\n\t}\r\n\r\n\tprivate ionApiContext: IonApiContext;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate httpService: HttpService\r\n\t) {\r\n\t}\r\n\r\n\tgetIonApiContextAsync(options?: IIonApiOptions): ng.IPromise<IIonApiContext> {\r\n\t\tconst deferred = this.$q.defer<IIonApiContext>();\r\n\t\tconst refresh = options && options.refresh;\r\n\r\n\t\tif (Config.ION_API_URL) {\r\n\t\t\tconst hasToken = this.ionApiContext && this.ionApiContext.getToken();\r\n\t\t\tconst ionBaseURL = this.getIonBaseUrl();\r\n\r\n\t\t\tif (!hasToken || refresh) {\r\n\t\t\t\tconst tokenURL =\r\n\t\t\t\t\tthis.isDeveloperModeActive ?\r\n\t\t\t\t\t\t`${Config.REST_ROOT}/settings/token` :\r\n\t\t\t\t\t\t\"/grid/rest/security/sessions/oauth?forceRefresh=true\";\r\n\r\n\t\t\t\tthis.httpService.executeRequest<string>({ url: tokenURL, method: HttpVerbEnum.GET, cache: false })\r\n\t\t\t\t\t.then((response) => {\r\n\r\n\t\t\t\t\t\tconst token = DEV_SERVER ?\r\n\t\t\t\t\t\t\t(response.data as any).data :\r\n\t\t\t\t\t\t\tresponse.data;\r\n\r\n\t\t\t\t\t\tconst context = new IonApiContext(ionBaseURL, Config.TENANT_ID, token);\r\n\t\t\t\t\t\tthis.ionApiContext = context;\r\n\t\t\t\t\t\tdeferred.resolve(context);\r\n\t\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\t\tdeferred.reject(error);\r\n\t\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tif (this.ionApiContext.getUrl() !== ionBaseURL) {\r\n\t\t\t\t\tthis.ionApiContext.setUrl(ionBaseURL);\r\n\t\t\t\t}\r\n\t\t\t\tdeferred.resolve(this.ionApiContext);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdeferred.reject();\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate getIonBaseUrl(): string {\r\n\t\tconst proxyURL = `http://localhost:${Config.ION_API_PROXY_PORT}`;\r\n\r\n\t\t// Possible alternative to the proxy running in our own server, see grunt job ion-api-proxy\r\n\t\t//const proxyURL = \"https://localhost:8000\";\r\n\t\treturn this.isDeveloperModeActive ?\r\n\t\t\tproxyURL :\r\n\t\t\tConfig.ION_API_URL;\r\n\r\n\t}\r\n\r\n\texecuteIonApiAsync<T>(options: IIonApiRequestOptions): ng.IPromise<ng.IHttpPromiseCallbackArg<T>> {\r\n\t\tconst deferred = this.$q.defer<ng.IHttpPromiseCallbackArg<T>>();\r\n\t\tthis.getIonApiContextAsync().then((context: IIonApiContext) => {\r\n\t\t\tthis.executeIonApi(context, options, deferred, false);\r\n\t\t}).catch(r => {\r\n\t\t\tdeferred.reject(r);\r\n\t\t});\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\t/**\r\n\t * NOTE: Solution copied from lime (May 2017, HEAD at 2203077d3a3):\r\n\t *\thttp://git.infor.com/projects/ITECH/repos/homepages/browse/\r\n\t\t* Client/Framework/Framework/scripts/lime/app/container.ts#1034\r\n\t\t*/\r\n\tprivate executeIonApi<T>(\r\n\t\tcontext: IIonApiContext,\r\n\t\toptions: IIonApiRequestOptions,\r\n\t\tdeferred: ng.IDeferred<any>,\r\n\t\tisRetry: boolean\r\n\t): void {\r\n\t\tconst url = options.url;\r\n\t\tconst contextUrl = context.getUrl(options.setTenant);\r\n\t\tif (url && url.indexOf(\"https://\") !== 0 && url.indexOf(contextUrl) !== 0) {\r\n\t\t\t// Prepend the ION API base URL to the relative URL\r\n\t\t\toptions.url = HttpUtil.combine(contextUrl, url);\r\n\t\t}\r\n\r\n\t\t// Add the authorization header for ION API including the OAuth token.\r\n\t\tconst headers = options.headers || {};\r\n\t\theaders[context.getHeaderName()] = context.getHeaderValue();\r\n\t\toptions.headers = headers;\r\n\r\n\t\tthis.httpService.executeRequest(options).then((httpResponse: ng.IHttpResponse<any>) => {\r\n\t\t\t//M3 returns failures as 200 in some cases. Currently only covering M3 Cloud data.\r\n\t\t\tconst m3Data = httpResponse.data as unknown as IJsonM3CloudData;\r\n\t\t\tif (m3Data && m3Data.nrOfFailedTransactions && m3Data.nrOfFailedTransactions > 0) {\r\n\t\t\t\tconst modifiedHttpResponse = {\r\n\t\t\t\t\t...httpResponse,\r\n\t\t\t\t};\r\n\t\t\t\tmodifiedHttpResponse.data.error = {\r\n\t\t\t\t\tmessage: m3Data.results[0].errorMessage,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tdeferred.reject(modifiedHttpResponse);\r\n\t\t\t}\r\n\r\n\t\t\t// Resolve successful request.\r\n\t\t\tdeferred.resolve(httpResponse);\r\n\t\t}).catch((error: ng.IHttpResponse<any>) => {\r\n\t\t\tconst unauthorizedError = 401;\r\n\t\t\tconst isUnauthorized = error.status === unauthorizedError;\r\n\t\t\t// Check if the failed request should be retried with a new ION API context\r\n\t\t\tif (!isRetry && isUnauthorized && options.ionApiRetry !== false) {\r\n\t\t\t\tthis.getIonApiContextAsync({ refresh: true }).then((retryContext: IIonApiContext) => {\r\n\t\t\t\t\tthis.executeIonApi(retryContext, options, deferred, true);\r\n\t\t\t\t}).catch(retryError => {\r\n\t\t\t\t\t// Reject when a new context cannot be retrieved\r\n\t\t\t\t\tdeferred.reject(retryError);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Reject failed retry attemtps or when retry is disabled\r\n\t\t\t\tdeferred.reject(error);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.ION_API_SERVICE, IonApiService);\r\n\t}\r\n}\r\n","import type { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\n\r\nimport { IJsonFlexbox, IJsonFlexboxSettings } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonTabs extends IJsonLayoutComponent {\r\n\torientation: OrientationEnum;\r\n\tchildren: IJsonTabPanel[];\r\n\tcomponentTabs: IJsonTabComponent[];\r\n\tboundarySettings: IMap<IJsonFlexboxSettings>;\r\n}\r\n\r\nexport interface IJsonTabPanel extends IJsonFlexbox {\r\n}\r\n\r\nexport interface IJsonTabComponent {\r\n\tid: string;\r\n\tname: string;\r\n\tfield?: string;\r\n\tvalue?: string; //TODO move value MUPS-3016\r\n}\r\n","import { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonRuntimeMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { RuntimeApp } from \"ng2/common/project/runtime-app\";\r\nimport { IAvailableSourceField } from \"../common/defines\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\nimport { CommonService } from \"../common/services/common-service\";\r\nimport { FrameworkService } from \"../components/services/framework-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\n\r\nexport class RuntimeService {\r\n\tstatic $inject = [\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate languageService: LanguageService\r\n\t) {\r\n\t}\r\n\r\n\tloadRuntimeProject(projectId: string, canvasWidth: number): ng.IPromise<RuntimeApp> {\r\n\t\tconst promise = this.commonService.loadProject(projectId, canvasWidth) as ng.IPromise<IJsonRuntimeMashup>;\r\n\t\treturn this.parseAndSetApp(promise, canvasWidth);\r\n\t}\r\n\r\n\tloadPublishedProject(projectId: string, canvasWidth: number): ng.IPromise<RuntimeApp> {\r\n\t\tconst promise = this.commonService.loadPublishedProject(projectId, canvasWidth);\r\n\t\treturn this.parseAndSetApp(promise, canvasWidth);\r\n\t}\r\n\r\n\tloadPublishedProjectNoConstraint(projectId: string, canvasWidth: number): ng.IPromise<RuntimeApp> {\r\n\t\tconst promise = this.commonService.loadPublishedProjectNoConstraints(projectId, canvasWidth);\r\n\t\treturn this.parseAndSetApp(promise, canvasWidth);\r\n\t}\r\n\r\n\tgetCurrentProject(): RuntimeApp {\r\n\t\treturn this.commonService.getCurrentProject() as RuntimeApp;\r\n\t}\r\n\r\n\tsetCurrentRootComponentInstance(component: ILayoutComponent): void {\r\n\t\tthis.commonService.setCurrentRootComponentInstance(component);\r\n\t}\r\n\r\n\tgetCurrentBoundary(): IBoundary {\r\n\t\treturn this.commonService.getCurrentBoundary();\r\n\t}\r\n\r\n\trunStartupInteractions(): void {\r\n\t\tthis.frameworkService.runStartupInteractions();\r\n\t}\r\n\r\n\tupdateCurrentBoundary(canvasWidth: number): void {\r\n\t\tthis.commonService.updateCurrentBoundary(canvasWidth);\r\n\t}\r\n\r\n\tinstantiateDataservice(id: string): IDatasource {\r\n\t\treturn this.frameworkService.getDatasourceObject(id);\r\n\t}\r\n\r\n\tsetCurrentUrlValues(urlDataset: string[]): void {\r\n\t\tconst newUrlMetaData: IAvailableSourceField[] = [];\r\n\t\turlDataset.forEach((urlData) => {\r\n\t\t\tconst name = urlData.substring(0, urlData.indexOf(\"=\"));\r\n\t\t\tconst value = urlData.substring(urlData.lastIndexOf(\"=\") + 1);\r\n\t\t\tconst sourceField: IAvailableSourceField = {\r\n\t\t\t\tvisibleName: name,\r\n\t\t\t\tsourceKey: name,\r\n\t\t\t\tsourceKeyShort: name,\r\n\t\t\t\tcurrentValue: value,\r\n\t\t\t};\r\n\t\t\tnewUrlMetaData.push(sourceField);\r\n\t\t});\r\n\r\n\t\tthis.commonService.setUrlMetaData(newUrlMetaData);\r\n\t}\r\n\r\n\tprivate parseAndSetApp(\r\n\t\tpromise: ng.IPromise<IJsonRuntimeMashup>,\r\n\t\tcanvasWidth: number): ng.IPromise<RuntimeApp> {\r\n\t\treturn promise.then((jsonMashup: IJsonRuntimeMashup) => {\r\n\t\t\tconst mashup = RuntimeApp.fromObj(jsonMashup);\r\n\t\t\t//on runtime: language must load before project\r\n\t\t\treturn this.languageService.initializeLanguageSettings().then(() => {\r\n\t\t\t\treturn this.commonService.buildPrerequisites(mashup, canvasWidth) as ng.IPromise<RuntimeApp>;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.service(InjectNames.RUNTIME_SERVICE, RuntimeService);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { ErrorResponse, IErrorResponse } from \"../error-response\";\r\nimport { Helper } from \"../helper\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions,\r\n\tIDialogResult, IMessageDialogOptions, StandardDialogButtons\r\n} from \"./dialog-service\";\r\n\r\nexport enum ConflictResolutionEnum { REPLACE = 1, COPY = 2, SKIP = 3 }\r\n\r\nexport interface IConflictObject {\r\n\tobjectName: string;\r\n\tconflictedString: string;\r\n\toccupiedStrings: string[];\r\n\tremainingCount: number;\r\n\tlastAction: ConflictResolutionEnum;\r\n\tmaxItems: number;\r\n}\r\n\r\nexport interface IConflictResult {\r\n\taction: ConflictResolutionEnum;\r\n\tsameForRemaining: boolean;\r\n\tnewName: string;\r\n}\r\n\r\nexport interface IResolutionResult<T> {\r\n\ttoRemove: T[];\r\n\ttoAdd: T[];\r\n}\r\n\r\ninterface IConflictResolution<T> {\r\n\tobject: T;\r\n\tresolution: ConflictResolutionEnum;\r\n\tnewName: string;\r\n}\r\n\r\ninterface ISplitConflict<T> {\r\n\tconflicting: T[];\r\n\tnotConflicting: T[];\r\n}\r\n\r\nexport class ConflictResolutonService {\r\n\tpublic maxItems: number = 0;\r\n\tprivate conflictKey: string;\r\n\tprivate occupiedStrings: string[];\r\n\tprivate objectName: string;\r\n\tprivate conflictingObjects: any[];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\r\n\t}\r\n\r\n\tpublic resolve<T>(\r\n\t\tnewObjects: T[],\r\n\t\tcurrentObjects: T[],\r\n\t\tconflictKey: string,\r\n\t\tobjectName: string,\r\n\t\tmaxItems: number\r\n\t): ng.IPromise<IResolutionResult<T>> {\r\n\t\tthis.objectName = objectName;\r\n\t\tthis.maxItems = maxItems;\r\n\t\tthis.conflictKey = conflictKey;\r\n\t\tthis.occupiedStrings = currentObjects.map((object) => {\r\n\t\t\treturn Helper.getDeepValue(object, conflictKey);\r\n\t\t});\r\n\r\n\t\tconst splitConflicting = this.splitConflicting(newObjects, currentObjects);\r\n\t\tthis.conflictingObjects = splitConflicting.conflicting;\r\n\t\tthis.occupiedStrings = this.occupiedStrings.concat(splitConflicting.notConflicting.map((notConflicting) => {\r\n\t\t\treturn Helper.getDeepValue(notConflicting, conflictKey);\r\n\t\t}));\r\n\r\n\t\tconst deferredResolutions = this.$q.defer<IResolutionResult<T>>();\r\n\t\tif (this.conflictingObjects.length > 0) {\r\n\t\t\tthis.resolveNextConflict<T>().then((resolutions) => {\r\n\t\t\t\tconst resolutionResult = this.applyResolutions(resolutions, currentObjects);\r\n\t\t\t\tresolutionResult.toAdd = resolutionResult.toAdd.concat(splitConflicting.notConflicting);\r\n\t\t\t\tdeferredResolutions.resolve(resolutionResult);\r\n\t\t\t}).catch((e: IErrorResponse) => {\r\n\t\t\t\tdeferredResolutions.reject(e.message);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tdeferredResolutions.resolve({\r\n\t\t\t\ttoRemove: [],\r\n\t\t\t\ttoAdd: newObjects\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn deferredResolutions.promise;\r\n\t}\r\n\r\n\tpublic checkIfInvalidImportedItems <T>(errorText: string, importedItems?: T[]): ng.IPromise<IMessageDialogOptions> {\r\n\t\tconst deferred = this.$q.defer<IMessageDialogOptions>();\r\n\r\n\t\tif (!importedItems) {\r\n\t\t\tdeferred.resolve();\r\n\t\t\treturn deferred.promise;\r\n\t\t}\r\n\r\n\t\tconst failedItems = importedItems.some((item: T) => {\r\n\t\t\treturn item ? false : true;\r\n\t\t});\r\n\r\n\t\tif (failedItems) {\r\n\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\ttitle: \"Import Project\",\r\n\t\t\t\tmessage: `One or more ${errorText} was not imported due to error in them`,\r\n\t\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\t\tisError: true,\r\n\t\t\t};\r\n\t\t\tdeferred.reject(options);\r\n\t\t\treturn deferred.promise;\r\n\t\t} else {\r\n\t\t\tdeferred.resolve();\r\n\t\t\treturn deferred.promise;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate splitConflicting<T>(newObjects: T[], oldObjects: T[]): ISplitConflict<T> {\r\n\t\tconst conflicting: T[] = [];\r\n\t\tconst notConflicting: T[] = [];\r\n\t\tnewObjects.forEach((newObject) => {\r\n\t\t\tconst hasDisplayNameConflict = oldObjects.some((existingObject) => {\r\n\t\t\t\treturn this.getConflictString(existingObject) === this.getConflictString(newObject);\r\n\t\t\t});\r\n\t\t\thasDisplayNameConflict ? conflicting.push(newObject) : notConflicting.push(newObject);\r\n\t\t});\r\n\t\treturn { conflicting: conflicting, notConflicting: notConflicting };\r\n\t}\r\n\r\n\tprivate getConflictString(object: any): string {\r\n\t\treturn Helper.getDeepValue(object, this.conflictKey);\r\n\t}\r\n\r\n\tprivate resolveConflictDialog(\r\n\t\tconflictedString: string,\r\n\t\tindex: number,\r\n\t\tconflictCount: number,\r\n\t\tlastAction: ConflictResolutionEnum\r\n\t): ng.IPromise<IDialogResult<IConflictResult>> {\r\n\t\tconst options: IDialogOptions<IConflictObject> = {\r\n\t\t\ttitle: \"Name Conflict (\" + (index + 1) + \"/\" + conflictCount + \")\",\r\n\t\t\ttemplate: require(\"../dialogs/import-conflict/conflict-decision-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tobjectName: this.objectName,\r\n\t\t\t\tconflictedString: conflictedString,\r\n\t\t\t\toccupiedStrings: this.occupiedStrings,\r\n\t\t\t\tlastAction: lastAction,\r\n\t\t\t\tremainingCount: conflictCount - (index + 1),\r\n\t\t\t\tmaxItems: this.maxItems\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn this.dialogService.show(options);\r\n\t}\r\n\r\n\tprivate resolveNextConflict<T>(\r\n\t\tlastAction: ConflictResolutionEnum = ConflictResolutionEnum.REPLACE,\r\n\t\tindex: number = 0): ng.IPromise<IConflictResolution<T>[]> {\r\n\t\tconst deferredResolutionChoice = this.$q.defer<IConflictResolution<T>[]>();\r\n\t\tconst currentObject = this.conflictingObjects[index];\r\n\r\n\t\tthis.resolveConflictDialog(\r\n\t\t\tthis.getConflictString(currentObject),\r\n\t\t\tindex,\r\n\t\t\tthis.conflictingObjects.length,\r\n\t\t\tlastAction\r\n\t\t).then((result) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Ok) {\r\n\t\t\t\tconst nextIndex = index + 1;\r\n\t\t\t\tconst dialogValue = result.value;\r\n\t\t\t\tconst resolutions: IConflictResolution<T>[] = [];\r\n\t\t\t\tresolutions.push({ object: currentObject, resolution: dialogValue.action, newName: dialogValue.newName });\r\n\t\t\t\tif (dialogValue.action === ConflictResolutionEnum.COPY) {\r\n\t\t\t\t\tthis.occupiedStrings.push(dialogValue.newName);\r\n\t\t\t\t} else if (dialogValue.action !== ConflictResolutionEnum.SKIP) {\r\n\t\t\t\t\tthis.occupiedStrings.push(this.getConflictString(currentObject));\r\n\t\t\t\t}\r\n\t\t\t\tif (dialogValue.sameForRemaining) {\r\n\t\t\t\t\tfor (let i = nextIndex; i < this.conflictingObjects.length; i++) {\r\n\t\t\t\t\t\tif (dialogValue.action === ConflictResolutionEnum.COPY) {\r\n\t\t\t\t\t\t\tdialogValue.newName = Helper.generateNewDisplayName(\r\n\t\t\t\t\t\t\t\tthis.getConflictString(this.conflictingObjects[i]),\r\n\t\t\t\t\t\t\t\tthis.occupiedStrings\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis.occupiedStrings.push(dialogValue.newName);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresolutions.push({\r\n\t\t\t\t\t\t\tobject: this.conflictingObjects[i],\r\n\t\t\t\t\t\t\tresolution: dialogValue.action,\r\n\t\t\t\t\t\t\tnewName: dialogValue.newName\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdeferredResolutionChoice.resolve(resolutions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (nextIndex < this.conflictingObjects.length) {\r\n\t\t\t\t\t\tthis.resolveNextConflict<T>(dialogValue.action, nextIndex).then((resolvedCompositeComponents) => {\r\n\t\t\t\t\t\t\tdeferredResolutionChoice.resolve(resolutions.concat(resolvedCompositeComponents));\r\n\t\t\t\t\t\t}).catch((e: IErrorResponse) => {\r\n\t\t\t\t\t\t\tdeferredResolutionChoice.reject(e);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdeferredResolutionChoice.resolve(resolutions);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdeferredResolutionChoice.reject(new ErrorResponse(\"User cancel\"));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn deferredResolutionChoice.promise;\r\n\t}\r\n\r\n\tprivate applyResolutions<T>(resolutions: IConflictResolution<T>[], oldObjects: T[]): IResolutionResult<T> {\r\n\t\tconst valuesToRemove: string[] = [];\r\n\t\tconst resolutionResult: IResolutionResult<T> = {\r\n\t\t\ttoRemove: [],\r\n\t\t\ttoAdd: []\r\n\t\t};\r\n\t\tresolutions.forEach((resolution) => {\r\n\t\t\tconst newItem = resolution.object;\r\n\t\t\tswitch (resolution.resolution) {\r\n\t\t\t\tcase ConflictResolutionEnum.REPLACE:\r\n\t\t\t\t\tvaluesToRemove.push(this.getConflictString(newItem));\r\n\t\t\t\t\tresolutionResult.toAdd.push(newItem);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ConflictResolutionEnum.COPY:\r\n\t\t\t\t\tHelper.setDeepValue(newItem, this.conflictKey, resolution.newName);\r\n\t\t\t\t\tresolutionResult.toAdd.push(newItem);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ConflictResolutionEnum.SKIP:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (valuesToRemove.length > 0) {\r\n\t\t\tconst objsToRemove = oldObjects.filter((obj) => {\r\n\t\t\t\treturn valuesToRemove.some((valueToRemove) => {\r\n\t\t\t\t\treturn this.getConflictString(obj) === valueToRemove;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tresolutionResult.toRemove = objsToRemove;\r\n\t\t}\r\n\t\treturn resolutionResult;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.service(InjectNames.CONFLICT_RESOLUTION_SERVICE, ConflictResolutonService);\r\n\t}\r\n}\r\n","import { InforOwnedEnum } from \"ng2/common/enums/infor-owned.enum\";\r\n\r\nexport interface IJsonTag {\r\n\tid: string;\r\n\tname: string;\r\n\tinforOwned?: InforOwnedEnum;\r\n}\r\n","// Module\nvar code = \"<div id=test-dataservice-dialog ng-controller=\\\"eirTestDataserviceCtrl as ctrl\\\"> <div class=field> <p> Test the data service by entering the defined parameters and click \\\"Run Data Service\\\". Be aware that this will run the actual service in the target system. </p> </div> <div class=field> <div class=field-input-fields> <div ng-repeat=\\\"inputField in ctrl.parameters\\\"> <label for=\\\"{{ inputField.id + '-field' }}\\\">{{inputField.key}}</label> <div class=input-field> <input type=text name=\\\"{{ inputField.id + '-field' }}\\\" ng-attr-id=\\\"{{ inputField.id + '-field' }}\\\" ng-model=inputField.value ng-keypress=ctrl.onKeyPress($event)> <div class=input-field-mandatory ng-if=inputField.mandatory> Required </div> </div> </div> <div class=input-field-button> <button type=button class=\\\"btn-primary hide-focus\\\" ng-click=ctrl.runApi() ng-disabled=ctrl.fetching xi-tooltip=\\\"'Run Data Service'\\\" xi-button> Run Data Service </button> </div> </div> </div> <div class=field> <div class=field--flex> <h2>Response Body</h2> <button type=button class=btn-modal ng-if=\\\"ctrl.type === ctrl.testDialogTypes.UNFORMATTED\\\" ng-click=ctrl.copyToClipboard()>Copy to clipboard</button> </div> <hr class=hr-field> </div> <div class=field ng-switch=ctrl.type xi-busy=ctrl.fetching> <textarea id=testDataserviceTextareaField class=resizable name=textareaField readonly=readonly rows=20 xi-textarea=textareaField ng-model=ctrl.responseData ng-switch-when=UNFORMATTED></textarea> <div xi-datagrid=ctrl.datagridOptions ng-switch-when=FORMATTED></div> </div> <div class=modal-buttonset> <button type=button class=btn-modal-primary ng-click=ctrl.close()>Close</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { Config, IdoDataType } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonGenericDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IDocument, IOperationObject, ISchemaObject } from \"ng2/common/model/swagger.model\";\r\nimport { IOperation } from \"../../common/model/ion-metadata.model\";\r\nimport { IResponseDatagridData } from \"./datasource/search/ion-api/ion-api-search-wizard-ctrl\";\r\n\r\n/**\r\n * Contains various utility functions (as static methods).\r\n */\r\nexport class RepositoryHelper {\r\n\r\n\t/**\r\n\t * Get the Swagger operation with the same path and method as the given operation.\r\n\t */\r\n\tpublic static getSwaggerOperation(operation: IOperation, swagger: IDocument): IOperationObject {\r\n\t\tconst pathItemObj = swagger.paths[operation.restPath];\r\n\t\tswitch (operation.method.toLowerCase()) {\r\n\t\t\tcase \"get\":\r\n\t\t\t\treturn pathItemObj.get;\r\n\t\t\tcase \"put\":\r\n\t\t\t\treturn pathItemObj.put;\r\n\t\t\tcase \"post\":\r\n\t\t\t\treturn pathItemObj.post;\r\n\t\t\tcase \"delete\":\r\n\t\t\t\treturn pathItemObj.delete;\r\n\t\t\tcase \"options\":\r\n\t\t\t\treturn pathItemObj.options;\r\n\t\t\tcase \"head\":\r\n\t\t\t\treturn pathItemObj.head;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(`Operation has unknown method '${operation.method}', using default 'get'`);\r\n\t\t\t\treturn pathItemObj.get;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Extract the suite, endpoint and resource of an operation such that it can be combined to a valid path, e.g:\r\n\t *\r\n\t * Given an operation with {\r\n\t * \tsuiteContext: \"mysuite\",\r\n\t *\t\tproxyPath: \"mytenant/mysuite/endpoint/\",\r\n\t\t*\t\trestPath: \"/my_resource\"\r\n\t\t* }\r\n\t\t* this will produce:\r\n\t\t* {\r\n\t\t*\t\tsuite: \"/mysuite\",\r\n\t\t*\t\tendpoint: \"/endpoint/\",\r\n\t\t*\t\tresource: \"my_resource\"\r\n\t\t* }\r\n\t\t* Such that it can be concatenated to an ION API request path:\r\n\t\t* /mysuite/endpoint/my_resource\r\n\t\t*/\r\n\tpublic static deconstructPath(operation: IOperation): {\r\n\t\tsuite: string,\r\n\t\tendpoint: string,\r\n\t\tresource: string,\r\n\t\tversion: string\r\n\t} {\r\n\t\tconst customerApi = \"/CustomerApi\";\r\n\t\t// SuiteContext is always: \"/suite\"\r\n\t\tlet suite = `/${operation.suiteContext}`;\r\n\t\tconst tenant = Config.TENANT_ID || \"\";\r\n\r\n\t\t// ProxyPath is always: \"tenant/suite/some_endpoint_path\" or just \"tenant/suite/\"\r\n\t\t// manually added APIs looks like this \"tenant/CustomerApi/suite\"\r\n\t\tif (operation.proxyPath.indexOf(customerApi) !== -1) {\r\n\t\t\toperation.proxyPath = operation.proxyPath.replace(customerApi, \"\");\r\n\t\t\tsuite = customerApi + suite;\r\n\t\t}\r\n\r\n\t\tconst caseInsensitive = new RegExp(`${tenant}/${operation.suiteContext}`, \"i\");\r\n\t\tlet endpoint = operation.proxyPath.replace(caseInsensitive, \"\");\r\n\r\n\t\tif (!endpoint.endsWith(\"/\")) {\r\n\t\t\tendpoint = `${endpoint}/`;\r\n\t\t}\r\n\t\t// RestPath is a swagger path key, so \"/some/path\"\r\n\t\tconst resource = operation.restPath.replace(/^\\//, \"\");\r\n\r\n\t\t// determine version, currently we only check M3, all else is v1\r\n\t\tlet version = \"v1\";\r\n\t\tif (endpoint.includes(\"/m3api-rest/v2/\")) {\r\n\t\t\tversion = \"v2\";\r\n\t\t}\r\n\r\n\t\treturn { suite, endpoint, resource, version };\r\n\t}\r\n\r\n\t/**\r\n\t * Transform a Swagger schema (e.g response) to something that can be used in a Responses data grid\r\n\t */\r\n\tpublic static mapSchemaToGridData(schema: ISchemaObject, name: string, depth: number = 1): IResponseDatagridData {\r\n\t\tif (!schema) {\r\n\t\t\tconsole.warn(\"mapSchemaToGridData was called with an undefined schema\");\r\n\t\t\tschema = {\r\n\t\t\t\tdescription: \"Schema not available\",\r\n\t\t\t};\r\n\t\t}\r\n\t\tconst data: IResponseDatagridData = {\r\n\t\t\tname,\r\n\t\t\tdescription: schema.description,\r\n\t\t\tdepth,\r\n\t\t\tchildren: [],\r\n\t\t\ttype: schema.type as string,\r\n\t\t\texpanded: false,\r\n\t\t};\r\n\t\tif (schema.type === \"object\" || schema.properties) {\r\n\t\t\tfor (const childName in schema.properties) {\r\n\t\t\t\tconst childSchema = schema.properties[childName];\r\n\t\t\t\tconst child = RepositoryHelper.mapSchemaToGridData(childSchema, childName, depth + 1);\r\n\t\t\t\tdata.children.push(child);\r\n\t\t\t}\r\n\t\t} else if (schema.type === \"array\" || schema.items) {\r\n\t\t\tconst childSchema = schema.items as ISchemaObject;\r\n\t\t\tconst childName = \"items\";\r\n\t\t\tdata.children = [RepositoryHelper.mapSchemaToGridData(childSchema, childName, depth + 1)];\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\t/**\r\n\t * Add query parameter with a specified ID to a datasource.resource.\r\n\t * NOTE: Will modify the resource field of the datasource.\r\n\t *\r\n\t *\tTODO: Move to helper module.\r\n\t\t* @param id id of parameter to add, e.g /api?id={id}\r\n\t\t* @param datasource datasource to modify\r\n\t\t*/\r\n\tpublic static addQueryParameter(id: string, datasource: IJsonGenericDatasource): void {\r\n\t\tif (!id || !id.trim()) {\r\n\t\t\tconsole.warn(\"addQueryParameter called with an empty ID\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tid = id.trim();\r\n\t\tconst hasNoQueryParameters: boolean = datasource.resource.match(/^[\\w\\-\\.\\_\\{\\}]+(\\/[\\w\\-\\.\\_\\{\\}]+)*$/g) !== null;\r\n\t\tif (hasNoQueryParameters) {\r\n\t\t\tdatasource.resource += \"?\";\r\n\t\t}\r\n\t\tconst hasSomeQueryParameters: boolean =\r\n\t\t\tdatasource.resource.match(/\\?.*$/) !== null && !datasource.resource.endsWith(\"?\");\r\n\t\tif (hasSomeQueryParameters) {\r\n\t\t\tdatasource.resource += \"&\";\r\n\t\t}\r\n\t\tdatasource.resource += `${id}={${id}}`;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts a Mongoose DataType to App Builder data type.\r\n\t *\r\n\t * @static\r\n\t * @param dataType DataType to be converted\r\n\t * @return The App Builder data type.\r\n\t */\r\n\tpublic static getAppbuilderDataType(dataType: string): string {\r\n\t\tlet newDataType = dataType;\r\n\t\tswitch (dataType) {\r\n\t\t\tcase \"Byte\":\r\n\t\t\t\tnewDataType = IdoDataType.boolean;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Binary\":\r\n\t\t\t\tnewDataType = IdoDataType.file;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Long Integer\":\r\n\t\t\t\tnewDataType = IdoDataType.integer;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn newDataType;\r\n\t}\r\n\r\n\t/* START--------------- Methods for generating output parameters ------------------\r\n\t\tTODO: Keep this code until further notice. There are valuable information in it.\r\n\t*/\r\n\t// private mapValueType(swaggerType: string): ValueType {\r\n\t// \tswitch (swaggerType) {\r\n\t// \t\tcase \"string\":\r\n\t// \t\t\treturn ValueType.STRING;\r\n\t// \t\tcase \"number\":\r\n\t// \t\t\treturn ValueType.NUMBER;\r\n\t// \t\tcase \"boolean\":\r\n\t// \t\t\treturn ValueType.BOOLEAN;\r\n\t// \t\tcase \"object\":\r\n\t// \t\t\treturn ValueType.OBJECT;\r\n\t// \t\tcase \"array\":\r\n\t// \t\t\treturn ValueType.LIST;\r\n\t// \t\tdefault:\r\n\t// \t\t\tconsole.warn(\"Unknown value type:\" + swaggerType);\r\n\t// \t\t\treturn ValueType.STRING;\r\n\t// \t}\r\n\t// }\r\n\r\n\t// private getValueType(obj: Object, path: string): ValueType {\r\n\t// \tlet value = jsonpath.value(obj, path);\r\n\t// \tlet valueType: string = typeof value;\r\n\t// \tif (valueType === \"object\") {\r\n\t// \t\tvalueType = ((value instanceof Array) ? \"array\" : \"object\");\r\n\t// \t}\r\n\t// \treturn this.mapValueType(valueType);\r\n\t// }\r\n\r\n\t// private getOutput(schema: ISchemaObject, limit: number, params: IParameterObject[]): IParameterObject[] {\r\n\t// \tconst parameters: IParameterObject[] = [];\r\n\t// \tconst sample = RepositoryHelper.generateSample(schema);\r\n\t// \tconst jsonpaths = jsonpath.paths(sample, \"$..*\", 5);\r\n\r\n\t// \tif (params.length < limit) {\r\n\t// \t\treturn this.getOutput(schema, limit, params);\r\n\t// \t} else {\r\n\t// \t\treturn params;\r\n\t// \t}\r\n\t// }\r\n\r\n\t// private getTypeAndDescription(\r\n\t//\t\tschema: ISchemaObject, pathArray: jsonpath.PathComponent[]): { type: ValueType; desc: string; } {\r\n\t// \tlet type: string;\r\n\t// \tlet desc: string;\r\n\t// \tpathArray.shift();\r\n\t// \tlet currentObj = schema;\r\n\t// \tpathArray.forEach((path) => {\r\n\t// \t\ttype = currentObj.type as string;\r\n\t// \t\tswitch (currentObj.type) {\r\n\t// \t\t\tcase \"integer\":\r\n\t// \t\t\tcase \"number\":\r\n\t// \t\t\tcase \"string\":\r\n\t// \t\t\tcase \"boolean\":\r\n\t// \t\t\t\tdesc = currentObj.description;\r\n\t// \t\t\t\tbreak;\r\n\t// \t\t\tcase \"array\":\r\n\t// \t\t\t\t// TODO: implement description and type for list\r\n\t// \t\t\t\tbreak;\r\n\t// \t\t\tcase \"object\":\r\n\t// \t\t\t\tcurrentObj = currentObj.properties[path];\r\n\t// \t\t\t\tbreak;\r\n\t// \t\t\tdefault:\r\n\t// \t\t\t\treturn null;\r\n\t// \t\t}\r\n\t// \t\ttype = currentObj.type as string;\r\n\t// \t\tdesc = currentObj.description;\r\n\t// \t});\r\n\t// \treturn { type: this.mapValueType(type), desc };\r\n\t// }\r\n\r\n\t/* END--------------- Methods for generating output parameters ------------------ */\r\n}\r\n","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IComponent } from \"../../../common/IComponent\";\r\nimport { FrameworkService } from \"../../../components/services/framework-service\";\r\n\r\nexport class BindingManagementService {\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t) { }\r\n\r\n\tpublic unregisterBinding(\r\n\t\ttargetComponent: IComponent,\r\n\t\ttargetKey: string,\r\n\t\tvaluesourceObject: IJsonValueSource\r\n\t): void {\r\n\t\tconst bindingID = this.frameworkService.getBindingId(targetComponent.getId(), targetKey, valuesourceObject);\r\n\t\tconst activeBindings: IMap<Function> = this.frameworkService.getActiveBinding();\r\n\r\n\t\tif (activeBindings[bindingID]) {\r\n\t\t\tactiveBindings[bindingID]();\r\n\t\t\tdelete activeBindings[bindingID];\r\n\t\t}\r\n\t}\r\n\r\n\tpublic unregisterContextBinding(\r\n\t\ttargetComponent: IComponent,\r\n\t\tsourceKey: string,\r\n\t\ttargetKey: string = \"\"\r\n\t): void {\r\n\t\tconst bindingId = this.frameworkService.getContextBindingId(targetComponent.getId(), targetKey, sourceKey);\r\n\t\tconst activeBindings: IMap<Function> = this.frameworkService.getActiveBinding();\r\n\r\n\t\tif (activeBindings[bindingId]) {\r\n\t\t\tactiveBindings[bindingId]();\r\n\t\t\tdelete activeBindings[bindingId];\r\n\t\t}\r\n\t}\r\n\r\n\tpublic registerBinding(\r\n\t\ttargetComponent: IComponent,\r\n\t\ttargetKey: string,\r\n\t\tvaluesourceObject: IJsonValueSource\r\n\t): void {\r\n\t\tthis.frameworkService.registerBinding(targetComponent, targetKey, valuesourceObject, valuesourceObject.value);\r\n\t}\r\n\r\n\tpublic registerContextBinding(\r\n\t\ttargetComponent: IComponent,\r\n\t\ttargetKey: string,\r\n\t\tvaluesourceObject: IJsonValueSource\r\n\t): void {\r\n\t\tthis.frameworkService.registerContextBinding(\r\n\t\t\ttargetComponent,\r\n\t\t\ttargetKey,\r\n\t\t\tvaluesourceObject.sourceKey,\r\n\t\t\tvaluesourceObject.value\r\n\t\t);\r\n\t}\r\n\r\n\tpublic setDefaultBindings(component: IJsonComponent, availableOutput: IMetaDataField[]): void {\r\n\t\tconst newAvailableOutput = $.extend([], availableOutput, true).reverse();\r\n\t\tthis.frameworkService.forEachComponent(component, (innerComponent) => {\r\n\t\t\tif (component === innerComponent || !innerComponent.datasource) {\r\n\t\t\t\tthis.frameworkService.forEachBindable(innerComponent, (bindableField, currentvalueSource) => {\r\n\t\t\t\t\t// Make sure only writeable and nonbooleans is changed\r\n\t\t\t\t\tif (bindableField.write && bindableField.valueType !== ValueTypeEnum.BOOLEAN) {\r\n\t\t\t\t\t\tconst outputParam = newAvailableOutput.pop();\r\n\t\t\t\t\t\tif (outputParam) {\r\n\t\t\t\t\t\t\tcurrentvalueSource.Type = BindingTypeEnum.CONTEXT_BINDING;\r\n\t\t\t\t\t\t\tcurrentvalueSource.sourceKey = outputParam.FLNM;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.BINDING_MANAGEMENT_SERVICE, BindingManagementService);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nimport { InjectNames, Numbers, ProjectLimit, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { STANDARD_ID_PREFIX } from \"ng2/common/constants/standard-boundaries.constant\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\n\r\nimport { DialogService, IToastOptions } from \"common/services/dialog-service\";\r\nimport { EditorHelper } from \"editor/helper\";\r\nimport { EditorService } from \"editor/services/editor-service\";\r\n\r\nexport class BoundaryManagementService {\r\n\tprivate boundaryIdCounter = 0;\r\n\tnewBoundaryAddedEvent = new InstanceEvent<IBoundary>();\r\n\tboundaryMovedEvent = new InstanceEvent<IBoundary>();\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\r\n\t}\r\n\r\n\tgetBoundary(boundaryId: string): IBoundary {\r\n\t\treturn this.getProjectBoundaries().find((boundary) => {\r\n\t\t\treturn boundary.id === boundaryId;\r\n\t\t});\r\n\t}\r\n\r\n\tgetProjectBoundaries(): IBoundary[] {\r\n\t\treturn this.editorService.getCurrentProject().getBoundaries();\r\n\t}\r\n\r\n\tgenerateBoundaryId(): string {\r\n\t\tconst newId = \"boundary\" + this.boundaryIdCounter++;\r\n\t\tconst boundaries = this.getProjectBoundaries();\r\n\t\tfor (const key in boundaries) {\r\n\t\t\tif (boundaries[key].id === newId) {\r\n\t\t\t\treturn this.generateBoundaryId();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newId;\r\n\t}\r\n\r\n\tgoToCurrentBoundaryMarker(boundary: IBoundary): void {\r\n\t\tthis.newBoundaryAddedEvent.raise(boundary);\r\n\t}\r\n\r\n\tprivate alreadyExistsHere(position: number): boolean {\r\n\t\tconst boundaries = this.getProjectBoundaries();\r\n\t\treturn boundaries.some((boundary) => {\r\n\t\t\treturn boundary.limitX === position;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate showError(title: string, message: string): void {\r\n\t\tthis.dialogService.showError(title, message);\r\n\t}\r\n\r\n\taddNewBoundaryMarker(offsetX: number, displayName?: string, description?: string): void {\r\n\t\tconst boundaries = this.getProjectBoundaries();\r\n\t\toffsetX = Math.floor(offsetX); //IE needs this\r\n\t\tif (boundaries.length >= ProjectLimit.MAX_BOUNDARIES) {\r\n\t\t\tthis.showError(\"Error\", \"Maximum number of boundaries reached, try to delete one first.\");\r\n\t\t} else if (this.alreadyExistsHere(offsetX)) {\r\n\t\t\tthis.showError(\"Error\", \"A Boundary already has this value, try to add one at a different place.\");\r\n\t\t} else { //Can add a boundary\r\n\t\t\tconst newBoundaryId = this.generateBoundaryId();\r\n\t\t\tconst boundary: IBoundary = ({\r\n\t\t\t\tid: newBoundaryId,\r\n\t\t\t\tdisplayName: displayName ? displayName : \"\",\r\n\t\t\t\tdescription: description ? description : \"\",\r\n\t\t\t\tlimitX: offsetX,\r\n\t\t\t});\r\n\r\n\t\t\tthis.addProjectBoundary(boundary);\r\n\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\tthis.editorService.setCurrentBoundary(boundary);\r\n\t\t\t\tthis.newBoundaryAddedEvent.raise(boundary);\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.MANIFEST).then(() => {\r\n\t\t\t\t\tconst options: IToastOptions = {\r\n\t\t\t\t\t\ttitle: \"New Boundary\",\r\n\t\t\t\t\t\tmessage: \"The boundary at position \" + boundary.limitX + \" successfully added\",\r\n\t\t\t\t\t\tposition: \"top right\",\r\n\t\t\t\t\t\tprogressBar: true\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.dialogService.showToast(options);\r\n\t\t\t\t});\r\n\t\t\t}, Numbers.TEN);\r\n\t\t}\r\n\t}\r\n\r\n\tisBoundaryReadOnly(boundary: IBoundary): boolean {\r\n\t\treturn boundary.id.substring(0, STANDARD_ID_PREFIX.length) === STANDARD_ID_PREFIX;\r\n\t}\r\n\r\n\tprivate removeBoundarySettingsFromComponents(boundaryId: string): void {\r\n\t\tconst allComponents: IEditorComponent[] = this.editorService.getAllComponents();\r\n\t\tallComponents.forEach((component: IEditorComponent) => {\r\n\t\t\tcomponent.getDatabearer().boundarySettings[boundaryId] = null;\r\n\t\t});\r\n\t}\r\n\r\n\tremoveProjectBoundary(boundary: IBoundary): void {\r\n\t\tthis.removeBoundarySettingsFromComponents(boundary.id);\r\n\t\tthis.removeBoundaryMarker(boundary.id);\r\n\t\tthis.editorService.projectBoundariesChangedEvent.raise(this.getProjectBoundaries());\r\n\t}\r\n\r\n\tprivate removeBoundaryMarker(boundaryId: string): void {\r\n\t\tconst allBoundaries = this.getProjectBoundaries();\r\n\t\tconst index: number = EditorHelper.findIndex(allBoundaries, boundaryId);\r\n\t\tif (index !== -1) {\r\n\t\t\tallBoundaries.splice(index, 1);\r\n\t\t}\r\n\t}\r\n\r\n\taddProjectBoundary(boundary: IBoundary): void {\r\n\t\tthis.getProjectBoundaries().push(boundary);\r\n\t\tthis.editorService.projectBoundariesChangedEvent.raise(this.getProjectBoundaries());\r\n\t}\r\n\r\n\tupdateBoundaryMarker(boundary: IBoundary): void {\r\n\t\tconst allBoundaries = this.getProjectBoundaries();\r\n\t\tfor (let i = 0; i < allBoundaries.length; i++) {\r\n\t\t\tif (allBoundaries[i].id === boundary.id) {\r\n\t\t\t\tallBoundaries[i] = boundary;\r\n\t\t\t\tthis.editorService.projectBoundariesChangedEvent.raise(this.getProjectBoundaries());\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.BOUNDARY_MANAGEMENT_SERVICE, BoundaryManagementService);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport html2canvas from \"html2canvas\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { InjectNames, SaveFlagsEnum, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { ErrorResponse, IErrorResponse } from \"../../../common/error-response\";\r\nimport { Helper } from \"../../../common/helper\";\r\nimport { InstanceEvent } from \"../../../common/instance-event\";\r\nimport { FeatureSwitchCtrl } from \"../../../common/shared-components/base/feature-switch-ctrl\";\r\n\r\nimport { FeatureSwitchService } from \"../../../common/services/feature-switch-service\";\r\nimport { HttpService } from \"../../../common/services/http-service\";\r\n\r\n/* tslint:disable:no-bitwise */\r\nexport class SaveService extends FeatureSwitchCtrl {\r\n\r\n\tpublic saveStates = {\r\n\t\tinProgress: \"Saving...\",\r\n\t\tsaved: \"Last saved at \",\r\n\t\tfailed: \"Failed to save\"\r\n\t};\r\n\tpublic saveStateEvent = new InstanceEvent<string | IErrorResponse>();\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t) {\r\n\t\tsuper(featureService);\r\n\t}\r\n\r\n\tprivate raiseSaveStateEvent(value: string | IErrorResponse): void {\r\n\t\tthis.saveStateEvent.raise(value);\r\n\t}\r\n\r\n\tpublic save(project: DesignerMashup, flags: number): ng.IPromise<void> {\r\n\t\tconst manifest = project.manifest;\r\n\t\tconst deferred = this.$q.defer<void>();\r\n\t\tconst promises: ng.IPromise<IJsonManifest>[] = [];\r\n\t\tthis.raiseSaveStateEvent(this.saveStates.inProgress);\r\n\r\n\t\tif ((flags & SaveFlagsEnum.MANIFEST) !== 0) {\r\n\t\t\tpromises.push(this.saveManifest(manifest));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.CANVAS_COMPONENTS) !== 0) {\r\n\t\t\tpromises.push(this.saveRootComponent(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.INTERACTIONS) !== 0) {\r\n\t\t\tpromises.push(this.saveInteractions(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.DATASOURCES) !== 0) {\r\n\t\t\tpromises.push(this.saveDatasources(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.SCREENSHOT) !== 0) {\r\n\t\t\tpromises.push(this.saveScreenshot(manifest));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.CUSTOMCOMPONENTS) !== 0) {\r\n\t\t\tpromises.push(this.saveCustomComponentDefinitions(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.COMPOSITE_COMPONENTS) !== 0) {\r\n\t\t\tpromises.push(this.saveCompositeComponents(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.TRANSLATIONS) !== 0 && this.isFeatureTranslationEnabled()) {\r\n\t\t\tpromises.push(this.saveTranslations(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.TAGS) !== 0) {\r\n\t\t\tpromises.push(this.saveTags(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.URL_VARIABLES) !== 0) {\r\n\t\t\tpromises.push(this.saveUrlVariables(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.EXPRESSIONS) !== 0) {\r\n\t\t\tpromises.push(this.saveExpressions(project));\r\n\t\t}\r\n\t\tif ((flags & SaveFlagsEnum.QUESTIONS) !== 0) {\r\n\t\t\tpromises.push(this.saveQuestions(project));\r\n\t\t}\r\n\r\n\t\tthis.$q.all(promises).then((responses) => {\r\n\t\t\tthis.raiseSaveStateEvent(this.saveStates.saved);\r\n\t\t\tconst newManifest = responses[0];\r\n\t\t\tconst manifest = project.getManifest();\r\n\t\t\tmanifest.updateLastChangedInformation(newManifest);\r\n\t\t\tdeferred.resolve();\r\n\t\t}).catch((errorResponse: ErrorResponse) => {\r\n\t\t\tlet saveState: ErrorResponse | string = errorResponse;\r\n\t\t\tif (!errorResponse) {\r\n\t\t\t\tsaveState = \"Failed to save.\";\r\n\t\t\t}\r\n\t\t\tthis.raiseSaveStateEvent(saveState);\r\n\t\t\tdeferred.reject(errorResponse);\r\n\t\t});\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tpublic renameProject(id: string, newDisplayName: string): ng.IPromise<IJsonManifest> {\r\n\t\treturn this.httpService.executePost<IJsonManifest>(ServerPaths.PROJECT + \"rename/\" + id, newDisplayName);\r\n\t}\r\n\r\n\tprivate saveManifest(manifest: DesignerManifest): ng.IPromise<IJsonManifest> {\r\n\t\treturn this.httpService.executePut<IJsonManifest>(ServerPaths.PROJECT + \"manifest\", manifest);\r\n\t}\r\n\r\n\tprivate saveScreenshot(manifest: DesignerManifest): ng.IPromise<IJsonManifest> {\r\n\t\tconst deferred = this.$q.defer<IJsonManifest>();\r\n\t\tconst half = 0.5;\r\n\t\tlet width = 1600; // default canvas width on 1920x1080\r\n\t\tconst height = 822; // default canvas height on 1920x1080\r\n\t\tconst canvasArea = $(\"#insideRuler\");\r\n\t\tconst style = canvasArea.prop(\"style\");\r\n\t\tlet inlineWidth = \"\";\r\n\r\n\t\t// check if inline style for width exist (active boundary)\r\n\t\tconst widthProp = \"width\";\r\n\t\tif (style && style[widthProp] !== \"\") {\r\n\t\t\tconst attributeLength = 2;\r\n\t\t\tinlineWidth = style[widthProp].slice(0, -attributeLength);\r\n\t\t\twidth = parseInt(inlineWidth);\r\n\t\t}\r\n\r\n\t\t// set canvas width and height for html2canvas to properly capture the whole area\r\n\t\tcanvasArea.width(width);\r\n\t\tcanvasArea.height(height);\r\n\r\n\t\tconst options: Html2Canvas.Html2CanvasOptions = {\r\n\t\t\t//Safe enough to use cross-origin in html2canvas for images?\r\n\t\t\tuseCORS: true,\r\n\t\t\tallowTaint: true\r\n\t\t};\r\n\r\n\t\t// Available options here: http://html2canvas.hertzen.com/documentation.html\r\n\t\thtml2canvas($(\"#insideRuler\")[0], options).then((canvas: HTMLCanvasElement) => {\r\n\t\t\tmanifest.previewImg = canvas.toDataURL(\"image/jpeg\", half);\r\n\t\t\tthis.httpService.executePut(ServerPaths.PROJECT + \"manifest\", manifest).then(() => {\r\n\t\t\t\tdeferred.resolve(manifest);\r\n\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\tdeferred.reject(errorResponse);\r\n\t\t\t});\r\n\t\t});\r\n\t\t// reset canvas width and height\r\n\t\tcanvasArea.width(inlineWidth);\r\n\t\tcanvasArea.height(\"\");\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate saveRootComponent(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst rootComponent = project.rootComponent;\r\n\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/rootComponent\";\r\n\t\treturn this.httpService.executePut(url, rootComponent);\r\n\t}\r\n\r\n\tprivate saveInteractions(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst jsonInteractions: IJsonInteraction[] = project.getInteractionDatabearers();\r\n\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/interactions\";\r\n\t\treturn this.httpService.executePut<IJsonManifest>(url, jsonInteractions);\r\n\t}\r\n\r\n\tprivate saveTranslations(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst jsonTranslations: IJsonLanguageComponent[] = project.getTranslationsList();\r\n\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/translations\";\r\n\t\treturn this.httpService.executePut<IJsonManifest>(url, jsonTranslations);\r\n\t}\r\n\r\n\tprivate saveTags(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst tags = Helper.getListNames(project.getTags());\r\n\t\tconst url = \"tags/\" + ServerPaths.PROJECT + project.getId() + \"?tagName=\" + tags;\r\n\t\treturn this.httpService.executePost<IJsonManifest>(url);\r\n\t}\r\n\r\n\tprivate saveCustomComponentDefinitions(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst deferred = this.$q.defer<IJsonManifest>();\r\n\t\tconst customComponentDefinitions = project.customComponentDefinitions;\r\n\r\n\t\tif (customComponentDefinitions) {\r\n\t\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/customComponentDefinitions\";\r\n\t\t\tthis.httpService.executePut(url, customComponentDefinitions).then(() => {\r\n\t\t\t\tdeferred.resolve();\r\n\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\tdeferred.reject(errorResponse);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t// No customComponentDefinitions in project\r\n\t\t\tdeferred.resolve();\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate saveDatasources(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst jsonDatasources: IJsonDatasource[] = project.getDatasourceDatabearers();\r\n\t\tjsonDatasources.forEach((jsonDatasource) => {\r\n\t\t\tHelper.cleanNulls(jsonDatasource);\r\n\t\t});\r\n\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/datasources\";\r\n\t\treturn this.httpService.executePut<IJsonManifest>(\r\n\t\t\turl,\r\n\t\t\tJSON.parse(angular.toJson(jsonDatasources)));\r\n\t}\r\n\r\n\tprivate saveCompositeComponents(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst deferred = this.$q.defer<IJsonManifest | null>();\r\n\t\tconst compositeComponentDefinitions = project.compositeComponents;\r\n\r\n\t\tif (compositeComponentDefinitions) {\r\n\t\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/compositeComponents\";\r\n\t\t\tthis.httpService.executePut<IJsonManifest>(url, compositeComponentDefinitions).then((response) => {\r\n\t\t\t\tdeferred.resolve(response);\r\n\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\tdeferred.reject(errorResponse);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t// No compositeComponents in project\r\n\t\t\tdeferred.resolve();\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate saveUrlVariables(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst urlVariables = project.manifest.urlVariables;\r\n\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/urlvariables\";\r\n\t\treturn this.httpService.executePut<IJsonManifest>(url, urlVariables);\r\n\t}\r\n\r\n\tprivate saveExpressions(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst expressions = project.expressions;\r\n\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/expressions\";\r\n\t\treturn this.httpService.executePut<IJsonManifest>(url, expressions);\r\n\t}\r\n\r\n\tprivate saveQuestions(project: DesignerMashup): ng.IPromise<IJsonManifest> {\r\n\t\tconst questions = project.questions;\r\n\t\tconst url = ServerPaths.PROJECT + project.getId() + \"/questions\";\r\n\t\treturn this.httpService.executePut<IJsonManifest>(url, questions);\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.SAVE_SERVICE, SaveService);\r\n\t}\r\n}\r\n","import { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport { Flexbox } from \"../../../../components/flexbox/flexbox\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\nimport { FlexboxContentSettingsDirective } from \"./flexbox-content-settings\";\r\n\r\nexport class FlexboxSettings {\r\n\r\n\tprivate static instance: FlexboxSettings = new FlexboxSettings();\r\n\r\n\tconstructor() {\r\n\t\tif (FlexboxSettings.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use FlexboxSettings.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static getInstance(): FlexboxSettings {\r\n\t\treturn FlexboxSettings.instance;\r\n\t}\r\n\r\n\tpublic contentSettingsDirective: ng.IDirective = new FlexboxContentSettingsDirective();\r\n\r\n\tpublic create(id: string): IJsonFlexbox {\r\n\t\tconst newFlexbox = ComponentSettingsCtrl.create(id, Flexbox) as IJsonFlexbox;\r\n\t\tnewFlexbox.children = [];\r\n\t\treturn newFlexbox;\r\n\t}\r\n\r\n\t/**\r\n\t * For creating a flexbox without any padding or margin values\r\n\t *\r\n\t * @param {string} id\r\n\t * @returns {IJsonFlexbox}\r\n\t *\r\n\t * @memberof FlexboxSettings\r\n\t */\r\n\tpublic createWithoutPadding(id: string, orientation: number = OrientationEnum.VERTICAL): IJsonFlexbox {\r\n\t\tconst defaultFlexbox = this.create(id);\r\n\t\tconst modifiedFlexbox: IJsonFlexbox = defaultFlexbox;\r\n\t\tconst boundarySettingsToChangeFromFlexbox = {\r\n\t\t\tmargin: { bottom: 0, left: 0, right: 0, top: 0 }\r\n\t\t};\r\n\r\n\t\tmodifiedFlexbox.boundarySettings.Default = {\r\n\t\t\t...defaultFlexbox.boundarySettings.Default,\r\n\t\t\t...boundarySettingsToChangeFromFlexbox,\r\n\t\t\torientation\r\n\t\t};\r\n\t\treturn modifiedFlexbox;\r\n\t}\r\n}\r\n","import type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IJsonInteractionParameter } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport type { IAvailableTargetField } from \"ng2/common/model/interaction/available-target-field.model\";\r\nimport type { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\n\r\nexport class InteractionParameter implements IInteractionParameter {\r\n\r\n\tprivate databearer: IJsonInteractionParameter;\r\n\r\n\ttargetField: IAvailableTargetField;\r\n\r\n\tconstructor(obj: IJsonInteractionParameter) {\r\n\t\tthis.databearer = obj;\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonInteractionParameter {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tget targetKey(): string {\r\n\t\treturn this.databearer.targetKey;\r\n\t}\r\n\tset targetKey(targetKey: string) {\r\n\t\tthis.databearer.targetKey = targetKey;\r\n\t}\r\n\r\n\tget valueSource(): IJsonValueSource {\r\n\t\treturn this.databearer.valueSource;\r\n\t}\r\n\tset valueSource(valueSource: IJsonValueSource) {\r\n\t\tthis.databearer.valueSource = valueSource;\r\n\t}\r\n\r\n}\r\n","import { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\n\r\nexport interface IInteraction {\r\n\tgetId: () => string;\r\n\tsourceName: string;\r\n\tsourceTriggerName: string;\r\n\ttargetName: string;\r\n\ttargetActionName: string;\r\n\tgetDatabearer: () => IJsonInteraction;\r\n\tgetParameters: () => IInteractionParameter[];\r\n\tgetParameter: (targetKey: string) => IInteractionParameter;\r\n}\r\n\r\nexport interface IInteractionResponse {\r\n\r\n}","import { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nexport interface IAvailableTargetField {\r\n\tvisibleName: string;\r\n\ttargetKey: string;\r\n\tisMandatory?: boolean;\r\n\tMeta?: IJsonBindableField;\r\n}\r\n","export enum QuestionDefinitionsEnum {\r\n\tSEEKS_BINDING,\r\n\tCOMPONENT_SETTINGS\r\n}\r\n","import angular from \"angular\";\r\nimport cloneDeep from \"lodash-es/cloneDeep\";\r\nimport isNumber from \"lodash-es/isNumber\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { Helper } from \"../../common/helper\";\r\nimport type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { ISohoDropdown } from \"../../common/model/sohoxi/sohoxi-dropdown.model\";\r\nimport { Component } from \"../component\";\r\nimport { ComponentsHelper } from \"../helper\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tInteractionActionEnum, InteractionPairOperation,\r\n\tInteractionTriggerEnum, SettingInputKeys,\r\n\tSettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonDropdown, IStaticValueDropdown } from \"ng2/common/model/databearer/components/json-dropdown.model\";\r\nimport type { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\nimport type{ IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport interface ICurrentItem extends IMap<any> { }\r\n\r\nexport class Dropdown extends Component {\r\n\tstatic AVAILABLE_WIDTHS: IDataPair[] = [\r\n\t\t{ name: \"Small\", value: \"input-sm\" },\r\n\t\t{ name: \"Medium\", value: \"input-mm\" },\r\n\t\t{ name: \"Large\", value: \"input-default\" }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.LIST,\r\n\t\tInteractionPairOperation.SET_CURRENT_ITEM,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic SETTING_FIELDS =\r\n\t\t([\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Options\",\r\n\t\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Keep Selection\",\r\n\t\t\t\t\ttooltip: \"Keep previous selected item on reload. (With ION APIs, an object ID is preferred if using this)\",\r\n\t\t\t\t\tref: SettingKeys.KEEP_SELECTED,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Disabled\",\r\n\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Width\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.BOX_WIDTH,\r\n\t\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\t\tdataset: Dropdown.AVAILABLE_WIDTHS,\r\n\t\t\t\t\tdefaultValue: \"input-default\",\r\n\t\t\t\t}]\r\n\t\t\t}\r\n\t\t] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Selected Item\",\r\n\t\tref: SettingKeys.CURRENT_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Display Value\",\r\n\t\tref: SettingKeys.DISPLAY_VALUE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}\r\n\t];\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tcurrentItem: ICurrentItem;\r\n\tdisplayValue: IJsonValueSource;\r\n\tcurrentItemIndex: number;\r\n\temptyValue: IStaticValueDropdown[];\r\n\tboxWidth: string;\r\n\tprotected databearer: IJsonDropdown;\r\n\tprivate keepSelected: boolean;\r\n\tprivate previousLength: number;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonDropdown,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tif (obj) {\r\n\t\t\tthis.keepSelected = obj.keepSelected;\r\n\t\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\t}\r\n\t\tthis.currentItemIndex = 0;\r\n\t\t//Static default value\r\n\t\tthis.emptyValue = [{\r\n\t\t\tvalue: 0,\r\n\t\t\tlabel: \"\"\r\n\t\t}];\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\tthis.setBoundarySettingIfChanged<string>(SettingKeys.BOX_WIDTH);\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.currentItemIndex = 0;\r\n\t\tthis.currentItem = null;\r\n\t\tthis.setSelection();\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param currentItem\r\n\t * Update current Item and trigger on item changed event.\r\n\t * This also triggers when the dropdown is bound to a list of data and a new selection is made.\r\n\t * This will not trigger on same data due to angular ng-change.\r\n\t */\r\n\tsetCurrentItem(currentItem: ICurrentItem): void {\r\n\t\tthis.updateCurrentItem(currentItem);\r\n\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\t}\r\n\r\n\tprivate updateCurrentItem(newCurrentItem: ICurrentItem): void {\r\n\t\tthis.currentItem = newCurrentItem;\r\n\t\tangular.extend(this.getContext(), newCurrentItem);\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tif (listResult.length > 0) {\r\n\t\t\tthis.currentItemIndex = listResult.findIndex((item) => {\r\n\t\t\t\treturn item === newCurrentItem;\r\n\t\t\t});\r\n\t\t\tthis.previousLength = angular.copy(listResult.length);\r\n\t\t}\r\n\t\tthis.setPseudoElemDisplayText();\r\n\t}\r\n\r\n\tprivate onListUpdated(): void {\r\n\t\tconst firstItem = this.getContext().ListResult[0];\r\n\t\tif (firstItem) {\r\n\t\t\tthis.setCurrentItem(firstItem);\r\n\t\t} else {\r\n\t\t\tthis.setPseudoElemDisplayText(\"\");\r\n\t\t}\r\n\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\tif (bindableReference === SettingKeys.DISPLAY_VALUE &&\r\n\t\t\tthis.currentItem && this.databearer.displayValue.sourceKey\r\n\t\t) {\r\n\t\t\tthis.setPseudoElemDisplayText();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setPseudoElemDisplayText(\r\n\t\ttext: string = this.currentItem[this.databearer.displayValue.sourceKey]\r\n\t): void {\r\n\t\tconst dropdown = this.getSoHoDropdown();\r\n\t\tif (dropdown) {\r\n\t\t\tdropdown.pseudoElem.find(\"span\").text(text);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getSoHoDropdown(): ISohoDropdown {\r\n\t\treturn this.element.find(\"#\" + this.getId() + \"select\").data(\"dropdown\") as ISohoDropdown;\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tlet interactionPromise: ng.IPromise<any | any[]>;\r\n\t\tswitch (interaction.targetActionName) {\r\n\t\t\tcase InteractionActionEnum.LIST:\r\n\t\t\t\tinteractionPromise = super.loadInteraction(interaction);\r\n\t\t\t\tinteractionPromise.then((listResult) => {\r\n\t\t\t\t\tthis.getContext().ListResult = cloneDeep(listResult);\r\n\t\t\t\t\tthis.trigger(InteractionTriggerEnum.ON_LOAD);\r\n\t\t\t\t\tthis.setSelection();\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase InteractionActionEnum.SET_CURRENT_ITEM:\r\n\t\t\t\tinteractionPromise = this.executeSetSelectedItemAction(interaction.getParameters());\r\n\t\t\t\tinteractionPromise.then((newValue) => {\r\n\t\t\t\t\tif (newValue) {\r\n\t\t\t\t\t\tthis.setCurrentItem(newValue);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.onListUpdated();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tinteractionPromise = super.loadInteraction(interaction);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tprivate setSelection(): void {\r\n\t\tif (!this.currentItem || !this.keepSelected) {\r\n\t\t\tthis.onListUpdated();\r\n\t\t} else {\r\n\t\t\tthis.moveIndex();\r\n\t\t}\r\n\t}\r\n\r\n\t// needed to maintain right index when adding or deleting items in the dropdown\r\n\tprivate moveIndex(): void {\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tconst index = ComponentsHelper.findItemIndexById(listResult, this.currentItem.id);\r\n\t\tif (isUndefined(index)) {\r\n\t\t\tthis.setErrorTooltip(\"Selection failed, Item ID is not unique.\");\r\n\t\t} else {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t}\r\n\r\n\t\tif (isNumber(index) && index !== -1) {\r\n\t\t\tthis.currentItemIndex = index;\r\n\t\t\tthis.currentItem = listResult[this.currentItemIndex];\r\n\t\t} else if (index) { //if item id does not exists, try to find correct index\r\n\t\t\tif (this.previousLength < listResult.length) {\r\n\t\t\t\t//Item added.\r\n\t\t\t\tthis.currentItemIndex = ComponentsHelper.incrementIndex(\r\n\t\t\t\t\tthis.currentItemIndex,\r\n\t\t\t\t\tthis.getContext(),\r\n\t\t\t\t\tthis.currentItem,\r\n\t\t\t\t\tthis.getDatasource()\r\n\t\t\t\t);\r\n\t\t\t\tthis.currentItem = listResult[this.currentItemIndex];\r\n\t\t\t} else if (this.previousLength > listResult.length) {\r\n\t\t\t\t//item deleted.\r\n\t\t\t\tthis.onListUpdated();\r\n\t\t\t} else {\r\n\t\t\t\t//Toggle selected\r\n\t\t\t\tthis.currentItem = listResult[this.currentItemIndex];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.onListUpdated();\r\n\t\t}\r\n\t\tthis.setPseudoElemDisplayText();\r\n\t}\r\n\r\n\tprivate executeSetSelectedItemAction(parameters: IInteractionParameter[]): ng.IPromise<any> {\r\n\t\tthis.setErrorTooltip();\r\n\t\tconst interactionDeferred = this.frameworkService.getNewDeferred<any | any[]>();\r\n\t\tconst context = this.getContext();\r\n\t\tif (context.ListResult) {\r\n\t\t\tlet possibleItems = context.ListResult;\r\n\t\t\tparameters.forEach((parameter) => {\r\n\t\t\t\tconst valueToFind = this.frameworkService.readValueSource(parameter.valueSource, context);\r\n\t\t\t\tpossibleItems = possibleItems.filter((listItem) => {\r\n\t\t\t\t\tconst actualValue = listItem[parameter.targetKey];\r\n\t\t\t\t\treturn Helper.trimIfPossible(actualValue) === Helper.trimIfPossible(valueToFind); // Trim to fix MI problem\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tif (possibleItems.length === 1) {\r\n\t\t\t\tinteractionDeferred.resolve(possibleItems[0]);\r\n\t\t\t\tthis.removeEmptyValue();\r\n\t\t\t} else if (possibleItems.length > 1) {\r\n\t\t\t\tthis.setErrorTooltip(\"Unable to select: Multiple items match\");\r\n\t\t\t\tthis.setEmptyValue();\r\n\t\t\t} else {\r\n\t\t\t\tthis.setErrorTooltip(\"Unable to select: No items match\");\r\n\t\t\t\tthis.setEmptyValue();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.setErrorTooltip(\"Unable to select: No items to select\");\r\n\t\t}\r\n\t\tinteractionDeferred.resolve();\r\n\t\treturn interactionDeferred.promise;\r\n\t}\r\n\r\n\tprivate setEmptyValue(): void {\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tif (listResult[0] !== this.emptyValue) {\r\n\t\t\tlistResult.unshift(this.emptyValue);\r\n\t\t}\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\tprivate removeEmptyValue(): void {\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tif (listResult[0] === this.emptyValue) {\r\n\t\t\tlistResult.shift();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./dropdown.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { Helper } from \"../../common/helper\";\r\nimport type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { IJsonHyperlink, ISourceItem } from \"../../common/model/component/hyperlink.model\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tBindingTypes, DirectionType, InteractionPairOperation, InteractionTriggerEnum,\r\n\tSettingInputKeys, SettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport class Hyperlink extends Component {\r\n\tstatic availableDirectionTypes: IDataPair[] = [\r\n\t\t{ name: \"None\", value: DirectionType.NONE },\r\n\t\t{ name: \"Back\", value: DirectionType.BACK },\r\n\t\t{ name: \"Forward\", value: DirectionType.DIRECTIONAL }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] =\r\n\t\tInteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CLICK]);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_CLICK;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Link Name\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t},\r\n\t{\r\n\t\tname: \"Link Value\",\r\n\t\tref: \"renderedLink\",\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t([{\r\n\t\t\ttitle: \"Style\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Disabled\",\r\n\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t}\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Caret\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.DIRECTION,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Hyperlink.availableDirectionTypes,\r\n\t\t\t\tdefaultValue: DirectionType.NONE\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Link Value\",\r\n\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\tsettings:\r\n\t\t\t[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Address\",\r\n\t\t\t\t\tref: SettingKeys.LINK_VALUE,\r\n\t\t\t\t\tinputType: SettingInputKeys.TEXT,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-compose\",\r\n\t\t\t\t\t\ttooltip: \"Build link\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdefaultValue: \"https://\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Use as Drillback\",\r\n\t\t\t\t\tref: SettingKeys.IS_DRILLBACK,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tcontent: string;\r\n\trenderedLink: string;\r\n\tdirection: string;\r\n\tsources: ISourceItem[] = [];\r\n\tlink: string;\r\n\tisDrillback: boolean;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonHyperlink,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, element, parent, frameworkService);\r\n\r\n\t\tthis.direction = obj.direction;\r\n\t\tthis.link = obj.link;\r\n\t\tthis.isDrillback = obj.isDrillback;\r\n\t\tif (obj.sources) {\r\n\t\t\tthis.sources = obj.sources;\r\n\t\t}\r\n\t}\r\n\r\n\tsetBindableValue(bindableRef: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableRef, value);\r\n\t\tif (this.sources) {\r\n\t\t\tconst mySource = this.sources.find((source) => {\r\n\t\t\t\treturn source.alias === bindableRef;\r\n\t\t\t});\r\n\t\t\tif (mySource) {\r\n\t\t\t\tthis.renderURL();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tif (this.sources) {\r\n\t\t\tthis.sources.forEach((source) => {\r\n\t\t\t\tconst valueSourceObject: IJsonValueSource = {\r\n\t\t\t\t\tType: BindingTypeEnum.BINDING,\r\n\t\t\t\t\tsourceKey: source.value,\r\n\t\t\t\t\tsourceName: source.type\r\n\t\t\t\t};\r\n\t\t\t\tthis.frameworkService.registerBinding(this, source.alias, valueSourceObject, null);\r\n\t\t\t});\r\n\t\t\tthis.renderURL();\r\n\t\t}\r\n\t}\r\n\r\n\tonLinkClick(): void {\r\n\t\tif (this.isDrillback) {\r\n\t\t\tthis.frameworkService.sendDrillbackMessage(this.renderedLink);\r\n\t\t} else {\r\n\t\t\tthis.frameworkService.openWindow(this.renderedLink);\r\n\t\t}\r\n\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\t}\r\n\r\n\trenderURL(): void {\r\n\t\tthis.renderedLink = this.buildLink(this.link, this.sources);\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./hyperlink.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import { Helper } from \"../../common/helper\";\r\nimport type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { IJsonImage } from \"../../common/model/component/image.model\";\r\nimport { Component } from \"../component\";\r\nimport { ComponentsHelper } from \"../helper\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tImageBase64, ImagePositions,\r\n\tInteractionPairOperation, InteractionTriggerEnum, SettingInputKeys, SettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nexport class Image extends Component {\r\n\tstatic availablePositionTypes: IDataPair[] = [\r\n\t\t{ name: \"Fill\", value: ImagePositions.FILL },\r\n\t\t{ name: \"Fit\", value: ImagePositions.FIT },\r\n\t\t{ name: \"Center\", value: ImagePositions.CENTER }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CLICK]);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([\r\n\t\t{\r\n\t\t\ttitle: \"Position\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.POSITION,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Image.availablePositionTypes,\r\n\t\t\t\tdefaultValue: ImagePositions.CENTER\r\n\t\t\t}]\r\n\t\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Source\",\r\n\t\tref: SettingKeys.SOURCE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tposition: string;\r\n\tsource: any;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonImage,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tif (obj) {\r\n\t\t\tthis.position = obj.position;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setImageSource(newValue: Blob | string): void {\r\n\t\tif (newValue instanceof Blob) {\r\n\t\t\tthis.source = (window.URL || window.webkitURL).createObjectURL(newValue);\r\n\t\t} else if (typeof newValue === \"string\" && this.getContext().DetailResult) {\r\n\t\t\t// e.g. \tnewValue http://{replaceValue}/\r\n\t\t\t// \t\tDetailResult: {replaceValue: Value}\r\n\t\t\tthis.source = Helper.stringReplace(newValue, this.getContext().DetailResult);\r\n\t\t} else if (typeof newValue === \"string\" && newValue.length > 0) {\r\n\t\t\tif (newValue.indexOf(\"http\") === 0) {\r\n\t\t\t\tthis.setImageFromUrlToSource(newValue);\r\n\t\t\t} else if (ComponentsHelper.isBase64(newValue)) {\r\n\t\t\t\tthis.source = Helper.parseBase64(newValue);\r\n\t\t\t} else {\r\n\t\t\t\tthis.source = newValue;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.source = ImageBase64.DEFAULT;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setImageFromUrlToSource(url: string): void {\r\n\t\tconst result: string = this.cache.get(url);\r\n\r\n\t\tif (Helper.isUndefined(result)) {\r\n\t\t\tthis.frameworkService.convertImageUrlToBase64(url)\r\n\t\t\t\t.then(base64result => this.source = base64result)\r\n\t\t\t\t.then(() => this.cache.put(url, this.source))\r\n\t\t\t\t.then(() => this.setErrorTooltip())\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tthis.setErrorTooltip(error.message);\r\n\t\t\t\t\tthis.source = ImageBase64.DEFAULT;\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.source = result;\r\n\t\t}\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tinteractionPromise.catch(() => {\r\n\t\t\tthis.source = ImageBase64.DEFAULT;\r\n\t\t});\r\n\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, newValue: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, newValue);\r\n\t\tif (bindableReference === SettingKeys.SOURCE) {\r\n\t\t\tthis.setImageSource(newValue);\r\n\t\t}\r\n\t}\r\n\r\n\tclick(): void {\r\n\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./image.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\n\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport { colors } from \"ng2/common/constants/colors.constant\";\r\nimport {\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonLabel } from \"ng2/common/model/databearer/components/json-label.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport class Label extends Component {\r\n\tstatic availableStyles = [\r\n\t\t{ name: \"Default\", value: \"default\" },\r\n\t\t{ name: \"Paragraph\", value: \"paragraph\" },\r\n\t\t{ name: \"Small Heading\", value: \"small-heading\" },\r\n\t\t{ name: \"Medium Heading\", value: \"medium-heading\" },\r\n\t\t{ name: \"Large Heading\", value: \"large-heading\" },\r\n\t\t{ name: \"Size 10 - Uppercase\", value: \"font-size-px-10\" },\r\n\t\t{ name: \"Size 12 - Uppercase\", value: \"font-size-px-12\" },\r\n\t\t{ name: \"Size 14\", value: \"font-size-px-14\" },\r\n\t\t{ name: \"Size 16\", value: \"font-size-px-16\" },\r\n\t\t{ name: \"Size 20\", value: \"font-size-px-20\" },\r\n\t\t{ name: \"Size 24\", value: \"font-size-px-24\" },\r\n\t\t{ name: \"Size 28\", value: \"font-size-px-28\" },\r\n\t\t{ name: \"Size 32\", value: \"font-size-px-32\" },\r\n\t\t{ name: \"Size 40\", value: \"font-size-px-40\" },\r\n\t\t{ name: \"Size 48\", value: \"font-size-px-48\" },\r\n\t\t{ name: \"Size 60\", value: \"font-size-px-60\" },\r\n\t\t{ name: \"Size 72\", value: \"font-size-px-72\" },\r\n\t];\r\n\r\n\tstatic availableCharacteristics = [\r\n\t\t{ name: \"Default\", value: \"\" },\r\n\t\t{ name: \"Descriptive\", value: \"text-descriptive\" },\r\n\t\t{ name: \"Link\", value: \"text-link\" },\r\n\t\t{ name: \"Muted\", value: \"text-muted\" },\r\n\t\t{ name: \"Alert\", value: \"text-alert\"},\r\n\t\t{ name: \"Emphasis\", value: \"text-emphasis\" },\r\n\t\t{ name: \"Strong\", value: \"text-strong\"}\r\n\t];\r\n\r\n\tstatic availableColors = [\r\n\t\t{ name: \"Default\", value: \"default\" },\r\n\t\t{ name: \"Light White\", value: \"rgba(255,255,255,0.5)\" },\r\n\t\t{ name: \"Medium White\", value: \"rgba(255,255,255,0.75)\" },\r\n\t\t{ name: \"Strong White\", value: \"#fff\" },\r\n\t\t{ name: \"Light Gray\", value: \"rgba(26,26,26,0.5)\" },\r\n\t\t{ name: \"Medium Gray\", value: \"rgba(26,26,26,0.75)\" },\r\n\t\t{ name: \"Strong Gray\", value: colors.graphite10 }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([\r\n\t\t{\r\n\t\t\ttitle: \"Typography\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.FONT_STYLE,\r\n\t\t\t\ttitle: \"Font Style\",\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\tdataset: Label.availableStyles,\r\n\t\t\t\tdefaultValue: Label.availableStyles[0].value,\r\n\t\t\t}, {\r\n\t\t\t\tref: SettingKeys.FONT_CHAR,\r\n\t\t\t\ttitle: \"Font Characteristic\",\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\tdataset: Label.availableCharacteristics,\r\n\t\t\t\tdefaultValue: Label.availableCharacteristics[0].value,\r\n\t\t\t\ttooltip: \"Note that you can only change the text color if the text has the following characteristics: Default, Strong or Emphasis.\"\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Color\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.COLOR,\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\tdataset: Label.availableColors,\r\n\t\t\t\tdefaultValue: Label.availableColors[0].value,\r\n\t\t\t}]\r\n\t\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] =\r\n\t[{\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Tooltip\",\r\n\t\tref: SettingKeys.TOOLTIP,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tcontent: string;\r\n\ttoolTip: string;\r\n\tfontStyle: string;\r\n\tfontChar: string;\r\n\tcolor: string;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonLabel,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tif (obj) {\r\n\t\t\tthis.fontStyle = obj.fontStyle;\r\n\t\t\tthis.fontChar = obj.fontChar ? obj.fontChar : \"\";\r\n\t\t\tthis.color = obj.color;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./label.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","export const colors = {\r\n\t// --------------------------------------------------------\r\n\t// Variables\r\n\t// --------------------------------------------------------\r\n\t// 1. Colors\r\n\tcomponentNameBackgroundColor: \"#1d5f8a\",\r\n\t// --------------------------------------------------------\r\n\t// 1. Colors\r\n\t// From SohoXi Color Scheme\r\n\r\n\tazure01: \"#c8e9f4\",\r\n\tazure02: \"#addbeb\",\r\n\tazure03: \"#8dc9e6\",\r\n\tazure04: \"#69b5dd\",\r\n\tazure05: \"#54a1d3\",\r\n\tazure06: \"#368ac0\",\r\n\tazure07: \"#2578a9\",\r\n\tazure08: \"#1d5f8a\",\r\n\tazure09: \"#134d71\",\r\n\tazure10: \"#133c59\",\r\n\r\n\tamber01: \"#fbe9bf\",\r\n\tamber02: \"#f8e09c\",\r\n\tamber03: \"#f7d475\",\r\n\tamber04: \"#f4c951\",\r\n\tamber05: \"#f2bc41\",\r\n\tamber06: \"#efa836\",\r\n\tamber07: \"#ee9a36\",\r\n\tamber08: \"#e4882b\",\r\n\tamber09: \"#db7726\",\r\n\tamber10: \"#d66221\",\r\n\r\n\tamethyst01: \"#ede3fc\",\r\n\tamethyst02: \"#daccec\",\r\n\tamethyst03: \"#c7b4db\",\r\n\tamethyst04: \"#b59eca\",\r\n\tamethyst05: \"#a38db7\",\r\n\tamethyst06: \"#9279a6\",\r\n\tamethyst07: \"#806594\",\r\n\tamethyst08: \"#6e5282\",\r\n\tamethyst09: \"#5d3e70\",\r\n\tamethyst10: \"#4b2a5e\",\r\n\r\n\tturquoise01: \"#c0ede3\",\r\n\tturquoise02: \"#a9e1d6\",\r\n\tturquoise03: \"#8ed1c6\",\r\n\tturquoise04: \"#7cc0b5\",\r\n\tturquoise05: \"#69ada3\",\r\n\tturquoise06: \"#579e95\",\r\n\tturquoise07: \"#448d83\",\r\n\tturquoise08: \"#317c73\",\r\n\tturquoise09: \"#206b62\",\r\n\tturquoise10: \"#0e5b52\",\r\n\r\n\truby01: \"#f4bcbc\",\r\n\truby02: \"#eb9d9d\",\r\n\truby03: \"#de8181\",\r\n\truby04: \"#d26d6d\",\r\n\truby05: \"#c65f5f\",\r\n\truby06: \"#b94e4a\",\r\n\truby07: \"#ad4242\",\r\n\truby08: \"#a13030\",\r\n\truby09: \"#941e1e\",\r\n\truby10: \"#880e0e\",\r\n\r\n\temerald01: \"#d5f6c0\",\r\n\temerald02: \"#c3e8ac\",\r\n\temerald03: \"#afdc91\",\r\n\temerald04: \"#9cce7c\",\r\n\temerald05: \"#89bf65\",\r\n\temerald06: \"#76b051\",\r\n\temerald07: \"#66a140\",\r\n\temerald08: \"#56932e\",\r\n\temerald09: \"#488421\",\r\n\temerald10: \"#397514\",\r\n\r\n\tgraphite01: \"#f0f0f0\",\r\n\tgraphite02: \"#d8d8d8\",\r\n\tgraphite03: \"#bdbdbd\",\r\n\tgraphite04: \"#999999\",\r\n\tgraphite05: \"#737373\",\r\n\tgraphite06: \"#5c5c5c\",\r\n\tgraphite07: \"#454545\",\r\n\tgraphite08: \"#383838\",\r\n\tgraphite09: \"#292929\",\r\n\tgraphite10: \"#1a1a1a\",\r\n\r\n\tslate01: \"#dee1e8\",\r\n\tslate02: \"#c8cbd4\",\r\n\tslate03: \"#abaeb7\",\r\n\tslate04: \"#888b94\",\r\n\tslate05: \"#656871\",\r\n\tslate06: \"#50535a\",\r\n\tslate07: \"#414247\",\r\n\tslate08: \"#313236\",\r\n\tslate09: \"#212224\",\r\n\tslate10: \"#1c1819\",\r\n};\r\n","import angular from \"angular\";\r\n\r\nimport {\r\n\tInteractionPairOperation, MaskProcess, SettingInputKeys,\r\n\tSettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJSonMaskSettings, IJsonTextBox } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\n\r\nimport { IMaskOptions } from \"../../common/model/sohoxi/sohoxi-mask.model\";\r\nimport { Component } from \"../component\";\r\n\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class TextBox extends Component {\r\n\tpublic static AVAILABLE_WIDTHS: IDataPair[] = [\r\n\t\t{ name: \"Tiny\", value: \"input-xs\" },\r\n\t\t{ name: \"Small\", value: \"input-sm\" },\r\n\t\t{ name: \"Medium\", value: \"input-mm\" },\r\n\t\t{ name: \"Large\", value: \"input-default\" }\r\n\t];\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tpublic static SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t(<IComponentSettingCategory[]>[{\r\n\t\t\ttitle: \"Style\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t}\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Width\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tref: SettingKeys.BOX_WIDTH,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: TextBox.AVAILABLE_WIDTHS,\r\n\t\t\t\tdefaultValue: \"input-default\",\r\n\t\t\t}]\r\n\t\t}]).concat(Component.SETTING_FIELDS);\r\n\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Text\",\r\n\t\tref: SettingKeys.TEXT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Placeholder\",\r\n\t\tref: SettingKeys.PLACEHOLDER,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}\r\n\t];\r\n\r\n\tpublic text: string;\r\n\tpublic label: string;\r\n\tpublic showLabel: boolean;\r\n\tpublic placeholder: string;\r\n\tpublic boxWidth: string;\r\n\tpublic editType: string;\r\n\tpublic lengthWarning: boolean;\r\n\tpublic maxLength = 2000;\r\n\tprotected databearer: IJsonTextBox;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTextBox,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\tthis.databearer.mask = BackwardCompatible.tryGetMask(obj);\r\n\t\tthis.lengthWarning = false;\r\n\r\n\t\tangular.element(() => {\r\n\t\t\tthis.updateMaskOptions();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setBindableValue(bindableReference: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\tif (this.getMask().process !== MaskProcess.NONE) {\r\n\t\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\t\tthis.updateMaskOptions();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic updateMaskOptions(maskOptions?: IJSonMaskSettings): void {\r\n\t\tthis.editType = \"text\";\r\n\t\tif (maskOptions) {\r\n\t\t\tthis.databearer.mask = maskOptions;\r\n\t\t}\r\n\t\tconst mask = this.databearer.mask;\r\n\t\tconst element = this.element.find(\"#\" + this.getId());\r\n\t\tif (mask && element) { //old textboxes < 2020.05 do not have mask\r\n\t\t\tconst maskApi = element.data(\"mask\");\r\n\t\t\tif (maskApi) {\r\n\t\t\t\tmaskApi.destroy(); //remove all the previous mask settings\r\n\t\t\t\telement.removeClass(\"is-number-mask\"); //Remove this class so typing is on the left side\r\n\t\t\t}\r\n\r\n\t\t\tlet maskOptions: IMaskOptions;\r\n\t\t\tswitch (mask.process) {\r\n\t\t\t\tcase MaskProcess.NUMBER:\r\n\t\t\t\t\tmaskOptions = {\r\n\t\t\t\t\t\tprocess: mask.process,\r\n\t\t\t\t\t\tpatternOptions: {\r\n\t\t\t\t\t\t\tallowDecimal: mask.decimalLimit > 0 ? true : false,\r\n\t\t\t\t\t\t\tallowNegative: mask.allowNegative,\r\n\t\t\t\t\t\t\tdecimalLimit: mask.decimalLimit,\r\n\t\t\t\t\t\t\tintegerLimit: mask.integerLimit,\r\n\t\t\t\t\t\t\tallowThousandsSeparator: mask.allowThousandsSeparator,\r\n\t\t\t\t\t\t\tprefix: mask.prefix\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MaskProcess.DATE_TIME:\r\n\t\t\t\t\tmaskOptions = {\r\n\t\t\t\t\t\tprocess: mask.process,\r\n\t\t\t\t\t\tpatternOptions: {\r\n\t\t\t\t\t\t\tformat: mask.format\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MaskProcess.STRING:\r\n\t\t\t\t\tmaskOptions = {\r\n\t\t\t\t\t\tpattern: mask.format\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MaskProcess.PASSWORD:\r\n\t\t\t\t\tthis.editType = mask.process;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MaskProcess.NONE:\r\n\t\t\t\t\t// This is a fix for masking acc-tests.\r\n\t\t\t\t\t// For some reason < input > does not get a value in its type when masking option is set to 'none'\r\n\t\t\t\t\telement.attr(\"type\", \"text\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// Mask not supported\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (maskOptions) {\r\n\t\t\t\telement.mask(maskOptions);\r\n\t\t\t} else {\r\n\t\t\t\telement.mask();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic newBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\r\n\t\tlet newBoxWidth = this.getBoundarySetting<string>(SettingKeys.BOX_WIDTH);\r\n\t\tnewBoxWidth = BackwardCompatible.tryGetBoxWidth(newBoxWidth);\r\n\t\tif (this.boxWidth !== newBoxWidth) {\r\n\t\t\tthis.boxWidth = newBoxWidth;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clear(): void {\r\n\t\tthis.text = \"\";\r\n\t}\r\n\r\n\tpublic getMask(): IJSonMaskSettings {\r\n\t\treturn this.databearer.mask;\r\n\t}\r\n\r\n\tpublic onUpdateValue(): void {\r\n\t\tsuper.onUpdateValue();\r\n\t\tthis.lengthWarning = this.text.length === this.maxLength;\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./textbox.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// FIXME: Find out what InjectNames.BUILD_ENV_CONSTANT and how it is used\r\n// MUPS-2682: remove hash-service?\r\n\r\nimport {\r\n\tAppEnvType,\r\n\tAppEnvTypes,\r\n\tBuildEnvType,\r\n\tBuildEnvTypes,\r\n\tConfig,\r\n\tInjectNames,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport interface IHashResponse {\r\n\tdata?: any;\r\n}\r\n\r\nexport enum HashSources {\r\n\tDESIGNER_HASH_SRC = \"cache-bust-map-designer.json\",\r\n\tRUNTIME_HASH_SRC = \"cache-bust-map-runtime.json\",\r\n}\r\n\r\nexport enum HashSourceTypes {\r\n\tDESIGNER = \"designer\",\r\n\tRUNTIME = \"runtime\",\r\n}\r\n\r\nexport type HashSourceType = HashSourceTypes.DESIGNER | HashSourceTypes.RUNTIME;\r\n\r\nexport class HashService {\r\n\tprivate designerMapOfHashes: IMap<string>;\r\n\tprivate runtimeMapOfHashes: IMap<string>;\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\t// InjectNames.BUILD_ENV_CONSTANT,\r\n\t\t// InjectNames.APP_ENV_CONSTANT,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate buildEnv: BuildEnvType,\r\n\t\tprivate appEnv: AppEnvType\r\n\t) {\r\n\t\t// TODO: MUPS-2682: Fix this\r\n\t\tthis.buildEnv = BuildEnvTypes.DEV;\r\n\t\tthis.appEnv = AppEnvTypes.DESIGNER;\r\n\r\n\t\tif (this.appEnv === AppEnvTypes.DESIGNER) {\r\n\t\t\tthis.getHashDataSrc(HashSourceTypes.DESIGNER).then((response: IHashResponse) => {\r\n\t\t\t\tthis.designerMapOfHashes = response.data;\r\n\t\t\t});\r\n\t\t} else if (this.appEnv === AppEnvTypes.RUNTIME) {\r\n\t\t\tthis.getHashDataSrc(HashSourceTypes.RUNTIME).then((response: IHashResponse) => {\r\n\t\t\t\tthis.runtimeMapOfHashes = response.data;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// switch (this.appEnv) {\r\n\t\t// \tcase AppEnvTypes.DESIGNER:\r\n\t\t// \t\tthis.getHashDataSrc(HashSourceTypes.DESIGNER).then((response: IHashResponse) => {\r\n\t\t// \t\t\tthis.designerMapOfHashes = response.data;\r\n\t\t// \t\t});\r\n\t\t// \t\tbreak;\r\n\t\t// \tcase AppEnvTypes.RUNTIME:\r\n\t\t// \t\tthis.getHashDataSrc(HashSourceTypes.RUNTIME).then((response: IHashResponse) => {\r\n\t\t// \t\t\tthis.runtimeMapOfHashes = response.data;\r\n\t\t// \t\t});\r\n\t\t// \t\tbreak;\r\n\t\t// \tdefault:\r\n\t\t// \t\tbreak;\r\n\t\t// }\r\n\t}\r\n\r\n\t/**\r\n\t * Use to get any hash for a file. Mainly used in production\r\n\t * The srcString needs to be in the format of:\r\n\t *\r\n\t * /WSWebClient/dynamic/metadata/appbuilder/ || WSWebClient/dynamic/metadata/appbuilder/\r\n\t * OR\r\n\t * /WSWebClient/dynamic/metadata/appruntime/ || WSWebClient/dynamic/metadata/appruntime/\r\n\t *\r\n\t *\tExample:\r\n\t\t* \t/WSWebClient/dynamic/metadata/appbuilder/assets/xi/light-theme.css\r\n\t\t* \twill return\r\n\t\t* \t/WSWebClient/dynamic/metadata/appbuilder/assets/xi/light-theme.myHash123adfs.css\r\n\t\t*\r\n\t\t* @param {string} srcString\r\n\t\t* @param {HashSourceType} hashSrc\r\n\t\t* @returns {ng.IPromise<string>}\r\n\t\t* @memberof HashService\r\n\t\t*/\r\n\tgetHashFromMapOfHashes(srcString: string, hashSrc: HashSourceType): ng.IPromise<string> {\r\n\t\tconst formattedSrcString = srcString.replace(/^\\//, \"\"); // rm the \"/\" for proper checkup in json structure\r\n\t\tconst getHash = () => {\r\n\t\t\tswitch (hashSrc) {\r\n\t\t\t\tcase HashSourceTypes.DESIGNER:\r\n\t\t\t\t\treturn this.getHashFromHashDataDesigner(formattedSrcString);\r\n\t\t\t\tcase HashSourceTypes.RUNTIME:\r\n\t\t\t\t\treturn this.getHashFromHashDataRuntime(formattedSrcString);\r\n\t\t\t\tdefault: // Did not find any source that has that hash. Just give back the formatted value\r\n\t\t\t\t\treturn this.q.resolve(formattedSrcString);\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn getHash()\r\n\t\t\t// Re-add the \"/\" that we removed at the beginning\r\n\t\t\t.then((newSrcString) => \"/\" + newSrcString)\r\n\t\t\t// If there are any errors, just send back the original srcString\r\n\t\t\t.catch((err: any) => srcString);\r\n\t}\r\n\r\n\t/**\r\n\t * Use to get all hash for every hashed asset.\r\n\t */\r\n\tgetHashMap(): IMap<string> {\r\n\t\tswitch (this.appEnv) {\r\n\t\t\tcase AppEnvTypes.DESIGNER:\r\n\t\t\t\treturn this.designerMapOfHashes;\r\n\t\t\tcase AppEnvTypes.RUNTIME:\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.runtimeMapOfHashes;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getHashFromHashDataDesigner(srcString: string): ng.IPromise<string> {\r\n\t\tif (this.designerMapOfHashes) {\r\n\t\t\treturn this.q.resolve(\r\n\t\t\t\tthis.getValueFromMapAndParseToMongooseAssetsPath(this.designerMapOfHashes, srcString) || srcString);\r\n\t\t} else {\r\n\t\t\treturn this.getHashDataSrc(HashSourceTypes.DESIGNER).then((response: IHashResponse) => {\r\n\t\t\t\tthis.designerMapOfHashes = response.data;\r\n\t\t\t\treturn this.getValueFromMapAndParseToMongooseAssetsPath(this.designerMapOfHashes, srcString) || srcString;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getValueFromMapAndParseToMongooseAssetsPath(mapWithHashes: IMap<string>, key: string): string {\r\n\t\tlet result = \"\";\r\n\t\tfor (const value in mapWithHashes) {\r\n\t\t\tif (key.indexOf(value) > 0) {\r\n\t\t\t\tresult = key.replace(value, mapWithHashes[value]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate getHashFromHashDataRuntime(srcString: string): ng.IPromise<string> {\r\n\t\tif (this.runtimeMapOfHashes) {\r\n\t\t\treturn this.q.resolve(\r\n\t\t\t\tthis.getValueFromMapAndParseToMongooseAssetsPath(this.runtimeMapOfHashes, srcString) || srcString);\r\n\t\t} else {\r\n\t\t\treturn this.getHashDataSrc(HashSourceTypes.RUNTIME).then((response: IHashResponse) => {\r\n\t\t\t\tthis.runtimeMapOfHashes = response.data;\r\n\t\t\t\treturn this.getValueFromMapAndParseToMongooseAssetsPath(this.runtimeMapOfHashes, srcString) || srcString;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getHashDataSrc(hashSrc: HashSourceType): ng.IPromise<IHashResponse> {\r\n\t\tif (this.buildEnv === BuildEnvTypes.DEV) {\r\n\t\t\treturn this.q.resolve({\r\n\t\t\t\tdata: {}\r\n\t\t\t});\r\n\t\t}\r\n\t\tlet src = \"\";\r\n\t\tswitch (hashSrc) {\r\n\t\t\tcase HashSourceTypes.DESIGNER:\r\n\t\t\t\tsrc = Config.APP_ROOT + HashSources.DESIGNER_HASH_SRC;\r\n\t\t\t\tbreak;\r\n\t\t\tcase HashSourceTypes.RUNTIME:\r\n\t\t\t\tsrc = Config.APP_ROOT + HashSources.RUNTIME_HASH_SRC;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this.httpService.executeRequest<IHashResponse>({ method: \"GET\", url: src });\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.HASH_SERVICE, HashService);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { Config, InjectNames, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { HashService, HashSourceTypes } from \"common/services/hash-service\";\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport class ThemeService {\r\n\tprivate mainTheme = ThemeEnum.LIGHT;\r\n\tprivate canvasTheme: ThemeEnum;\r\n\r\n\tprivate changeStylesheetPromises: IMap<ng.IPromise<void>> = {};\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.HASH_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate hashService: HashService\r\n\t) {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Change the href value of the <link> element.\r\n\t *\r\n\t * @param newTheme The theme to be set\r\n\t * @param updateCanvasCss Update the css of the canvas or the designer, always true for runtime\r\n\t */\r\n\tchangeThemeCss(newTheme: ThemeEnum, updateCanvasCss: boolean): ng.IPromise<void> {\r\n\r\n\t\tconst deferred = this.$q.defer<void>();\r\n\r\n\t\t// Make sure that the canvas stylesheet exist, otherwise update main theme\r\n\t\t// #sohoxi-stylesheet-canvas is 0 on runtime\r\n\t\tupdateCanvasCss = updateCanvasCss && angular.element(\"#sohoxi-stylesheet-canvas\").length > 0;\r\n\t\tif (updateCanvasCss) {\r\n\t\t\tif (this.canvasTheme === newTheme) {\r\n\t\t\t\tdeferred.reject();\r\n\r\n\t\t\t\treturn deferred.promise;\r\n\t\t\t}\r\n\t\t\tthis.canvasTheme = newTheme;\r\n\t\t} else {\r\n\t\t\tif (this.mainTheme === newTheme) {\r\n\t\t\t\tdeferred.reject();\r\n\r\n\t\t\t\treturn deferred.promise;\r\n\t\t\t}\r\n\t\t\tthis.mainTheme = newTheme;\r\n\t\t}\r\n\r\n\t\tconst isDesigner = APP_BUILDER;\r\n\t\tconst appRoot = isDesigner ? Config.APP_ROOT : Config.APP_RUNTIME_ROOT;\r\n\t\tlet cssUrl = appRoot + \"assets/xi/\";\r\n\r\n\t\tlet linkId = \"sohoxi-stylesheet\";\r\n\t\tif (updateCanvasCss) {\r\n\t\t\tcssUrl += \"canvas-\";\r\n\t\t\tlinkId += \"-canvas\";\r\n\t\t}\r\n\t\tcssUrl += this.getCssTheme(newTheme, updateCanvasCss);\r\n\t\tconst srcHashData = angular.element(\"#sohoxi-stylesheet-canvas\").length > 0\r\n\t\t\t? HashSourceTypes.DESIGNER\r\n\t\t\t: HashSourceTypes.RUNTIME;\r\n\t\tthis.hashService.getHashFromMapOfHashes(cssUrl, srcHashData).then((hashedString: string) => {\r\n\t\t\t// Solution for transparent themes\r\n\t\t\tconst bodyElement = $(\"body\");\r\n\t\t\tconst transparentClass = \"transparent\";\r\n\t\t\tif (newTheme === ThemeEnum.LIGHT_TRANSPARENT || newTheme === ThemeEnum.DARK_TRANSPARENT) {\r\n\t\t\t\tbodyElement.addClass(transparentClass);\r\n\t\t\t} else {\r\n\t\t\t\tbodyElement.removeClass(transparentClass);\r\n\t\t\t}\r\n\r\n\t\t\tconst linkElement = angular.element(\"#\" + linkId);\r\n\t\t\tthis.changeStylesheet(linkElement, hashedString).then(() => {\r\n\t\t\t\tdeferred.resolve();\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tdeferred.reject();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate getCssTheme(newTheme: ThemeEnum, updateCanvasCss: Boolean): String {\r\n\t\tswitch (newTheme) {\r\n\t\t\tcase ThemeEnum.DEFAULT:\r\n\t\t\tcase ThemeEnum.LIGHT:\r\n\t\t\tcase ThemeEnum.LIGHT_TRANSPARENT:\r\n\t\t\t\treturn \"light-theme.css\";\r\n\t\t\tcase ThemeEnum.DARK:\r\n\t\t\tcase ThemeEnum.DARK_TRANSPARENT:\r\n\t\t\t\treturn \"dark-theme.css\";\r\n\t\t\tcase ThemeEnum.HIGH_CONTRAST:\r\n\t\t\t\treturn \"high-contrast-theme.css\";\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[MashupService] Invalid theme: \" + newTheme);\r\n\t\t\t\treturn \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tprivate changeStylesheet(linkElement: ng.IAugmentedJQuery, url: string): ng.IPromise<void> {\r\n\t\tif (!this.changeStylesheetPromises[url]) {\r\n\t\t\tconst deferred: ng.IDeferred<void> = this.$q.defer<void>();\r\n\r\n\t\t\t// We make a request to avoid FOUC\r\n\t\t\tthis.httpService.executeRequest({ method: HttpVerbEnum.GET, url: url }).then(() => {\r\n\t\t\t\tdeferred.resolve();\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tdeferred.reject();\r\n\t\t\t});\r\n\r\n\t\t\t// Cache\r\n\t\t\tthis.changeStylesheetPromises[url] = deferred.promise;\r\n\t\t}\r\n\t\treturn this.changeStylesheetPromises[url].then(() => {\r\n\t\t\tlinkElement.attr(\"href\", url);\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.THEME_SERVICE, ThemeService);\r\n\t}\r\n}\r\n","import { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IComponent } from \"../../IComponent\";\r\n\r\nexport abstract class Datasource implements IDatasource {\r\n\r\n\tpublic usedBy: IComponent[] = [];\r\n\r\n\tprotected databearer: IJsonDatasource;\r\n\r\n\tconstructor(obj: IJsonDatasource) {\r\n\t\tthis.databearer = obj;\r\n\t}\r\n\r\n\tpublic getDatabearer(): IJsonDatasource {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tget id(): string {\r\n\t\treturn this.databearer.id;\r\n\t}\r\n\tset id(id: string) {\r\n\t\tthis.databearer.id = id;\r\n\t}\r\n\r\n\tget typedef(): DatasourceTypeEnum {\r\n\t\treturn this.databearer.typedef;\r\n\t}\r\n\tset typedef(typedef: DatasourceTypeEnum) {\r\n\t\tthis.databearer.typedef = typedef;\r\n\t}\r\n\r\n\tget displayName(): string {\r\n\t\treturn this.databearer.displayName;\r\n\t}\r\n\tset displayName(displayName: string) {\r\n\t\tthis.databearer.displayName = displayName;\r\n\t}\r\n\r\n\tpublic abstract getDetailData(params: IMap<any>): Promise<any>;\r\n\r\n\tpublic abstract getListData(params: IMap<any>): Promise<any>;\r\n\r\n\tpublic abstract getMetaData(): Promise<IMetaData>;\r\n\r\n\tpublic abstract getNonParsedData(params: IMap<any>): Promise<any[]>;\r\n\r\n\t/**\r\n\t * fill in extra parameters for multi parameter calls\r\n\t */\r\n\tpublic fillInParameters(\r\n\t\textraParameters: IMap<any>,\r\n\t\tinputParameters: IParameterObject[],\r\n\t\tparameters: IMap<any>[]\r\n\t): void {\r\n\t\tif (Object.keys(extraParameters).length > 0) {\r\n\t\t\tinputParameters.forEach((ionApiParameter) => {\r\n\t\t\t\tparameters.forEach((parameter) => {\r\n\t\t\t\t\tif (extraParameters[ionApiParameter.id]) {\r\n\t\t\t\t\t\tparameter[ionApiParameter.id] = extraParameters[ionApiParameter.id];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import {\r\n\tIJsonComponent,\r\n\tIJsonComponentSettings,\r\n} from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonRadioButtons extends IJsonComponent {\r\n\tlabel: IJsonValueSource;\r\n\tshowLabel: IJsonValueSource; // Deprecated\r\n\tcomponentRadioButtons: IRadioButton[];\r\n\tboundarySettings: IMap<IJsonRadioButtonSettings>;\r\n}\r\n\r\nexport interface IJsonRadioButtonSettings extends IJsonComponentSettings {\r\n\tshowLabel: boolean;\r\n}\r\n\r\nexport interface IRadioButton {\r\n\tid: string;\r\n\tname: string;\r\n\tfield?: string;\r\n\tvalue?: string; //TODO move value MUPS-3016\r\n}\r\n","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\n\r\nimport { InstanceEvent } from \"common/instance-event\";\r\nimport { IProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport class TagService {\r\n\r\n\tprojectInfoChangedEvent = new InstanceEvent<IProjectInfo[]>();\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.HTTP_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprotected httpService: HttpService,\r\n\t) {\r\n\t}\r\n\r\n\t//TODO: extend this class for custom tags as well\r\n\r\n\tgetAvailableTags(): ng.IPromise<IJsonTag[]> {\r\n\t\treturn this.httpService.executeGet(\"tags/\");\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.TAG_SERVICE, TagService);\r\n\t}\r\n}\r\n","import type {\r\n\tIJsonDesignerManifest,\r\n\tIJsonRuntimeManifest,\r\n} from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\n\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { RuntimeManifest } from \"ng2/common/project/manifest/runtime-manifest\";\r\n\r\nexport interface IProjectInfo {\r\n\tmanifest: IJsonRuntimeManifest | IJsonDesignerManifest;\r\n\ttags?: IJsonTag[];\r\n}\r\nexport class ProjectInfo {\r\n\r\n\tmanifest: IJsonDesignerManifest | IJsonRuntimeManifest;\r\n\ttags: IJsonTag[] = [];\r\n\r\n\tconstructor(projectInfo: IProjectInfo) {\r\n\t\tif (projectInfo.manifest instanceof DesignerManifest) {\r\n\t\t\tthis.manifest = new DesignerManifest(projectInfo.manifest);\r\n\t\t} else {\r\n\t\t\tthis.manifest = new RuntimeManifest(projectInfo.manifest as IJsonRuntimeManifest);\r\n\t\t}\r\n\r\n\t\tthis.tags = projectInfo.tags;\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { Config, InjectNames, ProjectLimit } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { IJsonDatasource, IJsonGenericDatasource, IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IDataGridColumn, IDataGridOptions, IDataGridRow } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { ITestDataserviceParameters, TestDataserviceDialogType } from \"../../../common/dialogs/test-dataservice/test-dataservice-dialog\";\r\nimport { IErrorResponse } from \"../../../common/error-response\";\r\nimport { Helper } from \"../../../common/helper\";\r\nimport { ConflictResolutonService } from \"../../../common/services/conflict-resolution-service\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult,\r\n\tIMessageDialogOptions, StandardDialogButtons\r\n} from \"../../../common/services/dialog-service\";\r\nimport { CustomFormatters } from \"../../../common/sohoxi/custom-formatters\";\r\nimport { RepositoryService } from \"../repository-service\";\r\nimport { RepositoryTab } from \"../repository-tab-ctrl\";\r\nimport { IDatasourceWizardParameter } from \"./create-wizard/datasource-wizard-ctrl\";\r\n\r\nexport interface IUpsertDialogParameter {\r\n\tdatasources: IJsonDatasource[];\r\n\tdatasource: IJsonGenericDatasource;\r\n\tisEdit: boolean;\r\n}\r\n\r\nexport class DatasourceTabCtrl extends RepositoryTab {\r\n\r\n\tpublic anySelectedDataItem: boolean = false;\r\n\tpublic datagridOptions: IDataGridOptions<IJsonDatasource>;\r\n\tpublic selectedDataItems: IJsonDatasource[] = [];\r\n\r\n\tprotected datagridId: string = \"dataservice-grid\";\r\n\r\n\tprivate dialogTitle: string = \"Create\";\r\n\tprivate importActionTitle: string = \"Import Data Services\";\r\n\tprivate dataset: IJsonDatasource[];\r\n\tprivate set Dataset(value: IJsonDatasource[]) {\r\n\t\tthis.dataset = value;\r\n\t\tthis.saveToCache(this.CACHE_KEY, value);\r\n\t}\r\n\r\n\tprivate readonly CACHE_KEY = \"dataservices\";\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tInjectNames.REPOSITORY_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.CONFLICT_RESOLUTION_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$cacheFactory: ng.ICacheFactoryService,\r\n\t\trepositoryService: RepositoryService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate conflictResolutionService: ConflictResolutonService\r\n\t) {\r\n\t\tsuper($scope, $element, $cacheFactory, repositoryService);\r\n\t}\r\n\r\n\tprotected initDatagridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tthis.dataset = [];\r\n\r\n\t\tcolumns.push({\r\n\t\t\tid: \"selectionCheckbox\",\r\n\t\t\tsortable: false,\r\n\t\t\tresizable: false,\r\n\t\t\twidth: 50,\r\n\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\talign: \"center\"\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"displayName\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"displayName\",\r\n\t\t\twidth: 250,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"author\",\r\n\t\t\tname: \"Author\",\r\n\t\t\tfield: \"authorDisplayName\",\r\n\t\t\twidth: 150,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"date\",\r\n\t\t\tname: \"Created\",\r\n\t\t\tfield: \"creationDate\",\r\n\t\t\twidth: 150,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Date\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Description\",\r\n\t\t\tname: \"Description\",\r\n\t\t\tfield: \"description\",\r\n\t\t\twidth: 250,\r\n\t\t\tsortable: false,\r\n\t\t\tformatter: CustomFormatters.Multi(CustomFormatters.DataSourceDescription(), Soho.Formatters.Ellipsis)\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"suite\",\r\n\t\t\tname: \"Type\",\r\n\t\t\tfield: \"suite\",\r\n\t\t\twidth: 100,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: CustomFormatters.DatasourceSuiteFormatter()\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"action\",\r\n\t\t\tname: \"Action\",\r\n\t\t\tfield: \"\",\r\n\t\t\twidth: 210,\r\n\t\t\tsortable: true,\r\n\t\t\talign: \"center\",\r\n\t\t\tformatter: Soho.Formatters.Button,\r\n\t\t\tclick: (_: JQueryEventObject, rowsSelected: IDataGridRow<any>[]) => {\r\n\t\t\t\tconst item: IJsonGenericDatasource2 = rowsSelected[0].item;\r\n\t\t\t\tthis.repositoryService.getDatasources()\r\n\t\t\t\t\t.then((datasources) => this.openTestDataserviceDialog(item))\r\n\t\t\t\t\t.catch((error: Error) => this.dialogService.showError(\"Could not test data service\", error.message));\r\n\t\t\t},\r\n\t\t\ttext: \"Test Data Service\",\r\n\t\t});\r\n\r\n\t\tthis.datagridOptions = {\r\n\t\t\tcolumns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: SelectableEnum.Multiple,\r\n\t\t\tpaging: true,\r\n\t\t\tpagesize: 25,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Global Data Services\",\r\n\t\t\t\tresults: true,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tadvancedFilter: true,\r\n\t\t\t\tactions: true,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true\r\n\t\t\t},\r\n\t\t\tenableTooltips: true\r\n\t\t};\r\n\t\tthis.loadDatasources();\r\n\t}\r\n\r\n\tprivate openTestDataserviceDialog(\r\n\t\tdataserviceToTest: IJsonGenericDatasource2\r\n\t): ng.IPromise<IDialogResult<string>> {\r\n\t\tconst options: IDialogOptions<ITestDataserviceParameters> = {\r\n\t\t\ttitle: \"Test Data Service\",\r\n\t\t\ttemplate: require(\"../../../common/dialogs/test-dataservice/test-dataservice-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tdataservice: dataserviceToTest as IJsonGenericDatasource2,\r\n\t\t\t\ttype: TestDataserviceDialogType.UNFORMATTED,\r\n\t\t\t},\r\n\t\t};\r\n\t\treturn this.dialogService.show<ITestDataserviceParameters, string>(options);\r\n\t}\r\n\r\n\tprivate loadDatasources(): void {\r\n\t\tconst cachedDataset =\r\n\t\t\tthis.getFromCache<IJsonDatasource[]>(this.CACHE_KEY);\r\n\r\n\t\tif (Helper.isUndefinedOrNull(cachedDataset)) {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.repositoryService.getDatasources().then((datasources: IJsonDatasource[]) => {\r\n\t\t\t\tthis.Dataset = this.datagridOptions.dataset = datasources;\r\n\t\t\t}).catch((errorResponse) => {\r\n\t\t\t\tthis.datagridOptions.dataset = [];\r\n\t\t\t\tthis.dialogService.showError(\"Load Data Services\", errorResponse.message);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.datagridOptions.dataset = cachedDataset;\r\n\t\t\tthis.clearSelected();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic exportDatasource(): void {\r\n\t\tconst ids: string[] = this.selectedDataItems.map((datasource) => {\r\n\t\t\treturn datasource.id;\r\n\t\t});\r\n\t\tthis.repositoryService.exportDatasources(ids);\r\n\t}\r\n\r\n\tpublic import(): void {\r\n\t\tconst options: IDialogOptions<any> = {\r\n\t\t\ttitle: this.importActionTitle,\r\n\t\t\ttemplate: require(\"../../../common/dialogs/import/import-dialog.html\"),\r\n\t\t};\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<FileList>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.loading = true;\r\n\t\t\t\tthis.repositoryService.readJsonFile<IJsonDatasource[]>(result.value[0]).then((datasourcesToImport) => {\r\n\t\t\t\t\tthis.importDatasources(datasourcesToImport);\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\t// Unable to read input file, probable JSON parse error\r\n\t\t\t\t\tconsole.warn(\"[DatasourceRepositoryTabCtrl] Could not read file\");\r\n\t\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\t\tthis.importActionTitle,\r\n\t\t\t\t\t\t\"Unable to read file due to: <br \\>\" + errorResponse.message\r\n\t\t\t\t\t);\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate importDatasources(datasourcesToImport: IJsonDatasource[]): void {\r\n\t\tthis.conflictResolutionService.resolve(\r\n\t\t\tdatasourcesToImport,\r\n\t\t\tthis.datagridOptions.dataset,\r\n\t\t\t\"displayName\",\r\n\t\t\t\"datasource\",\r\n\t\t\tConfig.MAX_DATASOURCES\r\n\t\t).then((conflictResolutionObject) => {\r\n\t\t\tconst datasourcesToAdd = conflictResolutionObject.toAdd;\r\n\t\t\tconst idsToDelete = conflictResolutionObject.toRemove\r\n\t\t\t\t.map(datasourceToDelete => datasourceToDelete.id);\r\n\r\n\t\t\tif (idsToDelete.length > 0) {\r\n\t\t\t\tthis.deleteDatasources(idsToDelete)\r\n\t\t\t\t\t.then(() => this.addImportedDatasources(datasourcesToAdd))\r\n\t\t\t\t\t.catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\t\tconsole.warn(\"[DatasourceRepositoryTabCtrl] Could not replace, unable to remove old data services\");\r\n\t\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\t\t\tthis.importActionTitle,\r\n\t\t\t\t\t\t\t\"Unable to replace old data services: <br \\>\" + errorResponse.message\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.addImportedDatasources(datasourcesToAdd);\r\n\t\t\t}\r\n\t\t}).catch(() => {\r\n\t\t\tconsole.warn(\"[DatasourceRepositoryTabCtrl] Cancelled\");\r\n\t\t\tthis.loading = false;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate addImportedDatasources(datasources: IJsonDatasource[]): void {\r\n\t\tthis.repositoryService.addDatasources(datasources)\r\n\t\t\t.then((addedDatasources) => {\r\n\t\t\t\tthis.conflictResolutionService.checkIfInvalidImportedItems<IJsonDatasource>(\r\n\t\t\t\t\t\"data service(s)\",\r\n\t\t\t\t\taddedDatasources,\r\n\t\t\t\t).catch((errorDialogOptions) => {\r\n\t\t\t\t\tthis.dialogService.showMessage(errorDialogOptions);\r\n\t\t\t\t});\r\n\t\t\t\tfor (const datasource of addedDatasources) {\r\n\t\t\t\t\tif (datasource) {\r\n\t\t\t\t\t\tthis.datagridOptions.dataset.push(datasource);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.Dataset = this.datagridOptions.dataset;\r\n\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\tthis.importActionTitle,\r\n\t\t\t\t\t\"Unable to import data services due to: \\n\" + errorResponse.message\r\n\t\t\t\t);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic delete(): void {\r\n\t\tconst actionTitle = \"Delete Data Services\";\r\n\t\tconst displayNames: string[] = [];\r\n\t\tconst idsToDelete: string[] = this.selectedDataItems.map((datasource) => {\r\n\t\t\tdisplayNames.push(datasource.displayName);\r\n\t\t\treturn datasource.id;\r\n\t\t});\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: actionTitle,\r\n\t\t\tmessage:\r\n\t\t\t\t`Are you sure you want to delete these ${displayNames.length} Data services?<br \\> ${displayNames.join(\", \")}`,\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(options).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.loading = true;\r\n\t\t\t\tthis.deleteDatasources(idsToDelete).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tthis.dialogService.showError(actionTitle, \"Unable to delete due to:<br \\>\" + errorResponse.message);\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate deleteDatasources(ids: string[]): ng.IPromise<void> {\r\n\t\treturn this.repositoryService.deleteDatasources(ids).then(() => {\r\n\t\t\tthis.Dataset = this.datagridOptions.dataset = this.datagridOptions.dataset.filter((datasource) => {\r\n\t\t\t\treturn !ids.some((deletedId) => {\r\n\t\t\t\t\treturn deletedId === datasource.id;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tthis.clearSelected();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic editDatasource(): void {\r\n\t\t// Only accept generic version 2\r\n\t\tconst version: number = 2;\r\n\t\tconst selectedDatasource = this.selectedDataItems[0];\r\n\t\tconst isCorrectVersion = selectedDatasource.version === version;\r\n\t\tconst typedef = selectedDatasource.typedef;\r\n\t\tlet promise: ng.IPromise<any>;\r\n\r\n\t\tif (isCorrectVersion &&\r\n\t\t\t(typedef === DatasourceTypeEnum.generic ||\r\n\t\t\t\ttypedef === DatasourceTypeEnum.IDO ||\r\n\t\t\t\ttypedef === DatasourceTypeEnum.MONGOOSE ||\r\n\t\t\t\ttypedef === DatasourceTypeEnum.INLINE_LIST)\r\n\t\t) {\r\n\t\t\tpromise = this.openDataserviceWizard(selectedDatasource as IJsonGenericDatasource2);\r\n\t\t} else {\r\n\t\t\t/* TODO:\r\n\t\t\t\tRemove else clause, since it handles old and most likely unsupported BI\r\n\t\t\t*/\r\n\t\t\tconst options: IDialogOptions<IUpsertDialogParameter> = {\r\n\t\t\t\ttitle: \"Edit Data Service\",\r\n\t\t\t\ttemplate: require(\"../datasource/dialog/datasource-upsert-dialog.html\"),\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\tdatasource: angular.copy(selectedDatasource),\r\n\t\t\t\t\tdatasources: this.datagridOptions.dataset,\r\n\t\t\t\t\tisEdit: true\r\n\t\t\t\t},\r\n\t\t\t\tcssClass: \"edit-modal\"\r\n\t\t\t};\r\n\t\t\tpromise = this.dialogService.show(options);\r\n\t\t}\r\n\t\tpromise.then((result: IDialogResult<any>) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Ok) {\r\n\t\t\t\tconst datasource: IJsonDatasource = result.value;\r\n\t\t\t\tthis.repositoryService.updateDatasource(datasource).then((response: IJsonDatasource) => {\r\n\t\t\t\t\tthis.updateDatasource(response);\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\t\t\ttitle: \"Edit Data Service\",\r\n\t\t\t\t\t\tmessage: errorResponse.message,\r\n\t\t\t\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\t\t\t\tisError: true,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.dialogService.showMessage(options);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// TODO: make shared functon, same functionality in datasources-dialog.ts\r\n\tpublic openDataserviceWizard(\r\n\t\tdatasource?: IJsonGenericDatasource2\r\n\t): ng.IPromise<IDialogResult<IJsonDatasource>> {\r\n\t\tconst title = (datasource ? \"Edit\" : \"Create\") + \" Data Service\";\r\n\r\n\t\tlet template: string = \"<eir-wizard ng-controller='eirDatasourceWizardCtrl as wizardCtrl'></eir-wizard>\";\r\n\t\tif (datasource) {\r\n\t\t\tswitch (datasource.typedef) {\r\n\t\t\t\tcase DatasourceTypeEnum.IDO:\r\n\t\t\t\t\ttemplate = \"<eir-wizard ng-controller='eirLocalIdoDataserviceWizardCtrl as wizardCtrl'></eir-wizard>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DatasourceTypeEnum.INLINE_LIST:\r\n\t\t\t\t\ttemplate = \"<eir-wizard ng-controller='eirInlineListDataserviceWizardCtrl as wizardCtrl'></eir-wizard>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst options: IDialogOptions<IDatasourceWizardParameter> = {\r\n\t\t\ttitle: title,\r\n\t\t\tparameter: {\r\n\t\t\t\tdatasource: angular.copy(datasource)\r\n\t\t\t},\r\n\t\t\ttemplate,\r\n\t\t\tcssClass: \"wizard-dialog large\",\r\n\t\t\tid: \"datasource-wizard\"\r\n\t\t};\r\n\r\n\t\treturn this.dialogService.show<IDatasourceWizardParameter, IJsonDatasource>(options).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tif (datasource) {\r\n\t\t\t\t\tthis.updateDatasource(result.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.addDatasource(result.value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateDatasource(datasource: IJsonDatasource): void {\r\n\t\tconst cachedDatasources = this.repositoryService.cacheDatasources;\r\n\t\tfor (let i = 0; i < cachedDatasources.length; i++) {\r\n\t\t\tif (cachedDatasources[i].id === datasource.id) {\r\n\t\t\t\tcachedDatasources[i] = datasource;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.datagridOptions.dataset.some((datasourceFind, index, array) => {\r\n\t\t\tif (datasourceFind.id === datasource.id) {\r\n\t\t\t\tarray[index] = datasource;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\tthis.clearSelected();\r\n\t}\r\n\r\n\tpublic create(isSearch: boolean): void {\r\n\t\tif (Helper.exceedAllowed(Config.MAX_DATASOURCES, this.datagridOptions.dataset)) {\r\n\t\t\tthis.dialogService.showError(this.dialogTitle + \" Data Service\", ProjectLimit.DATASOURCE_ERROR_MESSAGE);\r\n\t\t} else {\r\n\t\t\tif (isSearch) {\r\n\t\t\t\tconst options: IDialogOptions<void> = {\r\n\t\t\t\t\ttitle: \"Create from Wizard\",\r\n\t\t\t\t\ttemplate: require(\"../datasource/create-from-wizard/select-source.html\"),\r\n\t\t\t\t\tcssClass: \"select-source-modal\"\r\n\t\t\t\t};\r\n\t\t\t\tthis.dialogService.show(options)\r\n\t\t\t\t\t.then((result: IDialogResult<IJsonGenericDatasource>) => {\r\n\t\t\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\t\tif (result.value) {\r\n\t\t\t\t\t\t\t\tthis.addDatasource(result.value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tconst options: IDialogOptions<IUpsertDialogParameter> = {\r\n\t\t\t\t\ttitle: this.dialogTitle + \" Data Service\",\r\n\t\t\t\t\ttemplate: require(\"../datasource/dialog/datasource-upsert-dialog.html\"),\r\n\t\t\t\t\tparameter: {\r\n\t\t\t\t\t\tdatasource: null,\r\n\t\t\t\t\t\tdatasources: this.datagridOptions.dataset,\r\n\t\t\t\t\t\tisEdit: false\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcssClass: \"create-modal\"\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.dialogService.show(options).then((result: IDialogResult<IDatasource>) => {\r\n\t\t\t\t\tif (result.button === DialogButtonType.Ok && result.value) {\r\n\t\t\t\t\t\tthis.addDatasource(result.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis.dialogTitle = \"Create\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addDatasource(datasource: IJsonDatasource): void {\r\n\t\tthis.repositoryService.addDatasources([datasource]).then((newDatasource) => {\r\n\t\t\tthis.Dataset = this.datagridOptions.dataset = newDatasource.concat(this.datagridOptions.dataset);\r\n\t\t\tthis.clearSelected();\r\n\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\ttitle: \"Create Data Service\",\r\n\t\t\t\tmessage: errorResponse.message,\r\n\t\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\t\tisError: true\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.showMessage(options);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class DatasourceTabComponent implements ng.IComponentOptions {\r\n\tpublic controller = DatasourceTabCtrl;\r\n\tpublic controllerAs = \"eirDatasourceTabCtrl\";\r\n\tpublic template = require(\"./datasource-tab.html\");\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirDatasourceTab\", new DatasourceTabComponent());\r\n\t}\r\n}\r\n","import { IComponentRendered } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IDatagridApi, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { CacheableCtrl } from \"../../common/shared-components/base/cacheable-ctrl\";\r\nimport { DATAGRID_RENDERED } from \"../../common/sohoxi/component/datagrid-directive\";\r\nimport { IRowItem } from \"../../common/sohoxi/datagrid-helper\";\r\nimport { RepositoryService } from \"./repository-service\";\r\n\r\nexport interface IRepositoryTab extends ng.IComponentController {\r\n\tcreate?(optional?: any): void;\r\n\tedit?(): void;\r\n\tdelete(): void;\r\n\timport(): void;\r\n\texport?(): void;\r\n}\r\n\r\nexport abstract class RepositoryTab extends CacheableCtrl implements IRepositoryTab {\r\n\tpublic loading: boolean = false;\r\n\r\n\tprotected abstract datagridId: string;\r\n\tprotected abstract datagridOptions: IDataGridOptions<any>;\r\n\tprotected datagridApi: IDatagridApi;\r\n\r\n\tprotected abstract anySelectedDataItem: boolean;\r\n\tprotected abstract selectedDataItems: any[];\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: ng.IScope,\r\n\t\tprotected $element: ng.IAugmentedJQuery,\r\n\t\t$cacheFactory: ng.ICacheFactoryService,\r\n\t\tprotected repositoryService: RepositoryService,\r\n\t) {\r\n\t\tsuper($cacheFactory);\r\n\t}\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.initDatagridOptions();\r\n\t\tthis.datagridOptions.id = this.datagridId;\r\n\r\n\t\tthis.$element\r\n\t\t\t.on(DATAGRID_RENDERED, (event: JQueryEventObject, result: IComponentRendered) => {\r\n\t\t\t\tif (result.id === this.datagridId) {\r\n\t\t\t\t\tthis.datagridApi = result.api;\r\n\t\t\t\t\tthis.initDatagridEvents();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tabstract delete(): void;\r\n\r\n\tabstract import(): void;\r\n\r\n\tprotected clearSelected(): void {\r\n\t\tthis.anySelectedDataItem = false;\r\n\t\tthis.selectedDataItems = [];\r\n\t\tthis.datagridOptions.updateDatagrid = true;\r\n\t\tif (this.datagridApi) {\r\n\t\t\tthis.datagridApi.updated(this.datagridOptions);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected initDatagridEvents(): void {\r\n\t\tthis.datagridApi?.element\r\n\t\t\t.on(\"selected\", () => {\r\n\t\t\t\tconst selectedRows = this.datagridApi.selectedRows();\r\n\t\t\t\tthis.$scope.$evalAsync(() => {\r\n\t\t\t\t\tif (selectedRows.length > 0) {\r\n\t\t\t\t\t\tthis.anySelectedDataItem = true;\r\n\t\t\t\t\t\tthis.selectedDataItems = selectedRows\r\n\t\t\t\t\t\t\t.map((rowObject: IRowItem<any>) => { return rowObject.data; });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.selectedDataItems = [];\r\n\t\t\t\t\t\tthis.anySelectedDataItem = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tprotected abstract initDatagridOptions(): void;\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirImportProjectCtrl as ctrl\\\"> <div class=field> <label class=fileupload> <input xi-fileupload=ctrl.chosenFile type=file name=file-input /> </label> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-disabled=!ctrl.chosenFile ng-click=ctrl.import()>Import</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonGenericDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\n\r\nexport enum SourceEnum {\r\n\tION_API = \"ION API\",\r\n\tLOCAL_IDO = \"Local IDO\",\r\n\tINLINE_LIST = \"Static List\"\r\n}\r\n\r\nexport class SelectSourceCtrl {\r\n\tpublic readonly sourceList: SourceEnum[] = [\r\n\t\tSourceEnum.ION_API,\r\n\t\tSourceEnum.LOCAL_IDO,\r\n\t\tSourceEnum.INLINE_LIST\r\n\t];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tpublic readonly SELECT_SOURCE_ELEMENT_ID: string = \"select-source\";\r\n\r\n\tpublic selectedSource: SourceEnum;\r\n\r\n\tprivate dialog: IDialog<void>;\r\n\r\n\tconstructor(\r\n\t\t$scope: IDialogBaseScope<any>,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate dialogService: DialogService,\r\n\t) {\r\n\t\tthis.dialog = $scope.eirDialog;\r\n\t\tthis.initDialogEvents();\r\n\r\n\t\tthis.selectedSource = SourceEnum.ION_API;\r\n\t}\r\n\r\n\tpublic next(): void {\r\n\t\tswitch (this.selectedSource) {\r\n\t\t\tcase SourceEnum.ION_API:\r\n\t\t\t\tthis.openIonApiSearch();\r\n\t\t\t\tbreak;\r\n\t\t\tcase SourceEnum.INLINE_LIST:\r\n\t\t\t\tthis.openCreateInlineList();\r\n\t\t\t\tbreak;\r\n\t\t\tcase SourceEnum.LOCAL_IDO:\r\n\t\t\tdefault:\r\n\t\t\t\tthis.openCreateLocalIdo();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tprivate openCreateLocalIdo(): void {\r\n\t\tconst options: IDialogOptions<void> = {\r\n\t\t\ttitle: \"Create Data Service - Find IDO\",\r\n\t\t\ttemplate: require(\"../search/local-ido/search-wizard.html\"),\r\n\t\t\tcssClass: \"create-modal\",\r\n\t\t\tid: \"dataservice-search-wizard\"\r\n\t\t};\r\n\r\n\t\tthis.openDialog(options);\r\n\t}\r\n\r\n\tprivate openCreateInlineList(): void {\r\n\t\tconst template =\r\n\t\t\t`<eir-wizard ng-controller=\"eirInlineListDataserviceWizardCtrl as wizardCtrl\"></eir-wizard>`;\r\n\r\n\t\tconst options: IDialogOptions<void> = {\r\n\t\t\ttitle: \"Create Data Service - Static List\",\r\n\t\t\ttemplate,\r\n\t\t\tcssClass: \"wizard-dialog large\",\r\n\t\t\tid: \"datasource-wizard\"\r\n\t\t};\r\n\r\n\t\tthis.openDialog(options);\r\n\t}\r\n\r\n\tprivate openIonApiSearch(): void {\r\n\t\tconst options: IDialogOptions<void> = {\r\n\t\t\ttitle: \"Create Data Service - Find API\",\r\n\t\t\ttemplate: require(\"../search/ion-api/ion-api-search-wizard.html\"),\r\n\t\t\tcssClass: \"create-modal\",\r\n\t\t\tid: \"dataservice-search-wizard\"\r\n\t\t};\r\n\r\n\t\tthis.openDialog(options);\r\n\t}\r\n\r\n\tprivate openDialog(options: IDialogOptions<void>): void {\r\n\t\tthis.dialogService.show(options)\r\n\t\t\t.then((result: IDialogResult<IJsonGenericDatasource>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tif (result.value) {\r\n\t\t\t\t\t\tthis.dialog.close(result);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (result.button === DialogButtonType.Back) {\r\n\t\t\t\t\tthis.dialog.show();\r\n\t\t\t\t} else { // cancel\r\n\t\t\t\t\tthis.dialog.close();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\tthis.dialog.hide();\r\n\t}\r\n\r\n\tprivate initDialogEvents(): void {\r\n\t\tthis.$element.find(`#${this.SELECT_SOURCE_ELEMENT_ID}`)\r\n\t\t\t.on(\"selected\", event => {\r\n\t\t\t\tconst selectOption = event.currentTarget as unknown as HTMLOptionElement;\r\n\t\t\t\tthis.selectedSource = selectOption.value as SourceEnum;\r\n\t\t\t});\r\n\t}\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.controller(\"eirSelectSourceCtrl\", SelectSourceCtrl);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=step-three> <div class=field> <eir-input-field-component label-name=Name field-value=wizardCtrl.datasource.displayName validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'max-length', value: 128},\\r\\n\\t\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: wizardCtrl.ErrorList\\r\\n\\t\\t\\t}\\\"/> </div> <div class=field> <label for=datasource-description>Description</label> <textarea id=datasource-description ng-model=wizardCtrl.datasource.description></textarea> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport { IJsonLocalIdoDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport { IdoCollection, IdoProperty } from \"../../../../../components/services/local-ido-service\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../../common/defines\";\r\nimport { CustomFormatters } from \"../../../../../common/sohoxi/custom-formatters\";\r\nimport { RepositoryHelper } from \"../../../repository-helper\";\r\n\r\nexport interface ILocalIdoParameter {\r\n\toperation: IdoCollection;\r\n\tproperties: IdoProperty[];\r\n\tdatasource?: IJsonLocalIdoDatasource;\r\n}\r\n\r\nexport class LocalIdoOperationDetails {\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t];\r\n\r\n\tpublic get operation(): IdoCollection {\r\n\t\treturn this.$scope.eirDialog.parameter.operation;\r\n\t}\r\n\r\n\tpublic get properties(): IdoProperty[] {\r\n\t\treturn this.$scope.eirDialog.parameter.properties;\r\n\t}\r\n\r\n\tpublic parameterDatagridOptions: IDataGridOptions<any>;\r\n\r\n\tconstructor(private $scope: IDialogBaseScope<ILocalIdoParameter>) {\r\n\t\tthis.initParameterDatagrid();\r\n\r\n\t\tthis.parameterDatagridOptions.dataset = this.properties.map(property => {\r\n\t\t\tproperty.dataType = RepositoryHelper.getAppbuilderDataType(property.dataType);\r\n\t\t\treturn property;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initParameterDatagrid(): any {\r\n\t\tconst columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\tid: \"propertyName\",\r\n\t\t\t\tname: \"Property Name\",\r\n\t\t\t\tfield: \"propertyName\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: \"17%\",\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"dataType\",\r\n\t\t\t\tname: \"Data Type\",\r\n\t\t\t\tfield: \"dataType\",\r\n\t\t\t\twidth: \"17%\",\r\n\t\t\t\tsortable: false\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"dataLength\",\r\n\t\t\t\tname: \"Length\",\r\n\t\t\t\tfield: \"dataLength\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: \"17%\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"isReadOnly\",\r\n\t\t\t\tname: \"Read Only\",\r\n\t\t\t\tfield: \"isReadOnly\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: \"17%\",\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"isReadOnly\")\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"isRequired\",\r\n\t\t\t\tname: \"Required\",\r\n\t\t\t\tfield: \"isRequired\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: \"17%\",\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"isRequired\")\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"keySequence\",\r\n\t\t\t\tname: \"Primary Key\",\r\n\t\t\t\tfield: \"keySequence\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: \"17%\",\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"keySequence\", true)\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tthis.parameterDatagridOptions = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: false,\r\n\t\t\tisList: true,\r\n\t\t\tsaveColumns: false,\r\n\t\t\tenableTooltips: true,\r\n\t\t};\r\n\t}\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.controller(\r\n\t\t\t\"eirLocalIdoOperationDetails\",\r\n\t\t\tLocalIdoOperationDetails\r\n\t\t);\r\n\t}\r\n}\r\n","import { IJsonChart } from \"ng2/common/model/databearer/components/json-chart.model\";\r\n\r\nimport { Chart } from \"../../../../components/chart/chart\";\r\nimport { ISettingsClassInstance } from \"../../defines\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\nimport { ChartContentSettingsDirective } from \"./chart-content-settings\";\r\nimport { ChartStyleSettingsDirective } from \"./chart-style-settings\";\r\n\r\nexport enum ChartDialogActionEnum {\r\n\tADD = (\"Add Data Set\") as any,\r\n\tEDIT = (\"Edit Data Set\") as any\r\n}\r\n\r\nexport class ChartSettingsCtrl implements ISettingsClassInstance {\r\n\tprivate static instance: ChartSettingsCtrl = new ChartSettingsCtrl();\r\n\r\n\tpublic static getInstance(): ChartSettingsCtrl {\r\n\t\treturn ChartSettingsCtrl.instance;\r\n\t}\r\n\r\n\tpublic contentSettingsDirective: ng.IDirective = new ChartContentSettingsDirective();\r\n\tpublic styleSettingsDirective: ng.IDirective = new ChartStyleSettingsDirective();\r\n\r\n\tpublic constructor() {\r\n\t\tif (ChartSettingsCtrl.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use ChartSettingsCtrl.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic create(id: string): IJsonChart {\r\n\t\tconst newChart = ComponentSettingsCtrl.create(id, Chart) as IJsonChart;\r\n\r\n\t\treturn newChart;\r\n\t}\r\n}\r\n","import { ComponentClassNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonChart } from \"ng2/common/model/databearer/components/json-chart.model\";\r\nimport type { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IAvailableSourceField } from \"common/defines\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { Chart } from \"components/chart/chart\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorChart extends IEditorComponent, Chart {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonChart;\r\n}\r\n\r\nexport class EditorChartCtrl extends EditorComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Chart.name,\r\n\t\t\tEditorChartCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorChart;\r\n\r\n\t/**\r\n\t * Called to fill in content/style dialogs\r\n\t *\r\n\t * @returns {ng.IPromise<IAvailableSourceField[]>}\r\n\t *\r\n\t * @memberOf Chart\r\n\t */\r\n\tpublic getLocalContextMetaData(): ng.IPromise<IAvailableSourceField[]> {\r\n\t\tif (!this.component.datasource) {\r\n\t\t\treturn super.getLocalContextMetaData();\r\n\t\t}\r\n\r\n\t\treturn this.component.datasource.getMetaData().then(metadata => {\r\n\t\t\tconst availableSourceField: IAvailableSourceField[] = [];\r\n\t\t\tconst listResult = this.component.getContext().ListResult;\r\n\t\t\tlet listRow: IMap<any> = undefined;\r\n\r\n\t\t\tif (listResult.length > 0) {\r\n\t\t\t\tlistRow = listResult[0];\r\n\t\t\t}\r\n\r\n\t\t\tmetadata.outputFields.map((outputField: IMetaDataField) => {\r\n\t\t\t\tconst previewText = listRow ? `(${listRow[outputField.FLNM]})` : \"\";\r\n\r\n\t\t\t\tavailableSourceField.push({\r\n\t\t\t\t\tvisibleName: outputField.FLDS.trim() + previewText,\r\n\t\t\t\t\tsourceKey: outputField.FLNM,\r\n\t\t\t\t\tsourceKeyShort: outputField.FLNM\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\treturn availableSourceField;\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setDatasource(newDatasource: IDatasource): ng.IPromise<void> {\r\n\t\treturn super.setDatasource(newDatasource).then(() => {\r\n\t\t\tthis.component.datasourceChanged(newDatasource);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirExpressionDialogCtrl as ctrl\\\" class=expression-dialog> <div class=expression-dialog> <div class=toolbar role=toolbar> <div class=buttonset> <label class=audible for=searchfield-expressions>Keyword Search</label> <input id=searchfield-expressions name=searchfield-expressions class=searchfield /> <button class=btn-tertiary type=button xi-tooltip=\\\"'Add Condition'\\\" ng-click=ctrl.addExpression() ng-if=\\\"ctrl.expressionType !== 'all'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>Add</span> </button> <button class=btn-tertiary type=button xi-tooltip=\\\"'Edit Condition'\\\" ng-disabled=!ctrl.itemSelected ng-click=ctrl.editExpression()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-edit></use> </svg> <span>Edit</span> </button> <button class=btn-tertiary type=button xi-tooltip=\\\"'Delete Condition'\\\" ng-disabled=!ctrl.itemSelected ng-click=ctrl.deleteExpression()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> </div> </div> <div id=datagrid-expressions xi-datagrid=ctrl.datagridOptions></div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Close</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import type { InteractionActionEnum } from \"ng2/common/constants/common.constant\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IAvailableTargetField } from \"ng2/common/model/interaction/available-target-field.model\";\r\n\r\nimport type {\r\n\tIAvailableSourceField,\r\n\tIJQueryDragEventObject,\r\n\tIJQueryMouseEventObject\r\n} from \"common/defines\";\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IInsertPoints } from \"editor/defines\";\r\nimport type { IEditorLayoutComponent } from \"editor/components/editor-layout-component\";\r\nimport type { IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nimport { Defines } from \"components/defines\";\r\nimport { ApplicationParent } from \"components/application-parent\";\r\n\r\nexport class EditorApplicationParent extends ApplicationParent implements IEditorLayoutComponent {\r\n\r\n\tpublic parent: IEditorLayoutComponent;\r\n\r\n\tpublic getScope(): IEditorComponentScope {\r\n\t\treturn this.scope as IEditorComponentScope;\r\n\t}\r\n\r\n\t// Copies from EditorComponents implementation\r\n\tpublic getFieldSettings(): IComponentSettingCategory[] {\r\n\t\treturn Defines.allComponents[this.getTypedef()].class.SETTING_FIELDS;\r\n\t}\r\n\r\n\tpublic getSourceTriggers(): IDataPair[] {\r\n\t\treturn Defines.allComponents[this.getTypedef()].class.SOURCE_TRIGGERS;\r\n\t}\r\n\r\n\tpublic getTargetActions(): IDataPair[] {\r\n\t\treturn Defines.allComponents[this.getTypedef()].class.TARGET_ACTIONS;\r\n\t}\r\n\r\n\tpublic getDefaultAction(): IDataPair {\r\n\t\treturn Defines.allComponents[this.getTypedef()].class.DEFAULT_ACTION;\r\n\t}\r\n\r\n\tpublic getDefaultTrigger(): IDataPair {\r\n\t\treturn Defines.allComponents[this.getTypedef()].class.DEFAULT_TRIGGER;\r\n\t}\r\n\r\n\tpublic getParameterMetadata(action: InteractionActionEnum): ng.IPromise<IAvailableTargetField[]> {\r\n\t\tconst deferred = this.frameworkService.getNewDeferred<any>();\r\n\t\tdeferred.reject(\"No parameter metadata on app parent\");\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tpublic getContextMetaData(): ng.IPromise<IAvailableSourceField[]> {\r\n\t\tconst deferred = this.frameworkService.getNewDeferred<IAvailableSourceField[]>();\r\n\t\tdeferred.resolve([]);\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tpublic getBindingMetaData(): ng.IPromise<IAvailableSourceField[]> {\r\n\t\tconst deferred = this.frameworkService.getNewDeferred<IAvailableSourceField[]>();\r\n\t\tconst availableBindings: IAvailableSourceField[] = [];\r\n\t\tthis.forEachBindable((bindableFieldDefinition, currentValueSource: IJsonValueSource) => {\r\n\t\t\tif (bindableFieldDefinition.read) {\r\n\t\t\t\tavailableBindings.push({\r\n\t\t\t\t\tvisibleName: bindableFieldDefinition.name,\r\n\t\t\t\t\tsourceKey: bindableFieldDefinition.ref,\r\n\t\t\t\t\tsourceKeyShort: bindableFieldDefinition.ref,\r\n\t\t\t\t\tcurrentValue: (this as any)[bindableFieldDefinition.ref]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\tdeferred.resolve(availableBindings);\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tpublic getLocalContextMetaData(): ng.IPromise<IAvailableSourceField[]> {\r\n\t\tconst deferred = this.frameworkService.getNewDeferred<IAvailableSourceField[]>();\r\n\t\tdeferred.resolve([]);\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\t// To fulfill the EditorLayoutComponent interface\r\n\t// TODO: Maybe have a separate interface for \"NonGraphicComponent\" or \"ParentCompoenent\"\r\n\tpublic detach(): IJsonComponent { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic exposesReadableBindables(): boolean {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic exposesLocalizedBindables(): boolean {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onClick(event: IJQueryMouseEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onDragenter(event: IJQueryDragEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onDragleave(event: IJQueryDragEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onDragover(event: IJQueryDragEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onDragstart(event: IJQueryDragEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onDrop(event: IJQueryDragEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onMouseLeave(event: IJQueryMouseEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onMouseMove(event: IJQueryMouseEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onMouseOver(event: IJQueryMouseEventObject): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic resizableHeight(): boolean { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic resizableWidth(): boolean { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic setIsFinder(isFinder: boolean): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic setIsHovered(isHovered: boolean): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic setIsInsertChild(isInsertChild: boolean): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic setIsInsertParent(isInsertParent: boolean): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic setIsSelected(isHovered: boolean): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic setIsWizardFocus(isWizardFocusEnum: number): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic wizardFocusType: number;\r\n\r\n\tpublic setProperty(propertyName: string, newValue: any): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic setDatasource(datasource: IDatasource): ng.IPromise<void> {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic removeDatasource(): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic getBindableField(bindableReference: string): IJsonValueSource {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic getSettingCategories(): IComponentSettingCategory[] {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic setSetting(settingMeta: IComponentFieldSetting, newSettingValue: any): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic setBoundarySetting<T>(settingId: string, settingValue: T, boundaryId?: string): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic openDialog(): ng.IPromise<void> {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic insert(component: IJsonComponent, index?: number): Function {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic getInsertPoints(): IInsertPoints { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic removeChild(childId: string): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic detachChild(childId: string): IJsonComponent { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic getChildIndex(childId: string): number { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic refreshMetaSettings(): void { throw new Error(\"[EditorApplicationParent] method not implemented\"); }\r\n\r\n\tpublic onComponentInserted(childInstance: IEditorComponent, index: number): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n\tpublic onComponentDeleted(componentInstance: IEditorComponent): void {\r\n\t\tthrow new Error(\"[EditorApplicationParent] method not implemented\");\r\n\t}\r\n\r\n}\r\n","import { ComponentClassNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IJsonRadioButtons } from \"common/model/component/radiobutton.model\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { RadioButton } from \"components/radiobutton/radiobutton\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorRadioButtons extends IEditorComponent, RadioButton {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonRadioButtons;\r\n}\r\n\r\nexport class EditorRadioButtonCtrl extends EditorComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + RadioButton.name,\r\n\t\t\tEditorRadioButtonCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorRadioButtons;\r\n\r\n}\r\n","import { DEFAULT_BOUNDARY } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonTabPanel } from \"../../../../common/model/component/tabs.model\";\r\nimport { TabPanel } from \"../../../../components/tabs/tab-panel\";\r\nimport { IEditorFlexbox } from \"../../components/editor-flexbox\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\nimport { FlexboxContentSettingsDirective } from \"../flexbox/flexbox-content-settings\";\r\n\r\nexport interface IEditorTabPanel extends IEditorFlexbox {\r\n}\r\n\r\nexport class TabPanelSettings {\r\n\r\n\tprivate static instance: TabPanelSettings = new TabPanelSettings();\r\n\r\n\tstatic getInstance(): TabPanelSettings {\r\n\t\treturn TabPanelSettings.instance;\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tif (TabPanelSettings.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use FlexboxSettings.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n\r\n\tcontentSettingsDirective: ng.IDirective = new FlexboxContentSettingsDirective();\r\n\r\n\tcreate(id: string, panelIndex?: number): IJsonTabPanel {\r\n\t\tconst newPanel = ComponentSettingsCtrl.create(id, TabPanel) as IJsonTabPanel;\r\n\t\tnewPanel.children = [];\r\n\r\n\t\tconst boundaryId = DEFAULT_BOUNDARY.id;\r\n\t\tnewPanel.boundarySettings[boundaryId].visibility = panelIndex === 1 ? true : false;\r\n\r\n\t\treturn newPanel;\r\n\t}\r\n}\r\n","import { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\n\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IInsertPoints } from \"editor/defines\";\r\n\r\nimport { ApplicationParent } from \"components/application-parent\";\r\nimport { ChildrenDirective } from \"components/children-directive\";\r\n\r\nimport {\r\n\tEditorComponentCtrl,\r\n\tIEditorComponentScope\r\n} from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorLayoutComponent extends IEditorComponent, ILayoutComponent {\r\n\tparent: IEditorLayoutComponent;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonLayoutComponent;\r\n\tcalcNewSizes(orientation?: OrientationEnum): void;\r\n\r\n\t// Methods for layout components in Designer\r\n\tinsert(component: IJsonComponent, index?: number, isFinalInsert?: boolean): Function;\r\n\tgetInsertPoints(): IInsertPoints;\r\n\tremoveChild(childId: string): void;\r\n\tdetachChild(childId: string): IJsonComponent;\r\n\tgetChildIndex(childId: string): number;\r\n\tonComponentInserted(childInstance: IEditorComponent, index: number): void;\r\n\tonComponentDeleted(componentInstance: IEditorComponent): void;\r\n}\r\n\r\nexport class EditorLayoutComponentCtrl extends EditorComponentCtrl {\r\n\r\n\tprotected component: IEditorLayoutComponent;\r\n\tprotected isFinalInsert: boolean;\r\n\r\n\tprotected init(component: IEditorLayoutComponent): void {\r\n\t\tsuper.init(component);\r\n\r\n\t\tcomponent.onComponentInserted = this.onComponentInserted.bind(this);\r\n\t\tcomponent.onComponentDeleted = this.onComponentDeleted.bind(this);\r\n\r\n\t}\r\n\r\n\tpublic onComponentInserted(childInstance: IEditorComponent, index: number): void {\r\n\t\tconst allComponents = this.editorService.getAllBindableComponents();\r\n\t\tthis.component.children.splice(index, 0, childInstance);\r\n\t\tchildInstance.newBoundaryEntered(this.editorService.getCurrentBoundary().id);\r\n\t\tchildInstance.forEachChild((subChild) => {\r\n\t\t\tif (this.isFinalInsert) {\r\n\t\t\t\tif (subChild.getDatasource()) {\r\n\t\t\t\t\tthis.interactionManagementService.runStartupOnComponent(subChild.getDatabearer());\r\n\t\t\t\t}\r\n\t\t\t\tthis.initializeSourceBindings(childInstance, allComponents);\r\n\t\t\t}\r\n\t\t\tsubChild.initializeBindings();\r\n\t\t}, true);\r\n\t}\r\n\r\n\tpublic onComponentDeleted(componentInstance: IEditorComponent): void {\r\n\t\t// Component deleted\r\n\t}\r\n\r\n\tpublic static createTemplate(typedef: string): JQuery {\r\n\t\tconst componentTemplate = ChildrenDirective.createTemplate(typedef);\r\n\r\n\t\tcomponentTemplate.attr(\"component-ready\", \"parent.onComponentInserted(componentInstance, index);\");\r\n\t\tcomponentTemplate.attr(\"component-destroyed\", \"parent.onComponentDeleted(componentInstance)\");\r\n\r\n\t\treturn componentTemplate;\r\n\t}\r\n\r\n\tprivate initializeSourceBindings(childInstance: IEditorComponent, allComponents: IEditorComponent[]): void {\r\n\t\tallComponents.forEach(component => {\r\n\t\t\tif (component.getTypedef() !== ApplicationParent.name) {\r\n\t\t\t\tcomponent.forEachBindable((bindable) => {\r\n\t\t\t\t\tconst field = component.getBindableField(bindable.ref);\r\n\t\t\t\t\tif (field && field.sourceName === childInstance.getId() && field.Type !== BindingTypeEnum.STATIC_VALUE) {\r\n\t\t\t\t\t\tcomponent.initializeBindings();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { ComponentClassNames, SettingKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonTabComponent, IJsonTabPanel, IJsonTabs } from \"common/model/component/tabs.model\";\r\nimport type { ITab, ITabContent } from \"common/model/sohoxi/sohoxi-tabs.model\";\r\nimport type { IArrangeEvent } from \"common/model/sohoxi/sohoxi.model\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\n\r\nimport type { IChildScope } from \"common/interface/ichild-scope\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { TabPanel } from \"components/tabs/tab-panel\";\r\nimport { Tabs } from \"components/tabs/tabs\";\r\nimport { IEditorTabPanel, TabPanelSettings } from \"editor/component-settings/tabs/tab-panel-settings\";\r\nimport type { IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\nimport { EditorLayoutComponentCtrl, IEditorLayoutComponent } from \"editor/components/editor-layout-component\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { ComponentsHelper } from \"components/helper\";\r\nimport { EditorHelper } from \"editor/helper\";\r\n\r\nexport interface IEditorTabs extends IEditorLayoutComponent, Tabs {\r\n\tchildren: IEditorTabPanel[];\r\n\tparent: IEditorFlexbox;\r\n\taddTab(): IJsonTabComponent;\r\n\tdeleteTab(tab: IJsonTabComponent): void;\r\n\tupdateTab(tab: IJsonTabComponent, updatedTab: IJsonTabComponent): void;\r\n\tswitchFocusTab(tab: IJsonTabComponent): void;\r\n\tupdateTabPosition(status: any): void;\r\n\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonTabs;\r\n}\r\n\r\nexport class EditorTabsCtrl extends EditorLayoutComponentCtrl {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Tabs.name,\r\n\t\t\tEditorTabsCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorTabs;\r\n\r\n\texposesLocalizedBindables(): boolean {\r\n\t\treturn true; //tabs\r\n\t}\r\n\r\n\tinit(component: IEditorTabs): void {\r\n\t\tsuper.init(component);\r\n\r\n\t\tcomponent.addTab = this.addTab.bind(this);\r\n\t\tcomponent.deleteTab = this.deleteTab.bind(this);\r\n\t\tcomponent.updateTab = this.updateTab.bind(this);\r\n\t\tcomponent.switchFocusTab = this.switchFocusTab.bind(this);\r\n\t\tcomponent.updateTabPosition = this.updateTabPosition.bind(this);\r\n\t}\r\n\r\n\tonComponentInserted(childInstance: IEditorComponent, index: number): void {\r\n\t\tsuper.onComponentInserted(childInstance, index);\r\n\t}\r\n\r\n\tgetTabApi(): ITab {\r\n\t\treturn this.component.element\r\n\t\t\t.find(\".tab-container\")\r\n\t\t\t.data(\"tabs\");\r\n\t}\r\n\r\n\taddTab(): IJsonTabComponent {\r\n\t\tconst databearer = this.component.getDatabearer();\r\n\r\n\t\tconst newTabComponent = this.createTabComponent();\r\n\t\tdatabearer.componentTabs.push(newTabComponent);\r\n\r\n\t\tconst newTabPanel = TabPanelSettings.getInstance().create(newTabComponent.id);\r\n\t\tdatabearer.children.push(newTabPanel);\r\n\r\n\t\tthis.appendTabComponentToTemplate(newTabComponent, newTabPanel);\r\n\r\n\t\treturn newTabComponent;\r\n\t}\r\n\r\n\tdeleteTab(tab: IJsonTabComponent): void {\r\n\t\tconst databearer = this.component.getDatabearer();\r\n\r\n\t\tconst listOfTabs = databearer.componentTabs;\r\n\t\tconst index = listOfTabs.indexOf(tab);\r\n\t\tHelper.removeItemFromListByIndex(listOfTabs, index);\r\n\t\tHelper.removeItemFromListByIndex(databearer.children, index);\r\n\r\n\t\tthis.translationManagementService.removeTranslation(databearer.id, tab.id);\r\n\t\tthis.getTabApi().remove(tab.id);\r\n\r\n\t\t// switch to adjencent tab\r\n\t\tconst adjencentTabIndex = index - 1 > 0 ? index - 1 : 0;\r\n\t\tthis.switchFocusTab(listOfTabs[adjencentTabIndex]);\r\n\t}\r\n\r\n\tupdateTab(tab: IJsonTabComponent, updatedTab: IJsonTabComponent): void {\r\n\t\tconst componentTabs = this.component.componentTabs;\r\n\t\tconst index = componentTabs.indexOf(tab);\r\n\r\n\t\tif (index !== -1) {\r\n\t\t\t// Temporary until there's a proper method in SohoXI Tab API\r\n\t\t\tconst tabElement = angular.element(\"a[href$='\" + tab.id + \"']\");\r\n\r\n\t\t\t// Use global value if availale\r\n\t\t\tconst value = updatedTab.value ? updatedTab.value : updatedTab.name;\r\n\r\n\t\t\ttabElement.text(value);\r\n\t\t\tthis.switchFocusTab(this.component.currentTab);\r\n\t\t}\r\n\t}\r\n\r\n\tswitchFocusTab(tab: IJsonTabComponent): void {\r\n\t\tthis.getTabApi().select(\"#\" + tab.id, false);\r\n\t\tthis.component.currentTab = tab;\r\n\t\tthis.component.updatePanels();\r\n\t}\r\n\r\n\tupdateTabPosition(event: IArrangeEvent): void {\r\n\t\tconst databearer = this.component.getDatabearer();\r\n\t\tconst componentTabs = databearer.componentTabs;\r\n\t\tconst children = databearer.children;\r\n\r\n\t\tif (event.startIndex > event.endIndex) {\r\n\t\t\t//moving up\r\n\t\t\tthis.getTabElement(event.endIndex).before(this.getTabElement(event.startIndex));\r\n\t\t} else if (event.endIndex > event.startIndex) {\r\n\t\t\t//moving down\r\n\t\t\tthis.getTabElement(event.endIndex).after(this.getTabElement(event.startIndex));\r\n\t\t}\r\n\r\n\t\tEditorHelper.moveByIndex(componentTabs, event.startIndex, event.endIndex);\r\n\t\tEditorHelper.moveByIndex(children, event.startIndex, event.endIndex);\r\n\r\n\t\tthis.switchFocusTab(componentTabs[event.endIndex]);\r\n\t}\r\n\r\n\tsetSetting(settingMeta: IComponentFieldSetting, newSettingValue: number): void {\r\n\t\tsuper.setSetting(settingMeta, newSettingValue);\r\n\t\tif (settingMeta.ref === SettingKeys.ORIENTATION) {\r\n\t\t\tthis.component.onOrientationChanged();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getTabElement(index: number): JQuery {\r\n\t\tconst componentDatabearer = this.component.getDatabearer();\r\n\t\tconst elementId = componentDatabearer.componentTabs[index].id;\r\n\t\tconst elementSelector = \"a[href$='\" + elementId + \"']\";\r\n\r\n\t\treturn angular.element(elementSelector).parent();\r\n\t}\r\n\r\n\tprivate createTabComponent(): IJsonTabComponent {\r\n\t\tconst databearer = this.component.getDatabearer();\r\n\r\n\t\tconst newTabId = ComponentsHelper.nextNumber(\r\n\t\t\tdatabearer.componentTabs.map((tab) => {\r\n\t\t\t\treturn tab.id;\r\n\t\t\t}));\r\n\t\tconst newId: string = this.component.getId() + \"Panel\" + newTabId;\r\n\t\tconst newName: string = \"Tab \" + newTabId;\r\n\r\n\t\treturn {\r\n\t\t\tid: newId,\r\n\t\t\tname: newName\r\n\t\t};\r\n\t}\r\n\r\n\tprivate appendTabComponentToTemplate(\r\n\t\ttabComponent: IJsonTabComponent,\r\n\t\ttabPanel: IJsonTabPanel\r\n\t): void {\r\n\t\tconst elementName = TabPanel.name;\r\n\t\tconst tabPanelTemplate =\r\n\t\t\tEditorLayoutComponentCtrl.createTemplate(elementName);\r\n\r\n\t\tconst templateLinkingFunction = this.$compile(tabPanelTemplate);\r\n\r\n\t\tconst childScope = this.$scope.$new(true) as IChildScope;\r\n\t\tchildScope.component = tabPanel;\r\n\t\tchildScope.parent = this.component;\r\n\t\tchildScope.context = this.$scope.context;\r\n\r\n\t\ttemplateLinkingFunction(childScope, (clone) => {\r\n\t\t\tconst tabElement = this.component.element;\r\n\t\t\tconst tabOption: ITabContent = { name: tabComponent.name };\r\n\r\n\t\t\tthis.getTabApi().add(tabComponent.id, tabOption);\r\n\t\t\tconst newTabPanel = tabElement.find(`#${tabComponent.id}`);\r\n\t\t\tif (newTabPanel.length) {\r\n\t\t\t\tnewTabPanel.append(clone);\r\n\t\t\t\tthis.switchFocusTab(tabComponent);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error(\"Invalid tab component id\");\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { DEFAULT_BOUNDARY, FlexSizeTypeEnum, InjectNames, ProjectLimit, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport { ILanguage } from \"ng2/common/model/language.model\";\r\nimport { Helper } from \"../../../common/helper\";\r\nimport { IJsonTabs } from \"../../../common/model/component/tabs.model\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult,\r\n\tIMessageDialogOptions, StandardDialogButtons\r\n} from \"../../../common/services/dialog-service\";\r\nimport { Defines } from \"../../../components/defines\";\r\nimport { TranslationManagementService } from \"../../../components/services/translation-management-service\";\r\nimport { Tabs } from \"../../../components/tabs/tabs\";\r\nimport { DesignerService } from \"../../services/designer-service\";\r\nimport { EditorService } from \"./editor-service\";\r\n\r\nexport class CompositeComponentManagementService {\r\n\tprivate idCounter: number = 0;\r\n\tprivate isActive: boolean;\r\n\tprivate compositeComponentDialogPromise: ng.IPromise<IDialogResult<IJsonCompositeComponent>>;\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DESIGNER_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate designerService: DesignerService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate translationManagementService: TranslationManagementService\r\n\t) {\r\n\t}\r\n\r\n\tcreateNewViaWizard(component: IJsonComponent): void {\r\n\t\tcomponent = angular.copy(component);\r\n\t\tif (Helper.exceedAllowed(\r\n\t\t\tProjectLimit.MAX_COMPOSITE_COMPONENTS,\r\n\t\t\tthis.editorService.getCurrentProject().getCompositeComponents())\r\n\t\t) {\r\n\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\"Create Composite Component\", ProjectLimit.COMPOSITE_COMPONENT_ERROR_MESSAGE);\r\n\t\t} else {\r\n\t\t\tthis.startCompositeComponentWizard(component)\r\n\t\t\t\t.then((dialogResult: IDialogResult<IJsonCompositeComponent>) => {\r\n\t\t\t\t\tif (dialogResult.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\tconst compositeComponent = dialogResult.value;\r\n\t\t\t\t\t\tconst project = this.editorService.getCurrentProject();\r\n\t\t\t\t\t\tthis.designerService.requestInfo().then(() => {\r\n\t\t\t\t\t\t\tconst id = this.generateId(\"compositeComponent\");\r\n\t\t\t\t\t\t\tcompositeComponent.manifest.id = id;\r\n\t\t\t\t\t\t\tcompositeComponent.manifest.creationDate = Date.now();\r\n\t\t\t\t\t\t\tcompositeComponent.manifest.author = this.designerService.getInfo().getUserName();\r\n\t\t\t\t\t\t\tcompositeComponent.manifest.authorDisplayName =\r\n\t\t\t\t\t\t\t\tthis.designerService.getInfo().getUserDisplayName();\r\n\r\n\t\t\t\t\t\t\tlet includeDatasources = false;\r\n\t\t\t\t\t\t\tif (compositeComponent.datasources) {\r\n\t\t\t\t\t\t\t\tincludeDatasources = true;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Remove posible static width setting. The composit should adapt to the layout it is put into.\r\n\t\t\t\t\t\t\tif (Defines.allComponents[compositeComponent.component.typedef].isLayoutComponent) {\r\n\t\t\t\t\t\t\t\tconst component = compositeComponent.component as IJsonFlexbox;\r\n\t\t\t\t\t\t\t\tcomponent.boundarySettings[DEFAULT_BOUNDARY.id].sizeType = FlexSizeTypeEnum.FLEX;\r\n\t\t\t\t\t\t\t\tcomponent.boundarySettings[DEFAULT_BOUNDARY.id].size = 1;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// Clear datasoruces if not included\r\n\t\t\t\t\t\t\tthis.editorService.forEachComponent(compositeComponent.component, (component) => {\r\n\t\t\t\t\t\t\t\tif (!includeDatasources) {\r\n\t\t\t\t\t\t\t\t\tcomponent.datasource = null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tproject.addCompositeComponent(compositeComponent);\r\n\t\t\t\t\t\t\t/* tslint:disable:no-bitwise */\r\n\t\t\t\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.COMPOSITE_COMPONENTS | SaveFlagsEnum.MANIFEST);\r\n\t\t\t\t\t\t\t/* tslint:enable:no-bitwise */\r\n\t\t\t\t\t\t\tthis.editorService.compositeComponentsChangedEvent.raise(project.getCompositeComponents());\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tmanageCompositeComponents(): void {\r\n\t\tconst options: IDialogOptions<any> = {\r\n\t\t\ttitle: \"Project Composite Components\",\r\n\t\t\ttemplate: require(\"../component-settings/manage-dialogs/composites-dialog.html\"),\r\n\t\t\tcssClass: \"composites-manage-dialog\",\r\n\t\t\tstyle: \"min-width: 1000px; max-width: 1125px;\",\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(options).then(() => {\r\n\t\t\tthis.editorService.compositeComponentsChangedEvent\r\n\t\t\t\t.raise(this.editorService.getCurrentProject().getCompositeComponents());\r\n\t\t\t/* tslint:disable:no-bitwise */\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.COMPOSITE_COMPONENTS | SaveFlagsEnum.MANIFEST);\r\n\t\t\t/* tslint:enable:no-bitwise */\r\n\t\t});\r\n\t}\r\n\r\n\tstartCompositeComponentWizard(\r\n\t\tcomponent: IJsonComponent\r\n\t): ng.IPromise<IDialogResult<IJsonCompositeComponent>> {\r\n\t\tif (!this.isActive) {\r\n\t\t\tthis.isActive = true;\r\n\t\t\tconst options: IDialogOptions<IJsonComponent> = {\r\n\t\t\t\ttitle: \"Create Composite Component\",\r\n\t\t\t\tparameter: component,\r\n\t\t\t\ttemplate: \"<eir-wizard ng-controller='eirCompositeComponentWizardCtrl as wizardCtrl'></eir-wizard>\",\r\n\t\t\t\tcssClass: \"wizard-dialog\",\r\n\t\t\t\tstyle: \"min-width: 450px; min-height: 500px; max-width: 480px;\",\r\n\t\t\t\tid: \"composite-component-wizard\",\r\n\t\t\t\tdraggable: true,\r\n\t\t\t};\r\n\r\n\t\t\tthis.compositeComponentDialogPromise =\r\n\t\t\t\tthis.dialogService.show<IJsonComponent, IJsonCompositeComponent>(options)\r\n\t\t\t\t\t.finally(() => {\r\n\t\t\t\t\t\tthis.isActive = false;\r\n\t\t\t\t\t});\r\n\t\t}\r\n\t\treturn this.compositeComponentDialogPromise;\r\n\t}\r\n\r\n\tremoveViaDialog(compositeId: string): void {\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tconst compositeComponent = currentProject.getCompositeComponent(compositeId);\r\n\t\tconst confirmDialogOptions: IMessageDialogOptions = {\r\n\t\t\ttitle: \"Really delete?\",\r\n\t\t\tmessage: \"Do you really want to delete composite component '\" + compositeComponent.manifest.displayName + \"'?\",\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(confirmDialogOptions).then((result: IDialogResult<void>) => {\r\n\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\tcurrentProject.removeCompositeComponent(compositeId);\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.COMPOSITE_COMPONENTS);\r\n\t\t\t\tthis.editorService.compositeComponentsChangedEvent.raise(currentProject.getCompositeComponents());\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate generateId(compositeComponent: string): string {\r\n\t\tconst newId = compositeComponent + this.idCounter++;\r\n\t\tconst compositeComponents = this.editorService.getCurrentProject().getCompositeComponents();\r\n\t\tfor (const i in compositeComponents) {\r\n\t\t\tif (compositeComponents[i].manifest.id === newId) {\r\n\t\t\t\treturn this.generateId(compositeComponent);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newId;\r\n\t}\r\n\r\n\tprivate getTranslation(languages: ILanguage[]): string {\r\n\t\tlet value: string;\r\n\t\tconst cut = 2;\r\n\t\tfor (let i = 0; i < languages.length; i++) {\r\n\t\t\tconst locale = languages[i].locale.substring(0, cut);\r\n\t\t\tconst currentLocale = this.translationManagementService.getSelectedLocale().substring(0, cut);\r\n\t\t\tif (locale === currentLocale) {\r\n\t\t\t\tvalue = languages[i].value;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn value ? value : languages[0].value; //default english\r\n\t}\r\n\r\n\tprivate addLanguagesFromComposite(languages: ILanguage[]): void {\r\n\t\tlanguages.forEach((language) => {\r\n\t\t\tif (!this.translationManagementService.projectHasLanguage(language.locale)) {\r\n\t\t\t\tthis.translationManagementService.addLanguage({ key: language.locale, value: \"\" });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tsetCurrentValuesToCurrentLanguage(composite: IJsonCompositeComponent): void {\r\n\t\tif (composite.translations) {\r\n\t\t\tthis.editorService.forEachComponent(composite.component, (childComponent) => {\r\n\t\t\t\tthis.editorService.forEachBindable(childComponent, (field) => {\r\n\t\t\t\t\tif (field.valueType === ValueTypeEnum.LOCALIZED_STRING) {\r\n\t\t\t\t\t\tconst componentTranslations = composite.translations[childComponent.id];\r\n\r\n\t\t\t\t\t\tcomponentTranslations.forEach((translation) => {\r\n\t\t\t\t\t\t\tif (field.ref === translation.property) {\r\n\t\t\t\t\t\t\t\tthis.addLanguagesFromComposite(translation.translations);\r\n\t\t\t\t\t\t\t\t(childComponent as any)[field.ref].value = this.getTranslation(translation.translations);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tswitch (childComponent.typedef) {\r\n\t\t\t\t\tcase Tabs.name:\r\n\t\t\t\t\t\tconst componentTranslations = composite.translations[childComponent.id];\r\n\t\t\t\t\t\t(childComponent as IJsonTabs).componentTabs.forEach((tab) => {\r\n\t\t\t\t\t\t\tcomponentTranslations.forEach((componentTranslation) => {\r\n\t\t\t\t\t\t\t\tif (tab.id === componentTranslation.property) {\r\n\t\t\t\t\t\t\t\t\ttab.name = this.getTranslation(componentTranslation.translations);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t// Add new cases\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.COMPOSITE_COMPONENT_MANAGEMENT_SERVICE, CompositeComponentManagementService);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { KeyCodeEnum } from \"../../../common/defines\";\r\nimport { Flexbox } from \"../../../components/flexbox/flexbox\";\r\nimport type { IEditorFlexbox } from \"../components/editor-flexbox\";\r\n\r\nimport { EditorHelper } from \"../helper\";\r\n\r\nimport { EditorService } from \"./editor-service\";\r\nimport { InsertComponentService } from \"./insert-component-service\";\r\nimport { UndoService } from \"./undo-service\";\r\n\r\nimport {\r\n\tCanvasModeEnum, CssConstantKeys, CssConstantValues, EventTypes, InjectNames,\r\n\tInsertEventTypes, SaveFlagsEnum\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\n\r\nexport class HotkeyService {\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.UNDO_SERVICE,\r\n\t\tInjectNames.INSERT_COMPONENT_SERVICE\r\n\t];\r\n\r\n\tprivate originalTranslations: IMap<IJsonLanguageComponent[]> = {};\r\n\tprivate oldToNewIdMap: IMap<string>;\r\n\r\n\tconstructor(\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate undoService: UndoService,\r\n\t\tprivate insertComponentService: InsertComponentService,\r\n\t) {\r\n\t\tthis.bindEvents();\r\n\t}\r\n\r\n\tprivate bindEvents(): void {\r\n\t\t// Put it on body to avoid sohos deletion of key-events on document\r\n\t\tangular.element(\"body\").on(EventTypes.KEYDOWN, this.onKeyDown.bind(this));\r\n\t\tangular.element(\"body\").on(EventTypes.KEYUP, this.onKeyUp.bind(this));\r\n\t}\r\n\r\n\tremoveClipboardComponentByUndoStack(): void {\r\n\t\tconst component = this.insertComponentService.getClipboardComponent();\r\n\t\tif (component) {\r\n\t\t\tconst currentUndoComponent = this.undoService.getCurrentUndo().stateRootComponent;\r\n\t\t\tthis.editorService.forEachComponent(currentUndoComponent, (subComponent) => {\r\n\t\t\t\tif (subComponent.id === component.id) {\r\n\t\t\t\t\tthis.insertComponentService.setClipboardComponent(null);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getSelectedText(): string {\r\n\t\treturn window.getSelection().toString();\r\n\t}\r\n\r\n\t// Add Canvaswide keylisteners for special functions\r\n\tprivate onKeyDown($event: JQueryEventObject): void {\r\n\t\tconst keyCode = $event.keyCode;\r\n\t\tconst altKey = $event.altKey;\r\n\t\tconst ctrlKey = $event.ctrlKey && !altKey;\r\n\t\tconst cmdKey = $event.metaKey;\r\n\t\tconst modifierKey = ctrlKey || cmdKey;\r\n\r\n\t\tif (keyCode === KeyCodeEnum.CTRL) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Take care of ESCAPE only if the editor is in finder mode.\r\n\t\t// Also raise an event for listeners to act upon.\r\n\t\tif (keyCode === KeyCodeEnum.ESCAPE) {\r\n\t\t\tswitch (this.editorService.getCanvasMode()) {\r\n\t\t\t\tcase CanvasModeEnum.FINDER:\r\n\t\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcase CanvasModeEnum.INSERT:\r\n\t\t\t\t\tthis.insertComponentService.cancelInserting();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t// Other canvasmodes\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst previewMode = keyCode === KeyCodeEnum.LESS_THAN && modifierKey;\r\n\t\tconst saveProject = keyCode === KeyCodeEnum.KEY_S && modifierKey;\r\n\t\tif (previewMode) {\r\n\t\t\t// Toggle preview mode\r\n\t\t\tif (this.editorService.getCanvasMode() === CanvasModeEnum.RUNTIME) {\r\n\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\t\t} else {\r\n\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.RUNTIME);\r\n\t\t\t}\r\n\t\t} else if (saveProject) {\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.PROJECT);\r\n\t\t\t$event.preventDefault();\r\n\t\t} else if (\r\n\t\t\tthis.getSelectedText() === \"\"\r\n\t\t\t&& $($event.target).prop(\"nodeName\") !== \"INPUT\"\r\n\t\t\t&& !this.isAnyModalOpen()\r\n\t\t) {\r\n\t\t\t// Clipboard overrides shall only run when no text is selected in the UI and no modal dialog are open\r\n\t\t\tif (this.editorService.isMovable()) {\r\n\t\t\t\t//check if current component is movable\r\n\t\t\t\tswitch (keyCode) {\r\n\t\t\t\t\tcase KeyCodeEnum.KEY_X: // cut\r\n\t\t\t\t\t\tif (modifierKey && this.editorService.canCut()) {\r\n\t\t\t\t\t\t\tthis.cutComponent($event);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase KeyCodeEnum.KEY_C: // copy\r\n\t\t\t\t\t\tif (modifierKey && this.editorService.canCopy()) {\r\n\t\t\t\t\t\t\tthis.copyComponent($event);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase KeyCodeEnum.DELETE:\r\n\t\t\t\t\t\tif (this.editorService.getSelectedComponent().canDelete()) {\r\n\t\t\t\t\t\t\tthis.deleteComponent();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t//\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (modifierKey) {\r\n\t\t\t\tswitch (keyCode) {\r\n\t\t\t\t\tcase KeyCodeEnum.KEY_Z: // Undo\r\n\t\t\t\t\t\tthis.removeClipboardComponentByUndoStack();\r\n\t\t\t\t\t\tthis.undoService.undoAction();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase KeyCodeEnum.KEY_Y: //Redo\r\n\t\t\t\t\t\tthis.undoService.redoAction();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase KeyCodeEnum.KEY_V: // Paste\r\n\t\t\t\t\t\tthis.pasteComponent();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t//\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onKeyUp($event: JQueryEventObject): void {\r\n\t\tif ($event.keyCode === KeyCodeEnum.KEY_C) {\r\n\t\t\tthis.editorService.multiInsert = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isAnyModalOpen(): boolean {\r\n\t\treturn $(\".modal\").length > 0;\r\n\t}\r\n\r\n\tcopyComponent($event?: JQueryEventObject): void {\r\n\t\tconst currentComponent = this.editorService.getSelectedComponent();\r\n\t\tif (currentComponent) {\r\n\t\t\tif ($event) {\r\n\t\t\t\t// If it was triggered through shortcut\r\n\t\t\t\t$event.preventDefault();\r\n\t\t\t}\r\n\t\t\tthis.oldToNewIdMap = {};\r\n\t\t\tconst component = this.editorService.copy(currentComponent.getDatabearer(), this.oldToNewIdMap);\r\n\t\t\tthis.originalTranslations = this.editorService.getTranslationsFromComponentTree(currentComponent.getDatabearer());\r\n\t\t\tthis.insertComponentService.setClipboardComponent(component);\r\n\t\t}\r\n\t}\r\n\r\n\tcutComponent($event?: JQueryEventObject): void {\r\n\t\tconst currentComponent = this.editorService.getSelectedComponent();\r\n\t\tif (currentComponent) {\r\n\t\t\tif ($event) {\r\n\t\t\t\t// If it was triggered through shortcut\r\n\t\t\t\t$event.preventDefault();\r\n\t\t\t}\r\n\r\n\t\t\tthis.editorService.deselectComponent();\r\n\t\t\tconst component = currentComponent.detach();\r\n\t\t\tEditorHelper.updateDOMTreeElement(component.id);\r\n\r\n\t\t\tthis.originalTranslations =\r\n\t\t\t\tangular.copy(this.editorService.getTranslationsFromComponentTree(currentComponent.getDatabearer()));\r\n\t\t\tconst project = this.editorService.getCurrentProject();\r\n\t\t\tcurrentComponent.forEachChild((childComponentInstance) => {\r\n\t\t\t\tconst childComponentId = childComponentInstance.getId();\r\n\t\t\t\tproject.removeTranslation(childComponentId);\r\n\t\t\t}, false);\r\n\r\n\t\t\tthis.insertComponentService.setClipboardComponent(component);\r\n\t\t\tthis.editorService.addUndoStack(project);\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.PROJECT);\r\n\t\t}\r\n\t}\r\n\r\n\tpasteComponent($event?: JQueryEventObject): void {\r\n\t\tconst component = this.insertComponentService.getClipboardComponent();\r\n\t\tif (component) {\r\n\t\t\tif ($event) {\r\n\t\t\t\t// If it was triggered through shortcut\r\n\t\t\t\t$event.preventDefault();\r\n\t\t\t}\r\n\t\t\tconst bodyElement = angular.element(\"body\");\r\n\t\t\tconst designerElement = angular.element(\"#designer\");\r\n\r\n\t\t\tbodyElement.css(CssConstantKeys.CURSOR, CssConstantValues.CURSOR_NODROP);\r\n\t\t\tconst bodyClickListener = () => {\r\n\t\t\t\tthis.insertComponentService.cancelInserting();\r\n\t\t\t};\r\n\t\t\tdesignerElement.on(EventTypes.CLICK, bodyClickListener);\r\n\t\t\tthis.insertComponentService.startInserting(component, InsertEventTypes.COPY).then((newParent: IEditorFlexbox) => {\r\n\t\t\t\tnewParent.newBoundaryEntered(this.editorService.getCurrentBoundary().id);\r\n\t\t\t\tthis.finishInsertComponent(component);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tdesignerElement.off(EventTypes.CLICK, bodyClickListener);\r\n\t\t\t\tbodyElement.css(CssConstantKeys.CURSOR, \"\");\r\n\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\r\n\t\t\t\tthis.oldToNewIdMap = {};\r\n\t\t\t\tthis.originalTranslations = this.editorService.getTranslationsFromComponentTree(component);\r\n\t\t\t\tconst nextCopy = this.editorService.copy(component, this.oldToNewIdMap);\r\n\t\t\t\tthis.insertComponentService.setClipboardComponent(nextCopy);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate finishInsertComponent(component: IJsonComponent): void {\r\n\t\tthis.editorService.copyTranslationsToCurrentProject(this.originalTranslations, this.oldToNewIdMap, component);\r\n\t\tthis.editorService.saveCanvas();\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.TRANSLATIONS);\r\n\t}\r\n\r\n\tdeleteComponent(): void {\r\n\t\tconst selectedComponent = this.editorService.getSelectedComponent();\r\n\t\tconst parent = selectedComponent.parent;\r\n\t\tif (selectedComponent && selectedComponent.canDelete()) {\r\n\t\t\t// Clean Interactions and translations related to component about to be deleted\r\n\t\t\tconst project = this.editorService.getCurrentProject();\r\n\t\t\tselectedComponent.forEachChild((childComponentInstance) => {\r\n\t\t\t\tconst childComponentId = childComponentInstance.getId();\r\n\t\t\t\tproject.interactions = project.getInteractions().filter((interaction) => {\r\n\t\t\t\t\treturn interaction.targetName !== childComponentId && interaction.sourceName !== childComponentId;\r\n\t\t\t\t});\r\n\t\t\t\tproject.removeTranslation(childComponentId);\r\n\t\t\t\tproject.removeExpression(childComponentId);\r\n\t\t\t}, false);\r\n\r\n\t\t\tparent.removeChild(selectedComponent.getId());\r\n\t\t\tthis.editorService.deselectComponent();\r\n\t\t\tEditorHelper.updateParentComponentSizeClass(parent);\r\n\t\t\tif (parent instanceof Flexbox) {\r\n\t\t\t\tparent.updateChildrenClasses();\r\n\t\t\t}\r\n\t\t\tthis.editorService.addUndoStack(project);\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.PROJECT);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.HOTKEY_SERVICE, HotkeyService);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { ReplaceEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../common/services/dialog-service\";\r\n\r\nexport interface IConflictChoice {\r\n\toption: ReplaceEnum;\r\n\tnewDisplayName: string;\r\n}\r\n\r\nexport interface IConflictDialogParameter {\r\n\tmessage: string;\r\n\toldDisplayName: string;\r\n\tnewDisplayName: string;\r\n\tnewDisplayNameOverwrite?: string;\r\n}\r\n\r\nexport class IdConflictCtrl {\r\n\tpublic ReplaceEnum = ReplaceEnum;\r\n\tpublic message: string;\r\n\tpublic option: ReplaceEnum;\r\n\tpublic newDisplayName: string;\r\n\tpublic newDisplayNameOverwrite: string;\r\n\tprivate dialog: IDialog<IConflictDialogParameter>;\r\n\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<IConflictDialogParameter>) {\r\n\t\tthis.dialog = scope.eirDialog;\r\n\t\tconst parameter = this.dialog.parameter;\r\n\t\tthis.message = parameter.message;\r\n\t\tthis.newDisplayName = parameter.newDisplayName;\r\n\t\tthis.newDisplayNameOverwrite = parameter.newDisplayNameOverwrite;\r\n\t\tthis.option = ReplaceEnum.OVERWRITE;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic import(): void {\r\n\t\tconst result: IDialogResult<IConflictChoice> = {\r\n\t\t\tvalue: {\r\n\t\t\t\toption: this.option,\r\n\t\t\t\tnewDisplayName: this.option === ReplaceEnum.COPYNEW ? this.newDisplayName : this.newDisplayNameOverwrite\r\n\t\t\t},\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirIdConflictCtrl\", IdConflictCtrl);\r\n\t}\r\n}\r\n","import {\r\n\tforkJoin,\r\n\tObservable,\r\n} from \"rxjs\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\n\r\nimport type { IComponent } from \"ng2/common/model/components/base/component.model\";\r\nimport type { ILayoutComponent } from \"ng2/common/model/components/base/layout-component.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nimport { BaseComponent } from \"ng2/components/base/component\";\r\n\r\nexport abstract class LayoutComponent\r\n\textends BaseComponent\r\n\timplements ILayoutComponent {\r\n\r\n\tabstract hasIndividualChildSizes: boolean;\r\n\tchildren: ILayoutComponent[] = [];\r\n\r\n\tonChildrenReady(): void {\r\n\t\tconsole.info(`ID: ${this.displayName}, TYPEDEF: ${this.typedef}: Children Ready`);\r\n\t\tthis.componentReady$.next(this);\r\n\t}\r\n\r\n\tabstract getPxPerPercentComponent(ori: OrientationEnum, percent: number): number;\r\n\r\n\tforEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void {\r\n\t\tsuper.forEachChild(fn, doGenerated);\r\n\r\n\t\tthis.children.forEach(child => {\r\n\t\t\tchild.forEachChild(fn, doGenerated);\r\n\t\t});\r\n\t}\r\n\r\n\tonBoundaryChange(boundary: IBoundary): Observable<any> {\r\n\t\tconst observers = [super.onBoundaryChange(boundary)];\r\n\r\n\t\tthis.children.forEach(child => observers.push(child.onBoundaryChange(boundary)));\r\n\r\n\t\t// TODO: fix so it maybe returns a BoundaryResponse?\r\n\t\treturn forkJoin(observers);\r\n\t}\r\n}\r\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 504;","import angular from \"angular\";\r\n\r\nimport { upgradeModule } from \"@uirouter/angular-hybrid\";\r\nimport uiRouter, { StateService } from \"@uirouter/angularjs\";\r\nimport { WSForm, WSUserControl } from \"etc-assets/user-control-es\";\r\n\r\nimport \"./app.less\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { Debugger } from \"common/debugger\";\r\nimport { Config, DeveloperConstants, Numbers } from \"ng2/common/constants/common.constant\";\r\nimport { appLauncherState } from \"../app-builder/app.states\";\r\nimport { AppState } from \"./app.state\";\r\n\r\n// Module Imports\r\nimport { idsAssetsModule } from \"../../modules/ids-assets/module\";\r\nimport { designerModule } from \"./designer/module\";\r\nimport { repositoryModule } from \"./designer/repository/module\";\r\nimport { runtimeModule } from \"./runtime/module\";\r\n\r\n// Service Imports\r\nimport { BindingManagementService } from \"./designer/editor/services/binding-management-service\";\r\nimport { BoundaryManagementService } from \"./designer/editor/services/boundary-management-service\";\r\nimport { CompositeComponentManagementService } from \"./designer/editor/services/composite-component-management-service\";\r\nimport { EditorService } from \"./designer/editor/services/editor-service\";\r\nimport { HotkeyService } from \"./designer/editor/services/hotkey-service\";\r\nimport { InsertComponentService } from \"./designer/editor/services/insert-component-service\";\r\nimport { InteractionManagementService } from \"./designer/editor/services/interaction-management-service\";\r\nimport { SaveService } from \"./designer/editor/services/save-service\";\r\nimport { UndoService } from \"./designer/editor/services/undo-service\";\r\n\r\n//#region Dashboard Imports\r\nimport { DashboardDirective } from \"./designer/dashboard/all-projects/dashboard\";\r\n\r\n// Conflict Handlers\r\nimport { DuplicateProjectCtrl } from \"./designer/dashboard/duplicate-dialog/duplicate-dialog\";\r\nimport { DisplayNameConflictCtrl } from \"./designer/dashboard/import-dialog/displayname-conflict-dialog\";\r\nimport { IdConflictCtrl } from \"./designer/dashboard/import-dialog/id-conflict-dialog\";\r\n\r\n// Dashboard Components\r\nimport { AllProjectsToolbarComponent } from \"./designer/dashboard/all-projects/all-projects-toolbar/all-projects-toolbar\";\r\nimport { ProjectCardComponent } from \"./designer/dashboard/all-projects/project-card/project-card\";\r\nimport { CreateProjectComponent } from \"./designer/dashboard/create-project/create-project\";\r\nimport { CreateToolbarComponent } from \"./designer/dashboard/create-project/create-toolbar/create-toolbar\";\r\n//#endregion\r\n\r\n// Designer Directives Imports\r\nimport { ComponentValueDirective } from \"./designer/component-value-directive\";\r\nimport { CanvasDirective } from \"./designer/editor/canvas/canvas\";\r\nimport { CanvasSliderDirective } from \"./designer/editor/canvas/canvas-slider\";\r\nimport { UrlSourceFieldDirective } from \"./designer/editor/component-settings/build-link-dialog/url-source-field/url-source-field\";\r\nimport { EditorDirective } from \"./designer/editor/editor\";\r\nimport { NewComponentDirective } from \"./designer/editor/new-component/component/new-component\";\r\nimport { NewCompositeDirective } from \"./designer/editor/new-component/composite/new-composite\";\r\nimport { NewComponentTabsDirective } from \"./designer/editor/new-component/new-component-tabs\";\r\nimport { RulerDirective } from \"./designer/editor/ruler/ruler\";\r\nimport { SelectionBoxDirective } from \"./designer/editor/selection-box/selection-box\";\r\nimport { StatusbarDirective } from \"./designer/editor/statusbar/statusbar\";\r\nimport { TopbarDirective } from \"./designer/editor/topbar/topbar\";\r\n\r\n// Wizard Imports\r\nimport {\r\n\tCompositeComponentWizardCtrl\r\n} from \"./designer/editor/new-component/composite/composite-component-wizard-ctrl\";\r\nimport { WizardDirective } from \"./designer/editor/wizard/wizard-ctrl\";\r\n\r\n// Settings Switcher Imports\r\nimport { GenericSettingsDirective } from \"./designer/editor/component-settings/generic-settings\";\r\nimport { SettingsDirective } from \"./designer/editor/component-settings/settings\";\r\n\r\n// SettingsDirectives Imports\r\nimport { BorderSettingsDirective } from \"./designer/editor/component-settings/setting-templates/border-setting\";\r\nimport { CheckboxSettingsDirective } from \"./designer/editor/component-settings/setting-templates/checkbox-setting\";\r\nimport { DropdownSettingsDirective } from \"./designer/editor/component-settings/setting-templates/dropdown-setting\";\r\nimport { MarginSettingsDirective } from \"./designer/editor/component-settings/setting-templates/margin-setting\";\r\nimport { RadiobuttonSettingsDirective } from \"./designer/editor/component-settings/setting-templates/radiobutton-setting\";\r\nimport { SwitchSettingsDirective } from \"./designer/editor/component-settings/setting-templates/switch-setting\";\r\nimport { TextSettingsDirective } from \"./designer/editor/component-settings/setting-templates/text-setting\";\r\n\r\nimport { AttributeSettingsDirective } from \"./designer/editor/component-settings/attribute-settings\";\r\nimport { SettingsSwitchers } from \"./designer/editor/component-settings/settings-switchers\";\r\nimport { ValuesourceSettingsDirective } from \"./designer/editor/component-settings/valuesource-settings/valuesource-settings\";\r\n\r\n// Interaction Settings Imports\r\nimport { InteractionSettingsCtrl } from \"./designer/editor/component-settings/interaction/interaction-settings\";\r\nimport { InteractionSettingsDirective } from \"./designer/editor/component-settings/interaction/interaction-settings\";\r\nimport { InteractionWizardCtrl } from \"./designer/editor/component-settings/interaction/interaction-wizard-ctrl\";\r\nimport { ParameterHandlerDirective } from \"./designer/editor/component-settings/interaction/parameter-handler\";\r\n\r\nimport { DeveloperToolComponent } from \"./common/dev/developer-tool-component\";\r\n\r\n// EditorComponents Imports\r\nimport { EditorButtonCtrl } from \"./designer/editor/components/editor-button\";\r\nimport { EditorChartCtrl } from \"./designer/editor/components/editor-chart\";\r\nimport { EditorCheckboxCtrl } from \"./designer/editor/components/editor-checkbox\";\r\nimport { EditorComponentCtrl, EditorComponentDirective } from \"./designer/editor/components/editor-component\";\r\nimport { EditorDatagridCtrl } from \"./designer/editor/components/editor-datagrid\";\r\nimport { EditorDatepickerCtrl } from \"./designer/editor/components/editor-datepicker\";\r\nimport { EditorDropdownCtrl } from \"./designer/editor/components/editor-dropdown\";\r\nimport { EditorFlexboxCtrl } from \"./designer/editor/components/editor-flexbox\";\r\nimport { EditorHyperlinkCtrl } from \"./designer/editor/components/editor-hyperlink\";\r\nimport { EditorImageCtrl } from \"./designer/editor/components/editor-image\";\r\nimport { EditorLabelCtrl } from \"./designer/editor/components/editor-label\";\r\nimport { EditorListCtrl } from \"./designer/editor/components/editor-list\";\r\nimport { EditorLookupCtrl } from \"./designer/editor/components/editor-lookup\";\r\nimport { EditorRadioButtonCtrl } from \"./designer/editor/components/editor-radiobutton\";\r\nimport { EditorTabPanelCtrl } from \"./designer/editor/components/editor-tabpanel\";\r\nimport { EditorTabsCtrl } from \"./designer/editor/components/editor-tabs\";\r\nimport { EditorTextAreaCtrl } from \"./designer/editor/components/editor-textarea\";\r\nimport { EditorTextboxCtrl } from \"./designer/editor/components/editor-textbox\";\r\nimport { EditorTimepickerCtrl } from \"./designer/editor/components/editor-timepicker\";\r\n\r\n// Controllers Imports\r\nimport { StandardBoundariesCtrl } from \"./designer/editor/canvas/standard-boundaries-dialog\";\r\nimport { CustomComponentCtrl } from \"./designer/editor/component-settings/custom/custom-component-ctrl\";\r\n\r\n// Setting Dialog Imports\r\nimport { BuildLinkCtrl } from \"./designer/editor/component-settings/build-link-dialog/build-link-dialog\";\r\nimport { ChartSettingsDialogCtrl } from \"./designer/editor/component-settings/chart/chart-settings-dialog\";\r\nimport { AutoAddColumnCtrl } from \"./designer/editor/component-settings/dialog/auto-add-columns-dialog\";\r\nimport { UpsertColumnCtrl } from \"./designer/editor/component-settings/dialog/upsert-column\";\r\nimport { EditExpressionDialogCtrl } from \"./designer/editor/component-settings/expression-dialog/edit-expression-dialog/edit-expression-dialog\";\r\nimport { ExpressionDialogCtrl } from \"./designer/editor/component-settings/expression-dialog/expression-dialog\";\r\nimport { ManageCompositesCtrl } from \"./designer/editor/component-settings/manage-dialogs/manage-composites-dialog\";\r\nimport { ManageDatasourcesCtrl } from \"./designer/editor/component-settings/manage-dialogs/manage-datasources-dialog\";\r\nimport { ManageRepositoryCtrl } from \"./designer/editor/component-settings/manage-dialogs/manage-repository-dialog/manage-repository-dialog\";\r\nimport { EditRadioButtonCtrl } from \"./designer/editor/component-settings/radiobutton/edit-radiobutton-dialog\";\r\nimport { EditTabCtrl } from \"./designer/editor/component-settings/tabs/edit-tab-dialog\";\r\nimport { MaskSettingsDialogCtrl } from \"./designer/editor/component-settings/textbox/mask-setting-dialog\";\r\nimport { EditBindingCtrl } from \"./designer/editor/component-settings/valuesource-settings/edit-binding-dialog\";\r\nimport { TranslationDialogCtrl } from \"./designer/editor/component-settings/valuesource-settings/translation-dialog\";\r\nimport { ProjectSettingsCtrl } from \"./designer/editor/project-settings/project-settings-dialog\";\r\nimport { BoundaryEditorCtrl } from \"./designer/editor/ruler/boundary-editor-dialog/boundary-editor-dialog\";\r\nimport { BaseDialogController } from \"./designer/editor/topbar/base-modal/base\";\r\nimport { UpsertQuestionDialogCtrl } from \"./designer/editor/topbar/base-modal/upsert-question-dialog/upsert-question-dialog\";\r\nimport { CopyFormDialogController } from \"./designer/editor/topbar/copy-form/copy-form\";\r\nimport { UrlVariableDialogCtrl } from \"./designer/editor/url-settings/url-variable-dialog-ctrl\";\r\n\r\nif (JENKINS_JOB) {\r\n\tconsole.debug(process.env.NODE_ENV);\r\n\r\n\t// Specifically so Jenkins' acc-test job can find jQuery\r\n\twindow.$ = jQuery;\r\n}\r\n\r\nexport const appBuilder = angular.module(\"app-builder\",\r\n\t[\r\n\t\tuiRouter,\r\n\t\tupgradeModule.name,\r\n\t\tidsAssetsModule.name,\r\n\t\tdesignerModule.name,\r\n\t\trepositoryModule.name,\r\n\t\truntimeModule.name,\r\n\t]);\r\n\r\nappBuilder.run([\r\n\tAngularConstants.STATE_SERVICE,\r\n\tAngularConstants.INTERVAL, (\r\n\t\t$state: StateService,\r\n\t\t$interval: ng.IIntervalService,\r\n\t) => {\r\n\t\tWSUserControl.onReady(() => {\r\n\t\t\tconst stop = $interval(() => {\r\n\t\t\t\tparent.MG.App.doUnloadPrompt = false;\r\n\t\t\t\tWSForm.getVarValue(\"InitURL\", (initUrl: string) => {\r\n\r\n\t\t\t\t\tconst prefix = \"run/\";\r\n\t\t\t\t\tconst isLaunchApp = initUrl !== \"\" && initUrl.indexOf(prefix) === 0;\r\n\t\t\t\t\tConfig.IS_FIRST_LOAD = false;\r\n\r\n\t\t\t\t\tif (Config.IS_CONFIG_LOADED) {\r\n\r\n\t\t\t\t\t\tif (isLaunchApp) {\r\n\t\t\t\t\t\t\tconst isLaunchWithAngular = Config.IS_DEV &&\r\n\t\t\t\t\t\t\t\tlocalStorage.getItem(DeveloperConstants.LAUNCH_WITH_ANGULAR) === \"true\";\r\n\t\t\t\t\t\t\tconst id = initUrl.slice(prefix.length);\r\n\r\n\t\t\t\t\t\t\tconst stateName = isLaunchWithAngular ?\r\n\t\t\t\t\t\t\t\tappLauncherState.name : AppState.APP_LAUNCHER.name;\r\n\t\t\t\t\t\t\tconst params = isLaunchWithAngular ?\r\n\t\t\t\t\t\t\t\t{ projectId: id } : { id };\r\n\r\n\t\t\t\t\t\t\t$state.go(stateName, params);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t$interval.cancel(stop);\r\n\t\t\t}, Numbers.HUNDRED);\r\n\t\t});\r\n\t}\r\n]);\r\n\r\nappBuilder.config([\r\n\t\"$qProvider\", \"$compileProvider\",\r\n\t(\r\n\t\t$qProvider: ng.IQProvider,\r\n\t\t$compileProvider: ng.ICompileProvider\r\n\t) => {\r\n\t\t$qProvider.errorOnUnhandledRejections(false);\r\n\t\t$compileProvider.debugInfoEnabled(Debugger.isEnabled());\r\n\t\t$compileProvider.commentDirectivesEnabled(false);\r\n\t\t$compileProvider.cssClassDirectivesEnabled(false);\r\n\t}\r\n]);\r\n\r\n// ui-router states\r\nAppState.add(appBuilder);\r\n\r\n// Services\r\nBindingManagementService.add(appBuilder);\r\nBoundaryManagementService.add(appBuilder);\r\nEditorService.add(appBuilder);\r\nHotkeyService.add(appBuilder);\r\nInsertComponentService.add(appBuilder);\r\nInteractionManagementService.add(appBuilder);\r\nCompositeComponentManagementService.add(appBuilder);\r\nUndoService.add(appBuilder);\r\nSaveService.add(appBuilder);\r\n\r\n//#region Dashboard\r\nDashboardDirective.add(appBuilder);\r\n\r\n// Conflict Handlers\r\nDuplicateProjectCtrl.add(appBuilder);\r\nDisplayNameConflictCtrl.add(appBuilder);\r\nIdConflictCtrl.add(appBuilder);\r\n\r\n// Components\r\nAllProjectsToolbarComponent.add(appBuilder);\r\nCreateProjectComponent.add(appBuilder);\r\nCreateToolbarComponent.add(appBuilder);\r\nProjectCardComponent.add(appBuilder);\r\n//#endregion\r\n\r\n// Designer Directives\r\nCanvasDirective.add(appBuilder);\r\nCanvasSliderDirective.add(appBuilder);\r\nComponentValueDirective.add(appBuilder); // TODO: Move this to components module\r\nEditorDirective.add(appBuilder);\r\nNewComponentDirective.add(appBuilder);\r\nNewComponentTabsDirective.add(appBuilder);\r\nNewCompositeDirective.add(appBuilder);\r\nRulerDirective.add(appBuilder);\r\nSelectionBoxDirective.add(appBuilder);\r\nStatusbarDirective.add(appBuilder);\r\nTopbarDirective.add(appBuilder);\r\nUrlSourceFieldDirective.add(appBuilder);\r\n\r\n// Wizards\r\nWizardDirective.add(appBuilder);\r\nCompositeComponentWizardCtrl.add(appBuilder);\r\n\r\n//#region Settings Switcher\r\nSettingsDirective.add(appBuilder);\r\nGenericSettingsDirective.add(appBuilder);\r\n\r\n// SettingsDirectives\r\nBorderSettingsDirective.add(appBuilder);\r\nCheckboxSettingsDirective.add(appBuilder);\r\nDropdownSettingsDirective.add(appBuilder);\r\nMarginSettingsDirective.add(appBuilder);\r\nRadiobuttonSettingsDirective.add(appBuilder);\r\nSwitchSettingsDirective.add(appBuilder);\r\nTextSettingsDirective.add(appBuilder);\r\n\r\nSettingsSwitchers.addComponentSettings(appBuilder);\r\nValuesourceSettingsDirective.add(appBuilder);\r\n\r\nAttributeSettingsDirective.add(appBuilder);\r\n\r\n// Interaction Setting\r\nInteractionSettingsDirective.add(appBuilder);\r\nParameterHandlerDirective.add(appBuilder);\r\n//#endregion\r\n\r\n// EditorComponents\r\nEditorComponentCtrl.add(appBuilder); // TODO: MUPS-2682: Verify if this is actually used directly\r\nEditorComponentDirective.add(appBuilder);\r\nEditorButtonCtrl.add(appBuilder);\r\nEditorChartCtrl.add(appBuilder);\r\nEditorCheckboxCtrl.add(appBuilder);\r\nEditorDatagridCtrl.add(appBuilder);\r\nEditorDatepickerCtrl.add(appBuilder);\r\nEditorDropdownCtrl.add(appBuilder);\r\nEditorFlexboxCtrl.add(appBuilder);\r\nEditorHyperlinkCtrl.add(appBuilder);\r\nEditorImageCtrl.add(appBuilder);\r\nEditorLabelCtrl.add(appBuilder);\r\nEditorListCtrl.add(appBuilder);\r\nEditorLookupCtrl.add(appBuilder);\r\nEditorRadioButtonCtrl.add(appBuilder);\r\nEditorTabPanelCtrl.add(appBuilder);\r\nEditorTabsCtrl.add(appBuilder);\r\nEditorTextAreaCtrl.add(appBuilder);\r\nEditorTextboxCtrl.add(appBuilder);\r\nEditorTimepickerCtrl.add(appBuilder);\r\n\r\n// Controllers\r\nCustomComponentCtrl.add(appBuilder);\r\nInteractionSettingsCtrl.add(appBuilder);\r\nInteractionWizardCtrl.add(appBuilder);\r\nStandardBoundariesCtrl.add(appBuilder);\r\n\r\n// Setting Dialogs\r\nAutoAddColumnCtrl.add(appBuilder); // used by lookup component\r\nBoundaryEditorCtrl.add(appBuilder);\r\nBuildLinkCtrl.add(appBuilder);\r\nChartSettingsDialogCtrl.add(appBuilder);\r\nCopyFormDialogController.add(appBuilder);\r\nUpsertQuestionDialogCtrl.add(appBuilder);\r\nBaseDialogController.add(appBuilder);\r\nEditBindingCtrl.add(appBuilder);\r\nEditRadioButtonCtrl.add(appBuilder);\r\nEditTabCtrl.add(appBuilder);\r\nEditExpressionDialogCtrl.add(appBuilder);\r\nExpressionDialogCtrl.add(appBuilder);\r\nManageDatasourcesCtrl.add(appBuilder);\r\nManageCompositesCtrl.add(appBuilder);\r\nManageRepositoryCtrl.add(appBuilder);\r\nMaskSettingsDialogCtrl.add(appBuilder);\r\nProjectSettingsCtrl.add(appBuilder);\r\nTranslationDialogCtrl.add(appBuilder);\r\nUpsertColumnCtrl.add(appBuilder); // used by lookup component\r\nUrlVariableDialogCtrl.add(appBuilder);\r\n\r\nDeveloperToolComponent.add(appBuilder);\r\n","import { StateParams } from \"@uirouter/angular\";\r\nimport { NgHybridStateDeclaration } from \"@uirouter/angular-hybrid\";\r\n\r\nimport { AppTypeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { StateNames } from \"ng2/common/constants/state-names.constant\";\r\n\r\nimport { AppLauncherHybridComponent } from \"ng2/app-launcher/app-launcher-hybrid.component\";\r\n\r\nexport const appLauncherState: NgHybridStateDeclaration = {\r\n\turl: \"/launch/:projectId\",\r\n\tname: StateNames.APP_LAUNCHER,\r\n\tcomponent: AppLauncherHybridComponent,\r\n\tresolve: {\r\n\t\tappType: (): AppTypeEnum => AppTypeEnum.DESIGNER_PREVIEW,\r\n\t\tprojectId: [\"$stateParams\", (\r\n\t\t\t$stateParams: StateParams\r\n\t\t): any => {\r\n\t\t\treturn $stateParams.projectId;\r\n\t\t}]\r\n\t}\r\n};\r\n\r\nexport const appStates = [appLauncherState];\r\n","import {\r\n\tComponent,\r\n\tInjector,\r\n\tHostListener,\r\n\tOnDestroy,\r\n\tOnInit,\r\n} from \"@angular/core\";\r\nimport {\r\n\tfrom,\r\n\tObservable,\r\n\tSubject\r\n} from \"rxjs\";\r\nimport { takeUntil } from \"rxjs/operators\";\r\n\r\nimport {\r\n\tAppTypeEnum,\r\n\tInjectNames\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { ErrorResponse } from \"common/error-response\";\r\nimport { AppLauncherBase } from \"ng2/app-launcher/app-launcher.base\";\r\nimport { RuntimeApp } from \"ng2/common/project/runtime-app\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\nimport { RuntimeService as ng2RuntimeService } from \"ng2/app-launcher/runtime-canvas/runtime.service\";\r\nimport { FrameworkService as ng2FrameworkService } from \"ng2/components/services/framework.service\";\r\nimport { RuntimeService } from \"runtime/runtime-service\";\r\n\r\n@Component({\r\n\tselector: \"ng2-app-launcher\",\r\n\ttemplate: `\r\n\t\t<ng2-runtime-canvas\r\n\t\t\t*ngIf=\"showMashup\"\r\n\t\t\t[app]=\"runtimeApp\"\r\n\t\t></ng2-runtime-canvas>\r\n\t`,\r\n})\r\nexport class AppLauncherHybridComponent\r\n\textends AppLauncherBase\r\n\timplements OnInit, OnDestroy {\r\n\r\n\tprivate ng1RuntimeService: RuntimeService;\r\n\tprivate ng1FrameworkService: FrameworkService;\r\n\tprivate unsubscribe: Subject<RuntimeApp> = new Subject<RuntimeApp>();\r\n\r\n\tconstructor(\r\n\t\tprotected frameworkService: ng2FrameworkService,\r\n\t\tprivate injector: Injector,\r\n\t) {\r\n\t\tsuper(frameworkService);\r\n\t}\r\n\r\n\tngOnInit(): void {\r\n\r\n\t\tif (HYBRID) {\r\n\r\n\t\t\tthis.setNg1Services();\r\n\t\t\tthis.loadNg1Project();\r\n\t\t} else {\r\n\t\t\t// Not HYBRID\r\n\t\t\tthis.runtimeApp = this.frameworkService.loadProject(null);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setNg1Services(): void {\r\n\t\tthis.ng1RuntimeService =\r\n\t\t\tthis.injector.get(InjectNames.RUNTIME_SERVICE);\r\n\r\n\t\tthis.ng1FrameworkService =\r\n\t\t\tthis.injector.get(InjectNames.FRAMEWORK_SERVICE);\r\n\t}\r\n\r\n\tprivate loadNg1Project(): void {\r\n\t\tconst self = this;\r\n\t\tif (this.appType && this.projectId) {\r\n\t\t\tthis.loadProject(self.projectId)\r\n\t\t\t\t.pipe(takeUntil(this.unsubscribe))\r\n\t\t\t\t.subscribe({\r\n\t\t\t\t\tnext(value: RuntimeApp): void {\r\n\t\t\t\t\t\tself.runtimeApp = value;\r\n\t\t\t\t\t\tself.setNg2FrameworkServiceProperties();\r\n\r\n\t\t\t\t\t\tself.showMashup = true;\r\n\t\t\t\t\t\t// this.initProjectUrlVariables(project);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\terror(error: ErrorResponse): void {\r\n\t\t\t\t\t\tconsole.error(\r\n\t\t\t\t\t\t\t`[AppLauncherComponent] Failed to load project with id: ${self.projectId}`);\r\n\t\t\t\t\t\t// this.dialogService.showError(\"Load Project Error\", error.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @summary Sets Properties from NG1 to NG2 FrameworkService.\r\n\t * @description\r\n\t * Method is used in Hybrid Mode to set properties to the Framework Service.\r\n\t * After App Launcher point only NG2 services are/should be used.\r\n\t *\r\n\t * @private\r\n\t * @memberof AppLauncherComponent\r\n\t */\r\n\tprivate setNg2FrameworkServiceProperties(): void {\r\n\t\tthis.frameworkService.currentBoundary =\r\n\t\t\tthis.ng1FrameworkService.getCurrentBoundary();\r\n\r\n\t\tthis.frameworkService.currentProject = this.runtimeApp;\r\n\t}\r\n\r\n\tngOnDestroy(): void {\r\n\t\tthis.unsubscribe.next();\r\n\t\tthis.unsubscribe.complete();\r\n\t}\r\n\r\n\tprivate loadProject(projectId: string): Observable<RuntimeApp> {\r\n\r\n\t\tlet promise: Promise<RuntimeApp>;\r\n\r\n\t\tconst observable = new Observable<RuntimeApp>(observer => {\r\n\t\t\tswitch (this.appType) {\r\n\t\t\t\tcase AppTypeEnum.ADMIN_PREVIEW:\r\n\t\t\t\t\tpromise = this.ng1RuntimeService\r\n\t\t\t\t\t\t.loadPublishedProjectNoConstraint(projectId, null) as Promise<RuntimeApp>;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase AppTypeEnum.RUNTIME:\r\n\t\t\t\tcase AppTypeEnum.APPHUB:\r\n\t\t\t\t\tobserver.next( null );\r\n\t\t\t\t\tpromise = this.ng1RuntimeService\r\n\t\t\t\t\t\t.loadPublishedProject(projectId, null) as Promise<RuntimeApp>;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase AppTypeEnum.DESIGNER_PREVIEW:\r\n\t\t\t\t\tpromise = this.ng1RuntimeService\r\n\t\t\t\t\t\t.loadRuntimeProject(projectId, null) as Promise<RuntimeApp>;\r\n\r\n\t\t\t\t\tfrom(promise).subscribe({\r\n\t\t\t\t\t\tnext(value: RuntimeApp): void {\r\n\t\t\t\t\t\t\tobserver.next(value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tobserver.error({\r\n\t\t\t\t\t\tmessage: \"Error\",\r\n\t\t\t\t\t\tdetail: \"Invalid appType: \" + this.appType\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn observable;\r\n\t}\r\n\r\n\t@HostListener(\"window:resize\", [\"$event\"])\r\n\tonResize(event: Event): void {\r\n\r\n\t\tconst width = (event.target as Window).innerWidth;\r\n\r\n\t\tthis.frameworkService.updateCurrentBoundary(width);\r\n\t}\r\n}\r\n","import { Input } from \"@angular/core\";\r\n\r\nimport type { RuntimeApp } from \"ng2/common/project/runtime-app\";\r\n\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\nexport class AppLauncherBase {\r\n\r\n\t@Input() appType?: string;\r\n\t@Input() projectId?: string;\r\n\r\n\tshowMashup = false;\r\n\truntimeApp: RuntimeApp;\r\n\r\n\tconstructor(\r\n\t\tprotected frameworkService: FrameworkService,\r\n\t) {\r\n\r\n\t}\r\n}\r\n","import { ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IRuntimeManifest } from \"ng2/common/model/project/mashup/runtime-manifest.model\";\r\n\r\nexport class RuntimeManifest implements IRuntimeManifest {\r\n\tid: string;\r\n\tcreatedBy: string;\r\n\tcreatedByDisplayName: string;\r\n\tcreatedTime: number;\r\n\tdescription: string;\r\n\tdisplayName: string;\r\n\tlastChangedBy: string;\r\n\tlastChangedByDisplayName: string;\r\n\tlastChangedTime: number;\r\n\turlName: string;\r\n\tversion: string;\r\n\tpreviewImg: string;\r\n\ttitle: string;\r\n\tstatus: number;\r\n\turlVariables: IJsonUrlVariable[];\r\n\tmashupBoundaries: IBoundary[];\r\n\tdefaultTheme: ThemeEnum;\r\n\tthemeSwitchEnabled: boolean;\r\n\tshowTitleBar: boolean;\r\n\r\n\tconstructor(arg1?: string | IJsonRuntimeManifest, arg2?: string) {\r\n\t\tif (!arg2 && arg1 && typeof arg1 === \"object\") {\r\n\t\t\tthis.id = arg1.id;\r\n\t\t\tthis.displayName = arg1.displayName;\r\n\t\t\tthis.createdBy = arg1.createdBy;\r\n\t\t\tthis.createdByDisplayName = arg1.createdByDisplayName;\r\n\t\t\tthis.createdTime = arg1.createdTime;\r\n\t\t\tthis.lastChangedBy = arg1.lastChangedBy;\r\n\t\t\tthis.lastChangedByDisplayName = arg1.lastChangedByDisplayName;\r\n\t\t\tthis.lastChangedTime = arg1.lastChangedTime;\r\n\t\t\tthis.version = arg1.version;\r\n\t\t\tthis.description = arg1.description;\r\n\t\t\tthis.previewImg = arg1.previewImg;\r\n\t\t\tthis.title = arg1.title;\r\n\t\t\tthis.urlName = arg1.urlName;\r\n\t\t\tthis.status = arg1.status;\r\n\t\t\tthis.urlVariables = arg1.urlVariables;\r\n\t\t\tthis.showTitleBar = arg1.showTitleBar;\r\n\t\t\tthis.themeSwitchEnabled = arg1.themeSwitchEnabled;\r\n\t\t\tthis.defaultTheme = arg1.defaultTheme;\r\n\t\t\tthis.mashupBoundaries = arg1.mashupBoundaries;\r\n\r\n\t\t} else if (arg1) {\r\n\t\t\tthis.id = (arg1 as string);\r\n\t\t\tthis.displayName = (arg1 as string);\r\n\t\t\tthis.description = arg2;\r\n\t\t\tthis.title = (arg1 as string);\r\n\t\t}\r\n\t}\r\n}\r\n","/**\r\n * Former component/helper.ts\r\n */\r\nimport { Injectable } from \"@angular/core\";\r\n\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\n\r\n@Injectable()\r\nexport class ComponentService {\r\n\r\n\t/**\r\n\t * * Get default component setting value on ref for setting category with title\r\n\t * @param settingCategories\r\n\t * @param title\r\n\t * @param ref\r\n\t */\r\n\tgetDefaultComponentSettingValue<T>(\r\n\t\tsettingCategories: IComponentSettingCategory[], ref: string, title: string\r\n\t): T {\r\n\t\tconst componentCategory =\r\n\t\t\tsettingCategories.find(category => category.title === title);\r\n\r\n\t\tlet componentFieldSetting: IComponentFieldSetting;\r\n\t\tif (componentCategory.settings.length > 0) {\r\n\t\t\tcomponentFieldSetting = componentCategory.settings.find(setting => setting.ref === ref);\r\n\t\t}\r\n\t\treturn componentFieldSetting.defaultValue;\r\n\t}\r\n}\r\n","import { HttpClient } from \"@angular/common/http\";\r\nimport { Injectable } from \"@angular/core\";\r\n\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\n\r\nimport type {\r\n\tIJsonDatasource,\r\n\tIJsonGenericDatasource2,\r\n} from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IDataService } from \"ng2/common/model/dataservice/data-service.model\";\r\n\r\nimport { Generic } from \"ng2/common/project/data-service/generic\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\n\r\n@Injectable()\r\nexport class DataServiceBuilder {\r\n\r\n\tconstructor(\r\n\t\tprivate http: HttpClient,\r\n\t\tprivate dynamicComponentService: DynamicComponentService,\r\n\t) {\r\n\r\n\t}\r\n\r\n\tcreate(rawJson: IJsonDatasource): IDataService {\r\n\r\n\t\tconst version = 2;\r\n\t\tconst isCorrectVersion = rawJson.version === version;\r\n\r\n\t\tif (isCorrectVersion) {\r\n\t\t\tconst generic2Databearer =\r\n\t\t\t\trawJson as IJsonGenericDatasource2;\r\n\r\n\t\t\tswitch (rawJson.typedef) {\r\n\t\t\t\tcase DatasourceTypeEnum.generic:\r\n\t\t\t\t\treturn new Generic(\r\n\t\t\t\t\t\tthis.http,\r\n\t\t\t\t\t\tthis.dynamicComponentService,\r\n\t\t\t\t\t\tgeneric2Databearer,\r\n\t\t\t\t\t) as any;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow Error(`Dataservice of type '${rawJson.typedef}' is not supported`);\r\n\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[Helper] Invalid typedef on \", rawJson);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IJsonInteractionParameter } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IAvailableTargetField } from \"ng2/common/model/interaction/available-target-field.model\";\r\nexport interface IInteractionParameter {\r\n\ttargetKey: string;\r\n\tvalueSource: IJsonValueSource;\r\n\tgetDatabearer: () => IJsonInteractionParameter;\r\n\ttargetField?: IAvailableTargetField;\r\n}\r\n","import { IJsonCustomComponentDefinition } from \"ng2/common/model/databearer/components/json-custom-component-def.model\";\r\n\r\nexport interface ICustomComponentDefinition extends IJsonCustomComponentDefinition { }\r\n","import { IJsonFileMetaData } from \"ng2/common/model/databearer/json-manifest.model\";\r\n\r\nexport class FileMetaData implements IJsonFileMetaData {\r\n\tmimeType: string;\r\n\tvisibleName: string;\r\n\r\n\tconstructor(visibleName: string, mimeType: string) {\r\n\t\tthis.mimeType = mimeType;\r\n\t\tthis.visibleName = visibleName;\r\n\t}\r\n}\r\n","import { IJsonDesignerManifest, IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\n\r\nexport interface IDesignerManifest extends IJsonDesignerManifest {\r\n\tsetHasFile(fileKey: string, mimeType: string, visibleName: string): void;\r\n\tupdateLastChangedInformation(newManifest: IJsonManifest): void;\r\n}\r\n","import type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tButtonStyle,\r\n\tInteractionPairOperation,\r\n\tInteractionTriggerEnum,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonButton } from \"ng2/common/model/databearer/components/json-button.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport class Button extends Component {\r\n\tstatic availableButtonStyles: IDataPair[] = [\r\n\t\t{ name: \"Primary\", value: ButtonStyle.PRIMARY },\r\n\t\t{ name: \"Secondary\", value: ButtonStyle.SECONDARY },\r\n\t\t{ name: \"Transparent\", value: ButtonStyle.TERTIARY },\r\n\t\t{ name: \"Fill\", value: ButtonStyle.FILL }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CLICK]);\r\n\tstatic TARGET_ACTIONS = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_CLICK;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Content\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"Action\" }\r\n\t}];\r\n\tstatic SETTING_FIELDS =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\tref: SettingKeys.STYLE,\r\n\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\tdataset: Button.availableButtonStyles,\r\n\t\t\tdefaultValue: ButtonStyle.PRIMARY\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Disabled\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false,\r\n\t\t\tbutton: {\r\n\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\tdialog: true\r\n\t\t\t},\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tcontent: string;\r\n\tstyle: string;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonButton,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.style = BackwardCompatible.tryUpdateButtonStyle(obj);\r\n\t}\r\n\r\n\tclick(): void {\r\n\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./button.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import {\r\n\tInteractionPairOperation, InteractionTriggerEnum,\r\n\tSettingInputKeys, SettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { IJsonCheckbox } from \"../../common/model/component/checkbox.model\";\r\nimport { Component } from \"../component\";\r\n\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class Checkbox extends Component {\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] =\r\n\t\tInteractionDefines.SOURCE_TRIGGERS.concat([\r\n\t\t\tInteractionPairOperation.IS_CHECKED,\r\n\t\t\tInteractionPairOperation.IS_UNCHECKED\r\n\t\t]);\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.IS_CHECKED;\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tpublic static SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Disabled\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false,\r\n\t\t\tbutton: {\r\n\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\tdialog: true\r\n\t\t\t}\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Content\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"Checkbox\" }\r\n\t},\r\n\t{\r\n\t\tname: \"State\",\r\n\t\tref: SettingKeys.CHECK_STATE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: false }\r\n\t}\r\n\t];\r\n\tpublic checkboxState: boolean = false;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonCheckbox,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t}\r\n\r\n\tpublic checked(): void {\r\n\t\t// Timeout needed or else it will be wrong state\r\n\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\tif (this.checkboxState) {\r\n\t\t\t\tthis.trigger(InteractionTriggerEnum.CHECKED);\r\n\t\t\t} else {\r\n\t\t\t\tthis.trigger(InteractionTriggerEnum.UNCHECKED);\r\n\t\t\t}\r\n\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setBindableValue(bindableReference: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\tif (bindableReference === SettingKeys.CHECK_STATE) {\r\n\t\t\tthis.checkboxState = this.isChecked(value);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clear(): void {\r\n\t\tthis.checkboxState = false;\r\n\t}\r\n\r\n\tprivate isChecked(value: string | boolean | number): boolean {\r\n\t\treturn (value === \"1\" || value === true || value === 1 || value === \"true\");\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./checkbox.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import { Component } from \"../component\";\r\n\r\nimport {\r\n\tDateFormat,\r\n\tInteractionPairOperation,\r\n\tInteractionTriggerEnum,\r\n\tNumbers,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { IComponentScope } from \"../../common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { IJsonDatepicker } from \"../../common/model/component/datepicker.model\";\r\nimport { IDatepickerApi, IDatePickerOptions } from \"../../common/model/sohoxi/sohoxi-datepicker.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class Datepicker extends Component {\r\n\tstatic availableDateFormats: IDataPair[] = [\r\n\t\t{ name: `${DateFormat.FORMAT_1}`, value: DateFormat.FORMAT_1 },\r\n\t\t{ name: `${DateFormat.FORMAT_2}`, value: DateFormat.FORMAT_2 },\r\n\t\t{ name: `${DateFormat.FORMAT_3}`, value: DateFormat.FORMAT_3 },\r\n\t\t{ name: `ISO8601: ${DateFormat.ISO8601}`, value: DateFormat.ISO8601 },\r\n\t\t{ name: `M3: ${DateFormat.M3}`, value: DateFormat.M3 }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS =\r\n\t\tInteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CHANGED]);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER = InteractionPairOperation.ON_CHANGED;\r\n\tstatic DEFAULT_ACTION = InteractionPairOperation.GET;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t[\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Date Formats\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"To display\",\r\n\t\t\t\t\tref: SettingKeys.DATE_FORMAT_SHOW,\r\n\t\t\t\t\tdataset: Datepicker.availableDateFormats,\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: DateFormat.FORMAT_1\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"For bindings (outbound)\",\r\n\t\t\t\t\tref: SettingKeys.DATE_FORMAT_BINDING,\r\n\t\t\t\t\tdataset: Datepicker.availableDateFormats.concat([\r\n\t\t\t\t\t\t{ name: \"Raw timestamp\", value: DateFormat.RAW }\r\n\t\t\t\t\t]),\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: DateFormat.FORMAT_1\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"For bindings (inbound)\",\r\n\t\t\t\t\tref: SettingKeys.DATE_FORMAT_INPUT,\r\n\t\t\t\t\tdataset: [{ name: \"Automatic\", value: DateFormat.AUTOMATIC }].concat(\r\n\t\t\t\t\t\tDatepicker.availableDateFormats\r\n\t\t\t\t\t),\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: DateFormat.AUTOMATIC\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Default Date\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Today's date\",\r\n\t\t\t\t\tref: SettingKeys.DATE_TODAY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t...Component.SETTING_FIELDS\r\n\t\t];\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Date\",\r\n\t\tref: SettingKeys.DATE_VALUE,\r\n\t\tvalueType: ValueTypeEnum.STRING, // Ideally this would be type DATE\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Formatted date\",\r\n\t\tref: SettingKeys.DATE_FORMATTED,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\r\n\tstatic MAX_TIMESTAMP = 8640000000000000;\r\n\tstatic MIN_TIMESTAMP = -8640000000000000;\r\n\r\n\t// Variables set from binding framework\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tdateValue: Date | null;\r\n\tdateFormatted: string = \"\";\r\n\r\n\t// Variables set from settings framework\r\n\tdateFormatShow: string;\r\n\tdateFormatBinding: string;\r\n\tdateFormatInput: string;\r\n\tisDefaultTodayDate: boolean;\r\n\r\n\t// Variables used in template\r\n\tdatepickerOptions: IDatePickerOptions;\r\n\r\n\tdatePickerApi: IDatepickerApi;\r\n\tisStaticSet: boolean;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonDatepicker,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tthis.dateFormatShow = obj.dateFormatShow;\r\n\t\tthis.dateFormatBinding = obj.dateFormatBinding;\r\n\t\tthis.dateFormatInput = obj.dateFormatInput;\r\n\t\tthis.isDefaultTodayDate = obj.isDefaultTodayDate;\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\r\n\t\tthis.setDatepickerOptions();\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t}\r\n\r\n\tsetDatepickerOptions(): void {\r\n\t\tthis.datepickerOptions = {\r\n\t\t\tdateFormat: this.dateFormatShow,\r\n\t\t\tplaceholder: true\r\n\t\t};\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.getSohoXiApi().setValue(undefined, true);\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, value: any): void {\r\n\t\tif (bindableReference === SettingKeys.DATE_VALUE) {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t\tif (value === \"\") {\r\n\t\t\t\tthis.isStaticSet = false;\r\n\t\t\t\tthis.updateDatepickerValue();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst newDate = this.parseDate(value);\r\n\t\t\tif (DateHelper.isValidDate(newDate)) {\r\n\t\t\t\tthis.isStaticSet = true;\r\n\t\t\t\tthis.updateDatepickerValue(newDate);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setErrorTooltip(`Invalid date: '${value}'`);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set dateValue to newDate, or clear dateValue if newDate is falsy\r\n\t * @param newDate The new date to set, should already be valid.\r\n\t */\r\n\tsetDateValue(newDate?: Date): void {\r\n\t\tif (newDate) {\r\n\t\t\tthis.dateValue = newDate;\r\n\t\t\tif (this.dateFormatBinding === DateFormat.RAW) {\r\n\t\t\t\t// Keeping string format, change when we specially handle different value types in binding framework\r\n\t\t\t\tthis.dateFormatted = this.dateValue.getTime().toString();\r\n\t\t\t} else {\r\n\t\t\t\tthis.dateFormatted = Soho.Locale.formatDate(this.dateValue, { pattern: this.dateFormatBinding });\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.dateValue = undefined;\r\n\t\t\tthis.dateFormatted = \"\";\r\n\t\t}\r\n\t\tthis.onUpdateValue();\r\n\t}\r\n\r\n\tupdateDatepickerValue(newDate?: Date): void {\r\n\t\tconst datepickerApi = this.getSohoXiApi();\r\n\t\tdatepickerApi.settings.dateFormat = this.datepickerOptions.dateFormat;\r\n\t\tdatepickerApi.pattern = this.datepickerOptions.dateFormat;\r\n\t\tif (this.isStaticSet) {\r\n\t\t\tconst value = newDate ? newDate : this.dateValue;\r\n\t\t\tdatepickerApi.setValue(value, true);\r\n\t\t} else if (this.isDefaultTodayDate) {\r\n\t\t\tdatepickerApi.setToday();\r\n\t\t} else {\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeDatepicker(): void {\r\n\t\tconst datepickerApi = this.getSohoXiApi();\r\n\t\tthis.updateDatepickerReadonlyValue();\r\n\t\tdatepickerApi.element.on(\"change\", () => {\r\n\t\t\t// Parsing date because soho is not updating the currentDate when editing the field\r\n\t\t\tconst newDate = Soho.Locale.parseDate(datepickerApi.element.val().toString(), this.dateFormatShow);\r\n\t\t\tif (newDate) { // If not valid date soho will show invalid date error\r\n\t\t\t\tthis.setDateValue(newDate);\r\n\t\t\t\tthis.frameworkService.trigger(this, InteractionTriggerEnum.CHANGED);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setDateValue();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdatepickerApi.element.on(\"listopened\", () => {\r\n\t\t\tthis.addPreventDefault();\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Really nasty fix for interupting href in anchor tags.\r\n\t * Remove this when IDS has an update on\r\n\t * Solved in IDS 4.21\r\n\t */\r\n\tprivate addPreventDefault(): void {\r\n\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\tconst ulPath = \".picklist-section.is-year ul \";\r\n\t\t\t$(ulPath + \"li a\").click((e: any) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t});\r\n\t\t\t$(ulPath + \".up,\" + ulPath + \".down\").click((e: any) => {\r\n\t\t\t\tthis.addPreventDefault();\r\n\t\t\t});\r\n\t\t}, Numbers.THREE_HUNDRED);\r\n\t}\r\n\r\n\tupdateDatepickerReadonlyValue(): void {\r\n\t\tconst datepickerApi = this.getSohoXiApi();\r\n\t\tif (this.isReadonly) {\r\n\t\t\tdatepickerApi.readonly();\r\n\t\t} else {\r\n\t\t\tdatepickerApi.enable();\r\n\t\t}\r\n\t}\r\n\r\n\tgetSohoXiApi(): IDatepickerApi {\r\n\t\tif (!this.datePickerApi) {\r\n\t\t\tthis.datePickerApi = this.element.find(\"> div > input\").data(\"datepicker\");\r\n\t\t}\r\n\t\treturn this.datePickerApi;\r\n\t}\r\n\r\n\tprivate parseDate(value: any): Date | null {\r\n\t\tlet newDate: Date = null;\r\n\t\tif (typeof value === \"string\" && this.dateFormatInput !== DateFormat.AUTOMATIC) {\r\n\t\t\tnewDate = Soho.Locale.parseDate(value, this.dateFormatInput);\r\n\t\t} else { // DateFormat.AUTOMATIC\r\n\t\t\tnewDate = this.parseDateFormatAutomatic(value);\r\n\t\t}\r\n\t\treturn newDate;\r\n\t}\r\n\r\n\tprivate parseDateFormatAutomatic(value: any): Date {\r\n\t\tconst timestamp = new Date(value);\r\n\r\n\t\tif (!DateHelper.isValidDate(timestamp)) {\r\n\t\t\tconst milliseconds = DateHelper\r\n\t\t\t\t.parse(value)\r\n\t\t\t\t.getTime();\r\n\r\n\t\t\tif (!isNaN(milliseconds) &&\r\n\t\t\t\tDateHelper.isValidMillisecondTimestamp(milliseconds)\r\n\t\t\t) {\r\n\t\t\t\treturn new Date(milliseconds);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn timestamp;\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./datepicker.html\"),\r\n\t\t\treplace: true,\r\n\t\t\tlink: ($scope: IComponentScope, $element: ng.IAugmentedJQuery, $attrs: ng.IAttributes) => {\r\n\t\t\t\tconst componentInstance = $scope.componentInstance as Datepicker;\r\n\r\n\t\t\t\t$($element[0]).initialize(\"en-US\");\r\n\t\t\t\tcomponentInstance.initializeDatepicker();\r\n\r\n\t\t\t\t$scope.componentReady({ componentInstance: $scope.componentInstance });\r\n\t\t\t}\r\n\t\t};\r\n\t}];\r\n}\r\n","import {\r\n\tInteractionPairOperation, SettingInputKeys, SettingKeys,\r\n\tSidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { IJsonTextArea } from \"../../common/model/component/textarea.model\";\r\nimport { ITextAreaOptions } from \"../../common/model/sohoxi/sohoxi-textarea.model\";\r\nimport { Component } from \"../component\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class TextArea extends Component {\r\n\tpublic static readonly DEFAULT_MAX_LENGTH: number = 2000;\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tpublic static SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([\r\n\t\t{\r\n\t\t\ttitle: \"Character Limit\",\r\n\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Value\",\r\n\t\t\t\t\tref: SettingKeys.MAX_LENGTH,\r\n\t\t\t\t\tinputType: SettingInputKeys.NUMBER,\r\n\t\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Style\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Resizable\",\r\n\t\t\t\tref: SettingKeys.IS_RESIZABLE,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false\r\n\t\t\t}]\r\n\t\t}\r\n\t] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Text\",\r\n\t\tref: SettingKeys.TEXT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Placeholder\",\r\n\t\tref: SettingKeys.PLACEHOLDER,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tpublic text: string;\r\n\tpublic label: string;\r\n\tpublic placeholder: string;\r\n\tpublic showLabel: boolean;\r\n\tpublic resizable: boolean;\r\n\tpublic maxLength: number;\r\n\tpublic textareaOptions: ITextAreaOptions;\r\n\tprotected databearer: IJsonTextArea;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTextArea,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\tthis.resizable = obj.resizable;\r\n\t\tthis.maxLength = obj.maxLength;\r\n\t\tthis.updateMaxLength();\r\n\t}\r\n\r\n\tpublic newBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t}\r\n\r\n\tpublic clear(): void {\r\n\t\tthis.text = \"\";\r\n\t}\r\n\r\n\tpublic updateMaxLength(): void {\r\n\t\tthis.textareaOptions = {\r\n\t\t\tcharacterCounter: this.maxLength ? true : false,\r\n\t\t\tmaxLength: this.maxLength ? this.maxLength : TextArea.DEFAULT_MAX_LENGTH,\r\n\t\t\tcharRemainingText: \"Characters left: {0}\"\r\n\t\t};\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./textarea.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import {\r\n\tIJsonComponent,\r\n\tIJsonComponentSettings\r\n} from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonTextBox extends IJsonComponent {\r\n\ttext: IJsonValueSource;\r\n\tlabel: IJsonValueSource;\r\n\tplaceholder: IJsonValueSource;\r\n\tshowLabel: IJsonValueSource; // Deprecated\r\n\tmask: IJSonMaskSettings;\r\n\tboundarySettings: IMap<IJsonTextBoxSettings>;\r\n}\r\n\r\nexport interface IJsonTextBoxSettings extends IJsonComponentSettings {\r\n\tboxWidth: string;\r\n\tshowLabel: boolean;\r\n}\r\n\r\nexport interface IJSonMaskSettings {\r\n\tprocess: string;\r\n\tallowNegative?: boolean;\r\n\tintegerLimit?: number;\r\n\tdecimalLimit?: number;\r\n\tallowThousandsSeparator?: boolean;\r\n\tprefix?: string;\r\n\tformat?: string; //for date & string\r\n}\r\n","import { Component } from \"../component\";\r\n\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport { DEFAULT_BOUNDARY, HourMode, InteractionPairOperation, InteractionTriggerEnum, RegexStrings, SettingInputKeys, SettingKeys, SidebarTabTypes } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IJsonTimepicker } from \"common/model/component/timepicker.model\";\r\n\r\nimport type { ITimepickerApi, ITimePickerOptions } from \"common/model/sohoxi/sohoxi-timepicker.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport type { IComponentScope } from \"common/interface/icomponent-scope\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\n\r\nexport class Timepicker extends Component {\r\n\tstatic minuteInterval = 1;\r\n\tstatic secondInterval = 1;\r\n\tstatic availableHourMode: IDataPair[] = [\r\n\t\t{ name: \"12-hour\", value: HourMode.TWELVE },\r\n\t\t{ name: \"24-hour\", value: HourMode.TWENTYFOUR }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CHANGED]);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER = InteractionPairOperation.ON_CHANGED;\r\n\tstatic DEFAULT_ACTION = InteractionPairOperation.GET;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t[\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Format\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Time Format\",\r\n\t\t\t\t\t\tref: SettingKeys.TIME_FORMAT,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\t\tdataset: Timepicker.availableHourMode,\r\n\t\t\t\t\t\tdefaultValue: HourMode.TWENTYFOUR,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Enable Seconds\",\r\n\t\t\t\t\t\tref: SettingKeys.ENABLE_SECONDS,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\t...Component.SETTING_FIELDS\r\n\t\t];\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [\r\n\t\t{\r\n\t\t\tname: \"Label\",\r\n\t\t\tref: SettingKeys.LABEL,\r\n\t\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\t\twrite: true,\r\n\t\t\tread: false,\r\n\t\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"Time\",\r\n\t\t\tref: SettingKeys.TIME_VALUE,\r\n\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\twrite: true,\r\n\t\t\tread: true,\r\n\t\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t\t}\r\n\t];\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\ttimeFormat: string;\r\n\tenableSeconds: boolean;\r\n\tisReadonly: boolean;\r\n\r\n\ttimeValue: string;\r\n\r\n\tformatString: string;\r\n\ttimepickerOptions: ITimePickerOptions;\r\n\ttimepickerApi: ITimepickerApi;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTimepicker,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tthis.enableSeconds = obj.enableSeconds;\r\n\t\tthis.isReadonly = obj.isReadonly;\r\n\t\tthis.timeFormat = obj.timeFormat;\r\n\t\tthis.formatString = this.timeFormat;\r\n\t\tthis.showLabel = obj.boundarySettings[DEFAULT_BOUNDARY.id].showLabel;\r\n\t}\r\n\r\n\tinit(): void {\r\n\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\tthis.updateReadonly();\r\n\t\t\tthis.setSeconds();\r\n\t\t\tconst timepickerApi = this.getSohoXiApi();\r\n\t\t\ttimepickerApi.element.on(\"change\", () => {\r\n\t\t\t\tthis.timeValue = timepickerApi.value(false);\r\n\t\t\t\tthis.frameworkService.trigger(this, InteractionTriggerEnum.CHANGED);\r\n\t\t\t});\r\n\t\t\tthis.setTimepickerOptions();\r\n\t\t});\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, value: any): void {\r\n\t\tif (bindableReference === SettingKeys.TIME_VALUE) {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t\tif (!value) {\r\n\t\t\t\tthis.clear();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst upperCaseTime = (value as string).toUpperCase();\r\n\t\t\tif (this.isValidTime(upperCaseTime)) {\r\n\t\t\t\tthis.setTime(upperCaseTime);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setErrorTooltip(`Invalid time: '${value}'`);\r\n\t\t\t\tthis.clear();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\t}\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t}\r\n\r\n\tgetSohoXiApi(): ITimepickerApi {\r\n\t\tif (!this.timepickerApi) {\r\n\t\t\tthis.timepickerApi = this.element.find(`#time-field-${this.getId()}`).data(\"timepicker\");\r\n\t\t}\r\n\t\treturn this.timepickerApi;\r\n\t}\r\n\r\n\trefreshTimepicker(): void {\r\n\t\tthis.updateReadonly();\r\n\t\tthis.setSeconds();\r\n\t\tthis.setTimepickerOptions();\r\n\t\tthis.setTime($(`#time-field-${this.getId()}`).val() as string);\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.setTime(\"\");\r\n\t}\r\n\r\n\tprivate setTimepickerOptions(): void {\r\n\t\tthis.timepickerOptions = {\r\n\t\t\ttimeFormat: this.formatString,\r\n\t\t\tminuteInterval: Timepicker.minuteInterval,\r\n\t\t\tsecondInterval: Timepicker.secondInterval,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate setTime(time: string): void {\r\n\t\tconst field = $(`#time-field-${this.getId()}`);\r\n\t\tlet finalTime: string;\r\n\r\n\t\tif (time) {\r\n\t\t\t// Extract time stamp from dummy date\r\n\t\t\tfinalTime = Soho.Locale.formatDate(new Date(`2021-01-01 ${time}`), { pattern: this.formatString });\r\n\t\t} else {\r\n\t\t\tfinalTime = \"\";\r\n\t\t}\r\n\r\n\t\tfield.val(finalTime);\r\n\t\tthis.timeValue = finalTime;\r\n\t}\r\n\r\n\tprivate setSeconds(): void {\r\n\t\tif (this.enableSeconds) {\r\n\t\t\tthis.formatString = this.timeFormat.replace(\":mm\", \":mm:ss\");\r\n\t\t} else {\r\n\t\t\tthis.formatString = this.timeFormat;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateReadonly(): void {\r\n\t\tconst timepickerApi = this.getSohoXiApi();\r\n\t\tif (this.isReadonly) {\r\n\t\t\ttimepickerApi.readonly();\r\n\t\t} else {\r\n\t\t\ttimepickerApi.enable();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isValidTime(time: string): boolean {\r\n\t\treturn RegexStrings.TIME.test(time);\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./timepicker.html\"),\r\n\t\t\treplace: true,\r\n\t\t\tlink: ($scope: IComponentScope) => {\r\n\t\t\t\tconst componentInstance = $scope.componentInstance as Timepicker;\r\n\t\t\t\tcomponentInstance.init();\r\n\t\t\t\t$scope.componentReady({ componentInstance: $scope.componentInstance });\r\n\t\t\t}\r\n\t\t};\r\n\t}];\r\n}\r\n","import { IRequestConfig } from \"./request-config.model\";\r\n\r\nexport interface IIonApiRequestOptions extends IRequestConfig {\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if a request should be retried\r\n\t * if the ION API returns a 401 HTTP response code.\r\n\t *\r\n\t * A 401 response code usually means that the OAuth token has expired and must be renewed.\r\n\t * A 401 response code could also mean that the user cannot be authorized at all.\r\n\t *\r\n\t * The default value is true.\r\n\t */\r\n\tionApiRetry?: boolean;\r\n\r\n\t/**\r\n\t * Indicates whether tenant should be prepended to the request URL.\r\n\t */\r\n\tsetTenant?: boolean;\r\n}\r\n\r\nexport interface IIonApiOptions {\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if the ION API token should be refreshed or not.\r\n\t *\r\n\t * The default value is false. This property should only be set to true if the current token is invalid.\r\n\t * An ION API call will return HTTP 401 when the token is invalid.\r\n\t */\r\n\trefresh?: boolean;\r\n}\r\n\r\nexport interface IIonApiContext {\r\n\t/**\r\n\t * Gets the ION API base URL.\r\n\t * @return a URL\r\n\t */\r\n\tgetUrl(setTenant?: boolean): string;\r\n\r\n\t/**\r\n\t * Gets an OAUth token.\r\n\t *\r\n\t * The OAuth token must be provided in an Authorization header for each ION API call.\r\n\t * @return an OAuth token\r\n\t */\r\n\tgetToken(): string;\r\n\r\n\t/**\r\n\t * Gets the name of the HTTP Authorization header (Authorization).\r\n\t * @return the authorization header name\r\n\t */\r\n\tgetHeaderName(): string;\r\n\r\n\t/**\r\n\t * Gets the value for the HTTP authorization header including the OAuth token.\r\n\t *\r\n\t * The returned value is an Authorization Request Header Field for an OAuth 2.0 Bearar Token\r\n\t * according to https://tools.ietf.org/html/rfc6750#section-2.1\r\n\t *\r\n\t * Example return value: \"Bearer yg06wrbaBoutluM8Rdb9v4YH0ztx\"\r\n\t *\r\n\t * @return the authorization header value\r\n\t */\r\n\tgetHeaderValue(): string;\r\n}\r\n\r\nexport interface IIonApiCall {\r\n\trelativeUrl: string;\r\n\trequestBody: string;\r\n}\r\n","import jsonpath from \"jsonpath\";\r\nimport isArray from \"lodash-es/isArray\";\r\n\r\nimport { Subcodes } from \"ng2/common/constants/common.constant\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { ErrorResponse, IErrorResponse } from \"../../error-response\";\r\nimport { Datasource } from \"./datasource\";\r\n\r\nimport { DataServiceHelper } from \"ng2/common/helpers/data-service.helper\";\r\nimport { JsonHelper } from \"ng2/common/helpers/json.helper\";\r\nimport { DatasourceService } from \"../../../components/services/datasource-service\";\r\nimport { Helper } from \"../../helper\";\r\nimport { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\n\r\ninterface IIonApiCall {\r\n\trelativeUrl: string;\r\n\trequestBody: string;\r\n}\r\n\r\nexport class Generic2 extends Datasource {\r\n\tprotected databearer: IJsonGenericDatasource2;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonGenericDatasource2,\r\n\t\tprotected datasourceService: DatasourceService\r\n\t) {\r\n\t\tsuper(obj);\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonGenericDatasource2 {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tgetDetailData(params: IMap<any>): Promise<any> {\r\n\t\tconst databearer = this.databearer;\r\n\t\tconst formatResponse = (result: any) => {\r\n\t\t\tconst detailObject: any = {};\r\n\r\n\t\t\tconst resultToFormat = this.getVerifiedResult(result);\r\n\r\n\t\t\tif (databearer.isOutputFile) {\r\n\t\t\t\tdetailObject[databearer.outputParameters[0].id] = resultToFormat;\r\n\t\t\t} else {\r\n\t\t\t\t// Json response\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdatabearer.outputParameters.forEach((param) => {\r\n\t\t\t\t\t\tdetailObject[param.id] = jsonpath.value(\r\n\t\t\t\t\t\t\tresultToFormat,\r\n\t\t\t\t\t\t\tdatabearer.outputRootElement + param.key\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"Unable to parse data. The response is not in JSON format.\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn detailObject;\r\n\t\t};\r\n\t\treturn this.loadData(params).then(formatResponse);\r\n\t}\r\n\r\n\tprivate getVerifiedResult(obj: any): any {\r\n\t\treturn isArray(obj) ? obj[0] : obj;\r\n\t}\r\n\r\n\tgetListData(params: IMap<any>): Promise<IListDataItem[]> {\r\n\t\tconst databearer = this.databearer;\r\n\t\treturn this.loadData(params).then((result) => {\r\n\t\t\tconst list: IListDataItem[] = [];\r\n\t\t\tconst listResult = this.getVerifiedResult(result);\r\n\r\n\t\t\tconst rows = jsonpath.query(listResult, databearer.outputRootElement);\r\n\t\t\trows.forEach((row, index) => {\r\n\t\t\t\tconst listObject: IListDataItem = {};\r\n\t\t\t\tdatabearer.outputParameters.forEach((param) => {\r\n\t\t\t\t\tlistObject[param.id] = jsonpath.value(row, \"$.\" + param.key);\r\n\t\t\t\t});\r\n\t\t\t\tif (databearer.objectIdPath) {\r\n\t\t\t\t\tlistObject.id = jsonpath.value(row, \"$.\" + databearer.objectIdPath); //setting the id on the item\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlistObject.id = index.toString();\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(listObject);\r\n\t\t\t});\r\n\t\t\treturn list;\r\n\t\t});\r\n\t}\r\n\r\n\tgetNonParsedData(params: IMap<any>): Promise<any[]> {\r\n\t\treturn this.loadData(params).then((result) => {\r\n\t\t\treturn this.getVerifiedResult(result);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setSubstitutionTags(\r\n\t\turl: string,\r\n\t\tbodyParameter: string,\r\n\t\tparameters: IMap<any>\r\n\t): IIonApiCall {\r\n\t\tlet value: any;\r\n\t\tlet substitutionTag: string;\r\n\t\tlet requestBody;\r\n\r\n\t\tthis.databearer.inputParameters.forEach((datasourceParameter) => {\r\n\t\t\tvalue = parameters[datasourceParameter.id];\r\n\t\t\tswitch (datasourceParameter.parameterType) {\r\n\t\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\t\tsubstitutionTag = DataServiceHelper.getURLVariable(\r\n\t\t\t\t\t\tdatasourceParameter.key\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (url.indexOf(substitutionTag) !== -1) {\r\n\t\t\t\t\t\tif (value !== null && value !== undefined && value !== \"\") {\r\n\t\t\t\t\t\t\t// Exclude all false cases except 0\r\n\t\t\t\t\t\t\turl = url.replace(substitutionTag, encodeURIComponent(value));\r\n\t\t\t\t\t\t} else if (datasourceParameter.required) {\r\n\t\t\t\t\t\t\t// If required throw error\r\n\t\t\t\t\t\t\tthrow new Error(\"Parameter is required\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Null, undefined or \"\", remove substitution tags\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tdatasourceParameter.parameterType === ParameterTypeEnum.MATRIX\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t// Matrix\r\n\t\t\t\t\t\t\t\tconst strToReplace =\r\n\t\t\t\t\t\t\t\t\t\";\" +\r\n\t\t\t\t\t\t\t\t\tDataServiceHelper.getURLVariable(\r\n\t\t\t\t\t\t\t\t\t\tdatasourceParameter.key,\r\n\t\t\t\t\t\t\t\t\t\tParameterTypeEnum.MATRIX\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\turl = url.replace(strToReplace, \"\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Query\r\n\t\t\t\t\t\t\t\tconst fullSubstitutionTag = DataServiceHelper.getURLVariable(\r\n\t\t\t\t\t\t\t\t\tdatasourceParameter.key,\r\n\t\t\t\t\t\t\t\t\tParameterTypeEnum.QUERY\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\turl = url.replace(fullSubstitutionTag, \"\");\r\n\t\t\t\t\t\t\t\turl = url.replace(\"?&\", \"?\");\r\n\t\t\t\t\t\t\t\turl = url.replace(\"&&\", \"&\");\r\n\r\n\t\t\t\t\t\t\t\t// Rm if there is a & at the end.\r\n\t\t\t\t\t\t\t\t// E.g: LstItmByItmGr?ITGR=004&\r\n\t\t\t\t\t\t\t\tif (url.charAt(url.length - 1) === \"&\") {\r\n\t\t\t\t\t\t\t\t\turl = url.substr(0, url.length - 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(\"Substitution tag does not exist!\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ParameterTypeEnum.BODY_PART: {\r\n\t\t\t\t\trequestBody = this.getRequestBody(\r\n\t\t\t\t\t\tbodyParameter,\r\n\t\t\t\t\t\tdatasourceParameter,\r\n\t\t\t\t\t\tvalue\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t// Invalid inparameter type\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn {\r\n\t\t\trelativeUrl: url,\r\n\t\t\trequestBody,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getRequestBody(\r\n\t\tbodyParameter: string,\r\n\t\tdatasourceParameter: IParameterObject,\r\n\t\tvalue: any\r\n\t): any {\r\n\t\tconst contentType = this.databearer.headers?.[\"Content-Type\"];\r\n\t\tswitch (contentType) {\r\n\t\t\tcase \"text/plain\":\r\n\t\t\t\treturn value;\r\n\t\t\tcase \"application/json\":\r\n\t\t\tdefault: {\r\n\t\t\t\tconst bodyParameters = JSON.parse(bodyParameter);\r\n\t\t\t\tconst schema = JsonHelper.generateSchema(bodyParameters);\r\n\t\t\t\tconst propertyType = JsonHelper.getPropertyType(\r\n\t\t\t\t\tschema,\r\n\t\t\t\t\tdatasourceParameter.key\r\n\t\t\t\t);\r\n\t\t\t\tswitch (propertyType) {\r\n\t\t\t\t\tcase \"number\":\r\n\t\t\t\t\t\tvalue = parseFloat(value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"string\":\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tjsonpath.value(bodyParameters, datasourceParameter.key, value);\r\n\r\n\t\t\t\treturn bodyParameters;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tloadData(inputParameterValues: IMap<any>): Promise<any> {\r\n\t\tconst defer: ng.IDeferred<any> = this.datasourceService.getDeferred();\r\n\t\tconst databearer = this.databearer;\r\n\t\tconst relativeUrlPath =\r\n\t\t\tdatabearer.suite + databearer.endpoint + databearer.resource;\r\n\t\tconst requestBody = databearer.bodyTemplate;\r\n\t\tconst parameters: IMap<any>[] = [{}];\r\n\t\tconst ionApiCalls: IIonApiCall[] = [];\r\n\t\tconst extraParameters: IMap<any> = {};\r\n\r\n\t\ttry {\r\n\t\t\tthis.databearer.inputParameters.forEach((ionapiParameter) => {\r\n\t\t\t\tconst inputparameter = inputParameterValues[ionapiParameter.id];\r\n\t\t\t\tif (inputparameter && isArray(inputparameter)) {\r\n\t\t\t\t\t// if multiple parameters\r\n\t\t\t\t\tinputparameter.forEach((parameter, index) => {\r\n\t\t\t\t\t\tif (!parameters[index]) {\r\n\t\t\t\t\t\t\tparameters.push({});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparameters[index][ionapiParameter.id] = parameter;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (inputparameter) {\r\n\t\t\t\t\textraParameters[ionapiParameter.id] = inputparameter;\r\n\t\t\t\t\tif (parameters.length === 1) {\r\n\t\t\t\t\t\tparameters[0] = inputParameterValues;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.fillInParameters(\r\n\t\t\t\textraParameters,\r\n\t\t\t\tthis.databearer.inputParameters,\r\n\t\t\t\tparameters\r\n\t\t\t);\r\n\t\t\tparameters.forEach((parameter, index) => {\r\n\t\t\t\tionApiCalls.push(\r\n\t\t\t\t\tthis.setSubstitutionTags(relativeUrlPath, requestBody, parameter)\r\n\t\t\t\t);\r\n\t\t\t\tconst matches = ionApiCalls[index].relativeUrl.match(/{.+}/g);\r\n\t\t\t\tif (matches) {\r\n\t\t\t\t\tthrow new Error(\"Not all string replace positions were replaced\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (e) {\r\n\t\t\tconst error: ErrorResponse = new ErrorResponse(\r\n\t\t\t\te.message,\r\n\t\t\t\tSubcodes.DATA_SERVICE_ERROR,\r\n\t\t\t\te.stack\r\n\t\t\t);\r\n\r\n\t\t\tdefer.reject(error);\r\n\t\t\tconsole.error(e);\r\n\t\t\treturn defer.promise as Promise<any>;\r\n\t\t}\r\n\r\n\t\tconst promises: Promise<any>[] = [];\r\n\r\n\t\tionApiCalls.forEach((ionApiCall) => {\r\n\t\t\tpromises.push(\r\n\t\t\t\tthis.datasourceService\r\n\t\t\t\t\t.ionApiRequest(\r\n\t\t\t\t\t\tionApiCall.relativeUrl,\r\n\t\t\t\t\t\tdatabearer.isOutputFile,\r\n\t\t\t\t\t\tdatabearer.method,\r\n\t\t\t\t\t\tionApiCall.requestBody,\r\n\t\t\t\t\t\tdatabearer.headers\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.then((response: any) => {\r\n\t\t\t\t\t\tif (ionApiCall.relativeUrl.indexOf(\"righttrim=true\") > 0) {\r\n\t\t\t\t\t\t\tresponse = Helper.deepObjectTrim(response);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn response;\r\n\t\t\t\t\t})\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\treturn this.datasourceService.$q.all(promises) as Promise<any>;\r\n\t}\r\n\r\n\tgetMetaData(): Promise<IMetaData> {\r\n\t\tconst deferredMetaData: ng.IDeferred<any> =\r\n\t\t\tthis.datasourceService.getDeferred();\r\n\t\tconst inputFields: IMetaDataField[] = [];\r\n\t\tconst outputFields: IMetaDataField[] = [];\r\n\r\n\t\tthis.databearer.inputParameters.forEach((param) => {\r\n\t\t\tinputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.alias ? param.alias : param.key,\r\n\t\t\t\tMAND: param.required ? \"1\" : \"0\",\r\n\t\t\t\ttype: param.dataType,\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.databearer.outputParameters.forEach((param) => {\r\n\t\t\toutputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.alias ? param.alias : param.key,\r\n\t\t\t\tMAND: \"0\",\r\n\t\t\t\ttype: param.dataType,\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tdeferredMetaData.resolve({\r\n\t\t\tinputFields: inputFields,\r\n\t\t\toutputFields: outputFields,\r\n\t\t});\r\n\r\n\t\treturn deferredMetaData.promise as Promise<any>;\r\n\t}\r\n}\r\n","import { ConditionType, InjectNames, Operators, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport { Helper } from \"../helper\";\r\nimport { IComponent } from \"../IComponent\";\r\nimport { CommonService } from \"./common-service\";\r\n\r\ninterface IUsedExpression {\r\n\tcomponentId: string;\r\n\tconditionType: string;\r\n}\r\n\r\nexport class ExpressionService {\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.COMMON_SERVICE\r\n\t];\r\n\r\n\tprivate currentProjectComponents: IComponent[];\r\n\tprivate triggeredConditions: IUsedExpression[] = [];\r\n\r\n\tconstructor(\r\n\t\tprivate commonService: CommonService\r\n\t) {}\r\n\r\n\tpublic trigger(components: IComponent[]): void {\r\n\t\tthis.triggeredConditions = [];\r\n\t\tthis.currentProjectComponents = components;\r\n\t\tconst currentProject = this.commonService.getCurrentProject();\r\n\t\tconst expressions = currentProject.getExpressions();\r\n\t\texpressions.forEach((expression) => {\r\n\t\t\tconst alreadyTriggered = this.isUsed(expression.usedBy, expression.conditionType);\r\n\r\n\t\t\tif (!alreadyTriggered) {\r\n\t\t\t\tlet sourceValue = expression.sourceProperty;\r\n\t\t\t\tif (expression.source !== \"<static>\") {\r\n\t\t\t\t\tsourceValue = this.getExpressionValue(expression.source, expression.sourceProperty);\r\n\t\t\t\t}\r\n\t\t\t\tlet targetValue = expression.targetProperty;\r\n\t\t\t\tif (expression.target !== \"<static>\") {\r\n\t\t\t\t\ttargetValue = this.getExpressionValue(expression.target, expression.targetProperty);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.runExpression(sourceValue, targetValue, expression);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate isUsed(componentId: string, type: string): boolean {\r\n\t\treturn this.triggeredConditions.some((triggeredCondition) => {\r\n\t\t\treturn triggeredCondition.componentId === componentId &&\r\n\t\t\t\ttriggeredCondition.conditionType === type;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate runExpression(\r\n\t\tsourceValue: string,\r\n\t\ttargetValue: string,\r\n\t\texpression: IJsonExpression\r\n\t): void {\r\n\t\tlet result = false;\r\n\t\t//get the component that uses this expression\r\n\t\tconst component = this.findComponent(expression.usedBy);\r\n\r\n\t\t//if source is from checkbox\r\n\t\tif (typeof sourceValue === \"boolean\") {\r\n\t\t\tsourceValue = sourceValue ? \"1\" : \"0\";\r\n\t\t}\r\n\t\tif (typeof targetValue === \"boolean\") {\r\n\t\t\ttargetValue = targetValue ? \"1\" : \"0\";\r\n\t\t}\r\n\r\n\t\t//used in lower, greater etc\r\n\t\tlet sourceNumber;\r\n\t\tlet targetNumber;\r\n\r\n\t\tif (component) {\r\n\t\t\tswitch (expression.clauseOperator) {\r\n\t\t\t\tcase Operators.EQUALS:\r\n\t\t\t\t\tresult = sourceValue === targetValue;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.NOT_EQUALS:\r\n\t\t\t\t\tresult = sourceValue !== targetValue;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.GREATER:\r\n\t\t\t\t\tsourceNumber = parseInt(sourceValue);\r\n\t\t\t\t\ttargetNumber = parseInt(targetValue);\r\n\t\t\t\t\tresult = sourceNumber > targetNumber;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.LOWER:\r\n\t\t\t\t\tsourceNumber = parseInt(sourceValue);\r\n\t\t\t\t\ttargetNumber = parseInt(targetValue);\r\n\t\t\t\t\tresult = sourceNumber < targetNumber;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.SAME_GREATER:\r\n\t\t\t\t\tsourceNumber = parseInt(sourceValue);\r\n\t\t\t\t\ttargetNumber = parseInt(targetValue);\r\n\t\t\t\t\tresult = sourceNumber >= targetNumber;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.SAME_LOWER:\r\n\t\t\t\t\tsourceNumber = parseInt(sourceValue);\r\n\t\t\t\t\ttargetNumber = parseInt(targetValue);\r\n\t\t\t\t\tresult = sourceNumber <= targetNumber;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.INCLUDES:\r\n\t\t\t\t\tconst targetString = targetValue.trim().toLowerCase();\r\n\t\t\t\t\tconst sourceString = sourceValue.trim().toLowerCase();\r\n\t\t\t\t\tif (sourceString && targetString) {\r\n\t\t\t\t\t\tresult = targetString.includes(sourceString);\r\n\t\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate triggerCondition(expression: IJsonExpression, component: IComponent, value: boolean): void {\r\n\t\tif (value) {\r\n\t\t\tthis.triggeredConditions.push({\r\n\t\t\t\tcomponentId: component.getId(),\r\n\t\t\t\tconditionType: expression.conditionType\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tswitch (expression.conditionType) {\r\n\t\t\tcase ConditionType.DISABLE:\r\n\t\t\t\tcomponent.isReadonly = value;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ConditionType.HIDE:\r\n\t\t\t\tcomponent.isVisible = !value;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// type not exists\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getExpressionComponentValue(component: IComponent, property: string): string {\r\n\t\tlet value;\r\n\t\tconst componentDataservice = component.getDatasource();\r\n\t\tconst componentValue = component.getValue(property);\r\n\t\tconst componentBindableValue = component.getBindableValue(property);\r\n\r\n\t\tif (componentDataservice && !Helper.isUndefinedOrNull(componentValue)) {\r\n\t\t\tvalue = componentValue;\r\n\t\t} else if (!Helper.isUndefinedOrNull(componentBindableValue)) {\r\n\t\t\tvalue = componentBindableValue;\r\n\t\t} else if (property.includes(SettingKeys.SELECTED_ITEM)) {\r\n\t\t\tvalue = \"\";\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\tprivate getExpressionValue(componentName: string, property: string): string {\r\n\t\tconst component = this.findComponent(componentName);\r\n\t\tif (component) {\r\n\t\t\tproperty = this.getExpressionComponentValue(component, property);\r\n\t\t}\r\n\t\treturn property;\r\n\t}\r\n\r\n\tprivate findComponent(usedByComponent: string): IComponent {\r\n\t\treturn this.currentProjectComponents.find((component) => {\r\n\t\t\treturn component.getId() === usedByComponent;\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.EXPRESSION_SERVICE, ExpressionService);\r\n\t}\r\n}\r\n","import { InjectNames, Numbers } from \"ng2/common/constants/common.constant\";\r\n\r\nexport class MingleService {\r\n\r\n\tpublic static MESSAGETYPE_BUSINESSCONTEXT: string = \"inforBusinessContext\";\r\n\tpublic static MESSAGETYPE_CLEARCONTEXT: string = \"clearAllContext\";\r\n\tpublic static MESSAGETYPE_APPINITCOMPLETE: string = \"appInitComplete\";\r\n\tpublic static MESSAGETYPE_APPLICATIONDRILLBACK: string = \"applicationDrillback\";\r\n\tpublic static MESSAGETYPE_FAVORITECONTEXT: string = \"showFavoriteContext\";\r\n\tpublic static MESSAGETYPE_SHORTCUTCONTEXT: string = \"setShortcutContext\";\r\n\r\n\tpublic static DEFAULT_LID: string = \"lid://infor.app-builder.1\";\r\n\r\n\tprivate logicalId: string;\r\n\r\n\tpublic getLogicalId(): string {\r\n\t\treturn this.logicalId || MingleService.DEFAULT_LID;\r\n\t}\r\n\r\n\tpublic setupMessageHandler(messageType: string, callback: Function): void {\r\n\t\tinfor.companyon.client.registerMessageHandler(messageType, callback);\r\n\t}\r\n\r\n\tsendApplicationInitComplete(): void {\r\n\t\tinfor.companyon.client.sendMessage(MingleService.MESSAGETYPE_APPINITCOMPLETE, window.name);\r\n\t}\r\n\r\n\tpublic sendDrillbackMessage(message: string): void {\r\n\t\tinfor.companyon.client.sendPrepareDrillbackMessage(message);\r\n\t}\r\n\r\n\tpublic sendBusinessContextMessage(messageType: string, appId: string, appName: string): void {\r\n\t\tlet data: Object;\r\n\r\n\t\tswitch (messageType) {\r\n\t\t\tcase MingleService.MESSAGETYPE_BUSINESSCONTEXT:\r\n\t\t\t\tdata = {\r\n\t\t\t\t\t\"type\": messageType,\r\n\t\t\t\t\t\"screenId\": appId,\r\n\t\t\t\t\t\"visible\": true,\r\n\t\t\t\t\t\"readOnly\": false,\r\n\t\t\t\t\t\"originatingTime\": this.getOriginatingTime(),\r\n\t\t\t\t\t\"contextId\": this.generateContextId(),\r\n\t\t\t\t\t\"logicalId\": this.getLogicalId(),\r\n\t\t\t\t\t\"entities\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"entityType\": \"InforApp\",\r\n\t\t\t\t\t\t\t\"id1\": appId,\r\n\t\t\t\t\t\t\t\"drillbackURL\": this.getDrillbackUrl(this.getLogicalId(), appId)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase MingleService.MESSAGETYPE_SHORTCUTCONTEXT:\r\n\t\t\t\tdata = {\r\n\t\t\t\t\t\"name\": appName,\r\n\t\t\t\t\t\"description\": \"An Infor App in AppHub\",\r\n\t\t\t\t\t\"absoluteURL\": false,\r\n\t\t\t\t\t\"shortcutContext\": this.getDrillbackUrl(this.getLogicalId(), appId)\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tdata = {};\r\n\t\t}\r\n\r\n\t\tinfor.companyon.client.sendMessage(messageType, data);\r\n\t}\r\n\r\n\tpublic sendClearContextMessage(): void {\r\n\t\tinfor.companyon.client.sendMessage(MingleService.MESSAGETYPE_BUSINESSCONTEXT, {});\r\n\t\tinfor.companyon.client.sendMessage(MingleService.MESSAGETYPE_SHORTCUTCONTEXT, {});\r\n\t}\r\n\r\n\tprivate getDrillbackUrl(logicalId: string, appId: string): string {\r\n\t\treturn \"?LogicalId=\" + encodeURIComponent(logicalId) + \"&$appId=\" + appId;\r\n\t}\r\n\r\n\tprivate generateContextId(): string {\r\n\t\treturn this.getOriginatingTime().toString() + \"\" + Math.floor((Math.random() * Numbers.HUNDRED) + 1);\r\n\t}\r\n\r\n\tprivate getOriginatingTime(): number {\r\n\t\tconst d: Date = new Date();\r\n\t\treturn d.getTime();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.service(InjectNames.MINGLE_SERVICE, MingleService);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { commonModule } from \"../common/module\";\r\n\r\nimport { DatasourceService } from \"./services/datasource-service\";\r\nimport { FrameworkService } from \"./services/framework-service\";\r\nimport { IonApiService } from \"./services/ion-api-service\";\r\nimport { IonMetadataService } from \"./services/ion-metadata-service\";\r\nimport { LocalIdoService } from \"./services/local-ido-service\";\r\nimport { TranslationManagementService } from \"./services/translation-management-service\";\r\n\r\nimport { Defines } from \"./defines\";\r\n\r\nimport { ChildrenDirective } from \"./children-directive\";\r\nimport { ComponentCommonDirective } from \"./component-common\";\r\nimport { ComponentDirective } from \"./component-directive\";\r\nimport { TitlebarDirective } from \"./titlebar/titlebar\";\r\n\r\nexport const componentsModule = angular.module(\"componentsModule\", [\r\n\tcommonModule.name\r\n]);\r\n\r\ncomponentsModule.config([\"$qProvider\", ($qProvider: ng.IQProvider) => {\r\n\t$qProvider.errorOnUnhandledRejections(false);\r\n}]);\r\n\r\n// Add services\r\nDatasourceService.add(componentsModule);\r\nFrameworkService.add(componentsModule);\r\nIonApiService.add(componentsModule);\r\nIonMetadataService.add(componentsModule);\r\nLocalIdoService.add(componentsModule);\r\nTranslationManagementService.add(componentsModule);\r\n\r\n// Add components\r\nDefines.addComponents(componentsModule);\r\n\r\n// Add directives\r\nChildrenDirective.add(componentsModule);\r\nComponentCommonDirective.add(componentsModule);\r\nComponentDirective.add(componentsModule);\r\nTitlebarDirective.add(componentsModule);\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport type { IDialogBaseScope } from \"../../defines\";\r\nimport { Helper } from \"../../helper\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\n\r\nimport { FileExtensions, RegexStrings } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IValidation } from \"common/shared-components/base/field-validation\";\r\n\r\nexport interface IExportDialogParams {\r\n\ttype: \"project\" | \"composite component\" | \"dataservice\";\r\n\tfilename: string;\r\n}\r\n\r\nconst getFormattedFilename = (params: IExportDialogParams): string => {\r\n\tconst { type, filename } = params;\r\n\tlet formattedFilename = filename\r\n\t\t.split(\" \")\r\n\t\t.join(\"_\");\r\n\tformattedFilename = formattedFilename.replace(RegexStrings.NO_SPECIAL, \"\");\r\n\tswitch (params.type) {\r\n\t\tcase \"project\":\r\n\t\t\treturn `${formattedFilename}_${Helper.getFormattedDate(\"yyyy-mm-dd\")}`;\r\n\t\tdefault:\r\n\t\t\treturn `${Helper.getFormattedDate(\"yyyy-mm-dd\")}`;\r\n\t}\r\n};\r\n\r\nconst getFileExtension = (params: IExportDialogParams): string => {\r\n\tconst { type } = params;\r\n\tswitch (type) {\r\n\t\tcase \"project\":\r\n\t\t\treturn FileExtensions.PROJECT;\r\n\t\tcase \"composite component\":\r\n\t\t\treturn FileExtensions.COMPOSITE_COMPONENT;\r\n\t\tcase \"dataservice\":\r\n\t\t\treturn FileExtensions.DATA_SERVICE;\r\n\t\tdefault:\r\n\t\t\treturn \".somethingIsWrong\";\r\n\t}\r\n};\r\n\r\nexport class ExportProjectCtrl {\r\n\texportFileName: string;\r\n\tfileExtension: string;\r\n\tdefaultFilename: string;\r\n\terrorList: IValidation[] = [];\r\n\tget isInvalid(): boolean {\r\n\t\treturn this.errorList.length !== 0;\r\n\t}\r\n\r\n\tprivate dialog: IDialog<IExportDialogParams>;\r\n\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<IExportDialogParams>\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.exportFileName = getFormattedFilename(dialog.parameter);\r\n\t\tthis.fileExtension = getFileExtension(dialog.parameter);\r\n\t\tthis.defaultFilename = getFormattedFilename(dialog.parameter);\r\n\t}\r\n\r\n\tvalidate(value: string): boolean {\r\n\t\treturn !RegexStrings.NO_SPECIAL.test(value);\r\n\t}\r\n\r\n\tclose(): void {\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tbutton: DialogButtonType.Cancel\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\texport(): void {\r\n\t\tconst filename: string = Helper.isUndefinedEmpty(this.exportFileName) ?\r\n\t\t\tthis.defaultFilename : this.exportFileName;\r\n\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tvalue: `${filename}.${this.fileExtension}`,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirExportProjectCtrl\", ExportProjectCtrl);\r\n\t}\r\n\r\n}\r\n","export enum InforOwnedEnum {\r\n\tFALSE,\r\n\tTRUE\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { IComponentRendered } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { IListViewApi, IListViewOptions } from \"../../model/sohoxi/sohoxi-listview.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * Listview Directive.\r\n *\r\n * Example:\r\n * scope[\"options\"] = { dataset: items, selectable: \"multiple\" };\r\n * scope[\"items\"] = [\"first\", \"second\", \"third\"];\r\n *\r\n * <div class=\"card\">\r\n * \t<div class=\"card-header\"></div>\r\n * \t<div class=\"card-content\">\r\n * \t\t<div class=\"listview-toolbar toolbar is-hidden\">\r\n * \t\t\t<div class=\"buttonset\">\r\n * \t\t\t\t<button class=\"btn-tertiary\" title=\"remove\" type=\"button\"\r\n * \t\t\t\t\tng-click=\"ctrl.removeSelected()\"\r\n * \t\t\t\t>\r\n * \t\t\t\t\tRemove\r\n * \t\t\t\t</button>\r\n * \t\t\t</div>\r\n * \t\t</div>\r\n * \t\t<div class=\"listview is-muliselect\" id=\"multiselect-listview\"\r\n * \t\t\txi-listview=\"options\"\r\n *\t\t\t>\r\n\t* \t\t\t<ul>\r\n\t* \t\t\t\t<li ng-repeat=\"item in items track by $id($index)\">\r\n\t* \t\t\t\t\t<p>{{item}}</p>\r\n\t* \t\t\t\t</li>\r\n\t* \t\t\t</ul>\r\n\t* \t\t</div>\r\n\t* \t</div>\r\n\t* </div>\r\n\t*/\r\nexport const LISTVIEW_RENDERED = \"finishedListviewCreation\";\r\nexport class ListviewDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiListview\";\r\n\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[ListviewDirective.DIRECTIVE_NAME];\r\n\t\tconst toolbar = element\r\n\t\t\t.closest(\".widget, .card\")\r\n\t\t\t.find(\".listview-toolbar\");\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IListViewOptions) => {\r\n\t\t\t\tlet api: IListViewApi;\r\n\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\tapi =  Utils.getData(element, \"listview\");\r\n\r\n\t\t\t\t\tif (api) {\r\n\t\t\t\t\t\tapi.updated(newOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.listview(newOptions);\r\n\t\t\t\t\t\tapi =  Utils.getData(element, \"listview\");\r\n\r\n\t\t\t\t\t\tconst toolbarElement: any = toolbar\r\n\t\t\t\t\t\t\t.removeClass(\"is-visible\")\r\n\t\t\t\t\t\t\t.one(\"animateClosedComplete\",\r\n\t\t\t\t\t\t\t\tevent => {\r\n\t\t\t\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\t\t\t\ttoolbar.css(\"display\", \"none\");\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\ttoolbarElement[\"animateClosed\"](); // tslint:disable-line:no-string-literal\r\n\r\n\t\t\t\t\t\tangular.forEach(\r\n\t\t\t\t\t\t\tapi.selectedItems,\r\n\t\t\t\t\t\t\tselected => selected.removeClass());\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tapi = element.listview();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (newOptions?.id !== undefined) {\r\n\t\t\t\t\tconst finishedResult: IComponentRendered = {\r\n\t\t\t\t\t\tid: newOptions.id,\r\n\t\t\t\t\t\tapi,\r\n\t\t\t\t\t};\r\n\t\t\t\t\telement.trigger(LISTVIEW_RENDERED, finishedResult);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttrue\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst listViewData = Utils.getData(element, \"listview\");\r\n\t\t\tif (listViewData) {\r\n\t\t\t\tlistViewData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ListviewDirective.DIRECTIVE_NAME, [\r\n\t\t\t() => {\r\n\t\t\t\treturn new ListviewDirective();\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { Config, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDocument } from \"ng2/common/model/swagger.model\";\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\nimport { ErrorResponse } from \"../../common/error-response\";\r\nimport { IApiSuite, IOperation, IOperationQuery, ISuiteQuery } from \"../../common/model/ion-metadata.model\";\r\nimport { ComponentHelper } from \"../component-helper\";\r\nimport { IonApiService } from \"./ion-api-service\";\r\n\r\nexport class IonMetadataService {\r\n\tpublic cache: ng.ICacheObject;\r\n\r\n\t/** Page size when searching for operations */\r\n\tpublic static OPERATIONS_PAGE_SIZE = 20;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.ION_API_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $cacheFactory: ng.ICacheFactoryService,\r\n\t\tpublic $q: ng.IQService,\r\n\t\tprivate ionApiService: IonApiService\r\n\t) {\r\n\t\tthis.initCache();\r\n\t}\r\n\r\n\tprivate initCache(): void {\r\n\t\tthis.cache = this.$cacheFactory.get(\"IonMetadataService\");\r\n\t\tif (!this.cache) {\r\n\t\t\tthis.cache = this.$cacheFactory(\"IonMetadataService\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getApiSuites(): ng.IPromise<IApiSuite[]> {\r\n\t\tconst options: ISuiteQuery = {\r\n\t\t\tpageSize: 50\r\n\t\t};\r\n\t\treturn this.makeIonRequest(\"metadata/v1/\" + Config.TENANT_ID + \"/apisuites\", false, options);\r\n\t}\r\n\r\n\tpublic searchOperations(\r\n\t\tsuiteContext: string = \"\",\r\n\t\tquery: string = \"\",\r\n\t\tpageNo: number = 0): ng.IPromise<IOperation[]> {\r\n\t\tconst encodedSuiteContext = encodeURI(suiteContext);\r\n\t\tconst options: IOperationQuery = {\r\n\t\t\tsuiteContext: encodedSuiteContext,\r\n\t\t\tsearchCriteria: query,\r\n\t\t\tpageSize: IonMetadataService.OPERATIONS_PAGE_SIZE,\r\n\t\t\tpageNo,\r\n\t\t};\r\n\r\n\t\treturn this.makeIonRequest(\"metadata/v1/\" + Config.TENANT_ID + \"/operations\", false, options);\r\n\t}\r\n\r\n\tpublic getSwaggerDoc(fullPath: string): ng.IPromise<IDocument> {\r\n\t\tconst deferred = this.$q.defer<IDocument>();\r\n\t\tconst regex = new RegExp(\".*\\/\" + Config.TENANT_ID + \"\\/(.*)\", \"i\");\r\n\t\tconst pathMatch = fullPath.match(regex);\r\n\t\tif (pathMatch && pathMatch[1]) {\r\n\t\t\tconst swaggerPath = pathMatch[1];\r\n\t\t\tthis.makeIonRequest<IDocument>(swaggerPath, true).then(resp => {\r\n\t\t\t\tconst dereferenced = ComponentHelper.dereferenceSwagger(resp);\r\n\t\t\t\tdeferred.resolve(dereferenced);\r\n\t\t\t}).catch((errorResponse: ng.IHttpResponse<any>) => {\r\n\t\t\t\tconst error = new ErrorResponse(errorResponse.statusText, errorResponse.status);\r\n\t\t\t\tdeferred.reject(error);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconst error = new ErrorResponse(`Unable to handle path \"${fullPath}\"`);\r\n\t\t\tdeferred.reject(error);\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate makeIonRequest<T>(\r\n\t\trelativePath: string,\r\n\t\tsetTenant: boolean,\r\n\t\tparams: IMap<any> = {},\r\n\t\tmethod: string = \"GET\"\r\n\t): ng.IPromise<T> {\r\n\t\treturn this.ionApiService.executeIonApiAsync<T>({\r\n\t\t\turl: relativePath,\r\n\t\t\tmethod,\r\n\t\t\tsetTenant,\r\n\t\t\tparams,\r\n\t\t\tcache: this.cache,\r\n\t\t}).then(response => response.data);\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.ION_METADATA_SERVICE, IonMetadataService);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../common/angular-constants\";\r\nimport { IChildScope } from \"../common/interface/ichild-scope\";\r\nimport { IChildrenScope } from \"../common/interface/ichildren-scope\";\r\n\r\nimport { IComponent } from \"../common/IComponent\";\r\n\r\nexport class ChildrenDirective implements ng.IDirective {\r\n\tpublic restrict = \"E\";\r\n\tpublic scope = {\r\n\t\tparent: \"=\",\r\n\t\tchildrenReady: \"&\",\r\n\t};\r\n\r\n\tconstructor(\r\n\t\tprivate $compileService: ng.ICompileService\r\n\t) { }\r\n\r\n\tpublic link($scope: IChildrenScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattrs: ng.IAttributes\r\n\t): void {\r\n\t\tlet nrChildrenReady = 0;\r\n\t\tconst parentInstance = $scope.parent;\r\n\t\t$scope.context = parentInstance.getContext();\r\n\t\t$scope.onChildReady = (childInstance: IComponent, index: number) => {\r\n\t\t\tparentInstance.children[index] = childInstance;\r\n\t\t\tnrChildrenReady++;\r\n\t\t\tif (\r\n\t\t\t\tnrChildrenReady === parentInstance.getDatabearer().children.length\r\n\t\t\t) {\r\n\t\t\t\t$scope.childrenReady();\r\n\t\t\t}\r\n\t\t};\r\n\t\t$scope.$applyAsync(() => {\r\n\t\t\tif (parentInstance.getDatabearer().children.length === 0) {\r\n\t\t\t\t$scope.childrenReady();\r\n\t\t\t} else {\r\n\t\t\t\tparentInstance.getDatabearer().children.forEach((child, index) => {\r\n\t\t\t\t\tconst childScope = $scope.$new() as IChildScope;\r\n\t\t\t\t\tchildScope.component = child;\r\n\t\t\t\t\tchildScope.parent = parentInstance;\r\n\t\t\t\t\tchildScope.context = $scope.context;\r\n\t\t\t\t\tchildScope.index = index;\r\n\t\t\t\t\tthis.$compileService(ChildrenDirective.createTemplate(child.typedef))(\r\n\t\t\t\t\t\tchildScope,\r\n\t\t\t\t\t\t(clone) => {\r\n\t\t\t\t\t\t\telement.append(clone);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static createTemplate(typedef: string): JQuery {\r\n\t\tconst componentTemplate = $(\r\n\t\t\t\"<eir-component-directive></eir-component-directive>\"\r\n\t\t);\r\n\t\tcomponentTemplate.attr(\"component\", \"component\");\r\n\t\tcomponentTemplate.attr(\"context\", \"context\");\r\n\t\tcomponentTemplate.attr(\"parent\", \"parent\");\r\n\t\tcomponentTemplate.attr(\r\n\t\t\t\"component-ready\",\r\n\t\t\t\"onChildReady(componentInstance, index);\"\r\n\t\t);\r\n\t\tcomponentTemplate.attr(\"generated-id\", \"parent.generateId(index)\");\r\n\t\tcomponentTemplate.attr(\"typedef\", typedef);\r\n\t\treturn componentTemplate;\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = (\r\n\t\t\t$compileService: ng.ICompileService\r\n\t\t) => new ChildrenDirective($compileService);\r\n\t\tdirective.$inject = [AngularConstants.COMPILE];\r\n\t\tm.directive(\"eirChildren\", directive);\r\n\t}\r\n}\r\n","import { Config } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { Debugger } from \"common/debugger\";\r\nimport { IAvailableSourceField } from \"common/defines\";\r\nimport { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nexport class DesignerHelper extends Helper {\r\n\r\n\tstatic getSizeSuffix(instance: SizeTypeEnum): string {\r\n\t\treturn (instance === SizeTypeEnum.PIXELS ? \"px\" :\r\n\t\t\t(instance === SizeTypeEnum.PERCENT ? \"%\" : \"auto\"));\r\n\t}\r\n\r\n\tstatic openRuntime(\r\n\t\tprojectId: string,\r\n\t\t$window: ng.IWindowService,\r\n\t\turlBindings?: IJsonValueSource[],\r\n\t\turlVariables?: IAvailableSourceField[]\r\n\t): void {\r\n\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tthis.launchAsIntended(\r\n\t\t\t\tprojectId, $window, urlBindings, urlVariables);\r\n\t\t} else {\r\n\t\t\tthis.launchInMongooseIframes(\r\n\t\t\t\tprojectId, $window, urlBindings, urlVariables);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static launchAsIntended(\r\n\t\tprojectId: string,\r\n\t\t$window: ng.IWindowService,\r\n\t\turlBindings?: IJsonValueSource[],\r\n\t\turlVariables?: IAvailableSourceField[]\r\n\t): void {\r\n\r\n\t\tconst url = `#!/run/${projectId}`;\r\n\r\n\t\t$window.open(url, \"_blank\");\r\n\r\n\t}\r\n\r\n\tprivate static launchInMongooseIframes(\r\n\t\tprojectId: string,\r\n\t\t$window: ng.IWindowService,\r\n\t\turlBindings?: IJsonValueSource[],\r\n\t\turlVariables?: IAvailableSourceField[]\r\n\t): void {\r\n\r\n\t\tconst varValue = `run/${projectId}`;\r\n\r\n\t\tif (Config.MG_FORM_ONLY) {\r\n\t\t\tlet setVarValues = `SETVARVALUES(InitURL=${varValue}`;\r\n\t\t\tconst mgBaseUrl = \"/WSWebClient/PlainForm.aspx?page=FormOnly&notitle=1&\";\r\n\r\n\t\t\tif (urlVariables && urlVariables.length > 0) {\r\n\t\t\t\turlVariables.forEach(variable => {\r\n\t\t\t\t\tconst binding = urlBindings.find(bind => bind.sourceKey === variable.sourceKey);\r\n\t\t\t\t\tconst value = binding ? binding.value : \"\";\r\n\t\t\t\t\tsetVarValues += `,${variable.visibleName}=${value}`;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tsetVarValues += \")\";\r\n\r\n\t\t\tconst app = `Form=${Config.MG_FORM_NAME}(${setVarValues})`;\r\n\t\t\tconst url = `${mgBaseUrl}${app}${ Debugger.isEnabled() ? \"&debug=true\" : \"\" }`;\r\n\r\n\t\t\t$window.open(url, \"_blank\");\r\n\t\t} else {\r\n\t\t\tif (urlVariables && urlVariables.length > 0) {\r\n\t\t\t\tlet parameters = `SETVARVALUES(InitURL=${varValue},`;\r\n\t\t\t\turlVariables.forEach(variable => {\r\n\t\t\t\t\tconst binding = urlBindings.find(bind => bind.sourceKey === variable.sourceKey);\r\n\t\t\t\t\tconst value = binding ? binding.value : \"\";\r\n\t\t\t\t\tparameters += `${variable.visibleName}=${value},`;\r\n\t\t\t\t});\r\n\t\t\t\tparameters = parameters.substring(0, parameters.length - 1);\r\n\t\t\t\tparameters += \")\";\r\n\t\t\t\tWSForm.setVarValue(\"FormRunParameters\", parameters, null);\r\n\t\t\t\tWSForm.generate(\"LaunchAppBuilderWithParameters\", null, false);\r\n\t\t\t} else {\r\n\t\t\t\tWSForm.setVarValue(\"InitURL\", varValue, null);\r\n\t\t\t\tWSForm.generate(\"LaunchAppBuilder\", null, false);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div id=newDatasourceDialog ng-controller=\\\"eirDatasourceUpsertDialogCtrl as ctrl\\\"> <div class=row> <div class=columns> <div class=field> <input class=ng-hide id=datasource-type type=text ng-model=ctrl.datasourceType disabled=disabled> </div> </div> <div class=columns> <div class=field> <label for=DatasourceDisplayName class=required>Display name</label> <input id=DatasourceDisplayName class=required type=text ng-model=ctrl.datasource.displayName /> </div> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Close</button> <button type=button class=btn-modal ng-disabled=\\\"!(ctrl.validForm && ctrl.saveable())\\\" ng-click=ctrl.upsertDatasource()>{{ctrl.buttonTitle}}</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \" <div class=select-source ng-controller=\\\"eirSelectSourceCtrl as ctrl\\\"> <fieldset class=radio-group> <legend>Select Source</legend> <div ng-repeat=\\\"option in ctrl.sourceList\\\"> <input type=radio class=radio id={{option}} ng-model=ctrl.selectedSource value={{option}} /> <label for={{option}} class=radio-label>{{option}}</label> </div> </fieldset> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()> Cancel </button> <button type=button class=btn-modal-primary ng-click=ctrl.next()> Next </button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport { InjectNames, Subcodes } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { ErrorResponse, IErrorResponse } from \"../../../../../common/error-response\";\r\nimport { InstanceEvent } from \"../../../../../common/instance-event\";\r\nimport { IApiSuite, IOperation } from \"../../../../../common/model/ion-metadata.model\";\r\nimport { ILookupOptions } from \"../../../../../common/model/sohoxi/sohoxi-lookup.model\";\r\nimport { IDatasourceWizardParameter } from \"../../create-wizard/datasource-wizard-ctrl\";\r\nimport { BaseSearchCtrl, ISearchDialogFieldScope } from \"../base-search-ctrl\";\r\n\r\nimport { IDocument } from \"ng2/common/model/swagger.model\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialog, IDialogOptions\r\n} from \"../../../../../common/services/dialog-service\";\r\nimport { IonMetadataService } from \"../../../../../components/services/ion-metadata-service\";\r\nimport { IonApiOperationDetailsParameter } from \"./ion-api-operation-details-ctrl\";\r\n\r\nexport interface IIonApiDialogFieldScope extends ISearchDialogFieldScope {\r\n\tmethodsFilter: (op: IOperation) => boolean;\r\n}\r\n\r\nexport interface IResponseDatagridData {\r\n\tname: string;\r\n\tdescription: string;\r\n\ttype: string;\r\n\tchildren: IResponseDatagridData[];\r\n\tdepth: number;\r\n\texpanded?: boolean;\r\n}\r\n\r\nexport class IonApiSearchCtrl extends BaseSearchCtrl {\r\n\tpublic $scope: IIonApiDialogFieldScope;\r\n\r\n\tpublic genericInstanceEvent: InstanceEvent<any>;\r\n\r\n\tpublic filterOptions: { method: string, displayText: string, checked: boolean }[];\r\n\tpublic methodOptions: ILookupOptions;\r\n\r\n\tpublic dropdownOptions: IApiSuite[];\r\n\tpublic operations: IOperation[];\r\n\tpublic metadataService: IonMetadataService;\r\n\tpublic focusedOperation: IOperation;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.ION_METADATA_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: IIonApiDialogFieldScope,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$cacheFactory: ng.ICacheFactoryService,\r\n\t\tdialogService: DialogService,\r\n\t\tionMetadataService: IonMetadataService\r\n\t) {\r\n\t\tsuper($scope, $element, $cacheFactory, dialogService, ionMetadataService);\r\n\r\n\t\tthis.setFilterOptions();\r\n\t}\r\n\r\n\tprivate setFilterOptions(): void {\r\n\t\tthis.filterOptions = [\r\n\t\t\t{ method: \"get\", displayText: \"Get\", checked: false },\r\n\t\t\t{ method: \"put\", displayText: \"Put\", checked: false },\r\n\t\t\t{ method: \"post\", displayText: \"Post\", checked: false },\r\n\t\t\t{ method: \"delete\", displayText: \"Delete\", checked: false },\r\n\t\t\t{ method: \"patch\", displayText: \"Patch\", checked: false },\r\n\t\t\t{ method: \"head\", displayText: \"Head\", checked: false },\r\n\t\t];\r\n\t\tthis.$scope.methodsFilter = (operation: IOperation): boolean => {\r\n\t\t\t// TODO: Hacky way to run the filter function with correct scope...\r\n\t\t\tconst allUnchecked = this.filterOptions.filter(f => f.checked).length === 0;\r\n\t\t\tlet operationShouldPass = false;\r\n\t\t\tif (allUnchecked) {\r\n\t\t\t\t// Apply no filters\r\n\t\t\t\toperationShouldPass = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.filterOptions.forEach(opt => {\r\n\t\t\t\t\tif (opt.method === operation.method && opt.checked) {\r\n\t\t\t\t\t\toperationShouldPass = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn operationShouldPass;\r\n\t\t};\r\n\t}\r\n\r\n\tpublic setDropdownOptions(): void {\r\n\t\tthis.isBusy = true;\r\n\t\tthis.metadataService.getApiSuites()\r\n\t\t\t.then(suites => {\r\n\t\t\t\tthis.dropdownOptions = suites;\r\n\t\t\t\tthis.dropdownOptions.unshift({ description: \"All\", name: \"All\", suiteContext: undefined, type: \"\" });\r\n\t\t\t\tthis.$scope.selectedOption = this.dropdownOptions[0];\r\n\t\t\t})\r\n\t\t\t.catch(() => this.showError(new ErrorResponse(\r\n\t\t\t\t`Could not get suite list. ${Subcodes.CONTACT_SYSTEM_ADMIN}`, Subcodes.GENERIC_ERROR\r\n\t\t\t)))\r\n\t\t\t.finally(() => {\r\n\t\t\t\tthis.isBusy = false;\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic getListItems(selectedOption: IApiSuite, query: string): ng.IPromise<any> {\r\n\t\tconst suiteContext = selectedOption && selectedOption.suiteContext ?\r\n\t\t\tselectedOption.suiteContext : undefined;\r\n\r\n\t\treturn this.metadataService.searchOperations(suiteContext, query, this.pageNo);\r\n\t}\r\n\r\n\tpublic handleRequestError(errorResponse: ng.IHttpPromiseCallbackArg<any>): void {\r\n\t\tlet error: ErrorResponse;\r\n\t\tif (!(errorResponse instanceof ErrorResponse)) {\r\n\t\t\terror = new ErrorResponse(errorResponse.statusText, errorResponse.status);\r\n\t\t} else {\r\n\t\t\tthis.showError(new ErrorResponse(\r\n\t\t\t\t`Could not perform search request. ${Subcodes.CONTACT_SYSTEM_ADMIN}`,\r\n\t\t\t\terrorResponse.code,\r\n\t\t\t\terrorResponse.message));\r\n\t\t}\r\n\t\tthis.showError(error);\r\n\t}\r\n\r\n\tpublic showOperationDetails(operation: IOperation): void {\r\n\t\tconst openDialog = (swaggerDocument: IDocument) => {\r\n\t\t\tconst options: IDialogOptions<IonApiOperationDetailsParameter> = {\r\n\t\t\t\ttitle: `Operation details - ${operation.operationSummary}`,\r\n\t\t\t\ttemplate: require(\"./ion-api-operation-details.html\"),\r\n\t\t\t\tcssClass: \"operation-details\",\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\toperation,\r\n\t\t\t\t\tswaggerDocument\r\n\t\t\t\t},\r\n\t\t\t\tbuttons: [{\r\n\t\t\t\t\ttext: \"Close\",\r\n\t\t\t\t\tclick: (event: Event, modal: IDialog<void>) => {\r\n\t\t\t\t\t\tmodal.close();\r\n\t\t\t\t\t}\r\n\t\t\t\t}],\r\n\t\t\t\tid: \"dataservice-search-wizard\"\r\n\t\t\t};\r\n\t\t\tthis.$scope.eirDialog.hide();\r\n\t\t\tthis.dialogService.show(options).then(() => {\r\n\t\t\t\tthis.$scope.eirDialog.show();\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.showSwaggerDocumentation(operation, openDialog);\r\n\t}\r\n\r\n\tprivate getSwaggerDocumentFromCache(operation: IOperation): IDocument {\r\n\t\tlet cacheKey = \"\";\r\n\t\tswitch (operation.suiteContext) {\r\n\t\t\tcase \"M3\":\r\n\t\t\t\tcacheKey = operation.swaggerJsonFilePath;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"IDM\":\r\n\t\t\tcase \"Mingle\":\r\n\t\t\tdefault:\r\n\t\t\t\tcacheKey = operation.swaggerOperationId;\r\n\t\t}\r\n\t\treturn this.cacheObject.get(cacheKey);\r\n\t}\r\n\r\n\tprivate addSwaggerDocumentToCache(\r\n\t\toperation: IOperation,\r\n\t\tswaggerDocument: IDocument\r\n\t): void {\r\n\t\tlet cacheKey = \"\";\r\n\t\tswitch (operation.suiteContext) {\r\n\t\t\tcase \"M3\":\r\n\t\t\t\tcacheKey = operation.swaggerJsonFilePath;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"IDM\":\r\n\t\t\tcase \"Mingle\":\r\n\t\t\tdefault:\r\n\t\t\t\tcacheKey = operation.swaggerOperationId;\r\n\t\t}\r\n\t\tthis.cacheObject.put(cacheKey, swaggerDocument);\r\n\t}\r\n\r\n\tprivate isValidSwaggerDocument(item: any): boolean {\r\n\t\t// IDM returns 200 OK even though it is an error.\r\n\t\t// More checks might needed in future\r\n\t\tif (typeof item === \"string\") {\r\n\t\t\treturn item.toLowerCase().indexOf(\"error\") !== 0;\r\n\t\t}\r\n\r\n\t\treturn typeof item === \"object\" && item !== null;\r\n\t}\r\n\r\n\tpublic runCreateNewWizard(operation: IOperation): void {\r\n\t\tconst openDialog = (swaggerDocument: IDocument) => {\r\n\t\t\tconst options: IDialogOptions<IDatasourceWizardParameter> = {\r\n\t\t\t\ttitle: \"Create Data Service\",\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\tswaggerDocument,\r\n\t\t\t\t\tfocusedOperation: operation\r\n\t\t\t\t},\r\n\t\t\t\ttemplate: \"<eir-wizard ng-controller='eirDatasourceWizardCtrl as wizardCtrl'></eir-wizard>\",\r\n\t\t\t\tcssClass: \"wizard-dialog large\",\r\n\t\t\t\tid: \"datasource-wizard\"\r\n\t\t\t};\r\n\r\n\t\t\tthis.$scope.eirDialog.hide();\r\n\t\t\tthis.dialogService\r\n\t\t\t\t.show<IDatasourceWizardParameter, IJsonDatasource>(options)\r\n\t\t\t\t.then(result => {\r\n\t\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\tthis.$scope.eirDialog.close(result);\r\n\t\t\t\t\t} else { // cancel\r\n\t\t\t\t\t\tthis.$scope.eirDialog.show();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t};\r\n\r\n\t\tthis.showSwaggerDocumentation(operation, openDialog);\r\n\t}\r\n\r\n\tprivate showSwaggerDocumentation(operation: IOperation, openDialog: Function): void {\r\n\t\tconst swaggerDocument = this.getSwaggerDocumentFromCache(operation);\r\n\t\tif (swaggerDocument) {\r\n\t\t\topenDialog(swaggerDocument);\r\n\t\t} else {\r\n\t\t\tthis.isBusy = true;\r\n\t\t\tthis.metadataService.getSwaggerDoc(operation.swaggerJsonFilePath)\r\n\t\t\t\t.then(swaggerDocument => {\r\n\t\t\t\t\tif (this.isValidSwaggerDocument(swaggerDocument)) {\r\n\t\t\t\t\t\tthis.addSwaggerDocumentToCache(operation, swaggerDocument);\r\n\t\t\t\t\t\topenDialog(swaggerDocument);\r\n\t\t\t\t\t} else if (typeof swaggerDocument === \"string\") {\r\n\t\t\t\t\t\tthis.showError(swaggerDocument);\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tthis.showError(errorResponse);\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.isBusy = false;\r\n\t\t\t\t});\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tpublic showError(errorResponse: IErrorResponse | string): void {\r\n\t\tif (typeof errorResponse === \"object\" && errorResponse !== null) {\r\n\t\t\tconst errorStatus = errorResponse.code;\r\n\t\t\tconst errorMessage = `Status Code: ${errorStatus} <br><br>${this.getErrorMessage(errorResponse)}`;\r\n\t\t\tthis.dialogService.showError(\"Error\", errorMessage);\r\n\t\t} else if (typeof errorResponse === \"string\") {\r\n\t\t\tthis.dialogService.showError(\"Error\",  errorResponse);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getErrorMessage(errorResponse: IErrorResponse): string {\r\n\t\tconst errorStatus = errorResponse.code;\r\n\t\t// tslint:disable-next-line\r\n\t\tconst is500To599 = 500 <= errorStatus && errorStatus <= 599;\r\n\t\tif (is500To599) {\r\n\t\t\treturn `\r\n\t\t\t\tUnable to retrieve available ION API suits from ION API,\r\n\t\t\t\tif the issue persists please contact your system administrator.\r\n\t\t\t`;\r\n\t\t}\r\n\t\treturn errorResponse.message;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirIonApiSearchCtrl\", IonApiSearchCtrl);\r\n\t}\r\n}\r\n","import { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { ErrorResponse, IErrorResponse } from \"../../../../common/error-response\";\r\nimport { DialogButtonType, DialogService } from \"../../../../common/services/dialog-service\";\r\n\r\nexport interface IDataServiceSearch {\r\n\tsetDropdownOptions: () => void;\r\n\tgetListItems: (selectedOption: any, query: string) => ng.IPromise<any[]>;\r\n\tshowOperationDetails: (operation: any) => void;\r\n}\r\n\r\nexport interface ISearchDialogFieldScope extends IDialogBaseScope<void> {\r\n\tquery: string;\r\n\tselectedOption: any;\r\n}\r\n\r\nexport abstract class BaseSearchCtrl implements IDataServiceSearch {\r\n\t// Form\r\n\tpublic isBusy: boolean = false;\r\n\tpublic abstract dropdownOptions: any[];\r\n\tpublic abstract filterOptions: any[];\r\n\tpublic abstract operations: any[];\r\n\tpublic abstract focusedOperation: any;\r\n\r\n\t// Lazy load parameters\r\n\tprotected resultListContainerElement: ng.IAugmentedJQuery;\r\n\tprotected resultListElement: ng.IAugmentedJQuery;\r\n\tprotected previousPageHadResults: boolean;\r\n\tprotected pageNo = 0;\r\n\tprotected previousIndex: number;\r\n\r\n\t// Cache\r\n\tprotected cacheObject: ng.ICacheObject;\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: ISearchDialogFieldScope,\r\n\t\tprotected $element: ng.IAugmentedJQuery,\r\n\t\tprotected $cacheFactory: ng.ICacheFactoryService,\r\n\t\tprotected dialogService: DialogService,\r\n\t\tprotected metadataService: any,\r\n\t) {\r\n\t\tthis.setDropdownOptions();\r\n\r\n\t\tthis.resultListContainerElement = $element.find(\"#search-result-list\");\r\n\t\tthis.resultListElement = this.resultListContainerElement.children(\"ul\");\r\n\t\tthis.resultListContainerElement.on(\"scroll\", () =>\r\n\t\t\tthis.onResultListScroll()\r\n\t\t);\r\n\r\n\t\tconst childName = (this.constructor as any).name;\r\n\t\tthis.cacheObject =\r\n\t\t\tthis.$cacheFactory.get(childName) || this.$cacheFactory(childName);\r\n\t}\r\n\r\n\tpublic abstract setDropdownOptions(): void;\r\n\r\n\tpublic abstract getListItems(selectedOption: any, query: string): ng.IPromise<any[]>;\r\n\r\n\tpublic abstract showOperationDetails(operation: any): void;\r\n\r\n\tpublic abstract showError(error: IErrorResponse): void;\r\n\r\n\tprotected onToggleSelected(operation: any, index: number): void {\r\n\t\tif (this.previousIndex !== undefined) {\r\n\t\t\tthis.$element.find(\"#list-item-\" + this.previousIndex).toggleClass(\"is-selected\");\r\n\t\t}\r\n\t\tthis.previousIndex = index;\r\n\t\tthis.$element.find(\"#list-item-\" + index).toggleClass(\"is-selected\");\r\n\r\n\t\tthis.focusedOperation = operation;\r\n\t}\r\n\r\n\tprotected cancel(): void {\r\n\t\tthis.$scope.eirDialog.close({\r\n\t\t\tbutton: DialogButtonType.Cancel\r\n\t\t});\r\n\t}\r\n\r\n\tprotected back(): void {\r\n\t\tthis.$scope.eirDialog.close({\r\n\t\t\tbutton: DialogButtonType.Back\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Perform a search with the given suite and query.\r\n\t * When this method is called with getNextPage, new results will\r\n\t * be appended to the result list, and pageNo will be incremented.\r\n\t*/\r\n\tpublic searchOperations(selectedOption: any, query: string, getNextPage?: boolean): void {\r\n\t\tthis.$scope.query = query;\r\n\r\n\t\tif (!getNextPage) {\r\n\t\t\tthis.previousIndex = undefined;\r\n\t\t}\r\n\t\tif (getNextPage) {\r\n\t\t\tthis.pageNo += 1;\r\n\t\t} else {\r\n\t\t\tthis.previousPageHadResults = false;\r\n\t\t\tthis.operations = [];\r\n\t\t\tthis.pageNo = 0;\r\n\t\t}\r\n\t\tthis.isBusy = true;\r\n\t\tthis.getListItems(selectedOption, query)\r\n\t\t\t.then(operations => {\r\n\t\t\t\tthis.operations = this.operations.concat(operations);\r\n\t\t\t\tthis.previousPageHadResults = operations.length > 0;\r\n\t\t\t})\r\n\t\t\t.catch(this.handleRequestError.bind(this))\r\n\t\t\t.finally(() => this.isBusy = false);\r\n\t}\r\n\r\n\tpublic handleRequestError(errorResponse: ng.IHttpPromiseCallbackArg<any>): void {\r\n\t\tthis.previousPageHadResults = false;\r\n\t\tconst error = new ErrorResponse(errorResponse.statusText, errorResponse.status);\r\n\t\tthis.showError(error);\r\n\t}\r\n\r\n\t/**\r\n\t * When the search result list is scrolled, fetch more results if:\r\n\t *\r\n\t * Scroll-bar is at the bottom\r\n\t * Not currently busy with fetching results\r\n\t * The previous page returned results\r\n\t */\r\n\tprivate onResultListScroll(): void {\r\n\t\tconst scrollPositionBottomLimit = 0.95; // 95%\r\n\t\tconst scrollPosition = this.getResultListScrollPosition();\r\n\t\tif (\r\n\t\t\tscrollPosition > scrollPositionBottomLimit &&\r\n\t\t\t!this.isBusy &&\r\n\t\t\tthis.previousPageHadResults\r\n\t\t) {\r\n\t\t\tconst selectedOption = this.$scope.selectedOption;\r\n\t\t\tconst query = this.$scope.query;\r\n\t\t\tthis.searchOperations(selectedOption, query, true);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Get the scroll position (ratio [0, 1]) of the search result list.\r\n\t */\r\n\tprivate getResultListScrollPosition(): number {\r\n\t\tconst scrollHeight = this.resultListContainerElement.scrollTop();\r\n\t\tconst containerHeight = this.resultListContainerElement.height();\r\n\t\tconst listHeight = this.resultListElement.height();\r\n\t\treturn scrollHeight / (listHeight - containerHeight);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport { IDocument, IParameterObject } from \"ng2/common/model/swagger.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../../common/defines\";\r\nimport { IOperation } from \"../../../../../common/model/ion-metadata.model\";\r\nimport { CustomFormatters } from \"../../../../../common/sohoxi/custom-formatters\";\r\nimport { RepositoryHelper } from \"../../../repository-helper\";\r\nimport { IResponseDatagridData } from \"./ion-api-search-wizard-ctrl\";\r\n\r\n//tslint:disable-next-line:interface-name\r\nexport interface IonApiOperationDetailsParameter {\r\n\toperation: IOperation;\r\n\tswaggerDocument: IDocument;\r\n}\r\n\r\nexport class IonApiOperationDetails {\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tpublic parameterDatagridOption: IDataGridOptions<IParameterObject>;\r\n\tpublic responseDatagridOption: IDataGridOptions<IResponseDatagridData>;\r\n\r\n\tpublic get swaggerDocument(): IDocument {\r\n\t\treturn this.$scope.eirDialog.parameter.swaggerDocument;\r\n\t}\r\n\r\n\tpublic get operation(): IOperation {\r\n\t\treturn this.$scope.eirDialog.parameter.operation;\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<IonApiOperationDetailsParameter>\r\n\t) {\r\n\t\tthis.initParameterDatagrid();\r\n\t\tthis.initResponseDatagrid();\r\n\t\tthis.initDialogData();\r\n\t}\r\n\r\n\tprivate initDialogData(): void {\r\n\t\tconst swaggerOp = RepositoryHelper.getSwaggerOperation(\r\n\t\t\tthis.operation,\r\n\t\t\tthis.swaggerDocument\r\n\t\t);\r\n\t\tthis.parameterDatagridOption.dataset = swaggerOp.parameters;\r\n\r\n\t\tconst responseDataset: IResponseDatagridData[] = [];\r\n\t\tfor (const responseCode in swaggerOp.responses) {\r\n\t\t\tconst response = swaggerOp.responses[responseCode];\r\n\t\t\tresponseDataset.push(\r\n\t\t\t\tRepositoryHelper.mapSchemaToGridData(\r\n\t\t\t\t\tresponse.schema,\r\n\t\t\t\t\tresponse.description || responseCode\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.responseDatagridOption.dataset = responseDataset;\r\n\t}\r\n\r\n\tprivate initParameterDatagrid(): void {\r\n\t\tconst columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\tid: \"name\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"name\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: \"20%\",\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"description\",\r\n\t\t\t\tname: \"Description\",\r\n\t\t\t\tfield: \"description\",\r\n\t\t\t\twidth: \"20%\",\r\n\t\t\t\tsortable: false\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"type\",\r\n\t\t\t\tname: \"Type\",\r\n\t\t\t\tfield: \"type\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\twidth: \"20%\"\r\n\t\t\t},\r\n\t\t\t{ id: \"in\", name: \"In\", field: \"in\", sortable: false, width: \"20%\" },\r\n\t\t\t{\r\n\t\t\t\tid: \"required\",\r\n\t\t\t\tname: \"Required\",\r\n\t\t\t\tfield: \"required\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: \"20%\",\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"required\")\r\n\t\t\t}\r\n\t\t];\r\n\t\tthis.parameterDatagridOption = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: false,\r\n\t\t\tisList: true,\r\n\t\t\tsaveColumns: false\r\n\t\t};\r\n\t}\r\n\r\n\tprivate initResponseDatagrid(): void {\r\n\t\tthis.responseDatagridOption = {\r\n\t\t\tcolumns: [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"name\",\r\n\t\t\t\t\tname: \"Name\",\r\n\t\t\t\t\tfield: \"name\",\r\n\t\t\t\t\tformatter: Soho.Formatters.Tree,\r\n\t\t\t\t\twidth: \"33%\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"description\",\r\n\t\t\t\t\tname: \"Description\",\r\n\t\t\t\t\tfield: \"description\",\r\n\t\t\t\t\twidth: \"33%\"\r\n\t\t\t\t},\r\n\t\t\t\t{ id: \"type\", name: \"Type\", field: \"type\", width: \"33%\" }\r\n\t\t\t],\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: false,\r\n\t\t\ttreeGrid: true,\r\n\t\t\tisList: true,\r\n\t\t\tsaveColumns: false\r\n\t\t};\r\n\t}\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.controller(\"eirIonApiOperationDetails\", IonApiOperationDetails);\r\n\t}\r\n}\r\n","/**\r\n * Contains various utilities functions (as static methods).\r\n */\r\nimport jsonpath from \"jsonpath\";\r\n\r\nimport { Helper } from \"../../../../common/helper\";\r\n\r\nimport { RegexStrings } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\n\r\nexport type jsonValueTypes = string | number | Date | boolean;\r\nexport class DatasourceWizardHelper {\r\n\tstatic isSupportedIonApiDataservice(suite: string): boolean {\r\n\t\tconst value = suite.toUpperCase();\r\n\t\tconst result =\r\n\t\t\tvalue.indexOf(DatasourceTypeEnum.IDM) !== -1 ||\r\n\t\t\tvalue.indexOf(DatasourceTypeEnum.IDO) !== -1 ||\r\n\t\t\tvalue.indexOf(DatasourceTypeEnum.M3) !== -1 ||\r\n\t\t\tvalue.indexOf(DatasourceTypeEnum.MINGLE) !== -1;\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tstatic generateParameters(\r\n\t\tdatasource: IJsonGenericDatasource2,\r\n\t\tisInput = false\r\n\t): IParameterObject[] {\r\n\t\tconst root = isInput ? datasource.inputRootElement : datasource.outputRootElement;\r\n\t\tconst parameters: IParameterObject[] = [];\r\n\t\tconst jsonData = isInput ? datasource.bodyTemplate : datasource.outputJson;\r\n\t\tconst result = jsonpath.query(JSON.parse(jsonData), root);\r\n\r\n\t\t// if results exist, use them to find the parameters\r\n\t\tif (result.length === 1) {\r\n\t\t\tthis.findParameters(result[0], parameters, \"\", datasource.suite);\r\n\t\t\tthis.renameDuplicates(parameters);\r\n\t\t}\r\n\r\n\t\treturn parameters;\r\n\t}\r\n\r\n\tprivate static renameDuplicates(parameters: IParameterObject[]): void {\r\n\t\tparameters.forEach((parameter, index, parameters) => {\r\n\t\t\tconst alias = parameter.alias.toLowerCase();\r\n\t\t\tconst id = parameter.id;\r\n\t\t\tlet count = 1;\r\n\t\t\tparameters.forEach((parameter2) => {\r\n\t\t\t\tif (alias && alias === parameter2.alias.toLowerCase() && id !== parameter2.id) {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t\tparameter2.alias = parameter2.alias + count;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate static findParameters(\r\n\t\tobject: Object,\r\n\t\tparameters: IParameterObject[],\r\n\t\tpath = \"\",\r\n\t\tsuite: string\r\n\t): void {\r\n\t\tObject.entries(object).forEach(([key, value]: any) => {\r\n\t\t\tif (typeof value === \"object\" && !Array.isArray(value)) { // value is a object\r\n\t\t\t\tthis.findParameters(value, parameters, path + \".\" + key, suite);\r\n\t\t\t} else if (Array.isArray(value)) { // is array (assume all content is same type)\r\n\t\t\t\tif (typeof value[0] === \"object\") { // is array of objects\r\n\t\t\t\t\t// scenarios\r\n\t\t\t\t\t// 1. template object, e.g [{ \"prop1\": \"string\", \"prop2\": \"int\" ...}]\r\n\t\t\t\t\t// 3. M3 metadata [{\"@name\": \"value\" ...}, ...]\r\n\t\t\t\t\t// 2. named key-value pair (M3), e.g [{ \"Key\": \"name\", \"Value\": \"val\"}, ...]\r\n\r\n\t\t\t\t\tif (value.length === 1 && suite !== \"/M3\") { // template\r\n\t\t\t\t\t\tthis.findParameters(value[0], parameters, path + \".\" + key + \"[*]\", suite);\r\n\t\t\t\t\t} else if (Object.entries(value[0])[0][0].includes(\"@\")) { // metadata (M3)\r\n\t\t\t\t\t\tvalue.forEach((element, index) => {\r\n\t\t\t\t\t\t\tthis.findParameters(element, parameters, path + \".\" + key + \"[\" + index + \"]\", suite);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet propertyName = \"\";\r\n\t\t\t\t\t\tvalue.forEach((element, index, list) => {\r\n\t\t\t\t\t\t\tconst entries = Object.entries<string>(element);\r\n\t\t\t\t\t\t\tlet propertyValue: jsonValueTypes = \"\";\r\n\r\n\t\t\t\t\t\t\t// tslint:disable-next-line:no-magic-numbers\r\n\t\t\t\t\t\t\tif (entries.length === 2 && entries[1].length === 2) {\r\n\t\t\t\t\t\t\t\tpropertyValue = entries[1][1];\r\n\t\t\t\t\t\t\t\tpropertyName = entries[1][0];\r\n\r\n\t\t\t\t\t\t\t\tif (suite === \"/M3\") {\r\n\t\t\t\t\t\t\t\t\tpropertyValue = this.getm3OnpremValue(propertyValue);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (Helper.isUndefinedEmpty(propertyName)) {\r\n\t\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t\t\tif entries[1][1] happens to be undefined then the loop will\r\n\t\t\t\t\t\t\t\t\tlook forward to see if any other entries infront has entry which is defined\r\n\t\t\t\t\t\t\t\t\tand set the propertyName accordingly.\r\n\t\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\t\tlet doIndex = index;\r\n\t\t\t\t\t\t\t\tdo {\r\n\t\t\t\t\t\t\t\t\tconst entries = Object.entries<string>(list[doIndex]);\r\n\t\t\t\t\t\t\t\t\t// tslint:disable-next-line:no-magic-numbers\r\n\t\t\t\t\t\t\t\t\tif (entries.length === 2 && entries[1].length === 2) {\r\n\t\t\t\t\t\t\t\t\t\tpropertyName = entries[1][1];\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tdoIndex++;\r\n\r\n\t\t\t\t\t\t\t\t} while (Helper.isUndefinedEmpty(propertyName) ||\r\n\t\t\t\t\t\t\t\t\tdoIndex > value.length);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tparameters.push(\r\n\t\t\t\t\t\t\t\tDatasourceWizardHelper.createParameterObject(\r\n\t\t\t\t\t\t\t\t\t`${path}.${key}[?(@.${entries[0][0]}=='${entries[0][1]}')].${propertyName}`,\r\n\t\t\t\t\t\t\t\t\tentries[0][1],\r\n\t\t\t\t\t\t\t\t\tpropertyValue\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else { // array of values (string / int)\r\n\t\t\t\t\tparameters.push(DatasourceWizardHelper.createParameterObject(path + \".\" + key, key));\r\n\t\t\t\t}\r\n\t\t\t} else { // property in object\r\n\t\t\t\tconst newPath = key.includes(\"@\") ? path + \"['\" + key + \"']\" : path + \".\" + key;\r\n\t\t\t\tparameters.push(DatasourceWizardHelper.createParameterObject(newPath, key, value, suite));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate static getm3OnpremValue(sample: string): jsonValueTypes {\r\n\t\tswitch (sample) {  // M3 (named key-value pair)\r\n\t\t\tcase \"date\":\r\n\t\t\t\treturn \"1985-04-12\";\r\n\t\t\tcase \"date-time\":\r\n\t\t\t\treturn \"1985-04-12T23:20:50.52Z\";\r\n\t\t\tcase \"number\":\r\n\t\t\t\treturn 1;\r\n\t\t\tcase \"string\":\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"text\";\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static createParameterObject(\r\n\t\tkey: string,\r\n\t\talias: string,\r\n\t\tvalue?: any,\r\n\t\tdataserviceType?: string,\r\n\t): IParameterObject {\r\n\t\tconst dataType = this.getParameterType(value, dataserviceType);\r\n\t\tconst finalAlias = RegexStrings.FIRST_CHAR_LETTER.test(alias) ? alias : \"\";\r\n\r\n\t\treturn {\r\n\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\tkey,\r\n\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\tparameterType: ParameterTypeEnum.OUTPUT,\r\n\t\t\trequired: false,\r\n\t\t\talias: finalAlias,\r\n\t\t\tdataType\r\n\t\t};\r\n\t}\r\n\r\n\tstatic getParameterType(value: any, dataserviceType: string): string {\r\n\t\tconst type = typeof value;\r\n\t\tlet dataType = \"\";\r\n\t\tswitch (type) {\r\n\t\t\tcase \"number\":\r\n\t\t\t\tdataType = this.getNumericType(value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"string\":\r\n\t\t\t\tdataType = this.getStringType(value, dataserviceType);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"boolean\":\r\n\t\t\t\tdataType = \"Boolean\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tdataType = \"String\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn dataType;\r\n\t}\r\n\r\n\tstatic getStringType(\r\n\t\tvalue: string,\r\n\t\tdataserviceType = \"\"): string {\r\n\r\n\t\tlet date = new Date(value);\r\n\t\tif (DatasourceWizardHelper.isSupportedIonApiDataservice(dataserviceType)) {\r\n\t\t\tdate = DateHelper.parse(value);\r\n\t\t}\r\n\r\n\t\tif (date.toString() !== \"Invalid Date\") {\r\n\t\t\tif (date.getHours() !== 0) {\r\n\t\t\t\tconst dateSplit = value.split(\":\");\r\n\r\n\t\t\t\tif (dateSplit.length > 1) {\r\n\t\t\t\t\treturn \"Date Time\";\r\n\t\t\t\t}\r\n\t\t\t\treturn \"Date\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (value.toLowerCase() === \"true\" || value.toLowerCase() === \"false\") {\r\n\t\t\treturn \"Boolean\";\r\n\t\t}\r\n\r\n\t\tif (jQuery.isNumeric(value)) {\r\n\t\t\treturn this.getNumericType(value);\r\n\t\t}\r\n\r\n\t\tif (RegexStrings.EMAIL.test(value)) {\r\n\t\t\treturn \"Email\";\r\n\t\t}\r\n\r\n\t\treturn \"String\";\r\n\t}\r\n\r\n\tstatic getNumericType(value: string): string {\r\n\t\tconst MIN_LONG_INTEGER = -9223372036854775808;\r\n\t\tconst MAX_LONG_INTEGER = 9223372036854775808;\r\n\t\tconst MIN_SHORT_INTEGER = -32768;\r\n\t\tconst MAX_SHORT_INTEGER = 32768;\r\n\t\tconst numericValue = Number(value);\r\n\t\tif (Helper.isFloat(numericValue)) {\r\n\t\t\treturn \"Decimal\";\r\n\t\t} else {\r\n\t\t\tif (numericValue >= MIN_SHORT_INTEGER && numericValue <= MAX_SHORT_INTEGER) {\r\n\t\t\t\treturn \"Short Integer\";\r\n\t\t\t}\r\n\t\t\tif (numericValue >= MIN_LONG_INTEGER && numericValue <= MAX_LONG_INTEGER) {\r\n\t\t\t\treturn \"Long Integer\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn \"Integer\";\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { InjectNames, RegexStrings } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentRendered, SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { ErrorResponse } from \"../../../../common/error-response\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport { IListViewApi, IListViewOptions } from \"../../../../common/model/sohoxi/sohoxi-listview.model\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../../../common/services/feature-switch-service\";\r\nimport { IValidationResult, IValidatorError } from \"../../../../common/shared-components/base/field-validation\";\r\nimport { IOnComponentChangeNotification } from \"../../../../common/shared-components/base/notifiable-component\";\r\nimport { LISTVIEW_RENDERED } from \"../../../../common/sohoxi/component/listview-directive\";\r\nimport { LocalIdoService } from \"../../../../components/services/local-ido-service\";\r\nimport { IWizardStep, WizardCtrl } from \"../../../editor/wizard/wizard-ctrl\";\r\nimport { RepositoryService } from \"../../repository-service\";\r\nimport { CollectionData, CollectionProperty } from \"../collection-data\";\r\n\r\nexport class IdoValidator {\r\n\tstatic isValidName(value: string): IValidationResult {\r\n\t\tif (value.indexOf(\" \") !== -1) {\r\n\t\t\treturn { status: false, errorMessage: \"Name cannot contain spaces\" };\r\n\t\t} else if (RegexStrings.SPECIAL_CHARACTERS.test(value)) {\r\n\t\t\treturn { status: false, errorMessage: \"Name cannot contain special characters\" };\r\n\t\t} else if (RegexStrings.STARTS_WITH_NUMBER.test(value)) {\r\n\t\t\treturn { status: false, errorMessage: \"Name cannot begin with a number\" };\r\n\t\t}\r\n\r\n\t\treturn { status: true };\r\n\t}\r\n\r\n\tstatic isUniqueName(value: string, collections: string[]): IValidationResult {\r\n\t\tconst isDuplicateName = (value: string): boolean => {\r\n\t\t\treturn collections\r\n\t\t\t\t.find(item => item.toLowerCase() === value.toLowerCase()) !== undefined;\r\n\t\t};\r\n\r\n\t\tif (isDuplicateName(value)) {\r\n\t\t\treturn {\r\n\t\t\t\tstatus: false, errorMessage: `The name '${value}' is already used by an existing IDO.` };\r\n\t\t}\r\n\r\n\t\treturn { status: true };\r\n\t}\r\n}\r\n\r\nexport class IdoWizardCtrl extends WizardCtrl {\r\n\tsteps: IWizardStep[] = [\r\n\t\t{\r\n\t\t\tid: \"ido-wizard-basic.html\",\r\n\t\t\ttitle: \"Name & Description\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./ido-wizard-basic.html\")\r\n\t\t},\r\n\t\t{\r\n\t\t\tid: \"ido-wizard-properties.html\",\r\n\t\t\ttitle: \"Create Properties\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./ido-wizard-properties.html\")\r\n\t\t},\r\n\t\t{\r\n\t\t\tid: \"ido-wizard-summary.html\",\r\n\t\t\ttitle: \"Summary\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./ido-wizard-summary.html\")\r\n\t\t},\r\n\t];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TEMPLATE_CACHE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t\tInjectNames.LOCAL_IDO_SERVICE,\r\n\t\tInjectNames.REPOSITORY_SERVICE,\r\n\t];\r\n\r\n\tget isCurrentPropertyValid(): boolean {\r\n\t\tconst currentProperty = this.selectedProperty;\r\n\r\n\t\tconst isCurrentUndefined = Helper.isUndefined(currentProperty);\r\n\t\tif (isCurrentUndefined) {\r\n\t\t\treturn isCurrentUndefined;\r\n\t\t}\r\n\r\n\t\t// check mandatory fields are set and errorList is empty\r\n\t\tlet invalidProperty = this.verifyErrorList() ||\r\n\t\t\t(Helper.isUndefinedEmpty(currentProperty.dataType) ||\r\n\t\t\tHelper.isUndefinedEmpty(currentProperty.propertyLength) ||\r\n\t\t\tHelper.isUndefinedEmpty(currentProperty.name));\r\n\r\n\t\t// check if data type is 'date' then property is valid without property length\r\n\t\tif (invalidProperty &&\r\n\t\t\t!Helper.isUndefinedEmpty(currentProperty.dataType) &&\r\n\t\t\tcurrentProperty.dataType === \"Date\" &&\r\n\t\t\t!Helper.isUndefinedEmpty(currentProperty.name)\r\n\t\t) {\r\n\t\t\tinvalidProperty = false;\r\n\t\t}\r\n\r\n\t\t// check mandatory fields are set for dataType 'Decimal'\r\n\t\tif (!invalidProperty &&\r\n\t\t\t!Helper.isUndefinedEmpty(currentProperty.dataType) &&\r\n\t\t\tcurrentProperty.dataType === \"Decimal\" &&\r\n\t\t\tHelper.isUndefinedEmpty(currentProperty.decimalLength)\r\n\t\t) {\r\n\t\t\tinvalidProperty = true;\r\n\t\t}\r\n\r\n\t\treturn !invalidProperty;\r\n\t}\r\n\r\n\tprivate verifyErrorList(): boolean {\r\n\t\treturn this.errorList\r\n\t\t\t.filter(item => typeof item !== \"boolean\").length !== 0;\r\n\t}\r\n\r\n\tget addPropertyToolTip(): string {\r\n\t\tif (this.verifyErrorList()) {\r\n\t\t\treturn \"Correct errors in current property before adding new.\";\r\n\t\t}\r\n\t\treturn this.isCurrentPropertyValid ?\r\n\t\t\t\"Add Property\" :\r\n\t\t\t\"You are missing one or more mandatory fields. Complete before adding new\";\r\n\t}\r\n\r\n\tget ErrorList(): any[] {\r\n\t\tthis.setNextDisabled();\r\n\t\tthis.setErrorToListItem();\r\n\t\treturn this.errorList;\r\n\t}\r\n\r\n\tprivate setErrorToListItem(): void {\r\n\t\tthis.collection.properties.forEach(property => {\r\n\t\t\tdelete property.alert;\r\n\t\t\tdelete property.alertClass;\r\n\t\t});\r\n\t\tthis.errorList.forEach((error: IValidatorError) => {\r\n\t\t\tconst propertyFound = this.collection.properties\r\n\t\t\t\t.find(property => property.id === error.id);\r\n\t\t\tif (propertyFound) {\r\n\t\t\t\tpropertyFound.alert = true;\r\n\t\t\t\tpropertyFound.alertClass = \"error\";\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setNextDisabled(): void {\r\n\t\tconst hasCollectionPrimaryProperty = () => {\r\n\t\t\treturn this.collection.properties\r\n\t\t\t\t.some(property => property.primaryKey);\r\n\t\t};\r\n\r\n\t\tconst currentStepTitle = this.currentStep.title;\r\n\t\tlet isDisabled: boolean;\r\n\r\n\t\tif (currentStepTitle === this.steps[0].title) {\r\n\t\t\tisDisabled = Helper.isUndefinedEmpty(this.collection.name) ||\r\n\t\t\t\tHelper.isUndefinedEmpty(this.collection.idoProject) ||\r\n\t\t\t\tHelper.isUndefinedEmpty(this.collection.tableAlias);\r\n\t\t} else if (currentStepTitle === this.steps[1].title) {\r\n\t\t\tisDisabled = this.collection.properties.length === 0 ||\r\n\t\t\t\t!hasCollectionPrimaryProperty() ||\r\n\t\t\t\t!this.isCurrentPropertyValid;\r\n\t\t}\r\n\r\n\t\tthis.nextDisabled = isDisabled || this.errorList.length !== 0;\r\n\t}\r\n\r\n\tcollection: CollectionData;\r\n\tlistviewOptions: IListViewOptions;\r\n\tlistviewId = \"properties-listview\";\r\n\tselectedProperty: CollectionProperty;\r\n\tidoProjects: string[] = [];\r\n\r\n\tprivate listApi: IListViewApi;\r\n\tprivate idoCollectionUsedToValidateNameIsUnique: string[];\r\n\r\n\tconstructor(\r\n\t\t$scope: IDialogBaseScope<any>,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$templateCache: ng.ITemplateCacheService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t\tprivate localIdoService: LocalIdoService,\r\n\t\tprivate repositoryService: RepositoryService,\r\n\r\n\t) {\r\n\t\tsuper(\r\n\t\t\t$scope,\r\n\t\t\t$element,\r\n\t\t\t$templateCache,\r\n\t\t\tfeatureService,\r\n\t\t);\r\n\t\tthis.initWizard();\r\n\t\tthis.collection = {\r\n\t\t\tproperties: []\r\n\t\t} as any;\r\n\r\n\t\tthis.initIdoWizard();\r\n\t\tthis.$element.off()\r\n\t\t\t.on(\r\n\t\t\t\tLISTVIEW_RENDERED,\r\n\t\t\t\t(event, result: IComponentRendered) => {\r\n\t\t\t\t\tif (result.id === this.listviewId) {\r\n\t\t\t\t\t\tthis.listApi = result.api;\r\n\t\t\t\t\t\tthis.listApi.element.on(\"click\",\r\n\t\t\t\t\t\t\t(event: JQueryEventObject, selectedItem: any) => {\r\n\t\t\t\t\t\t\t\tif (this.selectedProperty.id !== selectedItem.data.id) {\r\n\t\t\t\t\t\t\t\t\t$scope.$applyAsync(() => {\r\n\t\t\t\t\t\t\t\t\t\tthis.selectedProperty = selectedItem.data;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t}\r\n\r\n\tgetIdoProjects(): ng.IPromise<string[]> {\r\n\t\treturn this.localIdoService.getIdoProjectList()\r\n\t\t\t.then(result => {\r\n\t\t\t\treturn result.map(item => item.serverName);\r\n\t\t\t});\r\n\t}\r\n\r\n\tadd(): void {\r\n\t\tconst newProperty = {\r\n\t\t\tid: Helper.generateUniqueId()\r\n\t\t};\r\n\t\tthis.collection.properties.push(newProperty);\r\n\t\tthis.selectedProperty = newProperty;\r\n\t}\r\n\r\n\tdelete(): void {\r\n\t\tconst deleteRow = (id: string): number => {\r\n\t\t\tconst index = this.collection.properties\r\n\t\t\t\t.findIndex(item => item.id === id);\r\n\r\n\t\t\t// delete entry\r\n\t\t\tthis.collection.properties.splice(index, 1);\r\n\r\n\t\t\treturn index;\r\n\t\t};\r\n\r\n\t\tconst setNextSelectedRow = (index: number) => {\r\n\t\t\tlet nextEntryIndex = index - 1;\r\n\t\t\tif (nextEntryIndex === -1) {\r\n\t\t\t\tnextEntryIndex = 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.collection.properties.length === 0) {\r\n\t\t\t\tthis.selectedProperty = undefined;\r\n\t\t\t} else {\r\n\t\t\t\tthis.selectedProperty =\r\n\t\t\t\t\tthis.collection.properties[nextEntryIndex];\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst selectedRows = this.listApi.getSelected();\r\n\t\tlet index: number;\r\n\r\n\t\tthis.dialogService\r\n\t\t\t.showYesNo(\r\n\t\t\t\t\"Delete Property\",\r\n\t\t\t\t`Do you want to delete ${Helper.isUndefinedEmpty(this.selectedProperty.name) ?\r\n\t\t\t\t\t\"the selected property\" :\r\n\t\t\t\t\t\"'\" + this.selectedProperty.name + \"'\"}?`)\r\n\t\t\t.then(result => {\r\n\t\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\t\tif (selectedRows.length > 1) { // multiple delete\r\n\t\t\t\t\t\tselectedRows.each((_, row) => {\r\n\t\t\t\t\t\t\tindex = deleteRow(row.id);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (selectedRows.length === 1 || this.selectedProperty) {\r\n\t\t\t\t\t\tindex = deleteRow(this.selectedProperty.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetNextSelectedRow(index);\r\n\r\n\t\t\t\t\tthis.setNextDisabled();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tpreview(): void {\r\n\t\tconst option: IDialogOptions<CollectionProperty[]> = {\r\n\t\t\ttitle: \"Preview IDO Properties\",\r\n\t\t\ttemplate: require(\"./preview-dialog/preview-template.html\"),\r\n\t\t\tparameter: this.collection.properties,\r\n\t\t\tcssClass: \"wizard-dialog large\"\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(option);\r\n\t}\r\n\r\n\topenTypeHelp = this.showTypeHelp.bind(this);\r\n\r\n\tshowTypeHelp(): void {\r\n\t\t// tslint:disable:max-line-length\r\n\t\tconst message =\r\n\t\t\t\"<b>Boolean</b> - Used for True(1) or False(0) values. <br><br>\" +\r\n\t\t\t\"<b>Date</b> -  Used for date and/or time values. <br><br>\" +\r\n\t\t\t\"<b>Decimal</b> - Used for decimal number values that have a fixed precision and scale. Valid precision values are 1 to 38. <br><br>\" +\r\n\t\t\t\"<b>File</b> - Used for Binary Large OBject (BLOB) data, such as image or audio files. <br><br>\" +\r\n\t\t\t\"<b>Integer</b> - Used for integer values. <br><br>\" +\r\n\t\t\t\"<b>String</b> - Used for text strings. Valid characters include all alphanumeric characters such as #, %, & and so on. \";\r\n\t\t// tslint:enable:max-line-length\r\n\r\n\t\tconst showOptions = {\r\n\t\t\tmessage: message,\r\n\t\t\ttitle: \"Data Type Help\",\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(showOptions);\r\n\t}\r\n\r\n\tisValidName(\r\n\t\tvalue: string\r\n\t): IValidationResult {\r\n\t\treturn IdoValidator.isValidName(value);\r\n\t}\r\n\r\n\tisUniqueName(\r\n\t\tvalue: string\r\n\t): IValidationResult {\r\n\t\treturn IdoValidator\r\n\t\t\t.isUniqueName(value, this.idoCollectionUsedToValidateNameIsUnique);\r\n\t}\r\n\r\n\tprotected onChangeCurrentStep(): void {\r\n\t\tthis.errorList.length = 0;\r\n\t}\r\n\r\n\tprotected getFinishParameter(): CollectionData {\r\n\t\tthis.collection.tableName = this.collection.name;\r\n\r\n\t\treturn this.collection;\r\n\t}\r\n\r\n\tprivate initIdoWizard(): void {\r\n\t\tthis.nextDisabled = true;\r\n\t\tthis.initIdoProjectDropdown();\r\n\t\tthis.initListviewOptions();\r\n\t\tthis.loadIdoCollections();\r\n\t}\r\n\r\n\tprivate initIdoProjectDropdown(): void {\r\n\t\tthis.getIdoProjects().then(result => {\r\n\t\t\tthis.$scope\r\n\t\t\t\t.$applyAsync(() => this.idoProjects = result);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initListviewOptions(): void {\r\n\t\tconst template =\r\n\t\t`<ul>\r\n\t\t\t{{#dataset}}\r\n\t\t\t\t{{#alert}}\r\n\t\t\t\t<li class=\"{{alertClass}}\">\r\n\t\t\t\t\t<p class=\"listview-heading\">{{name}}</p>\r\n\t\t\t\t\t<p class=\"listview-micro\">{{dataType}}</p>\r\n\t\t\t\t</li>\r\n\t\t\t\t{{/alert}}\r\n\t\t\t\t{{^alert}}\r\n\t\t\t\t<li id=\"{{id}}\">\r\n\t\t\t\t\t<p class=\"listview-heading\">{{name}}</p>\r\n\t\t\t\t\t<p class=\"listview-micro\">{{dataType}}</p>\r\n\t\t\t\t</li>\r\n\t\t\t\t{{/alert}}\r\n\t\t\t{{/dataset}}\r\n\t\t</ul>`;\r\n\r\n\t\tthis.listviewOptions = {\r\n\t\t\tid: this.listviewId,\r\n\t\t\tdataset: this.collection.properties,\r\n\t\t\ttemplate,\r\n\t\t\tselectable: SelectableEnum.Mixed,\r\n\t\t\tshowCheckboxes: false,\r\n\t\t\tselectOnFocus: false,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate loadIdoCollections(): void {\r\n\r\n\t\tthis.localIdoService.getIdoCollectionList()\r\n\t\t\t.then(result => {\r\n\t\t\t\tthis.idoCollectionUsedToValidateNameIsUnique =\r\n\t\t\t\t\tresult.map(collection => collection.collectionName);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate setTableAlias(idoName: string): void {\r\n\t\tlet alias: string;\r\n\t\tif (idoName) {\r\n\t\t\tconst shortHand = idoName.replace(/[a-z]/g, \"\");\r\n\t\t\tif (shortHand) {\r\n\t\t\t\talias = shortHand.slice(0,3) + \"_AB\";\r\n\t\t\t} else {\r\n\t\t\t\talias = idoName.slice(0, 3) + \"_AB\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.collection.tableAlias = alias;\r\n\t}\r\n\r\n\tsharedErrors: any;\r\n\r\n\tgetValidation($data: IOnComponentChangeNotification): IValidationResult {\r\n\t\tlet result: IValidationResult;\r\n\t\tswitch ($data.validator) {\r\n\t\t\tcase \"isValidName\":\r\n\t\t\t\tresult = this.isValidName($data.value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"isUniqueName\":\r\n\t\t\t\tresult = this.isUniqueName($data.value);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tnotify($data: IOnComponentChangeNotification): boolean | IValidationResult {\r\n\t\tthis.setTableAlias($data.value);\r\n\t\treturn super.notify($data);\r\n\t}\r\n\r\n\tclose(parameter: IDialogResult<CollectionData>): void {\r\n\t\tif (parameter.button === DialogButtonType.Ok) {\r\n\t\t\tthis.isBusy = true;\r\n\t\t\tthis.repositoryService\r\n\t\t\t\t.createIDO(parameter.value)\r\n\t\t\t\t.then(successful => {\r\n\t\t\t\t\tthis.isBusy = false;\r\n\t\t\t\t\tif (successful) {\r\n\t\t\t\t\t\tthis.dialog.close(parameter);\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error: ErrorResponse) => {\r\n\t\t\t\t\tthis.isBusy = false;\r\n\t\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\t\t\"Could not create table\",\r\n\t\t\t\t\t\t`Error due to \"<b>${error.message}</b>\"<br />\r\n\t\t\t\t\t\tThis could happen when an IDO was not correctly removed. Please contact your system administrator.`);\r\n\t\t\t\t});\r\n\t\t} else { // close is called if cancel as well. this route happens on cancel\r\n\t\t\tthis.dialog.close(parameter);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirIdoWizardCtrl\", IdoWizardCtrl);\r\n\t}\r\n}\r\n","//export enum WizardPaneEnum { Basic = 1, EventSource = 2, EventTarget = 3, EventParameters = 4 }\r\n\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { IDesignerMashup } from \"ng2/common/model/project/mashup/designer-mashup.model\";\r\n\r\nimport { IRootScope } from \"../common/services/common-service\";\r\n\r\nimport\"./images/createPage/01-thumb.png\";\r\nimport\"./images/createPage/010-thumb.png\";\r\nimport\"./images/createPage/011-thumb.png\";\r\nimport\"./images/createPage/012-thumb.png\";\r\nimport\"./images/createPage/013-thumb.png\";\r\nimport\"./images/createPage/02-thumb.png\";\r\nimport\"./images/createPage/03-thumb.png\";\r\nimport\"./images/createPage/04-thumb.png\";\r\nimport\"./images/createPage/05-thumb.png\";\r\nimport\"./images/createPage/06-thumb.png\";\r\nimport\"./images/createPage/07-thumb.png\";\r\nimport\"./images/createPage/08-thumb.png\";\r\nimport\"./images/createPage/09-thumb.png\";\r\n\r\nexport interface IPageTemplate {\r\n\tidx: number;\r\n\timgSrc: string;\r\n}\r\n\r\nexport interface IApplicationTemplate extends IPageTemplate {\r\n\tboundaries: IBoundary[];\r\n}\r\n\r\nexport interface IFinderModeOptions {\r\n\ttitle: string;\r\n\tcancel?: Function;\r\n\thideCancel?: boolean;\r\n\tcloseOnSelect?: boolean;\r\n}\r\n\r\nexport interface IDesignerRootScope extends IRootScope {\r\n\tview: string;\r\n\tsidebarView: string;\r\n\tcurrentProject: IDesignerMashup;\r\n}\r\n\r\nexport const PAGE_TEMPLATES: IPageTemplate[] = [\r\n\t{ idx: 1, imgSrc: \"designer/images/createPage/01-thumb.png\" },\r\n\t{ idx: 2, imgSrc: \"designer/images/createPage/02-thumb.png\" },\r\n\t{ idx: 3, imgSrc: \"designer/images/createPage/03-thumb.png\" },\r\n\t{ idx: 4, imgSrc: \"designer/images/createPage/04-thumb.png\" },\r\n\t{ idx: 5, imgSrc: \"designer/images/createPage/05-thumb.png\" },\r\n\t{ idx: 6, imgSrc: \"designer/images/createPage/06-thumb.png\" },\r\n\t{ idx: 7, imgSrc: \"designer/images/createPage/07-thumb.png\" },\r\n\t{ idx: 8, imgSrc: \"designer/images/createPage/08-thumb.png\" },\r\n\t{ idx: 9, imgSrc: \"designer/images/createPage/09-thumb.png\" },\r\n\t{ idx: 10, imgSrc: \"designer/images/createPage/010-thumb.png\" },\r\n\t{ idx: 11, imgSrc: \"designer/images/createPage/011-thumb.png\" },\r\n\t{ idx: 12, imgSrc: \"designer/images/createPage/012-thumb.png\" },\r\n\t{ idx: 13, imgSrc: \"designer/images/createPage/013-thumb.png\" },\r\n\t//{ idx: 14, imgSrc: \"designer/images/createPage/014-thumb.png\" },\r\n\t//{ idx: 15, imgSrc: \"designer/images/createPage/015-thumb.png\" }\r\n];\r\n","export default \"../designer/images/createPage/02-thumb.png\";","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { IJsonChartDataset } from \"ng2/common/model/databearer/components/json-chart.model\";\r\n\r\nimport { IAvailableSourceField, IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { ChartDialogActionEnum } from \"./chart-settings\";\r\n\r\nexport interface IChartDialogOptions {\r\n\tcontent: IChartDialogContent;\r\n\ttype: ChartDialogActionEnum;\r\n}\r\n\r\nexport interface IChartDialogContent {\r\n\tchartContent?: IJsonChartDataset;\r\n\tsourceFields: IAvailableSourceField[];\r\n}\r\n\r\nexport interface IChartDialogResult {\r\n\tcontent?: IJsonChartDataset;\r\n\tdialogAction: ChartDialogActionEnum;\r\n}\r\n\r\nexport class ChartSettingsDialogCtrl {\r\n\ttype: ChartDialogActionEnum;\r\n\tchartActionEnum = ChartDialogActionEnum;\r\n\tprivate dialog: IDialog<IChartDialogOptions>;\r\n\tprivate content: IChartDialogContent;\r\n\tprivate selectedCategory: IAvailableSourceField;\r\n\tprivate selectedSeries: IAvailableSourceField;\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<IChartDialogOptions>) {\r\n\t\tconst dialog: IDialog<IChartDialogOptions> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.type = dialog.parameter.type;\r\n\t\tthis.content = dialog.parameter.content;\r\n\t\tthis.setSelectedSourceField();\r\n\t}\r\n\r\n\tprivate setSelectedSourceField(): void {\r\n\t\tconst sourceFields = this.content.sourceFields;\r\n\t\tconst chartContent = this.content.chartContent;\r\n\t\tfor (let i = 0; i < sourceFields.length; i++) {\r\n\t\t\tif (sourceFields[i].sourceKeyShort === chartContent.categories) {\r\n\t\t\t\tthis.selectedCategory = sourceFields[i];\r\n\t\t\t}\r\n\t\t\tif (sourceFields[i].sourceKeyShort === chartContent.series) {\r\n\t\t\t\tthis.selectedSeries = sourceFields[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tconst result: IDialogResult<void> = {\r\n\t\t\tbutton: DialogButtonType.Cancel\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\t/**\r\n\t * Triggered in view from the edit dataset dialog.\r\n\t *\r\n\t * @param {boolean} [isNewContent=false]\r\n\t *\r\n\t * @memberOf EditSerieCtrl\r\n\t */\r\n\tsave(): void {\r\n\t\tthis.content.chartContent.categories = this.selectedCategory ? this.selectedCategory.sourceKeyShort : null;\r\n\t\tthis.content.chartContent.series = this.selectedSeries ? this.selectedSeries.sourceKeyShort : null;\r\n\t\tconst result: IDialogResult<IChartDialogResult> = {\r\n\t\t\tvalue: {\r\n\t\t\t\tdialogAction: this.type,\r\n\t\t\t\tcontent: this.content.chartContent\r\n\t\t\t},\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirChartSettingsDialogCtrl\", ChartSettingsDialogCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { EditorHelper } from \"../helper\";\r\n\r\nimport {\r\n\tComponentNames,\r\n\tInjectNames,\r\n\tNumbers,\r\n\tSaveFlagsEnum,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { FormatterEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IArrangeEvent } from \"common/model/sohoxi/sohoxi.model\";\r\nimport type {\r\n\tIExtendedDataGridColumn,\r\n\tIJsonDatagrid,\r\n\tIPreviousAttributes\r\n} from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport type { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport type { ILanguage } from \"ng2/common/model/language.model\";\r\nimport type { IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport type { IAvailableSourceField } from \"common/defines\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IAutoAddColumnResponse } from \"editor/component-settings/dialog/auto-add-columns-dialog\";\r\nimport { SettingsBase } from \"editor/component-settings/settings-base\";\r\nimport type { IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { DatagridHelper } from \"common/sohoxi/datagrid-helper\";\r\nimport { ComponentsHelper } from \"components/helper\";\r\n\r\nimport {\r\n\tDialogButtonType,\r\n\tDialogService,\r\n\tIDialogOptions,\r\n\tIDialogResult,\r\n} from \"common/services/dialog-service\";\r\nimport { TranslationManagementService } from \"components/services/translation-management-service\";\r\nimport { EditorService } from \"editor/services/editor-service\";\r\n\r\nexport interface IEditorComponentWithUpsertDatagridColumnSettings extends IEditorComponent {\r\n\tparent: IEditorFlexbox;\r\n\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonLookup | IJsonDatagrid;\r\n\tloadOptions(column: IExtendedDataGridColumn): void;\r\n\tupdateValuesWithTranslations(): void;\r\n\trefreshDatagrid(): void;\r\n\tupdateColumns(): void;\r\n\taddClickEvent(column: IExtendedDataGridColumn): void;\r\n\taddHyperlinkEvent(column: IExtendedDataGridColumn): void;\r\n\ttoggleSelected(): void;\r\n\ttoggleMultiSelection(): void;\r\n\tpreviousAttributes: IPreviousAttributes;\r\n\tdatagridOptions: IDataGridOptions<any>;\r\n}\r\n\r\nexport interface IUpsertOption {\r\n\tsourceFields: IAvailableSourceField[];\r\n\tisAdd?: boolean;\r\n\tcolumn?: IExtendedDataGridColumn;\r\n\tcomponent: IEditorComponentWithUpsertDatagridColumnSettings;\r\n}\r\n\r\n/**\r\n * Extend this class if component has upsert properties to data grid columns in its content settings\r\n * E.g. Lookup, and Data Grid component\r\n */\r\nexport abstract class UpsertDatagridColumnContentSettings extends SettingsBase {\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tprotected htmlDecode = Helper.htmlDecode;\r\n\r\n\tprotected selectedComponent: IEditorComponentWithUpsertDatagridColumnSettings;\r\n\r\n\tprotected abstract addTitle: string;\r\n\tprotected abstract editTitle: string;\r\n\r\n\tunsubscribers: Function[] = [];\r\n\tget Columns(): IExtendedDataGridColumn[] {\r\n\t\treturn this.selectedComponent.getDatabearer().columns;\r\n\t}\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\teditorService: EditorService,\r\n\t\tprotected dialogService: DialogService,\r\n\t\tprotected translationManagementService: TranslationManagementService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.unsubscribers.push(\r\n\t\t\teditorService.selectedDatasourceChangedEvent.on(datasource => {\r\n\t\t\t\tthis.refreshMetaSettings(datasource);\r\n\t\t\t}),\r\n\t\t\tthis.translationManagementService.onTranslationsChangedEvent.on(\r\n\t\t\t\t() => {\r\n\t\t\t\t\tif (this.selectedComponent) {\r\n\t\t\t\t\t\tthis.selectedComponent.updateValuesWithTranslations();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tonArrange(event: IArrangeEvent): void {\r\n\t\tconst databearer = this.selectedComponent.getDatabearer();\r\n\t\tEditorHelper.moveByIndex(databearer.columns, event.startIndex, event.endIndex);\r\n\t\tthis.refreshComponent();\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tonAddColumn(): void {\r\n\t\tconst column: IExtendedDataGridColumn = {\r\n\t\t\tid: \"\",\r\n\t\t\tname: \"\",\r\n\t\t\tsortable: true,\r\n\t\t\tresizable: true,\r\n\t\t\teditable: false,\r\n\t\t\tsummarize: false,\r\n\t\t\ttextOverflow: \"ellipsis\",\r\n\t\t} as IExtendedDataGridColumn;\r\n\t\tthis.addColumn(column);\r\n\r\n\t\tif (this.selectedComponent.getDatasource()) {\r\n\t\t\tthis.openUpsertDialog(column, true).then(\r\n\t\t\t\t(dialogResult: IDialogResult<IExtendedDataGridColumn>) => {\r\n\t\t\t\t\tif (dialogResult.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\tthis.editColumn(dialogResult.value);\r\n\t\t\t\t\t\tthis.save();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.deleteColumn(column, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tonEditColumn(column: IExtendedDataGridColumn): void {\r\n\t\tthis.openUpsertDialog(column).then(\r\n\t\t\t(dialogResult: IDialogResult<IExtendedDataGridColumn>) => {\r\n\t\t\t\tif (dialogResult.button) {\r\n\t\t\t\t\tswitch (dialogResult.button) {\r\n\t\t\t\t\t\tcase DialogButtonType.Ok:\r\n\t\t\t\t\t\t\tthis.editColumn(dialogResult.value);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tconsole.warn(\"Invalid option\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.save();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tdeleteColumn(column: IExtendedDataGridColumn, save = true): void {\r\n\t\tconst databearer = this.selectedComponent.getDatabearer();\r\n\t\tconst columns: IExtendedDataGridColumn[] = databearer.columns;\r\n\t\tconst index = columns.findIndex(item => item.id === column.id);\r\n\t\tif (index > -1) {\r\n\t\t\tcolumns.splice(index, 1);\r\n\t\t}\r\n\t\tthis.refreshComponent();\r\n\t\tthis.translationManagementService.removeTranslation(\r\n\t\t\tdatabearer.id,\r\n\t\t\tcolumn.id\r\n\t\t);\r\n\r\n\t\tif (column.text) {\r\n\t\t\tthis.translationManagementService.removeTranslation(databearer.id, column.id + \"CellText\");\r\n\t\t}\r\n\r\n\t\tif (save) {\r\n\t\t\tthis.save();\r\n\t\t}\r\n\t}\r\n\r\n\trefreshMetaSettings(dataservice: IDatasource): ng.IPromise<void> {\r\n\t\tconst newDeferred = this.editorService.getNewDeferred<void>();\r\n\r\n\t\tif (dataservice) {\r\n\t\t\tconst resultPromise = dataservice.getMetaData().then(metadata => {\r\n\t\t\t\tthis.addColumns(metadata.outputFields, true, dataservice.typedef);\r\n\t\t\t});\r\n\t\t\tnewDeferred.resolve(resultPromise);\r\n\t\t}\r\n\r\n\t\treturn newDeferred.promise;\r\n\t}\r\n\r\n\tprotected deleteAllColumns(): void {\r\n\t\tconst columns = angular.copy(\r\n\t\t\tthis.selectedComponent.getDatabearer().columns\r\n\t\t);\r\n\t\tif (columns.length) {\r\n\t\t\tcolumns.forEach(column => this.deleteColumn(column));\r\n\t\t}\r\n\t}\r\n\r\n\tprotected addColumns(\r\n\t\toutputFields: IMetaDataField[],\r\n\t\tshowAskDialog: boolean,\r\n\t\ttypedef?: DatasourceTypeEnum\r\n\t): void {\r\n\t\tif (showAskDialog) {\r\n\t\t\tthis.showAddPredefinedColumnsDialog(outputFields)\r\n\t\t\t\t.then((dialogResponse: IDialogResult<IAutoAddColumnResponse>) => {\r\n\r\n\t\t\t\t\tif (dialogResponse.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\tthis.deleteAllColumns();\r\n\r\n\t\t\t\t\t\tconst values = dialogResponse.value;\r\n\t\t\t\t\t\tthis.autoAddColumns(values.selectedColumns, values.autoFormatColumns, typedef);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.save();\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.autoAddColumns(outputFields);\r\n\t\t\tthis.refreshComponent();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected refreshComponent(): void {\r\n\t\tthis.selectedComponent.updateValuesWithTranslations();\r\n\t\tif (this.selectedComponent.getTypedef() === ComponentNames.Datagrid) {\r\n\t\t\tthis.selectedComponent.refreshDatagrid();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected save(): void {\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.TRANSLATIONS);\r\n\t\tthis.editorService.saveCanvas();\r\n\t\t//Columns are updated\r\n\t\tthis.editorService.setSourceTriggerEvent.raise();\r\n\t}\r\n\r\n\tprivate autoAddColumns(\r\n\t\toutputFields: IMetaDataField[],\r\n\t\tautoFormatColumns?: boolean,\r\n\t\ttypedef?: DatasourceTypeEnum,\r\n\t): void {\r\n\t\toutputFields.forEach(item => {\r\n\t\t\tconst newColumn: IExtendedDataGridColumn = {\r\n\t\t\t\tid: \"\",\r\n\t\t\t\tname: item.FLDS.trim(),\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsummarize: false,\r\n\t\t\t\ttextOverflow: \"ellipsis\",\r\n\t\t\t\tfield: item.FLNM,\r\n\t\t\t\tformatterName: autoFormatColumns ?\r\n\t\t\t\t\tthis.getFormatterName(item.type, typedef) : undefined\r\n\t\t\t};\r\n\r\n\t\t\tif (autoFormatColumns) {\r\n\t\t\t\tDatagridHelper.setColumnSettings(\r\n\t\t\t\t\tnewColumn,\r\n\t\t\t\t\tthis.translationManagementService.getSelectedLocale());\r\n\t\t\t}\r\n\r\n\t\t\tthis.addColumn(newColumn);\r\n\t\t});\r\n\r\n\t\tif (this.selectedComponent.getTypedef() === ComponentNames.Datagrid) {\r\n\t\t\tthis.selectedComponent.toggleMultiSelection();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getFormatterName(type: string, typedef: DatasourceTypeEnum): string {\r\n\t\tswitch (typedef) {\r\n\t\t\tcase DatasourceTypeEnum.IDO:\r\n\t\t\tcase DatasourceTypeEnum.generic:\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\t\tcase \"Boolean\":\r\n\t\t\t\t\tcase \"Byte\":\r\n\t\t\t\t\t\treturn FormatterEnum.Checkbox;\r\n\t\t\t\t\tcase \"Date\":\r\n\t\t\t\t\t\treturn FormatterEnum.Date;\r\n\t\t\t\t\tcase \"Date Time\":\r\n\t\t\t\t\t\treturn FormatterEnum.Datetime;\r\n\t\t\t\t\tcase \"Email\":\r\n\t\t\t\t\t\treturn FormatterEnum.Hyperlink;\r\n\t\t\t\t\tcase \"Short Integer\":\r\n\t\t\t\t\tcase \"Long Integer\":\r\n\t\t\t\t\tcase \"Number\":\r\n\t\t\t\t\t\treturn FormatterEnum.Integer;\r\n\t\t\t\t\tcase \"Decimal\":\r\n\t\t\t\t\t\treturn FormatterEnum.Decimal;\r\n\t\t\t\t\tcase \"GUID\":\r\n\t\t\t\t\tcase \"String\":\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn undefined;\r\n\t\t\t\t}\r\n\t\t\tcase DatasourceTypeEnum.IDM:\r\n\t\t\tcase DatasourceTypeEnum.M3:\r\n\t\t\tdefault:\r\n\t\t\t\t// implement other type of data types here\r\n\t\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addColumn(newColumn: IExtendedDataGridColumn): void {\r\n\t\tconst databearer = this.selectedComponent.getDatabearer();\r\n\r\n\t\tconst columnIds: string[] = databearer.columns.map((column) => {\r\n\t\t\treturn column.id;\r\n\t\t});\r\n\r\n\t\tconst index: number = ComponentsHelper.nextNumber(columnIds);\r\n\t\tconst newId: string = this.selectedComponent.getId() + \"Column\" + index;\r\n\r\n\t\tnewColumn.id = newId;\r\n\r\n\t\tdatabearer.columns.push(newColumn);\r\n\t\tthis.adjustColumnSizes();\r\n\t\tthis.addToLanguageComponents(newColumn, index);\r\n\t}\r\n\r\n\tprivate editColumn(column: IExtendedDataGridColumn): void {\r\n\t\tconst databearer = this.selectedComponent.getDatabearer();\r\n\t\tdatabearer.columns.forEach((ignoredColumn, index) => {\r\n\t\t\tif (column.id === ignoredColumn.id) {\r\n\t\t\t\tdatabearer.columns[index] = column;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst hasTextTranslation = this.translationManagementService.hasLanguageComponent(\r\n\t\t\tdatabearer.id,\r\n\t\t\tcolumn.id + \"CellText\"\r\n\t\t);\r\n\r\n\t\tif (!hasTextTranslation && !Helper.isUndefinedOrNull(column.text)) { //if column text is added\r\n\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\tdatabearer.id,\r\n\t\t\t\tcolumn.id + \"CellText\",\r\n\t\t\t\tcolumn.text,\r\n\t\t\t\tfalse\r\n\t\t\t);\r\n\t\t} else if (hasTextTranslation && !Helper.isUndefinedOrNull(column.text)) { //if column text is changed\r\n\t\t\tthis.translationManagementService.setTranslatableStringByProperty(\r\n\t\t\t\tdatabearer.id,\r\n\t\t\t\tcolumn.id + \"CellText\",\r\n\t\t\t\t{\r\n\t\t\t\t\tlocale: this.translationManagementService.getSelectedLocale(),\r\n\t\t\t\t\tvalue: column.text\r\n\t\t\t\t} as ILanguage,\r\n\t\t\t\tfalse\r\n\t\t\t);\r\n\t\t} else if (hasTextTranslation && Helper.isUndefinedOrNull(column.text)) { //if column text is removed\r\n\t\t\tthis.translationManagementService.removeTranslation(\r\n\t\t\t\tdatabearer.id,\r\n\t\t\t\tcolumn.id + \"CellText\",\r\n\t\t\t\tfalse\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tthis.translationManagementService.setTranslatableStringByProperty(\r\n\t\t\tdatabearer.id,\r\n\t\t\tcolumn.id,\r\n\t\t\t{\r\n\t\t\t\tlocale: this.translationManagementService.getSelectedLocale(),\r\n\t\t\t\tvalue: column.name\r\n\t\t\t} as ILanguage\r\n\t\t);\r\n\t\tif (column.formatterName === FormatterEnum.Button) {\r\n\t\t\tthis.selectedComponent.addClickEvent(column);\r\n\t\t} else if (column.formatterName === FormatterEnum.Hyperlink) {\r\n\t\t\tthis.selectedComponent.addHyperlinkEvent(column);\r\n\t\t}\r\n\r\n\t\t// if summarize is disabled, remove the associated properties\r\n\t\tif (!column.summarize) {\r\n\t\t\tcolumn.summaryText = null;\r\n\t\t\tcolumn.summaryTextPlacement = null;\r\n\t\t}\r\n\r\n\t\tif (!column.substitute) {\r\n\t\t\tcolumn.substituteOptions = null;\r\n\t\t}\r\n\r\n\t\treturn this.refreshComponent();\r\n\t}\r\n\r\n\tprivate adjustColumnSizes(): void {\r\n\t\tconst columns = this.selectedComponent.getDatabearer().columns;\r\n\r\n\t\tconst numberOfColumns = columns.length;\r\n\t\tconst width = (Numbers.HUNDRED / numberOfColumns).toString() + \"%\";\r\n\t\tcolumns.forEach(column => column.width = width);\r\n\t}\r\n\r\n\tprivate showAddPredefinedColumnsDialog(\r\n\t\toutputFields: IMetaDataField[]\r\n\t): ng.IPromise<IDialogResult<IAutoAddColumnResponse>\r\n\t\t> {\r\n\t\tconst options: IDialogOptions<IMetaDataField[]> = {\r\n\t\t\ttitle: \"Auto Add Columns\",\r\n\t\t\ttemplate: require(\"./dialog/auto-add-columns-dialog.html\"),\r\n\t\t\tparameter: outputFields\r\n\t\t};\r\n\r\n\t\treturn this.dialogService.show(options);\r\n\t}\r\n\r\n\tprivate openUpsertDialog(\r\n\t\tcolumn?: IExtendedDataGridColumn,\r\n\t\tisAdd?: boolean\r\n\t): ng.IPromise<IDialogResult<IExtendedDataGridColumn | {}>> {\r\n\t\tconst options: IDialogOptions<IUpsertOption> = {\r\n\t\t\ttitle: isAdd ? this.addTitle : this.editTitle,\r\n\t\t\tparameter: {\r\n\t\t\t\tsourceFields: [],\r\n\t\t\t\tcolumn: angular.copy(column),\r\n\t\t\t\tisAdd,\r\n\t\t\t\tcomponent: this.selectedComponent\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./dialog/upsert-column.html\")\r\n\t\t};\r\n\t\tif (this.selectedComponent.datasource) {\r\n\t\t\treturn this.getAvailableSourceFields().then(\r\n\t\t\t\t(sourceFields: IAvailableSourceField[]) => {\r\n\t\t\t\t\toptions.parameter.sourceFields = sourceFields;\r\n\t\t\t\t\treturn this.dialogService.show(options);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn this.dialogService.show(options);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getAvailableSourceFields(): ng.IPromise<IAvailableSourceField[]> {\r\n\t\treturn this.selectedComponent.datasource.getMetaData().then(metadata => {\r\n\t\t\tconst availableSourceField: IAvailableSourceField[] = [];\r\n\t\t\tmetadata.outputFields.map((outputField: IMetaDataField) => {\r\n\t\t\t\tavailableSourceField.push({\r\n\t\t\t\t\tvisibleName: outputField.FLDS.trim(),\r\n\t\t\t\t\tsourceKey: outputField.FLNM,\r\n\t\t\t\t\tsourceKeyShort: outputField.FLNM\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\treturn availableSourceField;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate addToLanguageComponents(column: IExtendedDataGridColumn, index: number): void {\r\n\t\tconst databearer = this.selectedComponent.getDatabearer();\r\n\t\tconst newId: string = column.id;\r\n\t\tconst newName: string = column.name ? column.name : \"Column \" + index;\r\n\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\tdatabearer.id,\r\n\t\t\tnewId,\r\n\t\t\tnewName\r\n\t\t);\r\n\r\n\t\treturn this.translationManagementService.setTranslatableStringByProperty(\r\n\t\t\tdatabearer.id,\r\n\t\t\tcolumn.id,\r\n\t\t\t{\r\n\t\t\t\tlocale: this.translationManagementService.getSelectedLocale(),\r\n\t\t\t\tvalue: column.name\r\n\t\t\t} as ILanguage\r\n\t\t);\r\n\t}\r\n}\r\n","import cloneDeep from \"lodash-es/cloneDeep\";\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport {\r\n\tComponentNames,\r\n\tDEFAULT_BOUNDARY,\r\n\tInjectNames,\r\n\tSettingKeys,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\n\r\n// import { Datagrid } from \"components/datagrid/datagrid\";\r\n// import { Dropdown } from \"components/dropdown/dropdown\";\r\n// import { Flexbox } from \"components/flexbox/flexbox\";\r\n// import { List } from \"components/list/list\";\r\n\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IPreviousAttributes } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IJQueryMouseEventObject } from \"common/defines\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorDatagrid } from \"editor/components/editor-datagrid\";\r\nimport type { IEditorDropdown } from \"editor/components/editor-dropdown\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\nimport type { IEditorList } from \"editor/components/editor-list\";\r\n\r\nimport { SettingsBase } from \"editor/component-settings/settings-base\";\r\nimport { FlexboxSettings } from \"editor/component-settings/flexbox/flexbox-settings\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { ComponentsHelper } from \"components/helper\";\r\nimport { EditorService } from \"editor/services/editor-service\";\r\n\r\nexport interface IDetachedChild {\r\n\tcontext: IContext;\r\n\tcurrentItemOptions: string | number | IPreviousAttributes;\r\n}\r\n\r\nexport class FlexboxContentSettingsCtrl extends SettingsBase {\r\n\tprivate static readonly MIN_CHILDREN_COUNT = 2;\r\n\r\n\tpublic currentOrientation: number;\r\n\tpublic flexChildrenAmount: number;\r\n\tpublic htmlEncode = Helper.htmlEncode;\r\n\tprotected selectedComponent: IEditorFlexbox;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\t$scope: ng.IScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t\tthis.unsubscribers.push(this.editorService.currentFlexOrientationChangedEvent.on((value: OrientationEnum) => {\r\n\t\t\tthis.currentOrientation = value;\r\n\t\t}));\r\n\t}\r\n\r\n\tpublic addFirstColumn(): void {\r\n\t\tthis.addFirstChildren(OrientationEnum.HORIZONTAL);\r\n\t}\r\n\r\n\tpublic addFirstRow(): void {\r\n\t\tthis.addFirstChildren(OrientationEnum.VERTICAL);\r\n\t}\r\n\r\n\tpublic onMouseEnter(component: IEditorComponent, event: IJQueryMouseEventObject): void {\r\n\t\tcomponent.onMouseOver(event);\r\n\t}\r\n\r\n\tpublic onMouseLeave(component: IEditorComponent, event: IJQueryMouseEventObject): void {\r\n\t\tcomponent.onMouseLeave(event);\r\n\t}\r\n\r\n\tpublic selectComponent(component: IEditorComponent, event: IJQueryMouseEventObject): void {\r\n\t\tcomponent.onClick(event);\r\n\t}\r\n\r\n\tpublic addChild(): void {\r\n\t\tthis.pushChild();\r\n\t\tthis.editorService.saveCanvas();\r\n\t}\r\n\r\n\tpublic removeChild(): void {\r\n\t\tif (this.selectedComponent.getDatabearer().children.length > FlexboxContentSettingsCtrl.MIN_CHILDREN_COUNT) {\r\n\t\t\tthis.popChild();\r\n\t\t} else { // 1 or 2 left\r\n\t\t\tthis.removeLastChildren();\r\n\t\t}\r\n\r\n\t\tthis.editorService.saveCanvas();\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tsuper.onComponentChanged(newComponent);\r\n\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.countflexChildren();\r\n\t\t\tconst currentBoundary = this.editorService.getCurrentBoundary();\r\n\t\t\tthis.currentOrientation =\r\n\t\t\t\tthis.selectedComponent.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, currentBoundary.id);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(currentBoundary: IBoundary): void {\r\n\t\tthis.currentOrientation =\r\n\t\t\tthis.selectedComponent.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, currentBoundary.id);\r\n\t}\r\n\r\n\tprivate countflexChildren(): void {\r\n\t\tlet flexChildrenCount: number = 0;\r\n\t\tthis.selectedComponent.children.forEach((child) => {\r\n\t\t\tif (child.getTypedef() === ComponentNames.Flexbox) {\r\n\t\t\t\tflexChildrenCount++;\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.flexChildrenAmount = flexChildrenCount;\r\n\t}\r\n\r\n\tprivate pushChild(): IJsonFlexbox {\r\n\t\tconst newFlexChild = FlexboxSettings.getInstance().create(\r\n\t\t\tthis.editorService.generateId(ComponentsHelper.getComponentDisplayName(\"Flexbox\"))\r\n\t\t);\r\n\t\tthis.flexChildrenAmount++;\r\n\t\tthis.selectedComponent.insert(newFlexChild);\r\n\t\treturn newFlexChild;\r\n\t}\r\n\r\n\tprivate popChild(): IJsonFlexbox {\r\n\t\tthis.flexChildrenAmount--;\r\n\t\tconst flexboxDatabearer = this.selectedComponent.getDatabearer();\r\n\t\tconst childIdToRemove = flexboxDatabearer.children[flexboxDatabearer.children.length - 1].id;\r\n\t\treturn this.selectedComponent.detachChild(childIdToRemove) as IJsonFlexbox;\r\n\t}\r\n\r\n\tprivate addFirstChildren(orientation: OrientationEnum): void {\r\n\t\tconst flexbox = this.selectedComponent;\r\n\t\tconst detachedChildren: IJsonComponent[] = [];\r\n\t\tconst childrenContext: IDetachedChild[] = [];\r\n\r\n\t\tif (!flexbox.isFlexParent) {\r\n\t\t\tconst childArray = flexbox.children;\r\n\t\t\twhile (childArray.length > 0) {\r\n\t\t\t\tlet currentItem = null;\r\n\t\t\t\tswitch (childArray[0].getTypedef()) {\r\n\t\t\t\t\tcase ComponentNames.Dropdown:\r\n\t\t\t\t\t\tcurrentItem = cloneDeep((childArray[0] as IEditorDropdown).currentItemIndex);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase ComponentNames.List:\r\n\t\t\t\t\t\tcurrentItem = cloneDeep((childArray[0] as IEditorList).selectedGeneratedId);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase ComponentNames.Datagrid:\r\n\t\t\t\t\t\tcurrentItem = cloneDeep((childArray[0] as IEditorDatagrid).previousAttributes);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t//no extra properties\r\n\t\t\t\t}\r\n\t\t\t\tchildrenContext.push({\r\n\t\t\t\t\tcontext: cloneDeep(childArray[0].getScope().context),\r\n\t\t\t\t\tcurrentItemOptions: currentItem\r\n\t\t\t\t});\r\n\t\t\t\tdetachedChildren.push(childArray[0].detach());\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst firstFlexChild = this.pushChild();\r\n\t\tthis.pushChild();\r\n\r\n\t\tdetachedChildren.forEach((child) => {\r\n\t\t\tfirstFlexChild.children.push(child);\r\n\t\t});\r\n\r\n\t\tflexbox.setBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, orientation);\r\n\t\tflexbox.isFlexParent = true;\r\n\t\tthis.currentOrientation = orientation;\r\n\r\n\t\tthis.editorService.currentFlexIsParentChangedEvent.raise(flexbox.isFlexParent);\r\n\t\tthis.editorService.currentFlexOrientationChangedEvent.raise(orientation);\r\n\t\tthis.editorService.refreshSettingEvent.raise(SettingKeys.ORIENTATION);\r\n\r\n\t\tthis.editorService.saveCanvas();\r\n\t\tthis.editorService.getTimeout()(() => {\r\n\t\t\t//Reset data when instances is created\r\n\t\t\tif (this.selectedComponent.children.length > 0) {\r\n\t\t\t\tthis.resetPreviousData(childrenContext);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate resetPreviousData(childrenContext: IDetachedChild[]): void {\r\n\t\tchildrenContext.forEach((childContext, index) => {\r\n\t\t\tconst newFlexboxParent = this.selectedComponent.children[0] as IEditorFlexbox;\r\n\t\t\tnewFlexboxParent.children[index].getScope().context = childContext.context;\r\n\t\t\tconst componentInstance = newFlexboxParent.children[index];\r\n\t\t\tswitch (componentInstance.getTypedef()) {\r\n\t\t\t\tcase ComponentNames.List:\r\n\t\t\t\t\t(componentInstance as IEditorList).setCurrentItem(childContext.currentItemOptions as string);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ComponentNames.Dropdown:\r\n\t\t\t\t\tconst currentIndex = childContext.currentItemOptions as number;\r\n\t\t\t\t\t(componentInstance as IEditorDropdown).setCurrentItem(childContext.context.ListResult[currentIndex]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ComponentNames.Datagrid:\r\n\t\t\t\t\tconst datagrid = (componentInstance as IEditorDatagrid);\r\n\t\t\t\t\tdatagrid.previousAttributes = (childContext.currentItemOptions as IPreviousAttributes);\r\n\t\t\t\t\tdatagrid.datagridOptions.dataset = childContext.context.ListResult;\r\n\t\t\t\t\tthis.editorService.getTimeout()(() => {\r\n\t\t\t\t\t\t//Wait for dataset to fill the grid\r\n\t\t\t\t\t\tdatagrid.toggleSelected();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t//no selection needed\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate removeLastChildren(): void {\r\n\t\tconst flexbox = this.selectedComponent;\r\n\t\tconst flexChildren = flexbox.getDatabearer().children;\r\n\t\tif (flexChildren.length === FlexboxContentSettingsCtrl.MIN_CHILDREN_COUNT) {\r\n\t\t\tthis.popChild();\r\n\t\t}\r\n\t\tconst lastChild = this.popChild();\r\n\t\tif (lastChild.children.length > 0) {\r\n\t\t\tthis.transferChildrenToGrandParent(lastChild);\r\n\t\t} else {\r\n\t\t\tflexbox.isFlexParent = false;\r\n\t\t}\r\n\t\tthis.editorService.currentFlexIsParentChangedEvent.raise(flexbox.isFlexParent);\r\n\t\tthis.editorService.currentFlexOrientationChangedEvent.raise(\r\n\t\t\tthis.selectedComponent.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, this.currentBoundary.id)\r\n\t\t);\r\n\t}\r\n\r\n\tprivate transferChildrenToGrandParent(child: IJsonFlexbox): void {\r\n\t\tconst flexbox = this.selectedComponent;\r\n\r\n\t\tchild.children.forEach((subChild) => {\r\n\t\t\tflexbox.insert(subChild);\r\n\t\t});\r\n\t\tflexbox.isFlexParent =\r\n\t\t\tflexbox.getDatabearer().children[0].typedef === ComponentNames.Flexbox;\r\n\t\tflexbox.setBoundarySetting(\r\n\t\t\tSettingKeys.ORIENTATION,\r\n\t\t\tchild.boundarySettings[DEFAULT_BOUNDARY.id].orientation\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport class FlexboxContentSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./flexbox-content-settings.html\");\r\n\tscope = true;\r\n\tcontroller = FlexboxContentSettingsCtrl;\r\n\tcontrollerAs = \"eirFlexboxContentSettingsCtrl\";\r\n}\r\n","import {\r\n\tDEFAULT_BOUNDARY,\r\n\tImagePositions,\r\n\tListTemplateIdEnum,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IJsonLabel } from \"ng2/common/model/databearer/components/json-label.model\";\r\nimport type { IJsonList } from \"ng2/common/model/databearer/components/json-list.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IJsonImage } from \"common/model/component/image.model\";\r\nimport type { ISettingsClassInstance } from \"editor/defines\";\r\n\r\nimport { ComponentSettingsCtrl } from \"editor/component-settings/component-settings\";\r\nimport { FlexboxSettings } from \"editor/component-settings/flexbox/flexbox-settings\";\r\nimport { ListStyleSettingsDirective } from \"editor/component-settings/list/list-style-settings\";\r\n\r\nimport { Hyperlink } from \"components/hyperlink/hyperlink\";\r\nimport { Image } from \"components/image/image\";\r\nimport { Label } from \"components/label/label\";\r\nimport { List } from \"components/list/list\";\r\n\r\nexport class ListSettings implements ISettingsClassInstance {\r\n\r\n\tprivate static readonly instance: ListSettings = new ListSettings();\r\n\r\n\tpublic static getInstance(): ListSettings {\r\n\t\treturn this.instance;\r\n\t}\r\n\r\n\tpublic readonly availableTemplates: { id: string, displayName: string }[] = [\r\n\t\t{ id: ListTemplateIdEnum.OneLabelFlexbox, displayName: \"One Label\" },\r\n\t\t{ id: ListTemplateIdEnum.TwoVerticalLabels, displayName: \"Two Labels Vertical\" },\r\n\t\t{ id: ListTemplateIdEnum.ImageAndLabels, displayName: \"Image & Labels\" },\r\n\t\t{ id: ListTemplateIdEnum.OneHyperlink, displayName: \"One Hyperlink\" },\r\n\t\t{ id: ListTemplateIdEnum.OneHyperlinkAndLabel, displayName: \"Label & Hyperlink\" },\r\n\t\t{ id: ListTemplateIdEnum.ImageLabelAndHyperlink, displayName: \"Image, Label and Hyperlink\"}\r\n\t];\r\n\r\n\tpublic styleSettingsDirective: ng.IDirective = new ListStyleSettingsDirective();\r\n\r\n\tpublic constructor() {\r\n\t\tif (ListSettings.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use ListSettings.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic create(id: string): IJsonList {\r\n\t\tconst newList = ComponentSettingsCtrl.create<IJsonList>(id, List);\r\n\t\tnewList.boundarySettings[DEFAULT_BOUNDARY.id].itemTemplate =\r\n\t\t\tthis.getTemplate(this.availableTemplates[0].id, id);\r\n\t\treturn newList;\r\n\t}\r\n\r\n\tpublic getTemplate(id: string, listId: string): IJsonLayoutComponent {\r\n\t\tlet templateComponent: IJsonLayoutComponent;\r\n\t\tswitch (id) {\r\n\t\t\tcase ListTemplateIdEnum.OneLabelFlexbox:\r\n\t\t\t\tconst labelFlexbox = FlexboxSettings\r\n\t\t\t\t\t.getInstance()\r\n\t\t\t\t\t.createWithoutPadding(ListTemplateIdEnum.OneLabelFlexbox);\r\n\r\n\t\t\t\tlabelFlexbox.children.push(ComponentSettingsCtrl.create(\"OneLabel\" + listId, Label));\r\n\t\t\t\ttemplateComponent = labelFlexbox;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ListTemplateIdEnum.TwoVerticalLabels:\r\n\t\t\t\tconst flexboxVertical = FlexboxSettings\r\n\t\t\t\t\t.getInstance()\r\n\t\t\t\t\t.createWithoutPadding(ListTemplateIdEnum.TwoVerticalLabels);\r\n\r\n\t\t\t\tconst topLabel = this.createLabel(listId, \"TopLabel\");\r\n\t\t\t\tconst bottomLabel = ComponentSettingsCtrl.create<IJsonLabel>(\"BottomLabel\" + listId, Label);\r\n\r\n\t\t\t\tflexboxVertical.children.push(topLabel);\r\n\t\t\t\tflexboxVertical.children.push(bottomLabel);\r\n\r\n\t\t\t\ttemplateComponent = flexboxVertical;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ListTemplateIdEnum.ImageAndLabels:\r\n\t\t\t\tconst imageFlexbox = FlexboxSettings\r\n\t\t\t\t\t.getInstance()\r\n\t\t\t\t\t.createWithoutPadding(ListTemplateIdEnum.ImageAndLabels, OrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\tconst image = this.createImage(listId);\r\n\t\t\t\tconst innerFlexbox = FlexboxSettings.getInstance().createWithoutPadding(\"InnerFlexbox\");\r\n\t\t\t\tconst label1 = this.createLabel(listId, \"Label1\");\r\n\t\t\t\tconst label2 = ComponentSettingsCtrl.create<IJsonLabel>(\"Label2\" + listId, Label);\r\n\r\n\t\t\t\tinnerFlexbox.children.push(label1);\r\n\t\t\t\tinnerFlexbox.children.push(label2);\r\n\r\n\t\t\t\timageFlexbox.children.push(image);\r\n\t\t\t\timageFlexbox.children.push(innerFlexbox);\r\n\t\t\t\ttemplateComponent = imageFlexbox;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ListTemplateIdEnum.OneHyperlink:\r\n\t\t\t\tconst hyperlinkFlexbox = FlexboxSettings\r\n\t\t\t\t\t.getInstance()\r\n\t\t\t\t\t.createWithoutPadding(ListTemplateIdEnum.OneHyperlink);\r\n\r\n\t\t\t\thyperlinkFlexbox.children.push(ComponentSettingsCtrl.create(\"Hyperlink\" + listId, Hyperlink));\r\n\t\t\t\ttemplateComponent = hyperlinkFlexbox;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ListTemplateIdEnum.OneHyperlinkAndLabel:\r\n\t\t\t\tconst flexboxHyperlinkVertical = FlexboxSettings\r\n\t\t\t\t\t.getInstance()\r\n\t\t\t\t\t.createWithoutPadding(ListTemplateIdEnum.OneHyperlinkAndLabel);\r\n\r\n\t\t\t\tconst label = this.createLabel(listId, \"Label\");\r\n\t\t\t\tconst hyperlink = ComponentSettingsCtrl.create(\"Hyperlink\" + listId, Hyperlink);\r\n\r\n\t\t\t\tflexboxHyperlinkVertical.children.push(label);\r\n\t\t\t\tflexboxHyperlinkVertical.children.push(hyperlink);\r\n\r\n\t\t\t\ttemplateComponent = flexboxHyperlinkVertical;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ListTemplateIdEnum.ImageLabelAndHyperlink:\r\n\t\t\t\tconst imageHyperlinkFlexbox = FlexboxSettings\r\n\t\t\t\t\t.getInstance()\r\n\t\t\t\t\t.createWithoutPadding(ListTemplateIdEnum.ImageLabelAndHyperlink, OrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\tconst imagePiece = this.createImage(listId);\r\n\t\t\t\tconst innerFlexboxPiece = FlexboxSettings.getInstance().createWithoutPadding(\"InnerFlexbox\");\r\n\t\t\t\tconst labelPiece = this.createLabel(listId, \"Label\");\r\n\t\t\t\tconst hyperlinkPiece = ComponentSettingsCtrl.create(\"Hyperlink\" + listId, Hyperlink);\r\n\r\n\t\t\t\tinnerFlexboxPiece.children.push(labelPiece);\r\n\t\t\t\tinnerFlexboxPiece.children.push(hyperlinkPiece);\r\n\r\n\t\t\t\timageHyperlinkFlexbox.children.push(imagePiece);\r\n\t\t\t\timageHyperlinkFlexbox.children.push(innerFlexboxPiece);\r\n\t\t\t\ttemplateComponent = imageHyperlinkFlexbox;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[DataListpanelSettingsCtrl] Invalid template choice\");\r\n\t\t}\r\n\r\n\t\treturn templateComponent;\r\n\t}\r\n\r\n\tprivate createLabel(listId: string, name: string): IJsonLabel {\r\n\t\tconst label = ComponentSettingsCtrl.create<IJsonLabel>(name + listId, Label);\r\n\r\n\t\tlabel.fontStyle = \"medium-heading\";\r\n\t\tlabel.boundarySettings[DEFAULT_BOUNDARY.id].margin = {\r\n\t\t\ttop: 2,\r\n\t\t\tright: 0,\r\n\t\t\tbottom: 10,\r\n\t\t\tleft: 0\r\n\t\t};\r\n\r\n\t\treturn label;\r\n\t}\r\n\r\n\tprivate createImage(listId: string): IJsonImage {\r\n\t\tconst image = ComponentSettingsCtrl.create<IJsonImage>(\"Image\" + listId, Image);\r\n\t\timage.boundarySettings[DEFAULT_BOUNDARY.id].width = { sizeType: SizeTypeEnum.PIXELS, value: 40 };\r\n\t\timage.boundarySettings[DEFAULT_BOUNDARY.id].height = { sizeType: SizeTypeEnum.PIXELS, value: 40 };\r\n\t\timage.boundarySettings[DEFAULT_BOUNDARY.id].margin = {\r\n\t\t\ttop: -1,\r\n\t\t\tright: 15,\r\n\t\t\tbottom: 2,\r\n\t\t\tleft: 0\r\n\t\t};\r\n\t\timage.position = ImagePositions.FIT;\r\n\r\n\t\treturn image;\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport type { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport type { IRadioButton } from \"../../../../common/model/component/radiobutton.model\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../../../common/services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"../../../../common/shared-components/base/feature-switch-ctrl\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport { IEditorRadioButtons } from \"../../components/editor-radiobutton\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IAutoCompleteOptions } from \"common/model/sohoxi/sohoxi-autocomplete.model\";\r\nimport type { ILookupOptions } from \"common/model/sohoxi/sohoxi-lookup.model\";\r\nimport type { ILanguage } from \"ng2/common/model/language.model\";\r\n\r\nexport interface IEditRadioButtonDialogParameter  {\r\n\tradio: IRadioButton;\r\n\tcomponent: IEditorRadioButtons;\r\n}\r\n\r\nexport class EditRadioButtonCtrl extends FeatureSwitchCtrl {\r\n\tradioButton: IRadioButton;\r\n\tlookupOptions: ILookupOptions;\r\n\tautocompleteOptions: IAutoCompleteOptions;\r\n\tprivate dialog: IDialog<IEditRadioButtonDialogParameter>;\r\n\tprivate selectedComponent: IEditorRadioButtons;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<IEditRadioButtonDialogParameter>,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tfeatureSwitchService: FeatureSwitchService\r\n\t) {\r\n\t\tsuper(featureSwitchService);\r\n\t\tconst dialog: IDialog<IEditRadioButtonDialogParameter> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tconst parameter = dialog.parameter;\r\n\t\tthis.radioButton = parameter.radio;\r\n\t\tthis.selectedComponent = parameter.component;\r\n\r\n\t\t//Init xi-components\r\n\t\tthis.lookupOptions = this.translationManagementService.getLookupOptions();\r\n\t\tthis.autocompleteOptions = this.translationManagementService.getAutoOptions();\r\n\t}\r\n\r\n\topenTranslations(): void {\r\n\t\tthis.translationManagementService.openTranslations(this.selectedComponent, this.radioButton.id)\r\n\t\t\t.then((result) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst changes = result.value;\r\n\t\t\t\t\tif (changes.savedComponentStrings.length > 0) {\r\n\t\t\t\t\t\tconst selectedChanged = changes.savedComponentStrings.find((translation) => {\r\n\t\t\t\t\t\t\treturn translation.component === this.selectedComponent.getId()\r\n\t\t\t\t\t\t\t\t&& translation.reference === this.radioButton.id;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (selectedChanged) {\r\n\t\t\t\t\t\t\tthis.radioButton.name = selectedChanged.newValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//If global translations is changed\r\n\t\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, result.value.savedGlobalStrings)) {\r\n\t\t\t\t\tthis.translationManagementService.saveGlobalTranslations(result.value.savedGlobalStrings)\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t//If global translations is deleted\r\n\t\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, result.value.deletedGlobalStrings)) {\r\n\t\t\t\t\tthis.translationManagementService.deleteGlobalTranslations(result.value.deletedGlobalStrings)\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tonChangeRadioButtonName(): void {\r\n\t\tconst currentLanguageKey = this.translationManagementService.getSelectedLocale();\r\n\t\tconst newValue: ILanguage = {\r\n\t\t\tlocale: currentLanguageKey,\r\n\t\t\tvalue: this.radioButton.name\r\n\t\t};\r\n\t\tthis.translationManagementService.setTranslatableStringByProperty(\r\n\t\t\tthis.selectedComponent.getId(),\r\n\t\t\tthis.radioButton.id,\r\n\t\t\tnewValue\r\n\t\t);\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\t//clear possible global string\r\n\t\tdelete this.radioButton.value;\r\n\r\n\t\tconst result: IDialogResult<any> = {\r\n\t\t\tvalue: this.radioButton,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t\tthis.selectedComponent.initializeBindings();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirEditRadioButtonCtrl\", EditRadioButtonCtrl);\r\n\t}\r\n}\r\n","import { MaskProcess } from \"ng2/common/constants/common.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonTextBox } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\n\r\nimport { ISettingsClassInstance } from \"../../defines\";\r\n\r\nimport { TextBox } from \"../../../../components/textbox/textbox\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\nimport { TextboxStyleSettingsDirective } from \"./textbox-style-settings\";\r\n\r\nexport class TextboxSettings implements ISettingsClassInstance {\r\n\r\n\tprivate static readonly instance: TextboxSettings = new TextboxSettings();\r\n\r\n\tpublic static getInstance(): TextboxSettings {\r\n\t\treturn this.instance;\r\n\t}\r\n\r\n\tpublic readonly availableMasks: IDataPair[] = [\r\n\t\t{ name: \"None\", value: MaskProcess.NONE },\r\n\t\t{ name: \"Number\", value: MaskProcess.NUMBER },\r\n\t\t{ name: \"Password\", value: MaskProcess.PASSWORD },\r\n\t\t{ name: \"Date/Time\", value: MaskProcess.DATE_TIME },\r\n\t\t{ name: \"String\", value: MaskProcess.STRING }\r\n\t];\r\n\r\n\tpublic styleSettingsDirective: ng.IDirective = new TextboxStyleSettingsDirective();\r\n\r\n\tpublic create(id: string): IJsonTextBox {\r\n\t\treturn ComponentSettingsCtrl.create(id, TextBox) as IJsonTextBox;\r\n\t}\r\n\r\n\tpublic constructor() {\r\n\t\tif (TextboxSettings.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use TextboxSettings.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n}\r\n","import { ComponentClassNames } from \"ng2/common/constants/common.constant\";\r\nimport type { IJsonTextBox } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { TextBox } from \"components/textbox/textbox\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorTextbox extends IEditorComponent, TextBox {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonTextBox;\r\n}\r\n\r\nexport class EditorTextboxCtrl extends EditorComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + TextBox.name,\r\n\t\t\tEditorTextboxCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorTextbox;\r\n\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"common/defines\";\r\n\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"common/services/dialog-service\";\r\nimport { BoundaryManagementService } from \"editor/services/boundary-management-service\";\r\nimport { EditorService } from \"editor/services/editor-service\";\r\n\r\nexport interface IStandardBoundariesDialogParameter {\r\n\tselectedStandardBoundaryIds: string[];\r\n\tstandardBoundaries: IBoundary[];\r\n}\r\n\r\nexport class StandardBoundariesCtrl {\r\n\tstandardBoundaries: IBoundary[];\r\n\tprivate dialog: IDialog<IStandardBoundariesDialogParameter>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.BOUNDARY_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<IStandardBoundariesDialogParameter>,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate boundaryManagementService: BoundaryManagementService\r\n\t) {\r\n\r\n\t\tconst dialog: IDialog<IStandardBoundariesDialogParameter> = this.scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.standardBoundaries = angular.copy(dialog.parameter.standardBoundaries);\r\n\r\n\t\tthis.standardBoundaries.forEach((boundary: IBoundary) => {\r\n\r\n\t\t\tif (dialog.parameter.selectedStandardBoundaryIds.indexOf(boundary.id) >= 0) {\r\n\t\t\t\tboundary.selected = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tok(): void {\r\n\t\tconst newBoundaryIds: string[] = [];\r\n\t\tthis.standardBoundaries.forEach((boundary: IBoundary) => {\r\n\t\t\tif (boundary.selected === true) {\r\n\t\t\t\tnewBoundaryIds.push(boundary.id);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst result: IDialogResult<string[]> = {\r\n\t\t\tvalue: newBoundaryIds,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirStandardBoundariesCtrl\", StandardBoundariesCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport {\r\n\tCanvasModeEnum, InjectNames, InteractionActionEnum, InteractionPairOperation,\r\n\tSaveFlagsEnum, ValueObject\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult\r\n} from \"../../../common/services/dialog-service\";\r\nimport { ComponentsHelper } from \"../../../components/helper\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../services/editor-service\";\r\nimport { InteractionManagementService } from \"../services/interaction-management-service\";\r\nimport { SettingsBase } from \"./settings-base\";\r\n\r\nexport interface ISettingsScope extends ng.IScope {\r\n\thideSidebar: Function;\r\n}\r\n\r\nexport class SettingsCtrl extends SettingsBase {\r\n\tpublic selectedComponentClassName: string;\r\n\tpublic showOverlay: boolean;\r\n\r\n\tpublic currentBoundary: IBoundary;\r\n\tpublic availableDatasources: IJsonDatasource[];\r\n\tpublic settingDatasource: IJsonDatasource;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: ISettingsScope,\r\n\t\teditorService: EditorService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate interactionManagementService: InteractionManagementService,\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.unsubscribers.push(editorService.currentBoundaryChangedEvent.on((newBoundary: IBoundary) => {\r\n\t\t\tthis.currentBoundary = newBoundary;\r\n\t\t}));\r\n\t\tthis.currentBoundary = editorService.getCurrentBoundary();\r\n\r\n\t\tthis.unsubscribers.push(editorService.canvasModeChangedEvent.on((mode: CanvasModeEnum) => {\r\n\t\t\tthis.showOverlay = mode === CanvasModeEnum.FINDER || mode === CanvasModeEnum.WIZARD;\r\n\t\t}));\r\n\r\n\t\tthis.refreshAvailableDatasources();\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tprivate refreshAvailableDatasources(): void {\r\n\t\tthis.availableDatasources = this.editorService.getCurrentProject().getDatasourceDatabearers();\r\n\t\tthis.availableDatasources.unshift({ displayName: ValueObject.TARGET_CONTEXT, id: undefined });\r\n\t}\r\n\r\n\tpublic manageDatasources(): void {\r\n\t\tconst options: IDialogOptions<any> = {\r\n\t\t\ttitle: \"Project Data Services\",\r\n\t\t\ttemplate: require(\"./manage-dialogs/datasources-dialog.html\"),\r\n\t\t\tcssClass: \"datasources-manage-dialog\",\r\n\t\t\tstyle: \"min-width: 1000px; max-width: 1125px;\"\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<any>) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.refreshAvailableDatasources();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic changeSidebarTab(item: string): void {\r\n\t\tthis.editorService.setCurrentSidebarTab(item);\r\n\t}\r\n\r\n\tpublic hideSidebar(): void {\r\n\t\tthis.editorService.setSidebarVisibility(false);\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\r\n\t\tthis.selectedComponent = newComponent;\r\n\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.selectedComponentClassName = ComponentsHelper.getComponentDisplayName(newComponent.getTypedef());\r\n\t\t\tthis.settingDatasource = this.selectedComponent.getDatasource()\r\n\t\t\t\t? newComponent.getDatasource().getDatabearer()\r\n\t\t\t\t: null;\r\n\t\t} else {\r\n\t\t\tthis.selectedComponentClassName = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onChangeDisplayName(): void {\r\n\t\t//Set the new width on the selectionbox.\r\n\t\tconst extraDisplayNameWidth = 6;\r\n\t\tconst extraWrapperWidth = 33;\r\n\t\tconst newWidth = this.selectedComponent.getDisplayName().length * extraDisplayNameWidth;\r\n\t\tangular.element(\".selectionbox-wrapper\").css(\"width\", newWidth + extraWrapperWidth);\r\n\t\tangular.element(\".selBoxComponentNameInput\").css(\"width\", newWidth);\r\n\t\tthis.editorService.saveCanvas();\r\n\t}\r\n\r\n\tpublic onChangeDatasource(\r\n\t\tpreviousDatasourceId: string\r\n\t): void {\r\n\t\tconst newDatasource = this.settingDatasource.id ?\r\n\t\t\tthis.editorService.getDatasourceObject(this.settingDatasource.id) :\r\n\t\t\tnull;\r\n\r\n\t\tif (previousDatasourceId === \"\") {\r\n\t\t\tthis.changeSelectDatasourceOnComponent(newDatasource);\r\n\t\t} else {\r\n\t\t\tthis.promptUpdateOrRemoveInteractionsConfirmDialog(newDatasource, previousDatasourceId);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tprivate changeSelectDatasourceOnComponent(datasource: IDatasource): void {\r\n\t\tthis.selectedComponent.setDatasource(datasource).then(() => {\r\n\t\t\tif (datasource) {\r\n\t\t\t\tthis.runDefaultInteraction();\r\n\t\t\t}\r\n\t\t\tthis.editorService.triggerDatasourceChanged(datasource);\r\n\t\t\tthis.editorService.getTimeout()(() => {\r\n\t\t\t\t/* triggerDatasourceChanged will trigger value source changes which may call on\r\n\t\t\t\t\tasync service. Thus race condition happens and this timeout is required to make\r\n\t\t\t\t\tsure all components has been probably updated before save */\r\n\t\t\t\tthis.editorService.saveCanvas();\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t\t\t\t// Not sure why this reset is needed but Static lists context needs to remain.\r\n\t\t\t\tif (datasource === null || datasource.typedef !== DatasourceTypeEnum.INLINE_LIST) {\r\n\t\t\t\t\tthis.selectedComponent.resetContext();\r\n\t\t\t\t}\r\n\t\t\t}, 1);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate runDefaultInteraction(): void {\r\n\t\tconst defaultAction = this.selectedComponent.getDefaultAction() === InteractionPairOperation.GET\r\n\t\t\t? InteractionActionEnum.GET\r\n\t\t\t: InteractionActionEnum.LIST;\r\n\r\n\t\tthis.selectedComponent.loadInteraction(\r\n\t\t\tthis.interactionManagementService.createNewOnTheFly(defaultAction));\r\n\r\n\t}\r\n\r\n\tprivate promptUpdateOrRemoveInteractionsConfirmDialog(\r\n\t\tnewDatasource: IDatasource,\r\n\t\tprevDatasourceId: string\r\n\t): void {\r\n\t\tconst isChangeDatasource = newDatasource !== null;\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tconst interactions = angular.copy(currentProject.getInteractions());\r\n\t\tconst amountInteractions =\r\n\t\t\tinteractions.filter(interaction => interaction.targetName === this.selectedComponent.getId()).length;\r\n\r\n\t\tif (newDatasource &&\r\n\t\t\tnewDatasource.getDatabearer().id === prevDatasourceId\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (amountInteractions > 0) {\r\n\t\t\tthis.dialogService.showYesNo(\r\n\t\t\t\t/* tslint:disable:max-line-length\r\n\t\t\t\t\tLong description */\r\n\t\t\t\t\"Warning\",\r\n\t\t\t\t`The data service on this component has ${amountInteractions} configured interaction${amountInteractions > 1 ? \"s\" : \"\"}.\r\n\t\t\t\tDo you want to ${isChangeDatasource ? \"change\" : \"remove\"} this data service from this component?`,\r\n\t\t\t\t\"warning-text\"\r\n\t\t\t\t/* tslint:enable:max-line-length */\r\n\t\t\t).then(dialogResult => {\r\n\t\t\t\tif (dialogResult.button === DialogButtonType.Yes) {\r\n\t\t\t\t\tthis.removeComponentInteractions(interactions);\r\n\t\t\t\t\tthis.changeSelectDatasourceOnComponent(newDatasource);\r\n\t\t\t\t} else { // No\r\n\t\t\t\t\tthis.settingDatasource =\r\n\t\t\t\t\t\tthis.availableDatasources.find(datasource => datasource.id === prevDatasourceId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.changeSelectDatasourceOnComponent(newDatasource);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate removeComponentInteractions(interactions: Interaction[]): void {\r\n\t\tinteractions.forEach((interaction, index) => {\r\n\t\t\tif (interaction.targetName === this.selectedComponent.getId()) {\r\n\t\t\t\tthis.interactionManagementService.removeInteraction(interaction);\r\n\t\t\t}\r\n\t\t\t// if (index + 1 === interactions.length) {\r\n\t\t\t// \tthis.changeSelectDatasourceOnComponent(null);\r\n\t\t\t// }\r\n\t\t});\r\n\r\n\t\t// this.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t}\r\n}\r\n\r\nexport class SettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./settings.html\");\r\n\tscope = true;\r\n\tcontroller = SettingsCtrl;\r\n\tcontrollerAs = \"eirSettingsCtrl\";\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive = () => new SettingsDirective();\r\n\t\tm.directive(\"eirSettings\", directive);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { IChanged, InjectNames, SubstitutionTags } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDataGridColumn } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { ILookupOptions } from \"../../../../common/model/sohoxi/sohoxi-lookup.model\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../../../common/services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"../../../../common/shared-components/base/feature-switch-ctrl\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\n\r\nexport interface IEditBindingDialogParameter {\r\n\tbindingString: string;\r\n\tvalueType: ValueTypeEnum;\r\n\tproperty: string;\r\n}\r\n\r\nexport class EditBindingCtrl extends FeatureSwitchCtrl {\r\n\tpublic bindingString: string;\r\n\tpublic invalidString = false;\r\n\tpublic lookupOptions: ILookupOptions;\r\n\tpublic isLocalized: boolean;\r\n\tprivate property: string;\r\n\tprivate dialog: IDialog<IEditBindingDialogParameter>;\r\n\tprivate substitutionTag: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<IEditBindingDialogParameter>,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tfeatureSwitchService: FeatureSwitchService\r\n\t) {\r\n\t\tsuper(featureSwitchService);\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.substitutionTag = SubstitutionTags.VALUE;\r\n\t\tconst valueType = dialog.parameter.valueType;\r\n\t\tif (!dialog.parameter.bindingString) {\r\n\t\t\tthis.bindingString = this.substitutionTag;\r\n\t\t} else {\r\n\t\t\tthis.bindingString = dialog.parameter.bindingString;\r\n\t\t}\r\n\t\tthis.isLocalized = valueType === ValueTypeEnum.LOCALIZED_STRING;\r\n\t\tthis.property = dialog.parameter.property;\r\n\t\tthis.onChangeBindingString();\r\n\t\tthis.initLookupOptions();\r\n\t}\r\n\r\n\tprivate initLookupOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Name\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"Name\",\r\n\t\t\twidth: 250,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Value\",\r\n\t\t\tname: \"Value\",\r\n\t\t\tfield: \"Value\",\r\n\t\t\twidth: 250,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\r\n\t\tconst dataset = this.translationManagementService.getCurrentStringsList();\r\n\r\n\t\tthis.lookupOptions = {\r\n\t\t\ttitle: \"Select Item\",\r\n\t\t\tfield: (selectedRow: IMap<string>) => {\r\n\t\t\t\tconst propertyName = \"Name\";\r\n\t\t\t\treturn this.substitutionTag + \"{\" + selectedRow[propertyName] + \"}\";\r\n\t\t\t},\r\n\t\t\tmatch: () => {\r\n\t\t\t\t// fake method\r\n\t\t\t},\r\n\t\t\toptions: {\r\n\t\t\t\tpaging: true,\r\n\t\t\t\tpagesize: 10,\r\n\t\t\t\tcolumns: columns,\r\n\t\t\t\tdataset: dataset,\r\n\t\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\t\ttoolbar: {\r\n\t\t\t\t\tkeywordFilter: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tpublic onChangeBindingString(): void {\r\n\t\tif (this.bindingString === \"\") {\r\n\t\t\tthis.bindingString = this.substitutionTag;\r\n\t\t\tthis.invalidString = false;\r\n\t\t} else {\r\n\t\t\tconst index = this.bindingString.indexOf(this.substitutionTag);\r\n\t\t\tif (index === -1) {\r\n\t\t\t\tthis.invalidString = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.invalidString = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close({\r\n\t\t\tbutton: DialogButtonType.Cancel\r\n\t\t});\r\n\t}\r\n\r\n\tpublic save(): void {\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tvalue: this.bindingString,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic openTranslations(): void {\r\n\t\tconst selectedComponent = this.editorService.getSelectedComponent();\r\n\t\tthis.translationManagementService.openTranslations(selectedComponent, this.property).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tconst data = result.value as IChanged;\r\n\t\t\t\tif (data.savedComponentStrings.length > 0) {\r\n\t\t\t\t\tconst selectedChanged = data.savedComponentStrings.filter((translation) => {\r\n\t\t\t\t\t\treturn translation.component === selectedComponent.getId();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (selectedChanged) {\r\n\t\t\t\t\t\tselectedChanged.forEach((updatedTranslation) => {\r\n\t\t\t\t\t\t\tif (updatedTranslation.reference === this.property) {\r\n\t\t\t\t\t\t\t\tthis.bindingString = updatedTranslation.newValue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.editorService.translationChangedEvent.raise(updatedTranslation);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// if selected component changed add undo\r\n\t\t\t\t\t\tthis.editorService.addUndoStack(this.editorService.getCurrentProject());\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//If global translations is changed\r\n\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, result.value.savedGlobalStrings)) {\r\n\t\t\t\tthis.translationManagementService.saveGlobalTranslations(result.value.savedGlobalStrings).then(() => {\r\n\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t//If global translations is deleted\r\n\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, result.value.deletedGlobalStrings)) {\r\n\t\t\t\tthis.translationManagementService.deleteGlobalTranslations(result.value.deletedGlobalStrings).then(() => {\r\n\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirEditBindingCtrl\", EditBindingCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport type { IComponent } from \"../../../../common/IComponent\";\r\nimport { InstanceEvent } from \"../../../../common/instance-event\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogResult, IMessageDialogOptions,\r\n\tStandardDialogButtons\r\n} from \"../../../../common/services/dialog-service\";\r\nimport { ComponentsHelper } from \"../../../../components/helper\";\r\nimport { Lookup } from \"../../../../components/lookup/lookup\";\r\nimport type { IFinderModeOptions } from \"../../../defines\";\r\n\r\nimport type { EditorService } from \"../../services/editor-service\";\r\nimport type { InteractionManagementService } from \"../../services/interaction-management-service\";\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nimport {\r\n\tInjectNames, InteractionPairOperation, IWizardFocusType, Numbers, SaveFlagsEnum,\r\n\tSettingTypes, WizardFocusEnum\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\nimport \"./interaction-settings.less\";\r\n\r\nexport class InteractionSettingsCtrl extends SettingsBase {\r\n\tselectedInteraction: Interaction;\r\n\trelevantInteractions: Interaction[];\r\n\r\n\tavailableSources: IJsonComponent[];\r\n\tavailableTargets: IJsonComponent[];\r\n\tavailableSourceTriggers: IDataPair[];\r\n\tavailableTargetActions: IDataPair[] = [];\r\n\tprivate isWizard: boolean;\r\n\r\n\tisFinderActive: boolean;\r\n\tsettingSourceComponent: IJsonComponent;\r\n\tsettingTargetComponent: IJsonComponent;\r\n\tsettingSourceTrigger: IDataPair;\r\n\tsettingTargetAction: IDataPair;\r\n\r\n\tinteractionChangedEvent = new InstanceEvent<Interaction>();\r\n\ttargetActionChangedEvent = new InstanceEvent<string>();\r\n\tsourceTriggerChangedEvent = new InstanceEvent<string>();\r\n\r\n\tget hasAvailableTargetActions(): boolean {\r\n\t\treturn this.availableTargetActions.length > 0 && this.availableTargetActions[0].value !== \"\";\r\n\t}\r\n\r\n\tget COMPONENT_HAS_NO_DATASERVICE(): string {\r\n\t\treturn \"Component has no data service\";\r\n\t}\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.TEMPLATE_CACHE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: ng.IScope,\r\n\t\tprivate $compile: ng.ICompileService,\r\n\t\tprivate $templateCache: ng.ITemplateCacheService,\r\n\t\teditorService: EditorService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate interactionManagementService: InteractionManagementService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\r\n\t\tthis.unsubscribers.push(this.interactionManagementService\r\n\t\t\t.projectInteractionsChanged.on((interaction) => {\r\n\t\t\t\tthis.updateRelevantInteractions();\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.wizardFocusComponentChangedEvent.on(\r\n\t\t\t(focusSettings: IWizardFocusType) => {\r\n\t\t\t\tthis.setWizardFocusType(focusSettings);\r\n\t\t\t}\r\n\t\t));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.selectedInteractionChangedEvent.on((interaction: Interaction) => {\r\n\t\t\tthis.selectInteraction(interaction);\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.finderModeChangedEvent.on((value: boolean) => {\r\n\t\t\tthis.isFinderActive = value;\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.newWizardInteractionEvent.on((interaction: Interaction) => {\r\n\t\t\tthis.selectInteraction(interaction);\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.isWizardChangedEvent.on((value: boolean) => {\r\n\t\t\tthis.isWizard = value;\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.setSourceTriggerEvent.on(() => {\r\n\t\t\tif (this.selectedInteraction) {\r\n\t\t\t\tthis.updateUI();\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.setTargetActionEvent.on(() => {\r\n\t\t\tif (this.selectedInteraction) {\r\n\t\t\t\tthis.updateUI();\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.selectedDatasourceChangedEvent.on((newDatasource?: IDatasource) => {\r\n\t\t\tconst currentInteractionsForSelectedComponent =\r\n\t\t\t\tthis.interactionManagementService.getInteractionsWithTarget(this.selectedComponent);\r\n\t\t\tif (currentInteractionsForSelectedComponent.length > 0) {\r\n\t\t\t\tcurrentInteractionsForSelectedComponent.forEach((interaction) => {\r\n\t\t\t\t\tinteraction.removeAllParameters();\r\n\t\t\t\t});\r\n\t\t\t\tthis.refreshInteractionDisplayName(currentInteractionsForSelectedComponent);\r\n\t\t\t}\r\n\t\t\tif (newDatasource) {\r\n\t\t\t\tif (currentInteractionsForSelectedComponent.length === 0) {\r\n\t\t\t\t\tthis.createDefaultInteraction();\r\n\t\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.selectedInteraction) {\r\n\t\t\t\tthis.updateUI();\r\n\t\t\t\tthis.targetActionChangedEvent.raise();\r\n\t\t\t}\r\n\t\t\tthis.initAvailableComponents();\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.wizardSetFinderModeEvent.on((value: string) => {\r\n\t\t\tlet tick = 0;\r\n\t\t\tif (value === \"target\") {\r\n\t\t\t\ttick = 1;\r\n\t\t\t}\r\n\t\t\tthis.useFinder(value).then(() => {\r\n\t\t\t\tthis.editorService.wizardTickChangedEvent.raise(tick);\r\n\t\t\t});\r\n\t\t}));\r\n\t}\r\n\r\n\tselectSourceApplication(): void {\r\n\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\tWizardFocusEnum.UNFOCUSED,\r\n\t\t\tthis.settingSourceComponent,\r\n\t\t\tSettingTypes.SOURCE\r\n\t\t);\r\n\t\tthis.settingSourceComponent = this.editorService.getApplicationParent().getDatabearer();\r\n\t\tthis.onChangeSourceComponent();\r\n\r\n\t\tthis.settingTargetComponent = this.selectedComponent.getDatabearer();\r\n\t\tthis.onChangeTargetComponent();\r\n\t}\r\n\r\n\tsetSourceAsTarget(): void {\r\n\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\tWizardFocusEnum.UNFOCUSED,\r\n\t\t\tthis.settingTargetComponent,\r\n\t\t\tSettingTypes.TARGET\r\n\t\t);\r\n\t\tthis.settingTargetComponent = angular.copy(this.settingSourceComponent);\r\n\t\tthis.onChangeTargetComponent();\r\n\t}\r\n\r\n\tselectTargetApplication(): void {\r\n\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\tWizardFocusEnum.UNFOCUSED,\r\n\t\t\tthis.settingTargetComponent,\r\n\t\t\tSettingTypes.TARGET);\r\n\t\tthis.settingTargetComponent = this.editorService.getApplicationParent().getDatabearer();\r\n\t\tthis.onChangeTargetComponent();\r\n\t}\r\n\r\n\tprivate setDisplayStrings(interaction: Interaction): void {\r\n\t\tif (interaction.displayName) {\r\n\t\t\tconst strings = interaction.displayName.split(\"->\");\r\n\t\t\tif (strings.length === 2) {\r\n\t\t\t\tinteraction.triggerString = strings[0];\r\n\t\t\t\tinteraction.targetString = strings[1];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tinteraction.triggerString = \"\";\r\n\t\t\tinteraction.targetString = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tprivate refreshInteractionDisplayName(interactions: Interaction[]): void {\r\n\t\tinteractions.forEach(interaction => {\r\n\t\t\tinteraction.displayName = this.interactionManagementService.getInteractionDisplayName(interaction);\r\n\t\t\tthis.setDisplayStrings(interaction);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateRelevantInteractions(): void {\r\n\t\tconst interactions = this.editorService.getCurrentProject().getInteractions();\r\n\t\tthis.relevantInteractions = [];\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tconst selectedComponentId = this.selectedComponent.getId();\r\n\t\t\tthis.relevantInteractions = interactions.filter((interaction) => {\r\n\t\t\t\tinteraction.displayName = this.interactionManagementService.getInteractionDisplayName(interaction);\r\n\t\t\t\tthis.setDisplayStrings(interaction);\r\n\t\t\t\treturn (interaction.sourceName === selectedComponentId || interaction.targetName === selectedComponentId);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (this.selectedInteraction && interactions.find(interaction =>\r\n\t\t\tinteraction.getId() === this.selectedInteraction.getId()) === undefined) {\r\n\t\t\tthis.selectedInteraction = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tthis.selectedComponent = null;\r\n\t\tsuper.onComponentChanged(newComponent);\r\n\t\tthis.updateRelevantInteractions();\r\n\t\tthis.initAvailableComponents();\r\n\t\tthis.selectInteraction(null);\r\n\t}\r\n\r\n\tprivate initAvailableComponents(): void {\r\n\t\tconst allComponents: IJsonComponent[] = this.editorService.getAllInteractiveComponents()\r\n\t\t\t.map((item) => {\r\n\t\t\t\treturn item.getDatabearer();\r\n\t\t\t});\r\n\t\tthis.availableSources = allComponents;\r\n\t\tthis.availableTargets = allComponents;\r\n\t}\r\n\r\n\tselectInteraction(newInteraction: Interaction): void {\r\n\t\tif (newInteraction) {\r\n\t\t\tthis.selectedInteraction = newInteraction;\r\n\t\t\tthis.updateUI();\r\n\t\t} else {\r\n\t\t\tthis.selectedInteraction = null;\r\n\t\t}\r\n\t\tthis.interactionChangedEvent.raise(this.selectedInteraction);\r\n\t}\r\n\r\n\tupdateUI(): void {\r\n\t\tconst sourceComponentInstance: IComponent =\r\n\t\t\tthis.editorService.getComponentInstanceById(this.selectedInteraction.sourceName);\r\n\t\tconst targetComponentInstance: IComponent =\r\n\t\t\tthis.editorService.getComponentInstanceById(this.selectedInteraction.targetName);\r\n\r\n\t\tthis.settingTargetComponent = targetComponentInstance ? targetComponentInstance.getDatabearer() : undefined;\r\n\t\tif (this.settingTargetComponent && targetComponentInstance) {\r\n\t\t\tthis.setAvailableTargetActions();\r\n\t\t}\r\n\r\n\t\tthis.settingSourceComponent = sourceComponentInstance ? sourceComponentInstance.getDatabearer() : undefined;\r\n\t\tif (this.settingSourceComponent && sourceComponentInstance) {\r\n\t\t\tthis.setAvailableSourceTriggers();\r\n\t\t} else {\r\n\t\t\tthis.settingSourceComponent = this.editorService.getApplicationParent().getDatabearer();\r\n\t\t\tthis.availableSourceTriggers = this.editorService.getApplicationParent().getSourceTriggers();\r\n\t\t}\r\n\r\n\t\tthis.availableSourceTriggers.filter((trigger) => {\r\n\t\t\tif (trigger.value === this.selectedInteraction.sourceTriggerName) {\r\n\t\t\t\tthis.settingSourceTrigger = trigger;\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.availableTargetActions.filter((action) => {\r\n\t\t\tif (action.value === this.selectedInteraction.targetActionName) {\r\n\t\t\t\tthis.settingTargetAction = action;\r\n\t\t\t}\r\n\t\t});\r\n\t\t// update the interaction with new displayName for the UI\r\n\t\tthis.selectedInteraction.displayName = this.getSelectedInteractionDisplayName();\r\n\t\tthis.setDisplayStrings(this.selectedInteraction);\r\n\r\n\t\t// elements needs to update because sometimes the dropdown can't be opened.\r\n\t\tangular.element(\"#interactionSourceSelect\").data(\"dropdown\").updated();\r\n\t\tangular.element(\"#interactionTargetSelect\").data(\"dropdown\").updated();\r\n\r\n\t}\r\n\r\n\tprivate getSelectedInteractionDisplayName(): string {\r\n\t\treturn this.interactionManagementService.getInteractionDisplayName(this.selectedInteraction);\r\n\t}\r\n\r\n\tprivate setAvailableSourceTriggers(): void {\r\n\t\tconst sourceComponentInstance = this.editorService.getComponentInstanceById(this.settingSourceComponent.id);\r\n\t\tlet sourceTriggers = sourceComponentInstance.getSourceTriggers();\r\n\t\tconst datasource = sourceComponentInstance.datasource;\r\n\t\tif (datasource) {\r\n\t\t\tconst needsIdentifier = sourceTriggers.length > 1;\r\n\t\t\tsourceTriggers = sourceTriggers.map((sourceTrigger) => {\r\n\t\t\t\tif (sourceTrigger === InteractionPairOperation.ON_LOAD) {\r\n\t\t\t\t\tconst identifier = needsIdentifier ? \" (\" + sourceTrigger.name + \")\" : \"\";\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tname: datasource.displayName + \" has run \" + identifier,\r\n\t\t\t\t\t\tvalue: sourceTrigger.value\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn sourceTrigger;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tsourceTriggers = sourceTriggers.map((sourceTrigger) => {\r\n\t\t\t\tif (sourceTrigger === InteractionPairOperation.ON_LOAD) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tname: sourceTrigger.name + \" (No Data Service) \",\r\n\t\t\t\t\t\tvalue: sourceTrigger.value\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn sourceTrigger;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.availableSourceTriggers = sourceTriggers;\r\n\t}\r\n\r\n\tprivate setAvailableTargetActions(): void {\r\n\t\tthis.availableTargetActions = this.getTargetActions();\r\n\t\tif (this.availableTargetActions.length > 0) {\r\n\t\t\tthis.settingTargetAction = this.availableTargetActions[0];\r\n\t\t} else {\r\n\t\t\tthis.settingTargetAction = {\r\n\t\t\t\tname: this.COMPONENT_HAS_NO_DATASERVICE,\r\n\t\t\t\tvalue: \"\"\r\n\t\t\t};\r\n\t\t\tthis.availableTargetActions.push(this.settingTargetAction);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getTargetActions(): IDataPair[] {\r\n\t\tconst targetComponentInstance = this.editorService.getComponentInstanceById(this.settingTargetComponent.id);\r\n\t\tlet targetActions: IDataPair[] = targetComponentInstance.getTargetActions();\r\n\t\tconst datasource = targetComponentInstance.datasource;\r\n\t\tif (datasource) {\r\n\t\t\tconst needsIdentifier = targetActions.length > 1;\r\n\t\t\ttargetActions = targetActions.map((targetAction) => {\r\n\t\t\t\tif (targetAction === InteractionPairOperation.GET ||\r\n\t\t\t\t\ttargetAction === InteractionPairOperation.LIST\r\n\t\t\t\t) {\r\n\t\t\t\t\tconst identifier = needsIdentifier ? \" (\" + targetAction.name + \")\" : \"\";\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tname: \"Run \" + datasource.displayName + identifier,\r\n\t\t\t\t\t\tvalue: targetAction.value\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn targetAction;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\ttargetActions = targetActions.map((targetAction) => {\r\n\t\t\t\tif (targetAction === InteractionPairOperation.GET ||\r\n\t\t\t\t\ttargetAction === InteractionPairOperation.LIST\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tname: targetAction.name + \" (No Data Service) \",\r\n\t\t\t\t\t\tvalue: targetAction.value\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn targetAction;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn targetActions;\r\n\t}\r\n\r\n\tmanualRunSelected(): void {\r\n\t\tthis.interactionManagementService.runInteraction(this.selectedInteraction);\r\n\t}\r\n\r\n\tgetSelectedInteraction(): Interaction {\r\n\t\treturn this.selectedInteraction;\r\n\t}\r\n\r\n\tsetWizardFocusType(focusSettings: IWizardFocusType): void {\r\n\t\t//Determine the new component\r\n\t\tif (focusSettings.setting === SettingTypes.SOURCE) {\r\n\t\t\tthis.settingSourceComponent = focusSettings.component;\r\n\t\t} else {\r\n\t\t\tthis.settingTargetComponent = focusSettings.component;\r\n\t\t}\r\n\t\t//Remove or add the new focus\r\n\t\tconst encodedFocusSettings = Helper.htmlEncode(focusSettings.setting);\r\n\t\tif (focusSettings.focus === WizardFocusEnum.UNFOCUSED) {\r\n\t\t\tangular.element(\".id-\" + focusSettings.component.id).removeClass(encodedFocusSettings);\r\n\t\t} else {\r\n\t\t\tangular.element(\".id-\" + focusSettings.component.id).addClass(encodedFocusSettings);\r\n\t\t}\r\n\t\t//update the new classes\r\n\t\tif (!ComponentsHelper.isApplicationParent(focusSettings.component)) {\r\n\t\t\tconst editorComponent = this.editorService.getComponentInstanceById(focusSettings.component.id) as IEditorComponent;\r\n\t\t\teditorComponent.setIsWizardFocus(focusSettings.focus);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tcreateNewInteraction(): void {\r\n\t\tconst interactionComponent = this.selectedComponent;\r\n\t\tconst targetComponent = this.editorService.getComponentInstanceById(this.availableTargets[0].id);\r\n\t\tconst newInteraction = this.interactionManagementService.createNew(interactionComponent, targetComponent);\r\n\t\tthis.selectInteraction(newInteraction);\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t}\r\n\r\n\tremoveSelectedInteraction(): void {\r\n\t\tconst interaction = this.selectedInteraction;\r\n\t\tconst options = {\r\n\t\t\ttitle: \"Confirm Delete\",\r\n\t\t\tmessage: \"Do you really want to delete this Interaction?\",\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo\r\n\t\t} as IMessageDialogOptions;\r\n\r\n\t\tthis.dialogService.showMessage(options).then((result: IDialogResult<any>) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.interactionManagementService.removeInteraction(interaction);\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t\t\t\tthis.selectInteraction(null);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tonChangeSourceComponent(): void {\r\n\t\tconst interaction = this.selectedInteraction;\r\n\t\tlet interactionSource: IEditorComponent;\r\n\r\n\t\tif (this.settingSourceComponent && !ComponentsHelper.isApplicationParent(this.settingSourceComponent)) {\r\n\t\t\tinteractionSource = this.editorService.getComponentInstanceById(this.settingSourceComponent.id);\r\n\t\t} else {\r\n\t\t\tinteractionSource = this.editorService.getApplicationParent();\r\n\t\t}\r\n\t\tif (interactionSource) {\r\n\t\t\tinteraction.sourceName = interactionSource.getId();\r\n\t\t\tthis.availableSourceTriggers = interactionSource.getSourceTriggers();\r\n\t\t\tconst index = this.availableSourceTriggers.map((trigger) => {\r\n\t\t\t\treturn trigger.value;\r\n\t\t\t}).indexOf(interaction.sourceTriggerName);\r\n\t\t\tif (!interaction.sourceTriggerName || index === -1) {\r\n\t\t\t\tthis.settingSourceTrigger = interactionSource.getDefaultTrigger();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.settingSourceTrigger = {} as IDataPair;\r\n\t\t\tinteraction.sourceName = \"\";\r\n\t\t\tthis.availableSourceTriggers = [];\r\n\t\t}\r\n\t\tthis.sourceTriggerChangedEvent.raise(this.selectedInteraction.sourceName);\r\n\t\tthis.editorService.setTriggerSourceComponent(interactionSource as IEditorComponent);\r\n\t\tthis.onChangeSourceTrigger();\r\n\t}\r\n\r\n\tonChangeSourceTrigger(): void {\r\n\t\tthis.selectedInteraction.sourceTriggerName = this.settingSourceTrigger.value;\r\n\t\tthis.editorService.setSourceTrigger(this.settingSourceTrigger);\r\n\r\n\t\tif (!this.isWizard) {\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t\t}\r\n\t}\r\n\r\n\tonChangeTargetComponent(): void {\r\n\t\tconst interaction = this.selectedInteraction;\r\n\t\tif (!this.settingTargetComponent || ComponentsHelper.isApplicationParent(this.settingTargetComponent)) {\r\n\t\t\tthis.settingTargetComponent = this.availableTargets[0];\r\n\t\t}\r\n\t\tconst interactionTarget = this.editorService.getComponentInstanceById(this.settingTargetComponent.id);\r\n\r\n\t\tif (interactionTarget) {\r\n\t\t\tinteraction.targetName = interactionTarget.getId();\r\n\t\t\tthis.setAvailableTargetActions();\r\n\t\t} else {\r\n\t\t\tthis.settingTargetAction = {} as IDataPair;\r\n\t\t\tinteraction.targetName = \"\";\r\n\t\t\tthis.availableTargetActions = [];\r\n\t\t}\r\n\r\n\t\tthis.targetActionChangedEvent.raise(this.selectedInteraction.targetActionName);\r\n\t\tthis.editorService.setTargetActionComponent(interactionTarget as IEditorComponent);\r\n\t\tthis.onChangeTargetAction();\r\n\t}\r\n\r\n\tonChangeTargetAction(): void {\r\n\t\tthis.selectedInteraction.removeAllParameters();\r\n\t\tif (!this.settingTargetAction) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst newTargetAction = this.settingTargetAction;\r\n\t\tif (newTargetAction.name !== undefined) {\r\n\t\t\tthis.selectedInteraction.targetActionName = newTargetAction.value;\r\n\t\t\tthis.editorService.setTargetAction(newTargetAction);\r\n\t\t}\r\n\r\n\t\tif (newTargetAction.value === InteractionPairOperation.LIST.value ||\r\n\t\t\tnewTargetAction.value === InteractionPairOperation.GET.value) {\r\n\t\t\tif (this.settingTargetComponent.datasource) {\r\n\t\t\t\tthis.editorService.getComponentInstanceById(this.settingTargetComponent.id).datasource.getMetaData();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.targetActionChangedEvent.raise(this.selectedInteraction.targetActionName);\r\n\t\tif (!this.isWizard) {\r\n\t\t\t//Wait for targetAction to be set before saving.\r\n\t\t\tthis.editorService.getTimeout()(()=> {\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t\t\t}, Numbers.TEN);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setMode(component: IEditorComponent, settingComponent: IJsonComponent, mode: string): void {\r\n\t\tif (this.isWizard && (component.wizardFocusType === WizardFocusEnum.UNFOCUSED)) {\r\n\t\t\tif (settingComponent) {\r\n\t\t\t\tthis.editorService.setWizardFocusComponent(WizardFocusEnum.UNFOCUSED, settingComponent, mode);\r\n\t\t\t}\r\n\t\t\tthis.triggerChangeComponent(component, mode);\r\n\t\t} else if (this.isWizard) {\r\n\t\t\t//block pointer\r\n\t\t} else {\r\n\t\t\tthis.triggerChangeComponent(component, mode);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate triggerChangeComponent(component: IEditorComponent, mode: string): void {\r\n\t\tif (mode === SettingTypes.SOURCE) {\r\n\t\t\tthis.settingSourceComponent = component.getDatabearer();\r\n\t\t\tthis.onChangeSourceComponent();\r\n\t\t} else {\r\n\t\t\tthis.settingTargetComponent = component.getDatabearer();\r\n\t\t\tthis.onChangeTargetComponent();\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t* Enables pre-selection of target component, use selectedComponent if it's not set as source\r\n\t*/\r\n\tprivate selectedComponentAsTarget(component: IEditorComponent): void {\r\n\t\tconst selectedComponent = this.selectedComponent;\r\n\t\tconst componentId = component.getId();\r\n\t\tconst selectedId = selectedComponent.getId();\r\n\t\tconst isTarget = (this.settingTargetComponent && this.settingTargetComponent.id === componentId);\r\n\t\tif (selectedComponent) {\r\n\t\t\tif (selectedId !== componentId) {\r\n\t\t\t\tthis.settingTargetComponent = selectedComponent.getDatabearer();\r\n\t\t\t\tthis.onChangeTargetComponent();\r\n\t\t\t} else if (selectedId === componentId && isTarget) {\r\n\t\t\t\tdelete this.settingTargetComponent;\r\n\t\t\t\tthis.onChangeTargetComponent();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tuseFinder(componentToSet: string): ng.IPromise<IEditorComponent> {\r\n\t\tthis.isFinderActive = true;\r\n\t\tconst isTarget = componentToSet === \"target\";\r\n\r\n\t\tconst finderOptions: IFinderModeOptions = { title: \"Select Interaction \" + (isTarget ? \"Target\" : \"Source\") };\r\n\t\tif (this.isWizard) {\r\n\t\t\tfinderOptions.closeOnSelect = false;\r\n\t\t\tfinderOptions.title = `Create Interaction: Select the ${isTarget ? \"target\" : \"source\"} component on the canvas.`;\r\n\t\t\tfinderOptions.cancel = () => {\r\n\t\t\t\tthis.editorService.wizardCloseEvent.raise();\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst promise = this.editorService.startFinderMode(finderOptions);\r\n\t\tpromise.then((component: IEditorComponent) => {\r\n\t\t\tif (!isTarget && this.isWizard && ComponentsHelper.isApplicationParent(component)) {\r\n\t\t\t\tthis.selectSourceApplication();\r\n\t\t\t} else if (isTarget) {\r\n\t\t\t\tthis.setMode(component, this.settingTargetComponent, SettingTypes.TARGET);\r\n\t\t\t} else if (!isTarget) {\r\n\t\t\t\tthis.setMode(component, this.settingSourceComponent, SettingTypes.SOURCE);\r\n\t\t\t\tthis.selectedComponentAsTarget(component);\r\n\t\t\t}\r\n\t\t}).finally(() => {\r\n\t\t\tif (!this.isWizard) {\r\n\t\t\t\tthis.isFinderActive = false;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tprivate createDefaultInteraction(): void {\r\n\t\tconst typedef = this.selectedComponent.getDatabearer().typedef;\r\n\t\tswitch (typedef) {\r\n\t\t\tcase Lookup.name:\r\n\t\t\t\tthis.interactionManagementService.createNew(\r\n\t\t\t\t\tthis.selectedComponent,\r\n\t\t\t\t\tthis.selectedComponent\r\n\t\t\t\t);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthis.interactionManagementService.createNew(\r\n\t\t\t\t\tthis.editorService.getApplicationParent(),\r\n\t\t\t\t\tthis.selectedComponent\r\n\t\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirInteractionSettingsCtrl\", InteractionSettingsCtrl);\r\n\t}\r\n}\r\n\r\nexport class InteractionSettingsDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirInteractionSettings\", () => {\r\n\t\t\treturn {\r\n\t\t\t\trestrict: \"E\",\r\n\t\t\t\ttemplate: require(\"./interaction-settings.html\"),\r\n\t\t\t\tscope: true,\r\n\t\t\t\tcontroller: InteractionSettingsCtrl,\r\n\t\t\t\tcontrollerAs: \"eirInteractionSettingsCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirBuildLinkCtrl as ctrl\\\" class=build-link-dialog> <div class=add-source> <label>New Source:</label> <select class=\\\"dropdown dropdown-md\\\" ng-model=ctrl.newTypeValue ng-options=\\\"type.value as type.name for type in ctrl.availableSources\\\" xi-drop-down> </select> <button xi-tooltip=\\\"'Add Source'\\\" class=btn-icon ng-click=ctrl.addSource() ng-disabled=\\\"ctrl.availableSources.length === 0\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-add></use> </svg> <span class=audible>Add</span> </button> </div> <div class=source-labels ng-if=\\\"ctrl.sources.length > 0\\\"> <label>Source:</label> <label>Alias:</label> </div> <div ng-repeat=\\\"source in ctrl.sources track by $index\\\"> <eir-url-source-field available-sources=ctrl.availableSources source=source build-link=ctrl.buildLink() remove-source=ctrl.removeSource(source) change-source-alias=\\\"ctrl.updateAlias(oldAlias, newAlias, $index)\\\" index=$index> </eir-url-source-field> </div> <label>Address:</label> <textarea class=textarea ng-model=ctrl.link ng-change=ctrl.buildLink() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 400, 'blur': 0}}\\\">\\r\\n\\t</textarea> <div class=field> <p class=link-text>{{ctrl.myLink}}</p> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-click=ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { ConditionType, InjectNames, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { Mashup } from \"ng2/common/project/mashup\";\r\nimport type { IDatagridApi, IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { IComponent } from \"../../../../common/IComponent\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { IRowItem } from \"../../../../common/sohoxi/datagrid-helper\";\r\nimport { FrameworkService } from \"../../../../components/services/framework-service\";\r\nimport { IExpressionData } from \"../../components/editor-component\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\n\r\ninterface IExpressionView {\r\n\tid: string;\r\n\tsourceName: string;\r\n\ttargetName: string;\r\n\tsourcePropertyName: string;\r\n\ttargetPropertyName: string;\r\n\toperatorName: string;\r\n\tusedBy: string;\r\n}\r\n\r\ninterface IExpressionTreeView {\r\n\tcomponentId: string;\r\n\tchildren: IExpressionView[];\r\n\texpanded: boolean;\r\n}\r\n\r\nexport interface IConditionData {\r\n\texpression: IJsonExpression;\r\n\texpressionType: string;\r\n}\r\n\r\nexport class ExpressionDialogCtrl {\r\n\tdatagridOptions: IDataGridOptions<IExpressionView | IExpressionTreeView>;\r\n\titemSelected = false;\r\n\tprivate selectedExpression: IJsonExpression;\r\n\tprivate expressionType: string;\r\n\tprivate dataset: IExpressionView[] | IExpressionTreeView[] = [];\r\n\tprivate selectedComponent: IComponent;\r\n\tprivate dialog: IDialog<IExpressionData>;\r\n\tprivate operatorDictionary: IMap<string> = {\r\n\t\t\"=\": \"Equals\",\r\n\t\t\"<>\": \"Not Equals\",\r\n\t\t\">\": \"Greater than\",\r\n\t\t\">=\": \"Equals or Greater\",\r\n\t\t\"<\": \"Lower than\",\r\n\t\t\"<=\": \"Equals or Lower\",\r\n\t\t\"*\": \"Contains In\"\r\n\t};\r\n\r\n\tprivate typeDictionary: IMap<string> = {\r\n\t\t\"disable\": \"Disable\",\r\n\t\t\"hide\": \"Hide\"\r\n\t};\r\n\r\n\tprivate currentProject: Mashup;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<IExpressionData>,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate frameworkService: FrameworkService\r\n\t) {\r\n\t\tconst dialog: IDialog<IExpressionData> = $scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.selectedComponent = dialog.parameter.component;\r\n\t\tthis.expressionType = dialog.parameter.option;\r\n\t\tthis.currentProject = this.editorService.getCurrentProject();\r\n\r\n\t\tthis.refreshDataset();\r\n\t\tthis.initGridOptions();\r\n\t}\r\n\r\n\taddExpression(): void {\r\n\t\tthis.editExpression(true);\r\n\t}\r\n\r\n\teditExpression(newExpression: boolean = false): void {\r\n\t\tif (newExpression) {\r\n\t\t\tthis.selectedExpression = null;\r\n\t\t}\r\n\t\tconst dialogOptions: IDialogOptions<IConditionData> = {\r\n\t\t\ttemplate: require(\"./edit-expression-dialog/edit-expression-dialog.html\"),\r\n\t\t\ttitle: newExpression ? \"New Condition\" : \"Edit Condition\",\r\n\t\t\tparameter: {\r\n\t\t\t\texpression: this.selectedExpression,\r\n\t\t\t\texpressionType: this.expressionType\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.dialogService.show(dialogOptions).then((results: IDialogResult<IJsonExpression>) => {\r\n\t\t\tconst button = results.button;\r\n\t\t\tif (button === DialogButtonType.Ok) {\r\n\t\t\t\tif (newExpression) {\r\n\t\t\t\t\tthis.currentProject.addExpression(results.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.currentProject.saveExpression(results.value);\r\n\t\t\t\t}\r\n\t\t\t\tthis.refreshDataset();\r\n\t\t\t\tthis.save();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tdeleteExpression(): void {\r\n\t\tthis.dialogService.showYesNo(\"Delete Condition\", \"Do you want to delete this condition?\").then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.currentProject.deleteExpression(this.selectedExpression);\r\n\t\t\t\tthis.refreshDataset();\r\n\t\t\t\tthis.save();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tclose(): void {\r\n\t\tconst result: IDialogResult<void> = {\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tprivate save(): void {\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.EXPRESSIONS + SaveFlagsEnum.MANIFEST);\r\n\t}\r\n\r\n\tprivate updateDisplayNames(): void {\r\n\t\tthis.updatePropertyNames().then(() => {\r\n\t\t\t// Timeout needed to view correct displayname\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\tthis.datagridOptions.dataset = this.dataset;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updatePropertyNames(): ng.IPromise<void> {\r\n\t\tconst deferred = this.frameworkService.getNewDeferred<void>();\r\n\t\tthis.dataset.forEach((item: IExpressionTreeView | IExpressionView) => {\r\n\t\t\tif (this.expressionType === ConditionType.ALL) {\r\n\t\t\t\t(item as IExpressionTreeView).children.forEach((child) => {\r\n\t\t\t\t\tthis.setSourcePropertyName(child).then(() => {\r\n\t\t\t\t\t\tthis.setTargetPropertyName(child).then(() => {\r\n\t\t\t\t\t\t\tdeferred.resolve();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.setSourcePropertyName(item as IExpressionView).then(() => {\r\n\t\t\t\t\tthis.setTargetPropertyName(item as IExpressionView).then(() => {\r\n\t\t\t\t\t\tdeferred.resolve();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate getComponentExpression(): IJsonExpression[] {\r\n\t\tconst allExpressions = this.currentProject.getExpressions();\r\n\t\tif (this.expressionType !== ConditionType.ALL) {\r\n\t\t\treturn allExpressions.filter((expression) => {\r\n\t\t\t\treturn expression.usedBy === this.selectedComponent.getId()\r\n\t\t\t\t\t&& expression.conditionType === this.expressionType;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\treturn allExpressions;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setTargetPropertyName(item: IExpressionView): ng.IPromise<void> {\r\n\t\treturn this.getPropertyName(item.targetName, item.targetPropertyName).then((propertyName) => {\r\n\t\t\titem.targetPropertyName = propertyName;\r\n\t\t\titem.targetName = this.getName(item.targetName);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setSourcePropertyName(item: IExpressionView): ng.IPromise<void> {\r\n\t\treturn this.getPropertyName(item.sourceName, item.sourcePropertyName).then((propertyName) => {\r\n\t\t\titem.sourcePropertyName = propertyName;\r\n\t\t\titem.sourceName = this.getName(item.sourceName);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getPropertyName(componentName: string, propertyName: string): ng.IPromise<string> {\r\n\t\tconst deferred = this.frameworkService.getNewDeferred<string>();\r\n\t\tlet propertyDisplayName;\r\n\t\tif (componentName === \"<static>\") {\r\n\t\t\tpropertyDisplayName = propertyName;\r\n\t\t\tdeferred.resolve(propertyDisplayName);\r\n\t\t} else {\r\n\t\t\tconst component = this.editorService.getComponentInstanceById(componentName);\r\n\t\t\tif (component) {\r\n\t\t\t\tcomponent.getBindingMetaData().then((bindings) => {\r\n\t\t\t\t\tif (bindings.length > 0) {\r\n\t\t\t\t\t\tpropertyDisplayName = bindings.find((binding) => {\r\n\t\t\t\t\t\t\treturn binding.sourceKey === propertyName;\r\n\t\t\t\t\t\t}).visibleName;\r\n\t\t\t\t\t\tdeferred.resolve(propertyDisplayName);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate getName(componentName: string): string {\r\n\t\tlet componentDisplayName;\r\n\t\tif (componentName === \"<static>\") {\r\n\t\t\tcomponentDisplayName = \"Static Value\";\r\n\t\t} else {\r\n\t\t\tconst component = this.editorService.getComponentInstanceById(componentName);\r\n\t\t\tcomponentDisplayName = component.getDisplayName();\r\n\t\t}\r\n\t\treturn componentDisplayName;\r\n\t}\r\n\r\n\tprivate buildDataset(): IExpressionView[] | IExpressionTreeView[] {\r\n\t\tconst expressionViewData: IExpressionView[] | IExpressionTreeView[] = [];\r\n\t\tthis.getComponentExpression().forEach((condition) => {\r\n\t\t\tconst displayItem = {\r\n\t\t\t\tid: condition.id,\r\n\t\t\t\tsourceName: condition.source,\r\n\t\t\t\ttargetName: condition.target,\r\n\t\t\t\tsourcePropertyName: condition.sourceProperty,\r\n\t\t\t\ttargetPropertyName: condition.targetProperty,\r\n\t\t\t\toperatorName: this.operatorDictionary[condition.clauseOperator],\r\n\t\t\t\tusedBy: this.getName(condition.usedBy),\r\n\t\t\t\tconditionalType: this.typeDictionary[condition.conditionType]\r\n\t\t\t};\r\n\t\t\tif (this.expressionType === ConditionType.ALL) { // Manage Dialog\r\n\t\t\t\tconst existingComponent = (expressionViewData as IExpressionTreeView[]).find((item) => {\r\n\t\t\t\t\treturn item.componentId === condition.usedBy;\r\n\t\t\t\t});\r\n\t\t\t\tif (existingComponent) {\r\n\t\t\t\t\texistingComponent.children.push(displayItem);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst manageDisplayItem = {\r\n\t\t\t\t\t\tcomponentId: condition.usedBy,\r\n\t\t\t\t\t\texpanded: false,\r\n\t\t\t\t\t\tchildren: [displayItem]\r\n\t\t\t\t\t};\r\n\t\t\t\t\t(expressionViewData as IExpressionTreeView[]).push(manageDisplayItem);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t(expressionViewData as IExpressionView[]).push(displayItem);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn expressionViewData;\r\n\t}\r\n\r\n\tprivate initGridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tif (this.expressionType === ConditionType.ALL) {\r\n\t\t\tconst manageColumns = [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"component\",\r\n\t\t\t\t\tname: \"Component\",\r\n\t\t\t\t\tfield: \"componentId\",\r\n\t\t\t\t\tsortable: true,\r\n\t\t\t\t\tformatter: Soho.Formatters.Tree,\r\n\t\t\t\t\twidth: \"21%\"\r\n\t\t\t\t}, {\r\n\t\t\t\t\tid: \"conditionalType\",\r\n\t\t\t\t\tname: \"Type\",\r\n\t\t\t\t\tfield: \"conditionalType\",\r\n\t\t\t\t\tsortable: true,\r\n\t\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t\t\twidth: \"21%\"\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t\tcolumns.push(...manageColumns);\r\n\t\t}\r\n\t\tconst gridcolumns = [{\r\n\t\t\tid: \"source\",\r\n\t\t\tname: \"Source\",\r\n\t\t\tfield: \"sourceName\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\twidth: \"21%\"\r\n\t\t}, {\r\n\t\t\tid: \"sourceProperty\",\r\n\t\t\tname: \"Property/Value\",\r\n\t\t\tfield: \"sourcePropertyName\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\twidth: \"21%\"\r\n\t\t}, {\r\n\t\t\tid: \"operator\",\r\n\t\t\tname: \"Operator\",\r\n\t\t\tfield: \"operatorName\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\twidth: \"16%\"\r\n\t\t}, {\r\n\t\t\tid: \"target\",\r\n\t\t\tname: \"Target\",\r\n\t\t\tfield: \"targetName\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\twidth: \"21%\"\r\n\t\t}, {\r\n\t\t\tid: \"targetProperty\",\r\n\t\t\tname: \"Property/Value\",\r\n\t\t\tfield: \"targetPropertyName\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\twidth: \"21%\"\r\n\t\t}\r\n\t\t];\r\n\t\tcolumns.push(...gridcolumns);\r\n\r\n\t\tconst options: IDataGridOptions<IExpressionTreeView | IExpressionView> = {\r\n\t\t\tdataset: [],\r\n\t\t\tcolumns: columns,\r\n\t\t\ttreeGrid: true,\r\n\t\t\tisList: true,\r\n\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Expression\",\r\n\t\t\t\tresults: true,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tadvancedFilter: true,\r\n\t\t\t\tactions: true,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.datagridOptions = options;\r\n\t\tthis.$element.find(\"#datagrid-expressions\")\r\n\t\t\t.on(\"selected\", (e: any, args: IRowItem<IExpressionView | IExpressionTreeView>[]) => {\r\n\t\t\t// When datagrid get unselected args[0] is undefined\r\n\t\t\t\tthis.$scope.$evalAsync(() => {\r\n\t\t\t\t\tif (args.length > 0) {\r\n\t\t\t\t\t\tif (!(args[0].data as IExpressionTreeView).children) {\r\n\t\t\t\t\t\t\tthis.itemSelected = true;\r\n\t\t\t\t\t\t\tthis.selectedExpression = this.getComponentExpression().find((condition) => {\r\n\t\t\t\t\t\t\t\treturn (args[0].data as IExpressionView).id === condition.id;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.selectedExpression = null;\r\n\t\t\t\t\t\tthis.itemSelected = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate refreshDataset(): void {\r\n\t\tthis.dataset = this.buildDataset();\r\n\t\tif (this.dataset.length > 0) {\r\n\t\t\tthis.updateDisplayNames();\r\n\t\t} else {\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\tthis.datagridOptions.dataset = this.dataset;\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.clearSelected();\r\n\t}\r\n\r\n\tprivate clearSelected(): void {\r\n\t\tthis.selectedExpression = null;\r\n\t\tthis.itemSelected = false;\r\n\t\tconst api = this.$element.find(\"#datagrid-expressions\").data(\"datagrid\") as IDatagridApi;\r\n\r\n\t\tif (api) {\r\n\t\t\tapi.deSelectAllRows();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirExpressionDialogCtrl\", ExpressionDialogCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { InjectNames, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IDataGridOptions, IDataItem } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { IErrorResponse } from \"../../../../common/error-response\";\r\nimport { DatagridHelper, IRowItem } from \"../../../../common/sohoxi/datagrid-helper\";\r\nimport { InteractionManagementService } from \"../../services/interaction-management-service\";\r\n\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport { ConflictResolutonService, IResolutionResult } from \"../../../../common/services/conflict-resolution-service\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialog, IDialogOptions, IDialogResult,\r\n\tIMessageDialogOptions, StandardDialogButtons\r\n} from \"../../../../common/services/dialog-service\";\r\nimport { HttpService } from \"../../../../common/services/http-service\";\r\nimport { RepositoryService } from \"../../../repository/repository-service\";\r\nimport { ProjectService } from \"../../../services/project-service\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\n\r\nexport interface IItemSpecificData {\r\n\tdataName: string;\r\n\tconflictKey: string;\r\n\turlName: string;\r\n\tmaxAllowed: number;\r\n\tmaxErrorMessage: string;\r\n}\r\n\r\nexport abstract class ManageDialogBase<T extends IJsonDatasource | IJsonCompositeComponent> {\r\n\tpublic itemSelected = false;\r\n\tpublic loading = false;\r\n\tpublic datagridOptions: IDataGridOptions<T>;\r\n\r\n\tprotected dialog: IDialog<void>;\r\n\tprotected selectedItems: T[] = [];\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.WINDOW,\r\n\t\tInjectNames.REPOSITORY_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.CONFLICT_RESOLUTION_SERVICE,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.PROJECT_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: IDialogBaseScope<void>,\r\n\t\tprotected $element: ng.IAugmentedJQuery,\r\n\t\tprotected $window: ng.IWindowService,\r\n\t\tprotected repositoryService: RepositoryService,\r\n\t\tprotected dialogService: DialogService,\r\n\t\tprotected editorService: EditorService,\r\n\t\tprotected conflictResolutionService: ConflictResolutonService,\r\n\t\tprotected httpService: HttpService,\r\n\t\tprotected projectService: ProjectService,\r\n\t\tprotected interactionManagementService: InteractionManagementService,\r\n\t) {\r\n\t\tthis.dialog = $scope.eirDialog;\r\n\t\tthis.initGrid();\r\n\t\tthis.$element.find(\"#local-grid\").on(\"selected\", (e: any, args: IRowItem<T>[]) => {\r\n\t\t\t// When datagrid get unselected args[0] is undefined\r\n\t\t\tthis.$scope.$evalAsync(() => {\r\n\t\t\t\tif (args.length > 0) {\r\n\t\t\t\t\tthis.itemSelected = true;\r\n\t\t\t\t\tthis.selectedItems = args.map(\r\n\t\t\t\t\t\trowObject => {\r\n\t\t\t\t\t\t\treturn rowObject.data;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.selectedItems = [];\r\n\t\t\t\t\tthis.itemSelected = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t});\r\n\t}\r\n\r\n\tprotected abstract addItemsToProject(items: T[]): void;\r\n\r\n\tprotected abstract deleteItems(ids: string[]): ng.IPromise<T[]>;\r\n\r\n\tprotected abstract export(): void;\r\n\r\n\tprotected abstract getDataList(): T[];\r\n\r\n\tprotected abstract getItemDisplayName(item: T): string;\r\n\r\n\tprotected abstract getItemId(item: T): string;\r\n\r\n\tprotected abstract initGrid(): void;\r\n\r\n\tprotected abstract getItemSpecificData(): IItemSpecificData;\r\n\r\n\tprotected abstract save(): ng.IPromise<void>;\r\n\r\n\tprotected abstract setItemId(item: T, id: string): void;\r\n\r\n\tpublic openGlobalRepository(): void {\r\n\t\tthis.loading = true;\r\n\t\tconst repoDatagridOptions = angular.copy(this.datagridOptions);\r\n\t\trepoDatagridOptions.toolbar.title = \"Global\";\r\n\t\tthis.repositoryService.getDataByName<T>(this.getItemSpecificData().urlName).then((items) => {\r\n\t\t\trepoDatagridOptions.dataset = items;\r\n\t\t\tconst options: IDialogOptions<any> = {\r\n\t\t\t\ttitle: \"Repository\",\r\n\t\t\t\ttemplate: require(\"./manage-repository-dialog/manage-repository-dialog.html\"),\r\n\t\t\t\tstyle: \"min-width: 1000px; max-width: 1125px;\",\r\n\t\t\t\tparameter: repoDatagridOptions,\r\n\t\t\t\tcssClass: \"repository-dialog\",\r\n\t\t\t};\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<any[]>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst notAdded: string[] = [];\r\n\t\t\t\t\tconst newItems = result.value;\r\n\t\t\t\t\tconst newUniqueItems = newItems.filter((newItem) => {\r\n\t\t\t\t\t\tconst isUnique = this.isUnique(newItem);\r\n\t\t\t\t\t\tif (!isUnique) {\r\n\t\t\t\t\t\t\tnotAdded.push(this.getItemDisplayName(newItem));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn isUnique;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (notAdded.length > 0) {\r\n\t\t\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\t\t\t\"Import\",\r\n\t\t\t\t\t\t\t\"Following item(s) already exist in your project<br />\" + notAdded.join(\"<br />\")\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnewUniqueItems.forEach(DatagridHelper.clearSohoProperties);\r\n\t\t\t\t\tthis.addItems(newUniqueItems);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}).catch((errorResponse) => {\r\n\t\t\tthis.datagridOptions.dataset = [];\r\n\t\t\tthis.dialogService.showError(\"Load from Repository\", errorResponse.message);\r\n\t\t}).finally(() => {\r\n\t\t\tthis.loading = false;\r\n\t\t});\r\n\t}\r\n\r\n\t// Adding from import-files or repository\r\n\tprotected addItems(newItems: T[]): ng.IPromise<T[]> | null {\r\n\t\tconst actionTitle = \"Import\";\r\n\t\tif (newItems.length === 0) {\r\n\t\t\treturn null;\r\n\t\t} else if (this.exceedsMaximum(newItems.length)) {\r\n\t\t\tthis.dialogService.showError(actionTitle, \"Tried to add more than max allowed\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst importPromise = this.importToCurrentProject(newItems);\r\n\t\timportPromise.then((response) => {\r\n\t\t\tif (response.length !== newItems.length) {\r\n\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\tactionTitle,\r\n\t\t\t\t\t`One or more ${this.getItemSpecificData().dataName}(s) was not imported due to error in them`\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.addItemsToProject(newItems);\r\n\t\t\tthis.datagridOptions.dataset = this.getDataList();\r\n\t\t\treturn response;\r\n\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t// When save fails revert all the newly added\r\n\t\t\tthis.dialogService.showError(\r\n\t\t\t\tactionTitle,\r\n\t\t\t\t`Failed to import any ${this.getItemSpecificData().dataName}(s).` +\r\n\t\t\t\t\"Due to \" + errorResponse.message + \".\"\r\n\t\t\t);\r\n\t\t});\r\n\t\treturn importPromise;\r\n\t}\r\n\r\n\tpublic import(): void {\r\n\t\tconst actionTitle = \"Import New\";\r\n\t\tif (this.exceedsMaximum()) {\r\n\t\t\tthis.dialogService.showError(actionTitle, this.getItemSpecificData().maxErrorMessage);\r\n\t\t} else {\r\n\t\t\tconst options: IDialogOptions<any> = {\r\n\t\t\t\ttitle: actionTitle,\r\n\t\t\t\ttemplate: require(\"../../../../common/dialogs/import/import-dialog.html\"),\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<FileList>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.loading = true;\r\n\t\t\t\t\tthis.repositoryService.readJsonFile<any[]>(result.value[0])\r\n\t\t\t\t\t\t.then((itemsToImport) => {\r\n\t\t\t\t\t\t\tif (this.exceedsMaximum(itemsToImport.length)) {\r\n\t\t\t\t\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\t\t\t\t\tactionTitle,\r\n\t\t\t\t\t\t\t\t\t`You are trying to import too many ${this.getItemSpecificData().dataName}s`\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.importItems(itemsToImport);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\t\t\t// Unable to read input file, probable JSON parse error\r\n\t\t\t\t\t\t\tconsole.warn(\"Could not read file\");\r\n\t\t\t\t\t\t\tthis.dialogService.showError(actionTitle, \"Unable to read file due to: <br \\>\" + errorResponse.message);\r\n\t\t\t\t\t\t}).finally(() => {\r\n\t\t\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate importItems(itemsToImport: T[]): void {\r\n\t\tthis.conflictResolutionService.resolve<T>(\r\n\t\t\titemsToImport,\r\n\t\t\tthis.datagridOptions.dataset,\r\n\t\t\tthis.getItemSpecificData().conflictKey,\r\n\t\t\tthis.getItemSpecificData().dataName,\r\n\t\t\tthis.getItemSpecificData().maxAllowed\r\n\t\t).then((conflictResolutionObject: IResolutionResult<T>) => {\r\n\t\t\tconst idsToDelete = conflictResolutionObject.toRemove.map(\r\n\t\t\t\t(itemToImport: any) => { return itemToImport.id; }\r\n\t\t\t);\r\n\t\t\tthis.deleteItems(idsToDelete)\r\n\t\t\t\t.then(deletedItems => {\r\n\t\t\t\t\tconflictResolutionObject.toAdd.forEach((item: T) => {\r\n\t\t\t\t\t\tthis.setItemId(item, Helper.generateUniqueId());\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.addItems(conflictResolutionObject.toAdd).catch(() => {\r\n\t\t\t\t\t\t// If import fails revert deleted items\r\n\t\t\t\t\t\tthis.addItems(deletedItems);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t}).catch(() => {\r\n\t\t\t// User cancel\r\n\t\t\tthis.loading = false;\r\n\t\t});\r\n\t}\r\n\r\n\tpublic deleteItem(): void {\r\n\t\tconst actionTitle = \"Delete Item\";\r\n\t\tconst displayNames: string[] = [];\r\n\t\tconst idsToDelete: string[] = this.selectedItems.map((item) => {\r\n\t\t\tif ((item as IJsonDatasource).id) {\r\n\t\t\t\tdisplayNames.push((item as IJsonDatasource).displayName);\r\n\t\t\t\treturn (item as IJsonDatasource).id;\r\n\t\t\t} else {\r\n\t\t\t\tdisplayNames.push((item as IJsonCompositeComponent).manifest.displayName);\r\n\t\t\t\treturn (item as IJsonCompositeComponent).manifest.id;\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: actionTitle,\r\n\t\t\tmessage: \"Are you sure you want to delete these Items?<br \\>\" + displayNames.join(\", \"),\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(options).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.deleteItems(idsToDelete).then(deletedItems => {\r\n\t\t\t\t\tif (deletedItems.length > 0) {\r\n\t\t\t\t\t\tthis.itemSelected = false;\r\n\t\t\t\t\t\tthis.selectedItems = [];\r\n\t\t\t\t\t\tthis.save();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}).finally(() => {\r\n\t\t\tthis.datagridOptions.dataset = this.getDataList();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.getDataList().forEach(dataItem => {\r\n\t\t\tDatagridHelper.clearSohoProperties(dataItem as IDataItem);\r\n\t\t});\r\n\t\tthis.dialog.close({ button: DialogButtonType.Ok });\r\n\t}\r\n\r\n\tprivate exceedsMaximum(withExtra?: number): boolean {\r\n\t\tlet amount = this.getDataList().length;\r\n\t\tif (withExtra) {\r\n\t\t\tamount += withExtra;\r\n\t\t}\r\n\t\treturn amount > this.getItemSpecificData().maxAllowed;\r\n\t}\r\n\r\n\tprivate importToCurrentProject(newItems: T[]): ng.IPromise<T[]> {\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tconst url = ServerPaths.PROJECT +\r\n\t\t\tcurrentProject.getId() + \"/\" +\r\n\t\t\tthis.getItemSpecificData().urlName + \"import\";\r\n\t\treturn this.httpService.executePost<T[]>(url, newItems);\r\n\t}\r\n\r\n\tprivate isUnique(item: T): boolean {\r\n\t\tconst idToFind = this.getItemId(item);\r\n\t\tconst existingItems = this.getDataList();\r\n\t\treturn !existingItems.some((existingItem) => {\r\n\t\t\treturn this.getItemId(existingItem) === idToFind;\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","import {\r\n\tButtonStyle,\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { BaseComponentMetadata } from \"ng2/components/base/component.metadata\";\r\n\r\nexport class ButtonMetadata {\r\n\tstatic availableButtonStyles: IDataPair[] = [\r\n\t\t{ name: \"Primary\", value: ButtonStyle.PRIMARY },\r\n\t\t{ name: \"Secondary\", value: ButtonStyle.SECONDARY },\r\n\t\t{ name: \"Tertiary\", value: ButtonStyle.TERTIARY }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CLICK]);\r\n\tstatic TARGET_ACTIONS = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_CLICK;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Content\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"Action\" }\r\n\t}];\r\n\tstatic SETTING_FIELDS =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\tref: SettingKeys.STYLE,\r\n\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\tdataset: ButtonMetadata.availableButtonStyles,\r\n\t\t\tdefaultValue: ButtonStyle.PRIMARY\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Disabled\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false,\r\n\t\t\tbutton: {\r\n\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\tdialog: true\r\n\t\t\t},\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(BaseComponentMetadata.SETTING_FIELDS);\r\n}","import {\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { BaseComponentMetadata } from \"ng2/components/base/component.metadata\";\r\n\r\nexport class ListMetadata {\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.LIST];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic SETTING_FIELDS =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Show Header\",\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true,\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Options\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Keep Selection\",\r\n\t\t\ttooltip: \"Keep previous selected row on reload. (With ION APIs, an object ID is preferred if using this)\",\r\n\t\t\tref: SettingKeys.KEEP_SELECTED,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(BaseComponentMetadata.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Selected Item\",\r\n\t\tref: SettingKeys.CURRENT_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Header\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n}","import {\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { BaseComponentMetadata } from \"ng2/components/base/component.metadata\";\r\n\r\nexport class TextboxMetadata {\r\n\tstatic AVAILABLE_WIDTHS: IDataPair[] = [\r\n\t\t{ name: \"Tiny\", value: \"input-xs\" },\r\n\t\t{ name: \"Small\", value: \"input-sm\" },\r\n\t\t{ name: \"Medium\", value: \"input-mm\" },\r\n\t\t{ name: \"Large\", value: \"input-default\" }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Show Label\",\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true,\r\n\t\t}, {\r\n\t\t\ttitle: \"Read Only\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false,\r\n\t\t\tbutton: {\r\n\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\tdialog: true\r\n\t\t\t}\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Width\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.BOX_WIDTH,\r\n\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\tdataset: TextboxMetadata.AVAILABLE_WIDTHS,\r\n\t\t\tdefaultValue: \"input-default\",\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(BaseComponentMetadata.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Text\",\r\n\t\tref: SettingKeys.TEXT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Placeholder\",\r\n\t\tref: SettingKeys.PLACEHOLDER,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}\r\n\t];\r\n}\r\n","import {\r\n\tChangeDetectorRef,\r\n\tComponent,\r\n\tElementRef,\r\n\tRenderer2,\r\n} from \"@angular/core\";\r\nimport { SohoMessageService } from \"ids-enterprise-ng\";\r\nimport { take } from \"rxjs/operators\";\r\n\r\nimport { InteractionTriggerEnum, SubstitutionTags } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonButton } from \"ng2/common/model/databearer/components/json-button.model\";\r\n\r\nimport { ButtonMetadata } from \"ng2/components/button/button.metadata\";\r\n\r\nimport { BaseComponent } from \"ng2/components/base/component\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\n@Component({\r\n\tselector: \"ng2-button\",\r\n\ttemplate: `\r\n\t\t<button\r\n\t\t\t[soho-button]=\"style\"\r\n\t\t\tsoho-busyindicator\r\n\t\t\t[disabled]=\"busyIndicator.activated\"\r\n\t\t\t(click)=\"onClick()\"\r\n\t\t>\r\n\t\t\t{{ content }}\r\n\t\t</button>\r\n\t`\r\n})\r\nexport class ButtonComponent extends BaseComponent {\r\n\r\n\tcontent: string;\r\n\tstyle: string;\r\n\r\n\tdatabearer: IJsonButton;\r\n\r\n\tconstructor(\r\n\t\telementRef: ElementRef,\r\n\t\trenderer: Renderer2,\r\n\t\tchangeDetectorRef: ChangeDetectorRef,\r\n\t\tframeworkService: FrameworkService,\r\n\t\tdynamicComponentService: DynamicComponentService,\r\n\t\tsohoMessageService: SohoMessageService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\telementRef,\r\n\t\t\trenderer,\r\n\t\t\tchangeDetectorRef,\r\n\t\t\tframeworkService,\r\n\t\t\tdynamicComponentService,\r\n\t\t\tsohoMessageService,\r\n\t\t);\r\n\t}\r\n\r\n\tinitializeBinding(componentDatabearer: IJsonButton): void {\r\n\t\tButtonMetadata.BINDABLE_FIELDS_2.forEach(field => {\r\n\t\t\tconst self: any = this;\r\n\t\t\tconst bindingValue = componentDatabearer[field.ref].value;\r\n\t\t\tself[field.ref] = bindingValue === SubstitutionTags.VALUE ?\r\n\t\t\t\t\"\" : bindingValue;\r\n\t\t});\r\n\t}\r\n\r\n\tonClick(): void {\r\n\t\tthis.trigger(InteractionTriggerEnum.CLICK)\r\n\t\t\t.pipe(take(1));\r\n\t}\r\n\r\n}\r\n","import {\r\n\tChangeDetectorRef,\r\n\tComponent,\r\n\tElementRef,\r\n\tRenderer2,\r\n\tViewChild,\r\n} from \"@angular/core\";\r\nimport { SohoDropDownComponent, SohoMessageService } from \"ids-enterprise-ng\";\r\nimport { Observable, of } from \"rxjs\";\r\n\r\nimport { InteractionTriggerEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IJsonDropdown } from \"ng2/common/model/databearer/components/json-dropdown.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { DropdownMetadata } from \"ng2/components/dropdown/dropdown.metadata\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { BaseComponent } from \"ng2/components/base/component\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\nexport interface ICurrentItem extends IMap<any> { }\r\n\r\n@Component({\r\n\tselector: \"ng2-button\",\r\n\ttemplate: `\r\n\t\t<div [id]=\"id\" class=\"dropdown-container\">\r\n\t\t\t<label\r\n\t\t\t\t*ngIf=\"showLabel\"\r\n\t\t\t\tclass=\"label\"\r\n\t\t\t\t[for]=\"id\"\r\n\t\t\t>\r\n\t\t\t\t{{ label }}\r\n\t\t\t</label>\r\n\t\t</div>\r\n\t\t<select soho-dropdown soho-busyindicator\r\n\t\t\t[name]=\"id\"\r\n\t\t\t[(ngModel)]=\"currentItem\"\r\n\t\t\t(change)=\"onChange($event)\"\r\n\t\t>\r\n\t\t\t<option\r\n\t\t\t\t*ngFor=\"let item of (contextData$ | async)\"\r\n\t\t\t\t[ngValue]=\"item\"\r\n\t\t\t>\r\n\t\t\t\t{{ item[databearer.displayValue.sourceKey] }}\r\n\t\t\t</option>\r\n\t\t</select>\r\n\t`\r\n})\r\nexport class DropdownComponent extends BaseComponent {\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tdisplayValue: string;\r\n\tcurrentItem: ICurrentItem;\r\n\tcurrentItemIndex: number;\r\n\r\n\tdatabearer: IJsonDropdown;\r\n\r\n\tcontextData$: Observable<any[]>;\r\n\r\n\t@ViewChild(SohoDropDownComponent, {\r\n\t\tstatic: true\r\n\t}) dropDownComponent: SohoDropDownComponent;\r\n\r\n\tconstructor(\r\n\t\telementRef: ElementRef,\r\n\t\trenderer: Renderer2,\r\n\t\tchangeDetectorRef: ChangeDetectorRef,\r\n\t\tframeworkService: FrameworkService,\r\n\t\tdynamicComponentService: DynamicComponentService,\r\n\t\tsohoMessageService: SohoMessageService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\telementRef,\r\n\t\t\trenderer,\r\n\t\t\tchangeDetectorRef,\r\n\t\t\tframeworkService,\r\n\t\t\tdynamicComponentService,\r\n\t\t\tsohoMessageService\r\n\t\t);\r\n\t}\r\n\r\n\tonInitComponent(): void {\r\n\t\tsuper.onInitComponent();\r\n\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(this.databearer);\r\n\t}\r\n\r\n\tinitializeBinding(componentDatabearer: IJsonDropdown): void {\r\n\t\tDropdownMetadata.BINDABLE_FIELDS_2.forEach(field => {\r\n\t\t\tswitch (field.valueType) {\r\n\t\t\t\tcase ValueTypeEnum.OBJECT: // 4\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ValueTypeEnum.STRING: // 1\r\n\t\t\t\tcase ValueTypeEnum.LOCALIZED_STRING: // 7\r\n\t\t\t\tdefault: {\r\n\t\t\t\t\tconst self: any = this;\r\n\t\t\t\t\tself[field.ref] = componentDatabearer[field.ref]?.value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tdataServiceCompleted(component: DropdownComponent): void {\r\n\t\tsuper.dataServiceCompleted(component);\r\n\r\n\t\tcomponent.currentItem = component.context.ListResult[0];\r\n\t\tcomponent.contextData$ = of(component.context.ListResult);\r\n\r\n\t\tthis.refreshComponent();\r\n\t\tthis.onChange();\r\n\t}\r\n\r\n\t/**\r\n\t * This is needed because. IDS dropdown does not have item in it until first action.\r\n\t */\r\n\tprivate refreshComponent(): void {\r\n\t\tthis.dropDownComponent.setFocus();\r\n\t\t$(\":focus\").blur();\r\n\t}\r\n\r\n\tonChange(event?: SohoDropDownEvent): void {\r\n\r\n\t\tconsole.info(event);\r\n\r\n\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\tthis.updateBindings();\r\n\t}\r\n\r\n}\r\n","import {\r\n\tChangeDetectorRef,\r\n\tComponent,\r\n\tElementRef,\r\n\tRenderer2\r\n} from \"@angular/core\";\r\nimport { SohoMessageService } from \"ids-enterprise-ng\";\r\n\r\nimport { AlignmentEnum, FlexSizeTypeEnum, SettingKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IComponentStyleProperties, ICssProperties } from \"ng2/common/model/components/base/component-style.model\";\r\nimport type { IComponent } from \"ng2/common/model/components/base/component.model\";\r\nimport type { IJsonMargin, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\n\r\nimport { FlexboxMetadata } from \"ng2/components/layout-components/flexbox/flexbox.metadata\";\r\n\r\nimport { LayoutComponent } from \"ng2/components/base/layout-component\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\n@Component({\r\n\tselector: \"ng2-flexbox\",\r\n\ttemplate: `\r\n\t\t<div\r\n\t\t\tid=\"child-cage-{{ id }}\"\r\n\t\t\tclass=\"child-cage\"\r\n\t\t\t[ngStyle]=\"inlineStyles\"\r\n\t\t>\r\n\t\t\t<children-component-container\r\n\t\t\t\t[ngClass]=\"{ 'vertical': orientation === 2 }\"\r\n\t\t\t\t[parent]=\"this\"\r\n\t\t\t\t(onChildrenReady)=\"onChildrenReady($event)\"\r\n\t\t\t></children-component-container>\r\n\t\t</div>\r\n\t`\r\n})\r\nexport class FlexboxComponent extends LayoutComponent {\r\n\r\n\t// Style Settings\r\n\torientation: OrientationEnum;\r\n\tsizeType: FlexSizeTypeEnum;\r\n\tsize: number;\r\n\r\n\tclassNames: string;\r\n\tinlineStyles: ICssProperties; // .child-cage\r\n\r\n\thasIndividualChildSizes = true;\r\n\r\n\tdatabearer: IJsonFlexbox;\r\n\r\n\tconstructor(\r\n\t\telementRef: ElementRef,\r\n\t\trenderer: Renderer2,\r\n\t\tchangeDetectorRef: ChangeDetectorRef,\r\n\t\tframeworkService: FrameworkService,\r\n\t\tdynamicComponentService: DynamicComponentService,\r\n\t\tsohoMessageService: SohoMessageService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\telementRef,\r\n\t\t\trenderer,\r\n\t\t\tchangeDetectorRef,\r\n\t\t\tframeworkService,\r\n\t\t\tdynamicComponentService,\r\n\t\t\tsohoMessageService,\r\n\t\t);\r\n\t}\r\n\r\n\tngAfterViewInit(): void {\r\n\t\t// super.ngAfterViewInit();\r\n\t\t// console.info(\"ngAfterViewInit\", this.children);\r\n\t}\r\n\r\n\tprivate getOrientationSettings(id: string): OrientationEnum {\r\n\r\n\t\tlet orientation = this.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, id);\r\n\r\n\t\tif (!orientation) {\r\n\t\t\torientation = this.frameworkService.componentService\r\n\t\t\t\t.getDefaultComponentSettingValue<OrientationEnum>(\r\n\t\t\t\t\tFlexboxMetadata.SETTING_FIELDS,\r\n\t\t\t\t\tSettingKeys.ORIENTATION, \"Orientation\"\r\n\t\t\t\t);\r\n\t\t}\r\n\t\treturn orientation;\r\n\t}\r\n\r\n\tprivate getAlignment(): ICssProperties {\r\n\t\tconst horizAlignment = this.getBoundarySetting<AlignmentEnum>(SettingKeys.ALIGNMENT_HORIZONTAL);\r\n\t\tconst verticAlignment = this.getBoundarySetting<AlignmentEnum>(SettingKeys.ALIGNMENT_VERTICAL);\r\n\r\n\t\treturn {\r\n\t\t\t\"justify-content\": this.getAlignmentProperty(\r\n\t\t\t\tthis.orientation === OrientationEnum.HORIZONTAL ? horizAlignment : verticAlignment),\r\n\t\t\t\"align-items\": this.getAlignmentProperty(\r\n\t\t\t\tthis.orientation === OrientationEnum.HORIZONTAL ? verticAlignment : horizAlignment)\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getAlignmentProperty(alignment: AlignmentEnum): string {\r\n\t\tlet alignmentProperty: string;\r\n\t\tswitch (alignment) {\r\n\t\t\tcase AlignmentEnum.FLEX_START:\r\n\t\t\t\talignmentProperty = \"flex-start\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase AlignmentEnum.CENTER:\r\n\t\t\t\talignmentProperty = \"center\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase AlignmentEnum.FLEX_END:\r\n\t\t\t\talignmentProperty = \"flex-end\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[Flexbox] Invalid alignment:\" + alignment);\r\n\t\t}\r\n\t\treturn alignmentProperty;\r\n\t}\r\n\r\n\tprivate getPadding(): ICssProperties {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tconst padding: ICssProperties = {\r\n\t\t\tpadding: margin.top + \"px \" + margin.right + \"px \" + margin.bottom + \"px \" + margin.left + \"px\"\r\n\t\t};\r\n\t\treturn padding;\r\n\t}\r\n\r\n\tgetPxPerPercentComponent(ori: OrientationEnum, percent: number): number {\r\n\t\tlet pixels = 0;\r\n\t\t// Only calculate for vertical (height) since flexbox doesn't allow content to be placed horizontally yet.\r\n\t\tif (ori === OrientationEnum.VERTICAL) {\r\n\t\t\tthis.children.forEach((child: IComponent) => {\r\n\t\t\t\tif (child.getBoundarySetting<boolean>(SettingKeys.VISIBILITY) &&\r\n\t\t\t\t\tchild.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT).sizeType === SizeTypeEnum.AUTO) {\r\n\t\t\t\t\tpixels += child.element.outerHeight(true);\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t}\r\n\t\treturn pixels;\r\n\t}\r\n\r\n\tupdateClassNames(): void {\r\n\t\tthis.classNames = \"something\";\r\n\t}\r\n\r\n\tupdateInlineStyles(): void {\r\n\t\tthis.calcNewSizes();\r\n\t\tthis.updateChildCageInlineStyles();\r\n\t\tthis.updateParentInlineStyles();\r\n\t}\r\n\r\n\tprivate updateChildCageInlineStyles(): void {\r\n\r\n\t\tconst boundary = this.frameworkService.currentBoundary;\r\n\r\n\t\tthis.orientation = this.getOrientationSettings(boundary.id);\r\n\t\tthis.sizeType = this.getBoundarySetting<FlexSizeTypeEnum>(\r\n\t\t\tSettingKeys.SIZE_TYPE, boundary.id);\r\n\t\tthis.size = this.getBoundarySetting<number>(SettingKeys.SIZE, boundary.id);\r\n\r\n\t\tthis.inlineStyles =\r\n\t\t\tObject.assign({}, this.getAlignment(), this.getPadding());\r\n\t}\r\n\r\n\tprivate updateParentInlineStyles(): void {\r\n\t\tconst generalComponentStyle = this.getInlineStyles();\r\n\r\n\t\tconst backgroundColor =\r\n\t\t\tthis.getBoundarySetting<string>(SettingKeys.BACKGROUND_COLOR);\r\n\r\n\t\tconst componentStyleProperties: IComponentStyleProperties = Object.assign(\r\n\t\t\t{\r\n\t\t\t\tbackgroundColor: backgroundColor === undefined ? \"\" : backgroundColor,\r\n\t\t\t\tpadding: null,\r\n\t\t\t\t// Width and height have default values in flexbox.less\r\n\t\t\t\twidth: \"\",\r\n\t\t\t\theight: \"\",\r\n\t\t\t},\r\n\t\t\tgeneralComponentStyle\r\n\t\t);\r\n\r\n\t\t// TODO: Padding SettingKeys are for some reason called MARGIN which is wrong fix this\r\n\t\tdelete componentStyleProperties.margin;\r\n\r\n\t\tcomponentStyleProperties.width = \"\";\r\n\r\n\t\tif (this.sizeType === FlexSizeTypeEnum.PIXELS) {\r\n\t\t\tconst value = this.size + \"px\";\r\n\t\t\tcomponentStyleProperties.flexGrow = 0;\r\n\t\t\tcomponentStyleProperties.flexShrink = 0;\r\n\t\t\tcomponentStyleProperties.flexBasis = value;\r\n\t\t} else {\r\n\t\t\tcomponentStyleProperties.flexShrink = 1;\r\n\t\t\tcomponentStyleProperties.flexBasis = 0;\r\n\t\t\tcomponentStyleProperties.flexGrow = this.size;\r\n\t\t}\r\n\r\n\t\tthis.setStyles(componentStyleProperties);\r\n\t}\r\n}\r\n","import {\r\n\tChangeDetectorRef,\r\n\tComponent,\r\n\tElementRef,\r\n\tRenderer2,\r\n\tViewChild,\r\n} from \"@angular/core\";\r\nimport {\r\n\tSohoListViewComponent,\r\n\tSohoMessageService\r\n} from \"ids-enterprise-ng\";\r\nimport { Observable, of } from \"rxjs\";\r\n\r\nimport {\r\n\tListTemplateIdEnum,\r\n\tSubstitutionTags,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonLabel } from \"ng2/common/model/databearer/components/json-label.model\";\r\nimport type { IJsonList } from \"ng2/common/model/databearer/components/json-list.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\n\r\nimport { ListMetadata } from \"ng2/components/list/list.metadata\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { BaseComponent } from \"ng2/components/base/component\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\n@Component({\r\n\tselector: \"ng2-list\",\r\n\ttemplate: `\r\n\t\t<div class=\"full-height\"\r\n\t\t\t[id]=\"id\"\r\n\t\t\tsoho-busyindicator\r\n\t\t>\r\n\t\t\t<soho-toolbar-flex\r\n\t\t\t\t*ngIf=\"showLabel\"\r\n\t\t\t>\r\n\t\t\t\t<soho-toolbar-flex-section\r\n\t\t\t\t\t*ngIf=\"showLabel\"\r\n\t\t\t\t\t[isTitle]=\"true\"\r\n\t\t\t\t\t[isTitleFavor]=\"true\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<h2>{{ label }}</h2>\r\n\t\t\t\t</soho-toolbar-flex-section>\r\n\t\t\t</soho-toolbar-flex>\r\n\r\n\t\t\t<soho-listview\r\n\t\t\t\t[ngSwitch]=\"template.id\"\r\n\t\t\t\t(selected)=\"onSelected($event)\"\r\n\t\t\t>\r\n\t\t\t\t<li soho-listview-item\r\n\t\t\t\t\t*ngFor=\"let item of ( contextData$ | async )\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ng-container\r\n\t\t\t\t\t\t*ngSwitchCase=\"'OneLabelFlexbox'\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<p soho-listview-header>{{ item[templateId[0]] }}</p>\r\n\t\t\t\t\t</ng-container>\r\n\t\t\t\t\t<ng-container\r\n\t\t\t\t\t\t*ngSwitchCase=\"'TwoVerticalLabels'\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<p soho-listview-header>{{ item[templateId[0]] }}</p>\r\n\t\t\t\t\t\t<p soho-listview-subheader>{{ item[templateId[1]] }}</p>\r\n\t\t\t\t\t</ng-container>\r\n\t\t\t\t\t<ng-container\r\n\t\t\t\t\t\t*ngSwitchDefault\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tYolo\r\n\t\t\t\t\t</ng-container>\r\n\t\t\t\t</li>\r\n\t\t\t</soho-listview>\r\n\t\t</div>\r\n\t`\r\n})\r\nexport class ListComponent extends BaseComponent {\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\r\n\tcurrentItem: IListDataItem;\r\n\r\n\ttemplate: IJsonLayoutComponent;\r\n\ttemplateId: string[] = [];\r\n\r\n\tdatabearer: IJsonList;\r\n\r\n\tcontextData$: Observable<any[]>;\r\n\r\n\t@ViewChild(SohoListViewComponent, {\r\n\t\tstatic: true\r\n\t}) listComponent: SohoListViewComponent;\r\n\r\n\tconstructor(\r\n\t\telementRef: ElementRef,\r\n\t\trenderer: Renderer2,\r\n\t\tchangeDetectorRef: ChangeDetectorRef,\r\n\t\tframeworkService: FrameworkService,\r\n\t\tdynamicComponentService: DynamicComponentService,\r\n\t\tsohoMessageService: SohoMessageService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\telementRef,\r\n\t\t\trenderer,\r\n\t\t\tchangeDetectorRef,\r\n\t\t\tframeworkService,\r\n\t\t\tdynamicComponentService,\r\n\t\t\tsohoMessageService,\r\n\t\t);\r\n\t}\r\n\r\n\tonInitComponent(): void {\r\n\t\tsuper.onInitComponent();\r\n\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(this.databearer);\r\n\t}\r\n\r\n\tinitializeBinding(componentDatabearer: IJsonList): void {\r\n\t\tListMetadata.BINDABLE_FIELDS_2.forEach(field => {\r\n\t\t\tconst self: any = this;\r\n\t\t\tconst bindingValue = componentDatabearer[field.ref]?.value;\r\n\t\t\tself[field.ref] = bindingValue === SubstitutionTags.VALUE ?\r\n\t\t\t\t\"\" : bindingValue;\r\n\r\n\t\t\t// TODO: look into how to make this generic and not specific way to set boundary values\r\n\t\t\tconst currentBoundary = this.frameworkService.currentBoundary;\r\n\t\t\tconst boundarySetting = componentDatabearer.boundarySettings[currentBoundary.displayName];\r\n\r\n\t\t\tthis.template = boundarySetting.itemTemplate;\r\n\t\t\tconsole.info(`List Template: ${ this.template.id }`);\r\n\t\t});\r\n\t}\r\n\r\n\tdataServiceCompleted(component: ListComponent): void {\r\n\t\tsuper.dataServiceCompleted(component);\r\n\r\n\t\tthis.setTemplateBindings();\r\n\t\tcomponent.contextData$ = of(component.context.ListResult);\r\n\r\n\t\t// TODO: look into how to make this generic and not specific\r\n\t\tthis.changeDetectorRef.detectChanges();\r\n\t}\r\n\r\n\t/**\r\n\t * TODO: POC Parser\r\n\t * Refactor old list editor into new List Component. Will become much more simple in its design\r\n\t */\r\n\tprivate setTemplateBindings(): void {\r\n\r\n\t\tthis.templateId.length = 0;\r\n\t\tswitch (this.template.id) {\r\n\t\t\tcase ListTemplateIdEnum.OneLabelFlexbox:\r\n\t\t\tcase ListTemplateIdEnum.TwoVerticalLabels:\r\n\t\t\tdefault:\r\n\t\t\t\tthis.template.children\r\n\t\t\t\t\t.forEach((item: IJsonLabel) => {\r\n\t\t\t\t\t\tthis.templateId.push(item.content.sourceKey);\r\n\t\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tonSelected(): void {\r\n\r\n\t\tconst selectedItemIndex = this.listComponent.getSelectedItems[0] as number;\r\n\t\tthis.currentItem = this.context.ListResult[selectedItemIndex];\r\n\r\n\t\tthis.updateBindings();\r\n\t}\r\n}\r\n","import {\r\n\tChangeDetectorRef,\r\n\tComponent,\r\n\tElementRef,\r\n\tRenderer2,\r\n\tViewChild,\r\n} from \"@angular/core\";\r\nimport {\r\n\tSohoLookupComponent,\r\n\tSohoMessageService,\r\n} from \"ids-enterprise-ng\";\r\nimport isNil from \"lodash-es/isNil\";\r\n\r\nimport {\r\n\tInteractionTriggerEnum,\r\n\tSubstitutionTags\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\n\r\nimport { LookupMetadata } from \"ng2/components/lookup/lookup.metadata\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { BaseComponent } from \"ng2/components/base/component\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\n@Component({\r\n\tselector: \"ng2-lookup\",\r\n\ttemplate: `\r\n\t\t<div class=\"field\">\r\n\t\t\t<label\r\n\t\t\t\t[for]=\"id\"\r\n\t\t\t\tsoho-label\r\n\t\t\t\t*ngIf=\"showLabel\"\r\n\t\t\t>\r\n\t\t\t\t{{ label }}\r\n\t\t\t</label>\r\n\t\t\t<input\r\n\t\t\t\tsoho-lookup\r\n\t\t\t\tsoho-busyindicator\r\n\t\t\t\t[columns]=\"columns\"\r\n\t\t\t\t[dataset]=\"dataset\"\r\n\t\t\t\t[beforeShow]=\"onBeforeShow.bind(this)\"\r\n\t\t\t/>\r\n\t\t</div>\r\n\t`\r\n})\r\nexport class LookupComponent extends BaseComponent {\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\r\n\tcolumns: any;\r\n\tdataset: any;\r\n\t@ViewChild(SohoLookupComponent) sohoLookupComponent: SohoLookupComponent;\r\n\tdatabearer: IJsonLookup;\r\n\r\n\tconstructor(\r\n\t\telementRef: ElementRef,\r\n\t\trenderer: Renderer2,\r\n\t\tchangeDetectorRef: ChangeDetectorRef,\r\n\t\tframeworkService: FrameworkService,\r\n\t\tdynamicComponentService: DynamicComponentService,\r\n\t\tsohoMessageService: SohoMessageService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\telementRef,\r\n\t\t\trenderer,\r\n\t\t\tchangeDetectorRef,\r\n\t\t\tframeworkService,\r\n\t\t\tdynamicComponentService,\r\n\t\t\tsohoMessageService,\r\n\t\t);\r\n\t}\r\n\r\n\tonInitComponent(): void {\r\n\t\tsuper.onInitComponent();\r\n\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(this.databearer);\r\n\t}\r\n\r\n\tinitializeBinding(componentDatabearer: IJsonLookup): void {\r\n\t\tLookupMetadata.BINDABLE_FIELDS_2.forEach(field => {\r\n\t\t\tconst self: any = this;\r\n\t\t\tconst bindingValue = componentDatabearer[field.ref].value;\r\n\t\t\tself[field.ref] = bindingValue === SubstitutionTags.VALUE ?\r\n\t\t\t\t\"\" : bindingValue;\r\n\t\t});\r\n\r\n\t\tthis.columns = [\r\n\t\t\t{\r\n\t\t\t\tid: \"productId\",\r\n\t\t\t\tname: \"Product Id\",\r\n\t\t\t\tfield: \"productId\",\r\n\t\t\t\tformatter: Soho.Formatters.Readonly\r\n\t\t\t},\r\n\t\t];\r\n\r\n\t\tthis.dataset = [\r\n\t\t\t{\r\n\t\t\t\tid: 1,\r\n\t\t\t\tproductId: 2142201,\r\n\t\t\t\tproductName: \"Compressor\",\r\n\t\t\t\tactivity:  \"Assemble Paint\",\r\n\t\t\t\tquantity: 1,\r\n\t\t\t\tprice: 210.99,\r\n\t\t\t\tstatus: \"OK\",\r\n\t\t\t\torderDate: new Date(2014, 12, 8),\r\n\t\t\t\taction: \"Action\",\r\n\t\t\t}\r\n\t\t];\r\n\t}\r\n\r\n\t// TODO: Needs to be completed when completed\r\n\t// https://github.com/infor-design/enterprise-ng/issues/899\r\n\tonBeforeShow(\r\n\t\tapi: SohoLookupStatic,\r\n\t\tresponse: SohoLookupBeforeShowResponse\r\n\t): void {\r\n\t\tif (isNil(this.datasource)) {\r\n\t\t\tthis.showErrorDialog(\r\n\t\t\t\t`No data service available on component: ${this.databearer.displayName}`);\r\n\r\n\t\t\tthis.busyIndicator.activated = false;\r\n\r\n\t\t\treturn response(false as any);\r\n\t\t} else {\r\n\t\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\r\n\t\t\treturn response();\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import {\r\n\tChangeDetectorRef,\r\n\tComponent,\r\n\tElementRef,\r\n\tRenderer2,\r\n\tViewChild,\r\n} from \"@angular/core\";\r\nimport { SohoInputComponent, SohoMessageService } from \"ids-enterprise-ng\";\r\n\r\nimport { SubstitutionTags } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonTextBox } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\n\r\nimport { TextboxMetadata } from \"ng2/components/textbox/textbox.metadata\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { BaseComponent } from \"ng2/components/base/component\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\n@Component({\r\n\tselector: \"ng2-textbox\",\r\n\ttemplate: `\r\n\t\t<div class=\"field\">\r\n\t\t\t<label [for]=\"id\"\r\n\t\t\t\t*ngIf=\"showLabel\">\r\n\t\t\t\t{{ label }}\r\n\t\t\t</label>\r\n\t\t\t<input [type]=\"editType\" [id]=\"id\" [name]=\"id\" [class]=\"boxWidth\"\r\n\t\t\t\tsoho-input\r\n\t\t\t\tsoho-busyindicator\r\n\t\t\t\t[(ngModel)]=\"text\"\r\n\t\t\t\t[readOnly]=\"isReadonly\"\r\n\t\t\t/>\r\n\t\t</div>\r\n\t`\r\n})\r\nexport class TextboxComponent extends BaseComponent {\r\n\r\n\ttext: string;\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tplaceholder: string;\r\n\tboxWidth: string;\r\n\teditType: string;\r\n\r\n\t@ViewChild(SohoInputComponent) input: SohoInputComponent;\r\n\r\n\tdatabearer: IJsonTextBox;\r\n\r\n\tconstructor(\r\n\t\telementRef: ElementRef,\r\n\t\trenderer: Renderer2,\r\n\t\tchangeDetectorRef: ChangeDetectorRef,\r\n\t\tframeworkService: FrameworkService,\r\n\t\tdynamicComponentService: DynamicComponentService,\r\n\t\tsohoMessageService: SohoMessageService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\telementRef,\r\n\t\t\trenderer,\r\n\t\t\tchangeDetectorRef,\r\n\t\t\tframeworkService,\r\n\t\t\tdynamicComponentService,\r\n\t\t\tsohoMessageService,\r\n\r\n\t\t);\r\n\t}\r\n\r\n\tonInitComponent(): void {\r\n\t\tsuper.onInitComponent();\r\n\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(this.databearer);\r\n\t}\r\n\r\n\tinitializeBinding(componentDatabearer: IJsonTextBox): void {\r\n\t\tTextboxMetadata.BINDABLE_FIELDS_2.forEach(field => {\r\n\t\t\tconst self: any = this;\r\n\t\t\tconst bindingValue = componentDatabearer[field.ref].value;\r\n\t\t\tself[field.ref] = bindingValue === SubstitutionTags.VALUE ?\r\n\t\t\t\t\"\" : bindingValue;\r\n\t\t});\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.text = \"\";\r\n\t\tthis.input.setValue(this.text);\r\n\t}\r\n\r\n}\r\n","import \"core-js/es7/reflect\";\r\nimport \"zone.js/dist/zone\";\r\n","/*\r\n\tAssets are included during Webpack's bundling process\r\n\r\n\tTODO: Bundle infor-companyon in the same way\r\n*/\r\nimport \"./user-control-es\";\r\n\r\n// Mingle\r\n// MUPS-2682: Convert to Typescript\r\n// tslint:disable-next-line:no-var-requires\r\nrequire(\"./infor-companyon-client\");","// UserControl.js - Web Client version\r\n\r\nMG = (function() {\r\n   var origin, \r\n       parentDomain,\r\n       postMessage,\r\n       isInitialized = false,\r\n       userControlListener,\r\n       userControlListenerScope,\r\n       handleParentMessage,\r\n       getQueryParameter,\r\n       requestId = 1,\r\n       requestCallbacks = {},\r\n       readyHandlers,\r\n       parameters = {};\r\n\r\n   origin = window.location.href.substring(0,window.location.href.indexOf(\"dynamic/metadata\") + \"dynamic/\".length - 1);\r\n\r\n   // parse query parameters\r\n   (function() {\r\n      var query = window.location.search.substring(1),\r\n          parms = query.split('&'),\r\n          val = \"\",\r\n          i, pos, key;\r\n\r\n      for (i = 0; i < parms.length; i++) {\r\n         pos = parms[i].indexOf('=');\r\n         if (pos > 0) {\r\n            key = parms[i].substring(0, pos);\r\n            parameters[key] = parms[i].substring(pos + 1);\r\n         }\r\n      }\r\n   })();\r\n\r\n   /*\r\n    * private handleParentMessage function: receives messages from host form\r\n    */\r\n   handleParentMessage = function (e) {\r\n      if (e && (e.data !== undefined && e.data !== \"\")) {\r\n         if (e.data === \"}}$etParent~\") {  // initial handshake\r\n            var ix, rh;\r\n            parentDomain = e.origin;      // save parent domain\r\n            isInitialized = true;\r\n            if (readyHandlers) {\r\n               for (ix=0; ix < readyHandlers.length; ix++) {\r\n                  rh = readyHandlers[ix];\r\n                  rh.fn.apply(rh.scope);\r\n               }\r\n               readyHandlers = undefined;\r\n            }\r\n         } else {\r\n            var payload = JSON.parse(e.data);\r\n\r\n            if ( payload.requestId ) {\r\n               if ( typeof(requestCallbacks[payload.requestId]) === \"function\" ) {\r\n                  if (payload.success)\r\n                     requestCallbacks[payload.requestId].apply(window, [payload.value]);\r\n                  delete requestCallbacks[payload.requestId];\r\n               }\r\n            } else if ( payload.fireEvent )\r\n               WSForm.fireEvent(payload.fireEvent);\r\n            else if (userControlListener)\r\n               userControlListener.apply(userControlListenerScope || window, [payload]);\r\n         }\r\n      }\r\n   };\r\n\r\n   // configure communication with parent\r\n   if (window.postMessage) {\r\n      if (window.addEventListener)     // ff, safari, opera\r\n         window.addEventListener(\"message\", handleParentMessage, false);\r\n      else if (window.attachEvent)   // ie\r\n         window.attachEvent(\"onmessage\", handleParentMessage);\r\n\r\n      /*\r\n       * private handleParenMessage function (modern browsers)\r\n       * \r\n       * see below for legacy support\r\n       */\r\n      postMessage = function(msg) {\r\n         if (msg && MG.getIsConnected())\r\n            parent.postMessage(msg, parentDomain);\r\n      };\r\n   } else {\r\n      try {\r\n         if (parent.MG) {\r\n            postMessage = function (msg) {\r\n               parent.MG.UserControl.postMessageDirect(msg, window);\r\n            };\r\n         }\r\n      } catch (err) {\r\n         postMessage = function () { alert(\"A user control is not supported by your browser: \" + err.message); };\r\n      }\r\n\r\n      if (!postMessage)\r\n         postMessage = function () { alert(\"A user control is not supported by your browser\"); };\r\n   }\r\n\r\n   return {\r\n\r\n      /*\r\n       * MG.generateServerEvent function - user control events\r\n       */\r\n      generateServerEvent: function(args) {\r\n         var request = { \r\n            cmd: \"gse\", \r\n            args: args \r\n         };\r\n\r\n         MG.sendWebUserControlRequest(request);\r\n      },\r\n\r\n      /*\r\n       * MG.sendWebUserControlRequest function - web user control requests\r\n       */\r\n      sendWebUserControlRequest: function(payload, callback) {\r\n         \r\n         if (typeof(callback) === \"function\") {\r\n            payload.requestId = requestId++;\r\n            requestCallbacks[payload.requestId.toString()] = callback;\r\n         }\r\n\r\n         postMessage(\r\n            JSON.stringify({\r\n               type: 'webuserctrl', \r\n               payload: payload\r\n            })\r\n         );\r\n      },\r\n\r\n      /*\r\n       * MG.getQueryParameter function - parse query parameters\r\n       */\r\n      getQueryParameter: function(name) {\r\n         name = name.replace(/[\\[]/, \"\\\\\\[\").replace(/[\\]]/, \"\\\\\\]\");\r\n         var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\"),\r\n            results = regex.exec(location.search);\r\n         return results == null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\r\n      },\r\n   \r\n      /*\r\n       * MG.onReady function - queue functions to fire when form is ready\r\n       */\r\n      onReady: function(fn, scope) {\r\n         if (typeof(fn) === \"function\") {\r\n            if (isInitialized)\r\n               fn.apply(scope || window);\r\n            else {\r\n               readyHandlers = readyHandlers || [];\r\n               readyHandlers.push({\r\n                  fn: fn,\r\n                  scope: scope || window\r\n               });\r\n            }\r\n         }\r\n      },\r\n\r\n      /*\r\n       * MG.getIsConnected function - true if form communication is initialized\r\n       */\r\n      getIsConnected:   function()  { return isInitialized; },\r\n\r\n      getOrigin: function () { return origin; },\r\n\r\n      getPlatform: function() { return parameters[\"platform\"]; },\r\n\r\n      getTheme: function() { return parameters[\"theme\"]; },\r\n\r\n      getWebClientUrl: function() { return decodeURIComponent( parameters[\"weburl\"] ); },   // really just for smart client\r\n\r\n      getSession: function() { return parameters[\"session\"]; },\r\n\r\n      getConfigName: function() { return parameters[\"config\"]; },\r\n\r\n      Ajax: {\r\n         /*\r\n          * MG.Ajax.get function - execute ajax get request\r\n          */\r\n         get: function(path, cb, onError) {\r\n            var req = new XMLHttpRequest(),\r\n                url;\r\n\r\n            if (path.indexOf(\"?\") === -1)\r\n               url = origin + path + \"?zid=\" + new Date().getTime();\r\n            else\r\n               url = origin + path + \"&zid=\" + new Date().getTime();\r\n\r\n            req.onreadystatechange = function() {\r\n               if (req.readyState === 4) {    // complete\r\n                  req.onreadystatechange = null;\r\n                  if (req.status === 200) {   // success\r\n                     if (typeof(cb) === \"function\")\r\n                        cb(JSON.parse(req.responseText));\r\n                  } else {\r\n                     if (typeof(onError) === \"function\")\r\n                        onError();\r\n                  }\r\n               }\r\n            };\r\n\r\n            req.open(\"GET\", url, true);\r\n            req.send();\r\n         },\r\n\r\n         /*\r\n          * MG.Ajax.post function - execute ajax post request\r\n          */\r\n         post: function(path, payload, cb, onError) {\r\n            var req = new XMLHttpRequest(),\r\n                url = origin + path;\r\n\r\n            req.onreadystatechange = function () {\r\n               if (req.readyState === 4) { // complete\r\n                  req.onreadystatechange = null;\r\n                  if (req.status === 200) { // success\r\n                     if (typeof(cb) === \"function\")\r\n                        cb(JSON.parse(req.responseText));\r\n                  } else {\r\n                     if (typeof(onError) === \"function\")\r\n                        onError();\r\n                  }\r\n               }\r\n            };\r\n\r\n            req.open(\"POST\", url, true);\r\n            req.send(JSON.stringify(payload));\r\n         }\r\n      },\r\n\r\n      UserControl: {\r\n         /*\r\n          * MG.UserControl.registerListener function - register listener for server \r\n          * side assembly messages\r\n          */\r\n         registerListener: function(callback, scope) {\r\n            userControlListener = callback;\r\n            userControlListenerScope = scope;\r\n         },\r\n      }\r\n   }\r\n})();\r\n\r\nWSForm = (function() {\r\n   var subscriptions = {};\r\n\r\n   return {\r\n      UserControl: {\r\n         /*\r\n          * WSForm.UserControl.registerListener function - register listener for server \r\n          * side assembly messages\r\n          */\r\n         registerListener: function(callback, scope) { MG.UserControl.registerListener(callback, scope); },\r\n         \r\n         /*\r\n          * WSForm.UserControl.invoke: call the Invoke method on server-side user control class\r\n          */\r\n         invoke: function(args) { MG.generateServerEvent(args); },\r\n\r\n         /*\r\n          * WSForm.UserControl.getName function - component name for this control\r\n          */\r\n         getName: function() { return MG.getQueryParameter('name'); }\r\n      },\r\n\r\n      /*\r\n       * WSForm.fireEvent function - called by framework to fire subscribed events\r\n       */\r\n      fireEvent: function(eventName) {\r\n         if (typeof(subscriptions[eventName]) === \"function\") {\r\n            subscriptions[eventName](eventName);\r\n         }\r\n      },\r\n\r\n      /*\r\n       * WSForm.getFormId function - get unique form id\r\n       */\r\n      getFormId: function() { return MG.getQueryParameter('formId'); },\r\n\r\n      /*\r\n       * WSForm.getCompValue function - get the value of a form component\r\n       */\r\n      getCompValue: function(name, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"getcomp\", name: name }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.setCompValue function - set the value of a form component\r\n       */\r\n      setCompValue: function(name, value, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"setcomp\", name: name, value: value }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.getVarValue function - get the value of a variable\r\n       */\r\n      getVarValue: function(name, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"getvar\", name: name }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.setVarValue function - set the value of a variable\r\n       */\r\n      setVarValue: function(name, value, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"setvar\", name: name, value: value }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.setPropValue function - get the value of a variable\r\n       */\r\n      getPropValue: function(name, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"getprop\", name: name }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.setPropValue function - set the value of a property\r\n       */\r\n      setPropValue: function(name, value, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"setprop\", name: name, value: value }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.invoke function - invoke a form script method returning success code\r\n       */\r\n      invoke: function(method) {\r\n         var args = [],\r\n             cb;\r\n\r\n         for (var i = 1; i < arguments.length; i++) {\r\n            if (typeof(arguments[i]) === \"function\")\r\n               cb = arguments[i];\r\n            else\r\n               args.push(arguments[i]);\r\n         }\r\n\r\n         MG.sendWebUserControlRequest({ cmd: \"invoke\", name: method, args: args }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.call function - call a form script method with return value\r\n       */\r\n      call: function(method) {\r\n         MG.sendWebUserControlRequest({\r\n            cmd: \"call\",\r\n            name: method.name,\r\n            args: method.parameters\r\n         }, method.onCompleted);\r\n      },\r\n\r\n      /*\r\n       * WSForm.generate function - generate a form event\r\n       */\r\n      generate: function(eventName, cb, async) {\r\n         MG.sendWebUserControlRequest({ cmd: \"generate\", name: eventName, args: (async == true) }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.subscribe function - subscribe to a form event\r\n       */\r\n      subscribe: function(eventName, handler, cb) {\r\n         subscriptions[eventName] = handler;\r\n         MG.sendWebUserControlRequest({ cmd: \"subscribe\", name: eventName }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.getImageSrc function - get a binary property as an image\r\n       */\r\n      getImageSrc: function(propertyName, row, cb) {\r\n         var src = MG.getOrigin() + \"/form/\" + WSForm.getFormId() + \"/getimage/\" + propertyName;\r\n\r\n         if ( row !== undefined )\r\n            src += \"/\" + row.toString();\r\n\r\n         if (typeof(cb) === \"function\")\r\n            cb(src + \"?zid=\" + new Date().getTime());\r\n      }\r\n   };\r\n})();\r\n\r\nWSUserControl = {       // backward compatibility\r\n   generateServerEvent: MG.generateServerEvent,\r\n   registerCallback:    MG.UserControl.registerListener,\r\n   onReady:             MG.onReady\r\n};  \r\n\r\n","// MUPS-2682: Convert to Typescript\r\n\r\nif (typeof infor == \"undefined\") {\r\n\tinfor = {};\r\n}\r\n\r\nif (typeof infor.companyon == \"undefined\") {\r\n\tinfor.companyon = {};\r\n}\r\n\r\ninfor.companyon.client = {};\r\ninfor.companyon.client.listeningMessageTypes = {};\r\ninfor.companyon.client.drillbackSelector = \"a.companyon-drillbacklink\";\r\ninfor.companyon.client.favoritesSelector = \"a.companyon-favoritelink\";\r\nvar MsgType = {\r\n\tContextDimensionChanged: \"contextDimensionChanged\",\r\n};\r\n\r\n/**\r\n * Message Handler for post messages\r\n **/\r\ninfor.companyon.client.messageReceiver = function (e) {\r\n\tinfor.companyon.client.executeMessage(e.data);\r\n};\r\n\r\ninfor.companyon.client.executeMessage = function (msg) {\r\n\tif (msg == null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\ttry {\r\n\t\tmsg = $.parseJSON(msg);\r\n\t} catch (e) {\r\n\t\t// ignore any errors during the parsing of the JSON message and return from the message handler\r\n\t\t// TODO: Once the client side logging is made available to core products, we can use the client side\r\n\t\t// logging to log this message.\r\n\t\treturn;\r\n\t}\r\n\tvar type = msg.type;\r\n\tvar data = msg.data;\r\n\r\n\tif (type == null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar registeredHandlers = infor.companyon.client.listeningMessageTypes[type] || [];\r\n\tvar wildCardHandlers = infor.companyon.client.listeningMessageTypes[\"*\"] || [];\r\n\tvar allHandlers = {};\r\n\t$.extend(allHandlers, registeredHandlers, wildCardHandlers);\r\n\t$.each(allHandlers, function (index, elem) {\r\n\t\tvar registeredHandler = elem.handler;\r\n\t\ttry {\r\n\t\t\tregisteredHandler(data, type);\r\n\t\t} catch (e) {\r\n\t\t\t//ignore any errors during the execution of the handler and continue to the next handler\r\n\t\t}\r\n\t});\r\n\tallHandlers = {};\r\n};\r\n\r\ninfor.companyon.client.sendRelayMessage = function (type, data) {\r\n\t// Send a proxy message to the top window and the message shall inturn be routed back to the\r\n\t// application sharepoint site iframe from the top window\r\n\r\n\tvar proxyMessage = {\r\n\t\ttype: type,\r\n\t\tdata: data,\r\n\t};\r\n\tinfor.companyon.client.sendMessage(\"prepareRelayProxyMessage\", proxyMessage);\r\n};\r\n\r\n/**\r\n *  send a message to the  parent window.\r\n *\r\n */\r\ninfor.companyon.client.sendMessageToParent = function (type, data) {\r\n\tvar message = {\r\n\t\ttype: type,\r\n\t\tdata: data,\r\n\t};\r\n\tvar encodedMessage = JSON.stringify(message);\r\n\r\n\tvar targetWindow = null;\r\n\r\n\tif (window.postMessage != null) {\r\n\t\t// Send a proxy message to the top window and the message shall inturn be routed back to the\r\n\t\t// application sharepoint site iframe from the top window\r\n\t\tvar proxyMessage = {\r\n\t\t\ttype: \"workspaceProxyMessage\",\r\n\t\t\tdata: message,\r\n\t\t};\r\n\t\tvar encodedProxyMessage = JSON.stringify(proxyMessage);\r\n\t\tif (window.parent != window) {\r\n\t\t\twindow.parent.postMessage(encodedProxyMessage, \"*\");\r\n\t\t}\r\n\t\t//window.parent.postMessage(encodedMessage, \"*\");\r\n\t}\r\n};\r\n\r\n/**\r\n *  send a message to the infor app container.\r\n *\r\n */\r\ninfor.companyon.client.sendMessage = function (type, data, target) {\r\n\tvar message = {\r\n\t\ttype: type,\r\n\t\tdata: data,\r\n\t};\r\n\tvar encodedMessage = JSON.stringify(message);\r\n\r\n\tvar targetWindow = null;\r\n\r\n\tif (infor.companyon.containerWindow === true) {\r\n\t\t//client is part of the main window, so use the current window to send the message\r\n\t\t//if ie7, use the companyon function to send the message\r\n\r\n\t\tif (window.postMessage != null) {\r\n\t\t\twindow.postMessage(encodedMessage, \"*\");\r\n\t\t} else {\r\n\t\t\t//workaround for ie7, might be able to call the messagereceiver directly in all cases!\r\n\t\t\tif (typeof infor.companyon.messageReceiver == \"function\") {\r\n\t\t\t\tinfor.companyon.messageReceiver({ data: encodedMessage });\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\t// The below logic was being used for drillbacks in dashboards where we allowed drillbacks from pop-up windows\r\n\t\tif (window.opener != null) {\r\n\t\t\t//cannot call postMessage on opener directly, call a JS function\r\n\t\t\t//http://blogs.msdn.com/b/ieinternals/archive/2009/09/16/bugs-in-ie8-support-for-html5-postmessage-sessionstorage-and-localstorage.aspx\r\n\r\n\t\t\ttry {\r\n\t\t\t\twindow.opener.infor.companyon.client.sendMessageProxy(encodedMessage);\r\n\t\t\t\twindow.opener.focus();\r\n\t\t\t\twindow.opener.document.focus();\r\n\t\t\t} catch (e) {\r\n\t\t\t\t//ignore errors;\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (arguments.length == 3) {\r\n\t\t\tvar encodedProxyMessage = JSON.stringify(message);\r\n\t\t\targuments[2].postMessage(encodedProxyMessage, \"*\");\r\n\t\t} else if (window.postMessage != null) {\r\n\t\t\t// Send a proxy message to the top window and the message shall inturn be routed back to the\r\n\t\t\t// application sharepoint site iframe from the top window\r\n\t\t\tvar proxyMessage = {\r\n\t\t\t\ttype: \"workspaceProxyMessage\",\r\n\t\t\t\tdata: message,\r\n\t\t\t};\r\n\t\t\tvar encodedProxyMessage = JSON.stringify(proxyMessage);\r\n\t\t\tif (window.top != window) {\r\n\t\t\t\twindow.top.postMessage(encodedProxyMessage, \"*\");\r\n\t\t\t}\r\n\t\t\t//window.parent.postMessage(encodedMessage, \"*\");\r\n\t\t} else {\r\n\t\t\t// for IE7\r\n\t\t\t// workaround - if the frame is not there, wait until it is created in the parentpage (usually happens during initValues message)\r\n\r\n\t\t\tfunction testFrameAndSend() {\r\n\t\t\t\tvar frame = window.parent.frames[\"inforCommFrame\"];\r\n\t\t\t\tif (frame != null) {\r\n\t\t\t\t\tframe.sendMessage(encodedMessage, infor.companyon.client.sharePointUrl);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(testFrameAndSend, 100);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttestFrameAndSend();\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * to be called from popup windows, opened from the same domain\r\n */\r\ninfor.companyon.client.sendMessageProxy = function (encodedMessage) {\r\n\tvar messageObject = $.evalJSON(encodedMessage);\r\n\tinfor.companyon.client.sendMessage(messageObject.type, messageObject.data);\r\n};\r\n\r\n/**\r\n * Send \"prepareApplicationDrillback\" message to handle the drillback execution\r\n **/\r\ninfor.companyon.client.sendPrepareDrillbackMessage = function (href) {\r\n\tvar data = {\r\n\t\tlink: href,\r\n\t};\r\n\tinfor.companyon.client.sendMessage(\"prepareApplicationDrillback\", data);\r\n\tinfor.companyon.client.sendMessage(\"syndication.complete\", {});\r\n};\r\n\r\n/**\r\n * Send Height Adjustment message . This is specifically provided in infor-companyon-client to\r\n * deal with different versions.\r\n */\r\n\r\ninfor.companyon.client.adjustHeight = function (height) {\r\n\tinfor.companyon.client.sendMessage(window.name, { height: height + \"px\" });\r\n\tinfor.companyon.client.sendMessage(MsgType.ContextDimensionChanged, {\r\n\t\theight: height,\r\n\t\tiframeName: window.name,\r\n\t});\r\n};\r\n\r\n/**\r\n * Send prepareFavoriteContext to handle the shortcut execution\r\n **/\r\ninfor.companyon.client.sendPrepareFavoritesMessage = function (href) {\r\n\tvar data = {\r\n\t\tlink: href,\r\n\t};\r\n\tinfor.companyon.client.sendMessage(\"prepareFavoriteContext\", data);\r\n};\r\n\r\n//to be called from Silverlight because you cannot call a javascript methods with dots from Silverlight\r\nfunction inforCompanyOnPrepareFavorites(href) {\r\n\tinfor.companyon.client.sendPrepareFavoritesMessage(href);\r\n}\r\n\r\n/**\r\n * Function to retrieve the query string parameter value for a given key from the URL in the current window\r\n **/\r\ninfor.companyon.client.getValueQuerystring = function (key) {\r\n\tvar key = key.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n\tvar regex = new RegExp(\"[\\\\?&]\" + key + \"=([^&#]*)\");\r\n\tvar qs = regex.exec(window.location.href);\r\n\r\n\tvar value = null;\r\n\tif (qs != null) {\r\n\t\tvalue = qs[1];\r\n\t}\r\n\treturn value;\r\n};\r\n\r\n/**\r\n * Function to register a handler for a given message type in a given namespace. The array of\r\n * registered messagetypes is updated and a message (of type workspaceClientSubscribe) is sent to the Workspace.\r\n **/\r\ninfor.companyon.client.registerMessageHandler = function (messageType, handler, namespace) {\r\n\tif (messageType == null || handler == null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar handlers = infor.companyon.client.listeningMessageTypes[messageType] || [];\r\n\r\n\thandlers.push({\r\n\t\thandler: handler,\r\n\t\tnamespace: namespace,\r\n\t});\r\n\r\n\tinfor.companyon.client.listeningMessageTypes[messageType] = handlers;\r\n\r\n\tif (arguments.length == 4) {\r\n\t\tinfor.companyon.client.sendMessageToParent(\"workspaceClientSubscribe\", {\r\n\t\t\tmessageType: messageType,\r\n\t\t\tiframeName: window.name,\r\n\t\t});\r\n\t} else {\r\n\t\t//inform the parent about this message type\r\n\t\tinfor.companyon.client.sendMessage(\"workspaceClientSubscribe\", {\r\n\t\t\tmessageType: messageType,\r\n\t\t\tiframeName: window.name,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n/**\r\n * Function to unregister a handler for a given message type in a given namespace. Currently, we do not\r\n * send a message to Workspace to cleanup the subscription.\r\n **/\r\ninfor.companyon.client.unRegisterMessageHandler = function (messageType, namespace) {\r\n\tif (messageType == null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar handlers = infor.companyon.client.listeningMessageTypes[messageType] || [];\r\n\tvar newHandlers = [];\r\n\t$.each(handlers, function (index, elem) {\r\n\t\tif (elem.namespace != namespace) {\r\n\t\t\tnewHandlers.push(elem);\r\n\t\t}\r\n\t});\r\n\r\n\tinfor.companyon.client.listeningMessageTypes[messageType] = newHandlers;\r\n};\r\n\r\n// bind and unbind were the function names for message handler registration. Hence they are still being\r\n// maintained for backward compatibility.\r\ninfor.companyon.client.bind = infor.companyon.client.registerMessageHandler;\r\ninfor.companyon.client.unbind = infor.companyon.client.unRegisterMessageHandler;\r\n\r\n//// New Function which needs to be called for Environment Information\r\ninfor.companyon.client.getEnvironmentInformation = function (callback) {\r\n\tvar randomNumber = infor.companyon.client.getRandomNumber();\r\n\tvar data = {};\r\n\tdata.MessageId = randomNumber;\r\n\t//// Step 1: Un-register\r\n\tinfor.companyon.client.unRegisterMessageHandler(\"processEnvironmentInformation_\" + randomNumber);\r\n\r\n\t//// Step 2: Register Handler\r\n\tinfor.companyon.client.registerMessageHandler(\r\n\t\t\"processEnvironmentInformation_\" + randomNumber,\r\n\t\tfunction (data) {\r\n\t\t\tcallback(data);\r\n\t\t}\r\n\t);\r\n\r\n\t//// Step 3: sendMessage\r\n\tinfor.companyon.client.sendMessage(\"getEnvironmentInformation\", data);\r\n};\r\n\r\n//// New Function which needs to be called for Entity Information Information\r\ninfor.companyon.client.getEntityInformation = function (data, callback) {\r\n\tvar randomNumber = infor.companyon.client.getRandomNumber();\r\n\tdata.MessageId = randomNumber;\r\n\t//// Step 1: Un-register\r\n\tinfor.companyon.client.unRegisterMessageHandler(\"processEntityInformation_\" + randomNumber);\r\n\r\n\t//// Step 2: Register Handler\r\n\tinfor.companyon.client.registerMessageHandler(\r\n\t\t\"processEntityInformation_\" + randomNumber,\r\n\t\tfunction (data) {\r\n\t\t\tcallback(data);\r\n\t\t}\r\n\t);\r\n\r\n\t//// Step 3: sendMessage\r\n\tinfor.companyon.client.sendMessage(\"getEntityInformation\", data);\r\n};\r\n\r\ninfor.companyon.client.getRandomNumber = function () {\r\n\tvar randomId = \"\" + new Date().getTime() + Math.floor(Math.random() * 10000);\r\n\treturn randomId;\r\n};\r\n\r\ninfor.companyon.client.getInforMingleHomeUrl = function (callback) {\r\n\tvar randomNumber = infor.companyon.client.getRandomNumber();\r\n\tvar data = {};\r\n\tdata.MessageId = randomNumber;\r\n\t//// Step 1: Un-register\r\n\tinfor.companyon.client.unRegisterMessageHandler(\"processInforMingleHomeUrl_\" + randomNumber);\r\n\r\n\t//// Step 2: Register Handler\r\n\tinfor.companyon.client.registerMessageHandler(\r\n\t\t\"processInforMingleHomeUrl_\" + randomNumber,\r\n\t\tfunction (data) {\r\n\t\t\tcallback(data);\r\n\t\t}\r\n\t);\r\n\r\n\t//// Step 3: sendMessage\r\n\tinfor.companyon.client.sendMessage(\"getInforMingleHomeUrl\", data);\r\n};\r\n\r\ninfor.companyon.client.relayMessage = function (data) {\r\n\tinfor.companyon.client.executeMessage(JSON.stringify(data));\r\n\tvar frames = $(\"iframe\");\r\n\r\n\tfor (var ct = 0; ct < frames.length; ct++) {\r\n\t\t//var target = frames[ct].get(0).contentWindow;\r\n\t\tvar fr = $('iframe[name=\"' + $(frames[ct]).attr(\"name\") + '\"]');\r\n\t\tinfor.companyon.client.sendMessage(\"relayFrameMessage\", data, fr.get(0).contentWindow);\r\n\t}\r\n};\r\n\r\n$(function () {\r\n\t//Don't do anything if an app iframe is already present. This is only needed for SharePoint based applications\r\n\tif (infor.companyon.iframeId != null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (window.postMessage != null) {\r\n\t\tif (window.attachEvent) {\r\n\t\t\twindow.attachEvent(\"onmessage\", infor.companyon.client.messageReceiver);\r\n\t\t} else if (window.addEventListener) {\r\n\t\t\twindow.addEventListener(\"message\", infor.companyon.client.messageReceiver, false);\r\n\t\t}\r\n\t}\r\n\r\n\t// drillback click handler\r\n\r\n\tif (\"undefined\" === typeof $(\"body\").live) {\r\n\t\t$(\"body\").on(\r\n\t\t\t{\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tvar href = $(this).attr(\"href\");\r\n\t\t\t\t\t// infor.companyon.client.sendPrepareDrillbackMessage(href);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tinfor.companyon.client.drillbackSelector\r\n\t\t);\r\n\r\n\t\t$(\"body\").on(\r\n\t\t\t{\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tvar href = $(this).attr(\"href\");\r\n\t\t\t\t\t//infor.companyon.client.sendPrepareFavoritesMessage(href);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tinfor.companyon.client.favoritesSelector\r\n\t\t);\r\n\t} else if (\"function\" === typeof $(infor.companyon.client.drillbackSelector).live) {\r\n\t\t$(infor.companyon.client.drillbackSelector).live(\"click\", function (event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tvar href = $(this).attr(\"href\");\r\n\t\t\tinfor.companyon.client.sendPrepareDrillbackMessage(href);\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\t$(infor.companyon.client.favoritesSelector).live(\"click\", function (event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tvar href = $(this).attr(\"href\");\r\n\t\t\tinfor.companyon.client.sendPrepareFavoritesMessage(href);\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\r\n\t// shortcut/favorite click handler\r\n\r\n\t//no need to send initclient when in a popup\r\n\tif (window.opener == null) {\r\n\t\t// Once this message is received by Workspace, it is assumed that the application is ready for receiving messages\r\n\t\tinfor.companyon.client.sendMessage(\"initClient\", window.name);\r\n\t}\r\n\tinfor.companyon.client.registerMessageHandler(\r\n\t\t\"relayFrameMessage\",\r\n\t\tinfor.companyon.client.relayMessage\r\n\t);\r\n});\r\n","import { NgModuleRef, NgZone } from \"@angular/core\";\r\nimport { platformBrowserDynamic } from \"@angular/platform-browser-dynamic\";\r\nimport { UrlService } from \"@uirouter/core\";\r\n\r\nlet ng1Import;\r\nlet ng2Import;\r\n\r\nif (APP_BUILDER) {\r\n\tng1Import = import(\"./appbuilder/app\")\r\n\t\t.then(module => module.appBuilder);\r\n\r\n\tng2Import = import(\"./app-builder/app.module\")\r\n\t\t.then(module => module.RootModule);\r\n\r\n} else if (APP_HUB) {\r\n\tng1Import = import(\"./appruntime/app\")\r\n\t\t.then(module => module.runtimeApp);\r\n\r\n\tng2Import = import(\"./app-hub/app.module\")\r\n\t\t.then(module => module.RootModule);\r\n\r\n}\r\n\r\nng1Import.then(ng1RootModule => {\r\n\t// Using AngularJS config block, call `deferIntercept()`.\r\n\t// This tells UI-Router to delay the initial URL sync (until all bootstrapping is complete)\r\n\tng1RootModule.config([\r\n\t\t\"$urlServiceProvider\",\r\n\t\t($urlService: UrlService) => $urlService.deferIntercept(),\r\n\t]);\r\n});\r\n\r\nng2Import.then(ng2RootModule => {\r\n\tplatformBrowserDynamic()\r\n\t\t.bootstrapModule(ng2RootModule)\r\n\t\t.then((platformRef: NgModuleRef<any>) => {\r\n\t\t\t// Intialize the Angular Module\r\n\t\t\t// get() the UIRouter instance from DI to initialize the router\r\n\t\t\tconst urlService: UrlService = platformRef.injector.get(UrlService);\r\n\r\n\t\t\t// Instruct UIRouter to listen to URL changes\r\n\t\t\tconst startUIRouter = () => {\r\n\t\t\t\turlService.listen();\r\n\t\t\t\turlService.sync();\r\n\t\t\t};\r\n\r\n\t\t\tconst ngZone = platformRef.injector.get<NgZone>(NgZone);\r\n\t\t\tngZone.run(startUIRouter);\r\n\t\t});\r\n});\r\n","export abstract class StateNames {\r\n\tpublic static readonly APP_LAUNCHER = \"ng2AppLauncher\";\r\n}","import { HttpClient } from \"@angular/common/http\";\r\nimport { query, value } from \"jsonpath\";\r\nimport isArray from \"lodash-es/isArray\";\r\nimport { Observable, throwError } from \"rxjs\";\r\nimport { map } from \"rxjs/internal/operators/map\";\r\n\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\n\r\nimport type {\r\n\tIHttpHeader,\r\n\tIJsonDatasource,\r\n\tIJsonGenericDatasource2\r\n} from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IComponent } from \"ng2/common/model/components/base/component.model\";\r\nimport type { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport type { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\nimport type { IIonApiCall } from \"ng2/common/model/ion-api/ion-api.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { DataServiceHelper } from \"ng2/common/helpers/data-service.helper\";\r\nimport { JsonHelper } from \"ng2/common/helpers/json.helper\";\r\nimport { DataService } from \"ng2/common/project/data-service/base-data-service\";\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\n\r\nexport class Generic extends DataService {\r\n\r\n\tusedBy: IComponent[];\r\n\r\n\ttypedef?: DatasourceTypeEnum;\r\n\tversion?: number;\r\n\tid?: string;\r\n\tdisplayName?: string;\r\n\tdescription?: string;\r\n\tauthor?: string;\r\n\tauthorDisplayName?: string;\r\n\tcreationDate?: number;\r\n\tchangedBy?: string;\r\n\tchangedByDisplayName?: string;\r\n\tchangedDate?: number;\r\n\theaders?: IHttpHeader;\r\n\r\n\tconstructor(\r\n\t\thttp: HttpClient,\r\n\t\tdynamicComponentService: DynamicComponentService,\r\n\t\tobj: IJsonDatasource,\r\n\t) {\r\n\r\n\t\tsuper(\r\n\t\t\thttp,\r\n\t\t\tdynamicComponentService,\r\n\t\t\tobj,\r\n\t\t);\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonDatasource {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\t// TODO: Look into why getDetailData is needed.\r\n\tgetDetailData(interactionParameters: IInteractionParameter[]): Observable<any> {\r\n\r\n\t\tconst parameters = this.readParameters(interactionParameters);\r\n\t\tconst databearer = this.databearer as IJsonGenericDatasource2;\r\n\r\n\t\tconst requestBody: any = undefined;\r\n\t\tconst url = `${databearer.suite}${databearer.endpoint}${databearer.resource}`;\r\n\t\tconst substituedUrl = this.setSubstitutionTags(url, requestBody, parameters);\r\n\r\n\t\treturn this\r\n\t\t\t.ionApiRequest(substituedUrl, parameters)\r\n\t\t\t.pipe(\r\n\t\t\t\tmap(data => {\r\n\r\n\t\t\t\t\tconst list: IListDataItem[] = [];\r\n\r\n\t\t\t\t\tquery(data, databearer.outputRootElement)\r\n\t\t\t\t\t\t.forEach((row) => {\r\n\t\t\t\t\t\t\tconst listObject: IListDataItem = {};\r\n\t\t\t\t\t\t\tdatabearer.outputParameters.forEach((param) => {\r\n\t\t\t\t\t\t\t\tlistObject[param.id] = value(row, \"$.\" + param.key);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (databearer.objectIdPath) {\r\n\t\t\t\t\t\t\t\tlistObject.id = value(row, \"$.\" + databearer.objectIdPath); //setting the id on the item\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlist.push(listObject);\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn list;\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t}\r\n\r\n\tgetListData(interactionParameters: IInteractionParameter[]): Observable<any[]> {\r\n\r\n\t\ttry {\r\n\t\t\tconst parameters = this.readParameters(interactionParameters);\r\n\t\t\tconst databearer = this.databearer as IJsonGenericDatasource2;\r\n\t\t\tconst extraParameters: IMap<any> = {};\r\n\r\n\t\t\tconst requestBody: any = undefined;\r\n\t\t\tconst url = `${databearer.suite}${databearer.endpoint}${databearer.resource}`;\r\n\r\n\t\t\tdatabearer.inputParameters.forEach((ionapiParameter) => {\r\n\t\t\t\tconst inputparameter = parameters[ionapiParameter.id];\r\n\t\t\t\tif (inputparameter && isArray(inputparameter)) { // if multiple parameters\r\n\t\t\t\t\tinputparameter.forEach((parameter, index) => {\r\n\t\t\t\t\t\tif (!parameters[index]) {\r\n\t\t\t\t\t\t\tparameters.push({});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparameters[index][ionapiParameter.id] = parameter;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (inputparameter) {\r\n\t\t\t\t\textraParameters[ionapiParameter.id] = inputparameter;\r\n\t\t\t\t\tif (parameters.length === 1) {\r\n\t\t\t\t\t\tparameters[0] = parameters;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// do something with substitution parameters in url\r\n\t\t\tconst substituedUrl = this.setSubstitutionTags(url, requestBody, parameters);\r\n\r\n\t\t\treturn this\r\n\t\t\t\t.ionApiRequest(substituedUrl, parameters)\r\n\t\t\t\t.pipe(\r\n\t\t\t\t\tmap(data => {\r\n\r\n\t\t\t\t\t\tconst list: IListDataItem[] = [];\r\n\r\n\t\t\t\t\t\tquery(data, databearer.outputRootElement)\r\n\t\t\t\t\t\t\t.forEach((row) => {\r\n\t\t\t\t\t\t\t\tconst listObject: IListDataItem = {};\r\n\t\t\t\t\t\t\t\tdatabearer.outputParameters.forEach((param) => {\r\n\t\t\t\t\t\t\t\t\tlistObject[param.id] = value(row, \"$.\" + param.key).trim();\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tif (databearer.objectIdPath) {\r\n\t\t\t\t\t\t\t\t\tlistObject.id = value(row, \"$.\" + databearer.objectIdPath); //setting the id on the item\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tlist.push(listObject);\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\treturn list;\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t} catch (error) {\r\n\t\t\treturn throwError(error);\r\n\t\t}\r\n\t}\r\n\r\n\t// public getMetaData(): Promise<IMetaData>;\r\n\r\n\t// public getNonParsedData(params: IMap<any>): Promise<any[]>;\r\n\r\n\tprivate setSubstitutionTags(url: string, bodyParameter: string, parameters: IMap<any>): IIonApiCall {\r\n\t\tlet value: any;\r\n\t\tlet substitutionTag: string;\r\n\r\n\t\tconst bodyParameterJson = bodyParameter ? JSON.parse(bodyParameter) : \"\";\r\n\t\tconst databearer = this.databearer as IJsonGenericDatasource2;\r\n\r\n\t\tdatabearer.inputParameters.forEach((datasourceParameter) => {\r\n\t\t\tvalue = parameters[datasourceParameter.id];\r\n\t\t\tswitch (datasourceParameter.parameterType) {\r\n\t\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\t\tsubstitutionTag = DataServiceHelper.getURLVariable(datasourceParameter.key);\r\n\t\t\t\t\tif (url.indexOf(substitutionTag) !== -1) {\r\n\t\t\t\t\t\tif (value !== null && value !== undefined && value !== \"\") { // Exclude all false cases except 0\r\n\t\t\t\t\t\t\turl = url.replace(substitutionTag, encodeURIComponent(value));\r\n\t\t\t\t\t\t} else if (datasourceParameter.required) { // If required throw error\r\n\t\t\t\t\t\t\tthrow Error(\"Parameter is required\");\r\n\t\t\t\t\t\t} else { // Null, undefined or \"\", remove substitution tags\r\n\t\t\t\t\t\t\tif (datasourceParameter.parameterType === ParameterTypeEnum.MATRIX) { // Matrix\r\n\t\t\t\t\t\t\t\tconst strToReplace = \";\" + DataServiceHelper\r\n\t\t\t\t\t\t\t\t\t.getURLVariable(datasourceParameter.key, ParameterTypeEnum.MATRIX);\r\n\t\t\t\t\t\t\t\turl = url.replace(strToReplace, \"\");\r\n\t\t\t\t\t\t\t} else { // Query\r\n\t\t\t\t\t\t\t\tconst fullSubstitutionTag =\r\n\t\t\t\t\t\t\t\t\tDataServiceHelper.getURLVariable(datasourceParameter.key, ParameterTypeEnum.QUERY);\r\n\t\t\t\t\t\t\t\turl = url.replace(fullSubstitutionTag, \"\");\r\n\t\t\t\t\t\t\t\turl = url.replace(\"?&\", \"?\");\r\n\t\t\t\t\t\t\t\turl = url.replace(\"&&\", \"&\");\r\n\r\n\t\t\t\t\t\t\t\t// Rm if there is a & at the end.\r\n\t\t\t\t\t\t\t\t// E.g: LstItmByItmGr?ITGR=004&\r\n\t\t\t\t\t\t\t\tif (url.charAt(url.length - 1) === \"&\") {\r\n\t\t\t\t\t\t\t\t\turl = url.substr(0, url.length - 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow Error(\"Substitution tag does not exist!\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ParameterTypeEnum.BODY_PART: {\r\n\t\t\t\t\tconst schema = JsonHelper.generateSchema(bodyParameterJson);\r\n\t\t\t\t\tconst propertyType = JsonHelper.getPropertyType(schema, datasourceParameter.key);\r\n\t\t\t\t\tswitch (propertyType) {\r\n\t\t\t\t\t\tcase \"number\":\r\n\t\t\t\t\t\t\tvalue = parseFloat(value);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"string\":\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalue(bodyParameterJson, datasourceParameter.key, value);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t// Invalid inparameter type\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn {\r\n\t\t\trelativeUrl: url,\r\n\t\t\trequestBody: JSON.stringify(bodyParameterJson)\r\n\t\t};\r\n\t}\r\n\r\n\tprivate readParameters(\r\n\t\tparameters: IInteractionParameter[],\r\n\t): IMap<any> {\r\n\r\n\t\tconst interactionParameters: IMap<any> = {};\r\n\r\n\t\tparameters.forEach(parameter => {\r\n\r\n\t\t\tconst sourceComponentId = parameter.valueSource.sourceName;\r\n\t\t\tconst sourceComponentKey = parameter.valueSource.sourceKey;\r\n\r\n\t\t\t// TODO: Static values not handled yet e.g. RIGHTTRIM\r\n\t\t\tif (sourceComponentKey) {\r\n\t\t\t\tconst sourceComponentInstance = this.dynamicComponentService.componentRefs\r\n\t\t\t\t\t.find(componentRef => componentRef.instance.id === sourceComponentId)\r\n\t\t\t\t\t.instance;\r\n\r\n\t\t\t\tconst sourceComponentValue = sourceComponentInstance[sourceComponentKey];\r\n\t\t\t\tinteractionParameters[parameter.targetKey] = sourceComponentValue.trim();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn interactionParameters;\r\n\t}\r\n}\r\n","import { HttpClient } from \"@angular/common/http\";\r\nimport { Observable } from \"rxjs/internal/Observable\";\r\n\r\nimport { Config, DeveloperConstants } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonDatasource, IHttpHeader } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IDataService } from \"ng2/common/model/dataservice/data-service.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport type { IComponent } from \"ng2/common/model/components/base/component.model\";\r\nimport type { IIonApiCall } from \"ng2/common/model/ion-api/ion-api.model\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\n\r\nexport abstract class DataService implements IDataService {\r\n\r\n\tprivate isDevelopment: boolean;\r\n\tprivate ionapiToken: string;\r\n\r\n\tconstructor(\r\n\t\tprotected http: HttpClient,\r\n\t\tprotected dynamicComponentService: DynamicComponentService,\r\n\t\tobj: IJsonDatasource,\r\n\t) {\r\n\r\n\t\tthis.databearer = obj;\r\n\t\tthis.initService();\r\n\t}\r\n\r\n\tdatabearer: IJsonDatasource;\r\n\r\n\tusedBy: IComponent[];\r\n\ttypedef?: DatasourceTypeEnum;\r\n\tversion?: number;\r\n\tid?: string;\r\n\tdisplayName?: string;\r\n\tdescription?: string;\r\n\tauthor?: string;\r\n\tauthorDisplayName?: string;\r\n\tcreationDate?: number;\r\n\tchangedBy?: string;\r\n\tchangedByDisplayName?: string;\r\n\tchangedDate?: number;\r\n\theaders?: IHttpHeader;\r\n\r\n\tabstract getDatabearer(): IJsonDatasource;\r\n\tabstract getDetailData(params: IMap<any>): Observable<any>;\r\n\tabstract getListData(params?: IMap<any>): Observable<any[]>;\r\n\r\n\tprivate initService(): void {\r\n\t\tthis.isDevelopment =\r\n\t\t\tConfig.IS_DEV && localStorage.getItem(DeveloperConstants.ION_PROXY) === \"true\";\r\n\t}\r\n\r\n\tionApiRequest(ionapiCall: IIonApiCall, parameters: IMap<any>): Observable<any> {\r\n\r\n\t\t/* FIXME:\r\n\t\t\tConfig.ION_API_URL, and Config.TENANT_ID comes from Mongoose\r\n\t\t\tand should be changed in the final version */\r\n\t\tconst url = this.isDevelopment ?\r\n\t\t\t`http://localhost:8083/infor${ionapiCall.relativeUrl}` :\r\n\t\t\t`${Config.ION_API_URL}/${Config.TENANT_ID}${ionapiCall.relativeUrl}`;\r\n\r\n\t\tconst headers: IMap<string> = {\r\n\t\t\tAccept: \"application/json\",\r\n\t\t\tAuthorization: `Bearer ${Config.ION_API_TOKEN}`\r\n\t\t};\r\n\r\n\t\treturn this.http\r\n\t\t\t.get(url, {\r\n\t\t\t\theaders\r\n\t\t\t});\r\n\t}\r\n}","import { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport interface IJsonCustomComponentDefinition {\r\n\tid: string;\r\n\tdisplayName: string;\r\n\r\n\tinit?: string;\r\n\tloadInteraction?: string;\r\n\thtmlTemplate?: string;\r\n\tbindableFields?: IJsonBindableField[];\r\n\ttargetActions?: string[];\r\n\tsourceTriggers?: string[];\r\n}\r\n","// Module\nvar code = \"<div> <button type=button class=btn-{{componentInstance.style}} ng-click=componentInstance.click() ng-disabled=componentInstance.isReadonly> {{componentInstance.content}} </button> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=chart> <div class=widget-header ng-if=componentInstance.showLabel> <h2 eir-component-value content=componentInstance.title class=widget-title></h2> </div> <div class=widget-content> <div id=chart-{{::component.id}} class=chart-container></div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=field> <input id=checkbox-{{::component.id}} type=checkbox class=checkbox ng-model=componentInstance.checkboxState ng-disabled=componentInstance.isReadonly ng-click=componentInstance.checked()> <label for=checkbox-{{::component.id}} class=checkbox-label>{{componentInstance.content}}</label> </div>\";\n// Exports\nmodule.exports = code;","import { DateFormatEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nexport class LocaleHelper {\r\n\tstatic getDateFormat(\r\n\t\tformat: string,\r\n\t\tlocale?: string\r\n\t): string {\r\n\t\tif (Helper.isUndefined(locale)) {\r\n\t\t\tlocale = Soho.Locale.currentLocale.name;\r\n\t\t}\r\n\t\tconst localeName = Soho.Locale.cultures[locale];\r\n\t\tconst calendar = localeName.calendars[0];\r\n\r\n\t\tif (format === DateFormatEnum.Timeformat) {\r\n\t\t\treturn calendar.timeFormat;\r\n\t\t}\r\n\t\treturn calendar.dateFormat[format];\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=datagrid-export-content ng-controller=\\\"eirDatagridExportDialogCtrl as ctrl\\\"> <div class=field> <label class=required for=export-name>Name</label> <input type=text id=export-name name=export-name ng-model=ctrl.exportName> </div> <fieldset class=radio-group> <legend>Type</legend> <input type=radio class=radio name=options id=exportExcel value=excel ng-model=ctrl.exportType /> <label for=exportExcel class=radio-label>Excel</label> <br> <input type=radio class=radio name=options id=exportCsv value=csv ng-model=ctrl.exportType /> <label for=exportCsv class=radio-label>Csv</label> </fieldset> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-click=ctrl.export() ng-disabled=\\\"!ctrl.exportName.length > 0\\\">Export</button> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=ab-datagrid-wrapper> <div class=toolbar role=toolbar ng-hide=!componentInstance.showLabel xi-control=toolbar> <div class=title> <h2 eir-component-value content=componentInstance.label></h2> <span class=datagrid-result-count ng-hide=!componentInstance.rowCount>(N Results)</span> </div> <div class=buttonset> <div class=\\\"searchfield-wrapper toolbar-searchfield-wrapper\\\" ng-hide=!componentInstance.filterBar> <label class=audible for=searchfield-datagrid-{{::component.id}}>Keyword Search</label> <input id=searchfield-datagrid-{{::component.id}} name=searchfield-datagrid-{{::component.id}} class=searchfield data-options=\\\"{ collapsible: true }\\\"/> </div> </div> <button type=button class=btn id=export ng-click=componentInstance.export() ng-if=componentInstance.enableExport> <svg class=icon focusable=false aria-hidden=true role=presentation> <use href=#icon-export-spreadsheet></use> </svg> <span>Export</span> </button> </div> <div id=datagrid-{{::component.id}} ng-if=componentInstance.showDatagrid xi-datagrid=componentInstance.datagridOptions /> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=field> <label for=date-field-{{component.id}} class=label ng-show=componentInstance.showLabel eir-component-value content=componentInstance.label> </label> <input id=date-field-{{component.id}} class=datepicker type=text data-disable-validation=true xi-datepicker=componentInstance.datepickerOptions /> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"dropdown-container {{componentInstance.boxWidth}}\\\"> <label ng-attr-for=\\\"{{::component.id + 'select'}}\\\" ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label></label> <select ng-attr-id=\\\"{{::component.id + 'select'}}\\\" class=dropdown ng-model=componentInstance.currentItemIndex ng-disabled=componentInstance.isReadonly ng-options=\\\"context.ListResult.indexOf(value) as value[component.displayValue.sourceKey] for value in context.ListResult\\\" ng-change=componentInstance.setCurrentItem(context.ListResult[componentInstance.currentItemIndex]) xi-drop-down></select> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=childCage ng-class=\\\"{ 'vertical': componentInstance.orientation === 2, 'flex-parent': componentInstance.isFlexParent}\\\" ng-style=componentInstance.styleOptions> <eir-children class={{componentInstance.childrenClasses}} parent=componentInstance children-ready=onChildrenReady()> </eir-children> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div> <a class=\\\"hyperlink {{componentInstance.direction}} hide-focus\\\" ng-click=componentInstance.onLinkClick() ng-disabled=componentInstance.isReadonly> <svg role=presentation aria-hidden=true focusable=false class=icon ng-if=\\\"componentInstance.direction == 'back'\\\"> <use xlink:href=#icon-caret-left /> </svg> <span class=hyperlink-content eir-component-value content=componentInstance.content></span> <svg role=presentation aria-hidden=true focusable=false class=icon ng-if=\\\"componentInstance.direction == 'directional'\\\"> <use xlink:href=#icon-caret-right /> </svg> </a> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"image img-{{component.position}}\\\" ng-if=componentInstance.source ng-style=\\\"{'background-image':'url('+componentInstance.source+')'}\\\" ng-click=componentInstance.click()> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=label-container> <span class=\\\"label {{componentInstance.fontChar}}\\\" xi-tooltip=componentInstance.toolTip ng-class=componentInstance.fontStyle ng-style=\\\"{ color: componentInstance.color }\\\" eir-component-value content=componentInstance.content> </span> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=card> <div class=card-header> <h2 class=card-title eir-component-value content=componentInstance.label> </h2> </div> <div class=card-content> <div class=listview-search ng-if=componentInstance.search> <span class=searchfield-wrapper> <input class=searchfield placeholder=Search name=list-search id=list-search autocomplete=off ng-model=componentInstance.filterValue ng-change=componentInstance.refresh()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use href=#icon-search></use> </svg> </span> </div> <div class=listview id=list-{{::component.id}} eir-infinite-scroll=componentInstance.loadMore(scrollingDown) eir-infinite-scroll-enabled=componentInstance.infiniteScrollEnabled> <ul> <li ng-repeat=\\\"child in componentInstance.childrenDatabearers\\\" ng-init=\\\"childContext=componentInstance.getChildContext(child.generatedId);\\\" ng-click=componentInstance.setCurrentItem(child.generatedId);$event.stopPropagation() ng-class=\\\"{ 'is-selected': componentInstance.selectedGeneratedId === child.generatedId }\\\"> <eir-component-directive component=child parent=componentInstance context=childContext typedef=Flexbox component-ready=\\\"componentInstance.parent.onComponentReady(componentInstance, child.generatedId)\\\"> </eir-component-directive> </li> </ul> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"field {{componentInstance.boxWidth}}\\\"> <label for={{::component.id}} ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label> </label> <input class=lookup id={{::component.id}} name={{::component.id}} ng-model=componentInstance.text ng-readonly=componentInstance.isReadonly ng-change=componentInstance.onUpdateValue() xi-lookup=componentInstance.lookupOptions /> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div> <fieldset class=radio-group> <label ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label></label> <div ng-repeat=\\\"radio in componentInstance.radioButtons track by radio.id\\\" class=radio-button-group> <input type=radio class=radio ng-model=componentInstance.selectedRadioButtonId ng-disabled=componentInstance.isReadonly id={{radio.id}} ng-change=componentInstance.setCurrentItem(radio) value={{radio.id}} /> <label for={{radio.id}} class=radio-label>{{radio.value ? radio.value : radio.name}}</label> </div> </fieldset> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=tab-wrapper ng-class=\\\"{'horizontal': componentInstance.orientation === 1, 'page-container no-scroll': componentInstance.orientation === 2}\\\"> <div id=tabs class=tab-container ng-class=\\\"{'horizontal': componentInstance.orientation === 1, 'vertical no-scroll': componentInstance.orientation === 2}\\\"> <ul class=tab-list> <li class=tab ng-repeat=\\\"tabObject in ::componentInstance.componentTabs track by tabObject.id\\\"> <a href=\\\"{{'#' + tabObject.id}}\\\" id=\\\"{{'atag-' + tabObject.id}}\\\"> {{tabObject.value ? tabObject.value : tabObject.name}} </a> </li> </ul> <div id=vertical-tab class=\\\"tab-panel-container scrollable-y\\\" ng-if=\\\"componentInstance.orientation === 2\\\"> <div id={{tabChild.id}} class=tab-panel ng-repeat=\\\"tabChild in ::componentInstance.childrenDatabearers track by tabChild.id\\\"> <eir-component-directive component=tabChild context=context parent=componentInstance typedef=TabPanel component-ready=componentInstance.parent.onComponentReady(componentInstance)> </eir-component-directive> </div> </div> </div> <div id=horizontal-tab class=tab-panel-container ng-if=\\\"componentInstance.orientation === 1\\\"> <div id={{tabChild.id}} class=tab-panel ng-repeat=\\\"tabChild in ::componentInstance.childrenDatabearers track by tabChild.id\\\"> <eir-component-directive component=tabChild context=context parent=componentInstance typedef=TabPanel component-ready=componentInstance.parent.onComponentReady(componentInstance)> </eir-component-directive> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"childCage tabPanelChildCage\\\" ng-class=\\\"{ 'vertical': componentInstance.orientation === 2, 'flex-parent': componentInstance.isFlexParent}\\\" ng-style=componentInstance.styleOptions> <eir-children class={{componentInstance.childrenClasses}} parent=componentInstance children-ready=onChildrenReady()> </eir-children> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=field> <label for={{::component.id}} ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label> </label> <textarea class=textarea ng-class=\\\"{'resizable': componentInstance.resizable}\\\" ng-readonly=componentInstance.isReadonly ng-model=componentInstance.text ng-change=componentInstance.onUpdateValue() ng-attr-maxlength={{componentInstance.maxLength}} ng-attr-placeholder={{componentInstance.placeholder}} xi-textarea=componentInstance.textareaOptions>\\r\\n\\t</textarea> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=field> <label for={{::component.id}} ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label></label> <input type={{componentInstance.editType}} id={{::component.id}} name={{::component.id}} class={{componentInstance.boxWidth}} eir-component-value content=componentInstance.text ng-model=componentInstance.text ng-change=componentInstance.onUpdateValue() ng-readonly=componentInstance.isReadonly placeholder={{componentInstance.placeholder}} ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\" maxlength={{componentInstance.maxLength}} /> <div ng-if=componentInstance.lengthWarning> <svg class=icon focusable=false aria-hidden=true role=presentation> <use href=#icon-alert></use> </svg> <span class=audible>Warning</span> <span class=warning-text>Maximum of 2000 characters reached.</span> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=field> <label for=time-field-{{component.id}} class=label ng-show=componentInstance.showLabel eir-component-value content=componentInstance.label> </label> <input id=time-field-{{component.id}} class=timepicker type=text data-validate=time xi-timepicker=componentInstance.timepickerOptions> </div>\";\n// Exports\nmodule.exports = code;","import type { IJsonTabComponent } from \"common/model/component/tabs.model\";\r\nimport { IComponent } from \"common/IComponent\";\r\n\r\nexport interface ITabsComponent extends IComponent {\r\n\tcomponentTabs: IJsonTabComponent[];\r\n}","\r\n/**\r\n* HTTP utility functions.\r\n*/\r\nexport class HttpUtil {\r\n\r\n\tpublic static combine(url1: string, url2: string): string {\r\n\t\tif (!url1) {\r\n\t\t\treturn url2;\r\n\t\t}\r\n\t\tif (!url2) {\r\n\t\t\treturn url1;\r\n\t\t}\r\n\t\tconst end = url1.length - 1;\r\n\t\tif (url1.charAt(end) === \"/\") {\r\n\t\t\turl1 = url1.substring(0, end);\r\n\t\t}\r\n\t\tif (url2.charAt(0) === \"/\") {\r\n\t\t\turl2 = url2.substring(1);\r\n\t\t}\r\n\t\treturn url1 + \"/\" + url2;\r\n\t}\r\n}\r\n","import { IJsonInlineListDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport { DatasourceService } from \"../../../components/services/datasource-service\";\r\nimport { Datasource } from \"./datasource\";\r\n\r\nexport class InlineList extends Datasource {\r\n\tprotected databearer: IJsonInlineListDatasource;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonInlineListDatasource,\r\n\t\tprivate datasourceService: DatasourceService\r\n\t) {\r\n\t\tsuper(obj);\r\n\t}\r\n\r\n\tpublic getDetailData(): Promise<any> {\r\n\t\treturn this.loadData().then(result => result[0]);\r\n\t}\r\n\r\n\tpublic getNonParsedData(): Promise<any[]> {\r\n\t\tconst defer = this.datasourceService.$q.defer<any>();\r\n\t\tconst output = this.databearer.dataset.map(entry => {\r\n\t\t\tconst newEntry: IListDataItem = {};\r\n\t\t\tthis.databearer.outputParameters.forEach(parameter => {\r\n\t\t\t\tnewEntry[parameter.key] = entry[parameter.field];\r\n\t\t\t});\r\n\t\t\treturn newEntry;\r\n\t\t});\r\n\t\tdefer.resolve(output);\r\n\t\treturn defer.promise as Promise<any>;\r\n\t}\r\n\r\n\tpublic getListData(): Promise<any> {\r\n\t\treturn this.loadData()\r\n\t\t\t.then((result) => {\r\n\t\t\t\treturn result;\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate loadData(): Promise<any> {\r\n\t\tconst defer = this.datasourceService.$q.defer<any>();\r\n\t\tdefer.resolve(this.databearer.dataset);\r\n\t\treturn defer.promise as Promise<any>;\r\n\t}\r\n\r\n\tpublic getMetaData(): Promise<IMetaData> {\r\n\t\tconst deferredMetaData: ng.IDeferred<any> = this.datasourceService.getDeferred();\r\n\t\tconst outputFields: IMetaDataField[] = [];\r\n\t\tthis.databearer.outputParameters.forEach((param) => {\r\n\t\t\toutputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.key,\r\n\t\t\t\tMAND: \"0\",\r\n\t\t\t\ttype: \"string\"\r\n\t\t\t});\r\n\t\t});\r\n\t\tdeferredMetaData.resolve({\r\n\t\t\tinputFields: [],\r\n\t\t\toutputFields: outputFields\r\n\t\t});\r\n\t\treturn deferredMetaData.promise as Promise<any>;\r\n\t}\r\n}\r\n","import type { IPromise } from \"angular\";\r\nimport isArray from \"lodash-es/isArray\";\r\n\r\nimport { IdoProperties } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonGenericDatasource2, IJsonLocalIdoDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport type { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport type { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { ErrorResponse } from \"common/error-response\";\r\nimport { Datasource } from \"common/project/datasource/datasource\";\r\nimport { DatasourceService } from \"components/services/datasource-service\";\r\n\r\nexport class LocalIdo extends Datasource {\r\n\r\n\tprotected databearer: IJsonLocalIdoDatasource;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonGenericDatasource2,\r\n\t\tprivate datasourceService: DatasourceService\r\n\t) {\r\n\t\tsuper(obj);\r\n\t}\r\n\r\n\tpublic getDetailData(inputParameterValues: IMap<any>): Promise<any> {\r\n\t\treturn this.loadData(inputParameterValues)\r\n\t\t\t.then(result => Array.isArray(result[0]) ? result[0] : [result[0]])\r\n\t\t\t.then(result => this.parseListData(result)[0]);\r\n\t}\r\n\r\n\tpublic getListData(inputParameterValues: IMap<any>): Promise<any> {\r\n\t\treturn this.loadData(inputParameterValues)\r\n\t\t\t.then(result => {\r\n\t\t\t\treturn this.parseListData(result[0]);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate loadData(inputParameterValues?: IMap<any>): Promise<any> {\r\n\t\tconst defer = this.datasourceService.$q.defer<any>();\r\n\t\tconst parameters: IMap<any>[] = [{}];\r\n\t\tconst extraParameters: IMap<any> = {};\r\n\t\ttry {\r\n\t\t\tthis.databearer.inputParameters.forEach((idoParameter) => {\r\n\t\t\t\tconst inputparameter = inputParameterValues[idoParameter.id];\r\n\t\t\t\tif (idoParameter.required && !inputparameter) {\r\n\t\t\t\t\tthrow new Error((\"Parameter is required\"));\r\n\t\t\t\t} else if (inputparameter && isArray(inputparameter)) { // if multiple parameters\r\n\t\t\t\t\tinputparameter.forEach((parameter, index) => {\r\n\t\t\t\t\t\tif (!parameters[index]) {\r\n\t\t\t\t\t\t\tparameters.push({});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparameters[index][idoParameter.id] = parameter;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (inputparameter) {\r\n\t\t\t\t\textraParameters[idoParameter.id] = inputparameter;\r\n\t\t\t\t\tif (parameters.length === 1) {\r\n\t\t\t\t\t\tparameters[0] = inputParameterValues;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (e) {\r\n\t\t\tconst error: ErrorResponse = new ErrorResponse(e, e);\r\n\t\t\tdefer.reject(error);\r\n\t\t\tconsole.error(e);\r\n\t\t\treturn defer.promise as Promise<any>;\r\n\t\t}\r\n\r\n\t\tthis.fillInParameters(extraParameters, this.databearer.inputParameters, parameters);\r\n\t\tconst promises: IPromise<any>[] = [];\r\n\t\tparameters.forEach((parameter) => {\r\n\t\t\tpromises.push(this.datasourceService.localIdoRequest(this.databearer, parameter));\r\n\t\t});\r\n\t\treturn this.datasourceService.$q.all(promises) as Promise<any>;\r\n\t}\r\n\r\n\tpublic getNonParsedData(inputParameterValues: IMap<any>): Promise<any[]> {\r\n\t\treturn this.datasourceService\r\n\t\t\t.localIdoRequest(this.databearer, inputParameterValues) as Promise<any>;\r\n\t}\r\n\r\n\tprivate parseListData(result: IListDataItem[]): IListDataItem[] {\r\n\t\tconst output = result.map(idoEntry => {\r\n\t\t\tconst newEntry: IListDataItem = {};\r\n\t\t\tthis.databearer.outputParameters.forEach(parameter => {\r\n\t\t\t\tnewEntry[parameter.id] = idoEntry[parameter.key];\r\n\t\t\t});\r\n\t\t\tnewEntry.id = idoEntry[IdoProperties.ROW_POINTER]; // setting the ID on the item\r\n\t\t\treturn newEntry;\r\n\t\t});\r\n\r\n\t\treturn output;\r\n\t}\r\n\r\n\tpublic getMetaData(): Promise<IMetaData> {\r\n\t\tconst deferredMetaData: ng.IDeferred<any> = this.datasourceService.getDeferred();\r\n\t\tconst inputFields: IMetaDataField[] = [];\r\n\t\tconst outputFields: IMetaDataField[] = [];\r\n\r\n\t\tthis.databearer.inputParameters.forEach((param) => {\r\n\t\t\tinputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.alias ? param.alias : param.key,\r\n\t\t\t\tMAND: param.required ? \"1\" : \"0\",\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.databearer.outputParameters.forEach((param) => {\r\n\t\t\toutputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.alias ? param.alias : param.key,\r\n\t\t\t\tMAND: \"0\",\r\n\t\t\t\ttype: param.dataType\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tdeferredMetaData.resolve({\r\n\t\t\tinputFields: inputFields,\r\n\t\t\toutputFields: outputFields\r\n\t\t});\r\n\r\n\t\treturn deferredMetaData.promise as Promise<any>;\r\n\t}\r\n}\r\n","import type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { Generic2 } from \"common/project/datasource/generic2\";\r\n\r\nexport interface IMongooseCollectionItem {\r\n\tName: string;\r\n\tValue: string;\r\n}\r\nexport interface IMongooseIonApiResponse {\r\n\tItems?: IMongooseCollectionItem[][]|string[][];\r\n}\r\n\r\nexport interface IMongooseIonApiParsedResponse {\r\n\tItems?: {}[];\r\n}\r\n\r\nexport class Mongoose extends Generic2 {\r\n\tpublic loadData(\r\n\t\tparameters: IMap<any>\r\n\t): Promise<IMongooseIonApiResponse | IMongooseIonApiParsedResponse> {\r\n\t\treturn super.loadData(parameters)\r\n\t\t\t.then((response: IMongooseIonApiResponse[]) => {\r\n\t\t\t\tconst items = response[0].Items;\r\n\t\t\t\tif (items?.length > 0 && typeof items[0][0] === \"object\") {\r\n\t\t\t\t\tconst parsedResponse =\r\n\t\t\t\t\t\tthis.remapItemProperties(response[0]);\r\n\t\t\t\t\treturn parsedResponse;\r\n\t\t\t\t}\r\n\t\t\t\treturn response[0];\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t\treturn error;\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Remaps Mongoose ION response { Items: []:{ Name: string, Value: string} }\r\n\t * into { Items: []:{ Name: Value } } which is compliance with how data mapping is in App Builder\r\n\t *\r\n\t * @param IMongooseIonApiResponse\r\n\t */\r\n\tprivate remapItemProperties(response: IMongooseIonApiResponse): IMongooseIonApiParsedResponse {\r\n\t\tconst parsedResponse = response as IMongooseIonApiParsedResponse;\r\n\t\tconst items = response.Items as IMongooseCollectionItem[][];\r\n\r\n\t\tconst parsedItems = items.map(items => {\r\n\t\t\tconst obj: IMap<string> = {};\r\n\t\t\titems.forEach(item => {\r\n\t\t\t\tobj[item.Name] = item.Value !== null ? item.Value : \"\";\r\n\t\t\t});\r\n\t\t\treturn obj;\r\n\t\t});\r\n\t\tparsedResponse.Items = parsedItems;\r\n\t\treturn parsedResponse;\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirTranslationDialogCtrl as $ctrl\\\"> <div id=translation-tabs class=tab-container xi-tabs> <ul class=tab-list role=tablist aria-multiselectable=false> <li class=\\\"tab is-selected\\\"> <a href=#component-tab class=hyperlink ng-click=$ctrl.onChangeTab($ctrl.tabEnum.COMPONENT)>Component Strings</a> </li> <li class=tab> <a href=#global-tab class=hyperlink ng-click=$ctrl.onChangeTab($ctrl.tabEnum.GLOBAL)>Global Strings</a> </li> </ul> </div> <div class=\\\"maincontent scrollable\\\"> <div id=component-tab class=scrollable> <p class=error-text>{$value} needs to be present.</p> <div class=toolbar role=toolbar data-options=\\\"{maxVisibleButtons: 10}\\\"> <h3 class=language-text xi-tooltip=\\\"'Current Language'\\\">{{$ctrl.currentLanguageDisplayName}}</h3> <div class=buttonset> <label class=audible for=searchfield-component-language>Keyword Search</label> <input ng-show=!$ctrl.selectedComponent id=searchfield-component-language name=searchfield-language class=searchfield /> <button class=\\\"btn btn-menu\\\" type=button xi-popupmenu> <span>Filter</span> </button> <ul class=\\\"popupmenu is-padded is-selectable\\\"> <li class=is-checked ng-click=\\\"$ctrl.filterLanguage('All')\\\"><a>All</a></li> <li ng-repeat=\\\"usedLanguage in $ctrl.usedLanguages track by usedLanguage.key\\\" ng-click=$ctrl.filterLanguage(usedLanguage.key)> <a>{{usedLanguage.value}}</a> </li> </ul> <button class=\\\"btn btn-menu\\\" type=button xi-popupmenu> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete Language</span> </button> <ul class=popupmenu> <li ng-repeat=\\\"usedLanguage in $ctrl.usedLanguages track by usedLanguage.key\\\" ng-click=$ctrl.deleteLanguage(usedLanguage)> <a>{{usedLanguage.value}}</a> </li> </ul> <button class=\\\"btn btn-menu\\\" type=button xi-popupmenu> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>Add Language</span> </button> <ul class=\\\"popupmenu is-padded\\\"> <li ng-repeat=\\\"supportedLanguage in $ctrl.supportedLanguages\\\" ng-click=$ctrl.addLanguage(supportedLanguage)> <a>{{supportedLanguage.value}}</a> </li> </ul> <button class=btn-actions type=button xi-tooltip=\\\"'More Actions'\\\" ng-show=$ctrl.originalComponent> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=\\\"popupmenu is-padded\\\"> <li><a ng-click=$ctrl.toggleAllTranslations()>{{ $ctrl.selectedComponent ? \\\"All Translations\\\" : \\\"Component Translations\\\" }}</a></li> </ul> </div> </div> <div xi-datagrid=$ctrl.componentDatagridOptions id=component-language-grid></div> </div> <div id=global-tab class=scrollable> <div class=toolbar role=toolbar> <h3 class=language-text xi-tooltip=\\\"'Current Language'\\\">{{$ctrl.currentLanguageDisplayName}}</h3> <div class=buttonset> <label class=audible for=searchfield-global-language>Keyword Search</label> <input id=searchfield-global-language name=searchfield-language class=searchfield /> <button class=btn-tertiary type=button ng-click=$ctrl.addNewString() xi-tooltip=\\\"'Add String'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>Add</span> </button> <button class=btn-tertiary type=button ng-disabled=!$ctrl.selectedGlobalString ng-click=$ctrl.deleteGlobalString() xi-tooltip=\\\"'Delete'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> <button class=\\\"btn btn-menu\\\" type=button xi-popupmenu> <span>Open Language</span> </button> <ul class=\\\"popupmenu is-padded is-selectable\\\"> <li ng-repeat=\\\"supportedLanguage in $ctrl.supportedLanguages\\\" ng-click=$ctrl.openLanguage(supportedLanguage) class=\\\"{{$ctrl.selectedGlobalLocale === supportedLanguage.key ? 'is-checked' : ''}}\\\"> <a>{{supportedLanguage.value}}</a> </li> </ul> </div> </div> <div xi-datagrid=$ctrl.globalDatagridOptions id=global-language-grid></div> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=$ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary translation-save\\\" ng-click=$ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div ng-controller=\\\"eirAddStringCtrl as ctrl\\\"> <div class=field> <label for=stringName class=required>String Name</label> <input id=stringName type=text class=required aria-required=true ng-model=ctrl.stringName /> </div> <div class=field> <label for=stringValue class=required>String Value</label> <input id=stringValue type=text ng-model=ctrl.stringValue /> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-disabled=!ctrl.stringName ng-click=ctrl.add()>Add</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { Injectable } from \"@angular/core\";\r\n\r\n@Injectable({\r\n\tprovidedIn: \"root\"\r\n})\r\nexport class RuntimeService {\r\n\r\n\truntimeHelo(): string {\r\n\t\treturn \"Helo\";\r\n\t}\r\n}","import { Editors, Formatters, Locale, theme } from \"ab-ids-enterprise\";\r\nimport angular from \"angular\";\r\n\r\nimport { IdsSvgComponent } from \"./svg/ids-svg.component\";\r\n\r\nexport const idsAssetsModule = angular\r\n\t.module(\"idsAssetsModule\", [])\r\n\t.config(() => {\r\n\t\t// IDS Configuration\r\n\t\tif (!window.Soho) {\r\n\t\t\twindow.Soho = {\r\n\t\t\t\tEditors,\r\n\t\t\t\tFormatters,\r\n\t\t\t\tLocale,\r\n\t\t\t\ttheme,\r\n\t\t\t};\r\n\t\t}\r\n\t\tLocale.set(\"en-US\");\r\n\t});\r\n\r\n// IdsStyleConfig.add(idsAssetsModule);\r\nIdsSvgComponent.add(idsAssetsModule);\r\n","export class IdsSvgComponent {\r\n\tpublic static add(module: ng.IModule): void {\r\n\t\tmodule\r\n\t\t\t.component(\"eirSvg\", {\r\n\t\t\t\ttemplate: require(\"./eir-svg.html\"),\r\n\t\t\t})\r\n\t\t\t.component(\"idsSvg\", {\r\n\t\t\t\ttemplate: require(\"../../../../../../node_modules/ab-ids-enterprise/dist/svg/svg.html\"),\r\n\t\t\t})\r\n\t\t\t.component(\"idsAssetsModule\", {\r\n\t\t\t\ttemplate: `\r\n\t\t\t\t\t<eir-svg></eir-svg>\r\n\t\t\t\t\t<ids-svg></ids-svg>\r\n\t\t\t\t`,\r\n\t\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=svg-icons> <svg xmlns=http://www.w3.org/2000/svg version=1.1 class=svg-icons style=display:none> <symbol id=icon-hidden xmlns=http://www.w3.org/2000/svg viewBox=\\\"0 0 18 18\\\"> <path class=cls-1 fill=none d=M7.38,12.51l-.44.82c.2.06.39.1.59.14a4.29,4.29,0,0,1-.6-.13h0a2.72,2.72,0,0,1-.38-.11c-.25-.07-.5-.16-.74-.25a2.6,2.6,0,0,1-.36-.13,8.1,8.1,0,0,1-3.22-2.42c-.1-.13-.18-.25-.26-.37s-.15-.27-.21-.4A1.73,1.73,0,0,1,1.6,9a1.49,1.49,0,0,1,0-.21.67.67,0,0,1,0-.19A7,7,0,0,1,5.44,5.27L5.6,5.2a4.23,4.23,0,0,0-.71.94c-.06.12-.11.24-.17.37a3.14,3.14,0,0,0-.23.81,2.13,2.13,0,0,0-.07.44c0,.14,0,.29,0,.44a4.67,4.67,0,0,0,.41,1.91,3,3,0,0,0,.16.31,3.85,3.85,0,0,0,.23.38l.27.35a2.68,2.68,0,0,0,.28.3l.17.17.13.1a4.63,4.63,0,0,0,1.33.77h0 /> <path class=cls-1 fill=none d=M16.4,9a3.94,3.94,0,0,1-1.75,2.54c-.16.14-.34.27-.52.4l-.52.34a10.69,10.69,0,0,1-1.12.58,9.62,9.62,0,0,1-1.57.51l-.48.1A8.47,8.47,0,0,1,9,13.6l-.78,0-.69-.1.69.09.41-.77h0a2.17,2.17,0,0,0,.36,0l.48,0a5.57,5.57,0,0,0,.85-.16A4.57,4.57,0,0,0,13.7,8.2a4.4,4.4,0,0,0-1.06-2.82l0,0,0,0C14.89,6.2,16.4,7.93,16.4,9Z /> <path class=cls-1 fill=none d=M7.5,7.1A6.23,6.23,0,0,1,9.8,5.7a3.29,3.29,0,0,0-3,.7c-.9.7-.6,2.7-.6,2.7A4.63,4.63,0,0,1,7.5,7.1Z /> <path d=M12.6,5.45l-4,7.33a2.17,2.17,0,0,0,.36,0l.48,0a5.57,5.57,0,0,0,.85-.16A4.52,4.52,0,0,0,13.6,8.2,4.09,4.09,0,0,0,12.6,5.45Zm.7-1.28-.61,1.11,0,0C14.83,6.34,16.3,8,16.3,9a3.73,3.73,0,0,1-1.65,2.54c-.16.14-.34.27-.52.4l-.52.34a10.69,10.69,0,0,1-1.12.58,9.62,9.62,0,0,1-1.57.51l-.48.1A8.47,8.47,0,0,1,9,13.6l-.78,0L7.6,14.71A10.74,10.74,0,0,0,9,14.8c5,0,9-3.8,9-5.8C18,7.69,16.11,5.44,13.3,4.17Zm-5.77,9.3.69.1h0Zm-.59-.14h0a4.29,4.29,0,0,0,.6.13C7.33,13.43,7.14,13.39,6.94,13.33ZM6.8,6.4,7,6.23l.06-.05a2.87,2.87,0,0,1,.68-.38l.34-.11h0l.31,0a3.57,3.57,0,0,1,.86,0h.07l.19,0a1.75,1.75,0,0,1,.27,0,2.69,2.69,0,0,0-.61.21A5.67,5.67,0,0,0,7.5,7.1l-.2.2A3.51,3.51,0,0,0,6.21,9.06v0S5.9,7.1,6.8,6.4Zm.59,6.09,4.74-8.78h0a11.17,11.17,0,0,0-1.54-.38A10.21,10.21,0,0,0,9,3.2C4,3.2,0,7.1,0,9c0,1.47,2,3.72,4.85,4.94a11.57,11.57,0,0,0,1.47.51,0,0,0,0,1,0,0l.6-1.12h0l-.38-.1c-.25-.07-.5-.16-.74-.25l-.35-.15a8.52,8.52,0,0,1-3.23-2.4c-.1-.13-.18-.25-.26-.37s-.15-.27-.21-.4A1.73,1.73,0,0,1,1.6,9a1.49,1.49,0,0,1,0-.21.67.67,0,0,1,0-.19C2,7.5,3.46,6,5.5,5.2l-.06.07a4.62,4.62,0,0,0-.55.87c-.06.12-.11.24-.17.37a4.42,4.42,0,0,0-.23.81c0,.14,0,.29-.07.44s0,.29,0,.44a4.67,4.67,0,0,0,.41,1.91,3,3,0,0,0,.16.31,3.85,3.85,0,0,0,.23.38l.27.35a2.68,2.68,0,0,0,.28.3l.17.17.12.11a4.44,4.44,0,0,0,1.33.78h0Z /> <rect x=7.75 y=1.87 width=1.53 height=13.8 transform=\\\"translate(5.19 -2.99) rotate(28.38)\\\"/> <path class=cls-2 fill=currentColor d=M6.94,13.33c.2.06.39.1.59.14a4.29,4.29,0,0,1-.6-.13Z /> <path class=cls-2 fill=currentColor d=M8.22,13.56h0l-.69-.1Z /> <line class=cls-1 fill=none x1=7.39 y1=12.49 x2=7.38 y2=12.51 /> </symbol> <symbol id=icon-screen viewBox=\\\"0 0 18 18\\\"> <g id=additional-icons stroke=none stroke-width=1 fill=none fill-rule=evenodd> <g id=screen-1 fill=currentColor> <path d=\\\"M15.5,1 L2.5,1 C1.119,1 0,2.12 0,3.5 L0,10.599 C0,11.945 1.098,13 2.5,13 L15.5,13 C16.881,13 18,11.881 18,10.5 L18,3.5 C18,2.12 16.881,1 15.5,1 L15.5,1 Z M16,10 L16,10.5 C16,10.775 15.776,11 15.5,11 L2.5,11 C2.449,11 2,10.988 2,10.599 L2,3.5 C2,3.224 2.224,3 2.5,3 L15.5,3 C15.775,3 16,3.224 16,3.5 L16,10 Z M12,17 L6,17 C5.45,17 5,16.55 5,16 C5,15.45 5.45,15 6,15 L12,15 C12.55,15 13,15.45 13,16 C13,16.55 12.55,17 12,17 L12,17 Z\\\" id=Page-1></path> </g> </g> </symbol> <symbol id=icon-stop viewBox=\\\"0 0 22 22\\\"> <rect width=22 height=22 rx=4 ry=4 /> </symbol> <symbol id=icon-play viewBox=\\\"3 3 12 12\\\"> <path d=\\\"M5 3.731c0-.604.886-.947 1.361-.58l6.329 5.269c.377.292.427.868.049 1.16l-6.403 5.269c-.475.367-1.336.024-1.336-.58v-10.538\\\"></path> </symbol> <symbol id=icon-more-small class=soho-icon-color viewBox=\\\"0 0 18 18\\\"> <path d=\\\"M2 7a2 2 0 1 0 .001 4.001A2 2 0 0 0 2 7zm7 0a2 2 0 1 0 .001 4.001A2 2 0 0 0 9 7zm7 0a2 2 0 1 0 .001 4.001A2 2 0 0 0 16 7z\\\" fill=currentColor fill-rule=nonzero stroke=none class=soho-icon-color-path-white></path> </symbol> <symbol id=icon-preview viewBox=\\\"0 0 17 11\\\"> <g> <path fill=none d=\\\"M11.8,1.9c0.7,0.8,1.1,1.7,1.1,2.8c0,2.4-1.9,4.3-4.3,4.3C6.1,9,4.2,7.1,4.2,4.7c0-1.1,0.4-2.1,1.1-2.8\\r\\n\\t\\tC3,2.8,1.5,4.5,1.5,5.5c0,1.5,3.1,4.3,7,4.3c3.8,0,7-2.8,7-4.3C15.5,4.5,14,2.8,11.8,1.9z\\\"/> <path fill=none d=M7.1,3.7c1.1-1,2.2-1.3,2.2-1.3S7.5,1.9,6.4,3C5.6,3.7,5.9,5.6,5.9,5.6S6,4.7,7.1,3.7z /> <path fill=currentColor d=\\\"M8.5,0C3.8,0,0,3.7,0,5.5c0,2,3.8,5.5,8.5,5.5c4.7,0,8.5-3.6,8.5-5.5C17,3.7,13.2,0,8.5,0z M6.4,3\\r\\n\\t\\tc1.2-1.1,2.9-0.6,2.9-0.6S8.2,2.6,7.1,3.7C6,4.7,5.9,5.6,5.9,5.6S5.6,3.7,6.4,3z M8.5,9.8c-3.8,0-7-2.8-7-4.3c0-1,1.5-2.7,3.7-3.6\\r\\n\\t\\tC4.6,2.6,4.2,3.6,4.2,4.7C4.2,7.1,6.1,9,8.5,9c2.4,0,4.3-1.9,4.3-4.3c0-1.1-0.4-2-1.1-2.8c2.2,1,3.7,2.7,3.7,3.6\\r\\n\\t\\tC15.5,7,12.3,9.8,8.5,9.8z\\\"/> </g> </symbol> <svg id=icon-custom-hamburger x=0px y=0px viewBox=\\\"0 0 160 120\\\"> <rect x=0 y=0 width=160 height=20 /> <rect x=0 y=50 width=160 height=20 /> <rect x=0 y=100 width=160 height=20 /> </svg> <symbol id=eir-icon-dashboard class=soho-icon-color viewBox=\\\"0 0 18 18\\\"> <path d=M7,8H1C0.4,8,0,7.6,0,7V1c0-0.5,0.4-1,1-1h6c0.5,0,1,0.5,1,1v6C8,7.6,7.5,8,7,8z fill=currentColor /> <path d=M17,8h-6c-0.6,0-1-0.4-1-1V1c0-0.5,0.4-1,1-1h6c0.5,0,1,0.5,1,1v6C18,7.6,17.5,8,17,8z fill=currentColor /> <path d=M7,18H1c-0.6,0-1-0.5-1-1v-6c0-0.6,0.4-1,1-1h6c0.5,0,1,0.4,1,1v6C8,17.6,7.5,18,7,18z fill=currentColor /> <path d=M17,18h-6c-0.6,0-1-0.5-1-1v-6c0-0.6,0.4-1,1-1h6c0.5,0,1,0.4,1,1v6C18,17.6,17.5,18,17,18z fill=currentColor /> </symbol> <symbol id=icon-launch-project class=soho-icon-color viewBox=\\\"0 0 16 19\\\"> <path d=\\\"M15.2,14.8c-0.6-1.2-1.6-2.2-2.9-2.9c-0.1-0.1-0.2-0.1-0.1-0.2c0.3-1.8,0.3-3.6-0.1-5.4c-0.3-1.4-0.8-2.7-1.8-4\\r\\n\\t\\t\\t\\t\\t\\tC9.7,1.6,9,1,8.1,0.5c-0.1-0.1-0.3-0.1-0.4,0C7.4,0.7,7,0.9,6.7,1.1C5.6,2,4.9,3,4.4,4.1C3.8,5.3,3.6,6.4,3.4,7.6\\r\\n\\t\\t\\t\\t\\t\\tc-0.1,1.3-0.1,2.7,0.1,4c0,0.2,0,0.3-0.2,0.3c-1,0.6-1.8,1.3-2.4,2.1c-0.9,1.3-1.2,2.6-0.9,4c0.1,0.3,0.1,0.6,0.2,0.9c0,0,0,0,0.1,0\\r\\n\\t\\t\\t\\t\\t\\tc0.1-0.1,0.1-0.2,0.2-0.3c0.8-1,1.8-1.9,3.1-2.4c0.2-0.1,0.5-0.1,0.6-0.3c0.1-0.2,0-0.4-0.1-0.6C4.1,15,4.1,14.7,4,14.3\\r\\n\\t\\t\\t\\t\\t\\tc0.1,0,0.1,0.1,0.1,0.2c0.3,0.5,0.5,1,0.8,1.5c0.2,0.4,0.5,0.9,1,1.2c0.8,0.5,1.6,0.6,2.6,0.5c1-0.1,1.8-0.5,2.2-1.3\\r\\n\\t\\t\\t\\t\\t\\tc0.3-0.6,0.6-1.2,0.9-1.8c0,0,0-0.1,0.1-0.1c0,0,0,0.1,0,0.1c-0.1,0.5-0.1,1-0.2,1.5c0,0.1,0,0.1,0.1,0.2c1.7,0.6,2.8,1.5,3.7,2.8\\r\\n\\t\\t\\t\\t\\t\\tc0,0,0.1,0.1,0.1,0.2c0-0.1,0-0.1,0-0.1C15.9,17.5,15.8,16.2,15.2,14.8z M7.9,7.6C7.2,7.6,6.6,7,6.5,6.2c0-0.8,0.6-1.4,1.4-1.4\\r\\n\\t\\t\\t\\t\\t\\tc0.8,0,1.4,0.6,1.4,1.4C9.3,6.9,8.7,7.6,7.9,7.6z\\\" fill=currentColor /> </symbol> <symbol id=icon-action-wizard viewBox=\\\"0 0 16.2 15.5\\\"> <polygon fill=none stroke=#FFFFFF stroke-miterlimit=10 points=\\\"10,7.3 12.3,4 8.3,4.2 5.9,1.1 4.9,4.9 1.1,6.3 4.5,8.4 4.6,12.4 7.7,9.9 7.2,7.1 \\\"/> <path fill=#FFFFFF d=M8.9,9.8l1.4-1.5l5.7,4.8c0,0,0.9,2.2-1.8,2.1C12.8,13.9,8.9,9.8,8.9,9.8z /> </symbol> <symbol id=icon-add-comp class=soho-icon-color viewBox=\\\"0 0 18 18\\\"> <path d=\\\"M9,0C4,0,0,4,0,9c0,5,4,9,9,9c5,0,9-4,9-9C18,4,14,0,9,0z M14.4,9.7H10v4.7H8V9.7H3.6v-2H8V3.6h2v4.1h4.4V9.7z\\\" fill=currentColor /> </symbol> <symbol id=icon-action-interaction viewBox=\\\"0 0 12.5 18.2\\\"> <path fill=#FFFFFF d=\\\"M4,18.2c-0.3-0.1-0.5-0.3-0.7-0.6c-1-1.3-2-2.6-3-3.9C0.2,13.5,0,13.3,0,13.1C0,12.6,0.2,12.2,0.5,12\\r\\n\\t\\t\\tc0.4-0.2,0.8-0.2,1.2,0.1c0.4,0.3,0.8,0.7,1.2,1c0.1,0.1,0.3,0.2,0.4,0.2c0.3,0,0.5-0.2,0.5-0.5c0-1.4,0-2.8,0-4.2\\r\\n\\t\\t\\tc0-0.9,0-1.9,0-2.8c0-0.6,0.4-1,0.9-1.1c0.6-0.1,1.2,0.4,1.2,1c0,0.7,0,1.5,0,2.2c0,0.5,0,1,0,1.4c0,0,0,0.1,0.1,0.2\\r\\n\\t\\t\\tc0,0,0.1-0.1,0.1-0.1c0.2-0.4,0.7-0.6,1.2-0.5c0.5,0.1,0.8,0.5,0.8,1c0,0.2,0,0.4,0,0.7c0,0,0,0,0,0c0,0,0.1-0.1,0.1-0.1\\r\\n\\t\\t\\tc0.2-0.4,0.7-0.7,1.2-0.5c0.5,0.1,0.8,0.5,0.8,1c0,0.2,0,0.4,0,0.7c0,0,0.1-0.1,0.1-0.1c0.2-0.4,0.7-0.6,1.2-0.5\\r\\n\\t\\t\\tc0.5,0.1,0.8,0.5,0.8,1c0,0.9,0,1.7,0,2.6c0,0.7-0.2,1.5-0.4,2.2c-0.1,0.3-0.2,0.6-0.3,0.9c-0.1,0.3-0.3,0.6-0.6,0.7\\r\\n\\t\\t\\tC8.7,18.2,6.3,18.2,4,18.2z\\\"/> <path style=fill:none;stroke:#fff;stroke-width:2;stroke-miterlimit:10 d=M2.1,6.7C1.6,6.1,1.3,5.4,1.3,4.5c0-2,1.6-3.5,3.5-3.5s3.5,1.6,3.5,3.5c0,0.8-0.2,1.5-0.7,2 /> </symbol> <symbol id=icon-action-dataservice viewBox=\\\"0 0 13.1 12.8\\\"> <ellipse fill=#FFFFFF cx=6.6 cy=1.4 rx=6.6 ry=1.4 /> <path fill=#FFFFFF d=M0,2.6c0,0,3.1,1.1,6.4,1.1c3.4,0,6.7-1,6.7-1v3.9c0,0-3.5,1.3-6.7,1.3C2.6,7.9,0,6.6,0,6.6V2.6z /> <path fill=#FFFFFF d=M0,7.6c0,0,3.1,1.1,6.4,1.1c3.4,0,6.7-1,6.7-1v3.9c0,0-3.5,1.3-6.7,1.3c-3.7,0-6.4-1.3-6.4-1.3V7.6z /> </symbol> <symbol id=icon-action-edit viewBox=\\\"0 0 16.9 14.1\\\"> <path fill=#FFFFFF d=\\\"M6.4,7.8c0,0,4.1-6.8,6.8-7.3C14.5,0.2,15.6,0,16.1,0c0.3,0,0.7,0.4,0.7,0.7l-0.1,1.7c0,0.2-0.1,0.6-0.2,0.7\\r\\n\\t\\t\\tC16,4.4,13.2,9.1,8.9,10C8.2,9.5,6.4,7.8,6.4,7.8z\\\"/> <path style=fill:none;stroke:#fff;stroke-width:1.5;stroke-miterlimit:10 d=\\\"M7.1,8.3H4.9c0,0-0.8,0-1.3,1c-0.4,0.8-1.4,3.4-2,4h3.9c0.2,0,0.3-0.1,0.4-0.2c0.6-0.7,2.7-3,2.6-3.7\\r\\n\\t\\t\\tC7.2,8.4,7.1,8.3,7.1,8.3z\\\"/> </symbol> <symbol id=icon-action-orientation-2 viewBox=\\\"0 0 18 18\\\"> <path fill=#FFFFFF d=\\\"M9.715 15.77l.062-.063h.001l4.999-5c.391-.391.391-1.023 0-1.414-.39-.391-1.054-.391-1.445 0l-3.324 3.293v-9.586c0-.553-.448-1-1-1s-1 .447-1 1v9.711l-3.324-3.355c-.391-.391-1.008-.391-1.399 0-.195.195-.285.451-.285.706 0 .256.102.512.297.707l5.002 5.001c.391.39 1.025.39 1.416 0\\\"/> </symbol> <symbol id=icon-action-orientation-1 viewBox=\\\"0 0 18 18\\\"> <path fill=#FFFFFF d=\\\"M1 10h13.564l-5.33 5.32c-.392.388-.396 1.037-.008 1.43.389.393 1.021.404 1.415.016l7.062-6.996c.393-.388.397-1.019.009-1.412l-7-7.061c-.196-.198-.454-.297-.712-.297-.254 0-.508.096-.703.289-.393.388-.397.989-.009 1.382l5.318 5.329h-13.606c-.553 0-1 .448-1 1s.447 1 1 1\\\"/> </symbol> <symbol id=icon-small-close viewBox=\\\"0 0 12 12\\\"> <circle fill=#ffffff cx=6 cy=6 r=6 /> <g> <line fill=none stroke-width=1.5 stroke=#313236 x1=3.5 y1=3.5 x2=8.5 y2=8.5 /> <line fill=none stroke-width=1.5 stroke=#313236 x1=3.5 y1=8.5 x2=8.5 y2=3.5 /> </g> </symbol> <symbol id=boundary-marker-pin viewBox=\\\"0 0 5 11.3\\\"> <polygon class=st0 points=\\\"0,0.1 5,0.1 5,8.4 2.5,11.3 0,8.4 \\\"/> </symbol> <symbol id=icon-add-from-repository viewBox=\\\"0 0 18 18\\\"> <polygon fill=currentColor points=\\\"15 14.83 9 18 3 14.83 3 11.48 3 8.13 9 11.3 15 8.13 15 11.48 15 14.83\\\"/> <path fill=currentColor class=cls-1 d=M11.88,13.07,9,11.27,15.12,8,18,9.65Z /> <path fill=currentColor class=cls-1 d=M0,9.65,2.88,8,9,11.27l-2.88,1.8Z /> <path fill=currentColor class=cls-1 d=M0,6.24,2.88,8,5,6.85V3.59Z /> <path fill=currentColor class=cls-1 d=M13,3.59V6.85L15.12,8,18,6.24Z /> <path fill=currentColor class=cls-2 d=M11.27,4H10V1A1,1,0,0,0,8,1V4H6.73a.88.88,0,0,0-.58,1.36L8.42,8.69a.73.73,0,0,0,1.16.05l2.27-3.4A.86.86,0,0,0,11.27,4Z /> </symbol></svg>  </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { componentsModule } from \"../components/module\";\r\n\r\nimport { DesignerService } from \"./services/designer-service\";\r\nimport { ProjectService } from \"./services/project-service\";\r\n\r\nexport const designerModule = angular.module(\"designerModule\", [\r\n\tcomponentsModule.name\r\n]);\r\n\r\n// Services\r\nProjectService.add(designerModule);\r\nDesignerService.add(designerModule);\r\n","import angular from \"angular\";\r\nimport ngAnimate from \"angular-animate\";\r\n\r\nimport { Config } from \"ng2/common/constants/common.constant\";\r\nimport { Filters } from \"./filters\";\r\n\r\n// Add Controller Imports\r\nimport { AddStringCtrl } from \"./dialogs/add-string/add-string\";\r\nimport { ExportProjectCtrl } from \"./dialogs/export/export-dialog\";\r\nimport { ImportConflictCtrl } from \"./dialogs/import-conflict/conflict-decision-dialog\";\r\nimport { ImportErrorCtrl } from \"./dialogs/import-error/import-error-dialog\";\r\nimport { ImportProjectCtrl } from \"./dialogs/import/import-dialog\";\r\nimport { LicensesButton } from \"./dialogs/licenses/licenses-button\";\r\nimport { LicensesDialogCtrl } from \"./dialogs/licenses/licenses-dialog\";\r\nimport { TestDataserviceDialogCtrl } from \"./dialogs/test-dataservice/test-dataservice-dialog\";\r\nimport { DatagridExportDialogCtrl } from \"../components/datagrid/datagrid-export-dialog-ctrl\";\r\n\r\nimport { CommonService } from \"./services/common-service\";\r\nimport { ConflictResolutonService } from \"./services/conflict-resolution-service\";\r\nimport { DialogService } from \"./services/dialog-service\";\r\nimport { ExpressionService } from \"./services/expression-service\";\r\nimport { FeatureSwitchService } from \"./services/feature-switch-service\";\r\nimport { HashService } from \"./services/hash-service\";\r\nimport { HttpService } from \"./services/http-service\";\r\nimport { LanguageService } from \"./services/language-service\";\r\nimport { MingleService } from \"./services/mingle-service\";\r\nimport { TagService } from \"./services/tag-service\";\r\nimport { ThemeService } from \"./services/theme-service\";\r\n\r\n// Add Directive Imports\r\nimport { RepeatDoneDirective } from \"./after-repeat-directive\";\r\nimport { DragDirective } from \"./drag-directive\";\r\nimport { InfiniteScrollDirective } from \"./helpers/infinite-scroll\";\r\nimport { InitializeDirective } from \"./initialize-directive\";\r\n\r\n// Shared Component Imports\r\nimport { DropdownFieldComponent } from \"./shared-components/dropdown-field/dropdown-field-component\";\r\nimport { FilterPopupmenuComponent } from \"./shared-components/filter-popupmenu/filter-popupmenu-component\";\r\nimport { FilterTagComponent } from \"./shared-components/filter-tag-dropdown/filter-tag-component\";\r\nimport { FilterToolbarComponent } from \"./shared-components/filter-toolbar/filter-toolbar\";\r\nimport { InputFieldComponent } from \"./shared-components/input-field/input-field-component\";\r\nimport { PaginatorComponent } from \"./shared-components/paginator/paginator-component\";\r\nimport { ProjectTagsComponent } from \"./shared-components/project-tags/project-tags-component\";\r\nimport { SortPopupmenuComponent } from \"./shared-components/sort-popupmenu/sort-popupmenu-component\";\r\nimport { TagDropdownComponent } from \"./shared-components/tag-dropdown/tag-dropdown-component\";\r\nimport { TextareaFieldComponent } from \"./shared-components/textarea-field/textarea-field-component\";\r\n\r\n// IDS directives\r\nimport { AboutDirective } from \"./sohoxi/component/about-directive\";\r\nimport { ApplicationMenuDirective } from \"./sohoxi/component/application-menu-directive\";\r\nimport { ArrangeDirective }from \"./sohoxi/component/arrange-directive\";\r\nimport { AutocompleteDirective } from \"./sohoxi/component/autocomplete-directive\";\r\nimport { BusyDirective } from \"./sohoxi/component/busy-directive\";\r\nimport { ButtonDirective } from \"./sohoxi/component/button-directive\";\r\nimport { ColorPickerDirective } from \"./sohoxi/component/colorpicker-directive\";\r\nimport { ControlDirective } from \"./sohoxi/component/control-directive\";\r\nimport { DatagridDirective } from \"./sohoxi/component/datagrid-directive\";\r\nimport { DatepickerDirective } from \"./sohoxi/component/datepicker-directive\";\r\nimport { DropDownDirective } from \"./sohoxi/component/dropdown-directive\";\r\nimport { EditorDirective } from \"./sohoxi/component/editor-directive\";\r\nimport { FileuploadDirective } from \"./sohoxi/component/fileupload-directive\";\r\nimport { ListviewDirective } from \"./sohoxi/component/listview-directive\";\r\nimport { LookupDirective } from \"./sohoxi/component/lookup-directive\";\r\nimport { MaskDirective } from \"./sohoxi/component/mask-directive\";\r\nimport { MultiSelectDirective } from \"./sohoxi/component/multiselect-directive\";\r\nimport { PopoverDirective } from \"./sohoxi/component/popover-directive\";\r\nimport { PopupmenuDirective } from \"./sohoxi/component/popupmenu-directive\";\r\nimport { SearchFieldDirective } from \"./sohoxi/component/search-field-directive\";\r\nimport { SliderDirective } from \"./sohoxi/component/slider-directive\";\r\nimport { SpinboxDirective } from \"./sohoxi/component/spinbox-directive\";\r\nimport { TabsDirective } from \"./sohoxi/component/tabs-directive\";\r\nimport { TextareaDirective } from \"./sohoxi/component/textarea-directive\";\r\nimport { TimepickerDirective } from \"./sohoxi/component/timepicker-directive\";\r\nimport { ToolbarDirective } from \"./sohoxi/component/toolbar-directive\";\r\nimport { TooltipDirective } from \"./sohoxi/component/tooltip-directive\";\r\nimport { TrackDirtyDirective } from \"./sohoxi/component/trackdirty-directive\";\r\nimport { ValidateDirective } from \"./sohoxi/component/validate-directive\";\r\n\r\n// TODO: MUPS-2682 Needs to be fixed later\r\n// (window as any).setContextRoots();\r\n\r\nexport const commonModule = angular.module(\"commonModule\", [\r\n\tngAnimate\r\n]);\r\n\r\ncommonModule.run(() => {\r\n\tconst setContextRoots = () => {\r\n\r\n\t\tlet pathname: string;\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tpathname = \"api\";\r\n\t\t} else {\r\n\t\t\tpathname = location.pathname;\r\n\t\t}\r\n\r\n\t\t// Setting context roots, used by angular for rest calls and templates\r\n\t\tconst pathnameNoIndex = pathname.substr(0, pathname.indexOf(\"index.html\"));\r\n\r\n\t\tConfig.APP_ROOT = pathnameNoIndex; // MUPS-2682: Remove as this property is probably obsolete now\r\n\r\n\t\tif (pathname.indexOf(\"appbuilder\") !== -1) {\r\n\t\t\tConfig.REST_ROOT = Config.APP_BUILDER_REST_ROOT;\r\n\t\t} else if (pathname.indexOf(\"apphub\") !== -1) {\r\n\t\t\tConfig.REST_ROOT = Config.APP_RUNTIME_REST_ROOT;\r\n\t\t} else {\r\n\t\t\tConfig.REST_ROOT = `http://localhost:3000/${pathname}`;\r\n\t\t}\r\n\t};\r\n\r\n\tsetContextRoots();\r\n});\r\n\r\n// Add angularAnimate to any component we want ngAnimate on\r\ncommonModule\r\n\t.config([\"$animateProvider\", (\r\n\t\t$animateProvider: ng.animate.IAnimateProvider\r\n\t) => {\r\n\t\t$animateProvider.classNameFilter(/angularAnimate/);\r\n\t}]);\r\n\r\n//tslint:disable:no-magic-numbers\r\n// Adds custom slide and fade animation using ngAnimate\r\ncommonModule\r\n\t.animation(\".angularAnimate-slide\", [() => {\r\n\t\treturn {\r\n\t\t\tenter: (element: JQuery, doneFn: any) => {\r\n\t\t\t\t$(element).slideDown(1000, doneFn);\r\n\t\t\t},\r\n\t\t\tleave: (element: JQuery, doneFn: any) => {\r\n\t\t\t\t$(element).slideUp(1000, doneFn);\r\n\t\t\t},\r\n\t\t} as ng.animate.IAnimateCallbackObject;\r\n\t}])\r\n\t.animation(\".angularAnimate-fade\", [() => {\r\n\t\treturn {\r\n\t\t\tenter: (element: JQuery, doneFn: any) => {\r\n\t\t\t\t$(element).fadeIn(1500, doneFn);\r\n\t\t\t},\r\n\t\t\tleave: (element: JQuery, doneFn: any) => {\r\n\t\t\t\t$(element).fadeOut(500, doneFn);\r\n\t\t\t},\r\n\t\t} as ng.animate.IAnimateCallbackObject;\r\n\t}]);\r\n//tslint:enable\r\n\r\ncommonModule.config([\"$qProvider\", ($qProvider: ng.IQProvider) => {\r\n\t$qProvider.errorOnUnhandledRejections(false);\r\n}]);\r\n\r\n// NoCacheInterceptor.add(commonModule);\r\n\r\n// Add Controllers\r\nAddStringCtrl.add(commonModule);\r\nExportProjectCtrl.add(commonModule);\r\nImportConflictCtrl.add(commonModule);\r\nImportErrorCtrl.add(commonModule);\r\nImportProjectCtrl.add(commonModule);\r\nLicensesButton.add(commonModule);\r\nLicensesDialogCtrl.add(commonModule);\r\nTestDataserviceDialogCtrl.add(commonModule);\r\nDatagridExportDialogCtrl.add(commonModule);\r\n\r\n// Add Services\r\nCommonService.add(commonModule);\r\nConflictResolutonService.add(commonModule);\r\nDialogService.add(commonModule);\r\nExpressionService.add(commonModule);\r\nFeatureSwitchService.add(commonModule);\r\nHashService.add(commonModule);\r\nHttpService.add(commonModule);\r\nLanguageService.add(commonModule);\r\nMingleService.add(commonModule);\r\nTagService.add(commonModule);\r\nThemeService.add(commonModule);\r\n\r\n// Add Directives\r\nDragDirective.add(commonModule);\r\nInitializeDirective.add(commonModule);\r\nInfiniteScrollDirective.add(commonModule);\r\nRepeatDoneDirective.add(commonModule);\r\n\r\n// // Add Filters\r\nFilters.add(commonModule);\r\n\r\n// Shared Components\r\nDropdownFieldComponent.add(commonModule);\r\nFilterPopupmenuComponent.add(commonModule);\r\nFilterTagComponent.add(commonModule);\r\nFilterToolbarComponent.add(commonModule);\r\nInputFieldComponent.add(commonModule);\r\nPaginatorComponent.add(commonModule);\r\nProjectTagsComponent.add(commonModule);\r\nTagDropdownComponent.add(commonModule);\r\nTextareaFieldComponent.add(commonModule);\r\nSortPopupmenuComponent.add(commonModule);\r\n\r\n// SohoXi directives\r\nAboutDirective.add(commonModule);\r\nArrangeDirective.add(commonModule);\r\nAutocompleteDirective.add(commonModule);\r\nBusyDirective.add(commonModule);\r\nButtonDirective.add(commonModule);\r\nColorPickerDirective.add(commonModule);\r\nControlDirective.add(commonModule);\r\nDatagridDirective.add(commonModule);\r\nDatepickerDirective.add(commonModule);\r\nDropDownDirective.add(commonModule);\r\nEditorDirective.add(commonModule);\r\nFileuploadDirective.add(commonModule);\r\nListviewDirective.add(commonModule);\r\nLookupDirective.add(commonModule);\r\nMaskDirective.add(commonModule);\r\nMultiSelectDirective.add(commonModule);\r\nPopupmenuDirective.add(commonModule);\r\nPopoverDirective.add(commonModule);\r\nSearchFieldDirective.add(commonModule);\r\nSliderDirective.add(commonModule);\r\nSpinboxDirective.add(commonModule);\r\nTabsDirective.add(commonModule);\r\nTextareaDirective.add(commonModule);\r\nTimepickerDirective.add(commonModule);\r\nToolbarDirective.add(commonModule);\r\nTooltipDirective.add(commonModule);\r\nTrackDirtyDirective.add(commonModule);\r\nValidateDirective.add(commonModule);\r\nApplicationMenuDirective.add(commonModule);\r\n","import { Helper } from \"./helper\";\r\n\r\nclass ExcludeFromFilter {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.filter(\"eirExcludeFrom\", () => {\r\n\t\t\treturn (inputArray: any[], criteria: any, itemProperty: string, selectedItem: any): any[] => {\r\n\r\n\t\t\t\tif (criteria instanceof Array) {\r\n\t\t\t\t\treturn inputArray ? inputArray.filter((item: any) => {\r\n\t\t\t\t\t\tlet keepItem = true;\r\n\t\t\t\t\t\tconst compareValue1: any = (itemProperty ? item[itemProperty] : item);\r\n\t\t\t\t\t\tcriteria.forEach((item2: any) => {\r\n\t\t\t\t\t\t\tconst compareValue2: any = (itemProperty ? item2[itemProperty] : item2);\r\n\t\t\t\t\t\t\tif (compareValue1 === compareValue2) {\r\n\t\t\t\t\t\t\t\tkeepItem = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (selectedItem && selectedItem[itemProperty] === compareValue1) {\r\n\t\t\t\t\t\t\tkeepItem = true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn keepItem;\r\n\t\t\t\t\t}) : inputArray;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn inputArray ? inputArray.filter((item: any) => {\r\n\t\t\t\t\t\tconst compareValue1: any = (itemProperty ? item[itemProperty] : item);\r\n\t\t\t\t\t\tif (criteria === compareValue1) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}) : inputArray;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n\r\nclass OnlyIncludeFilter {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.filter(\"eirOnlyInclude\", () => {\r\n\t\t\treturn (inputArray: any[], criteria: any, itemProperty1: string, itemProperty2: string) => {\r\n\t\t\t\treturn inputArray ? inputArray.filter((item: any) => {\r\n\t\t\t\t\tconst compareValue1: any = (itemProperty1 ? item[itemProperty1] : item);\r\n\t\t\t\t\tconst compareValue2: any = (itemProperty2 ? item[itemProperty2] : item);\r\n\t\t\t\t\tif (criteria === compareValue1) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (criteria === compareValue2) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}) : inputArray;\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n\r\ninterface IFilterHtmlEncode {\r\n\t(html: string): string;\r\n}\r\nclass HtmlEncode {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.filter(\"eirHtmlEncode\", () => {\r\n\t\t\treturn (input: string) =>\r\n\t\t\t\tHelper.htmlEncode(input);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class Filters {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tExcludeFromFilter.add(m);\r\n\t\tOnlyIncludeFilter.add(m);\r\n\t\tHtmlEncode.add(m);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IMongooseString } from \"ng2/common/model/language.model\";\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\nimport { LanguageService } from \"../../services/language-service\";\r\n\r\nexport class AddStringCtrl {\r\n\tpublic stringName: string;\r\n\tpublic stringValue: string;\r\n\tprivate dialog: IDialog<string>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<string>,\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.stringName = this.dialog.parameter;\r\n\t\tthis.stringValue = null;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic add(): void {\r\n\t\tif (this.stringValue) {\r\n\t\t\tif (!this.languageService.getGlobalString(this.stringName)) {\r\n\t\t\t\tconst result: IDialogResult<IMongooseString> = {\r\n\t\t\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\t\t\tvalue: {\r\n\t\t\t\t\t\tName: this.stringName,\r\n\t\t\t\t\t\tValue: this.stringValue\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.dialog.close(result);\r\n\t\t\t} else {\r\n\t\t\t\tthis.dialogService.showError(\"Add String\", \"String Key already exists\");\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.dialogService.showError(\"Add String\", \"Must have a string Value\");\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirAddStringCtrl\", AddStringCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { ConflictResolutionEnum, IConflictObject, IConflictResult } from \"../../services/conflict-resolution-service\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\n\r\nimport { Helper } from \"../../helper\";\r\n\r\nexport class ImportConflictCtrl {\r\n\tpublic objectName: string;\r\n\tpublic remainingCount: number;\r\n\tpublic newName: string;\r\n\tpublic resolutionOption: string;\r\n\tpublic sameForAll: boolean = false;\r\n\tpublic currentActionName: string;\r\n\tpublic maxItems: number;\r\n\tpublic occupiedStrings: string[];\r\n\r\n\tpublic get ConflictResolutionEnum(): any {\r\n\t\treturn ConflictResolutionEnum;\r\n\t}\r\n\r\n\tprivate dialog: IDialog<IConflictObject>;\r\n\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<IConflictObject>) {\r\n\t\tconst dialog: IDialog<IConflictObject> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tconst parameter = dialog.parameter;\r\n\r\n\t\tthis.objectName = parameter.objectName;\r\n\t\tthis.remainingCount = parameter.remainingCount;\r\n\t\tthis.maxItems = parameter.maxItems;\r\n\t\tthis.occupiedStrings = parameter.occupiedStrings;\r\n\t\tif (this.maxItems > this.occupiedStrings.length) {\r\n\t\t\tthis.resolutionOption = parameter.lastAction\r\n\t\t\t\t? parameter.lastAction.toString()\r\n\t\t\t\t: ConflictResolutionEnum.REPLACE.toString();\r\n\t\t} else {\r\n\t\t\tthis.resolutionOption = ConflictResolutionEnum.REPLACE.toString();\r\n\t\t}\r\n\t\tthis.onChangeOption();\r\n\t\tthis.newName = Helper.generateNewDisplayName(parameter.conflictedString, parameter.occupiedStrings);\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic resolve(): void {\r\n\t\tconst result: IDialogResult<IConflictResult> = {\r\n\t\t\tvalue: {\r\n\t\t\t\taction: parseInt(this.resolutionOption),\r\n\t\t\t\tsameForRemaining: this.sameForAll,\r\n\t\t\t\tnewName: this.newName\r\n\t\t\t},\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic onChangeOption(): void {\r\n\t\tswitch (parseInt(this.resolutionOption)) {\r\n\t\t\tcase ConflictResolutionEnum.REPLACE:\r\n\t\t\t\tthis.currentActionName = \"Replace\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase ConflictResolutionEnum.COPY:\r\n\t\t\t\tthis.currentActionName = \"Copy\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase ConflictResolutionEnum.SKIP:\r\n\t\t\t\tthis.currentActionName = \"Skip\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[ImportConflictCtrl] Invalid option\");\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirImportConflictCtrl\", ImportConflictCtrl);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div id=conflict-dialog ng-controller=\\\"eirImportConflictCtrl as ctrl\\\"> <fieldset class=radio-group> <legend>You already have a {{ctrl.objectName}} with the name \\\"<b>{{ctrl.dialog.parameter.conflictedString}}</b>\\\"</legend> <input type=radio checked=checked class=radio name=import id=importReplace value={{ctrl.ConflictResolutionEnum.REPLACE}} ng-model=ctrl.resolutionOption ng-change=ctrl.onChangeOption() /> <label for=importReplace class=radio-label>Replace</label> <br/> <label class=extra-label>Replace the existing {{ctrl.objectName}} with the {{ctrl.objectName}} you are importing</label> <br/> <input type=radio class=radio name=import id=importCopy value={{ctrl.ConflictResolutionEnum.COPY}} ng-model=ctrl.resolutionOption ng-change=ctrl.onChangeOption() ng-disabled=\\\"ctrl.maxItems <= ctrl.occupiedStrings.length\\\"/> <label for=importCopy class=radio-label>Copy</label> <br/> <label class=\\\"extra-label label-warning\\\" ng-if=\\\"ctrl.maxItems <= ctrl.occupiedStrings.length\\\">No more space for new data services!</label> <label class=extra-label ng-if=\\\"ctrl.maxItems > ctrl.occupiedStrings.length\\\" ng-model=ctrl.newName>Import a copy with new name <b>{{ctrl.newName}}</b></label> <br/> <input type=radio class=radio name=import id=importSkip value={{ctrl.ConflictResolutionEnum.SKIP}} ng-model=ctrl.resolutionOption ng-change=ctrl.onChangeOption() /> <label for=importSkip class=radio-label>Skip</label> <br/> <label class=extra-label ng-model=ctrl.newName>Do not import this {{ctrl.objectName}}</label> <br/> <div class=\\\"field center\\\" ng-if=\\\"ctrl.remainingCount > 0\\\"> <input type=checkbox class=checkbox id=same-for-all ng-model=ctrl.sameForAll ng-disabled=\\\"ctrl.currentActionName === 'Copy' && ctrl.maxItems <= (ctrl.occupiedStrings.length + ctrl.remainingCount)\\\"/> <label for=same-for-all class=checkbox-label>Same action for remaining {{ctrl.remainingCount}} {{ctrl.objectName}}(s)</label> <label class=label-warning ng-if=\\\"ctrl.currentActionName === 'Copy' && ctrl.maxItems <= (ctrl.occupiedStrings.length + ctrl.remainingCount)\\\">Only space for {{ctrl.maxItems - ctrl.occupiedStrings.length}} new item(s)</label> </div> </fieldset> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel (All)</button> <button type=button class=btn-modal-primary ng-click=ctrl.resolve()>{{ctrl.currentActionName}}</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { Subcodes } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { IErrorResponse } from \"../../error-response\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\n\r\nexport interface IConflictDialogState {\r\n\tconfirmButton: {\r\n\t\ttext: string,\r\n\t\ttype: DialogButtonType,\r\n\t};\r\n\textraInfo: string;\r\n}\r\n\r\nexport class ImportErrorCtrl {\r\n\tpublic information: string;\r\n\tpublic extraInfo: string;\r\n\tpublic confirmButtonDisplayName: string;\r\n\tprivate dialog: IDialog<IErrorResponse>;\r\n\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<IErrorResponse>) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tconst state = this.stateBasedOnSubcode(dialog.parameter.subcode);\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.information = dialog.parameter.message;\r\n\t\tthis.extraInfo = state.extraInfo;\r\n\t\tthis.confirmButtonDisplayName = state.confirmButton.text;\r\n\t}\r\n\r\n\t/**\r\n\t * Depending on the given subcode, this import dialog will have different state\r\n\t *\r\n\t * @private\r\n\t * @param {number} subcode\r\n\t * @returns {IConflictDialogState}\r\n\t *\r\n\t * @memberof ImportConflictCtrl\r\n\t */\r\n\tprivate stateBasedOnSubcode(subcode: number): IConflictDialogState {\r\n\t\tswitch (subcode) {\r\n\t\t\tcase Subcodes.PROJECT_ID_CONFLICT:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tconfirmButton: {\r\n\t\t\t\t\t\ttext: \"Replace\",\r\n\t\t\t\t\t\ttype: DialogButtonType.Yes\r\n\t\t\t\t\t},\r\n\t\t\t\t\textraInfo: \"Would you like to replace that version?\",\r\n\t\t\t\t};\r\n\t\t\tcase Subcodes.PROJECT_DISPLAYNAME_CONFLICT:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tconfirmButton: {\r\n\t\t\t\t\t\ttext: \"Replace\",\r\n\t\t\t\t\t\ttype: DialogButtonType.Yes\r\n\t\t\t\t\t},\r\n\t\t\t\t\textraInfo: \"Would you like to replace the existing App?\",\r\n\t\t\t\t};\r\n\t\t\tdefault:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tconfirmButton: {\r\n\t\t\t\t\t\ttext: \"Confirm\",\r\n\t\t\t\t\t\ttype: DialogButtonType.None\r\n\t\t\t\t\t},\r\n\t\t\t\t\textraInfo: \"\",\r\n\t\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic confirm(): void {\r\n\t\tconst state = this.stateBasedOnSubcode(this.dialog.parameter.subcode);\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tbutton: state.confirmButton.type\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirImportErrorCtrl\", ImportErrorCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\n\r\nexport class ImportProjectCtrl {\r\n\tpublic chosenFile: FileList;\r\n\r\n\tprivate dialog: IDialog<FileList>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<FileList>) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.chosenFile = dialog.parameter;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic import(): void {\r\n\t\tconst result: IDialogResult<FileList> = {\r\n\t\t\tvalue: this.chosenFile,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirImportProjectCtrl\", ImportProjectCtrl);\r\n\t}\r\n}\r\n","import type { IComponentController, IOnInit } from \"angular\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IAboutOptions } from \"common/model/sohoxi/sohoxi-about.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { CommonService } from \"common/services/common-service\";\r\n\r\nexport class LicensesButton implements IComponentController, IOnInit{\r\n\tstatic $inject: string[] = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.COMMON_SERVICE\r\n\t];\r\n\r\n\tappName: string;\r\n\taboutOptions: IAboutOptions;\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate commonService: CommonService\r\n\t) { }\r\n\r\n\t$onInit(): void {\r\n\t\tconst promises: ng.IPromise<string>[] = [\r\n\t\t\tthis.commonService.loadApplicationVersion(),\r\n\t\t\tthis.commonService.loadDBVersions(),\r\n\t\t];\r\n\r\n\t\tthis.$q\r\n\t\t\t.all(promises)\r\n\t\t\t.then(response => {\r\n\t\t\t\tconst version = response[0];\r\n\t\t\t\tconst dbVersion = response[1];\r\n\t\t\t\tconst productName = this.appName.replace(\"Infor \", \"\");\r\n\t\t\t\tconst content = `<p>Form definitions database version ${dbVersion}</p>`;\r\n\r\n\t\t\t\tthis.aboutOptions = {\r\n\t\t\t\t\tappName: this.appName,\r\n\t\t\t\t\tproductName,\r\n\t\t\t\t\tversion,\r\n\t\t\t\t\tuseDefaultCopyright: true,\r\n\t\t\t\t\tcontent\r\n\t\t\t\t};\r\n\t\t\t});\r\n\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirLicensesButton\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tappName: \"@\"\r\n\t\t\t},\r\n\t\t\tcontroller: LicensesButton,\r\n\t\t\tcontrollerAs: \"eirLicenseButtonCtrl\",\r\n\t\t\ttemplate: `\r\n\t\t\t<button class=\"btn about\" id=\"about-dialog\"\r\n\t\t\t\txi-about=\"eirLicenseButtonCtrl.aboutOptions\"\r\n\t\t\t>\r\n\t\t\t\tAbout App Builder\r\n\t\t\t</button>\r\n\t\t\t`\r\n\t\t});\r\n\t}\r\n}\r\n","// TODO: MUPS-2682: Old thing?\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { CommonService } from \"../../services/common-service\";\r\nimport { IDialog } from \"../../services/dialog-service\";\r\n\r\nexport class LicensesDialogCtrl {\r\n\tprivate dialog: IDialog<void>;\r\n\tpublic licensesHtml: String;\r\n\tpublic applicationVersion: String;\r\n\tpublic dbVersions: String;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<void>,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate $sce: any\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.licensesHtml = \"Loading...\";\r\n\t\t/*commonService.loadLicensesHtml().then((licensesHtml: any) => {\r\n\t\t\tthis.licensesHtml = licensesHtml;\r\n\t\t});*/\r\n\r\n\t\tcommonService.loadApplicationVersion().then((applicationVersion: string) => {\r\n\t\t\tthis.applicationVersion = applicationVersion;\r\n\t\t});\r\n\r\n\t\tcommonService.loadDBVersions().then((dbVersions: string) => {\r\n\t\t\tthis.dbVersions = dbVersions;\r\n\t\t});\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm\r\n\t\t\t.controller(\"eirLicensesDialogCtrl\", LicensesDialogCtrl)\r\n\t\t\t.filter(\"sanitize\", [\"$sce\", ($sce: any) => {\r\n\t\t\t\treturn (htmlCode: any) => {\r\n\t\t\t\t\treturn $sce.trustAsHtml(htmlCode);\r\n\t\t\t\t};\r\n\t\t\t}]);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../common/angular-constants\";\r\n\r\nimport { DatagridExportTypes } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"../../common/defines\";\r\nimport { DialogButtonType, IDialogResult } from \"../../common/services/dialog-service\";\r\n\r\nexport interface IDatagridExportResult {\r\n\texportName: string;\r\n\texportType: string;\r\n}\r\n\r\nexport class DatagridExportDialogCtrl {\r\n\tpublic exportType: string;\r\n\tpublic exportName: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<void>,\r\n\t) {\r\n\t\tthis.exportName = \"\";\r\n\t\tthis.exportType = DatagridExportTypes.EXCEL;\r\n\t}\r\n\r\n\tpublic export(): void {\r\n\t\tconst result: IDialogResult<IDatagridExportResult> = {\r\n\t\t\tvalue: {\r\n\t\t\t\texportName: this.exportName,\r\n\t\t\t\texportType: this.exportType,\r\n\t\t\t},\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\r\n\t\tthis.$scope.eirDialog.close(result);\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.$scope.eirDialog.close();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirDatagridExportDialogCtrl\", DatagridExportDialogCtrl);\r\n\t}\r\n}","export class RepeatDoneDirective {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"repeatDone\", () => {\r\n\t\t\treturn (\r\n\t\t\t\tscope: ng.IRepeatScope,\r\n\t\t\t\telement: ng.IAugmentedJQuery,\r\n\t\t\t\tattrs: any\r\n\t\t\t) => {\r\n\t\t\t\tif (scope.$last) {\r\n\t\t\t\t\tscope.$eval(attrs.repeatDone);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"./angular-constants\";\r\n\r\nexport class DragDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\t// http://stackoverflow.com/a/38753647/304894\r\n\t\tconst ngDragEventDirectives: any = {};\r\n\t\tangular.forEach(\r\n\t\t\t\"drag dragend dragenter dragexit dragleave dragover dragstart drop\".split(\r\n\t\t\t\t\" \"\r\n\t\t\t),\r\n\t\t\t(eventName) => {\r\n\t\t\t\tconst directiveName: string =\r\n\t\t\t\t\t\"ng\" + eventName.charAt(0).toUpperCase() + eventName.slice(1);\r\n\r\n\t\t\t\tngDragEventDirectives[directiveName] = [\r\n\t\t\t\t\t\"$parse\",\r\n\t\t\t\t\tAngularConstants.ROOT_SCOPE,\r\n\t\t\t\t\t($parse: ng.IParseService, $rootScope: ng.IRootScopeService) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\trestrict: \"A\",\r\n\t\t\t\t\t\t\tcompile: (\r\n\t\t\t\t\t\t\t\t$element: ng.IRootElementService,\r\n\t\t\t\t\t\t\t\tattr: ng.IAttributes\r\n\t\t\t\t\t\t\t) => {\r\n\t\t\t\t\t\t\t\tconst fn = $parse(attr[directiveName]);\r\n\r\n\t\t\t\t\t\t\t\treturn function ngDragEventHandler(\r\n\t\t\t\t\t\t\t\t\tscope: ng.IScope,\r\n\t\t\t\t\t\t\t\t\telement: ng.IAugmentedJQuery\r\n\t\t\t\t\t\t\t\t): void {\r\n\t\t\t\t\t\t\t\t\telement.on(eventName, (event: JQueryEventObject) => {\r\n\t\t\t\t\t\t\t\t\t\tfn(scope, { $event: event });\r\n\t\t\t\t\t\t\t\t\t\tscope.$digest(); // do digest directly on scope since apply does digest on rootScope\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t},\r\n\t\t\t\t];\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tm.directive(ngDragEventDirectives);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../angular-constants\";\r\nimport { IJQueryScrollEventObject } from \"../defines\";\r\n\r\nexport interface IInfScrollScope extends ng.IScope {\r\n\teirInfiniteScroll: Function;\r\n}\r\n\r\nclass InfiniteScrollCtrl {\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.INTERVAL\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $scope: IInfScrollScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $interval: ng.IIntervalService\r\n\t) {\r\n\t\tthis.initialize();\r\n\t}\r\n\r\n\t// Varibles that potentially will be input variables\r\n\tprivate THROTTLE_MILLISECONDS = 50;\r\n\tprivate loadMore: Function;\r\n\tprivate scrollDistanceThreshold: number = 0.25;\r\n\tprivate bounceDistance: number = 10;\r\n\tprivate EDGE_BOUNCE_INTERVAL_MILLIESECONDS = 50;\r\n\r\n\t// State variables\r\n\tprivate lastScrollTop: number = 0;\r\n\tprivate edgeBounceInterval: {\r\n\t\tup: ng.IPromise<void> | null;\r\n\t\tdown: ng.IPromise<void> | null;\r\n\t} = { up: null, down: null };\r\n\r\n\tprivate initialize(): void {\r\n\t\tconst scope = this.$scope;\r\n\t\tconst element = this.$element;\r\n\t\tthis.loadMore = scope.eirInfiniteScroll;\r\n\t\tscope.$watch(\"eirInfiniteScrollEnabled\", (scrollEnabled) => {\r\n\t\t\tif (scrollEnabled) {\r\n\t\t\t\telement.on(\"scroll\", this.throttle(this.handler, this.THROTTLE_MILLISECONDS));\r\n\t\t\t} else {\r\n\t\t\t\telement.off(\"scroll\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tscope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\telement.off(\"scroll\");\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handler(evt: IJQueryScrollEventObject): void {\r\n\t\tconst target = evt.currentTarget;\r\n\t\tconst scrollingDown: boolean = (this.lastScrollTop < target.scrollTop);\r\n\t\tconst scrollingUp: boolean = (this.lastScrollTop > target.scrollTop);\r\n\t\tthis.lastScrollTop = target.scrollTop;\r\n\r\n\t\tif (scrollingDown) {\r\n\t\t\tconst distanceFromBottom = target.scrollHeight - (target.offsetHeight + target.scrollTop);\r\n\t\t\tconst closeEnoughToBottom = distanceFromBottom < (target.offsetHeight * this.scrollDistanceThreshold);\r\n\t\t\tif (closeEnoughToBottom) {\r\n\t\t\t\tthis.loadMore({ scrollingDown });\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t}\r\n\t\t\tif (distanceFromBottom <= 0) {\r\n\t\t\t\ttarget.scrollTop -= this.bounceDistance;\r\n\t\t\t}\r\n\t\t} else if (scrollingUp) {\r\n\t\t\tconst distanceFromTop = target.scrollTop;\r\n\t\t\tconst closeEnoughToTop = distanceFromTop < (target.offsetHeight * this.scrollDistanceThreshold);\r\n\t\t\tif (closeEnoughToTop) {\r\n\t\t\t\tthis.loadMore({ scrollingDown });\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t}\r\n\t\t\tif (distanceFromTop <= 0) {\r\n\t\t\t\ttarget.scrollTop += this.bounceDistance;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.bounceEdges(evt);\r\n\t}\r\n\r\n\t// Make sure that it always bounds when reaching edges.\r\n\t// This can happen in the rare case of user manually scrolling in scrollbar\r\n\tprivate bounceEdges(evt: IJQueryScrollEventObject): void {\r\n\t\tconst target = evt.currentTarget;\r\n\t\tconst distanceFromBottom = target.scrollHeight - (target.offsetHeight + target.scrollTop);\r\n\t\tconst distanceFromTop = target.scrollTop;\r\n\r\n\t\tif (this.edgeBounceInterval.up) {\r\n\t\t\tthis.$interval.cancel(this.edgeBounceInterval.up);\r\n\t\t\tthis.edgeBounceInterval.up = null;\r\n\t\t}\r\n\t\tif (this.edgeBounceInterval.down) {\r\n\t\t\tthis.$interval.cancel(this.edgeBounceInterval.down);\r\n\t\t\tthis.edgeBounceInterval.down = null;\r\n\t\t}\r\n\r\n\t\tif (distanceFromBottom <= 0) {\r\n\t\t\tthis.edgeBounceInterval.up = this.$interval(() => {\r\n\t\t\t\tif (distanceFromBottom <= 0) {\r\n\t\t\t\t\ttarget.scrollTop -= this.bounceDistance;\r\n\t\t\t\t}\r\n\t\t\t}, this.EDGE_BOUNCE_INTERVAL_MILLIESECONDS);\r\n\t\t}\r\n\t\tif (distanceFromTop <= 0) {\r\n\t\t\tthis.edgeBounceInterval.down = this.$interval(() => {\r\n\t\t\t\tif (distanceFromTop <= 0) {\r\n\t\t\t\t\ttarget.scrollTop += this.bounceDistance;\r\n\t\t\t\t}\r\n\t\t\t}, this.EDGE_BOUNCE_INTERVAL_MILLIESECONDS);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate throttle(\r\n\t\tfunc: (e: IJQueryScrollEventObject) => void,\r\n\t\twait: number\r\n\t): (e: IJQueryScrollEventObject) => void {\r\n\t\tlet timeout: ng.IPromise<void> = null;\r\n\t\tlet previous = 0;\r\n\r\n\t\tconst later = (event: IJQueryScrollEventObject) => {\r\n\t\t\tprevious = new Date().getTime();\r\n\t\t\tthis.$timeout.cancel(timeout);\r\n\t\t\ttimeout = null;\r\n\t\t\treturn func.call(this, event);\r\n\t\t};\r\n\r\n\t\tconst throttled = (event: IJQueryScrollEventObject) => {\r\n\t\t\tconst now = new Date().getTime();\r\n\t\t\tconst remaining = wait - (now - previous);\r\n\t\t\tif (remaining <= 0) {\r\n\t\t\t\tthis.$timeout.cancel(timeout);\r\n\t\t\t\ttimeout = null;\r\n\t\t\t\tprevious = now;\r\n\t\t\t\tfunc.call(this, event);\r\n\t\t\t} else {\r\n\t\t\t\tthis.$timeout.cancel(timeout);\r\n\t\t\t\ttimeout = this.$timeout(later, remaining, false, event);\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn throttled;\r\n\t}\r\n}\r\n\r\nexport class InfiniteScrollDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = {\r\n\t\teirInfiniteScroll: \"&\",\r\n\t\teirInfiniteScrollEnabled: \"=\"\r\n\t};\r\n\r\n\tpublic controller = InfiniteScrollCtrl;\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = () => {\r\n\t\t\treturn new InfiniteScrollDirective();\r\n\t\t};\r\n\t\tm.directive(\"eirInfiniteScroll\", directive);\r\n\t}\r\n}\r\n","import { Helper } from \"./helper\";\r\n\r\nimport { Config, InjectNames, MGPlatform, Numbers } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IEnvironmentSettings } from \"ng2/common/model/environment-settings.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { Debugger } from \"common/debugger\";\r\nimport { WSUserControl } from \"etc-assets/user-control-es\";\r\n\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\n\r\ninterface IInitializeScope extends ng.IScope {\r\n\tdone: boolean;\r\n\tisLoading: boolean;\r\n}\r\n\r\nclass InitializeCtrl {\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.INTERVAL,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IInitializeScope,\r\n\t\tprivate $interval: ng.IIntervalService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate languageService: LanguageService\r\n\t) {\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tthis.loadEnvironmentSettings();\r\n\t\t}\r\n\t\tWSUserControl.onReady(() => {\r\n\t\t\tthis.loadEnvironmentSettings();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate loadEnvironmentSettings(): void {\r\n\t\tthis.commonService.loadEnvironmentSettings()\r\n\t\t\t.then((settings: IEnvironmentSettings) => {\r\n\t\t\t\tConfig.IS_DEV = settings.isDevelopment;\r\n\t\t\t\tConfig.ION_API_URL = settings.url;\r\n\t\t\t\tConfig.MAX_PROJECTS = settings.maxProjects;\r\n\t\t\t\tConfig.MAX_APPS = settings.maxApps;\r\n\t\t\t\tConfig.MAX_COMPOSITES = settings.maxComposites;\r\n\t\t\t\tConfig.MAX_DATASOURCES = settings.maxDatasources;\r\n\t\t\t\tConfig.LOCALE = settings.locale;\r\n\t\t\t\tConfig.TENANT_ID = settings.tenantId;\r\n\t\t\t\tConfig.USER = settings.user;\r\n\t\t\t\tConfig.MG_FORM_NAME = settings.mgFormName;\r\n\t\t\t\tConfig.MG_FORM_ONLY = settings.mgFormOnly;\r\n\t\t\t\tConfig.MG_PLATFORM = settings.mgPlatform;\r\n\t\t\t\tConfig.MG_CONFIG_NAME = settings.mgConfigName;\r\n\t\t\t\tConfig.MG_HELP_BASE_URL = settings.mgHelpBaseUrl;\r\n\t\t\t\tDebugger.initialize();\r\n\t\t\t\tthis.$scope.done = Config.IS_CONFIG_LOADED = true;\r\n\t\t\t})\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.languageService.initializeLanguageSettings();\r\n\t\t\t\tthis.setBaseBuilder();\r\n\t\t\t})\r\n\t\t\t.then(() => {\r\n\t\t\t\tconst stop = this.$interval(() => {\r\n\t\t\t\t\tif (!Config.IS_FIRST_LOAD) {\r\n\t\t\t\t\t\tthis.$scope.isLoading = Config.IS_FIRST_LOAD;\r\n\t\t\t\t\t\tthis.$interval.cancel(stop);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, Numbers.HUNDRED);\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate setBaseBuilder(): void {\r\n\t\tconst url = Config.MG_PLATFORM === MGPlatform.WEB || DEV_SERVER ?\r\n\t\t\twindow.parent.location.search.substring(1) :\r\n\t\t\twindow.location.search.substring(1);\r\n\r\n\t\tconst query = Helper.parseQueryString(url);\r\n\t\tif (query.basebuilder) {\r\n\t\t\tConfig.IS_BASE_BUILDER = true;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class InitializeDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirInitialize\", () => {\r\n\t\t\treturn {\r\n\t\t\t\trestrict: \"A\",\r\n\t\t\t\tscope: {\r\n\t\t\t\t\tdone: \"=eirInitialize\",\r\n\t\t\t\t\tisLoading: \"=\"\r\n\t\t\t\t},\r\n\t\t\t\tcontroller: InitializeCtrl,\r\n\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { Helper } from \"../../helper\";\r\nimport { FieldValidation } from \"../base/field-validation\";\r\n\r\nexport class DropdownFieldCtrl extends FieldValidation {\r\n\r\n\tpublic $static = [\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.SCOPE,\r\n\t];\r\n\r\n\t// Bindings\r\n\tpublic listValues: string[];\r\n\tpublic onChange: Function;\r\n\r\n\tconstructor(\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$scope: ng.IScope,\r\n\t) {\r\n\t\tsuper();\r\n\r\n\t\t$element\r\n\t\t\t.on(\"listclosed\", () => {\r\n\t\t\t\tif (!Helper.isUndefined(this.validation)) {\r\n\t\t\t\t\tthis.validate();\r\n\r\n\t\t\t\t\t// needs to trigger Angular digest cycle\r\n\t\t\t\t\t$scope.$applyAsync();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.on(\"change\", () => {\r\n\t\t\t\tif (this.onChange) {\r\n\t\t\t\t\tthis.onChange();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\nexport class DropdownFieldComponent implements ng.IComponentOptions {\r\n\tpublic controller = DropdownFieldCtrl;\r\n\tpublic template = require(\"./dropdown-template.html\");\r\n\tpublic bindings: IMap<string> = {\r\n\t\tid: \"@?\",\r\n\t\tlabelName: \"@?\",\r\n\t\tfieldValue: \"=\",\r\n\t\tvalidation: \"<?\",\r\n\t\treadonly: \"<?\",\r\n\t\tlistValues: \"<\",\r\n\t\tonChange: \"&?\"\r\n\t};\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\r\n\t\t\t\"eirDropdownFieldComponent\",\r\n\t\t\tnew DropdownFieldComponent());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-if=\\\"$ctrl.validation !== undefined\\\" class=dropdown-field> <label for=dropdown-field-component ng-class=\\\"{ required : $ctrl.isRequired }\\\" ng-if=\\\"$ctrl.labelName !== undefined\\\"> {{ $ctrl.labelName }} </label> <select id=ido-project-select class=\\\"dropdown-field-component dropdown-lg\\\" ng-model=$ctrl.fieldValue ng-options=\\\"item for item in $ctrl.listValues\\\" xi-drop-down></select> <div ng-repeat=\\\"validatorError in $ctrl.fieldSpecificErrors\\\" ng-style=\\\"{ 'display': $ctrl.displayStatus }\\\" class=error-message> <svg class=\\\"icon-error icon\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-error></use> </svg> <pre class=audible>Error</pre> <p class=message-text>{{ validatorError.message }}</p> </div> </div> <div ng-if=\\\"$ctrl.validation === undefined\\\"> <label for=dropdown-field-component>{{ $ctrl.labelName }}</label> <select id=ido-project-select class=\\\"dropdown-field-component dropdown-lg\\\" ng-model=$ctrl.fieldValue ng-options=\\\"item for item in $ctrl.listValues\\\" xi-drop-down></select> </div> \";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { FilterPopupmenuCtrl } from \"./filter-popupmenu-ctrl\";\r\n\r\nexport class FilterPopupmenuComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tfilterOptions: \"<\",\r\n\t\t\tfilterValues: \"=\",\r\n\t\t\tlocalPrefix: \"<\"\r\n\t\t};\r\n\r\n\t\tthis.controller = [\r\n\t\t\tAngularConstants.FILTER,\r\n\t\t\tFilterPopupmenuCtrl\r\n\t\t];\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./filter-popupmenu-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirFilterPopupmenuComponent\", new FilterPopupmenuComponent());\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nexport class FilterPopupmenuCtrl<T> {\r\n\r\n\t// component bindings\r\n\tpublic filterOptions: IDataPair[];\r\n\tpublic localPrefix: string;\r\n\tpublic filterValues: T[];\r\n\r\n\tprivate originalValues: T[];\r\n\tprivate previousFilterValues: T[];\r\n\tprivate currentSelectedFilter: IDataPair;\r\n\tprivate readonly filterOn = \"filter-on\";\r\n\r\n\tprivate orderBy: ng.IFilterOrderBy = this.$filter(\"orderBy\");\r\n\tprivate filter: ng.IFilterFilter = this.$filter(\"filter\");\r\n\r\n\t$inject = [\r\n\t\tAngularConstants.FILTER\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $filter: ng.IFilterService\r\n\t) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\tconst storageName = this.localPrefix + this.filterOn;\r\n\t\tconst storedFilter: IDataPair = JSON.parse(localStorage.getItem(storageName));\r\n\t\tthis.originalValues = angular.copy(this.filterValues);\r\n\r\n\t\tif (!storedFilter) {\r\n\t\t\tconst filterOption = this.filterOptions[0];\r\n\t\t\tlocalStorage.setItem(storageName, JSON.stringify(filterOption));\r\n\t\t\tthis.currentSelectedFilter = filterOption;\r\n\t\t} else {\r\n\t\t\tthis.currentSelectedFilter =\r\n\t\t\t\tthis.filterOptions.find(x => x.name === storedFilter.name);\r\n\t\t}\r\n\r\n\t\tthis.doFilter();\r\n\t}\r\n\r\n\tpublic $doCheck(): void {\r\n\t\tconst previousValues = this.previousFilterValues;\r\n\t\tconst currentValues = this.filterValues;\r\n\r\n\t\tif (previousValues.length !== currentValues.length ||\r\n\t\t\tthis.equalLengthsNotSameContent(previousValues, currentValues)\r\n\t\t) {\r\n\t\t\tthis.originalValues = angular.copy(currentValues);\r\n\t\t\tthis.doFilter();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onFilter(filterOption: IDataPair): void {\r\n\t\tconst storageName = this.localPrefix + this.filterOn;\r\n\r\n\t\tthis.currentSelectedFilter = angular.copy(filterOption);\r\n\t\tlocalStorage.setItem(storageName, JSON.stringify({ name: filterOption.name }));\r\n\r\n\t\tthis.doFilter();\r\n\t}\r\n\r\n\tprivate doFilter(): void {\r\n\t\tconst currentSelectedFilter = this.currentSelectedFilter.value;\r\n\r\n\t\tif (currentSelectedFilter) {\r\n\t\t\tthis.filterValues = this.filter(this.originalValues, currentSelectedFilter);\r\n\t\t} else {\r\n\t\t\tthis.filterValues = this.originalValues;\r\n\t\t}\r\n\t\tthis.previousFilterValues = this.filterValues;\r\n\t}\r\n\r\n\tprivate equalLengthsNotSameContent(listA: T[], listB: T[]): boolean {\r\n\t\treturn (listA.length === listB.length &&\r\n\t\t\t!angular.equals(\r\n\t\t\t\tthis.orderBy(listA, \"manifest.createdTime\"),\r\n\t\t\t\tthis.orderBy(listB, \"manifest.createdTime\")));\r\n\t}\r\n\r\n}\r\n","// Module\nvar code = \"<button type=button id=buttonFilterBy class=btn-menu xi-popupmenu> <span>{{ ctrl.currentSelectedFilter.name }}</span> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-dropdown></use> </svg> </button> <ul class=popupmenu> <li ng-repeat=\\\"filterOption in ctrl.filterOptions track by filterOption.name\\\" ng-click=ctrl.onFilter(filterOption)> <a>{{filterOption.name}}</a> </li> </ul>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { FilterTagCtrl } from \"./filter-tag-ctrl\";\r\n\r\nexport class FilterTagComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tfilterValues: \"=\",\r\n\t\t\tlocalPrefix: \"<\"\r\n\t\t};\r\n\r\n\t\tthis.controller = [\r\n\t\t\tAngularConstants.FILTER,\r\n\t\t\tInjectNames.TAG_SERVICE,\r\n\t\t\tFilterTagCtrl\r\n\t\t];\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./filter-tag-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirFilterTagComponent\", new FilterTagComponent());\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { IProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nimport { TagService } from \"../../services/tag-service\";\r\n\r\nexport class FilterTagCtrl<T> {\r\n\r\n\tpublic selectedTags: IJsonTag[] = [];\r\n\tpublic currentTag: IJsonTag = {\r\n\t\tid: \"select\",\r\n\t\tname: \"All\"\r\n\t};\r\n\tpublic filterValues: IProjectInfo[];\r\n\tpublic filterOptions: IJsonTag[] = [];\r\n\r\n\tprivate originalValues: IProjectInfo[];\r\n\tprivate previousFilterValues: IProjectInfo[];\r\n\tprivate unsubscribers: Function[] = [];\r\n\r\n\tprivate filter: ng.IFilterFilter = this.$filter(\"filter\");\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.FILTER,\r\n\t\tInjectNames.TAG_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $filter: ng.IFilterService,\r\n\t\tprivate tagService: TagService\r\n\t) {\r\n\t\tthis.unsubscribers.push(tagService.projectInfoChangedEvent.on((projects) => {\r\n\t\t\tthis.updateValues(projects);\r\n\t\t\tthis.doFilter();\r\n\t\t}));\r\n\t\tthis.getAvailableTags();\r\n\t}\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.originalValues = angular.copy(this.filterValues);\r\n\t\tthis.doFilter();\r\n\t}\r\n\r\n\tprivate doFilter(): void {\r\n\t\tif (this.selectedTags.length > 0) {\r\n\t\t\tthis.filterValues = this.filter(this.originalValues,\r\n\t\t\t\t(projectItem: IProjectInfo) => {\r\n\t\t\t\t\treturn this.filterProject(projectItem);\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.filterValues = angular.copy(this.originalValues);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addTag(): void {\r\n\t\tconst alreadyExists = this.selectedTags.some((tag) => {\r\n\t\t\treturn tag.id === this.currentTag.id;\r\n\t\t});\r\n\t\tif (!alreadyExists && this.currentTag.id !== \"select\") {\r\n\t\t\tthis.selectedTags.push(this.currentTag);\r\n\t\t\tthis.doFilter();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic deleteTag(tag: IJsonTag): void {\r\n\t\tconst selectedTags = angular.copy(this.selectedTags);\r\n\t\tthis.selectedTags = selectedTags.filter((selectedTag) => {\r\n\t\t\treturn tag.id !== selectedTag.id;\r\n\t\t});\r\n\t\tthis.doFilter();\r\n\t}\r\n\r\n\tprivate filterProject(project: IProjectInfo): boolean {\r\n\t\treturn this.selectedTags.some((selectedTag) => {\r\n\t\t\treturn project.tags.some((projectTag) => {\r\n\t\t\t\treturn projectTag.name === selectedTag.name;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateValues(projects: IProjectInfo[]): void {\r\n\t\t// Update original values with new setting data\r\n\t\t// TODO: refactor to more isolated method\r\n\t\tconst originalValues = angular.copy(this.originalValues);\r\n\t\toriginalValues.forEach((originalProject, index) => {\r\n\t\t\tprojects.forEach((currentProject) => {\r\n\t\t\t\tif (originalProject.manifest.id === currentProject.manifest.id) {\r\n\t\t\t\t\tthis.originalValues[index] = currentProject;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.getAvailableTags();\r\n\t}\r\n\r\n\tprivate getAvailableTags(): void {\r\n\t\tthis.filterOptions = [this.currentTag];\r\n\t\tthis.tagService.getAvailableTags().then((tags) => {\r\n\t\t\tthis.filterOptions.push(...tags);\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"with-button filter-tag\\\"> <div class=tag-container> <a class=\\\"tag is-dismissable\\\" ng-repeat=\\\"tag in ctrl.selectedTags track by tag.id\\\">{{tag.name}} <span class=dismissable-btn ng-click=ctrl.deleteTag(tag)> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-close></use> </svg> <span class=audible>Close</span> </span> </a> </div> <select id=tagSetting class=dropdown ng-model=ctrl.currentTag ng-options=\\\"tag.name for tag in ctrl.filterOptions track by tag.id\\\" xi-drop-down=ctrl.filterOptions> </select> <button class=btn-icon xi-tooltip=\\\"'Add tag'\\\" ng-click=ctrl.addTag()> <svg class=icon focusable=false> <use xlink:href=#icon-add></use> </svg> <span class=audible>Add</span> </button> </div>\";\n// Exports\nmodule.exports = code;","import { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\n\r\nexport class FilterToolbarComponent {\r\n\r\n\t// component bindings\r\n\tpublic filterTarget: IDesignerManifest[];\r\n\tpublic filterTypeOptions: IDataPair[];\r\n\tpublic sortPropertiesOptions: IDataPair[];\r\n\tpublic localPrefix: string;\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirFilterToolbarComponent\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tfilterTypeOptions: \"<\",\r\n\t\t\t\tsortPropertiesOptions: \"<\",\r\n\t\t\t\tfilterTarget: \"=\",\r\n\t\t\t\tlocalPrefix: \"@\"\r\n\t\t\t},\r\n\t\t\tcontroller: FilterToolbarComponent,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t\ttemplate: require(\"./filter-toolbar.html\"),\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=sort-container> <eir-filter-popupmenu-component filter-options=ctrl.filterTypeOptions filter-values=ctrl.filterTarget local-prefix=::ctrl.localPrefix> </eir-filter-popupmenu-component> <eir-sort-popupmenu-component sort-options=ctrl.sortPropertiesOptions sort-values=ctrl.filterTarget local-prefix=::ctrl.localPrefix> </eir-sort-popupmenu-component> <eir-filter-tag-component filter-values=ctrl.filterTarget> </eir-filter-tag-component> </div>\";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { FieldValidation } from \"../base/field-validation\";\r\nimport { ISharedStyling } from \"../base/shared-styling\";\r\n\r\nexport class InputFieldCtrl\r\n\textends FieldValidation\r\n\timplements ISharedStyling {\r\n\tpublic readonly: boolean = false;\r\n}\r\n\r\nexport class InputFieldComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tid: \"@?\",\r\n\t\t\tlabelName: \"@?\",\r\n\t\t\tfieldValue: \"=\",\r\n\t\t\tfieldName: \"@?\",\r\n\t\t\tvalidation: \"<?\",\r\n\t\t\trequired: \"@?\",\t// mark field as required\r\n\t\t\treadonly: \"<?\",\t// readonly field\r\n\r\n\t\t\tonComponentChange: \"&?\",\r\n\t\t\tparentAnnounce: \"<?\"\r\n\t\t};\r\n\r\n\t\tthis.controller = InputFieldCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./input-field-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirInputFieldComponent\", new InputFieldComponent());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=component-base> <div ng-if=\\\"ctrl.validation !== undefined\\\"> <label for=input-field-component ng-class=\\\"{ required : ctrl.isRequired }\\\" ng-if=\\\"ctrl.labelName !== undefined\\\"> {{ ctrl.labelName }} </label> <input class=input-field-component type=text name={{ctrl.fieldName}} ng-model=ctrl.fieldValue ng-model-options=\\\"{ debounce: 100 }\\\" ng-change=ctrl.validate() ng-readonly=ctrl.readonly ng-blur=ctrl.validate() /> <div class=error-message> <div class=error-text ng-repeat=\\\"validatorError in ctrl.fieldSpecificErrors\\\" ng-show=\\\"ctrl.displayStatus === 'none' ? false : true\\\"> <svg class=\\\"icon-error icon\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-error></use> </svg> <pre class=audible>Error</pre> <p class=message-text>{{ validatorError.message }}</p> </div> </div> </div> <div ng-if=\\\"ctrl.validation === undefined\\\"> <label for=input-field-component>{{ ctrl.labelName }}</label> <input class=input-field-component type=text aria-required=true class=input-lg ng-model=ctrl.fieldValue ng-readonly=ctrl.readonly /> </div> </div> \";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { PaginatorCtrl } from \"./paginator-ctrl\";\r\n\r\nexport class PaginatorComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tpagingValues: \"<\",\r\n\t\t\tcurrentPage: \"=\",\r\n\t\t};\r\n\r\n\t\tthis.controller = PaginatorCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./paginator-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirPaginator\", new PaginatorComponent());\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IPagerApi, IPageRequest, IPagerInfo } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nexport interface IPaginatorChangesObject<T> {\r\n\tpagingValues: ng.IChangesObject<T>;\r\n}\r\n\r\nexport class PaginatorCtrl<T> {\r\n\tpublic pagingValues: T[];\r\n\tprivate currentPage: T[];\r\n\tprivate pages: T[][];\r\n\tprivate pagerOptions: IPagerInfo;\r\n\tprivate pageNumber: number;\r\n\tprivate static pagesize = 16;\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery\r\n\t) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\t// tslint:disable-next-line:no-magic-numbers\r\n\t\tconst pagesizes = [16, 28, 48, 76];\r\n\t\tthis.createPages(PaginatorCtrl.pagesize);\r\n\r\n\t\tthis.pagerOptions = {\r\n\t\t\ttype: \"standalone\",\r\n\t\t\tpagesize: PaginatorCtrl.pagesize,\r\n\t\t\tpageSizeSelectorText: \"{0} Projects per page\",\r\n\t\t\tpagesizes: pagesizes,\r\n\t\t\tshowPageSizeSelector: true,\r\n\t\t\tshowFirstButton: true,\r\n\t\t\tenableFirstButton: false,\r\n\t\t\tshowPreviousButton: true,\r\n\t\t\tenablePreviousButton: false,\r\n\t\t\tshowNextButton: true,\r\n\t\t\tenableNextButton: true,\r\n\t\t\tshowLastButton: true,\r\n\t\t\tenableLastButton: true,\r\n\t\t\tonFirstPage: (_elem: any, _args: IPageRequest) => {\r\n\t\t\t\tthis.resetCurrentPage();\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t\tonPreviousPage: (_elem: any, _args: IPageRequest) => {\r\n\t\t\t\t--this.pageNumber;\r\n\t\t\t\tthis.previousPage(this.pageNumber);\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t\tonNextPage: (_elem: any, _args: IPageRequest) => {\r\n\t\t\t\t++this.pageNumber;\r\n\t\t\t\tthis.nextPage(this.pageNumber);\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t\tonLastPage: (_elem: any, _args: IPageRequest) => {\r\n\t\t\t\tthis.pageNumber = this.pages.length - 1;\r\n\t\t\t\tthis.currentPage = this.pages[this.pageNumber];\r\n\t\t\t\tthis.updateButtons(false, false, true, true);\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t\tonPageSizeChange: (_elem: any, args: IPageRequest) => {\r\n\t\t\t\tthis.createPages(args.pagesize);\r\n\t\t\t\tthis.resetCurrentPage();\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t};\r\n\t\tthis.getPagerElement().pager(this.pagerOptions).data(\"pager\");\r\n\t\tthis.resetCurrentPage();\r\n\t}\r\n\r\n\tpublic $onChanges(value: IPaginatorChangesObject<T[]>): void {\r\n\t\tconst currentList = value.pagingValues.currentValue;\r\n\t\tconst previousList = value.pagingValues.previousValue;\r\n\t\tif (previousList.length && (currentList !== previousList)) {\r\n\t\t\tthis.pagingValues = value.pagingValues.currentValue;\r\n\t\t\tthis.createPages(PaginatorCtrl.pagesize);\r\n\t\t\tthis.resetCurrentPage();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic nextPage(page: number): void {\r\n\t\tthis.currentPage = this.pages[page];\r\n\t\tif (page === (this.pages.length - 1)) {\r\n\t\t\tthis.updateButtons(false, false, true, true);\r\n\t\t} else {\r\n\t\t\tthis.updateButtons(true, true, true, true);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic previousPage(page: number): void {\r\n\t\tthis.currentPage = this.pages[page];\r\n\t\tif (page === 0) {\r\n\t\t\tthis.updateButtons(true, true, false, false);\r\n\t\t} else {\r\n\t\t\tthis.updateButtons(true, true, true, true);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate createPages(pagesize: number): void {\r\n\t\tthis.pages = [];\r\n\t\tconst pagingTarget = angular.copy(this.pagingValues);\r\n\r\n\t\tfor (let pageIndex = 0; pagingTarget.length !== 0; pageIndex++) {\r\n\t\t\tconst page = pagingTarget.splice(0, pagesize);\r\n\t\t\tthis.pages.push(page);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getPagerElement(): any {\r\n\t\treturn this.$element.find(\".pager-container\");\r\n\t}\r\n\r\n\tprivate getPagerApi(): IPagerApi {\r\n\t\treturn this.getPagerElement().data(\"pager\");\r\n\t}\r\n\r\n\tprivate resetCurrentPage(): void {\r\n\t\tthis.pageNumber = 0;\r\n\t\tthis.currentPage = this.pages[this.pageNumber];\r\n\t\tif (this.pages.length > 1) {\r\n\t\t\tthis.updateButtons(true, true, false, false);\r\n\t\t} else {\r\n\t\t\tthis.updateButtons(false, false, false, false);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateButtons(last: boolean, next: boolean, first: boolean, previous: boolean): void {\r\n\t\tthis.getPagerApi().updated({\r\n\t\t\tenableLastButton: last,\r\n\t\t\tenableNextButton: next,\r\n\t\t\tenableFirstButton: first,\r\n\t\t\tenablePreviousButton: previous\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=pager-container></div>\";\n// Exports\nmodule.exports = code;","import { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\nimport * as xi from \"../../model/sohoxi/sohoxi-tooltip.model\";\r\n\r\nexport class ProjectTagsComponent {\r\n\tpublic tags: IJsonTag[];\r\n\tpublic tagsOverflowed = false;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.ELEMENT,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $element: ng.IAugmentedJQuery\r\n\t) { }\r\n\r\n\tpublic checkOverflow(): void {\r\n\t\t//Timeout needed for getting the correct tag names instead of variable names.\r\n\t\tthis.$timeout(() => {\r\n\t\t\tconst tagContainerElement = this.$element.find(\".tag-container\")[0];\r\n\t\t\tconst overflowed = tagContainerElement.offsetHeight < tagContainerElement.scrollHeight;\r\n\t\t\tif (overflowed) {\r\n\t\t\t\tthis.tagsOverflowed = true;\r\n\t\t\t}\r\n\t\t}, 1);\r\n\t}\r\n\r\n\tpublic moreTagInit(): void {\r\n\t\tconst popoverOptions: xi.ITooltipOptions = {\r\n\t\t\tpopover: true,\r\n\t\t\tcontent: this.$element.find(\"#popover-contents\"),\r\n\t\t\tplacement: \"bottom\",\r\n\t\t\ttitle: \"Tags\",\r\n\t\t\textraClass: \"alternate\"\r\n\t\t};\r\n\r\n\t\tthis.$element.find(\"#popover-trigger\").popover(popoverOptions);\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirProjectTags\", {\r\n\t\t\tbindings: {\r\n\t\t\t\ttags: \"<\"\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./project-tags-component.html\"),\r\n\t\t\tcontroller: ProjectTagsComponent,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=tag-field> <div class=\\\"tag-container tag-list\\\"> <span class=tag ng-repeat=\\\"tag in ctrl.tags\\\" repeat-done=ctrl.checkOverflow()> {{tag.name}} </span> </div> <span class=\\\"more-tag tag is-clickable\\\" id=popover-trigger ng-init=ctrl.moreTagInit() ng-if=ctrl.tagsOverflowed>...</span> </div> <div id=popover-contents class=hidden> <div class=\\\"tag-list popover-tags\\\"> <span class=\\\"pop-tag hide-focus\\\" ng-repeat=\\\"tag in ctrl.tags\\\"> {{tag.name}} </span> </div> </div>\";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\nimport { SortPopupmenuCtrl } from \"./sort-popupmenu-ctrl\";\r\n\r\nexport class SortPopupmenuComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tsortOptions: \"<\",\r\n\t\t\tsortValues: \"=\",\r\n\t\t\tlocalPrefix: \"<\"\r\n\t\t};\r\n\r\n\t\tthis.controller = [\r\n\t\t\tAngularConstants.FILTER,\r\n\t\t\tSortPopupmenuCtrl\r\n\t\t];\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./sort-popupmenu-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirSortPopupmenuComponent\", new SortPopupmenuComponent());\r\n\t}\r\n}\r\n","import { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nenum OrderEnum {\r\n\tASCENDING = \"\",\r\n\tDESCENDING = \"-\"\r\n}\r\n\r\nexport class SortPopupmenuCtrl {\r\n\r\n\t// component bindings\r\n\tpublic sortOptions: IDataPair[];\r\n\tpublic bindingSortValues: any[];\r\n\tpublic localPrefix: string;\r\n\r\n\tpublic get sortValues(): any[] {\r\n\t\treturn this.bindingSortValues;\r\n\t}\r\n\tpublic set sortValues(value: any[]) {\r\n\t\tthis.bindingSortValues = value;\r\n\t\tif (value && this.currentSelected && this.currentSelectedSortOrder) {\r\n\t\t\tthis.doSort();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic sortOrderTypes: IDataPair[] = [\r\n\t\t{ name: \"Ascending\", value: 0 },\r\n\t\t{ name: \"Descending\", value: 1 }\r\n\t];\r\n\r\n\tpublic currentSelected: IDataPair;\r\n\tpublic currentSelectedSortOrder: IDataPair;\r\n\r\n\tprivate readonly sortOn = \"sort-on\";\r\n\tprivate readonly sortOrder = \"sort-order\";\r\n\r\n\t$inject = [\r\n\t\tAngularConstants.FILTER\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $filter: ng.IFilterService\r\n\t) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\tconst sortOn = JSON.parse(localStorage.getItem(this.localPrefix + this.sortOn));\r\n\t\tconst sortOrder = JSON.parse(localStorage.getItem(this.localPrefix + this.sortOrder));\r\n\r\n\t\tif (!sortOn || !sortOrder) {\r\n\t\t\tconst sortOption = this.sortOptions[0];\r\n\t\t\tconst sortOrder = this.sortOrderTypes[1];\r\n\r\n\t\t\tlocalStorage.setItem(this.localPrefix + this.sortOn, JSON.stringify(sortOption));\r\n\t\t\tlocalStorage.setItem(this.localPrefix + this.sortOrder, JSON.stringify(sortOrder));\r\n\t\t\tthis.currentSelected = sortOption;\r\n\t\t\tthis.currentSelectedSortOrder = sortOrder;\r\n\t\t} else {\r\n\t\t\tthis.currentSelected = sortOn;\r\n\t\t\tthis.currentSelectedSortOrder = sortOrder;\r\n\t\t}\r\n\t\tthis.doSort();\r\n\t}\r\n\r\n\tpublic onSort(sortOption: IDataPair): void {\r\n\t\tthis.currentSelected = sortOption;\r\n\t\tlocalStorage.setItem(this.localPrefix + this.sortOn, JSON.stringify(sortOption));\r\n\r\n\t\tthis.doSort();\r\n\t}\r\n\r\n\tpublic onSortOrder(sortOrder: IDataPair): void {\r\n\t\tthis.currentSelectedSortOrder = sortOrder;\r\n\t\tlocalStorage.setItem(this.localPrefix + this.sortOrder, JSON.stringify(sortOrder));\r\n\r\n\t\tthis.doSort();\r\n\t}\r\n\r\n\tprivate doSort(): void {\r\n\t\tconst orderBy = this.currentSelectedSortOrder.value ?\r\n\t\t\tOrderEnum.DESCENDING : OrderEnum.ASCENDING;\r\n\r\n\t\tthis.bindingSortValues = this.$filter(\"orderBy\")(\r\n\t\t\tthis.bindingSortValues, `${orderBy}(${this.currentSelected.value})`);\r\n\t}\r\n\r\n}\r\n","// Module\nvar code = \"<button type=button id=buttonSort class=btn-menu xi-popupmenu> <span>By {{ ctrl.currentSelected.name }}</span> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-dropdown></use> </svg> </button> <ul class=popupmenu> <li ng-repeat=\\\"sortOption in ctrl.sortOptions track by sortOption.name\\\" ng-click=ctrl.onSort(sortOption)> <a>{{sortOption.name}}</a> </li> </ul> <button type=button id=buttonSortOrder class=btn-menu xi-popupmenu> <span>In {{ctrl.currentSelectedSortOrder.name }} Order</span> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-dropdown></use> </svg> </button> <ul class=popupmenu> <li ng-repeat=\\\"sortOrder in ctrl.sortOrderTypes track by sortOrder.name\\\" ng-click=ctrl.onSortOrder(sortOrder)> <a>{{ sortOrder.name }}</a> </li> </ul> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { INewProject, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { InforOwnedEnum } from \"ng2/common/enums/infor-owned.enum\";\r\nimport { IJsonManifest, IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { KeyCodeEnum } from \"../../defines\";\r\nimport { Helper } from \"../../helper\";\r\nimport { ISearchFieldOptions } from \"../../model/sohoxi/sohoxi-searchfield.model\";\r\nimport { TagService } from \"../../services/tag-service\";\r\n\r\nexport interface IProjectChangeObject {\r\n\tproject: angular.IChangesObject<IJsonManifest | IJsonRuntimeManifest>;\r\n}\r\n\r\nexport class TagDropdownComponent {\r\n\r\n\tpublic availableTags: IJsonTag[] = [];\r\n\tpublic availableTagNames: string[] = [];\r\n\tpublic currentTag: string;\r\n\tpublic errorMessage: string;\r\n\tpublic onSaveTags: Function;\r\n\tpublic project: IJsonManifest | IJsonRuntimeManifest | INewProject;\r\n\tpublic selectedTags: IJsonTag[] = [];\r\n\r\n\tpublic KeyCodeEnum = KeyCodeEnum;\r\n\tpublic searchFieldOptions: ISearchFieldOptions;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.TAG_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate tagService: TagService\r\n\t) {\r\n\t\tthis.initAvailableTags();\r\n\t\tthis.initSearchFieldEvent();\r\n\t}\r\n\r\n\tpublic $onChanges(changeObject: IProjectChangeObject): void {\r\n\t\tconst project = changeObject.project;\r\n\t\tif (project && !project.isFirstChange() &&\r\n\t\t\tproject.currentValue.id !== project.previousValue.id) {\r\n\t\t\tthis.currentTag = undefined;\r\n\t\t\tthis.errorMessage = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addTag(): void {\r\n\t\tconst currentTag = this.currentTag;\r\n\t\tif (!Helper.isUndefinedEmpty(currentTag) &&\r\n\t\t\tthis.isValid() && currentTag\r\n\t\t) {\r\n\t\t\tlet tag: IJsonTag = this.getAvailableTag(currentTag);\r\n\t\t\tif (!tag) {\r\n\t\t\t\ttag = this.getNewTag();\r\n\t\t\t}\r\n\t\t\tthis.selectedTags.push(tag);\r\n\t\t\tthis.save();\r\n\r\n\t\t\tthis.currentTag = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic deleteTag(tag: IJsonTag): void {\r\n\t\tconst selectedTags = angular.copy(this.selectedTags);\r\n\t\tthis.selectedTags = selectedTags.filter((selectedTag) => {\r\n\t\t\treturn tag.name !== selectedTag.name;\r\n\t\t});\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tpublic isValid(): boolean {\r\n\t\tconst isValid = true;\r\n\t\tconst currentTag = this.currentTag;\r\n\r\n\t\t/* For some reason when adding tags in create project view it will trigger addTag() twice\r\n\t\t\twhen pressing enter, one time from keypress enter and one time from button click.\r\n\t\t\tThis extra check on if tag is valid is to prevent the second call on addTag is evaluated. */\r\n\t\tif (Helper.isUndefinedEmpty(currentTag)) {\r\n\t\t\tthis.errorMessage = undefined;\r\n\t\t\treturn isValid;\r\n\t\t}\r\n\r\n\t\tconst alreadyExists = this.selectedTags.some((tag) => {\r\n\t\t\treturn tag.name === currentTag;\r\n\t\t});\r\n\r\n\t\tif (alreadyExists) {\r\n\t\t\tthis.errorMessage = \"Tag already added\";\r\n\t\t\treturn !isValid;\r\n\t\t}\r\n\r\n\t\tconst isValidTag = /^[a-zA-Z0-9\\s]{1,256}$/.test(currentTag);\r\n\t\tif (!isValidTag) {\r\n\t\t\tthis.errorMessage = \"Tag is not valid\";\r\n\t\t\treturn !isValid;\r\n\t\t}\r\n\r\n\t\tthis.errorMessage = undefined;\r\n\t\treturn isValid;\r\n\t}\r\n\r\n\tpublic onKeyPressed($event: JQueryKeyEventObject): void {\r\n\t\tif ($event.which === KeyCodeEnum.ENTER) {\r\n\t\t\tthis.addTag();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getNewTag(): IJsonTag {\r\n\t\treturn {\r\n\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\tname: this.currentTag,\r\n\t\t\tinforOwned: InforOwnedEnum.FALSE\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getAvailableTag(tagName: string): IJsonTag {\r\n\t\treturn this.availableTags.find((availableTag) => {\r\n\t\t\treturn availableTag.name === tagName;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate save(): void {\r\n\t\tif ((this.project as INewProject).tags) {//new project\r\n\t\t\t(this.project as INewProject).tags = this.selectedTags;\r\n\t\t} else {\r\n\t\t\tthis.onSaveTags({ $tags: this.selectedTags });\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initAvailableTags(): void {\r\n\t\tthis.tagService.getAvailableTags().then((tags) => {\r\n\t\t\tthis.availableTags = tags;\r\n\t\t\tthis.availableTagNames = Helper.getListNames(tags);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initSearchFieldEvent(): void {\r\n\t\tthis.$element.on(\r\n\t\t\t\"selected\",\r\n\t\t\t(event: JQueryEventObject, selectedItem: ng.IAugmentedJQuery\r\n\t\t\t) => {\r\n\t\t\t\tthis.currentTag = selectedItem.text().trim();\r\n\t\t\t\tthis.isValid();\r\n\t\t\t\tthis.$scope.$applyAsync();\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirTagDropdown\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tonSaveTags: \"&\",\r\n\t\t\t\tproject: \"<\",\r\n\t\t\t\tselectedTags: \"=\"\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./tag-dropdown-component.html\"),\r\n\t\t\tcontroller: TagDropdownComponent as any,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=with-button> <label for=tagSetting>Tags</label> <div class=tag-container> <a class=\\\"tag is-dismissable\\\" ng-repeat=\\\"tag in ctrl.selectedTags track by tag.id\\\">{{tag.name}} <span class=dismissable-btn ng-click=ctrl.deleteTag(tag)> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-close></use> </svg> <span class=audible>Close</span> </span> </a> </div> <input class=searchfield xi-searchfield=\\\"{'source': ctrl.availableTagNames}\\\" ng-model=ctrl.currentTag ng-model-options=\\\"{ debounce: 500 }\\\" ng-change=ctrl.isValid() ng-keypress=ctrl.onKeyPressed($event) id=tag-searchfield name=searchfield placeholder=\\\"Add tag\\\" maxlength=25 /> <button class=btn-icon xi-tooltip=\\\"'Add tag'\\\" ng-click=ctrl.addTag()> <svg class=icon focusable=false> <use xlink:href=#icon-add></use> </svg> <span class=audible>Add</span> </button> </div> <div ng-show=\\\"ctrl.errorMessage !== undefined\\\" class=\\\"error-icon error-message\\\"> <svg class=\\\"icon icon-error\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-error></use> </svg> <pre class=audible>Error</pre> <p class=message-text>{{ ctrl.errorMessage }}</p> </div> \";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { TextareaFieldCtrl } from \"./textarea-field-ctrl\";\r\n\r\nexport class TextareaFieldComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tlabelName: \"@?\",\r\n\t\t\tfieldValue: \"=\",\r\n\t\t\tvalidation: \"<?\",\r\n\t\t\treadonly: \"<?\",\t// readonly field\r\n\t\t};\r\n\r\n\t\tthis.controller = TextareaFieldCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./textarea-field-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirTextareaFieldComponent\", new TextareaFieldComponent());\r\n\t}\r\n}\r\n","import { FieldValidation } from \"../base/field-validation\";\r\nimport { ISharedStyling } from \"../base/shared-styling\";\r\n\r\nimport * as xi from \"../../model/sohoxi/sohoxi-textarea.model\";\r\n\r\nexport class TextareaFieldCtrl\r\n\textends FieldValidation\r\n\timplements ISharedStyling {\r\n\tpublic readonly: boolean = false;\r\n\r\n\tpublic textareaOptions: xi.ITextAreaOptions;\r\n\r\n\tpublic $onInit(): void {\r\n\t\tsuper.$onInit();\r\n\r\n\t\tthis.textareaOptions = {\r\n\t\t\tautoGrow: true,\r\n\t\t\tautoGrowAnimate: true\r\n\t\t};\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=component-base> <div ng-if=\\\"ctrl.validation !== undefined\\\"> <label for=textareaField ng-if=\\\"ctrl.labelName !== undefined\\\"> {{ ctrl.labelName }} </label> <textarea class=\\\"textarea resizable\\\" id=textareaField name=textareaField xi-textarea=ctrl.textareaOptions ng-model=ctrl.fieldValue ng-model-options=\\\"{ debounce: 100 }\\\" ng-blur=ctrl.validate() ng-change=ctrl.validate() ng-readonly=ctrl.readonly></textarea> <div ng-repeat=\\\"validatorError in ctrl.fieldSpecificErrors\\\" ng-style=\\\"{ 'display': ctrl.displayStatus }\\\" class=error-message> <svg class=\\\"icon-error icon\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-error></use> </svg> <pre class=audible>Error</pre> <p class=message-text>{{ validatorError.message }}</p> </div> </div> <div ng-if=\\\"ctrl.validation === undefined\\\"> <label for=textareaField ng-if=\\\"ctrl.labelName !== undefined\\\"> {{ ctrl.labelName }} </label> <textarea class=resizable id=textareaField name=textareaField xi-textareaname=textareaField ng-model=ctrl.fieldValue ng-readonly=ctrl.readonly></textarea> </div> </div>\";\n// Exports\nmodule.exports = code;","import { IAboutOptions } from \"../../model/sohoxi/sohoxi-about.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * About Directive.\r\n *\r\n * Shows a modal dialog which contains information typical for about dialogs\r\n *\r\n * Example:\r\n * scope[\"options\"]: IXiAboutOptions = {\r\n * \tappName: \"SoHo Xi Test\",\r\n * \tproductName: \"Test page for directives\", version: \"0.0.7\",\r\n * \tuseDefaultCopyright: true,\r\n * \tcontent: \"<div><p>Additional content goes here</p></div>\"\r\n * }\r\n *\r\n * <button class=\"btn about\" id=\"about-dialog\" xi-about=\"options\">Open about modal</button>\r\n */\r\nexport class AboutDirective implements ng.IDirective {\r\n\trestrict = \"A\";\r\n\tscope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiAbout\";\r\n\r\n\tlink(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[AboutDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IAboutOptions) => {\r\n\t\t\t\tconst aboutComponent = Utils.getData(element, \"about\");\r\n\t\t\t\tif (aboutComponent) {\r\n\t\t\t\t\taboutComponent.destroy();\r\n\t\t\t\t\taboutComponent.modal.remove();\r\n\t\t\t\t}\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.about(newOptions);\r\n\t\t\t\t\t// Replace the option specified additional content with a compiled angular version\r\n\t\t\t\t\t// if (newOptions.content) {\r\n\t\t\t\t\t// \tconst content: any = this.$compile(newOptions.content)(scope);\r\n\t\t\t\t\t// \tUtils.getData(element, \"about\").modal.one(\"open\", () => {\r\n\t\t\t\t\t// \t\t$(\"body\")\r\n\t\t\t\t\t// \t\t\t.find(\"#about-modal\" + id)\r\n\t\t\t\t\t// \t\t\t.find(\".additional-content\")\r\n\t\t\t\t\t// \t\t\t.html(content);\r\n\t\t\t\t\t// \t\t$(\"body\")\r\n\t\t\t\t\t// \t\t\t.find(\"#about-modal\" + id)\r\n\t\t\t\t\t// \t\t\t.find(\".modal-body\")\r\n\t\t\t\t\t// \t\t\t.css({\r\n\t\t\t\t\t// \t\t\t\t\"max-height\": \"350px\",\r\n\t\t\t\t\t// \t\t\t\t\"overflow-y\": \"auto\",\r\n\t\t\t\t\t// \t\t\t});\r\n\t\t\t\t\t// \t});\r\n\t\t\t\t\t// }\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.about();\r\n\t\t\t\t}\r\n\t\t\t\t// Support more than one about modal on the same page\r\n\t\t\t\t// Utils.getData(element, \"about\").modal.attr(\"id\", \"about-modal\" + id);\r\n\t\t\t\t// element.attr(\"data-modal\", \"about-modal\" + id);\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst modalData = Utils.getData(element, \"about\");\r\n\t\t\tif (modalData) {\r\n\t\t\t\tmodalData.destroy();\r\n\r\n\t\t\t\tconst aboutSelector = \"#about-modal\";\r\n\t\t\t\tdo {\r\n\t\t\t\t\t$(aboutSelector).remove();\r\n\t\t\t\t} while ($(aboutSelector).length > 0);\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(AboutDirective.DIRECTIVE_NAME, () => new AboutDirective());\r\n\t}\r\n}\r\n","/**\r\n * Application Menu Directive.\r\n *\r\n * Example:\r\n * <nav xi-app-menu class=\"application-menu\"</nav>\r\n */\r\nexport class ApplicationMenuDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(scope: ng.IScope, element: ng.IAugmentedJQuery): void {\r\n\t\telement.applicationMenu();\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"xiAppMenu\", () => {\r\n\t\t\treturn new ApplicationMenuDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IArrangeEvent } from \"common/model/sohoxi/sohoxi.model\";\r\n\r\nexport class ArrangeDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiArrange\";\r\n\trestrict = \"A\";\r\n\tscope = false;\r\n\r\n\tlink(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes,\r\n\t): void {\r\n\r\n\t\tif (element.length > 0) {\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\t//DOM has finished rendering\r\n\t\t\t\tconst arrangeElement = element as any;\r\n\t\t\t\tarrangeElement.arrange().off(\"arrangeupdate\");\r\n\t\t\t\tarrangeElement.arrange().on(\"arrangeupdate\", (e: any, event: IArrangeEvent) => {\r\n\t\t\t\t\tconst controllScope = scope as any;\r\n\t\t\t\t\tcontrollScope[attributes.xiArrange].onArrange(event);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\t\t\tfunction () { return element[0].childNodes.length; },\r\n\t\t\t\t\tfunction (newValue, oldValue) {\r\n\t\t\t\t\t\tif (newValue !== oldValue) {\r\n\t\t\t\t\t\t\t// DOM changes\r\n\t\t\t\t\t\t\tarrangeElement.arrange();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\t// Tear down\r\n\t\t\t\tarrangeElement.on(\"$destroy\", () => {\r\n\t\t\t\t\tunbindWatcher();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tconstructor(private $timeout: ng.ITimeoutService) {\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(ArrangeDirective.DIRECTIVE_NAME, ($timeout: ng.ITimeoutService) => {\r\n\t\t\treturn new ArrangeDirective($timeout);\r\n\t\t});\r\n\t}\r\n}\r\n","import { IAutoCompleteOptions } from \"../../model/sohoxi/sohoxi-autocomplete.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * Autocomplete Directive.\r\n *\r\n * Suggests values in given data (source) that matches the input.\r\n * Instead of providing av options object, the following attributes can be used as an alternative:\r\n * data-autocomplete (string url value only, instead of options.source)\r\n * data-tmpl (instead of options.template)\r\n *\r\n * Example:\r\n * scope[\"options\"]: IXiAutoCompleteOptions = {\r\n * \tsource: [\"Alpha\", \"Bravo\"],\r\n * \ttemplate: \"#template\", filterMode: \"contains\"\r\n * }\r\n * <input xi-autocomplete=\"options\" />\r\n */\r\nexport class AutocompleteDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiAutocomplete\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[AutocompleteDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watchCollection(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IAutoCompleteOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t// Set the data-autocomplete attribute to source (external in options object)\r\n\t\t\t\t\telement.attr(\"data-autocomplete\", \"source\");\r\n\t\t\t\t\telement.autocomplete(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.autocomplete();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst autoCompleteData = Utils.getData(element, \"autocomplete\");\r\n\t\t\tif (autoCompleteData) {\r\n\t\t\t\tautoCompleteData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(AutocompleteDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new AutocompleteDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IBusyOptions } from \"../../model/sohoxi/sohoxi-busy.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * Busy Directive.\r\n *\r\n * Shows a busy indicator, covering the area spanned by the element\r\n *\r\n * Example:\r\n * scope[\"isAppBusy\"]: boolean = true\r\n * <div xi-busy=\"isAppBusy\">\r\n * \tThis area is busy until variable isAppBusy is set to false. Indicator shown after 3000 ms when triggered\r\n * </div>\r\n *\r\n * Default delay until the loading indicator shows up, after triggered, is 3000 ms.\r\n * To set another delay, use the attribute busy-delay\r\n *\r\n * Example:\r\n * scope[\"isAnotherAppBusy\"]: boolean = true\r\n * <div xi-busy=\"isAnotherAppBusy\" busy-delay=\"0\">\r\n * \tThis area is busy until variable isAnotherAppBusy is set to false. Indicator shown immediately when triggered\r\n * </div>\r\n *\r\n */\r\nexport class BusyDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiBusy\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\telement.addClass(\"busy\");\r\n\t\tconst options: IBusyOptions = {};\r\n\t\tconst delay = attributes.busyDelay;\r\n\t\tconst transparentOverlay = attributes.transparentOverlay;\r\n\r\n\t\tif ($.isNumeric(delay)) {\r\n\t\t\toptions.displayDelay = parseInt(delay);\r\n\t\t}\r\n\t\tif (transparentOverlay === \"true\") { // default is false\r\n\t\t\toptions.transparentOverlay = true;\r\n\t\t}\r\n\r\n\t\telement.busyindicator(options);\r\n\r\n\t\tconst expression = attributes[BusyDirective.DIRECTIVE_NAME];\r\n\t\tlet isRunning = false;\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\texpression,\r\n\t\t\t(newValue: boolean, _) => {\r\n\t\t\t\tif (newValue && !isRunning) {\r\n\t\t\t\t\tisRunning = true;\r\n\t\t\t\t\telement.trigger(\"start.busyindicator\");\r\n\t\t\t\t} else if (!newValue && isRunning) {\r\n\t\t\t\t\tisRunning = false;\r\n\t\t\t\t\telement.trigger(\"complete.busyindicator\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst busyData = Utils.getData(element, \"busyindicator\");\r\n\t\t\tif (busyData) {\r\n\t\t\t\tbusyData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(BusyDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new BusyDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Button Directive.\r\n *\r\n * Example:\r\n * <button xi-button class=\"btn-primary\" type=\"button\">Action</button>\r\n */\r\nexport class ButtonDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(scope: ng.IScope, element: ng.IAugmentedJQuery): void {\r\n\t\telement.button();\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"xiButton\", () => {\r\n\t\t\treturn new ButtonDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IColorPickerApi, IColorPickerOptions } from \"../../model/sohoxi/sohoxi-colorpicker.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Colorpicker Directive.\r\n *\r\n * Provides a color picker consisting of colors specified by the IColorpickerOptions option,\r\n * or default colors if not specified. Use the value attribute to set a default color.\r\n *\r\n * Example:\r\n * scope[\"options\"] = {\r\n * \tcolors: [\r\n * \t\t{label: \"white\", value: \"ffffff\" },\r\n * \t\t{label: \"black\", value: \"000000\"}\r\n * \t]\r\n * }\r\n * <input value=\"#ffffff\" xi-colorpicker=\"colors\" />\r\n */\r\nexport class ColorPickerDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic require = \"?ngModel\";\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiColorPicker\";\r\n\r\n\tconstructor(private $parse: ng.IParseService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes,\r\n\t\tngModel: ng.INgModelController\r\n\t): void {\r\n\t\t// Save selected/default color then trigger change so control updates\r\n\t\tlet selectedColor = element.val() as string;\r\n\t\tconst options = attributes[ColorPickerDirective.DIRECTIVE_NAME];\r\n\t\tlet api: IColorPickerApi;\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IColorPickerOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.colorpicker(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.colorpicker();\r\n\t\t\t\t}\r\n\t\t\t\tapi = Utils.getData(element, \"colorpicker\");\r\n\t\t\t\tif (ngModel) {\r\n\t\t\t\t\t// Watch ng-model and update element value on change\r\n\t\t\t\t\tscope.$watch(attributes.ngModel, (color: string) => {\r\n\t\t\t\t\t\tif (color && color.length > 0 && color !== selectedColor) {\r\n\t\t\t\t\t\t\telement.val(color);\r\n\t\t\t\t\t\t\tif (api) {\r\n\t\t\t\t\t\t\t\tapi.setColor(color);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tselectedColor = color;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\telement.on(\"selected.colorpicker\", (e, item) => {\r\n\t\t\t\t\t\tscope.$apply(() => {\r\n\t\t\t\t\t\t\tthis.$parse(attributes.ngModel).assign(\r\n\t\t\t\t\t\t\t\tscope,\r\n\t\t\t\t\t\t\t\t\"#\" + item.data(\"value\")\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tif (api) {\r\n\t\t\t\telement.off(\"change\");\r\n\t\t\t\telement.off(\"selected.colorpicker\");\r\n\t\t\t\tapi.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ColorPickerDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$parse\",\r\n\t\t\tparse => {\r\n\t\t\t\treturn new ColorPickerDirective(parse);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","/**\r\n * Standard Control Directive.\r\n *\r\n * Used to call a standard initialize method for the specified SohoXi Control.\r\n * Does not support initialization with control options\r\n */\r\n\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class ControlDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiControl\";\r\n\r\n\tstatic $inject = [\"$log\"];\r\n\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tconstructor(\r\n\t\tprivate log: ng.ILogService,\r\n\t\tprivate timeout: ng.ITimeoutService\r\n\t) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst functionName = attributes[ControlDirective.DIRECTIVE_NAME];\r\n\t\tif (!functionName) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tthis.timeout(() => {\r\n\t\t\t\tconst data = Utils.getData(element, functionName);\r\n\t\t\t\tif (!data) {\r\n\t\t\t\t\tswitch (functionName) {\r\n\t\t\t\t\t\tcase \"expandablearea\":\r\n\t\t\t\t\t\t\telement.expandablearea();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"toolbar\":\r\n\t\t\t\t\t\t\telement.toolbar();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"accordion\":\r\n\t\t\t\t\t\t\telement.accordion();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"wizard\":\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\telement.wizard();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, 1);\r\n\t\t} catch (ex) {\r\n\t\t\tthis.log.error(name + \" Failed to call \" + functionName, ex);\r\n\t\t}\r\n\t\tscope.$on(\"$destroy\", () => {\r\n\t\t\tconst data = Utils.getData(element, functionName);\r\n\t\t\tif (data) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata.destroy();\r\n\t\t\t\t} catch (exc) {\r\n\t\t\t\t\tthis.log.error(name + \" Failed to destroy \" + functionName, exc);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ControlDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$log\",\r\n\t\t\t\"$timeout\",\r\n\t\t\t(log, timeout) => {\r\n\t\t\t\treturn new ControlDirective(log, timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { IDatePickerOptions } from \"../../model/sohoxi/sohoxi-datepicker.model\";\r\n\r\n/**\r\n * Datepicker directive.\r\n *\r\n * Example:\r\n * scope[\"options\"] = {\tdateFormat: \"YYYY/M/D\" }\r\n *\r\n * <input xi-datepicker=\"options\" id=\"date-field\" class=\"datepicker\" type=\"text\"/>\r\n */\r\nexport class DatepickerDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiDatepicker\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[DatepickerDirective.DIRECTIVE_NAME];\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(\r\n\t\t\t\tnewOptions: IDatePickerOptions,\r\n\t\t\t\toldOptions: IDatePickerOptions\r\n\t\t\t) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.datepicker(newOptions);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(DatepickerDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new DatepickerDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Dropdown Directive.\r\n *\r\n * Example:\r\n * scope[\"datas\"] = [{ value: 1, label: \"first\" }, { value: 2, label: \"second\" }]\r\n *\t<select id=\"dropdown-1\" class=\"dropdown\"\r\n\t\tng-model=\"modelVal\"\r\n\t\tng-options=\"data.label as data.value for data in datas\"\r\n\t\txi-drop-down\r\n\t></select>\r\n\t*/\r\n\r\nimport * as xi from \"../../model/sohoxi/sohoxi-dropdown.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class DropDownDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiDropDown\";\r\n\r\n\tconstructor(private $timeout: ng.ITimeoutService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[DropDownDirective.DIRECTIVE_NAME];\r\n\t\tlet api: any;\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: xi.IDropDownOptions) => {\r\n\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t\telement.dropdown(newOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.dropdown();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tapi = Utils.getData(element, \"dropdown\");\r\n\t\t\t\t\tapi.setDisplayedValues();\r\n\t\t\t\t}, 100); // tslint:disable-line:no-magic-numbers\r\n\t\t\t},\r\n\t\t\ttrue\r\n\t\t);\r\n\r\n\t\tlet modelWatcher: any;\r\n\t\tconst modelAttr = attributes.ngModel;\r\n\r\n\t\tif (modelAttr) {\r\n\t\t\tmodelWatcher = scope.$watch(modelAttr, () => {\r\n\t\t\t\tif (api) {\r\n\t\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\t\tapi.setDisplayedValues();\r\n\t\t\t\t\t}, 100); // tslint:disable-line:no-magic-numbers\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tlet disabledWatcher: any;\r\n\t\tconst disabledAttr = attributes.ngDisabled;\r\n\r\n\t\tif (disabledAttr) {\r\n\t\t\tdisabledWatcher = scope.$watch(disabledAttr, newValue => {\r\n\t\t\t\tif (api) {\r\n\t\t\t\t\tif (newValue === false) {\r\n\t\t\t\t\t\tapi.enable();\r\n\t\t\t\t\t} else if (newValue === true) {\r\n\t\t\t\t\t\tapi.disable();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tif (api) {\r\n\t\t\t\tapi.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t\tif (modelWatcher) {\r\n\t\t\t\tmodelWatcher();\r\n\t\t\t}\r\n\t\t\tif (disabledWatcher) {\r\n\t\t\t\tdisabledWatcher();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(DropDownDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\ttimeout => {\r\n\t\t\t\treturn new DropDownDirective(timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { IEditorOptions } from \"../../model/sohoxi/sohoxi-editor.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Editor Directive.\r\n *\r\n * Example:\r\n * scope[\"options\"]: IEditorOptions = {\r\n * \tanchor: {\r\n * \t\turl: \"https://www.example.com,\r\n * \t\tclass: \"hyperlink\",\r\n * \t\ttarget: \"_blank\"\r\n * \t}\r\n * };\r\n * <div class=\"editor\" id=\"my-editor\" role=\"textbox\" aria-multiline=\"true\" aria-label=\"notes\" xi-editor></div>\r\n */\r\nexport class EditorDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiEditor\";\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[EditorDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IEditorOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.editor(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.editor();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst editorData = Utils.getData(element, \"editor\");\r\n\t\t\tif (editorData) {\r\n\t\t\t\teditorData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(EditorDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new EditorDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { Utils } from \"../utils\";\r\n\r\n/**\r\n * File Upload Directive.\r\n *\r\n * Used for binding a scope variable to selected file(s)\r\n * The name of the scope variable is specified as xi-fileupload=\"scopeVariableName\"\r\n *\r\n * Example:\r\n * scope[\"files\"]\r\n *\r\n * <label class=\"fileupload\">\r\n * \t<span class=\"audible\">Choose File</span>\r\n * \t<input type=\"file\" name=\"file-input\" xi-fileupload=\"chosenFile\" />\r\n * </label>\r\n */\r\nexport class FileuploadDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiFileupload\";\r\n\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tconstructor(\r\n\t\tprivate timeout: ng.ITimeoutService,\r\n\t\tprivate parse: ng.IParseService\r\n\t) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst expression = attributes[FileuploadDirective.DIRECTIVE_NAME];\r\n\t\tconst parent = element.parent(\".fileupload\");\r\n\t\tif (!expression || parent.length === 0) {\r\n\t\t\t// Incorrect setup\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telement.bind(\"change.fileupload\", () => {\r\n\t\t\tconst files = (element[0] as any)[\"files\"];\r\n\r\n\t\t\tthis.parse(expression).assign(scope, files); // tslint:disable-line:no-string-literal\r\n\t\t\tscope.$apply();\r\n\t\t});\r\n\t\t// Timeout to let the label render\r\n\t\tthis.timeout(() => {\r\n\t\t\tparent.fileupload();\r\n\t\t}, 1);\r\n\t\tparent.on(\"$destroy\", () => {\r\n\t\t\tconst fileUploadData = Utils.getData(parent, \"fileupload\");\r\n\t\t\tif (fileUploadData) {\r\n\t\t\t\tfileUploadData.destroy();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(FileuploadDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\t\"$parse\",\r\n\t\t\t(timeout, parse) => {\r\n\t\t\t\treturn new FileuploadDirective(timeout, parse);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { ILookupOptions } from \"../../model/sohoxi/sohoxi-lookup.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n//tslint:disable\r\n/**\r\n * Lookup Directive.\r\n *\r\n * Example:\r\n * scope[\"options\"]: ILookupOptions = {\r\n * \tfield: \"productId\",\r\n * \toptions: {\r\n * \t\tcolumns: [\r\n * \t\t\t{ id: 'productId', name: 'Product Id', field: 'productId', width: 140 },\r\n * \t\t\t{ id: 'productName', name: 'Product Name', sortable: false, field: 'productName', width: 250, formatter: (<any>window).Formatters.Hyperlink },\r\n * \t\t\t{ id: 'activity', hidden: true, name: 'Activity', field: 'activity', width: 125 }\r\n * \t\t],\r\n * \t\tdataset: [\r\n * \t\t\t{ id: 1, productId: 2142201, productName: 'Compressor', activity: 'Assemble Paint' },\r\n * \t\t\t{ id: 2, productId: 2241202, productName: 'Different Compressor', activity: 'Inspect and Repair' },\r\n * \t\t\t{ id: 3, productId: 2342203, productName: 'Third Compressor', activity: 'Inspect and Repair' }\r\n * \t\t],\r\n * \t\tselectable: 'single'\r\n * \t}\r\n * }\r\n * <input id=\"lookup-example\" data-init=\"false\" class=\"lookup\" type=\"text\" xi-lookup=\"options\"/>\r\n */\r\n\r\n//tslint:enable\r\nexport class LookupDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiLookup\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[LookupDirective.DIRECTIVE_NAME];\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ILookupOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.lookup(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.lookup();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttrue\r\n\t\t);\r\n\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst lookupData = Utils.getData(element, \"lookup\");\r\n\t\t\tif (lookupData) {\r\n\t\t\t\tlookupData.destroy();\r\n\t\t\t}\r\n\t\t\t$(\"body\").off(\"open\");\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(LookupDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new LookupDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IMaskOptions } from \"../../model/sohoxi/sohoxi-mask.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * Mask Directive.\r\n *\r\n * Sets masking properties on an input.\r\n * Instead of providing av options object, the following attributes can be used:\r\n * data-mask-mode\r\n * data-mask (corresponds to 'pattern' in IMaskOptions)\r\n * data-thousands\r\n * data-must-complete\r\n * data-show-currency\r\n *\r\n * Example:\r\n * scope[\"options\"]: IXiMaskOptions = {\"pattern\": \"##:##\", }\r\n * <input xi-mask=\"options\" />\r\n *\r\n * <input xi-mask data-mask-mode=\"number\" data-mask=\"####\" data-thousands=\"true\" />\r\n */\r\nexport class MaskDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiMask\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[MaskDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IMaskOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t// Set attributes and initialize control with options object\r\n\t\t\t\t\tif (newOptions.mode) {\r\n\t\t\t\t\t\telement.attr(\"data-mask-mode\", newOptions.mode);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newOptions.thousands) {\r\n\t\t\t\t\t\telement.attr(\"data-thousands\", String(newOptions.thousands));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newOptions.mustComplete) {\r\n\t\t\t\t\t\telement.attr(\r\n\t\t\t\t\t\t\t\"data-must-complete\",\r\n\t\t\t\t\t\t\tString(newOptions.mustComplete)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newOptions.showCurrency) {\r\n\t\t\t\t\t\telement.attr(\r\n\t\t\t\t\t\t\t\"data-show-currency\",\r\n\t\t\t\t\t\t\tString(newOptions.showCurrency)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telement.mask(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Initiate control without options object\r\n\t\t\t\t\telement.mask();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst maskData = Utils.getData(element, \"mask\");\r\n\t\t\tif (maskData) {\r\n\t\t\t\tmaskData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(MaskDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new MaskDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IMultiSelectOptions } from \"../../model/sohoxi/sohoxi-multiselect.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Multiselect Directive\r\n *\r\n * Provides multiselection.\r\n * Note that the element must have an ID.\r\n */\r\nexport class MultiSelectDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiMultiselect\";\r\n\r\n\tconstructor(private $timeout: ng.ITimeoutService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\t// ID is required\r\n\t\tif (!attributes.id) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst options = attributes[MultiSelectDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IMultiSelectOptions) => {\r\n\t\t\t\t// Set selected after binding\r\n\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t\telement.multiselect(newOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.multiselect();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 100); // tslint:disable-line:no-magic-numbers\r\n\t\t\t}\r\n\t\t);\r\n\t\t// let modelWatcher;\r\n\t\t// const modelAttr = attributes[\"ngModel\"];\r\n\t\t// if (modelAttr) {\r\n\t\t// \tmodelWatcher = scope.$watch(modelAttr, () => {\r\n\t\t// \t\tif (api) {\r\n\t\t// \t\t\tthis.$timeout(() => {\r\n\t\t// \t\t\t\tapi.setValue();\r\n\t\t// \t\t\t}, 100);\r\n\t\t// \t\t}\r\n\t\t// \t});\r\n\t\t// }\r\n\r\n\t\t// let disabledWatcher;\r\n\t\t// const disabledAttr = attributes[\"ngDisabled\"];\r\n\t\t// if (disabledAttr) {\r\n\t\t// \tdisabledWatcher = scope.$watch(disabledAttr, newValue => {\r\n\t\t// \t\tif (api) {\r\n\t\t// \t\t\tif (newValue === false) {\r\n\t\t// \t\t\t\tapi.enable();\r\n\t\t// \t\t\t} else if (newValue === true) {\r\n\t\t// \t\t\t\tapi.disable();\r\n\t\t// \t\t\t}\r\n\t\t// \t\t}\r\n\t\t// \t});\r\n\t\t// }\r\n\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst multiSelectApi = Utils.getData(element, \"multiselect\");\r\n\t\t\tif (multiSelectApi) {\r\n\t\t\t\tmultiSelectApi.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t\t// if (modelWatcher) {\r\n\t\t\t// \tmodelWatcher();\r\n\t\t\t// }\r\n\t\t\t// if (disabledWatcher) {\r\n\t\t\t// \tdisabledWatcher();\r\n\t\t\t// }\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(MultiSelectDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\ttimeout => {\r\n\t\t\t\treturn new MultiSelectDirective(timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { IPopoverOptions } from \"../../model/sohoxi/sohoxi-popover.model\";\r\nimport { Utils } from \"../utils\";\r\n/**\r\n * Popover Directive\r\n *\r\n * Same control as tooltip.\r\n *\r\n * Example:\r\n * scope[\"options\"]: IXiTooltipOptions = {\r\n * \tcontent: $(\"#popover-contents\"),\r\n * \ttrigger: \"click\",\r\n * \tplacement: \"left\"\r\n * }\r\n * <button class=\"btn-primary\" type=\"button\" xi-popover=\"options\">Click Activated</button>\r\n * <div id=\"popover-contents\">\r\n * \t<p>This is the popover content</p>\r\n * </div>\r\n */\r\nexport class PopoverDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiPopover\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\tattributes[PopoverDirective.DIRECTIVE_NAME],\r\n\t\t\t(newValue: IPopoverOptions) => {\r\n\t\t\t\tif (newValue) {\r\n\t\t\t\t\tif (!newValue.placement) {\r\n\t\t\t\t\t\tnewValue.placement = \"right\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\telement.popover(newValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst tooltipData = Utils.getData(element, \"tooltip\");\r\n\t\t\tif (tooltipData) {\r\n\t\t\t\ttooltipData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(PopoverDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new PopoverDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Popup Menu Directive.\r\n */\r\n\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class PopupmenuDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiPopupmenu\";\r\n\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tconstructor(private timeout: ng.ITimeoutService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\tattributes[PopupmenuDirective.DIRECTIVE_NAME],\r\n\t\t\tnewOptions => {\r\n\t\t\t\t// Init popup menu plugin. The timeout allows angular bindings to be evaluated\r\n\t\t\t\tthis.timeout(() => {\r\n\t\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t\telement.popupmenu(newOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.popupmenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1);\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst popupMenuData = Utils.getData(element, \"popupmenu\");\r\n\t\t\tif (popupMenuData) {\r\n\t\t\t\tpopupMenuData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(PopupmenuDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\ttimeout => {\r\n\t\t\t\treturn new PopupmenuDirective(timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { ISearchFieldOptions } from \"../../model/sohoxi/sohoxi-searchfield.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Searchfield Directive.\r\n *\r\n * Suggests values in given data (source) that matches the input.\r\n *\r\n * Example:\r\n * scope[\"options\"]: ISearchfieldOptions = { \"source\": [\"Alpha\", \"Bravo\"], \"template\": \"#template\" }\r\n * <input xi-searchfield=\"options\" />\r\n */\r\nexport class SearchFieldDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiSearchfield\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[SearchFieldDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ISearchFieldOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t// Set the data-autocomplete attribute to source (external in options object)\r\n\t\t\t\t\telement.searchfield(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.searchfield();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst searchFieldData = Utils.getData(element, \"searchfield\");\r\n\t\t\tif (searchFieldData) {\r\n\t\t\t\tsearchFieldData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(SearchFieldDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new SearchFieldDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { ISliderOptions } from \"../../model/sohoxi/sohoxi-slider.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Slider directive.\r\n *\r\n * Example:\r\n * scope[\"options\"] = {\r\n * \tvalue: [1],\r\n * \tmin: 0,\r\n * \tmax: 2,\r\n * \trange: false,\r\n * \tstep: 1,\r\n * \tticks: [\r\n * \t\t{ value: 0, description: \"Hidden\", color: \"#ed1c24\" },\r\n * \t\t{ value: 1, description: \"Read only\", color: \"#faa719\" },\r\n * \t\t{ value: 2, description: \"Enabled\", color: \"#157a13\" }\r\n * \t]\r\n * }\r\n * <input id=\"slider-example\" xi-slider=\"options\"/>\r\n */\r\nexport class SliderDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiSlider\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[SliderDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ISliderOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.slider(newOptions as any);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.slider();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst sliderData = Utils.getData(element, \"slider\");\r\n\t\t\tif (sliderData) {\r\n\t\t\t\tsliderData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(SliderDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new SliderDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { Utils } from \"../utils\";\r\n\r\n/**\r\n * Spinbox Directive.\r\n *\r\n * Example:\r\n * <input xi-spinbox class=\"spinbox\" min=\"-99\" max=\"99\" value=\"0\" step=\"3\" />\r\n *\r\n * Attributes: min, max, value (default), step\r\n * Supports xi-track-dirty\r\n */\r\nexport class SpinboxDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiSpinbox\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\telement.spinbox();\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst spinBoxData = Utils.getData(element, \"spinbox\");\r\n\t\t\tif (spinBoxData) {\r\n\t\t\t\tspinBoxData.destroy();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(SpinboxDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new SpinboxDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import * as xi from \"../../model/sohoxi/sohoxi-tabs.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class TabsDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTabs\";\r\n\r\n\tconstructor(private $timeout: ng.ITimeoutService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[TabsDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: xi.ITabsOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\tif (newOptions.modalId) {\r\n\t\t\t\t\t\tlet tabToFocus;\r\n\t\t\t\t\t\tconst modalElement = $(\"#\" + newOptions.modalId);\r\n\r\n\t\t\t\t\t\t// Force recalculation of modal size\r\n\t\t\t\t\t\tmodalElement.addClass(\"hidden\");\r\n\r\n\t\t\t\t\t\tmodalElement.one(\"open\", () => {\r\n\t\t\t\t\t\t\tmodalElement.removeClass(\"hidden\");\r\n\t\t\t\t\t\t\telement.tabs(newOptions as any);\r\n\t\t\t\t\t\t\tUtils.getData(modalElement, \"modal\").resize();\r\n\r\n\t\t\t\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\t\t\t\ttabToFocus = modalElement.find(\r\n\t\t\t\t\t\t\t\t\t\":focusable:not(.searchfield):first\"\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tif (tabToFocus.length) {\r\n\t\t\t\t\t\t\t\t\ttabToFocus.focus();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (newOptions.tabToSelect) {\r\n\t\t\t\t\t\t\t\t\tconst tab = modalElement.find(\r\n\t\t\t\t\t\t\t\t\t\t\"li\" + newOptions.tabToSelect\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tif (tab.length) {\r\n\t\t\t\t\t\t\t\t\t\ttab.click();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, 10); // tslint:disable-line:no-magic-numbers\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.tabs(newOptions as any);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.tabs();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst tabData = Utils.getData(element, \"tabs\");\r\n\t\t\tif (tabData) {\r\n\t\t\t\ttabData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(TabsDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\ttimeout => {\r\n\t\t\t\treturn new TabsDirective(timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { ITextAreaOptions } from \"../../model/sohoxi/sohoxi-textarea.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Textarea directive.\r\n *\r\n * Example:\r\n * <textarea xi-textarea type=\"text\" maxlength=\"100\"></textarea>\r\n */\r\nexport class TextareaDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTextarea\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[TextareaDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ITextAreaOptions) => {\r\n\t\t\t\tconst textareaApi = Utils.getData(element, \"textarea\");\r\n\t\t\t\tif (newOptions && textareaApi === undefined) {\r\n\t\t\t\t\telement.textarea(newOptions);\r\n\t\t\t\t} else if (textareaApi) {\r\n\t\t\t\t\ttextareaApi.updated(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.textarea();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst textAreaData = Utils.getData(element, \"textarea\");\r\n\t\t\tif (textAreaData) {\r\n\t\t\t\ttextAreaData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(TextareaDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new TextareaDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import type { ITimePickerOptions } from \"../../model/sohoxi/sohoxi-timepicker.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Timepicker Directive.\r\n *\r\n * Example:\r\n * <input xi-timepicker=\"options\" class=\"timepicker\">\r\n*/\r\nexport class TimepickerDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTimepicker\";\r\n\trestrict = \"A\";\r\n\tscope = false;\r\n\r\n\tlink(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[TimepickerDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ITimePickerOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t// Destory old settings\r\n\t\t\t\t\telement.data(\"timepicker\").destroy();\r\n\t\t\t\t\telement.timepicker(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.timepicker();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst timePickerData = Utils.getData(element, \"timepicker\");\r\n\t\t\tif (timePickerData) {\r\n\t\t\t\ttimePickerData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(TimepickerDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new TimepickerDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IToolbarOptions } from \"../../model/sohoxi/sohoxi-toolbar.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Toolbar directive.\r\n *\r\n * Example:\r\n * scope[\"options\"] = {rightAligned: false, maxVisibleButtons: 5}\r\n * <div class=\"toolbar\" xi-toolbar=\"options\"> ... </div>\r\n */\r\nexport class ToolbarDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiToolbar\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\tpublic replace = true;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[ToolbarDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IToolbarOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.toolbar(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.toolbar();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst toolbarData = Utils.getData(element, \"toolbar\");\r\n\t\t\tif (toolbarData) {\r\n\t\t\t\ttoolbarData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ToolbarDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new ToolbarDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Tooltip Directive\r\n */\r\n\r\nimport has from \"lodash-es/has\";\r\n\r\nimport * as xi from \"../../model/sohoxi/sohoxi-tooltip.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class TooltipDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTooltip\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tlet isInstantiated = false;\r\n\t\tif (has(attributes, \"ngDisabled\")) {\r\n\t\t\tconst content = attributes.xiTooltip.replace(/^\\'+|\\'+$/g, \"\");\r\n\t\t\telement.append(\r\n\t\t\t\t`<div class=\"disabled-tooltip\" title=\"${content}\"></div>`\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst options = attributes[TooltipDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\tnewValue => {\r\n\t\t\t\tif (typeof newValue === \"string\") {\r\n\t\t\t\t\tif (newValue.length === 0) {\r\n\t\t\t\t\t\t// Empty tooltips should not be shown so destroy the plugin\r\n\t\t\t\t\t\tif (isInstantiated) {\r\n\t\t\t\t\t\t\tUtils.getData(element, \"tooltip\").destroy();\r\n\t\t\t\t\t\t\tisInstantiated = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (!isInstantiated) {\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t\tTimeout is required because when xi-tooltip is used together with xi-toolbar\r\n\t\t\t\t\t\t\t\tand if tooltip is initialized before toolbar then toolbar overrides tooltip.\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\telement.tooltip({\r\n\t\t\t\t\t\t\t\t\tcontent: newValue\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t//tslint:disable-next-line\r\n\t\t\t\t\t\t\t}, 100);\r\n\r\n\t\t\t\t\t\t\tconst disabledTooltip = element.find(\"div[title]\");\r\n\t\t\t\t\t\t\tif (disabledTooltip.length !== 0) {\r\n\t\t\t\t\t\t\t\tdisabledTooltip.tooltip();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisInstantiated = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconst newOptions = {\r\n\t\t\t\t\t\t\t\tcontent: newValue\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tconst api = Utils.getData(element, \"tooltip\");\r\n\t\t\t\t\t\t\tapi.updated(newOptions);\r\n\r\n\t\t\t\t\t\t\tconst disabledTooltip =\r\n\t\t\t\t\t\t\t\telement.find(\"div.disabled-tooltip\");\r\n\t\t\t\t\t\t\tif (disabledTooltip.length === 1) {\r\n\t\t\t\t\t\t\t\tdisabledTooltip\r\n\t\t\t\t\t\t\t\t\t.data(\"tooltip\")\r\n\t\t\t\t\t\t\t\t\t.updated(newOptions);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (typeof newValue === \"undefined\" || newValue === null) {\r\n\t\t\t\t\t// Empty tooltips should not be shown so destroy the plugin\r\n\t\t\t\t\tif (isInstantiated) {\r\n\t\t\t\t\t\tUtils.getData(element, \"tooltip\").destroy();\r\n\t\t\t\t\t\tisInstantiated = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Instantiate plugin with tooltip value\r\n\t\t\t\t\telement.tooltip(newValue);\r\n\t\t\t\t\tisInstantiated = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst tooltipData = Utils.getData(element, \"tooltip\") as xi.ITooltipApi;\r\n\t\t\tif (isInstantiated && tooltipData) {\r\n\t\t\t\ttooltipData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\r\n\t\t\tTooltipDirective.DIRECTIVE_NAME,\r\n\t\t\t() => {\r\n\t\t\t\treturn new TooltipDirective();\r\n\t\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Track Dirty Directive.\r\n *\r\n * Indicates if an element is dirty.\r\n */\r\nexport class TrackDirtyDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTrackDirty\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\tpublic replace = true;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\telement.attr(\"data-trackdirty\", \"true\");\r\n\t\telement.trackdirty();\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(TrackDirtyDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new TrackDirtyDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IValidateOptions } from \"../../model/sohoxi/sohoxi-validate.model\";\r\n\r\n/**\r\n * Validation Directive.\r\n *\r\n * Validates input based on the options. Possible validations are \"required\", \"date\" and \"time\".\r\n * If validation is \"time\", the \"timeFormat\" option can be set.\r\n * Instead of providing av options object, the following attributes can be used:\r\n * data-validate\r\n * data-time-format\r\n *\r\n * Examples:\r\n * <input xi-validate=\"time\" xi-time-format=\"HH\"/>\r\n */\r\nexport class ValidateDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiValidate\";\r\n\r\n\tpublic require = \"?ngModel\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[ValidateDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IValidateOptions) => {\r\n\t\t\t\t// Use options object or attributes\r\n\t\t\t\tif (!newOptions) {\r\n\t\t\t\t\t// Use attributes\r\n\t\t\t\t\telement.validate();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (newOptions.validation) {\r\n\t\t\t\t\t\telement.attr(\"data-validate\", newOptions.validation);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newOptions.timeFormat) {\r\n\t\t\t\t\t\telement.attr(\"data-time-format\", newOptions.timeFormat);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telement.validate();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ValidateDirective.DIRECTIVE_NAME, [\r\n\t\t\t() => {\r\n\t\t\t\treturn new ValidateDirective();\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDocument } from \"ng2/common/model/swagger.model\";\r\n\r\n/**\r\n * Various utility functions, exposed as static methods.\r\n */\r\nexport class ComponentHelper {\r\n\r\n\t/**\r\n\t * Transform a Swagger document such that every $ref is replaced by the object it is referencing.\r\n\t *\tTODO: Should use a proper parser/validator for JSON-schema.\r\n\t\t*/\r\n\tpublic static dereferenceSwagger(doc: IDocument): IDocument {\r\n\t\t// Clone the document to avoid side-effects. (SLOW! Wait for Object.assign support?)\r\n\t\tconst copy: IDocument = JSON.parse(JSON.stringify(doc));\r\n\r\n\t\tComponentHelper.mapObject(copy, (key, value) => {\r\n\t\t\tif (key === \"$ref\") {\r\n\t\t\t\tconst {prop, propName} = ComponentHelper.lookupRef(value, copy);\r\n\t\t\t\tif (prop) {\r\n\t\t\t\t\treturn { key: propName, value: prop };\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn(`Could not dereference ${value}`);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn copy;\r\n\t}\r\n\r\n\t/**\r\n\t * Transform an object by calling the mapFunc on every property.\r\n\t *\r\n\t *\tNOTE: Will modify the given object.\r\n\t\t* @param obj\r\n\t\t* @param mapFunc\r\n\t\t*/\r\n\tpublic static mapObject(obj: IMap<any>, mapFunc: (k: string, value: any) => any): void {\r\n\t\tfor (const propName in obj) {\r\n\t\t\tif (obj.hasOwnProperty(propName)) {\r\n\t\t\t\tif (typeof obj[propName] === \"object\") {\r\n\t\t\t\t\tComponentHelper.mapObject(obj[propName], mapFunc);\r\n\t\t\t\t}\r\n\t\t\t\tconst newProp = mapFunc(propName, obj[propName]);\r\n\t\t\t\tif (newProp !== null) {\r\n\t\t\t\t\t// TODO: Temporary workaround for swagger schema. REMOVEME\r\n\t\t\t\t\tfor (const k in newProp.value) {\r\n\t\t\t\t\t\tobj[k] = newProp.value[k];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// obj[newProp.key] = newProp.value\r\n\t\t\t\t\tdelete (obj[propName]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Look up a JSON-schema reference ('$ref') and return the object it is referencing.\r\n\t * @param path A JSON-schema reference, e.g '#/objectroot/deep/property'\r\n\t * @param obj The object to search for the reference.\r\n\t * @param upperPropName Name of the returned parent object.\r\n\t */\r\n\tpublic static lookupRef(path: string, obj: IMap<any>, upperPropName?: string): { prop: any, propName: string } {\r\n\t\tpath = path.replace(/^#/, \"\");\t// Remove #/\r\n\t\tconst regex = /\\/?[^\\/]+\\/?/;\t\t// Match e.g [/herp/]derp\r\n\t\tconst matches = path.match(regex);\r\n\t\tif (matches) {\r\n\t\t\tconst firstMatch = matches[0];\t// /herp/\r\n\t\t\tconst restOfPath = path.slice(firstMatch.length);\t// 'derp'\r\n\t\t\tconst propName = firstMatch.replace(/\\//g, \"\");\t// 'herp'\r\n\r\n\t\t\treturn ComponentHelper.lookupRef(restOfPath, obj[propName], propName);\r\n\t\t} else {\r\n\t\t\treturn { prop: obj, propName: upperPropName };\r\n\t\t}\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { Component } from \"./component\";\r\n\r\ninterface IComponentCommonScope extends ng.IScope {\r\n\tcomponent: Component;\r\n}\r\n\r\nclass ComponentCommonCtrl {\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n}\r\n\r\nexport class ComponentCommonDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirComponentCommon\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tcontroller: ComponentCommonCtrl,\r\n\t\t\t\ttemplate: require(\"./component-common.html\"),\r\n\t\t\t\treplace: true,\r\n\t\t\t\tscope: true\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=componentCommon> <span class=errorMessage xi-tooltip=componentInstance.errorTooltip ng-if=\\\"componentInstance.errorTooltip != null && componentInstance.isShowError\\\"> <svg class=\\\"icon icon-error\\\" focusable=false aria-hidden=true> <use xlink:href=#icon-error></use> </svg> <span class=audible>Error</span> </span> <div class=\\\"component-tooltip row\\\"> <div class=\\\"component-name id-{{::component.id}}\\\"> <span class=focus-type-target>Target Component</span> <span class=focus-type-source>Source Component</span> <span class=\\\"normal-name small-thin-text\\\">{{component.displayName}}</span> <svg ng-if=!componentInstance.isGenerated class=icon-selectionbox focusable=false> <use xlink:href=#icon-more></use> </svg> </div> <div class=arrow-down-outer> <div class=arrow-down-inner></div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { ComponentClassNames, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentScope } from \"../common/interface/icomponent-scope\";\r\nimport { LayoutComponent } from \"./layout-component\";\r\n\r\nimport { ComponentsHelper } from \"./helper\";\r\nimport { FrameworkService } from \"./services/framework-service\";\r\n\r\nexport class ComponentDirective implements ng.IDirective {\r\n\t// Found guide to make directive in typescript\r\n\t//http://blog.aaronholmes.net/writing-angularjs-directives-as-typescript-classes/\r\n\tpublic restrict = \"E\";\r\n\tpublic scope = {\r\n\t\tcomponent: \"=\",\r\n\t\tparent: \"=\",\r\n\t\tcontext: \"=\",\r\n\t\tgeneratedId: \"=\",\r\n\t\tcomponentReady: \"&\",\r\n\t\tcomponentDestroyed: \"&\"\r\n\t};\r\n\tpublic replace = true;\r\n\tpublic link: (scope: ng.IScope, element: ng.IAugmentedJQuery, attrs: ng.IAttributes) => void;\r\n\tpublic template: (element: ng.IAugmentedJQuery, attrs: ng.IAttributes) => string;\r\n\tpublic controllerExists: (controllerName: string) => boolean;\r\n\r\n\tconstructor(\r\n\t\tprivate $compile: ng.ICompileService,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate $controller: ng.IControllerService\r\n\t) {\r\n\t\tComponentDirective.prototype.controllerExists = (controllerName: string) => {\r\n\t\t\ttry {\r\n\t\t\t\tthis.$controller(controllerName, null, true);\r\n\t\t\t\treturn true;\r\n\t\t\t} catch (e) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tComponentDirective.prototype.template = (element: ng.IAugmentedJQuery, attrs: ng.IAttributes) => {\r\n\t\t\t// Keeping the eir-component node name because of css-reasons\r\n\t\t\tconst template = $(\"<eir-component></eir-component>\");\r\n\t\t\ttemplate.attr(\"id\", \"{{component.id}}\");\r\n\t\t\ttemplate.attr(\"xi-busy\", \"componentInstance.isLoading\");\r\n\t\t\ttemplate.attr(\"ng-show\", \"componentInstance.isVisible\");\r\n\r\n\t\t\tif (frameworkService.isDesigner()) {\r\n\t\t\t\tconst editorControllerName = ComponentClassNames.EDITOR_COMPONENT_PREFIX + element.attr(\"typedef\");\r\n\t\t\t\tif (!this.controllerExists(editorControllerName)) {\r\n\t\t\t\t\t// TODO: Decide on fallback or error\r\n\t\t\t\t\t//editorControllerName = ComponentClassNames.EDITOR_COMPONENT_PREFIX + ComponentClassNames.COMPONENT;\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"[Component directive] Not implemented controller for component of type: \" + element.attr(\"typedef\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttemplate.attr(\"eir-editor-component\", editorControllerName);\r\n\t\t\t\ttemplate.attr(\"ng-click\", \"componentInstance.onClick($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-attr-draggable\", \"{{eirEditorComponent.isDraggable}}\");\r\n\t\t\t\ttemplate.attr(\"ng-dragenter\", \"componentInstance.onDragenter($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-dragleave\", \"componentInstance.onDragleave($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-dragover\", \"componentInstance.onDragover($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-dragstart\", \"componentInstance.onDragstart($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-drop\", \"componentInstance.onDrop($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-mouseleave\", \"componentInstance.onMouseLeave($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-mousemove\", \"componentInstance.onMouseMove($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-mouseover\", \"componentInstance.onMouseOver($event);\");\r\n\t\t\t\tconst classes: string[] = [];\r\n\t\t\t\tclasses.push(\"{ isHovered: eirEditorComponent.isHovered }\");\r\n\t\t\t\tclasses.push(\"{ isSelected: eirEditorComponent.isSelected }\");\r\n\t\t\t\tclasses.push(\"{ isWizardFocus: eirEditorComponent.wizardFocusType===1 }\");\r\n\t\t\t\tclasses.push(\"{ isWizardRest: eirEditorComponent.wizardFocusType===2 }\");\r\n\t\t\t\tclasses.push(\"{ isFinder: eirEditorComponent.isFinder }\");\r\n\t\t\t\tclasses.push(\"{ isInsertParent: eirEditorComponent.isInsertParent }\");\r\n\t\t\t\tclasses.push(\"{ isInsertChild: eirEditorComponent.isInsertChild }\");\r\n\r\n\t\t\t\ttemplate.attr(\"ng-class\", \"[\" + classes.join(\", \") + \"]\");\r\n\t\t\t}\r\n\t\t\treturn template[0].outerHTML;\r\n\t\t};\r\n\r\n\t\tComponentDirective.prototype.link = (\r\n\t\t\t$scope: IComponentScope,\r\n\t\t\t$element: ng.IAugmentedJQuery,\r\n\t\t\t$attrs: ng.IAttributes\r\n\t\t) => {\r\n\r\n\t\t\tif (!$scope.component) { throw new Error(\"[ComponentDirective] Component not set\"); }\r\n\t\t\tif (!$scope.context) { throw new Error(\"[ComponentDirective] Context not provided\"); }\r\n\t\t\tif (!$scope.parent) { throw new Error(\"[ComponentDirective] Parent not provided\"); }\r\n\r\n\t\t\tconst component = $scope.component;\r\n\t\t\tconst parentInstance = $scope.parent;\r\n\t\t\t$scope.context = Object.create($scope.context);\r\n\t\t\t// Passing scope via the $element\r\n\t\t\t$element.data(\"eir-scope\", $scope);\r\n\r\n\t\t\tconst componentInstance = ComponentsHelper.instantiateComponent(\r\n\t\t\t\tcomponent, $element, parentInstance, this.frameworkService);\r\n\t\t\t$scope.componentInstance = componentInstance;\r\n\r\n\t\t\tconst template = document.createElement(\"d\" + componentInstance.getTypedef().toLowerCase());\r\n\r\n\t\t\tthis.$compile(template)($scope, (clone, scope) => {\r\n\t\t\t\t$element.empty();\r\n\t\t\t\tconst commonPart = this.$compile(\"<eir-component-common></eir-component-common>\")($scope);\r\n\t\t\t\t$element.append(commonPart);\r\n\t\t\t\t$element.append(clone);\r\n\r\n\t\t\t\t// Components that are not Layout resolve via linking function added from defines\r\n\t\t\t\tif (componentInstance instanceof LayoutComponent) {\r\n\t\t\t\t\t$scope.onChildrenReady = () => {\r\n\t\t\t\t\t\tcomponentInstance.onChildrenReady();\r\n\t\t\t\t\t\t$scope.componentReady({ componentInstance: componentInstance });\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.$on(AngularConstants.DESTROY, (ev: ng.IAngularEvent) => {\r\n\t\t\t\t\t$scope.componentDestroyed({ componentInstance: componentInstance });\r\n\t\t\t\t\tcomponentInstance.element.empty();\r\n\t\t\t\t\tcomponentInstance.element.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = (\r\n\t\t\t$compile: ng.ICompileService,\r\n\t\t\tframeworkService: FrameworkService,\r\n\t\t\t$controller) => {\r\n\t\t\treturn new ComponentDirective($compile, frameworkService, $controller);\r\n\t\t};\r\n\t\tdirective.$inject = [\r\n\t\t\tAngularConstants.COMPILE,\r\n\t\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\t\tAngularConstants.CONTROLLER\r\n\t\t];\r\n\t\tm.directive(\"eirComponentDirective\", directive);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { InjectNames, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\nimport { FeatureSwitchService } from \"../../common/services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"../../common/shared-components/base/feature-switch-ctrl\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport interface IThemes {\r\n\tdata: string;\r\n\tdisplayName: string;\r\n}\r\n\r\nexport class TitlebarCtrl extends FeatureSwitchCtrl {\r\n\r\n\tpublic showTitlebar: boolean;\r\n\tpublic showThemeSwitch: boolean;\r\n\tpublic title: string;\r\n\tpublic currentTheme: ThemeEnum;\r\n\r\n\tpublic themes: IThemes[] =\r\n\t\t[\r\n\t\t\t{\r\n\t\t\t\tdata: \"light-theme\",\r\n\t\t\t\tdisplayName: \"Light\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tdata: \"dark-theme\",\r\n\t\t\t\tdisplayName: \"Dark\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tdata: \"high-contrast-theme\",\r\n\t\t\t\tdisplayName: \"High Contrast\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tdata: \"light-transparent-theme\",\r\n\t\t\t\tdisplayName: \"Light Transparent\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tdata: \"dark-transparent-theme\",\r\n\t\t\t\tdisplayName: \"Dark Transparent\"\r\n\t\t\t}\r\n\t\t];\r\n\r\n\tprivate unsubscribers: Array<Function> = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tfeatureSwitchService: FeatureSwitchService,\r\n\t) {\r\n\t\tsuper(featureSwitchService);\r\n\r\n\t\tthis.updateSettings(frameworkService.getCurrentProject().manifest);\r\n\r\n\t\t// Event used in editor when editing project settings\r\n\t\tthis.unsubscribers.push(frameworkService.projectSettingsChangedEvent.on((manifest) => {\r\n\t\t\tthis.updateSettings(manifest);\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(frameworkService.currentCanvasThemeChangedEvent.on((theme: ThemeEnum) => {\r\n\t\t\tthis.currentTheme = theme;\r\n\t\t}));\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic updateSettings(manifest: DesignerManifest): void {\r\n\t\tthis.currentTheme = manifest.defaultTheme;\r\n\t\tthis.showTitlebar = manifest.showTitleBar;\r\n\t\tthis.showThemeSwitch = manifest.themeSwitchEnabled;\r\n\t\tthis.title = this.isFeatureTranslationEnabled() ?\r\n\t\t\tthis.frameworkService.getTranslatableHeaderString() :\r\n\t\t\tmanifest.title;\r\n\t}\r\n\r\n\tpublic changeCanvasTheme(theme: ThemeEnum): void {\r\n\t\tthis.frameworkService.setCanvasTheme(theme);\r\n\t}\r\n}\r\n\r\nexport class TitlebarDirective implements ng.IDirective {\r\n\tcontroller = TitlebarCtrl;\r\n\tcontrollerAs = \"eirTitlebarCtrl\";\r\n\ttemplate = require(\"./titlebar.html\");\r\n\treplace = true; // Important for css-rule\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive = () => new TitlebarDirective();\r\n\t\tm.directive(\"eirTitlebar\", directive);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<header class=\\\"header is-personalizable application-header\\\" ng-if=eirTitlebarCtrl.showTitlebar ng-class=\\\"{'with-themeswitcher' : eirTitlebarCtrl.showThemeSwitch}\\\"> <div class=\\\"toolbar has-title\\\" ng-class=\\\"{'has-more-button' : eirTitlebarCtrl.showThemeSwitch}\\\"> <div class=title> <h1>{{eirTitlebarCtrl.title}}</h1> </div> <div ng-if=eirTitlebarCtrl.showThemeSwitch> <button class=btn-menu xi-popupmenu> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=\\\"popupmenu is-selectable\\\"> <li class=heading>Theme</li> <li ng-repeat=\\\"theme in eirTitlebarCtrl.themes\\\" ng-class=\\\"{'is-checked':eirTitlebarCtrl.currentTheme === $index + 1}\\\"> <a ng-click=\\\"eirTitlebarCtrl.changeCanvasTheme($index + 1)\\\" data-theme=theme.data> {{theme.displayName}} </a> </li> </ul> </div> </div> </header>\";\n// Exports\nmodule.exports = code;","import { HttpService } from \"../common/services/http-service\";\r\n\r\nimport { ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonDesigner } from \"../common/model/designer.model\";\r\n\r\nexport class Designer {\r\n\tprivate userDisplayName: string;\r\n\r\n\tpublic getUserDisplayName(): string { return this.userDisplayName; }\r\n\r\n\tprivate userName: string;\r\n\r\n\tpublic getUserName(): string { return this.userName; }\r\n\r\n\tpublic fromJson(obj: IJsonDesigner): void {\r\n\t\tif (obj === null) {\r\n\t\t\tthrow new Error(\"Json object was null and could therefore not be loaded.\");\r\n\t\t}\r\n\r\n\t\tthis.userDisplayName = obj.userDisplayName;\r\n\t\tthis.userName = obj.userName;\r\n\t}\r\n\r\n\tpublic static info(httpService: HttpService): ng.IPromise<Designer> {\r\n\t\treturn httpService.executeGet(ServerPaths.DESIGNER).then((data: IJsonDesigner) => {\r\n\t\t\tconst designer: Designer = new Designer();\r\n\t\t\tdesigner.fromJson(data);\r\n\t\t\treturn designer;\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirDuplicateProjectCtrl as ctrl\\\"> <div class=field> <label for=duplicateName class=required>Name</label> <input id=duplicateName type=text class=required ng-model=ctrl.projectName aria-required=true data-validate=required xi-validate/> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.duplicate()>Duplicate</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { RepositoryService } from \"./repository-service\";\r\n\r\n// Repository Dashboard View Imports\r\nimport { RepositoryDirective } from \"./repository\";\r\n\r\n// Datasource Tab Imports\r\nimport { DatasourceTabComponent } from \"./datasource/datasource-tab-ctrl\";\r\n\r\n// Data Service Wizard\r\nimport { SelectSourceCtrl } from \"./datasource/create-from-wizard/select-source-ctrl\";\r\nimport { DatasourceParameterComponent } from \"./datasource/create-wizard/datasource-parameter/datasource-parameter-component\";\r\nimport { DatasourceWizardCtrl } from \"./datasource/create-wizard/datasource-wizard-ctrl\";\r\nimport { JsonpathHelpDialogCtrl } from \"./datasource/create-wizard/jsonpath-help-dialog/jsonpath-help-dialog-ctrl\";\r\nimport { RequestEditorDialogCtrl } from \"./datasource/create-wizard/request-header-editor/dialog/request-editor-ctrl\";\r\nimport { RequestHeaderEditorComponent } from \"./datasource/create-wizard/request-header-editor/request-header-editor-component\";\r\nimport { EditUrlDialogCtrl } from \"./datasource/create-wizard/resource-url-editor/edit-url-dialog/edit-url-dialog-ctrl\";\r\nimport { ResourceUrlEditorComponent } from \"./datasource/create-wizard/resource-url-editor/resource-url-editor-component\";\r\nimport { ViewJsonDialogCtrl } from \"./datasource/create-wizard/view-json-dialog/view-json-dialog-ctrl\";\r\nimport { DatasourceUpsertDialogCtrl } from \"./datasource/dialog/datasource-upsert-dialog-ctrl\";\r\nimport { SwaggerSchemaExpanderComponent } from \"./datasource/dialog/swagger-schema-expander\";\r\nimport { IonApiOperationDetails } from \"./datasource/search/ion-api/ion-api-operation-details-ctrl\";\r\nimport { IonApiSearchCtrl } from \"./datasource/search/ion-api/ion-api-search-wizard-ctrl\";\r\n\r\n// Local IDO Data Service\r\nimport { LocalIdoDataserviceParametersComponent } from \"./datasource/create-wizard/local-ido/dataservice-parameters/dataservice-parameters-component\";\r\nimport { LocalIdoDataserviceSummaryDatagridComponent } from \"./datasource/create-wizard/local-ido/dataservice-summary/dataservice-summary-datagrid-component\";\r\nimport { LocalIdoDataserviceWizardCtrl } from \"./datasource/create-wizard/local-ido/dataservice-wizard-ctrl\";\r\nimport { LocalIdoOperationDetails } from \"./datasource/search/local-ido/operation-details-ctrl\";\r\nimport { LocalIdoSearchCtrl } from \"./datasource/search/local-ido/search-wizard-ctrl\";\r\n\r\n// Composite Component Tab\r\nimport { CompositeTabComponent } from \"./composite/composite-tab-ctrl\";\r\n\r\n// IDO Tab\r\nimport { IdoWizardCtrl } from \"./ido/create/ido-wizard-ctrl\";\r\nimport { PreviewCtrl } from \"./ido/create/preview-dialog/preview-ctrl\";\r\nimport { IdoPropertyComponent } from \"./ido/create/property-component/ido-property-component\";\r\nimport { IdoPropertyDatagridComponent } from \"./ido/create/property-datagrid-component/ido-property-datagrid-component\";\r\nimport { IdoTabComponent } from \"./ido/ido-tab-ctrl\";\r\n\r\n// Inline list\r\nimport { AddNewColumnDialogCtrl } from \"./datasource/create-wizard/inline-list/add-new-column/add-new-column\";\r\nimport { InlineListDataserviceWizardCtrl } from \"./datasource/create-wizard/inline-list/dataservice-wizard-ctrl\";\r\nimport { DeleteColumnDialogCtrl } from \"./datasource/create-wizard/inline-list/delete-column/delete-column\";\r\nimport { InlineListDataserviceSummaryDatagridComponent } from \"./datasource/create-wizard/inline-list/summary-page/dataservice-wizard-summary-component\";\r\n\r\nexport const repositoryModule = angular.module(\"repositoryModule\", []);\r\n\r\nRepositoryService.add(repositoryModule);\r\n\r\n// Repository Dashboard Views\r\nRepositoryDirective.add(repositoryModule);\r\n\r\n//#region Data Service Tab\r\nDatasourceTabComponent.add(repositoryModule);\r\n\r\n// ION Data Service Wizard\r\nDatasourceUpsertDialogCtrl.add(repositoryModule);\r\nDatasourceWizardCtrl.add(repositoryModule);\r\nDatasourceParameterComponent.add(repositoryModule);\r\nEditUrlDialogCtrl.add(repositoryModule);\r\nIonApiSearchCtrl.add(repositoryModule);\r\nIonApiOperationDetails.add(repositoryModule);\r\nJsonpathHelpDialogCtrl.add(repositoryModule);\r\nRequestEditorDialogCtrl.add(repositoryModule);\r\nRequestHeaderEditorComponent.add(repositoryModule);\r\nResourceUrlEditorComponent.add(repositoryModule);\r\nSelectSourceCtrl.add(repositoryModule);\r\nSwaggerSchemaExpanderComponent.add(repositoryModule);\r\nViewJsonDialogCtrl.add(repositoryModule);\r\n\r\n// Local IDO Data Service Wizard\r\nLocalIdoSearchCtrl.add(repositoryModule);\r\nLocalIdoOperationDetails.add(repositoryModule);\r\nLocalIdoDataserviceWizardCtrl.add(repositoryModule);\r\nLocalIdoDataserviceParametersComponent.add(repositoryModule);\r\nLocalIdoDataserviceSummaryDatagridComponent.add(repositoryModule);\r\n\r\n// Inline List Data Source\r\nInlineListDataserviceWizardCtrl.add(repositoryModule);\r\nAddNewColumnDialogCtrl.add(repositoryModule);\r\nDeleteColumnDialogCtrl.add(repositoryModule);\r\nInlineListDataserviceSummaryDatagridComponent.add(repositoryModule);\r\n//#endregion\r\n\r\n//#region Composite Component Tab\r\nCompositeTabComponent.add(repositoryModule);\r\n//#endregion\r\n\r\n//#region IDO Tab\r\nIdoTabComponent.add(repositoryModule);\r\nIdoWizardCtrl.add(repositoryModule);\r\nIdoPropertyComponent.add(repositoryModule);\r\nIdoPropertyDatagridComponent.add(repositoryModule);\r\nPreviewCtrl.add(repositoryModule);\r\n//#endregion\r\n","import { AppState } from \"../../app.state\";\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { ViewEnum } from \"../../common/defines\";\r\nimport { DesignerService } from \"../services/designer-service\";\r\n\r\nenum RepositoryTabEnum {\r\n\tDATASOURCE,\r\n\tCOMPOSITE,\r\n\tIDO,\r\n}\r\n\r\nclass RepositoryCtrl {\r\n\tpublic canNavigateBack: boolean;\r\n\tpublic tabEnum = RepositoryTabEnum;\r\n\tpublic currentTab: RepositoryTabEnum = RepositoryTabEnum.DATASOURCE;\r\n\r\n\tprivate fromEditor: boolean;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.STATE_SERVICE,\r\n\t\tInjectNames.DESIGNER_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $state: ng.ui.IStateService,\r\n\t\tprivate designerService: DesignerService,\r\n\t) {\r\n\t\tthis.setCanNavigateBack();\r\n\r\n\t\tdesignerService.setView(ViewEnum.REPOSITORY);\r\n\t}\r\n\r\n\tpublic onChangeTab(tab: RepositoryTabEnum): void {\r\n\t\tthis.currentTab = tab;\r\n\t}\r\n\r\n\tpublic navigateBack(): void {\r\n\t\tif (this.canNavigateBack) {\r\n\t\t\tif (this.fromEditor) {\r\n\t\t\t\tthis.$state.go(AppState.EDITOR.name, {\r\n\t\t\t\t\tid: this.designerService.getCurrentProject().getId(),\r\n\t\t\t\t\treloadProject: false,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.$state.go(AppState.HOME.name);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setCanNavigateBack(): void {\r\n\t\tconst currentView = this.designerService.getView();\r\n\r\n\t\tthis.canNavigateBack = currentView === ViewEnum.DASHBOARD || currentView === ViewEnum.EDITOR;\r\n\t\tif (this.canNavigateBack) {\r\n\t\t\tthis.fromEditor = currentView === ViewEnum.EDITOR;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class RepositoryDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirRepository\", () => {\r\n\t\t\treturn {\r\n\t\t\t\ttemplate: require(\"./repository.html\"),\r\n\t\t\t\tcontroller: RepositoryCtrl,\r\n\t\t\t\tcontrollerAs: \"eirRepositoryCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<header class=header> <div class=toolbar> <div class=title> <button class=\\\"btn-icon application-menu-trigger\\\" type=button ng-if=eirRepositoryCtrl.canNavigateBack ng-click=eirRepositoryCtrl.navigateBack()> <span class=\\\"icon app-header go-back\\\"> <span class=one></span> <span class=two></span> <span class=three></span> </span> </button> <h1><span>App Builder Repository</span></h1> </div> </div> </header> <div id=repository-tabs class=\\\"tab-container alternate\\\" xi-tabs> <ul class=tab-list role=tablist aria-multiselectable=false> <li class=\\\"tab is-selected\\\"> <a href=#datasource-tab class=hyperlink ng-click=eirRepositoryCtrl.onChangeTab(eirRepositoryCtrl.tabEnum.DATASOURCE)>Data Services</a> </li> <li class=tab> <a href=#composite-tab class=hyperlink ng-click=eirRepositoryCtrl.onChangeTab(eirRepositoryCtrl.tabEnum.COMPOSITE)>Composite Components</a> </li>  <li class=tab> <a href=#ido-tab class=hyperlink ng-click=eirRepositoryCtrl.onChangeTab(eirRepositoryCtrl.tabEnum.IDO)>IDOs</a> </li> </ul> </div> <div class=\\\"maincontent scrollable\\\"> <div id=datasource-tab class=\\\"scrollable repository-tab\\\"> <eir-datasource-tab ng-if=\\\"eirRepositoryCtrl.currentTab === eirRepositoryCtrl.tabEnum.DATASOURCE\\\"></eir-datasource-tab> </div> <div id=composite-tab class=\\\"scrollable repository-tab\\\"> <eir-composite-tab ng-if=\\\"eirRepositoryCtrl.currentTab === eirRepositoryCtrl.tabEnum.COMPOSITE\\\"></eir-composite-tab> </div> <div id=ido-tab class=\\\"scrollable repository-tab\\\"> <eir-ido-tab ng-if=\\\"eirRepositoryCtrl.currentTab === eirRepositoryCtrl.tabEnum.IDO\\\"></eir-ido-tab> </div> </div> \";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nexport abstract class CacheableCtrl {\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.CACHE_FACTORY\r\n\t];\r\n\r\n\tprivate cacheObject: ng.ICacheObject;\r\n\r\n\tconstructor(\r\n\t\t$cacheFactory: ng.ICacheFactoryService\r\n\t) {\r\n\t\tthis.setCacheObject($cacheFactory);\r\n\t}\r\n\r\n\tprivate setCacheObject($cacheFactory: ng.ICacheFactoryService): void {\r\n\t\tconst cacheId = (this.constructor as any).name;\r\n\t\tconst cacheObject = $cacheFactory.get(cacheId);\r\n\r\n\t\tthis.cacheObject = cacheObject === undefined ?\r\n\t\t\t$cacheFactory(cacheId) :\r\n\t\t\tcacheObject;\r\n\t}\r\n\r\n\tprotected getFromCache<T>(key: string): T {\r\n\t\treturn this.cacheObject.get(key);\r\n\t}\r\n\r\n\tprotected saveToCache<T>(key: string, value: T): void {\r\n\t\tthis.cacheObject.put<T>(key, value);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=row> <div class=\\\"twelve columns\\\"> <div class=toolbar role=toolbar id=toolbar-dataservice xi-toolbar='{\\\"maxVisibleButtons\\\": 5}'> <div class=title></div> <div class=buttonset> <div class=\\\"searchfield-wrapper toolbar-searchfield-wrapper\\\"> <label class=audible for=searchfield-local-datasource>Keyword Search</label> <input id=searchfield-local-datasource name=searchfield-local-datasource class=searchfield data-options=\\\"{ collapsible: true }\\\"/> </div> <button class=\\\"btn btn-menu\\\" type=button xi-tooltip=\\\"'Add Data Service'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>Add Data Service</span> </button> <ul class=\\\"popupmenu is-padded\\\"> <li> <a ng-click=eirDatasourceTabCtrl.create(true)> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-magic-wand></use> </svg> <span>Create from Wizard</span> </a> </li> <li class=separator></li> <li> <a ng-click=eirDatasourceTabCtrl.import()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-import></use> </svg> <span>Import from File</span> </a> </li> <li> <a ng-click=eirDatasourceTabCtrl.openDataserviceWizard()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-compose></use> </svg> <span>Configure Data Service Manually</span> </a> </li> </ul> <button class=btn-tertiary type=button ng-disabled=\\\"eirDatasourceTabCtrl.selectedDataItems.length !== 1\\\" ng-click=eirDatasourceTabCtrl.editDatasource() xi-tooltip=\\\"'Edit Data Service'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-edit></use> </svg> <span>Edit</span> </button> <button class=btn-tertiary type=button ng-disabled=!eirDatasourceTabCtrl.anySelectedDataItem ng-click=eirDatasourceTabCtrl.delete() xi-tooltip=\\\"'Delete'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> <button class=btn type=button ng-disabled=!eirDatasourceTabCtrl.anySelectedDataItem ng-click=eirDatasourceTabCtrl.exportDatasource()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-export></use> </svg> <span>Export to File</span> </button> </div> </div> <div id=\\\"{{ eirDatasourceTabCtrl.datagridId }}\\\" xi-datagrid=eirDatasourceTabCtrl.datagridOptions></div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=dataservice-search-wizard xi-busy=$ctrl.isBusy ng-controller=\\\"eirLocalIdoSearchCtrl as $ctrl\\\"> <div class=search> <form ng-submit=\\\"$ctrl.searchOperations(selectedOption, query)\\\"> <div class=compound-field> <div class=field> <label for=generic-suites class=label>Project</label> <select id=generic-suites name=generic-suites class=\\\"dropdown dropdown-sm\\\" ng-model=selectedOption ng-options=\\\"option as option.serverName for option in $ctrl.dropdownOptions\\\" xi-drop-down> </select> </div> <div class=field> <label for=generic-search>Search</label> <input id=generic-search class=searchfield name=generic-search placeholder=\\\"Search for something\\\" autocomplete=off ng-model=query /> </div> <div class=field> <label for=generic-search-button></label> <button id=generic-search-button class=btn-primary type=submit name=generic-search-button>Search</button> </div> </div> </form> </div> <div class=results> <div class=list> <div class=field> <h2 class=card-title ng-show=\\\"$ctrl.operations.length > 0\\\"> Showing {{filteredOperations.length}} results <span ng-show=\\\"$ctrl.operations.length - filteredOperations.length > 0\\\"> ({{$ctrl.operations.length - filteredOperations.length}} hidden) </span> </h2> </div> <div id=search-result-list class=listview> <ul> <li id=list-item-{{$index}} ng-repeat=\\\"operation in $ctrl.operations | filter: methodsFilter as filteredOperations track by $index \\\" ng-click=\\\"$ctrl.onToggleSelected(operation, $index)\\\" class=search-li> <div class=summary> <p class=listview-heading style=width:fit-content xi-tooltip=operation.collectionName> {{operation.collectionName | limitTo: 60}} {{operation.collectionName.length > 60 ? \\\"...\\\" : \\\"\\\"}} </p> <p class=listview-subheading>{{operation.serverName}}</p> <p class=listview-micro>{{operation.collectionDesc}}</p> </div> <button class=btn ng-click=$ctrl.showOperationDetails(operation)> Details </button> </li> </ul> </div> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=$ctrl.cancel()> Cancel </button> <button type=button class=btn-modal ng-click=$ctrl.back()> Back </button> <button type=button class=btn-modal-primary ng-click=$ctrl.runCreateNewWizard($ctrl.focusedOperation) ng-disabled=\\\"!$ctrl.focusedOperation || $ctrl.isBusy\\\"> Next </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=dataservice-search-wizard xi-busy=$ctrl.isBusy ng-controller=\\\"eirIonApiSearchCtrl as $ctrl\\\"> <div class=search> <form ng-submit=\\\"$ctrl.searchOperations(selectedOption, query)\\\"> <div class=compound-field> <div class=field> <label for=generic-suites class=label>Suite</label> <select id=generic-suites name=generic-suites class=\\\"dropdown dropdown-sm\\\" ng-model=selectedOption ng-options=\\\"option as option.name for option in $ctrl.dropdownOptions\\\" xi-drop-down> </select> </div> <div class=field> <label for=generic-search>Search</label> <input id=generic-search class=searchfield name=generic-search placeholder=\\\"Search for something\\\" autocomplete=off ng-model=query /> </div> <div class=field> <label for=generic-search-button></label> <button id=generic-search-button class=btn-primary type=submit name=generic-search-button>Search</button> </div> </div> </form> </div> <div class=results> <div class=filters> <div class=field> <h4>Filters</h4> </div> <div class=field ng-repeat=\\\"opt in $ctrl.filterOptions\\\"> <input type=checkbox class=checkbox name=cb-{{opt.method}} id=cb-{{opt.method}} ng-model=opt.checked /> <label for=cb-{{opt.method}} class=checkbox-label>{{opt.displayText}}</label> </div> </div> <div class=list> <div class=field> <h2 class=card-title ng-show=\\\"$ctrl.operations.length > 0\\\"> Showing {{filteredOperations.length}} results <span ng-show=\\\"$ctrl.operations.length - filteredOperations.length > 0\\\"> ({{$ctrl.operations.length - filteredOperations.length}} hidden) </span> </h2> </div> <div id=search-result-list class=listview> <ul> <li id=list-item-{{$index}} ng-repeat=\\\"operation in $ctrl.operations | filter: methodsFilter as filteredOperations track by $index \\\" ng-click=\\\"$ctrl.onToggleSelected(operation, $index)\\\" class=search-li> <div class=summary> <p class=listview-heading style=width:fit-content xi-tooltip=operation.operationSummary> {{operation.operationSummary | limitTo: 60}} {{operation.operationSummary.length > 60 ? \\\"...\\\" : \\\"\\\"}} </p> <p class=listview-subheading xi-tooltip=operation.restPath>{{operation.restPath}}</p> <p class=listview-micro>{{operation.proxyPath}}</p> </div> <button class=btn ng-click=$ctrl.showOperationDetails(operation)> Details </button> </li> </ul> </div> </div> </div> <div class=row ng-if=\\\"$ctrl.configStep === 1\\\"> <div class=row> <button class=\\\"btn-tertiary btn--left-float\\\" type=button ng-click=\\\"$ctrl.configStep = 0\\\"> <svg class=icon><use xlink:href=#icon-caret-left></use></svg> <span>Back to results</span> </button> <button class=\\\"btn-tertiary btn--right-float\\\" type=button ng-click=$ctrl.runCreateNewWizard($ctrl.focusedOperation)> <svg class=icon><use xlink:href=#icon-add></use></svg> <span>Create Data Service</span> </button> </div> <div class=\\\"columns operation-details\\\" ng-init=\\\"op = $ctrl.swagger.paths[$ctrl.focusedOperation.restPath][$ctrl.focusedOperation.method]\\\"> <h1>{{$ctrl.focusedOperation.productName}}</h1> <h2>{{$ctrl.swagger.info.title}}</h2> <br/> <h2>{{op.summary}}</h2> <p>{{op.description || 'This operation has no detailed description'}}</p> <small><strong> {{$ctrl.focusedOperation.method | uppercase}} {{$ctrl.focusedOperation.proxyPath}}{{$ctrl.focusedOperation.restPath}} </strong></small> <h2 class=fieldset-title>Input</h2> <div class=row> <div xi-datagrid=$ctrl.parameterDatagridOpts></div> </div> <h2 class=fieldset-title>Output</h2> <div class=row> <div xi-datagrid=$ctrl.responseDatagridOpts></div> </div> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=$ctrl.cancel()> Cancel </button> <button type=button class=btn-modal ng-click=$ctrl.back()> Back </button> <button type=button class=btn-modal-primary ng-click=$ctrl.runCreateNewWizard($ctrl.focusedOperation) ng-disabled=\\\"!$ctrl.focusedOperation || $ctrl.isBusy\\\"> Next </button> </div> </div>\";\n// Exports\nmodule.exports = code;","import jsonpath from \"jsonpath\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport type * as sw from \"ng2/common/model/swagger.model\";\r\n\r\nimport type { IFieldValidationResult, IValidatorError } from \"common/shared-components/base/field-validation\";\r\nimport { IOnComponentChangeNotification, NotifiableComponent } from \"common/shared-components/base/notifiable-component\";\r\nimport { CustomFormatters } from \"common/sohoxi/custom-formatters\";\r\nimport { DatasourceCreateModeEnum } from \"designer/repository/datasource/create-wizard/datasource-wizard-ctrl\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { DatasourceWizardHelper } from \"designer/repository/datasource/create-wizard/datasource-wizard-helper\";\r\nimport { DataServiceHelper } from \"ng2/common/helpers/data-service.helper\";\r\n\r\nimport { DialogButtonType, DialogService } from \"common/services/dialog-service\";\r\n\r\nexport class DatasourceParameterCtrl extends NotifiableComponent {\r\n\tstatic $inject = [\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tparameterTypes: IDataPair[];\r\n\tParameterTypeEnum = ParameterTypeEnum;\r\n\tisPathParameter: boolean;\r\n\tinvalidParameters: boolean[] = [];\r\n\trequiredParameters: boolean[] = [];\r\n\tget isInput(): boolean { return this.isInputPriv; }\r\n\trestPath: string;\r\n\tmatrixPath = \"\";\r\n\tqueryPath: string;\r\n\r\n\tprivate bindingDatasourceParameters: IParameterObject[];\r\n\tprivate isInputPriv: boolean;\r\n\tparameterDatagridOptions: IDataGridOptions<IParameterObject>;\r\n\r\n\t// Component Bindings\r\n\theadTitle: string;\r\n\tswaggerOperation: sw.IOperationObject;\r\n\tget datasourceParameters(): IParameterObject[] { return this.bindingDatasourceParameters; }\r\n\tset datasourceParameters(value: IParameterObject[]) {\r\n\t\tthis.bindingDatasourceParameters = value;\r\n\t}\r\n\tget datasourceResourceUrl(): string {\r\n\t\treturn this.restPath + this.matrixPath + this.queryPath;\r\n\t}\r\n\tset datasourceResourceUrl(value: string) {\r\n\t\t[this.restPath, this.matrixPath, this.queryPath] = DataServiceHelper.deconstructPath(value);\r\n\t}\r\n\tdatasourceCreateMode: DatasourceCreateModeEnum;\r\n\twizardNextDisabled: ($item: any) => void;\r\n\toutputRootElement: string;\r\n\tshowHelp: () => void;\r\n\tprivate generateOutputParameters: (datasource: any) => void;\r\n\tprivate generateInputParameters: (datasource: any) => void;\r\n\tprivate datasource: IJsonGenericDatasource2;\r\n\treadonly: boolean;\r\n\r\n\tprivateErrorList: IValidatorError[] = [];\r\n\tset errorList(value: IValidatorError[]) {\r\n\t\tthis.privateErrorList = value;\r\n\t}\r\n\tget errorList(): IValidatorError[] {\r\n\t\tconst item = this.privateErrorList.length !== 0;\r\n\r\n\t\tif (this.wizardNextDisabled) {\r\n\t\t\tthis.wizardNextDisabled({\r\n\t\t\t\t$item: {\r\n\t\t\t\t\tid: DatasourceParameterComponent.componentName,\r\n\t\t\t\t\tstatus: item\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this.privateErrorList;\r\n\t}\r\n\r\n\tget isInvalid(): boolean {\r\n\t\tconst json = this.isInput ? this.datasource.bodyTemplate : this.datasource.outputJson;\r\n\t\ttry {\r\n\t\t\tif (this.datasource) {\r\n\t\t\t\tjsonpath.query(JSON.parse(json), \"$\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t} catch (e) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tsuper();\r\n\t}\r\n\r\n\t$onInit(): void {\r\n\t\tif (this.headTitle.indexOf(\"Input\") !== -1) {\r\n\t\t\tif (this.swaggerOperation && this.swaggerOperation.parameters) {\r\n\t\t\t\tthis.swaggerOperation.parameters.forEach((swaggerParameter) => {\r\n\t\t\t\t\tif (swaggerParameter.required) {\r\n\t\t\t\t\t\tthis.bindingDatasourceParameters.forEach((datasourceParameter: IParameterObject, index) => {\r\n\t\t\t\t\t\t\tif (swaggerParameter.in === \"query\" && swaggerParameter.name === datasourceParameter.key) {\r\n\t\t\t\t\t\t\t\tthis.requiredParameters[index] = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.isInputPriv = true;\r\n\t\t\tthis.parameterTypes = [\r\n\t\t\t\t{ name: \"Path\", value: ParameterTypeEnum.PATH },\r\n\t\t\t\t{ name: \"Matrix\", value: ParameterTypeEnum.MATRIX },\r\n\t\t\t\t{ name: \"Query\", value: ParameterTypeEnum.QUERY },\r\n\t\t\t\t{ name: \"Body(jsonpath)\", value: ParameterTypeEnum.BODY_PART }\r\n\t\t\t];\r\n\t\t} else {\r\n\t\t\tthis.parameterTypes = [];\r\n\t\t}\r\n\t\tthis.initParameterDatagrid();\r\n\t}\r\n\r\n\tprivate initParameterDatagrid(): void {\r\n\t\tconst columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\twidth: \"30%\",\r\n\t\t\t\tid: \"key\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"key\",\r\n\t\t\t\tsortable: false\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\twidth: \"30%\",\r\n\t\t\t\tid: \"parameterType\",\r\n\t\t\t\tname: \"Type\",\r\n\t\t\t\tfield: \"parameterType\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tformatter: CustomFormatters.DataSourceParameterType()\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\twidth: \"30%\",\r\n\t\t\t\tid: \"alias\",\r\n\t\t\t\tname: \"Alias\",\r\n\t\t\t\tfield: \"alias\",\r\n\t\t\t\tsortable: false\r\n\t\t\t},\r\n\t\t];\r\n\r\n\t\tthis.parameterDatagridOptions = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tisList: true,\r\n\t\t\tselectable: false,\r\n\t\t\tdataset: this.datasourceParameters,\r\n\t\t\trowHeight: \"short\"\r\n\t\t};\r\n\t}\r\n\r\n\tgenerateParameters(): void {\r\n\t\tif (this.isInput) {\r\n\t\t\tthis.generateInputParameters({ $datasource: this.datasource });\r\n\t\t} else {\r\n\t\t\tthis.generateOutputParameters({ $datasource: this.datasource });\r\n\t\t}\r\n\t}\r\n\r\n\tisUrlComponent(type: ParameterTypeEnum): boolean {\r\n\t\tswitch (type) {\r\n\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\treturn true;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tgetParameterTypeName(type: ParameterTypeEnum): string {\r\n\t\tlet name: string;\r\n\t\tthis.parameterTypes.some((dataPair) => {\r\n\t\t\tname = dataPair.name;\r\n\t\t\treturn dataPair.value === type;\r\n\t\t});\r\n\t\treturn name;\r\n\t}\r\n\r\n\tonDeleteDatasourceParameter(item: IParameterObject): void {\r\n\t\tconst deleteParameter = () => {\r\n\t\t\tswitch (item.parameterType) {\r\n\t\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\t\tthis.updateRestPath(item, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\t\t\tthis.updateRestMatrixPath(item, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\t\tthis.updateRestQueryPath(item, true);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.info(\"No change in REST path\");\r\n\t\t\t}\r\n\t\t\tconst index = this.bindingDatasourceParameters.indexOf(item);\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tthis.bindingDatasourceParameters.splice(index, 1);\r\n\t\t\t}\r\n\r\n\t\t\t// clear nextDisabled if needed\r\n\t\t\tthis.privateErrorList = this.privateErrorList.filter(error => error.field !== item.id);\r\n\t\t\tthis.wizardNextDisabled({\r\n\t\t\t\t$item: {\r\n\t\t\t\t\tid: DatasourceParameterComponent.componentName,\r\n\t\t\t\t\tstatus: this.privateErrorList.length !== 0\r\n\t\t\t\t} as IFieldValidationResult\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tif (item.required) {\r\n\t\t\tswitch (this.datasourceCreateMode) {\r\n\t\t\t\tcase DatasourceCreateModeEnum.EDIT:\r\n\t\t\t\tcase DatasourceCreateModeEnum.FROM_SWAGGER:\r\n\t\t\t\t\tthis.dialogService.showYesNo(\r\n\t\t\t\t\t\t\"Warning\",\r\n\t\t\t\t\t\t\"Deleting mandatory parameter may cause data service to stop working. Do you want to continue?\",\r\n\t\t\t\t\t\t\"warning-text\")\r\n\t\t\t\t\t\t.then(result => {\r\n\t\t\t\t\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\t\t\t\t\tdeleteParameter();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DatasourceCreateModeEnum.FROM_SCRATCH:\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tdeleteParameter();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdeleteParameter();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tonAddDatasourceParameter(type: ParameterTypeEnum): void {\r\n\t\tconst newItem: IParameterObject = {\r\n\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\tkey: this.getNewName(type),\r\n\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\tparameterType: type,\r\n\t\t\trequired: type === ParameterTypeEnum.PATH,\r\n\t\t\talias: \"\"\r\n\t\t};\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase ParameterTypeEnum.PATH: {\r\n\t\t\t\tconst index = this.bindingDatasourceParameters.findIndex((item) => {\r\n\t\t\t\t\treturn item.parameterType === ParameterTypeEnum.QUERY;\r\n\t\t\t\t});\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tthis.bindingDatasourceParameters.splice(index, 0, newItem);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.bindingDatasourceParameters.push(newItem);\r\n\t\t\t\t}\r\n\t\t\t\tthis.updateRestPath(newItem);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\t\tthis.bindingDatasourceParameters.push(newItem);\r\n\t\t\t\tthis.updateRestMatrixPath(newItem);\r\n\t\t\t\tbreak;\r\n\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\tthis.bindingDatasourceParameters.push(newItem);\r\n\t\t\t\tthis.updateRestQueryPath(newItem);\r\n\t\t\t\tbreak;\r\n\t\t\tcase ParameterTypeEnum.BODY_PART:\r\n\t\t\t\tthis.bindingDatasourceParameters.push(newItem);\r\n\t\t\t\tbreak;\r\n\t\t\tcase ParameterTypeEnum.OUTPUT:\r\n\t\t\t\tthis.bindingDatasourceParameters.push(newItem);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"unknown\");\r\n\r\n\t\t\t\tthis.isPathParameter = newItem.parameterType === ParameterTypeEnum.PATH;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getNextParamName(baseName: string): string {\r\n\t\tconst elementMatch = this.bindingDatasourceParameters.filter((item) => item.key.match(baseName + \"[0-9]+$\"));\r\n\t\tif (elementMatch.length === 0) {\r\n\t\t\treturn baseName + 0;\r\n\t\t}\r\n\t\tconst lastElement = elementMatch[elementMatch.length - 1];\r\n\t\tconst next = parseInt(lastElement.key.match(/[0-9]+$/g).join()) + 1;\r\n\t\treturn baseName + next;\r\n\t}\r\n\r\n\tprivate getNewName(type: ParameterTypeEnum): string {\r\n\t\tswitch (type) {\r\n\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\treturn this.getNextParamName(\"path\");\r\n\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\t\treturn this.getNextParamName(\"matrix\");\r\n\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\treturn this.getNextParamName(\"query\");\r\n\t\t\tcase ParameterTypeEnum.BODY_PART:\r\n\t\t\t\treturn \"$\";\r\n\t\t\tcase ParameterTypeEnum.OUTPUT:\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateRestPath(newItem: IParameterObject, remove?: boolean): void {\r\n\t\tif (remove) {\r\n\t\t\tthis.restPath = this.restPath\r\n\t\t\t\t.replace(\"/\" + DataServiceHelper.getURLVariable(newItem.key, ParameterTypeEnum.PATH), \"\");\r\n\t\t} else {\r\n\t\t\tthis.restPath += (this.restPath.endsWith(\"/\") ? \"\" : \"/\") +\r\n\t\t\t\tDataServiceHelper.getURLVariable(newItem.key, ParameterTypeEnum.PATH);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateRestMatrixPath(newItem: IParameterObject, remove?: boolean): void {\r\n\t\tconst deletedItem = (item: string) => { return item.split(\"=\")[0] !== encodeURIComponent(newItem.key); };\r\n\t\tif (remove) {\r\n\t\t\tthis.matrixPath = this.matrixPath.split(\";\")\r\n\t\t\t\t.filter(DataServiceHelper.emptyItem).filter(deletedItem).join(\";\");\r\n\t\t} else {\r\n\t\t\tthis.matrixPath += \";\" + DataServiceHelper.getURLVariable(newItem.key, ParameterTypeEnum.MATRIX);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateRestQueryPath(newItem: IParameterObject, remove?: boolean): void {\r\n\t\tconst removeAnyFirstQuestionmarks = (item: string) => {\r\n\t\t\treturn item.charAt(0) === \"?\" ? item.slice(1) : item;\r\n\t\t};\r\n\t\tconst deletedItem = (item: string) => {\r\n\t\t\tconst key = item.split(\"=\")[0];\r\n\t\t\treturn key !== encodeURIComponent(newItem.key);\r\n\t\t};\r\n\t\tif (remove) {\r\n\t\t\t// removes any first questionmarks and filters out the item to be deleted\r\n\t\t\tconst newQueryPath = this.queryPath\r\n\t\t\t\t.split(\"&\")\r\n\t\t\t\t.map(removeAnyFirstQuestionmarks)\r\n\t\t\t\t.filter(deletedItem)\r\n\t\t\t\t.join(\"&\");\r\n\r\n\t\t\t// Adds the questionmark to the beginning only of there is any querypath left.\r\n\t\t\tthis.queryPath = newQueryPath === \"\"\r\n\t\t\t\t? newQueryPath\r\n\t\t\t\t: \"?\" + newQueryPath;\r\n\r\n\t\t} else {\r\n\t\t\tthis.queryPath +=\r\n\t\t\t\t(this.queryPath === \"\" ? \"?\" : \"&\")\r\n\t\t\t\t+ DataServiceHelper.getURLVariable(newItem.key, ParameterTypeEnum.QUERY);\r\n\t\t}\r\n\t}\r\n\r\n\tonUpdateResourceUrl(newItem: IParameterObject, oldItem: IParameterObject, index: number): void {\r\n\t\tif (this.isInput && newItem.key.length === 0) { // Default value and fallback when user erases all chars\r\n\t\t\tnewItem.key = this.getNewName(newItem.parameterType);\r\n\t\t}\r\n\t\tswitch (newItem.parameterType) {\r\n\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\tthis.datasourceResourceUrl =\r\n\t\t\t\t\tthis.datasourceResourceUrl.replace(\r\n\t\t\t\t\t\tDataServiceHelper.getURLVariable(oldItem.key, oldItem.parameterType),\r\n\t\t\t\t\t\tDataServiceHelper.getURLVariable(newItem.key, newItem.parameterType)\r\n\t\t\t\t\t);\r\n\t\t\t\tbreak;\r\n\t\t\tcase ParameterTypeEnum.OUTPUT:\r\n\t\t\t\ttry {\r\n\t\t\t\t\tjsonpath.parse(this.outputRootElement + newItem.key);\r\n\t\t\t\t\tconst foundMatch = jsonpath.query(\r\n\t\t\t\t\t\tJSON.parse(this.datasource.outputJson), this.outputRootElement + newItem.key);\r\n\t\t\t\t\tif (foundMatch.length === 1) {\r\n\t\t\t\t\t\tnewItem.dataType = DatasourceWizardHelper\r\n\t\t\t\t\t\t\t.getParameterType(foundMatch[0], this.datasource.suite);\r\n\t\t\t\t\t\tthis.invalidParameters[index] = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(\"No match found in Schema\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\t//console.warn(error);\r\n\t\t\t\t\tthis.invalidParameters[index] = true;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase ParameterTypeEnum.BODY_PART:\r\n\t\t\t\ttry {\r\n\t\t\t\t\tjsonpath.parse(newItem.key);\r\n\t\t\t\t\tthis.invalidParameters[index] = false;\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tthis.invalidParameters[index] = true;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.bindingDatasourceParameters[index] = newItem;\r\n\t}\r\n\r\n\tisAliasUnique(alias: string, id: string): boolean {\r\n\t\tif (Helper.isUndefinedEmpty(alias)) { // alias is empty string skip checking\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tconst parameters = this.bindingDatasourceParameters;\r\n\t\t// alias check comes from same id skip checking\r\n\t\tconst checkAlias = parameters.filter(parameter => parameter.alias.toLowerCase() === alias.toLowerCase());\r\n\t\tif (checkAlias.length > 1) {\r\n\t\t\treturn false;\r\n\t\t} else if (checkAlias.length === 1 && checkAlias[0].id === id) {\r\n\t\t\treturn true;\r\n\t\t} else if (checkAlias.length === 1 && checkAlias[0].id !== id) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetValidation($data: IOnComponentChangeNotification): boolean {\r\n\t\tlet result: boolean;\r\n\t\tif ($data.validator === \"isAliasUnique\") {\r\n\t\t\tresult = this.isAliasUnique($data.value, $data.id);\r\n\t\t} else if ($data.validator === \"isFirstCharLetter\") {\r\n\t\t\tresult = $data.value ? Helper.isFirstCharLetter($data.value) : true;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nexport class DatasourceParameterComponent implements ng.IComponentOptions {\r\n\r\n\tstatic readonly componentName: string = \"eirDatasourceParameter\";\r\n\tcontroller: any;\r\n\tcontrollerAs: string;\r\n\ttemplate: string;\r\n\tbindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\theadTitle: \"@\",\r\n\t\t\tswaggerOperation: \"<\",\r\n\t\t\tdatasourceParameters: \"=\",\r\n\t\t\tdatasourceResourceUrl: \"=?\",\r\n\t\t\tdatasourceCreateMode: \"=?\",\r\n\t\t\twizardNextDisabled: \"&?\",\r\n\t\t\toutputRootElement: \"=\",\r\n\t\t\tshowHelp: \"<\",\r\n\t\t\tgenerateOutputParameters: \"&\",\r\n\t\t\tgenerateInputParameters: \"&\",\r\n\t\t\tdatasource: \"<\",\r\n\t\t\treadonly: \"<\"\r\n\t\t};\r\n\r\n\t\tthis.controller = DatasourceParameterCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./datasource-parameter.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\r\n\t\t\tDatasourceParameterComponent.componentName,\r\n\t\t\tnew DatasourceParameterComponent());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div xi-busy=wizardCtrl.isBusy> <div class=wizard> <div class=wizard-header> <div class=bar> <div class=completed-range></div> </div> </div> </div> <div class=summary-title ng-if=\\\"wizardCtrl.currentTick === wizardCtrl.getEndStep()\\\"> <h4>Summary</h4> </div> <div class=wizard-content> <p ng-if=wizardCtrl.currentStep.userTip class=\\\"user-tip label\\\">{{wizardCtrl.currentStep.userTip}}</p> <div class=wizard-content-wrapper ng-include src=wizardCtrl.currentStep.id></div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=wizardCtrl.cancel() ng-disabled=wizardCtrl.isBusy> Cancel </button> <button type=button class=btn-modal ng-click=wizardCtrl.back() ng-disabled=\\\"wizardCtrl.isBusy || wizardCtrl.backDisabled\\\"> Back </button> <button type=button class=btn-modal-primary ng-click=wizardCtrl.next() ng-disabled=\\\"wizardCtrl.isBusy || wizardCtrl.nextDisabled\\\"> {{wizardCtrl.currentStep === wizardCtrl.getEndStep() ? 'Finish' : 'Next'}} </button> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \" <div class=row ng-controller=\\\"eirIonApiOperationDetails as $ctrl\\\"> <div class=\\\"columns operation-details\\\" ng-init=\\\"op = $ctrl.swaggerDocument.paths[$ctrl.operation.restPath][$ctrl.operation.method]\\\"> <h1>{{$ctrl.operation.productName}}</h1> <h2>{{$ctrl.swaggerDocument.info.title}}</h2> <br/> <h2>{{op.summary}}</h2> <p>{{op.description || 'This operation has no detailed description'}}</p> <small><strong> {{$ctrl.operation.method | uppercase}} {{$ctrl.operation.proxyPath}}{{$ctrl.operation.restPath}} </strong></small> <h2 class=fieldset-title>Input</h2> <div class=\\\"row operation-details-grid\\\"> <div xi-datagrid=$ctrl.parameterDatagridOption></div> </div> <h2 class=fieldset-title>Output</h2> <div class=\\\"row operation-details-grid\\\"> <div xi-datagrid=$ctrl.responseDatagridOption></div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div id=wizard-input-parameter class=container> <h2 class=fieldset-title>Basic Request Information</h2> <hr class=hr-field> <div class=field> <button type=button id=buttonViewJson class=\\\"btn-tertiary hide-focus\\\" ng-disabled=!wizardCtrl.hasRequestBody ng-click=wizardCtrl.openInputJsonDialog()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-info></use> </svg> <span>VIEW JSON</span> </button> </div> <div class=field ng-if=wizardCtrl.hasRequestBody> <label for=root-element>Root Element</label> <input name=root-element class=input-md value=\\\"\\\" placeholder=\\\"Root Element\\\" ng-model=wizardCtrl.datasource.inputRootElement ng-class=\\\"{'error':wizardCtrl.inputRootElementInvalid}\\\" ng-change=wizardCtrl.onChangeInputRootElement() /> </div> <div class=field> <label>Http Method</label> <select class=\\\"dropown dropdown-md\\\" xi-drop-down ng-model=wizardCtrl.datasource.method ng-change=wizardCtrl.onChangeRequestMethod()> <option value={{httpMethod}} ng-repeat=\\\"httpMethod in wizardCtrl.httpMethods\\\">{{httpMethod}}</option> </select> </div> <div class=field> <eir-resource-url-editor datasource-parameters=wizardCtrl.datasource.inputParameters datasource-resource-url=wizardCtrl.datasource.resource datasource-rest-url=wizardCtrl.restUrl /> </div> <div class=field> <eir-request-header-editor headers=wizardCtrl.datasource.headers wizard-next-disabled=wizardCtrl.setNextDisabled($item)></eir-request-header-editor> </div> <eir-datasource-parameter head-title={{wizardCtrl.currentStep.title}} swagger-operation=wizardCtrl.swaggerOperation datasource-parameters=wizardCtrl.datasource.inputParameters datasource-resource-url=wizardCtrl.datasource.resource datasource-create-mode=wizardCtrl.datasourceCreateMode wizard-next-disabled=wizardCtrl.setNextDisabled($item) show-help=wizardCtrl.onOpenJsonHelp datasource=wizardCtrl.datasource output-root-element=wizardCtrl.datasource.inputRootElement generate-input-parameters=wizardCtrl.generateInputParameters($datasource)></eir-datasource-parameter> <div class=\\\"field test-button\\\"> <button type=button ng-click=wizardCtrl.openTestDataserviceDialog() xi-tooltip=\\\"'Test Data Service'\\\" xi-button class=btn-primary> <span>Test Data Service</span> </button> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div id=wizard-output-parameter class=container> <h2 class=fieldset-title>Basic Response Information</h2> <hr class=hr-field> <div class=field> <fieldset class=radio-group> <legend>Output Type</legend> <input type=radio class=radio name=options id=outputIsJson ng-value=false ng-model=wizardCtrl.datasource.isOutputFile ng-change=wizardCtrl.onChangeOutputType() /> <label for=outputIsJson class=radio-label>JSON</label> <br> <input type=radio class=radio name=options id=outputIsFile ng-value=true ng-model=wizardCtrl.datasource.isOutputFile ng-change=wizardCtrl.onChangeOutputType() /> <label for=outputIsFile class=radio-label>File</label> </fieldset> </div> <div ng-if=wizardCtrl.datasource.isOutputFile> <div class=field> <label>Response alias</label> <input name=parameterAlias ng-model=wizardCtrl.datasource.outputParameters[0].alias /> </div> </div> <div ng-if=!wizardCtrl.datasource.isOutputFile> <div class=field> <button type=button id=buttonViewJson class=\\\"btn-tertiary hide-focus\\\" ng-click=wizardCtrl.openOutputJsonDialog()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-info></use> </svg> <span>VIEW JSON</span> </button> </div> <div class=field> <label for=root-element>Root Element</label> <input name=root-element class=input-md value=\\\"\\\" placeholder=\\\"Root Element\\\" ng-class=\\\"{'error':wizardCtrl.outputRootElementInvalid}\\\" ng-model=wizardCtrl.datasource.outputRootElement ng-change=wizardCtrl.onChangeOutputRootElement() /> </div> <div class=field> <div class=value-label-info> <label for=id-element>Object Id</label> <svg class=icon focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'Add unique key, used for selecting items on refresh. (Optional)'\\\"> <use xlink:href=#icon-info></use> </svg> </div> <input name=id-element class=input-md ng-class=\\\"{'error':wizardCtrl.objectIdInvalid}\\\" ng-model=wizardCtrl.datasource.objectIdPath ng-change=wizardCtrl.onChangeObjectIdPath() ng-model-options=\\\"{ debounce: 300 }\\\"/> <label class=\\\"warning-text override-soho-field-short-label-path\\\" ng-if=wizardCtrl.objectIdInvalid>JSON-path might be incorrect.</label> </div> <eir-datasource-parameter head-title={{wizardCtrl.currentStep.title}} swagger-operation=wizardCtrl.swaggerOperation datasource-parameters=wizardCtrl.datasource.outputParameters output-root-element=wizardCtrl.datasource.outputRootElement wizard-next-disabled=wizardCtrl.setNextDisabled($item) show-help=wizardCtrl.onOpenJsonHelp generate-output-parameters=wizardCtrl.generateOutputParameters($datasource) datasource=wizardCtrl.datasource class=datasourceOutputParameter></eir-datasource-parameter> <div class=\\\"field test-button\\\"> <button class=btn-primary type=button ng-click=wizardCtrl.openTestDataserviceDialog() xi-tooltip=\\\"'Test Data Service'\\\" xi-button> <span>Test Data Service</span> </button> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div id=wizard-summary class=\\\"container summary-form\\\"> <div class=row> <div class=field> <span class=label>Name</span> <span class=\\\"data summary {{wizardCtrl.datasource.displayName.length > 0 ? '' : 'warning-field' }}\\\"> {{ wizardCtrl.datasource.displayName.length > 0 ? wizardCtrl.datasource.displayName : 'Empty' }} </span> </div> <div class=field ng-hide=\\\"!wizardCtrl.datasource.description || wizardCtrl.datasource.description.length === 0 \\\"> <span class=label>Description</span> <span class=\\\"data summary\\\">{{ wizardCtrl.datasource.description }}</span> </div> </div> <div class=row> <h2 class=fieldset-title>Request Information</h2> <hr class=hr-field> <div class=field> <span class=label>Http Method</span> <span class=\\\"data summary\\\">{{ wizardCtrl.datasource.method }}</span> </div> <div class=field> <span class=label>API URL</span> <span class=\\\"data summary\\\">{{ wizardCtrl.restUrl }}</span> </div> <div class=row> <eir-request-header-editor headers=wizardCtrl.datasource.headers readonly=true></eir-request-header-editor> </div> <div class=row> <eir-datasource-parameter head-title=\\\"Input Parameters\\\" swagger-operation=wizardCtrl.swaggerOperation datasource-parameters=wizardCtrl.datasource.inputParameters datasource-resource-url=wizardCtrl.datasource.resource readonly=true /> </div> </div> <div class=row> <h2 class=fieldset-title>Response Information</h2> <hr class=hr-field> <div class=field ng-show=wizardCtrl.datasource.isOutputFile> <h3 class=section-title>Output is a File</h3> <label>Response alias</label> <input name=parameterAlias ng-model=wizardCtrl.datasource.outputParameters[0].alias readonly=readonly /> </div> <div ng-show=!wizardCtrl.datasource.isOutputFile> <div class=field> <span class=label>Root Element</span> <span class=\\\"data summary\\\">{{ wizardCtrl.datasource.outputRootElement }}</span> </div> <eir-datasource-parameter head-title=\\\"Output Parameters\\\" swagger-operation=wizardCtrl.swaggerOperation datasource-parameters=wizardCtrl.datasource.outputParameters datasource-resource-url=wizardCtrl.datasource.resource readonly=true /> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div id=jsonhelp-dialog ng-controller=\\\"eirJsonpathHelpDialogCtrl as ctrl\\\"> <table role=grid class=\\\"listview-table show-headers\\\"> <thead> <tr> <th scope=col role=columnheader>JSONPath</th> <th scope=col role=columnheader>Description</th> </tr> </thead> <tbody> <tr> <td><code>$</code></td> <td>The root object/element</td> </tr> <tr> <td><code>@</code></td> <td>The current object/element</td> </tr> <tr> <td><code>.</code></td> <td>Child member operator</td> </tr> <tr> <td><code>..</code></td> <td>Recursive descendant operator; JSONPath borrows this syntax from E4X</td> </tr> <tr> <td><code>*</code></td> <td>Wildcard matching all objects/elements regardless their names</td> </tr> <tr> <td><code>[]</code></td> <td>Subscript operator</td> </tr> <tr> <td><code>[,]</code></td> <td>Union operator for alternate names or array indices as a set</td> </tr> <tr> <td><code>[start:end:step]</code></td> <td>Array slice operator borrowed from ES4 / Python</td> </tr> <tr> <td><code>?()</code></td> <td>Applies a filter (script) expression via static evaluation</td> </tr> <tr> <td><code>()</code></td> <td>Script expression via static evaluation</td> </tr> </tbody> </table> <div class=field> <p>More information about JSONPath in the library page at <a class=\\\"hyperlink hide-focus\\\" href=https://github.com/dchester/jsonpath target=_blank>https://github.com/dchester/jsonpath</a> </p> </div> <div class=modal-buttonset> <button type=button class=btn-modal-primary ng-click=ctrl.close()>Close</button> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=view-json-dialog ng-controller=\\\"eirViewJsonDialogCtrl as $ctrl\\\"> <div class=row> <div class=\\\"six columns\\\"> <h1>Schema</h1> <textarea ng-model=$ctrl.schemaString ng-change=\\\"$ctrl.isModified = true; $ctrl.generateSample()\\\" ng-class=\\\"{error: $ctrl.schemaHasError}\\\"></textarea> </div> <div class=\\\"six columns\\\"> <h1>{{ $ctrl.isInput ? 'Template' : 'Json'}}</h1> <textarea ng-model=$ctrl.sampleString ng-change=\\\"$ctrl.isModified = true; $ctrl.generateSchema()\\\" ng-class=\\\"{error: $ctrl.sampleHasError}\\\"></textarea> </div> </div> <div class=field> <button type=button class=btn-primary ng-if=!$ctrl.isInput ng-click=$ctrl.refreshSchema() ng-disabled=!$ctrl.resetEnabled>Reset</button> <div class=root> <label for=root-element>Root Element</label> <input name=root-element id=root class=input-md value=\\\"\\\" placeholder=\\\"Root Element\\\" ng-class=\\\"{'error':$ctrl.rootElementInvalid}\\\" ng-model=$ctrl.root ng-change=\\\"$ctrl.onChangeRootElement(); $ctrl.isModified = true;\\\"/> </div> <button type=button class=btn-tertiary ng-click=$ctrl.showHelp()> <span>JSON Help</span> </button> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=$ctrl.close()>Close</button> <button type=button class=\\\"btn-modal-primary no-validation\\\" ng-disabled=$ctrl.saveDisabled ng-click=$ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=parameter-container ng-show=!ctrl.readonly> <div class=datasource-header> <h2 class=fieldset-title>{{ctrl.headTitle}}</h2> <div class=field> <button type=button class=btn-tertiary ng-click=ctrl.showHelp()> <span>JSON Help</span> </button> </div> </div> <hr class=hr-field> <div class=button-content> <div class=button-container> <button type=button class=\\\"btn-tertiary hide-focus\\\" ng-click=ctrl.generateParameters() ng-disabled=ctrl.isInvalid> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-refresh></use> </svg> <span>GENERATE PARAMETERS</span> </button> <button type=button id=buttonAdd class=btn-menu ng-if=ctrl.isInput xi-popupmenu> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>ADD</span> </button> <ul class=popupmenu ng-if=ctrl.isInput> <li ng-repeat=\\\"parameterType in ctrl.parameterTypes\\\" ng-click=ctrl.onAddDatasourceParameter(parameterType.value)> <a>{{parameterType.name}} Parameter</a> </li> </ul> <button type=button id=buttonAdd class=\\\"btn-tertiary hide-focus\\\" ng-click=ctrl.onAddDatasourceParameter(ctrl.ParameterTypeEnum.OUTPUT) ng-if=!ctrl.isInput> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>ADD</span> </button> </div> </div> <div class=\\\"datasource-param-container field\\\"> <div class=compound-field> <div class=\\\"field-short override-soho-field-short-label-mandatory\\\" ng-show=ctrl.isInput> <label for=parameterMandatory>Required</label> </div> <div class=field-short ng-class=\\\"ctrl.isInput ?\\r\\n\\t\\t\\t\\t\\t'override-soho-field-short-is-input' :\\r\\n\\t\\t\\t\\t\\t'override-soho-field-short-is-not-input'\\\"> <label class=\\\"\\\" for=parameterName>Name</label> </div> <div class=\\\"field-short override-soho-field-short-label-type\\\" ng-show=ctrl.isInput> <label class=\\\"\\\" for=parameterType>Type</label> </div> <div class=\\\"field-short override-soho-field-short-label-alias\\\"> <label class=\\\"\\\" for=input-field-component>Alias (Optional)</label> </div> </div> <div class=compound-field ng-repeat=\\\"item in ctrl.bindingDatasourceParameters track by $index\\\"> <div class=\\\"field-short override-soho-field-short-container\\\" ng-show=ctrl.isInput> <input type=checkbox class=checkbox name=parameterMandatory-{{$index}} id=parameterMandatory-{{$index}} ng-model=item.required ng-change=ctrl.onValidateAlias() ng-disabled=ctrl.isPathParameter /> <label ng-show=ctrl.isInput for=parameterMandatory-{{$index}} class=checkbox-label></label> </div> <div class=field-short> <input name=parameterName ng-class=\\\"{'error':ctrl.invalidParameters[$index], 'input-mm':ctrl.isInput, 'input-lg':!ctrl.isInput  }\\\" ng-model=item.key ng-change=\\\"ctrl.onUpdateResourceUrl(item, {{item}}, $index)\\\" ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> <label class=\\\"warning-text override-soho-field-short-label-path\\\" ng-if=ctrl.invalidParameters[$index]>JSON-path might be incorrect.</label> </div> <div class=field-short> <input name=parameterType class=\\\"input-xs override-soho-field-short-label-type\\\" ng-show=ctrl.isInput ng-value=::ctrl.getParameterTypeName(item.parameterType) disabled=disabled /> </div> <div class=field-short> <eir-input-field-component id={{item.id}} field-value=item.alias field-name=parameterAlias validation=\\\"{\\r\\n\\t\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvalidator: 'isAliasUnique',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\terrorMessage: 'Alias has to be unique'\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\r\\n\\t\\t\\t\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvalidator: 'isFirstCharLetter',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\terrorMessage: 'First character needs to be a letter'\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\r\\n\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t\\t}\\\" on-component-change=ctrl.notify($data) parent-announce=ctrl.parentAnnounce /> </div> <div class=field-short> <button type=button class=\\\"btn-tertiary hide-focus button-delete\\\" ng-class=\\\"{ overrideSohoFieldShortLabelTest:($first && !ctrl.isInput) }\\\" ng-click=ctrl.onDeleteDatasourceParameter(item)> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> </button> </div> </div> </div> </div> <div class=field ng-show=ctrl.readonly> <span class=label>{{ctrl.headTitle}}</span> <div xi-datagrid=ctrl.parameterDatagridOptions></div> </div>\";\n// Exports\nmodule.exports = code;","import { IDialogBaseScope } from \"../../../../../common/defines\";\r\nimport { IDialog } from \"../../../../../common/services/dialog-service\";\r\n\r\nexport class JsonpathHelpDialogCtrl {\r\n\tprivate dialog: IDialog<void>;\r\n\r\n\tpublic constructor(\r\n\t\tprivate $scope: IDialogBaseScope<void>\r\n\t) {\r\n\t\tthis.dialog = $scope.eirDialog;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirJsonpathHelpDialogCtrl\", JsonpathHelpDialogCtrl);\r\n\t}\r\n}\r\n","import { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { FormatterEnum, IComponentRendered } from \"ng2/common/constants/sohoxi.constant\";\r\nimport {\r\n\tIDatagridApi,\r\n\tIDatagridColumnArgs,\r\n\tIDataGridOptions,\r\n\tIDataGridRow,\r\n} from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport { IDialogBaseScope } from \"../../../../../../common/defines\";\r\nimport { Helper } from \"../../../../../../common/helper\";\r\n\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../../../common/services/dialog-service\";\r\nimport { IOnComponentChangeNotification, NotifiableComponent } from \"../../../../../../common/shared-components/base/notifiable-component\";\r\nimport { DATAGRID_RENDERED } from \"../../../../../../common/sohoxi/component/datagrid-directive\";\r\nimport { DatagridHelper } from \"../../../../../../common/sohoxi/datagrid-helper\";\r\n\r\nexport interface IRequestHeaderItem {\r\n\tkey: string;\r\n\tvalue: string;\r\n}\r\nexport class RequestEditorDialogCtrl extends NotifiableComponent {\r\n\r\n\tpublic dialog: IDialog<IMap<string>>;\r\n\r\n\tpublic errorList: [] = [];\r\n\tpublic isInitialValid: boolean = false;\r\n\tpublic newParameter: IRequestHeaderItem;\r\n\tpublic dataset: IRequestHeaderItem[] = [];\r\n\tpublic datagridOptions: IDataGridOptions<IRequestHeaderItem>;\r\n\tpublic readonly datagridId = \"requestEditorDatagrid\";\r\n\tpublic datagridApi: IDatagridApi;\r\n\tpublic hasError: boolean = false;\r\n\tpublic editMode: boolean = false;\r\n\r\n\tpublic constructor(\r\n\t\t$scope: IDialogBaseScope<IMap<string>>,\r\n\t) {\r\n\t\tsuper();\r\n\r\n\t\tthis.dialog = $scope.eirDialog;\r\n\t\tthis.initDatagridOptions();\r\n\r\n\t\t$(\"#request-header-datagrid\")\r\n\t\t\t.on(DATAGRID_RENDERED, (_, result: IComponentRendered) => {\r\n\t\t\t\tthis.datagridApi = result.api;\r\n\t\t\t})\r\n\t\t\t.on(\"entereditmode\", () => {\r\n\t\t\t\t$scope.$applyAsync(() => {\r\n\t\t\t\t\tthis.editMode = true;\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.on(\"exiteditmode\", (_, args: IDatagridColumnArgs<IRequestHeaderItem>) => {\r\n\t\t\t\t$scope.$applyAsync(() => {\r\n\t\t\t\t\tthis.hasError = args.target.hasClass(\"error\");\r\n\t\t\t\t\tthis.editMode = false;\r\n\t\t\t\t});\r\n\t\t\t\tif (args.value !== args.oldValue) {\r\n\t\t\t\t\tthis.datagridApi.validateCell(args.row, args.cell);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic add(): void {\r\n\t\tthis.dataset.push(this.newParameter);\r\n\t\tdelete this.newParameter;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic save(): void {\r\n\t\tconst result = this.dataset\r\n\t\t\t.map((item: { key: string, value: string }) => {\r\n\t\t\t\treturn `${item.key}:${item.value}`;\r\n\t\t\t})\r\n\t\t\t.join(\"\\n\");\r\n\t\tconst dialogResult: IDialogResult<string> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: result\r\n\t\t};\r\n\r\n\t\tthis.dialog.close(dialogResult);\r\n\t}\r\n\r\n\tprivate initDatagridOptions(): void {\r\n\t\tconst createDatagridColumns = (): IExtendedDataGridColumn[] => {\r\n\t\t\tconst columns = [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"key\",\r\n\t\t\t\t\tname: \"Key\",\r\n\t\t\t\t\tfield: \"key\",\r\n\t\t\t\t\twidth: \"40%\",\r\n\t\t\t\t\teditable: true,\r\n\t\t\t\t\tformatterName: FormatterEnum.Text,\r\n\t\t\t\t\tvalidate: \"required\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"value\",\r\n\t\t\t\t\tname: \"Value\",\r\n\t\t\t\t\tfield: \"value\",\r\n\t\t\t\t\twidth: \"40%\",\r\n\t\t\t\t\teditable: true,\r\n\t\t\t\t\tformatterName: FormatterEnum.Text,\r\n\t\t\t\t\tvalidate: \"required\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tid: \"action\",\r\n\t\t\t\t\tname: \"Action\",\r\n\t\t\t\t\tfield: \"\",\r\n\t\t\t\t\twidth: \"20%\",\r\n\t\t\t\t\talign: \"center\",\r\n\t\t\t\t\tformatter: Soho.Formatters.Button,\r\n\t\t\t\t\ttext: \"Remove\",\r\n\t\t\t\t\tclick: (_: JQueryEventObject, rowsSelected: IDataGridRow<IRequestHeaderItem>[]) => {\r\n\t\t\t\t\t\tif (rowsSelected.length === 1) { // only one should have been selected\r\n\t\t\t\t\t\t\tHelper.removeItemFromListByIndex(this.dataset, rowsSelected[0].row);\r\n\t\t\t\t\t\t\tthis.datagridApi.updateDataset(this.dataset, null);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t];\r\n\r\n\t\t\tcolumns.forEach(\r\n\t\t\t\tcolumn => DatagridHelper.setEditableOnColumn(column));\r\n\r\n\t\t\treturn columns;\r\n\t\t};\r\n\r\n\t\tconst getDataset = (): IRequestHeaderItem[] => {\r\n\t\t\tconst headerObject = this.dialog.parameter;\r\n\t\t\tconst dataset: IRequestHeaderItem[] = [];\r\n\t\t\tfor (const key in headerObject) {\r\n\t\t\t\tdataset.push({\r\n\t\t\t\t\tkey,\r\n\t\t\t\t\tvalue: headerObject[key],\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn dataset;\r\n\t\t};\r\n\r\n\t\tconst columns = createDatagridColumns();\r\n\t\tthis.dataset = getDataset();\r\n\r\n\t\tthis.datagridOptions = {\r\n\t\t\tcolumns,\r\n\t\t\tdataset: this.dataset,\r\n\t\t\teditable: true,\r\n\t\t\tid: this.datagridId,\r\n\t\t};\r\n\t}\r\n\r\n\tprotected notify(\r\n\t\t$data: IOnComponentChangeNotification\r\n\t): boolean {\r\n\t\tif ($data.id.indexOf(\"key\") !== -1) {\r\n\t\t\tthis.isInitialValid =\r\n\t\t\t\t!Helper.isUndefinedEmpty($data.value) &&\r\n\t\t\t\t!Helper.isUndefinedEmpty(this.newParameter.value);\r\n\t\t} else if ($data.id.indexOf(\"value\") !== -1) {\r\n\t\t\tthis.isInitialValid =\r\n\t\t\t\t!Helper.isUndefinedEmpty(this.newParameter.key) &&\r\n\t\t\t\t!Helper.isUndefinedEmpty($data.value);\r\n\t\t}\r\n\t\treturn this.isInitialValid;\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirRequestEditorDialogCtrl\", RequestEditorDialogCtrl);\r\n\t}\r\n}\r\n","import isEmpty from \"lodash-es/isEmpty\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"../../../../../common/services/dialog-service\";\r\nimport { IFieldValidationResult } from \"../../../../../common/shared-components/base/field-validation\";\r\n\r\nexport class RequestHeaderEditorCtrl implements ng.IComponentController {\r\n\r\n\tpublic static $inject: string[] = [\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\t// Component Bindings\r\n\tpublic headers: IMap<string>;\r\n\tpublic wizardNextDisabled: ($item: any) => void;\r\n\r\n\t// Members\r\n\tpublic errorList: any[] = [];\r\n\tpublic isValid: boolean;\r\n\tprivate _parsedHeaders: string;\r\n\tpublic get parsedHeaders(): string { return this._parsedHeaders; }\r\n\tpublic set parsedHeaders(value: string) {\r\n\t\tthis.isValid =\r\n\t\t\tthis.isValidParsedHeaders(value);\r\n\r\n\t\tif (this.isValid && !isEmpty(value)) {\r\n\t\t\tthis.headers = value\r\n\t\t\t\t.split(\"\\n\")\r\n\t\t\t\t// convert parsed header to header object\r\n\t\t\t\t.reduce((output: any, keyValuePair) => {\r\n\t\t\t\t\tconst indexOfFirstColon = keyValuePair.indexOf(\":\");\r\n\t\t\t\t\tif (indexOfFirstColon !== -1) {\r\n\t\t\t\t\t\tconst key = keyValuePair.substring(0, indexOfFirstColon);\r\n\t\t\t\t\t\tconst value = keyValuePair.substring(indexOfFirstColon + 1);\r\n\t\t\t\t\t\toutput[key] = value;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toutput[keyValuePair] = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn output;\r\n\t\t\t\t}, {});\r\n\t\t}\r\n\r\n\t\tif (isEmpty(value) && !isEmpty(this.headers)) {\r\n\t\t\tthis.headers = {};\r\n\t\t}\r\n\r\n\t\tthis._parsedHeaders = value;\r\n\t}\r\n\r\n\tpublic constructor(\r\n\t\tprivate dialogService: DialogService,\r\n\t) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.parseHeader();\r\n\t}\r\n\r\n\tprivate parseHeader(): void {\r\n\t\tthis.parsedHeaders = JSON\r\n\t\t\t.stringify(this.headers)\r\n\t\t\t.slice(1)\t\t// removes {\r\n\t\t\t.slice(0, -1)\t// removes }\r\n\t\t\t.split(\",\") // get rows of key:value\r\n\t\t\t.map(keyValue => keyValue.replace(/\\\"/g, \"\")) // replace occurrence of \" with empty\r\n\t\t\t.join(\"\\n\");\r\n\r\n\t}\r\n\r\n\tpublic isValidParsedHeaders(value: string): boolean {\r\n\t\tconst validHeaderRequestRow = /.+:{1}.+[\\n]?/;\r\n\t\tconst isNextDisabled = {\r\n\t\t\t$item: {\r\n\t\t\t\tid: RequestHeaderEditorComponent.componentName\r\n\t\t\t} as IFieldValidationResult\r\n\t\t};\r\n\t\tlet hasInvalid = false;\r\n\r\n\t\t/* verify if parsed headers looks as following:\r\n\t\t\tfoo1:bar2\\nfoo2:bar2 */\r\n\t\tif (value.indexOf(\"\\n\") !== -1) {\r\n\t\t\thasInvalid = value\r\n\t\t\t\t.split(\"\\n\")\r\n\t\t\t\t.some(keyValuePair => !validHeaderRequestRow.test(keyValuePair));\r\n\t\t} else if (isEmpty(value)) {\r\n\t\t\thasInvalid = false;\r\n\t\t} else {\r\n\t\t\thasInvalid = !validHeaderRequestRow.test(value);\r\n\t\t}\r\n\r\n\t\tisNextDisabled.$item.status = hasInvalid;\r\n\r\n\t\tif (this.wizardNextDisabled) {\r\n\t\t\tthis.wizardNextDisabled(isNextDisabled);\r\n\t\t}\r\n\r\n\t\treturn !isNextDisabled.$item.status;\r\n\r\n\t}\r\n\r\n\tpublic onEdit(): void {\r\n\t\tconst dialogOptions: IDialogOptions<IMap<string>> = {\r\n\t\t\ttitle: \"Request Header Editor\",\r\n\t\t\ttemplate: require(\"./dialog/request-editor-template.html\"),\r\n\t\t\tparameter: this.headers\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(dialogOptions)\r\n\t\t\t.then((dialogResult: IDialogResult<string>) => {\r\n\t\t\t\tif (dialogResult.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.parsedHeaders = dialogResult.value;\r\n\t\t\t\t\tthis.headers = JSON.parse(this.parsedHeaders);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\nexport class RequestHeaderEditorComponent implements ng.IComponentOptions {\r\n\tpublic static readonly componentName: string = \"eirRequestHeaderEditor\";\r\n\tpublic static readonly componentRoot: string =\r\n\t\t\"designer/repository/datasource/create-wizard/request-header-editor/\";\r\n\tpublic controller = RequestHeaderEditorCtrl;\r\n\tpublic controllerAs = \"$ctrl\";\r\n\tpublic template = require(\"./request-header-component-template.html\");\r\n\tpublic bindings: IMap<string> = {\r\n\t\theaders: \"=\",\r\n\t\twizardNextDisabled: \"&?\",\r\n\t\treadonly: \"<?\"\r\n\t};\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\r\n\t\t\tRequestHeaderEditorComponent.componentName,\r\n\t\t\tnew RequestHeaderEditorComponent());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div id=request-editor-dialog ng-controller=\\\"eirRequestEditorDialogCtrl as ctrl\\\"> <div class=row> <div class=\\\"five columns\\\"> <eir-input-field-component id=key-field label-name=Key field-value=ctrl.newParameter.key validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tvalidator: 'void'\\r\\n\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t}\\\" on-component-change=ctrl.notify($data) parent-announce=ctrl.parentAnnounce /> </div> <div class=\\\"five columns\\\"> <eir-input-field-component id=value-field label-name=Value field-value=ctrl.newParameter.value validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tvalidator: 'void'\\r\\n\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t}\\\" on-component-change=ctrl.notify($data) parent-announce=ctrl.parentAnnounce /> </div> <div class=\\\"two columns\\\"> <label></label> <button class=btn-icon ng-click=ctrl.add() ng-disabled=\\\"!ctrl.isInitialValid || ctrl.errorList.length !== 0\\\" xi-tooltip=\\\"'Add Header Parameter'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-add></use> </svg> <span class=audible>Add</span> </button> </div> </div> <div class=row> <div class=\\\"full column\\\"> <div id=request-header-datagrid xi-datagrid=ctrl.datagridOptions></div> </div> </div> <div class=modal-buttonset> <button type=button ng-click=ctrl.close()> Cancel </button> <button type=button class=btn-modal-primary ng-click=ctrl.save() ng-disabled=\\\"ctrl.editMode || ctrl.hasError\\\"> OK </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<label>Request Header</label> <div class=\\\"six columns\\\"> <eir-textarea-field-component field-value=$ctrl.parsedHeaders readonly=$ctrl.readonly validation=\\\"{\\r\\n\\t\\t\\tvalidators: [{\\r\\n\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\tvalidator: $ctrl.isValidObject,\\r\\n\\t\\t\\t\\t\\terrorMessage: 'Needs to be a valid JSON'\\r\\n\\t\\t\\t\\t}\\r\\n\\r\\n\\t\\t\\t}],\\r\\n\\t\\t\\terrorList: $ctrl.errorList\\r\\n\\t\\t}\\\"></eir-textarea-field-component> </div> <div class=\\\"two columns\\\" ng-if=!$ctrl.readonly> <button type=button class=btn-icon ng-click=$ctrl.onEdit() ng-disabled=!$ctrl.isValid> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-edit></use> </svg> </button> </div> \";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../../../common/angular-constants\";\r\n\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../../../common/defines\";\r\nimport { IValidation } from \"../../../../../../common/shared-components/base/field-validation\";\r\n\r\nimport { DataServiceHelper } from \"ng2/common/helpers/data-service.helper\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../../../common/services/dialog-service\";\r\n\r\nexport class EditUrlDialogCtrl {\r\n\r\n\tpublic get resourceUrl(): string {\r\n\t\treturn this.dialog.parameter.resource;\r\n\t}\r\n\tpublic set resourceUrl(value: string) {\r\n\t\tthis.dialog.parameter.resource = value;\r\n\t}\r\n\r\n\tpublic errorList: IValidation[] = [];\r\n\tpublic get IsInvalid(): boolean {\r\n\t\treturn this.errorList.length !== 0;\r\n\t}\r\n\r\n\tprivate dialog: IDialog<IMap<string>>;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\t$scope: IDialogBaseScope<IMap<string>>\r\n\t) {\r\n\t\tthis.dialog = $scope.eirDialog;\r\n\t}\r\n\r\n\tpublic cancel(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic ok(): void {\r\n\t\tthis.dialog.close({\r\n\t\t\tvalue: this.resourceUrl,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t} as IDialogResult<string>);\r\n\t}\r\n\r\n\tpublic validate(value: string): boolean {\r\n\t\treturn DataServiceHelper.validate(value);\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirEditUrlDialogCtrl\", EditUrlDialogCtrl);\r\n\t}\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { ResourceUrlEditorCtrl } from \"./resource-url-editor-ctrl\";\r\n\r\nexport class ResourceUrlEditorComponent implements ng.IComponentOptions {\r\n\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tdatasourceParameters: \"=\",\r\n\t\t\tdatasourceResourceUrl: \"=\",\r\n\t\t\tdatasourceRestUrl: \"<\",\r\n\t\t};\r\n\r\n\t\tthis.controller = ResourceUrlEditorCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./resource-url-editor.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirResourceUrlEditor\", new ResourceUrlEditorComponent());\r\n\t}\r\n}\r\n","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { DialogButtonType, DialogService, IDialogOptions } from \"../../../../../common/services/dialog-service\";\r\n\r\nimport { DataServiceHelper } from \"ng2/common/helpers/data-service.helper\";\r\nimport { Helper } from \"../../../../../common/helper\";\r\n\r\nexport class ResourceUrlEditorCtrl {\r\n\r\n\tpublic static $inject = [\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tpublic datasourceResourceUrl: string;\r\n\tpublic datasourceRestUrl: string;\r\n\tpublic htmlEncode = Helper.htmlEncode;\r\n\r\n\tpublic bindingDatasourceParameters: IParameterObject[];\r\n\t// public datasourceParameters: IParameterObject[];\r\n\r\n\tpublic get datasourceParameters(): IParameterObject[] { return this.bindingDatasourceParameters; }\r\n\tpublic set datasourceParameters(value: IParameterObject[]) {\r\n\t\tthis.bindingDatasourceParameters = value;\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tprivate dialogService: DialogService\r\n\t) { }\r\n\r\n\tpublic onEditDatasourceUrl(): void {\r\n\t\tconst options: IDialogOptions<IMap<string>> = {\r\n\t\t\t// TODO\r\n\t\t\ttitle: \"Edit Relative URL\",\r\n\t\t\ttemplate: require(\"./edit-url-dialog/edit-url-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tresource: this.datasourceResourceUrl\r\n\t\t\t},\r\n\t\t};\r\n\t\tthis.dialogService.show<IMap<string>, string>(options).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.datasourceResourceUrl = result.value;\r\n\r\n\t\t\t\tconst newParameters = DataServiceHelper.parse(result.value);\r\n\t\t\t\tconst resultParameters: IParameterObject[] = [];\r\n\t\t\t\tnewParameters.forEach((newParameter) => {\r\n\t\t\t\t\tconst existingIndex = this.bindingDatasourceParameters.findIndex((existingParameter) => {\r\n\t\t\t\t\t\treturn existingParameter.key === newParameter.key &&\r\n\t\t\t\t\t\t\texistingParameter.parameterType === newParameter.parameterType;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (existingIndex !== -1) {\r\n\t\t\t\t\t\tresultParameters.push(this.bindingDatasourceParameters[existingIndex]); // Adding existing to keep ID, alias, etc\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresultParameters.push(newParameter);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis.bindingDatasourceParameters.forEach((existingParameter, index: number, existingParameters) => {\r\n\t\t\t\t\tif (existingParameter.parameterType === ParameterTypeEnum.BODY_PART) {\r\n\t\t\t\t\t\tresultParameters.push(existingParameter); // Not modifying body parameters from URL\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis.bindingDatasourceParameters = resultParameters;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div id=edit-dialog ng-controller=\\\"eirEditUrlDialogCtrl as ctrl\\\"> <div class=warning-label> <span class=data>Please note that changing URL will also change the input parameters</span> </div> <div class=field> <eir-input-field-component class=input-field-component label-name=\\\"API Relative URL\\\" field-value=ctrl.resourceUrl validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\tvalidator: ctrl.validate,\\r\\n\\t\\t\\t\\t\\t\\t\\terrorMessage: 'Invalid URL'\\r\\n\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t}\\\"/> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.cancel()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.ok() ng-disabled=ctrl.IsInvalid>OK</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<label for=relative-url>API Relative URL</label> <div class=content> <div class=input-container> <input name=relative-url class=\\\"input-full {{ctrl.error ? 'required error' : ''}}\\\" readonly=readonly xi-tooltip=ctrl.htmlEncode(ctrl.datasourceResourceUrl) ng-model=ctrl.datasourceResourceUrl ng-blur=ctrl.validate() /> <label class=\\\"data sub-label\\\">{{ ctrl.datasourceRestUrl }}</label> </div> <button type=button id=button-edit class=\\\"btn-tertiary hide-focus\\\" ng-click=ctrl.onEditDatasourceUrl()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-edit></use> </svg> </button> </div> \";\n// Exports\nmodule.exports = code;","import jsonpath from \"jsonpath\";\r\n\r\nimport { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport type { IDialogBaseScope } from \"../../../../../common/defines\";\r\n\r\nimport { DialogButtonType, DialogService } from \"../../../../../common/services/dialog-service\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\n\r\nimport type { ISchemaObject } from \"ng2/common/model/swagger.model\";\r\n\r\nimport { JsonHelper } from \"ng2/common/helpers/json.helper\";\r\n\r\nexport interface IViewJsonDialogParameters {\r\n\tdataservice: IJsonGenericDatasource2;\r\n\tisInput: boolean;\r\n\tshowHelp?: Function;\r\n}\r\n\r\nexport class ViewJsonDialogCtrl {\r\n\r\n\tschemaString = \"\";\r\n\tsampleString = \"\";\r\n\tschemaHasError: boolean;\r\n\tsampleHasError: boolean;\r\n\tisModified: boolean;\r\n\tisInput: boolean;\r\n\troot: string;\r\n\tresetEnabled = false;\r\n\tsampleError: string;\r\n\trootElementInvalid = false;\r\n\tprivate originalSchema: ISchemaObject;\r\n\tprivate showHelp: Function;\r\n\r\n\tget saveDisabled(): boolean {\r\n\t\treturn !this.isModified || this.schemaHasError || this.sampleHasError || this.rootElementInvalid;\r\n\t}\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<IViewJsonDialogParameters>,\r\n\t\tprivate dialogService: DialogService,\r\n\t) {\r\n\t\tconst parameters = $scope.eirDialog.parameter;\r\n\t\tconst schema = parameters.isInput ? parameters.dataservice.inputSchema : parameters.dataservice.outputSchema;\r\n\t\tthis.originalSchema = parameters.dataservice.originalSchema; //output\r\n\t\tconst json = parameters.isInput ? parameters.dataservice.bodyTemplate : parameters.dataservice.outputJson;\r\n\t\tthis.root = parameters.isInput ?\r\n\t\t\tparameters.dataservice.inputRootElement : parameters.dataservice.outputRootElement;\r\n\t\tthis.showHelp = parameters.showHelp;\r\n\t\tthis.isInput = parameters.isInput;\r\n\r\n\t\tif (this.originalSchema) {\r\n\t\t\tthis.resetEnabled = true;\r\n\t\t}\r\n\r\n\t\tif (schema) {\r\n\t\t\tthis.schemaString = JSON.stringify(schema, null, \"  \");\r\n\t\t\tif (json) {\r\n\t\t\t\tthis.sampleString = json;\r\n\t\t\t} else {\r\n\t\t\t\tthis.generateSample();\r\n\t\t\t}\r\n\t\t} else if (json) {\r\n\t\t\tthis.sampleString = json;\r\n\t\t\tthis.generateSchema();\r\n\t\t}\r\n\t}\r\n\r\n\tgenerateSample(): void {\r\n\t\ttry {\r\n\t\t\tif (this.schemaString) {\r\n\t\t\t\tconst parsedSchema = JSON.parse(this.schemaString);\r\n\t\t\t\tconst sample = JsonHelper.generateSample(parsedSchema);\r\n\t\t\t\tthis.sampleString = JSON.stringify(sample, null, \"  \");\r\n\t\t\t\tthis.schemaHasError = false;\r\n\t\t\t\tthis.sampleHasError = false;\r\n\t\t\t\tthis.sampleError = \"\";\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.warn(\"Schema has error:\", error);\r\n\t\t\tthis.schemaHasError = true;\r\n\t\t\tif (error instanceof Error) {\r\n\t\t\t\tthis.sampleError = error.message.split(\"<br/>\").join(\"\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.sampleError = \"Ops, something went wrong. See Console for details.\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgenerateSchema(): void {\r\n\t\ttry {\r\n\t\t\tconst parsedSample = JSON.parse(this.sampleString);\r\n\t\t\tconst schema = JsonHelper.generateSchema(parsedSample);\r\n\t\t\tthis.schemaString = JSON.stringify(schema, null, \"  \");\r\n\t\t\tthis.sampleHasError = false;\r\n\t\t\tthis.schemaHasError = false;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.warn(\"Sample has error:\", error);\r\n\t\t\tthis.sampleHasError = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonChangeRootElement(): void {\r\n\t\tthis.rootElementInvalid = JsonHelper.isInvalidJsonPath(this.root);\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\tthis.$scope.eirDialog.close({\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: {\r\n\t\t\t\tjson: this.sampleString,\r\n\t\t\t\tschema: JsonHelper.generateSchema(JSON.parse(this.sampleString)),\r\n\t\t\t\troot: this.root,\r\n\t\t\t},\r\n\t\t});\r\n\t}\r\n\r\n\trefreshSchema(): void {\r\n\t\tthis.dialogService.showYesNo(\r\n\t\t\t\"Warning\",\r\n\t\t\t\"All user changes will be discarded, continue?\",\r\n\t\t\t\"warning-text\")\r\n\t\t\t.then(result => {\r\n\t\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\t\tthis.schemaString = JSON.stringify(this.originalSchema, null, \"  \");\r\n\t\t\t\t\tthis.isModified = true;\r\n\t\t\t\t\tthis.generateSample();\r\n\t\t\t\t\tthis.generateSchema();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tclose(): void {\r\n\t\tthis.$scope.eirDialog.close({\r\n\t\t\tbutton: DialogButtonType.Cancel,\r\n\t\t\tvalue: null,\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirViewJsonDialogCtrl\", ViewJsonDialogCtrl);\r\n\t}\r\n}\r\n","import { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { availableDatasourceTypes, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\nimport { IJsonDatasource, IJsonGenericDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { ILookupOptions } from \"../../../../common/model/sohoxi/sohoxi-lookup.model\";\r\nimport { DialogButtonType, DialogService, IDialog, StandardDialogButtons } from \"../../../../common/services/dialog-service\";\r\nimport { DatasourceService } from \"../../../../components/services/datasource-service\";\r\nimport { DesignerService } from \"../../../services/designer-service\";\r\nimport { IUpsertDialogParameter } from \"../datasource-tab-ctrl\";\r\n\r\n/*\r\n\tOld and not used anymore except for BI data services which is legacy\r\n*/\r\n\r\nexport class DatasourceUpsertDialogCtrl {\r\n\r\n\tpublic validForm = false;\r\n\tpublic buttonTitle: string;\r\n\tpublic datasource: IJsonDatasource;\r\n\r\n\tpublic datasourceTypeEnum = DatasourceTypeEnum;\r\n\r\n\tpublic datasourceType: string;\r\n\tpublic datasourceTypeOptions: ILookupOptions;\r\n\r\n\tprivate dialog: IDialog<IUpsertDialogParameter>;\r\n\tprivate datasources: IJsonDatasource[];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.DATASOURCE_SERVICE,\r\n\t\tInjectNames.DESIGNER_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprotected scope: IDialogBaseScope<IUpsertDialogParameter>,\r\n\t\tprotected dialogService: DialogService,\r\n\t\tprotected datasourceService: DatasourceService,\r\n\t\tprotected designerService: DesignerService\r\n\t) {\r\n\t\tthis.dialog = scope.eirDialog;\r\n\t\tconst parameter = this.dialog.parameter;\r\n\t\tif (parameter.isEdit) { // Edit\r\n\t\t\tthis.buttonTitle = \"Save\";\r\n\t\t\tthis.datasource = parameter.datasource;\r\n\t\t\tthis.validForm = true;\r\n\t\t\tthis.datasourceType =\r\n\t\t\t\tavailableDatasourceTypes[this.datasource.typedef as any].name;\r\n\t\t} else { // Create\r\n\t\t\tthis.buttonTitle = \"Create\";\r\n\r\n\t\t\tthis.datasource = {\r\n\t\t\t\ttypedef: null,\r\n\t\t\t\tid: \"\",\r\n\t\t\t\tdisplayName: \"\",\r\n\t\t\t\tversion: 1\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tthis.datasources = parameter.datasources;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tprotected saveable(): boolean {\r\n\t\tif (this.dialog.parameter.isEdit) {\r\n\t\t\t// Exclude itself datasource\r\n\t\t\tthis.datasources = this.datasources.filter((datasource: IDatasource) => {\r\n\t\t\t\treturn datasource.id !== this.datasource.id;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst saveable = !this.hasNameConflict(this.datasources, this.datasource.displayName);\r\n\t\treturn saveable;\r\n\t}\r\n\r\n\tprivate hasNameConflict(datasources: IJsonDatasource[], displayName: string): boolean {\r\n\t\treturn datasources.some((datasource: IJsonDatasource) => {\r\n\t\t\treturn datasource.displayName.toLowerCase() === displayName.toLowerCase();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic showErrorDialog(message: string): void {\r\n\t\tthis.dialogService.showMessage({\r\n\t\t\ttitle: \"Operation Failed\",\r\n\t\t\tmessage: message,\r\n\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\tisError: true,\r\n\t\t});\r\n\t}\r\n\r\n\tprivate removeDisabledFields(): IJsonGenericDatasource {\r\n\t\tconst datasource: IJsonGenericDatasource = this.datasource;\r\n\t\tconst method = datasource.method;\r\n\t\tif (method === HttpVerbEnum.GET || method === HttpVerbEnum.HEAD) {\r\n\t\t\tdelete datasource.bodyParameters;\r\n\t\t}\r\n\t\tif (datasource.isOutputFile) {\r\n\t\t\tdelete datasource.outputParameters;\r\n\t\t}\r\n\t\treturn datasource;\r\n\t}\r\n\r\n\tpublic upsertDatasource(): void {\r\n\t\tlet newDatasource: IJsonDatasource = this.datasource;\r\n\r\n\t\tif (this.datasource.typedef === DatasourceTypeEnum.generic) {\r\n\t\t\tnewDatasource = this.removeDisabledFields();\r\n\t\t}\r\n\t\tif (this.saveable()) {\r\n\t\t\tthis.dialog.close({ button: DialogButtonType.Ok, value: newDatasource });\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirDatasourceUpsertDialogCtrl\", DatasourceUpsertDialogCtrl);\r\n\t}\r\n}\r\n","import { Numbers } from \"ng2/common/constants/common.constant\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport * as sw from \"ng2/common/model/swagger.model\";\r\n/**\r\n * Render a Swagger schema with expandable arrays and objects.\r\n */\r\nexport class SwaggerSchemaExpanderComponent {\r\n\tpublic schemaName: string;\r\n\tpublic schema: sw.ISchemaObject;\r\n\tpublic depth: number = 0;\r\n\tpublic expanded = false;\r\n\r\n\tpublic getIndentationStyle (): IMap<string> {\r\n\t\treturn {\r\n\t\t\t\"margin-left\": `${this.depth * Numbers.TWENTY}px`,\r\n\t\t};\r\n\t}\r\n\r\n\tpublic getExpandedStyle (): IMap<string> {\r\n\t\treturn {\r\n\t\t\t\"margin-left\": `${this.expanded ? this.depth * Numbers.TWENTY : 0}px`,\r\n\t\t};\r\n\t}\r\n\r\n\tpublic toggleExpanded (): void {\r\n\t\tthis.expanded = !this.expanded;\r\n\t}\r\n\r\n\tpublic schemaIsObject(): boolean {\r\n\t\tif (this.schema) {\r\n\t\t\treturn this.schema.type === \"object\" || this.schema.properties !== undefined;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic schemaIsArray(): boolean {\r\n\t\tif (this.schema) {\r\n\t\t\treturn this.schema.type === \"array\" || this.schema.items !== undefined;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic schemaIsPrimitive(): boolean {\r\n\t\tif (this.schema) {\r\n\t\t\tconst isNumber = this.schema.type === \"number\";\r\n\t\t\tconst isBoolean = this.schema.type === \"boolean\";\r\n\t\t\tconst isString = this.schema.type === \"string\";\r\n\t\t\tconst isInteger = this.schema.type === \"integer\";\r\n\t\t\tconst isNull = this.schema.type === \"null\";\r\n\t\t\treturn isNumber || isBoolean || isString || isInteger || isNull;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add (m: ng.IModule): void {\r\n\t\tm.component(\"swaggerSchemaExpander\", {\r\n\t\t\ttemplate: require(\"./swagger-schema-expander.html\"),\r\n\t\t\tcontroller: SwaggerSchemaExpanderComponent,\r\n\t\t\tbindings: {\r\n\t\t\t\tschemaName: \"=\",\r\n\t\t\t\tschema: \"=\",\r\n\t\t\t\tdepth: \"=\"\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<span ng-switch=$ctrl.schema.type ng-style=$ctrl.getIndentationStyle()> <span ng-if=$ctrl.schemaIsObject()> <span ng-click=$ctrl.toggleExpanded() style=cursor:pointer>{{$ctrl.schemaName}}: Object{</span> <span ng-show=$ctrl.expanded> <br/> <swagger-schema-expander ng-repeat=\\\"(schemaName, childSchema) in $ctrl.schema.properties\\\" schema=childSchema schema-name=schemaName depth=$ctrl.depth+1></swagger-schema-expander> </span> <span ng-style=$ctrl.getExpandedStyle()>}</span> </span> <span ng-if=$ctrl.schemaIsArray()> <span ng-click=$ctrl.toggleExpanded() style=cursor:pointer>{{$ctrl.schemaName}}: Array[</span> <span ng-show=$ctrl.expanded> <br/> <swagger-schema-expander schema=$ctrl.schema.items depth=$ctrl.depth+1></swagger-schema-expander> </span> <span ng-style=$ctrl.getExpandedStyle()>]</span> </span> <span ng-if=$ctrl.schemaIsPrimitive()> {{$ctrl.schemaName}}: {{$ctrl.schema.type}} <span ng-show=$ctrl.schema.description> - {{$ctrl.schema.description}}</span> </span> <br/> </span>\";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { LocalIdoDataserviceParametersCtrl } from \"./dataservice-parameters-ctrl\";\r\n\r\nexport class LocalIdoDataserviceParametersComponent implements ng.IComponentOptions {\r\n\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\theadTitle: \"@\",\r\n\t\t\tidoProperties: \"<\",\r\n\t\t\tdataserviceParameters: \"=\",\r\n\t\t\twizardNextDisabled: \"=\",\r\n\t\t\terrorList: \"=\",\r\n\t\t\tsetRequiredParameters: \"<?\",\r\n\t\t\tsetPrimaryParameters: \"<?\",\r\n\t\t\tcreateParameterObject: \"&\",\r\n\t\t};\r\n\r\n\t\tthis.controller = LocalIdoDataserviceParametersCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./dataservice-parameters.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\r\n\t\t\t\"eirLocalIdoDataserviceParameters\",\r\n\t\t\tnew LocalIdoDataserviceParametersComponent()\r\n\t\t);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../../../common/angular-constants\";\r\n\r\nimport { Helper } from \"../../../../../../common/helper\";\r\nimport type { IValidationResult } from \"../../../../../../common/shared-components/base/field-validation\";\r\nimport { IOnComponentChangeNotification, NotifiableComponent } from \"../../../../../../common/shared-components/base/notifiable-component\";\r\nimport { CustomFormatters } from \"../../../../../../common/sohoxi/custom-formatters\";\r\nimport type { IRowItem } from \"../../../../../../common/sohoxi/datagrid-helper\";\r\nimport type { IdoProperty } from \"../../../../../../components/services/local-ido-service\";\r\nimport type { ILocalIdoDataserviceWizardScope } from \"../dataservice-wizard-ctrl\";\r\n\r\nimport { IdoProperties, Numbers } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport type { ILocalIdoParameterObject , IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport type { IDatagridApi, IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nexport class LocalIdoDataserviceParametersCtrl extends NotifiableComponent {\r\n\r\n\t// component bindings\r\n\theadTitle: string;\r\n\tidoProperties: IdoProperty[];\r\n\tdataserviceParameters: IParameterObject[];\r\n\twizardNextDisabled: boolean;\r\n\terrorList: any[] = [];\r\n\tsetRequiredParameters: boolean;\r\n\tsetPrimaryParameters: boolean;\r\n\tcreateParameterObject: (item: any) => ILocalIdoParameterObject;\r\n\r\n\tprivate datagridApi: IDatagridApi;\r\n\tdatagridOptions: IDataGridOptions<IdoProperty>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: ILocalIdoDataserviceWizardScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t) {\r\n\t\tsuper();\r\n\t}\r\n\r\n\t$onInit(): void {\r\n\t\tthis.initParameterDatagrid();\r\n\t\tthis.initDatagridEvent();\r\n\t}\r\n\r\n\tprivate initDatagridEvent(): void {\r\n\t\tthis.$element.on(\r\n\t\t\t\"rendered\",\r\n\t\t\t(event: any, element: ng.IAugmentedJQuery) => {\r\n\t\t\t\tthis.initDatagridSelectedEvent(element);\r\n\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\t// needs because Soho Datagrid API isn't initialized right after datagrid triggers rendered\r\n\t\t\t\t\tthis.datagridApi = element.data(\"datagrid\") as IDatagridApi;\r\n\r\n\t\t\t\t\tif (this.dataserviceParameters.length > 0) {\r\n\t\t\t\t\t\tthis.setSelectedRows();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, Numbers.HUNDRED);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tprivate setSelectedRows(): void {\r\n\t\tlet rowsToSelect: number[] = [];\r\n\t\tif (this.datagridApi) {\r\n\t\t\tthis.dataserviceParameters.forEach(parameter => {\r\n\t\t\t\trowsToSelect = this.addToSelect(rowsToSelect, parameter.key);\r\n\t\t\t});\r\n\t\t\tthis.datagridApi.selectRows(rowsToSelect);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addToSelect(list: number[], propertyName: string): number[] {\r\n\t\treturn list.concat(this.datagridApi.findRowsByValue(\"propertyName\", propertyName));\r\n\t}\r\n\r\n\tprivate initDatagridSelectedEvent(element: ng.IAugmentedJQuery): void {\r\n\t\telement.on(\r\n\t\t\t\"selected\",\r\n\t\t\t(event: any, selectedDatagridItems: IRowItem<IdoProperty>[]) => {\r\n\t\t\t\tthis.$scope.$applyAsync(() => {\r\n\t\t\t\t\tthis.onSelectedEvent(selectedDatagridItems);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tprivate onSelectedEvent(selectedDatagridItems: IRowItem<IdoProperty>[]): void {\r\n\t\tconst newDataserviceParameters =\r\n\t\t\tthis.getSelectedDataserviceParameters(selectedDatagridItems);\r\n\r\n\t\tconst addedDataserviceParameters = this.dataserviceParameters;\r\n\r\n\t\tnewDataserviceParameters.forEach((newDataserviceParameter, index, array) => {\r\n\t\t\tconst parameter = addedDataserviceParameters\r\n\t\t\t\t.find(addedOutputParameter => addedOutputParameter.key === newDataserviceParameter.key);\r\n\t\t\tif (parameter) {\r\n\t\t\t\tarray[index].alias = parameter.alias;\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.dataserviceParameters = newDataserviceParameters;\r\n\t}\r\n\r\n\tisAliasUnique(alias: string, id: string): boolean {\r\n\t\tif (Helper.isUndefinedEmpty(alias)) {\r\n\t\t\t// alias is empty string skip checking\r\n\t\t\tthis.wizardNextDisabled = false;\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tconst parameters = this.dataserviceParameters;\r\n\t\t// alias check comes from same id skip checking\r\n\t\tconst checkAlias = parameters.filter(\r\n\t\t\tparameter => parameter.alias === alias\r\n\t\t);\r\n\t\tif (checkAlias.length > 1) {\r\n\t\t\tthis.wizardNextDisabled = true;\r\n\t\t\treturn false;\r\n\t\t} else if (checkAlias.length === 1 && checkAlias[0].id === id) {\r\n\t\t\tthis.wizardNextDisabled = false;\r\n\t\t\treturn true;\r\n\t\t} else if (checkAlias.length === 1 && checkAlias[0].id !== id) {\r\n\t\t\tthis.wizardNextDisabled = true;\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.wizardNextDisabled = false;\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate getSelectedDataserviceParameters(\r\n\t\tselectedDatagridItems: IRowItem<IdoProperty>[]\r\n\t): ILocalIdoParameterObject[] {\r\n\t\tconst dataserviceParameters: ILocalIdoParameterObject[] = [];\r\n\r\n\t\tselectedDatagridItems.forEach(item => {\r\n\t\t\tdataserviceParameters.push(this.createParameterObject({ $item: item }));\r\n\t\t});\r\n\t\treturn dataserviceParameters;\r\n\t}\r\n\r\n\tprivate initParameterDatagrid(): void {\r\n\t\tlet columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\tid: \"selectionCheckbox\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\twidth: 50,\r\n\t\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\t\talign: \"center\",\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"propertyName\",\r\n\t\t\t\tname: \"Property Name\",\r\n\t\t\t\tfield: \"propertyName\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: 200,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"dataType\",\r\n\t\t\t\tname: \"Data Type\",\r\n\t\t\t\tfield: \"dataType\",\r\n\t\t\t\twidth: 200,\r\n\t\t\t\tsortable: true\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"dataLength\",\r\n\t\t\t\tname: \"Length\",\r\n\t\t\t\tfield: \"dataLength\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: 200\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tif (this.setRequiredParameters) {\r\n\t\t\tcolumns = columns.concat([{\r\n\t\t\t\tid: \"isReadOnly\",\r\n\t\t\t\tname: \"Read Only\",\r\n\t\t\t\tfield: \"isReadOnly\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: \"21%\",\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"isReadOnly\")\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"isRequired\",\r\n\t\t\t\tname: \"Required\",\r\n\t\t\t\tfield: \"isRequired\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: \"21%\",\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"isRequired\")\r\n\t\t\t}]);\r\n\t\t}\r\n\r\n\t\tif (this.setPrimaryParameters) {\r\n\t\t\tcolumns = columns.concat([{\r\n\t\t\t\tid: \"keySequence\",\r\n\t\t\t\tname: \"Primary Key\",\r\n\t\t\t\tfield: \"keySequence\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: \"21%\",\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"keySequence\", true)\r\n\t\t\t}]);\r\n\t\t}\r\n\r\n\t\t//ItemID is nothing you can filter with\r\n\t\tif (this.headTitle === \"Filter Properties\") {\r\n\t\t\tthis.idoProperties = this.idoProperties.filter((idoProperty) => {\r\n\t\t\t\treturn idoProperty.propertyName !== IdoProperties.ITEM_ID;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tlet requiredFirst;\r\n\t\tif (this.setPrimaryParameters) {\r\n\t\t\trequiredFirst = angular.copy(this.idoProperties).sort((x, y) => {\r\n\t\t\t\treturn x.keySequence > 0 ? -1 : y.keySequence > 0 ? 1 : 0;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\trequiredFirst = Helper.sortObjectByProperty(\r\n\t\t\t\tangular.copy(this.idoProperties), \"isRequired\", true);\r\n\t\t}\r\n\r\n\t\tthis.datagridOptions = {\r\n\t\t\tcolumns,\r\n\t\t\tdataset: requiredFirst,\r\n\t\t\tindeterminate: true,\r\n\t\t\tisList: false,\r\n\t\t\tsaveColumns: false,\r\n\t\t\tenableTooltips: true,\r\n\t\t\tselectable: this.setPrimaryParameters ? false : SelectableEnum.Multiple,\r\n\t\t\trowHeight: \"short\",\r\n\t\t\tisRowDisabled: (idx, item: any) => {\r\n\t\t\t\tif (this.setRequiredParameters && item.isRequired) {\r\n\t\t\t\t\titem._selected = true;\r\n\t\t\t\t} else if (this.setPrimaryParameters && item.keySequence > 0) {\r\n\t\t\t\t\titem._selected = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem._selected = false;\r\n\t\t\t\t}\r\n\t\t\t\treturn item._selected;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tgetValidation($data: IOnComponentChangeNotification): boolean | IValidationResult {\r\n\t\tlet result: boolean;\r\n\t\tif ($data.validator === \"isAliasUnique\") {\r\n\t\t\tresult = this.isAliasUnique($data.value, $data.id);\r\n\t\t} else if ($data.validator === \"isFirstCharLetter\") {\r\n\t\t\tresult = $data.value ? Helper.isFirstCharLetter($data.value) : true;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"field local-ido-parameter-field\\\"> <div id=localIdoProperties xi-datagrid=ctrl.datagridOptions> </div> </div> <hr class=hr-field> <div ng-show=\\\"ctrl.dataserviceParameters.length !== 0\\\"> <div class=compound-field> <h3 class=fieldset-title>Included {{ ctrl.headTitle }} </h3></div> <div class=\\\"local-ido-parameter-field field\\\"> <div class=compound-field> <div class=field-short> <label class=\\\"\\\" for=parameterName>Name</label> </div> <div class=field-short> <label class=\\\"\\\" for=parameterType>Type</label> </div> <div class=field-short> <label class=\\\"\\\" for=input-field-component>Alias (Optional)</label> </div> </div> <div class=compound-field ng-repeat=\\\"item in ctrl.dataserviceParameters track by item.id\\\"> <div class=field-short> <input name=parameterName ng-value=item.key readonly=readonly /> </div> <div class=field-short> <input name=parameterType class=\\\"input-xs override-soho-field-short-label-type\\\" ng-value=item.dataType readonly=readonly /> </div> <div class=field-short> <eir-input-field-component id={{item.id}} field-value=item.alias field-name=parameterAlias validation=\\\"{\\r\\n\\t\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvalidator: 'isAliasUnique',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\terrorMessage: 'Alias has to be unique'\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\r\\n\\t\\t\\t\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvalidator: 'isFirstCharLetter',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\terrorMessage: 'First character needs to be a letter'\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\r\\n\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t\\t}\\\" on-component-change=ctrl.notify($data) parent-announce=ctrl.parentAnnounce /> </div> </div> <hr class=hr-field> </div> </div> \";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { LocalIdoDataserviceSummaryDatagridCtrl } from \"./dataservice-summary-datagrid-ctrl\";\r\n\r\nexport class LocalIdoDataserviceSummaryDatagridComponent implements ng.IComponentOptions {\r\n\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\theadTitle: \"@\",\r\n\t\t\tdataset: \"<\",\r\n\t\t\tdatagridOptions: \"<?\"\r\n\t\t};\r\n\r\n\t\tthis.controller = LocalIdoDataserviceSummaryDatagridCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./dataservice-summary-datagrid.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirLocalIdoDataserviceSummaryDatagridComponent\", new LocalIdoDataserviceSummaryDatagridComponent());\r\n\t}\r\n}\r\n","import { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { CustomFormatters } from \"../../../../../../common/sohoxi/custom-formatters\";\r\n\r\nexport class LocalIdoDataserviceSummaryDatagridCtrl {\r\n\r\n\t// component bindings\r\n\tpublic headTitle: string;\r\n\tpublic dataset: IParameterObject[];\r\n\r\n\tpublic datagridOptions: IDataGridOptions<IParameterObject>;\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.initDatagridOptions();\r\n\t}\r\n\r\n\tprivate initDatagridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\twidth: \"30%\",\r\n\t\t\t\tid: \"key\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"key\",\r\n\t\t\t\tsortable: false\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\twidth: \"30%\",\r\n\t\t\t\tid: \"parameterType\",\r\n\t\t\t\tname: \"Type\",\r\n\t\t\t\tfield: \"parameterType\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tformatter: CustomFormatters.DataSourceParameterType()\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\twidth: \"30%\",\r\n\t\t\t\tid: \"alias\",\r\n\t\t\t\tname: \"Alias\",\r\n\t\t\t\tfield: \"alias\",\r\n\t\t\t\tsortable: false\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tthis.datagridOptions = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tisList: true,\r\n\t\t\tselectable: false,\r\n\t\t\tdataset: this.dataset,\r\n\t\t\trowHeight: \"short\"\r\n\t\t};\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=field> <span class=label>{{ ctrl.headTitle }}</span> <div xi-datagrid=ctrl.datagridOptions></div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport { IdoProperties, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IJsonDatasource, IJsonLocalIdoDatasource, IRecordCapOption } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { ILocalIdoParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\n\r\nimport { HttpVerbEnum } from \"../../../../../../app-builder/common/enums/http-verb.enum\";\r\nimport { IDialogBaseScope } from \"../../../../../common/defines\";\r\nimport { ITestDataserviceParameters, TestDataserviceDialogType, TTestDataserviceDialogType } from \"../../../../../common/dialogs/test-dataservice/test-dataservice-dialog\";\r\nimport { IRowItem } from \"../../../../../common/sohoxi/datagrid-helper\";\r\nimport { IWizardStep, WizardCtrl } from \"../../../../editor/wizard/wizard-ctrl\";\r\nimport { SourceEnum } from \"../../create-from-wizard/select-source-ctrl\";\r\nimport { ILocalIdoParameter } from \"../../search/local-ido/operation-details-ctrl\";\r\n\r\nimport { Helper } from \"../../../../../common/helper\";\r\nimport { DialogService, IDialogOptions, IDialogResult } from \"../../../../../common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../../../../common/services/feature-switch-service\";\r\nimport { IdoCollection, IdoProperty, ILocalIDOTestDataService, LocalIdoService } from \"../../../../../components/services/local-ido-service\";\r\n\r\nexport interface ILocalIdoDataserviceWizardScope extends IDialogBaseScope<ILocalIdoParameter> {}\r\n\r\nclass IdoOperations {\r\n\tstatic LOAD = \"Load Collection\";\r\n\tstatic UPDATE = \"Update Row\";\r\n\tstatic INSERT = \"Insert Row\";\r\n\tstatic DELETE = \"Delete Row\";\r\n}\r\n\r\nexport class LocalIdoDataserviceWizardCtrl extends WizardCtrl {\r\n\tpublic get idoCollection(): IdoCollection {\r\n\t\treturn this.$scope.eirDialog.parameter.operation;\r\n\t}\r\n\r\n\t// tslint:disable:no-magic-numbers\r\n\tpublic get LocalIdoOperation(): string {\r\n\t\tswitch (this.datasource.method) {\r\n\t\t\tcase HttpVerbEnum.GET:\r\n\t\t\t\treturn this.operationList[0];\r\n\t\t\tcase HttpVerbEnum.PUT:\r\n\t\t\t\treturn this.operationList[1];\r\n\t\t\tcase HttpVerbEnum.POST:\r\n\t\t\t\treturn this.operationList[2];\r\n\t\t\tdefault:\r\n\t\t\tcase HttpVerbEnum.DELETE:\r\n\t\t\t\treturn this.operationList[3];\r\n\t\t}\r\n\t}\r\n\t// tslint:enable\r\n\r\n\tpublic operationList: string[] = [\r\n\t\tIdoOperations.LOAD,\r\n\t\tIdoOperations.UPDATE,\r\n\t\tIdoOperations.INSERT,\r\n\t\tIdoOperations.DELETE\r\n\t];\r\n\r\n\tpublic recordCapOptions: IRecordCapOption[] = [\r\n\t\t{ name: \"Use Default\", id: \"0\", limit: 200 },\r\n\t\t{ name: \"Retrieve All\", id: \"1\", limit: -1 },\r\n\t\t{ name: \"Use Specified Max\", id: \"2\" },\r\n\t];\r\n\tpublic selectedRecordCapOption: string;\r\n\r\n\tprivate DEFAULT_ORDER: string = \"Default Order\";\r\n\r\n\tpublic $scope: ILocalIdoDataserviceWizardScope;\r\n\r\n\tpublic selectedOperation: string;\r\n\r\n\t// public itemIdChecked: boolean;\r\n\tpublic currentShownIdName: string;\r\n\tpublic idoProperties: IdoProperty[];\r\n\tpublic idoPropertyOptions: string[];\r\n\r\n\tpublic datasource: IJsonLocalIdoDatasource;\r\n\r\n\tprivate previousMethod: string;\r\n\r\n\t// TODO: MUPS-2682: Refactor wizard template URL so it uses require\r\n\tpublic steps: IWizardStep[] = [\r\n\t\t{\r\n\t\t\tid: \"dataservice-wizard-operation.html\",\r\n\t\t\ttitle: \"Operation\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./dataservice-wizard-operation.html\")\r\n\t\t},\r\n\t\t{\r\n\t\t\tid: \"dataservice-wizard-parameters.html\",\r\n\t\t\ttitle: \"Parameters\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./dataservice-parameters/dataservice-wizard-parameters.html\")\r\n\t\t},\r\n\t\t{\r\n\t\t\tid: \"datasource-wizard-description.html\",\r\n\t\t\ttitle: \"Name &amp; Description\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"../datasource-wizard-description.html\")\r\n\t\t},\r\n\t\t{\r\n\t\t\tid: \"dataservice-wizard-summary.html\",\r\n\t\t\ttitle: \"Summary\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./dataservice-summary/dataservice-wizard-summary.html\")\r\n\t\t}\r\n\t];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TEMPLATE_CACHE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t\tInjectNames.LOCAL_IDO_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ILocalIdoDataserviceWizardScope,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$templateCache: ng.ITemplateCacheService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t\tprivate localIdoService: LocalIdoService,\r\n\t\tprivate dialogService: DialogService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\t$scope,\r\n\t\t\t$element,\r\n\t\t\t$templateCache,\r\n\t\t\tfeatureService,\r\n\t\t);\r\n\t\tthis.initWizard();\r\n\t\tthis.nextDisabled = false;\r\n\t\tconst eirDialog = $scope.eirDialog;\r\n\r\n\t\tif (eirDialog.parameter.datasource) {\r\n\t\t\tthis.datasource = eirDialog.parameter.datasource;\r\n\t\t\tthis.initEditDataServiceDialog();\r\n\t\t} else if (this.idoCollection) {\r\n\t\t\t// New from Wizard\r\n\t\t\tthis.selectedOperation = this.operationList[0];\r\n\t\t\tthis.selectedRecordCapOption = \"0\";\r\n\r\n\t\t\tthis.datasource = {\r\n\t\t\t\tdisplayName: this.idoCollection.collectionName,\r\n\t\t\t\tmethod: HttpVerbEnum.GET,\r\n\t\t\t\tresource: this.idoCollection.collectionName,\r\n\t\t\t\ttypedef: DatasourceTypeEnum.IDO,\r\n\t\t\t\tendpoint: \"\",\r\n\t\t\t\tsuite: SourceEnum.LOCAL_IDO,\r\n\t\t\t\tversion: 2,\r\n\t\t\t\toutputParameters: [],\r\n\t\t\t\tinputParameters: [],\r\n\t\t\t\torderBy: this.DEFAULT_ORDER,\r\n\t\t\t\trecordCap: this.recordCapOptions[0]\r\n\t\t\t};\r\n\r\n\t\t\tthis.loadIdoCollectionProperties();\r\n\t\t} else {\r\n\t\t\t// From scratch\r\n\t\t\tconsole.info(\"Create from scratch\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadIdoCollectionProperties(): void {\r\n\t\tthis.localIdoService\r\n\t\t\t.getIdoProperties(this.datasource.resource)\r\n\t\t\t.then(properties => {\r\n\t\t\t\tthis.idoProperties = angular.copy(properties);\r\n\t\t\t\treturn properties;\r\n\t\t\t})\r\n\t\t\t.then(properties => {\r\n\t\t\t\tthis.idoPropertyOptions = properties.map(property => property.propertyName);\r\n\t\t\t\tthis.idoPropertyOptions.unshift(this.DEFAULT_ORDER);\r\n\t\t\t})\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.addItemID();\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate initEditDataServiceDialog(): void {\r\n\t\t// Edit existing datasource\r\n\t\tthis.loadIdoCollectionProperties();\r\n\r\n\t\tconst recordCap = this.datasource.recordCap;\r\n\t\tthis.selectedRecordCapOption = !recordCap ? this.recordCapOptions[0].id : recordCap.id;\r\n\r\n\t\tthis.setIdoOperation();\r\n\t}\r\n\r\n\tprivate setIdoOperation(): void {\r\n\t\t// tslint:disable:no-magic-numbers\r\n\t\tswitch (this.datasource.method) {\r\n\t\t\tcase HttpVerbEnum.GET:\r\n\t\t\t\tthis.selectedOperation = this.operationList[0];\r\n\t\t\t\tbreak;\r\n\t\t\tcase HttpVerbEnum.PUT:\r\n\t\t\t\tthis.selectedOperation = this.operationList[1];\r\n\t\t\t\tbreak;\r\n\t\t\tcase HttpVerbEnum.POST:\r\n\t\t\t\tthis.selectedOperation = this.operationList[2];\r\n\t\t\t\tbreak;\r\n\t\t\tcase HttpVerbEnum.DELETE:\r\n\t\t\tdefault:\r\n\t\t\t\tthis.selectedOperation = this.operationList[3];\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t// tslint:enable\r\n\t\tthis.previousMethod = this.datasource.method;\r\n\t}\r\n\r\n\t/**\r\n\t * Adds ItemID if operation is LOAD, UPDATE, or DELETE.\r\n\t * Otherwise remove ItemID if its in the list\r\n\t */\r\n\tprivate addItemID(): void {\r\n\t\tconst hasItemID = this.idoProperties.\r\n\t\t\tfindIndex(property => property.propertyName === IdoProperties.ITEM_ID) !== -1;\r\n\t\tconst hasRowPointer = this.idoProperties.\r\n\t\t\tfindIndex(property => property.propertyName === IdoProperties.ROW_POINTER) !== -1;\r\n\r\n\t\tif (this.datasource.method !== HttpVerbEnum.POST && !hasItemID && hasRowPointer) {\r\n\t\t\tthis.idoProperties.unshift({\r\n\t\t\t\tpropertyName: IdoProperties.ITEM_ID,\r\n\t\t\t\tpropertyType: \"string\",\r\n\t\t\t\tcolumnName: IdoProperties.ITEM_ID,\r\n\t\t\t\tisReadOnly: true,\r\n\t\t\t\tisRequired: true,\r\n\t\t\t\tdataType: \"string\",\r\n\t\t\t\tkeySequence: 99\r\n\t\t\t});\r\n\t\t} else if (this.datasource.method === HttpVerbEnum.POST) {\r\n\t\t\tthis.idoProperties =\r\n\t\t\t\tthis.idoProperties.filter(property => property.propertyName !== IdoProperties.ITEM_ID);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onChangeCurrentStep(): void {\r\n\t\tif (this.currentShownIdName) {\r\n\t\t\tthis.onToggleParameterSetting(this.currentShownIdName);\r\n\t\t}\r\n\t\tif (!Helper.isUndefined(this.previousMethod) &&\r\n\t\tthis.previousMethod !== this.datasource.method) {\r\n\t\t\tthis.datasource.inputParameters.length = 0;\r\n\t\t}\r\n\t\tthis.previousMethod = this.datasource.method;\r\n\t}\r\n\r\n\tprotected getFinishParameter(): IJsonDatasource {\r\n\t\tconst method = this.datasource.method;\r\n\r\n\t\tif (method === HttpVerbEnum.PUT) {\r\n\t\t\tthis.datasource.outputParameters = this.datasource.inputParameters;\r\n\t\t}\r\n\r\n\t\tif (method === HttpVerbEnum.PUT ||\r\n\t\t\tmethod === HttpVerbEnum.POST) {\r\n\t\t\tthis.addRequiredParameters();\r\n\t\t} else if (method === HttpVerbEnum.DELETE) {\r\n\t\t\tthis.addPrimaryParameters();\r\n\t\t}\r\n\r\n\t\treturn this.datasource;\r\n\t}\r\n\r\n\tprivate addRequiredParameters(dataservice?: IJsonLocalIdoDatasource): void {\r\n\t\tconst localIdoDataservice = dataservice ?\r\n\t\t\tdataservice : this.datasource;\r\n\t\tthis.idoProperties.forEach(property => {\r\n\t\t\tif (property.isRequired) {\r\n\t\t\t\tconst datagridItem: IRowItem<IdoProperty> = {\r\n\t\t\t\t\tdata: property\r\n\t\t\t\t} as any;\r\n\t\t\t\tlocalIdoDataservice.inputParameters.push(this.createParameterObject(datagridItem));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate addPrimaryParameters(dataservice?: IJsonLocalIdoDatasource): void {\r\n\t\tconst localIdoDataservice = dataservice ?\r\n\t\t\tdataservice : this.datasource;\r\n\t\tthis.idoProperties.forEach(property => {\r\n\t\t\tif (property.keySequence > 0) {\r\n\t\t\t\tconst datagridItem: IRowItem<IdoProperty> = {\r\n\t\t\t\t\tdata: property\r\n\t\t\t\t} as any;\r\n\t\t\t\tlocalIdoDataservice.inputParameters.push(this.createParameterObject(datagridItem));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic createParameterObject(item: IRowItem<IdoProperty>): ILocalIdoParameterObject {\r\n\t\tconst currentParameters = this.datasource.method !== HttpVerbEnum.GET ?\r\n\t\t\tthis.datasource.inputParameters : this.datasource.outputParameters;\r\n\t\tconst existingParameter = currentParameters\r\n\t\t\t.find(param => param.key === item.data.propertyName);\r\n\r\n\t\treturn ({\r\n\t\t\tid:  !existingParameter ? Helper.generateUniqueId() : existingParameter.id,\r\n\t\t\tkey: item.data.propertyName,\r\n\t\t\tvalueType: this.getValueType(item.data.dataType),\r\n\t\t\tdataType: item.data.dataType,\r\n\t\t\tparameterType: ParameterTypeEnum.QUERY,\r\n\t\t\trequired: item.data.isRequired,\r\n\t\t\talias: \"\"\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getValueType(datatype: string): ValueTypeEnum {\r\n\t\tswitch (datatype) {\r\n\t\t\tcase \"Date\":\r\n\t\t\t\treturn ValueTypeEnum.DATE;\r\n\t\t\tcase \"String\":\r\n\t\t\tcase \"GUID\":\r\n\t\t\t\treturn ValueTypeEnum.STRING;\r\n\t\t\tcase \"Long Integer\":\r\n\t\t\tcase \"Byte\":\r\n\t\t\tdefault:\r\n\t\t\t\treturn ValueTypeEnum.NUMBER;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onOperationChange(): void {\r\n\t\tswitch (this.selectedOperation) {\r\n\t\t\tcase IdoOperations.LOAD:\r\n\t\t\t\tthis.datasource.method = HttpVerbEnum.GET;\r\n\t\t\t\tbreak;\r\n\t\t\tcase IdoOperations.INSERT:\r\n\t\t\t\tthis.datasource.method = HttpVerbEnum.POST;\r\n\t\t\t\tbreak;\r\n\t\t\tcase IdoOperations.UPDATE:\r\n\t\t\t\tthis.datasource.method = HttpVerbEnum.PUT;\r\n\t\t\t\tbreak;\r\n\t\t\tcase IdoOperations.DELETE:\r\n\t\t\tdefault:\r\n\t\t\t\tthis.datasource.method = HttpVerbEnum.DELETE;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.addItemID();\r\n\t}\r\n\r\n\tpublic onRecordCapChange(): void {\r\n\t\tconst optionId = parseInt(this.selectedRecordCapOption);\r\n\t\tthis.datasource.recordCap = this.recordCapOptions[optionId];\r\n\t}\r\n\r\n\tpublic onToggleParameterSetting(idName: string): void {\r\n\t\tif (Helper.isUndefinedOrNull(this.currentShownIdName)) {\r\n\t\t\tthis.toggleParameterSettings(idName);\r\n\t\t\tthis.currentShownIdName = idName;\r\n\t\t} else if (this.currentShownIdName === idName) {\r\n\t\t\tthis.toggleParameterSettings(idName);\r\n\t\t\tthis.currentShownIdName = undefined;\r\n\r\n\t\t} else if (this.currentShownIdName !== idName) {\r\n\t\t\tthis.toggleParameterSettings(this.currentShownIdName);\r\n\t\t\tthis.toggleParameterSettings(idName);\r\n\t\t\tthis.currentShownIdName = idName;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate toggleParameterSettings(idName: string): void {\r\n\t\tlet eirLocalIdoDataserviceElement =\r\n\t\t\tthis.$element.find(`#${idName} > eir-local-ido-dataservice-parameters`);\r\n\r\n\t\teirLocalIdoDataserviceElement = eirLocalIdoDataserviceElement.length ?\r\n\t\t\teirLocalIdoDataserviceElement :\r\n\t\t\tthis.$element.find(`#${idName} > #local-ido-settings`);\r\n\r\n\t\teirLocalIdoDataserviceElement.slideToggle();\r\n\r\n\t\tconst textElement = this.$element.find(`#${idName} a`);\r\n\t\tconst text = textElement.text().trim();\r\n\t\ttextElement.text(text === \"Show more\" ? \"Show less\" : \"Show more\");\r\n\t}\r\n\r\n\tpublic openTestDataserviceDialog(): ng.IPromise<IDialogResult<string>> {\r\n\t\tconst preliminaryDataservice = angular.copy(this.datasource) as ILocalIDOTestDataService;\r\n\t\tif (this.selectedOperation !== IdoOperations.LOAD) {\r\n\t\t\tthis.addRequiredParameters(preliminaryDataservice);\r\n\t\t}\r\n\r\n\t\tpreliminaryDataservice.isTestIDO = true;\r\n\r\n\t\tconst options: IDialogOptions<ITestDataserviceParameters> = {\r\n\t\t\ttitle: \"Test Data Service\",\r\n\t\t\ttemplate: require(\"../../../../../common/dialogs/test-dataservice/test-dataservice-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tdataservice: preliminaryDataservice,\r\n\t\t\t\ttype: this.getTestDialogType(),\r\n\t\t\t},\r\n\t\t};\r\n\t\treturn this.dialogService.show<ITestDataserviceParameters, string>(options);\r\n\t}\r\n\r\n\tprivate getTestDialogType(): TTestDataserviceDialogType {\r\n\t\tconst inputParamStep = 0;\r\n\t\tconst outputParamStep = 1;\r\n\t\tlet testDialogType: TTestDataserviceDialogType;\r\n\r\n\t\tswitch (this.steps.indexOf(this.currentStep)) {\r\n\t\t\tcase inputParamStep:\r\n\t\t\t\ttestDialogType = TestDataserviceDialogType.UNFORMATTED;\r\n\t\t\t\tbreak;\r\n\t\t\tcase outputParamStep:\r\n\t\t\t\ttestDialogType = TestDataserviceDialogType.FORMATTED;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\ttestDialogType = TestDataserviceDialogType.UNFORMATTED;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\ttestDialogType = TestDataserviceDialogType.UNFORMATTED;\r\n\r\n\t\treturn testDialogType;\r\n\t}\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.controller(\r\n\t\t\t\"eirLocalIdoDataserviceWizardCtrl\",\r\n\t\t\tLocalIdoDataserviceWizardCtrl\r\n\t\t);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=container> <div class=field> <label for=local-ido-operation class=fieldset-title> Choose the collection operation that you want to configure </label> <select id=local-ido-operation class=dropdown ng-model=wizardCtrl.selectedOperation ng-change=wizardCtrl.onOperationChange(option) ng-options=\\\"option for option in wizardCtrl.operationList\\\" xi-drop-down=\\\"{ placeholder: '' }\\\"> </select> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"container local-ido-dataservice-wizard-parameters\\\"> <div ng-if=\\\"wizardCtrl.datasource.method === 'GET'\\\"> <div class=\\\"row row-divider\\\" id=parameter-settings-one> <h2 class=fieldset-title ng-click=\\\"wizardCtrl.onToggleParameterSetting('parameter-settings-one')\\\">Output Properties</h2> <eir-local-ido-dataservice-parameters head-title=\\\"Output Properties\\\" dataservice-parameters=wizardCtrl.datasource.outputParameters wizard-next-disabled=wizardCtrl.nextDisabled ido-properties=wizardCtrl.idoProperties error-list=wizardCtrl.ErrorList set-required-parameters=wizardCtrl.itemIdChecked create-parameter-object=wizardCtrl.createParameterObject($item)> </eir-local-ido-dataservice-parameters> <div class=\\\"field-short show-less-more\\\" ng-click=\\\"wizardCtrl.onToggleParameterSetting('parameter-settings-one')\\\"> <a href=# onclick=return!1 class=hyperlink>Show more</a> </div> </div> <hr class=hr-field> </div> <div class=\\\"row row-divider\\\" id=parameter-settings-two> <h2 class=fieldset-title ng-click=\\\"wizardCtrl.onToggleParameterSetting('parameter-settings-two')\\\">{{ wizardCtrl.datasource.method === \\\"GET\\\" ? \\\"Filter Properties\\\" : \\\"Input Properties\\\" }}</h2> <eir-local-ido-dataservice-parameters head-title=\\\"{{ wizardCtrl.datasource.method !== 'GET' ? 'Input Properties' : 'Filter Properties' }}\\\" dataservice-parameters=wizardCtrl.datasource.inputParameters wizard-next-disabled=wizardCtrl.nextDisabled ido-properties=wizardCtrl.idoProperties error-list=wizardCtrl.ErrorList set-required-parameters=\\\"wizardCtrl.datasource.method == 'PUT' || wizardCtrl.datasource.method == 'POST'\\\" set-primary-parameters=\\\"wizardCtrl.datasource.method == 'DELETE'\\\" create-parameter-object=wizardCtrl.createParameterObject($item)> </eir-local-ido-dataservice-parameters> <div class=field-short ng-click=\\\"wizardCtrl.onToggleParameterSetting('parameter-settings-two')\\\"> <a href=# onclick=return!1 class=hyperlink>Show more</a> </div> </div> <hr class=hr-field> <div ng-if=\\\"wizardCtrl.datasource.method === 'GET'\\\"> <div class=\\\"row row-divider\\\" id=parameter-settings-three> <h2 class=fieldset-title ng-click=\\\"wizardCtrl.onToggleParameterSetting('parameter-settings-three')\\\">IDO Settings</h2> <div id=local-ido-settings class=content> <div class=field> <label for=local-ido-orderby>Data Record Cap</label> <fieldset class=radio-group> <div ng-repeat=\\\"item in wizardCtrl.recordCapOptions track by item.id\\\"> <input type=radio class=radio name=record-cap-option id={{item.id}} value={{item.id}} ng-model=wizardCtrl.selectedRecordCapOption ng-change=wizardCtrl.onRecordCapChange()> <label for={{item.id}} class=radio-label>{{ item.name }}</label> </div> </fieldset> </div> <div class=field> <eir-input-field-component label-name=\\\"Record Cap\\\" field-value=wizardCtrl.datasource.recordCap.limit validation=\\\"{\\r\\n\\t\\t\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t{ type: 'numeric' },\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t{ type: 'not-empty' }\\r\\n\\t\\t\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\t\\t\\terrorList: wizardCtrl.ErrorList\\r\\n\\t\\t\\t\\t\\t\\t}\\\" readonly=\\\"wizardCtrl.datasource.recordCap.id !== '2'\\\"/> </div> <div class=field> <label for=local-ido-orderby>Default Order By</label> <select id=local-ido-operation class=dropdown ng-model=wizardCtrl.datasource.orderBy ng-options=\\\"option for option in wizardCtrl.idoPropertyOptions\\\" xi-drop-down=\\\"{ placeholder: '' }\\\"> </select> </div> </div> <div class=field-short ng-click=\\\"wizardCtrl.onToggleParameterSetting('parameter-settings-three')\\\"> <a href=# onclick=return!1 class=hyperlink>Show more</a> </div> </div> <hr class=hr-field> </div> <div class=field> <div class=field-button> <button class=btn-primary type=button ng-click=wizardCtrl.openTestDataserviceDialog() ng-disabled=wizardCtrl.nextDisabled xi-tooltip=\\\"'Test Data Service'\\\"> <span>Test Data Service</span> </button> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=container> <div class=row> <h2 class=fieldset-title>Local IDO Setup Summary</h2> <hr class=hr-field> </div> <div class=row> <div class=field> <span class=label>Name</span> <span class=\\\"data summary {{wizardCtrl.datasource.displayName.length > 0 ? '' : 'warning-field' }}\\\"> {{ wizardCtrl.datasource.displayName.length > 0 ? wizardCtrl.datasource.displayName : 'Empty' }} </span> </div> <div class=field ng-hide=\\\"!wizardCtrl.datasource.description || wizardCtrl.datasource.description.length === 0 \\\"> <span class=label>Description</span> <span class=\\\"data summary\\\">{{ wizardCtrl.datasource.description }}</span> </div> </div> <div class=row> <div class=field> <span class=label>Operation</span> <span class=\\\"data summary\\\">{{ wizardCtrl.LocalIdoOperation }}</span> </div> <eir-local-ido-dataservice-summary-datagrid-component ng-if=wizardCtrl.datasource.outputParameters.length head-title=\\\"Included Output Parameters\\\" dataset=wizardCtrl.datasource.outputParameters> </eir-local-ido-dataservice-summary-datagrid-component> <eir-local-ido-dataservice-summary-datagrid-component ng-if=wizardCtrl.datasource.inputParameters.length head-title=\\\"Included Filter Parameters\\\" dataset=wizardCtrl.datasource.inputParameters> </eir-local-ido-dataservice-summary-datagrid-component> </div> <div class=row> <div class=field ng-if=wizardCtrl.datasource.orderBy.length> <span class=label>Order By</span> <span class=\\\"data summary\\\">{{ wizardCtrl.datasource.orderBy }}</span> </div> <div class=field ng-if=wizardCtrl.datasource.recordCap.length> <span class=label>Record Cap</span> <span class=\\\"data summary\\\">{{ wizardCtrl.datasource.recordCap }}</span> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","import { Config, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { AngularConstants } from \"../../../../../common/angular-constants\";\r\nimport { IErrorResponse } from \"../../../../../common/error-response\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialog, IDialogOptions\r\n} from \"../../../../../common/services/dialog-service\";\r\nimport { IdoCollection, IdoProject, IdoProperty, LocalIdoService } from \"../../../../../components/services/local-ido-service\";\r\nimport { BaseSearchCtrl, ISearchDialogFieldScope } from \"../base-search-ctrl\";\r\nimport { ILocalIdoParameter } from \"./operation-details-ctrl\";\r\n\r\nexport class LocalIdoSearchCtrl extends BaseSearchCtrl {\r\n\r\n\tpublic filterOptions: any[] = [];\r\n\tpublic dropdownOptions: IdoProject[];\r\n\tpublic operations: IdoCollection[];\r\n\tpublic focusedOperation: IdoCollection;\r\n\r\n\tpublic metadataService: LocalIdoService;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.LOCAL_IDO_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ISearchDialogFieldScope,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$cacheFactory: ng.ICacheFactoryService,\r\n\t\tdialogService: DialogService,\r\n\t\tlocalIdoService: LocalIdoService,\r\n\t) {\r\n\t\tsuper($scope, $element, $cacheFactory, dialogService, localIdoService);\r\n\t}\r\n\r\n\tpublic setDropdownOptions(): void {\r\n\t\tthis.metadataService.getIdoProjectList().then(response => {\r\n\t\t\tthis.dropdownOptions = response;\r\n\t\t\tthis.dropdownOptions.unshift({ serverName: \"All\", serverDesc: undefined, accessAs: undefined });\r\n\t\t\tthis.$scope.selectedOption = this.dropdownOptions[0];\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tpublic getListItems(selectedOption: IdoProject, query: string): ng.IPromise<any> {\r\n\t\tlet projectName = undefined;\r\n\r\n\t\tif (selectedOption && selectedOption.serverName) {\r\n\t\t\tprojectName = selectedOption.serverName !== \"All\" ? selectedOption.serverName : undefined;\r\n\t\t}\r\n\r\n\t\treturn this.metadataService.getIdoCollectionList(projectName, query, this.pageNo);\r\n\t}\r\n\r\n\tpublic showOperationDetails(operation: IdoCollection): void {\r\n\t\tconst openDialog = (properties: IdoProperty[]) => {\r\n\t\t\tconst options: IDialogOptions<ILocalIdoParameter> = {\r\n\t\t\t\ttitle: `IDO details`,\r\n\t\t\t\tcssClass: \"operation-details\",\r\n\t\t\t\ttemplate: require(\"./operation-details.html\"),\r\n\t\t\t\tbuttons: [{\r\n\t\t\t\t\ttext: \"Close\",\r\n\t\t\t\t\tclick: (event: Event, modal: IDialog<void>) => modal.close\r\n\t\t\t\t}],\r\n\t\t\t\tid: \"dataservice-search-wizard\",\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\toperation,\r\n\t\t\t\t\tproperties\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis.$scope.eirDialog.hide();\r\n\t\t\tthis.dialogService.show(options)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tthis.$scope.eirDialog.show();\r\n\t\t\t\t});\r\n\t\t};\r\n\r\n\t\tconst cachedOperationProperties: IdoProperty[] =\r\n\t\t\tthis.cacheObject.get(operation.collectionName);\r\n\r\n\t\tif (cachedOperationProperties) {\r\n\t\t\topenDialog(cachedOperationProperties);\r\n\t\t} else {\r\n\t\t\tthis.isBusy = true;\r\n\t\t\tthis.metadataService.getIdoProperties(operation.collectionName)\r\n\t\t\t\t.then(properties => {\r\n\t\t\t\t\tthis.cacheObject.put(operation.collectionName, properties);\r\n\t\t\t\t\topenDialog(properties);\r\n\t\t\t\t})\r\n\t\t\t\t.finally(() => this.isBusy = false);\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tpublic runCreateNewWizard(operation: IdoCollection): void {\r\n\t\tconst openDialog = (properties: IdoProperty[]) => {\r\n\t\t\tconst options: IDialogOptions<ILocalIdoParameter> = {\r\n\t\t\t\ttitle: \"Create Data Service\",\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\toperation,\r\n\t\t\t\t\tproperties\r\n\t\t\t\t},\r\n\t\t\t\ttemplate: \"<eir-wizard ng-controller='eirLocalIdoDataserviceWizardCtrl as wizardCtrl'></eir-wizard>\",\r\n\t\t\t\tcssClass: \"wizard-dialog large\",\r\n\t\t\t\tid: \"datasource-wizard\"\r\n\t\t\t};\r\n\r\n\t\t\tthis.$scope.eirDialog.hide();\r\n\t\t\tthis.dialogService\r\n\t\t\t\t.show<ILocalIdoParameter, IJsonDatasource>(options)\r\n\t\t\t\t.then(result => {\r\n\t\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\tthis.$scope.eirDialog.close(result);\r\n\t\t\t\t\t} else { // cancel\r\n\t\t\t\t\t\tthis.$scope.eirDialog.show();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t};\r\n\r\n\t\tconst properties: IdoProperty[] = this.cacheObject.get(operation.collectionName);\r\n\t\tif (properties) {\r\n\t\t\topenDialog(properties);\r\n\t\t} else {\r\n\t\t\tthis.isBusy = true;\r\n\t\t\tthis.metadataService.getIdoProperties(operation.collectionName)\r\n\t\t\t\t.then(properties => {\r\n\t\t\t\t\tthis.cacheObject.put(operation.collectionName, properties);\r\n\t\t\t\t\topenDialog(properties);\r\n\t\t\t\t})\r\n\t\t\t\t.catch((errorResponse) => {\r\n\t\t\t\t\tthis.showError(errorResponse);\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.isBusy = false;\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic showError(error: IErrorResponse): void {\r\n\t\tconsole.error(error);\r\n\t}\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.controller(\"eirLocalIdoSearchCtrl\", LocalIdoSearchCtrl);\r\n\t}\r\n}\r\n","// Module\nvar code = \" <div class=row ng-controller=\\\"eirLocalIdoOperationDetails as $ctrl\\\"> <div class=\\\"columns operation-details\\\"> <h1>{{$ctrl.operation.collectionName}}</h1> <p>{{$ctrl.operation.collectionDesc || 'This IDO has no detailed description'}}</p> <h2 class=fieldset-title>Input</h2> <div class=\\\"row operation-details-grid\\\"> <div xi-datagrid=$ctrl.parameterDatagridOptions></div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport isNil from \"lodash-es/isNil\";\r\nimport { Config, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport { IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IErrorResponse } from \"../../../common/error-response\";\r\nimport { ConflictResolutonService } from \"../../../common/services/conflict-resolution-service\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult,\r\n\tIMessageDialogOptions, StandardDialogButtons\r\n} from \"../../../common/services/dialog-service\";\r\nimport { RepositoryService } from \"../repository-service\";\r\nimport { RepositoryTab } from \"../repository-tab-ctrl\";\r\n\r\nexport class CompositeTabCtrl extends RepositoryTab {\r\n\tpublic anySelectedDataItem: boolean = false;\r\n\tpublic datagridOptions: IDataGridOptions<IJsonCompositeComponent>;\r\n\tpublic selectedDataItems: IJsonCompositeComponent[] = [];\r\n\r\n\tprotected datagridId: string = \"composite-grid\";\r\n\r\n\tprivate importActionTitle: string = \"Import Composite Components\";\r\n\r\n\tprivate dataset: IJsonCompositeComponent[];\r\n\tprivate set Dataset(value: IJsonCompositeComponent[]) {\r\n\t\tthis.dataset = value;\r\n\t\tthis.saveToCache(this.CACHE_KEY, value);\r\n\t}\r\n\tprivate readonly CACHE_KEY = \"compositeComponents\";\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tInjectNames.REPOSITORY_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.CONFLICT_RESOLUTION_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$cacheFactory: ng.ICacheFactoryService,\r\n\t\trepositoryService: RepositoryService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate conflictResolutionService: ConflictResolutonService\r\n\t) {\r\n\t\tsuper($scope, $element, $cacheFactory, repositoryService);\r\n\t}\r\n\r\n\tprotected initDatagridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tthis.dataset = [];\r\n\r\n\t\tcolumns.push({\r\n\t\t\tid: \"selectionCheckbox\",\r\n\t\t\tsortable: false,\r\n\t\t\tresizable: false,\r\n\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\talign: \"center\"\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"displayName\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"manifest.displayName\",\r\n\t\t\tsortable: true,\r\n\t\t\twidth: \"350px\",\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"author\",\r\n\t\t\tname: \"Author\",\r\n\t\t\tfield: \"manifest.authorDisplayName\",\r\n\t\t\tsortable: true,\r\n\t\t\twidth: \"350px\",\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"date\",\r\n\t\t\tname: \"Created\",\r\n\t\t\tfield: \"manifest.creationDate\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Date\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"datasources\",\r\n\t\t\tname: \"Data Services\",\r\n\t\t\tfield: \"datasources.length\",\r\n\t\t\tsortable: true,\r\n\t\t\twidth: \"150px\",\r\n\t\t\tformatter: Soho.Formatters.Integer\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"interactions\",\r\n\t\t\tname: \"Interactions\",\r\n\t\t\tfield: \"interactions.length\",\r\n\t\t\twidth: \"150px\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Integer\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"expressions\",\r\n\t\t\tname: \"Expressions\",\r\n\t\t\tfield: \"expressions.length\",\r\n\t\t\twidth: \"150px\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Integer\r\n\t\t});\r\n\r\n\t\tthis.datagridOptions = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: SelectableEnum.Multiple,\r\n\t\t\tpaging: true,\r\n\t\t\tpagesize: 25,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Global Composite Components\",\r\n\t\t\t\tresults: true,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tadvancedFilter: true,\r\n\t\t\t\tactions: true,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true\r\n\t\t\t},\r\n\t\t\tenableTooltips: true\r\n\t\t};\r\n\t\tthis.loadCompositeComponents();\r\n\t}\r\n\r\n\tprivate loadCompositeComponents(): void {\r\n\t\tconst cachedDataset =\r\n\t\t\tthis.getFromCache<IJsonCompositeComponent[]>(this.CACHE_KEY);\r\n\r\n\t\tif (isNil(cachedDataset)) {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.repositoryService\r\n\t\t\t\t.loadCompositeComponents()\r\n\t\t\t\t.then((compositeComponents: IJsonCompositeComponent[]) => {\r\n\t\t\t\t\tthis.Dataset = this.datagridOptions.dataset = compositeComponents;\r\n\t\t\t\t}).catch((errorResponse) => {\r\n\t\t\t\t\tthis.datagridOptions.dataset = [];\r\n\t\t\t\t\tthis.dialogService.showError(\"Load Composite Components\", errorResponse.message);\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.datagridOptions.dataset = cachedDataset;\r\n\t\t\tthis.clearSelected();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate importComposites(compositeComponentsToImport: IJsonCompositeComponent[]): void {\r\n\t\t//let deferredResolutions = this.repositoryService.newDeferred<d.IResolutionResult<IJsonCompositeComponent>>();\r\n\t\tthis.conflictResolutionService.resolve(\r\n\t\t\tcompositeComponentsToImport,\r\n\t\t\tthis.datagridOptions.dataset,\r\n\t\t\t\"manifest.displayName\",\r\n\t\t\t\"Composite component\",\r\n\t\t\tConfig.MAX_COMPOSITES\r\n\t\t).then((conflictResolutionObject) => {\r\n\t\t\tconst compositesToAdd = conflictResolutionObject.toAdd;\r\n\t\t\tconst idsToDelete = conflictResolutionObject.toRemove\r\n\t\t\t\t.map(compositeToDelete => compositeToDelete.manifest.id);\r\n\r\n\t\t\tif (idsToDelete.length > 0) {\r\n\t\t\t\tthis.deleteComposites(idsToDelete)\r\n\t\t\t\t\t.then(() => this.addComposites(compositesToAdd))\r\n\t\t\t\t\t.catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\t\t// Deleting of the composites supposed to replace was unsuccessful\r\n\t\t\t\t\t\tconsole.warn(\"[CompositeTabCtrl] Could not replace, unable to remove old CompositeComponents\");\r\n\t\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\t\t\tthis.importActionTitle,\r\n\t\t\t\t\t\t\t\"Unable to replace old composites: <br \\>\" + errorResponse.message\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.addComposites(compositesToAdd);\r\n\t\t\t}\r\n\t\t}).catch(() => {\r\n\t\t\t// User cancel\r\n\t\t\tconsole.warn(\"[CompositeTabCtrl] Cancelled\");\r\n\t\t\tthis.loading = false;\r\n\t\t});\r\n\t\t//deferredResolutions.promise;\r\n\t}\r\n\r\n\tprivate addComposites(composites: IJsonCompositeComponent[]): void {\r\n\t\t// The server will generate new IDs\r\n\t\tthis.repositoryService.addCompositeComponents(composites)\r\n\t\t\t.then(addedCompositeComponents => {\r\n\t\t\t\tthis.conflictResolutionService.checkIfInvalidImportedItems<IJsonCompositeComponent>(\r\n\t\t\t\t\t\"composite(s)\",\r\n\t\t\t\t\taddedCompositeComponents\r\n\t\t\t\t).catch((errorDialogOptions) => this.dialogService.showMessage(errorDialogOptions));\r\n\t\t\t\tfor (const composite of addedCompositeComponents) {\r\n\t\t\t\t\tif (composite) {\r\n\t\t\t\t\t\tthis.datagridOptions.dataset.unshift(composite);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.Dataset = this.datagridOptions.dataset;\r\n\t\t\t\tthis.clearSelected();\r\n\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t// Network problems\r\n\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\tthis.importActionTitle,\r\n\t\t\t\t\t\"Unable to import composite components due to: \\n\" + errorResponse.message\r\n\t\t\t\t);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate validate(compositeComponentsToValidate: IJsonCompositeComponent[]): boolean {\r\n\t\t// TODO: validate\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic import(): void {\r\n\t\tconst options: IDialogOptions<any> = {\r\n\t\t\ttitle: this.importActionTitle,\r\n\t\t\ttemplate: require(\"../../../common/dialogs/import/import-dialog.html\"),\r\n\t\t};\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<FileList>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.loading = true;\r\n\t\t\t\tthis.repositoryService.readJsonFile<IJsonCompositeComponent[]>(result.value[0])\r\n\t\t\t\t\t.then((compositeComponentsToImport) => {\r\n\t\t\t\t\t\tif (this.validate(compositeComponentsToImport)) {\r\n\t\t\t\t\t\t\tthis.importComposites(compositeComponentsToImport);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.dialogService.showError(this.importActionTitle, \"Failed to validate CompositeComponents\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\t\t// Unable to read input file, probable JSON parse error\r\n\t\t\t\t\t\tconsole.warn(\"[CompositeTabCtrl] Could not read file\");\r\n\t\t\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\t\t\tthis.importActionTitle,\r\n\t\t\t\t\t\t\t\"Unable to read file due to: <br \\>\" + errorResponse.message\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}).finally(() => {\r\n\t\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic delete(): void {\r\n\t\tconst actionTitle = \"Delete Composite Components\";\r\n\t\tconst displayNames: string[] = [];\r\n\t\tconst idsToDelete: string[] = this.selectedDataItems.map(composite => {\r\n\t\t\tdisplayNames.push(composite.manifest.displayName);\r\n\t\t\treturn composite.manifest.id;\r\n\t\t});\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: actionTitle,\r\n\t\t\tmessage:\r\n\t\t\t\t`Are you sure you want to delete these ${displayNames.length}` +\r\n\t\t\t\t`Composite Components?<br \\> ${displayNames.join(\", \")}`,\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(options).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.loading = true;\r\n\t\t\t\tthis.deleteComposites(idsToDelete).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tthis.dialogService.showError(actionTitle, \"Unable to delete due to:<br \\>\" + errorResponse.message);\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.loading = false;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate deleteComposites(ids: string[]): ng.IPromise<void> {\r\n\t\treturn this.repositoryService.deleteCompositeComponents(ids).then(() => {\r\n\t\t\tthis.Dataset = this.datagridOptions.dataset = this.datagridOptions.dataset.filter((composite) => {\r\n\t\t\t\treturn !ids.some((deletedId) => {\r\n\t\t\t\t\treturn deletedId === composite.manifest.id;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tthis.clearSelected();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic export(): void {\r\n\t\tconst ids: string[] = this.selectedDataItems.map((composite) => {\r\n\t\t\treturn composite.manifest.id;\r\n\t\t});\r\n\t\tthis.repositoryService.exportCompositeComponents(ids);\r\n\t}\r\n\r\n}\r\n\r\nexport class CompositeTabComponent implements ng.IComponentOptions {\r\n\tpublic controller = CompositeTabCtrl;\r\n\tpublic controllerAs = \"eirCompositeTabCtrl\";\r\n\tpublic template = require(\"./composite-tab.html\");\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirCompositeTab\", new CompositeTabComponent());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=row xi-busy=eirCompositeTabCtrl.loading> <div class=\\\"twelve columns\\\"> <div class=toolbar role=toolbar id=toolbar-composite xi-toolbar='{\\\"maxVisibleButtons\\\": 4}'> <div class=title></div> <div class=buttonset> <div class=\\\"searchfield-wrapper toolbar-searchfield-wrapper\\\"> <label class=audible for=searchfield-composite>Keyword Search</label> <input id=searchfield-composite name=searchfield-composite class=searchfield data-options='{ \\\"collapsible\\\": true }'/> </div> <button class=btn type=button ng-disabled=!eirCompositeTabCtrl.anySelectedDataItem ng-click=eirCompositeTabCtrl.delete() xi-tooltip=\\\"'Delete Composite Component'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> <button class=btn type=button ng-click=eirCompositeTabCtrl.import() xi-tooltip=\\\"'Import Composite Component'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-import></use> </svg> <span>Import from File</span> </button> <button class=btn type=button ng-disabled=!eirCompositeTabCtrl.anySelectedDataItem ng-click=eirCompositeTabCtrl.export()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-export></use> </svg> <span>Export to File</span> </button> </div> </div> <div id=\\\"{{ eirCompositeTabCtrl.datagridId }}\\\" xi-datagrid=eirCompositeTabCtrl.datagridOptions></div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=step-one> <div class=field> <eir-input-field-component label-name=Name field-value=wizardCtrl.collection.name validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'max-length', value: 128},\\r\\n\\t\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\tvalidator: 'isValidName',\\r\\n\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\tvalidator: 'isUniqueName',\\r\\n\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: wizardCtrl.ErrorList\\r\\n\\t\\t\\t}\\\" on-component-change=wizardCtrl.notify($data) parent-announce=wizardCtrl.parentAnnounce /> </div> <div class=field> <eir-dropdown-field-component label-name=\\\"IDO Project\\\" field-value=wizardCtrl.collection.idoProject validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: wizardCtrl.ErrorList\\r\\n\\t\\t\\t}\\\" list-values=wizardCtrl.idoProjects> </eir-dropdown-field-component> </div> <div class=field> <eir-textarea-field-component label-name=Description field-value=wizardCtrl.collection.idoDescription validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'max-length', value: 2000}\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: wizardCtrl.ErrorList\\r\\n\\t\\t\\t}\\\"/> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=step-two> <div class=row> <div class=\\\"six columns\\\" ng-class=\\\"{ 'form-container': wizardCtrl.selectedProperty }\\\"> <div ng-if=wizardCtrl.selectedProperty> <eir-ido-property value=wizardCtrl.selectedProperty error-list=wizardCtrl.ErrorList show-help=wizardCtrl.openTypeHelp></eir-ido-property> </div> </div> <div class=\\\"six columns properties-container\\\"> <div class=\\\"toolbar no-actions-button\\\" id=toolbar-ido-properties role=toolbar xi-toolbar> <div class=title></div> <div class=buttonset> <button class=btn type=button ng-disabled=!wizardCtrl.isCurrentPropertyValid ng-click=wizardCtrl.add() xi-tooltip=wizardCtrl.addPropertyToolTip> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> </button> <button class=btn type=button ng-disabled=!wizardCtrl.selectedProperty ng-click=wizardCtrl.delete() xi-tooltip=\\\"'Delete Property'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> </button> <button class=btn type=button xi-tooltip=\\\"'Preview Properties'\\\" ng-click=wizardCtrl.preview()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-update-preview></use> </svg> </button> </div> </div> <div class=field> <div class=listview id=\\\"{{ wizardCtrl.listviewId }}\\\" xi-listview=wizardCtrl.listviewOptions></div> </div> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=step-three> <div class=row> <div class=field-short> <eir-input-field-component label-name=Name field-value=wizardCtrl.collection.name readonly=true></eir-input-field-component> </div> <div class=field-short> <eir-input-field-component label-name=\\\"IDO Project\\\" field-value=wizardCtrl.collection.idoProject readonly=true></eir-input-field-component> </div> <div class=field-short> <eir-textarea-field-component label-name=Description field-value=wizardCtrl.collection.idoDescription readonly=true /> </div> <div class=field-short> <ido-property-datagrid-component head-title=Properties dataset=wizardCtrl.collection.properties></ido-property-datagrid-component> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div id=IdoPreviewDialog ng-controller=\\\"eirPreviewCtrl as ctrl\\\"> <div class=row> <div class=field-short> <ido-property-datagrid-component head-title={{ctrl.headTitle}} dataset=ctrl.dataset include-default-properties=true></ido-property-datagrid-component> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()> Close </button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../../common/angular-constants\";\r\nimport { IDialogBaseScope } from \"../../../../../common/defines\";\r\nimport { CollectionProperty } from \"../../collection-data\";\r\n\r\nexport class PreviewCtrl {\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE\r\n\t];\r\n\r\n\tpublic dataset: CollectionProperty[];\r\n\r\n\tpublic headTitle =\r\n\t\t`Below is a preview of properties.\r\n\t\tKeep in note that it is including default properties which will be created together with this collection.`;\r\n\r\n\tpublic constructor(\r\n\t\tprivate scope: IDialogBaseScope<CollectionProperty[]>\r\n\t) {\r\n\t\tthis.dataset = scope.eirDialog.parameter;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.scope.eirDialog.close();\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirPreviewCtrl\", PreviewCtrl);\r\n\t}\r\n}\r\n","import { IValidationResult } from \"../../../../../common/shared-components/base/field-validation\";\r\nimport { CollectionProperty } from \"../../collection-data\";\r\nimport { IdoDataType } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { IdoValidator } from \"../ido-wizard-ctrl\";\r\nimport { Helper } from \"../../../../../common/helper\";\r\n\r\nexport class IdoPropertyCtrl implements ng.IController {\r\n\tpublic dataTypes = [\r\n\t\tIdoDataType.boolean,\r\n\t\tIdoDataType.date,\r\n\t\tIdoDataType.decimal,\r\n\t\tIdoDataType.file,\r\n\t\tIdoDataType.integer,\r\n\t\tIdoDataType.string\r\n\t];\r\n\r\n\t// Component Bindings\r\n\tpublic value: CollectionProperty;\r\n\tpublic errorList: any[] = [];\r\n\tpublic showHelp: () => void;\r\n\r\n\tpublic isValidPropertyName(\r\n\t\tvalue: string\r\n\t): IValidationResult {\r\n\t\treturn IdoValidator.isValidName(value);\r\n\t}\r\n\r\n\tpublic isValidNumber(\r\n\t\tvalue: string\r\n\t): IValidationResult {\r\n\t\treturn value.indexOf(\"0\") !== 0 ?\r\n\t\t\t{ status: true } :\r\n\t\t\t{ status: false, errorMessage: \"Cannot start with 0\" };\r\n\t}\r\n\r\n\tpublic isValidPropertyLength(\r\n\t\tvalue: string\r\n\t): IValidationResult {\r\n\t\tconst parsedValue = parseInt(value);\r\n\t\tconst validMaxLengthForPropertyLength = 4000;\r\n\r\n\t\treturn parsedValue <= validMaxLengthForPropertyLength ||\r\n\t\t\tHelper.isUndefinedEmpty(value) ||\r\n\t\t\tisNaN(parsedValue) ?\r\n\t\t\t{ status: true } :\r\n\t\t\t{ status: false, errorMessage: \"Cannot be larger than 4000\" };\r\n\t}\r\n\r\n\tprivate tempDecimalLength: string;\r\n\r\n\tpublic onChangeDataType(): void {\r\n\t\tthis.clearOptions();\r\n\r\n\t\tif (this.value.decimalLength) {\r\n\t\t\tthis.tempDecimalLength = this.value.decimalLength;\r\n\t\t}\r\n\r\n\t\tif (this.value.dataType === IdoDataType.decimal &&\r\n\t\t\tthis.tempDecimalLength\r\n\t\t) {\r\n\t\t\tthis.value.decimalLength = this.tempDecimalLength;\r\n\t\t}\r\n\r\n\t\tif (this.value.dataType !== IdoDataType.decimal) {\r\n\t\t\tdelete this.value.decimalLength;\r\n\t\t}\r\n\r\n\t\tif (this.value.dataType === IdoDataType.file) {\r\n\t\t\tthis.value.propertyLength = \"-1\";\r\n\t\t\tthis.clearPropertyError(\"Property Length\");\r\n\t\t}\r\n\r\n\t\tif (this.value.dataType === IdoDataType.boolean) {\r\n\t\t\tthis.value.propertyLength = \"1\";\r\n\t\t}\r\n\r\n\t\tthis.setSqlDataType(this.value);\r\n\t}\r\n\r\n\tpublic onPrimaryKeyChange(): void {\r\n\t\tif (this.value.primaryKey) {\r\n\t\t\tthis.value.required = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate clearOptions(): void {\r\n\t\tthis.value.propertyLength = \"\";\r\n\t\tthis.value.primaryKey = false;\r\n\t\tthis.value.required = false;\r\n\t\tthis.value.readonly = false;\r\n\t\tthis.value.decimalLength = \"\";\r\n\t}\r\n\r\n\tprivate clearPropertyError(propertyName: string): void {\r\n\t\tfor (let i = 0; i < this.errorList.length; i++) {\r\n\t\t\tif (this.errorList[i].field === propertyName) {\r\n\t\t\t\tthis.errorList.splice(i, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setSqlDataType(value: CollectionProperty): void {\r\n\t\tswitch (value.dataType) {\r\n\t\t\tcase IdoDataType.file:\r\n\t\t\t\tvalue.sqlDataType = \"varbinary\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase IdoDataType.boolean:\r\n\t\t\t\tvalue.sqlDataType = \"tinyint\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase IdoDataType.date:\r\n\t\t\t\tvalue.sqlDataType = \"datetime\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase IdoDataType.decimal:\r\n\t\t\t\tvalue.sqlDataType = \"decimal\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase IdoDataType.integer:\r\n\t\t\t\tvalue.sqlDataType = \"int\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase IdoDataType.string:\r\n\t\t\tdefault:\r\n\t\t\t\tvalue.sqlDataType = \"nvarchar\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class IdoPropertyComponent implements ng.IComponentOptions {\r\n\tpublic controller = IdoPropertyCtrl;\r\n\tpublic controllerAs = \"$ctrl\";\r\n\tpublic template = require(\"./ido-property-template.html\");\r\n\r\n\tpublic bindings = {\r\n\t\tvalue: \"<\",\r\n\t\terrorList: \"=\",\r\n\t\tshowHelp: \"<\"\r\n\t};\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirIdoProperty\", new IdoPropertyComponent());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=field> <eir-input-field-component id=\\\"{{ $ctrl.value.id }}\\\" label-name=Name field-value=$ctrl.value.name validation=\\\"{\\r\\n\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t{type: 'max-length', value: 128},\\r\\n\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\tvalidator: $ctrl.isValidPropertyName,\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t}\\r\\n\\t\\t\\t],\\r\\n\\t\\t\\terrorList: $ctrl.errorList\\r\\n\\t\\t}\\\"/> </div> <div class=field> <eir-dropdown-field-component id=\\\"{{ $ctrl.value.id }}\\\" label-name=\\\"Data Type\\\" field-value=$ctrl.value.dataType validation=\\\"{\\r\\n\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t],\\r\\n\\t\\t\\terrorList: $ctrl.errorList\\r\\n\\t\\t}\\\" list-values=$ctrl.dataTypes on-change=$ctrl.onChangeDataType()> </eir-dropdown-field-component> <button class=\\\"btn-icon show-type-help\\\" ng-click=$ctrl.showHelp() xi-tooltip=\\\"'Help'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-info></use> </svg> </button> </div> <div class=field> <eir-input-field-component id=\\\"{{ $ctrl.value.id }}\\\" label-name=\\\"Property Length\\\" field-value=$ctrl.value.propertyLength validation=\\\"{\\r\\n\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t{type: 'numeric-no-negative'},\\r\\n\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\tvalidator: $ctrl.isValidNumber,\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\tvalidator: $ctrl.isValidPropertyLength,\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t}\\r\\n\\t\\t\\t],\\r\\n\\t\\t\\terrorList: $ctrl.errorList\\r\\n\\t\\t}\\\" ng-class=\\\"{'disabled' : $ctrl.value.dataType === 'Date' || $ctrl.value.dataType === 'File' || $ctrl.value.dataType === 'Boolean'}\\\"/> </div> <div class=field> <eir-input-field-component id=\\\"{{ $ctrl.value.id }}\\\" ng-if=\\\"$ctrl.value.dataType === 'Decimal'\\\" label-name=\\\"Decimal Length\\\" field-value=$ctrl.value.decimalLength validation=\\\"{\\r\\n\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t{type: 'numeric-no-negative'},\\r\\n\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\tvalidator: $ctrl.isValidNumber,\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t}\\r\\n\\t\\t\\t],\\r\\n\\t\\t\\terrorList: $ctrl.errorList\\r\\n\\t\\t}\\\"/> </div> <div class=row> <span class=checkbox-group-label>Options:</span> <div class=field> <input type=checkbox class=checkbox id=primary-key ng-model=$ctrl.value.primaryKey ng-change=$ctrl.onPrimaryKeyChange() ng-disabled=\\\"$ctrl.value.dataType === 'File'\\\"/> <label for=primary-key class=checkbox-label>Primary Key</label> </div> <div class=field> <input type=checkbox class=checkbox id=required ng-model=$ctrl.value.required ng-disabled=$ctrl.value.primaryKey /> <label for=required class=checkbox-label>Required</label> </div> <div class=field> <input type=checkbox class=checkbox id=read-only ng-model=$ctrl.value.readonly /> <label for=read-only class=checkbox-label>Read Only</label> </div> </div>\";\n// Exports\nmodule.exports = code;","import { IdoProperties } from \"ng2/common/constants/common.constant\";\r\nimport { IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { Helper } from \"../../../../../common/helper\";\r\nimport { BaseDatagridComponent, BaseDatagridCtrl } from \"../../../../../common/shared-components/base-datagrid/base-datagrid-component\";\r\nimport { CustomFormatters } from \"../../../../../common/sohoxi/custom-formatters\";\r\nimport { CollectionProperty } from \"../../collection-data\";\r\n\r\nexport class IdoPropertyDatagridCtrl extends BaseDatagridCtrl<CollectionProperty> {\r\n\tpublic datagridOptions: IDataGridOptions<CollectionProperty>;\r\n\tpublic datasetToDisplay: CollectionProperty[];\r\n\r\n\t// bindings\r\n\tpublic dataset: CollectionProperty[];\r\n\tpublic includeDefaultProperties: boolean;\r\n\r\n\tpublic $onInit(): void {\r\n\t\tif (this.includeDefaultProperties) {\r\n\t\t\tthis.setIdoDefaultProperties();\r\n\t\t}\r\n\t\tthis.initDatagridOptions();\r\n\t}\r\n\r\n\tpublic initDatagridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\tid: \"name\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"name\",\r\n\t\t\t\twidth: \"25%\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"dataType\",\r\n\t\t\t\tname: \"Data Type\",\r\n\t\t\t\tfield: \"dataType\",\r\n\t\t\t\twidth: \"20%\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"propertyLength\",\r\n\t\t\t\tname: \"Length\",\r\n\t\t\t\tfield: \"propertyLength\",\r\n\t\t\t\twidth: \"15%\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tformatter: Soho.Formatters.Integer\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"primaryKey\",\r\n\t\t\t\tname: \"Primary Key\",\r\n\t\t\t\tfield: \"primaryKey\",\r\n\t\t\t\twidth: \"14%\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"primaryKey\")\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"required\",\r\n\t\t\t\tname: \"Required\",\r\n\t\t\t\tfield: \"required\",\r\n\t\t\t\twidth: \"13%\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"required\")\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"readonly\",\r\n\t\t\t\tname: \"Read Only\",\r\n\t\t\t\tfield: \"readonly\",\r\n\t\t\t\twidth: \"13%\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tformatter: CustomFormatters.RequiredFormatter(\"readonly\")\r\n\t\t\t}\r\n\t\t];\r\n\t\tthis.datagridOptions = {\r\n\t\t\tid: \"idoPropertyDatagrid\",\r\n\t\t\tcolumns,\r\n\t\t\tdataset: Helper.isUndefined(this.datasetToDisplay) ?\r\n\t\t\t\tthis.dataset : this.datasetToDisplay,\r\n\t\t\tisList: true\r\n\t\t};\r\n\t}\r\n\r\n\tprivate setIdoDefaultProperties(): void {\r\n\t\tconst defaultIdoProperties: CollectionProperty[] = [\r\n\t\t\t{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tname: \"CreateDate\",\r\n\t\t\t\tdataType: \"Date\",\r\n\t\t\t\trequired: false,\r\n\t\t\t\treadonly: true,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tname: \"CreatedBy\",\r\n\t\t\t\tdataType: \"String\",\r\n\t\t\t\tpropertyLength: \"128\",\r\n\t\t\t\trequired: false,\r\n\t\t\t\treadonly: true,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tname: \"InWorkflow\",\r\n\t\t\t\tdataType: \"Byte\",\r\n\t\t\t\trequired: false,\r\n\t\t\t\treadonly: false,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tname: \"NoteExistsFlag\",\r\n\t\t\t\tdataType: \"Byte\",\r\n\t\t\t\trequired: false,\r\n\t\t\t\treadonly: false,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tname: IdoProperties.RECORD_DATE,\r\n\t\t\t\tdataType: \"Date\",\r\n\t\t\t\trequired: false,\r\n\t\t\t\treadonly: true,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tname: IdoProperties.ROW_POINTER,\r\n\t\t\t\tdataType: \"GUID\",\r\n\t\t\t\trequired: false,\r\n\t\t\t\treadonly: true,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tname: \"UpdatedBy\",\r\n\t\t\t\tdataType: \"String\",\r\n\t\t\t\tpropertyLength: \"128\",\r\n\t\t\t\trequired: false,\r\n\t\t\t\treadonly: true,\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tthis.datasetToDisplay = this.dataset.concat(defaultIdoProperties);\r\n\t}\r\n\r\n\tconstructor($element: ng.IAugmentedJQuery) {\r\n\t\tsuper($element);\r\n\t}\r\n}\r\n\r\nexport class IdoPropertyDatagridComponent extends BaseDatagridComponent {\r\n\tpublic controller = IdoPropertyDatagridCtrl;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.bindings.includeDefaultProperties = \"<?\";\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\r\n\t\t\t\"idoPropertyDatagridComponent\",\r\n\t\t\tnew IdoPropertyDatagridComponent()\r\n\t\t);\r\n\t}\r\n}\r\n","import { IComponentRendered } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDatagridApi, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { DATAGRID_RENDERED } from \"../../sohoxi/component/datagrid-directive\";\r\nimport { IBaseDatagridComponentSettings, IBaseDatagridCtrlSettings } from \"./base-datagrid-settings\";\r\n\r\nexport abstract class BaseDatagridCtrl<T> implements IBaseDatagridCtrlSettings<T> {\r\n\tpublic abstract datagridOptions: IDataGridOptions<T>;\r\n\tpublic api: IDatagridApi;\r\n\r\n\t// bindings\r\n\tpublic dataset: T[];\r\n\tpublic headTitle?: string;\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.initDatagridOptions();\r\n\t}\r\n\r\n\tpublic $onChanges(onChangesObject: ng.IOnChangesObject): void {}\r\n\r\n\tpublic abstract initDatagridOptions(): void;\r\n\r\n\tpublic constructor($element: ng.IAugmentedJQuery) {\r\n\t\t$element.on(DATAGRID_RENDERED,\r\n\t\t\t(event, result: IComponentRendered) => {\r\n\t\t\t\tthis.api = result.api as IDatagridApi;\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic getDatagridApi(): IDatagridApi {\r\n\t\treturn this.api;\r\n\t}\r\n}\r\n\r\nexport abstract class BaseDatagridComponent implements IBaseDatagridComponentSettings {\r\n\tpublic abstract controller: string | ng.Injectable<ng.IControllerConstructor>;\r\n\tpublic template: string = require(\"./base-datagrid-template.html\");\r\n\tpublic bindings: IMap<string> = {\r\n\t\tdataset: \"<\",\r\n\t\theadTitle: \"@?\",\r\n\t};\r\n}\r\n","// Module\nvar code = \"<div class=component-base> <span class=label>{{ $ctrl.headTitle }}</span> <div xi-datagrid=$ctrl.datagridOptions></div> </div>\";\n// Exports\nmodule.exports = code;","import cloneDeep from \"lodash-es/cloneDeep\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { InjectNames, IdoDataType } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IDataGridColumn, IDataGridOptions, IDataGridRow } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IErrorResponse } from \"../../../common/error-response\";\r\nimport { Helper } from \"../../../common/helper\";\r\nimport { IToolbarOptions } from \"../../../common/model/sohoxi/sohoxi-toolbar.model\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult\r\n} from \"../../../common/services/dialog-service\";\r\nimport { CustomFormatters } from \"../../../common/sohoxi/custom-formatters\";\r\nimport { IdoCollection } from \"../../../components/services/local-ido-service\";\r\nimport { RepositoryService } from \"../repository-service\";\r\nimport { RepositoryTab } from \"../repository-tab-ctrl\";\r\nimport { CollectionData } from \"./collection-data\";\r\nimport { RepositoryHelper } from \"../repository-helper\";\r\n\r\nexport class IdoTabCtrl extends RepositoryTab {\r\n\tprotected datagridId: string = \"ido-grid\";\r\n\tprotected anySelectedDataItem: boolean = false;\r\n\tprotected selectedDataItems: IdoCollection[] = [];\r\n\tprotected datagridOptions: IDataGridOptions<IdoCollection>;\r\n\r\n\tpublic dataset: IdoCollection[];\r\n\tprivate readonly CACHE_KEY = \"ido-collections\";\r\n\tprivate set Dataset(value: IdoCollection[]) {\r\n\t\tthis.dataset = value;\r\n\t\tthis.saveToCache(this.CACHE_KEY, value);\r\n\t}\r\n\r\n\tpublic toolbarOptions: IToolbarOptions;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tInjectNames.REPOSITORY_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$cacheFactory: ng.ICacheFactoryService,\r\n\t\trepositoryService: RepositoryService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tsuper($scope, $element, $cacheFactory, repositoryService);\r\n\t}\r\n\r\n\tpublic $onInit(): void {\r\n\t\tsuper.$onInit();\r\n\t\tthis.toolbarOptions = {\r\n\t\t\trightAligned: true,\r\n\t\t\tmaxVisibleButtons: 5\r\n\t\t};\r\n\t}\r\n\r\n\tprotected initDatagridOptions(): void {\r\n\t\tconst locale = this.repositoryService.getLanguage();\r\n\t\tthis.dataset = [];\r\n\t\tconst columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\tid: \"selectionCheckbox\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\twidth: \"50px\",\r\n\t\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\t\talign: \"center\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"collectionName\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"collectionName\",\r\n\t\t\t\twidth: \"450px\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t// Uncomment when the CreateBy property in Mongoose does not say 'sa'\r\n\t\t\t// {\r\n\t\t\t// \tid: \"createdBy\",\r\n\t\t\t// \tname: \"Author\",\r\n\t\t\t// \tfield: \"createdBy\",\r\n\t\t\t// \twidth: \"150px\",\r\n\t\t\t// \tsortable: true,\r\n\t\t\t// \tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t// },\r\n\t\t\t{\r\n\t\t\t\tid: \"createDate\",\r\n\t\t\t\tname: \"Created\",\r\n\t\t\t\tfield: \"createDate\",\r\n\t\t\t\twidth: \"50px\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: CustomFormatters.Date(locale),\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"collectionDesc\",\r\n\t\t\t\tname: \"Description\",\r\n\t\t\t\tfield: \"collectionDesc\",\r\n\t\t\t\twidth: \"450px\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"serverName\",\r\n\t\t\t\tname: \"Project\",\r\n\t\t\t\tfield: \"serverName\",\r\n\t\t\t\twidth: \"150px\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"action\",\r\n\t\t\t\tname: \"Action\",\r\n\t\t\t\tfield: \"\",\r\n\t\t\t\twidth: \"50px\",\r\n\t\t\t\talign: \"center\",\r\n\t\t\t\tformatter: Soho.Formatters.Button,\r\n\t\t\t\tclick: (_, rowsSelected: IDataGridRow<IdoCollection>[]) => {\r\n\t\t\t\t\tconst item = rowsSelected[0].item;\r\n\t\t\t\t\tthis.repositoryService.getIdoProperties(item.collectionName)\r\n\t\t\t\t\t\t.then(properties => {\r\n\t\t\t\t\t\t\tconst collectionProperties = properties.map(item => {\r\n\t\t\t\t\t\t\t\tconst name = Helper.isUndefinedEmpty(item.columnName) ?\r\n\t\t\t\t\t\t\t\t\titem.propertyName :\r\n\t\t\t\t\t\t\t\t\titem.columnName;\r\n\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\tname,\r\n\t\t\t\t\t\t\t\t\tdataType: RepositoryHelper.getAppbuilderDataType(item.dataType),\r\n\t\t\t\t\t\t\t\t\tpropertyLength: item.dataLength,\r\n\t\t\t\t\t\t\t\t\tprimaryKey: item.isRequired,\r\n\t\t\t\t\t\t\t\t\trequired: item.isRequired,\r\n\t\t\t\t\t\t\t\t\treadonly: item.isReadOnly,\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthis.dialogService.show({\r\n\t\t\t\t\t\t\t\ttitle: \"Preview IDO Properties\",\r\n\t\t\t\t\t\t\t\ttemplate: require(\"./create/preview-dialog/table-template.html\"),\r\n\t\t\t\t\t\t\t\tparameter: collectionProperties,\r\n\t\t\t\t\t\t\t\tcssClass: \"wizard-dialog large\"\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\ttext: \"Show Table\",\r\n\t\t\t}\r\n\t\t];\r\n\t\tthis.datagridOptions = {\r\n\t\t\tcolumns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: SelectableEnum.Multiple,\r\n\t\t\tpaging: true,\r\n\t\t\tpagesize: 25,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"IDO Collections\",\r\n\t\t\t\tresults: true,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tadvancedFilter: true,\r\n\t\t\t\tactions: true,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true\r\n\t\t\t},\r\n\t\t\tenableTooltips: true\r\n\t\t};\r\n\t\tthis.loadIDOs();\r\n\t}\r\n\r\n\tprivate loadIDOs(): void {\r\n\t\tconst cachedDataset = this.getFromCache<IdoCollection[]>(\r\n\t\t\tthis.CACHE_KEY\r\n\t\t);\r\n\r\n\t\tif (Helper.isUndefined(cachedDataset)) {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.repositoryService.getIDOs().then(idoCollections => {\r\n\t\t\t\tthis.Dataset = this.datagridOptions.dataset = idoCollections;\r\n\t\t\t}).catch((errorResponse) => {\r\n\t\t\t\tthis.datagridOptions.dataset = [];\r\n\t\t\t\tthis.dialogService.showError(\"Load IDOs\", errorResponse.message);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.loading = false;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.datagridOptions.dataset = cachedDataset;\r\n\t\t\tthis.clearSelected();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic create(): void {\r\n\t\tconst template =\r\n\t\t\t`<eir-wizard ng-controller=\"eirIdoWizardCtrl as wizardCtrl\"></eir-wizard>`;\r\n\r\n\t\tconst options: IDialogOptions<CollectionData> = {\r\n\t\t\ttitle: \"Table & IDO\",\r\n\t\t\ttemplate,\r\n\t\t\tcssClass: \"wizard-dialog large\",\r\n\t\t\tid: \"ido-wizard\"\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(options)\r\n\t\t\t.then((result: IDialogResult<CollectionData>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst collectionData = result.value;\r\n\t\t\t\t\tconst today = Helper.getFormattedDate(\"yyyymmdd HH:mm:ss.fff\");\r\n\r\n\t\t\t\t\tthis.Dataset = this.datagridOptions.dataset = [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcollectionName: collectionData.name,\r\n\t\t\t\t\t\t\tcollectionDesc: collectionData.idoDescription,\r\n\t\t\t\t\t\t\tserverName: collectionData.idoProject,\r\n\t\t\t\t\t\t\tcreatedBy: \"sa\", // for some reason regardless who created it Author will always be 'sa'\r\n\t\t\t\t\t\t\tcreateDate: today\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t...this.datagridOptions.dataset];\r\n\r\n\t\t\t\t\tthis.$scope.$applyAsync(() => {\r\n\t\t\t\t\t\tthis.datagridApi.updated();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate removeDeleted(idoNames: string[]): void {\r\n\t\tlet newDataset = cloneDeep(this.dataset);\r\n\t\tidoNames.forEach(name => {\r\n\t\t\tnewDataset = newDataset.filter(ido => {\r\n\t\t\t\treturn ido.collectionName !== name;\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.Dataset = newDataset;\r\n\t\tthis.datagridOptions.dataset = newDataset;\r\n\t\tthis.clearSelected();\r\n\t}\r\n\r\n\tpublic delete(): void {\r\n\t\tconst idoNames = this.selectedDataItems.map(ido => ido.collectionName);\r\n\t\tconst namesString = idoNames.join(\", \\n\");\r\n\t\tthis.dialogService.showYesNo(\r\n\t\t\t\"Warning\",\r\n\t\t\t`Are you sure that you want to delete the following IDOs with its associated SQL Tables? \\n ${namesString}`,\r\n\t\t\t\"warning-text\")\r\n\t\t\t.then(result => {\r\n\t\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\t\tthis.repositoryService.deleteIDOs(idoNames).then((success: boolean) => {\r\n\t\t\t\t\t\tif (success) {\r\n\t\t\t\t\t\t\tthis.removeDeleted(idoNames);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).catch((response: IErrorResponse) => {\r\n\t\t\t\t\t\tthis.dialogService.showError(\r\n\t\t\t\t\t\t\t\"Error\",\r\n\t\t\t\t\t\t\t`Failed to delete ${response.failedItems[0]} \\n` +\r\n\t\t\t\t\t\t\tresponse.message\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tif (response.successfulItems.length > 0) {\r\n\t\t\t\t\t\t\tthis.removeDeleted(response.successfulItems);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic import(): void {\r\n\t\tthrow new Error(\"Method not implemented.\");\r\n\t}\r\n}\r\n\r\nexport class IdoTabComponent implements ng.IComponentOptions {\r\n\tpublic controller = IdoTabCtrl;\r\n\tpublic controllerAs = \"ctrl\";\r\n\tpublic template = require(\"./ido-tab.html\");\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirIdoTab\", new IdoTabComponent());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div id=IdoPreviewDialog ng-controller=\\\"eirPreviewCtrl as ctrl\\\"> <div class=row> <div class=field-short> <ido-property-datagrid-component dataset=ctrl.dataset></ido-property-datagrid-component> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()> Close </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=row xi-busy=ctrl.loading> <div class=\\\"twelve columns\\\"> <div id=toolbar-ido class=toolbar role=toolbar xi-toolbar=ctrl.toolbarOptions> <div class=title></div> <div class=buttonset> <div class=\\\"searchfield-wrapper toolbar-searchfield-wrapper\\\"> <label class=audible for=toolbar-searchfield>Toolbar Searchfield</label> <input class=searchfield placeholder=keyword id=toolbar-searchfield name=toolbar-searchfield /> </div> <button class=btn type=button id=yolo ng-click=ctrl.create() xi-tooltip=\\\"'Create Table & IDO'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-magic-wand></use> </svg> <span>Create from Wizard</span> </button> <button class=btn type=button ng-click=ctrl.delete() ng-disabled=!ctrl.anySelectedDataItem xi-tooltip=\\\"'Delete IDO & Table'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> <button class=btn type=button ng-if=false ng-click=ctrl.import() xi-tooltip=\\\"'Import IDO Table'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-import></use> </svg> <span>Import from File</span> </button> </div> </div> <div id=\\\"{{ ctrl.datagridId }}\\\" xi-datagrid=ctrl.datagridOptions></div> </div> </div> \";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../../../common/angular-constants\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../../../common/services/dialog-service\";\r\nimport { IValidationResult, IValidatorError } from \"../../../../../../common/shared-components/base/field-validation\";\r\nimport { IOnComponentChangeNotification, NotifiableComponent } from \"../../../../../../common/shared-components/base/notifiable-component\";\r\n\r\nexport class AddNewColumnDialogCtrl extends NotifiableComponent {\r\n\tpublic dialog: IDialog<string[]>;\r\n\tpublic columnName: string = \"\";\r\n\tprivate columnNames: string[] = [];\r\n\tpublic errorList: IValidatorError[] = [];\r\n\tpublic get isNameInvalid(): boolean {\r\n\t\treturn this.errorList.length !== 0;\r\n\t}\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tscope: IDialogBaseScope<string[]>\r\n\t) {\r\n\t\tsuper();\r\n\t\tconst dialog: IDialog<string[]> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.errorList = [];\r\n\t\tthis.columnNames = this.dialog.parameter;\r\n\t\tthis.columnName = \"NewColumn\" + (this.columnNames.length + 1);\r\n\t}\r\n\r\n\tpublic saveForm(): void {\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: this.columnName\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic getValidation($data: IOnComponentChangeNotification): boolean | IValidationResult {\r\n\t\tconst foundName = this.columnNames.find(item => item === $data.value);\r\n\t\tif (foundName) {\r\n\t\t\treturn {\r\n\t\t\t\tstatus: false,\r\n\t\t\t\terrorMessage: `The column name '${$data.value}' is already in use.`\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tstatus: true\r\n\t\t};\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirAddNewColumnDialogCtrl\", AddNewColumnDialogCtrl);\r\n\t}\r\n}","import { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentRendered, SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport { IJsonDatasource, IJsonInlineListDatasource, IJsonInlineListParameter } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { IDatagridApi, IDatagridColumnArgs, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../../common/defines\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"../../../../../common/services/dialog-service\";\r\nimport { DATAGRID_RENDERED } from \"../../../../../common/sohoxi/component/datagrid-directive\";\r\nimport { IWizardStep, WizardCtrl } from \"../../../../editor/wizard/wizard-ctrl\";\r\nimport { SourceEnum } from \"../../create-from-wizard/select-source-ctrl\";\r\nimport { IDatasourceWizardParameter } from \"../datasource-wizard-ctrl\";\r\n\r\nimport { Helper } from \"../../../../../common/helper\";\r\nimport { FeatureSwitchService } from \"../../../../../common/services/feature-switch-service\";\r\nimport { DesignerService } from \"../../../../services/designer-service\";\r\n\r\nexport interface IInlineListDataserviceWizardScope extends IDialogBaseScope<IDatasourceWizardParameter> { }\r\n\r\nexport class InlineListDataserviceWizardCtrl extends WizardCtrl {\r\n\t$scope: IDialogBaseScope<void>;\r\n\tdatagridOptions: IDataGridOptions<any>;\r\n\tprivate columns: IExtendedDataGridColumn[] = [];\r\n\tprivate dataset: IListDataItem[] = [];\r\n\tselectedItem: any;\r\n\tdatasource: IJsonDatasource;\r\n\tprivate gridApi: IDatagridApi;\r\n\tsteps: IWizardStep[] = [\r\n\t\t{\r\n\t\t\tid: \"inline-list-properties.html\",\r\n\t\t\ttitle: \"Properties\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./inline-list-properties.html\")\r\n\t\t},\r\n\t\t{\r\n\t\t\tid: \"datasource-wizard-description.html\",\r\n\t\t\ttitle: \"Name &amp; Description\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"../datasource-wizard-description.html\")\r\n\t\t},\r\n\t\t{\r\n\t\t\tid: \"inline-dataservice-wizard-summary.html\",\r\n\t\t\ttitle: \"Summary\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./summary-page/dataservice-wizard-summary.html\")\r\n\t\t}\r\n\t];\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TEMPLATE_CACHE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.DESIGNER_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: IInlineListDataserviceWizardScope,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$templateCache: ng.ITemplateCacheService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate designerService: DesignerService\r\n\t) {\r\n\t\tsuper(\r\n\t\t\t$scope,\r\n\t\t\t$element,\r\n\t\t\t$templateCache,\r\n\t\t\tfeatureService\r\n\t\t);\r\n\t\tthis.initWizard();\r\n\t\tthis.nextDisabled = true;\r\n\t\tthis.backDisabled = false;\r\n\t\tconst eirDialog = $scope.eirDialog;\r\n\t\tif (eirDialog.parameter) {\r\n\t\t\tthis.datasource = eirDialog.parameter.datasource;\r\n\t\t}\r\n\t}\r\n\r\n\t$onInit(): void {\r\n\t\tthis.initDatagrid();\r\n\t\tthis.$element.on(DATAGRID_RENDERED, (_event: JQueryEventObject, result: IComponentRendered) => {\r\n\t\t\tthis.gridApi = result.api;\r\n\t\t\tthis.initDatagridEvents();\r\n\t\t});\r\n\t}\r\n\r\n\taddRow(): void {\r\n\t\tthis.dataset.push({\r\n\t\t\tid: Helper.generateUniqueId()\r\n\t\t});\r\n\t\tthis.datagridOptions.dataset = this.dataset;\r\n\t\tthis.gridApi.updated(this.datagridOptions);\r\n\t\tthis.updateNextDisabled();\r\n\t}\r\n\r\n\tdeleteRow(): void {\r\n\t\tthis.dataset = this.datagridOptions.dataset.filter(item => item.id !== this.selectedItem.id);\r\n\t\tthis.datagridOptions.dataset = this.dataset;\r\n\t\tthis.gridApi.deSelectAllRows();\r\n\t\tthis.gridApi.syncSelectedRowsIdx();\r\n\t\tthis.gridApi.updated(this.datagridOptions);\r\n\t\tthis.updateNextDisabled();\r\n\t}\r\n\r\n\taddColumn(): void {\r\n\t\tconst columnNames: string[] = [];\r\n\t\tthis.columns.forEach((column) => {\r\n\t\t\tcolumnNames.push(column.name);\r\n\t\t});\r\n\t\tconst options: IDialogOptions<string[]> = {\r\n\t\t\ttitle: \"Add New Column\",\r\n\t\t\tparameter: columnNames,\r\n\t\t\ttemplate: require(\"./add-new-column/add-new-column.html\")\r\n\t\t};\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tconst newColumn = {\r\n\t\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\t\tname: result.value,\r\n\t\t\t\t\tfield: \"\",\r\n\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\teditor: Soho.Editors.Input\r\n\t\t\t\t};\r\n\t\t\t\tthis.columns.push(newColumn);\r\n\t\t\t\tthis.updateColumns();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tdeleteColumn(): void {\r\n\t\tconst options: IDialogOptions<IExtendedDataGridColumn[]> = {\r\n\t\t\ttitle: \"Delete Column\",\r\n\t\t\tparameter: this.columns,\r\n\t\t\ttemplate: require(\"./delete-column/delete-column.html\")\r\n\t\t};\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<IExtendedDataGridColumn[]>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.columns = result.value;\r\n\t\t\t\tthis.updateColumns();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tback(): void {\r\n\t\tif (this.currentStep === this.steps[0]) {\r\n\t\t\tthis.$scope.eirDialog.close({\r\n\t\t\t\tbutton: DialogButtonType.Back\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tsuper.back();\r\n\t\t}\r\n\t}\r\n\r\n\tupdateBackDisabled(): void {\r\n\t\tthis.backDisabled = false;\r\n\t}\r\n\r\n\tprotected getFinishParameter(): IJsonDatasource {\r\n\t\tconst displayName = this.datasource.displayName;\r\n\t\tconst description = this.datasource.description;\r\n\t\tconst outputParams: IJsonInlineListParameter[] = [];\r\n\t\tthis.datagridOptions.columns.forEach((column) => {\r\n\t\t\toutputParams.push({ id: column.id, key: column.name, field: column.field });\r\n\t\t});\r\n\t\tconst datasource = {\r\n\t\t\t...this.datasource,\r\n\t\t\ttypedef: DatasourceTypeEnum.INLINE_LIST,\r\n\t\t\tsuite: SourceEnum.INLINE_LIST,\r\n\t\t\tdataset: this.datagridOptions.dataset,\r\n\t\t\tdisplayName: displayName,\r\n\t\t\tversion: 2,\r\n\t\t\toutputParameters: outputParams,\r\n\t\t\tdescription: description,\r\n\t\t} as IJsonInlineListDatasource;\r\n\t\treturn datasource;\r\n\t}\r\n\r\n\tprotected onChangeCurrentStep(): void {\r\n\t\tif (this.currentStep === this.steps[1]) {\r\n\t\t\tif (!this.datasource) {\r\n\t\t\t\tthis.datasource = { displayName: \"My Static Source\" };\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected initDatagridEvents(): void {\r\n\t\tthis.gridApi.element.on(\"selected\", () => {\r\n\t\t\tconst selectedRow = this.gridApi.selectedRows();\r\n\t\t\tthis.$scope.$evalAsync(() => {\r\n\t\t\t\tif (selectedRow.length > 0) {\r\n\t\t\t\t\tthis.selectedItem = selectedRow[0].data;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.selectedItem = null;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.gridApi.element.on(\"cellchange\", (_event: any, args: IDatagridColumnArgs<any>) => {\r\n\t\t\tthis.$scope.$evalAsync(() => {\r\n\t\t\t\tif (args.value !== args.oldValue) {\r\n\t\t\t\t\tconst selectedRow = this.datagridOptions.dataset.find(row => row.id === args.rowData.id);\r\n\t\t\t\t\tconst selectedColumn = this.columns.find(column => column.id === args.column.id);\r\n\t\t\t\t\tselectedRow[args.column.id] = args.value;\r\n\t\t\t\t\tselectedColumn.field = args.column.id;\r\n\t\t\t\t\tthis.gridApi.updated(this.datagridOptions);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateColumns(): void {\r\n\t\tif (this.columns.length > 0) {\r\n\t\t\tconst totalWidth = 100;\r\n\t\t\tconst newWidth = totalWidth / this.columns.length;\r\n\t\t\tfor (let i = 0; i < this.columns.length; i++) {\r\n\t\t\t\tthis.columns[i].width = newWidth + \"%\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.datagridOptions.columns = this.columns;\r\n\t\tthis.gridApi.updateColumns(this.columns);\r\n\t\tthis.updateNextDisabled();\r\n\t}\r\n\r\n\tprivate initDatagrid(): void {\r\n\t\tthis.initOnEdit();\r\n\t\tthis.datagridOptions = {\r\n\t\t\tid: \"inline-list-id\",\r\n\t\t\tcolumns: this.columns,\r\n\t\t\tdataset: this.dataset,\r\n\t\t\tisList: false,\r\n\t\t\teditable: true,\r\n\t\t\tsaveColumns: false,\r\n\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\trowHeight: \"short\",\r\n\t\t\tfrozenColumns: { // Could possible be removed on newer IDS Version\r\n\t\t\t\tleft: [],\r\n\t\t\t\tright: []\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tprivate initOnEdit(): void {\r\n\t\tif (this.datasource) {\r\n\t\t\tconst inlineDatasource = (this.datasource as IJsonInlineListDatasource);\r\n\t\t\tinlineDatasource.outputParameters.forEach((parameter) => {\r\n\t\t\t\tconst totalWidth = 100;\r\n\t\t\t\tconst width = totalWidth / inlineDatasource.outputParameters.length;\r\n\t\t\t\tconst newColumn = {\r\n\t\t\t\t\tid: parameter.id,\r\n\t\t\t\t\tname: parameter.key,\r\n\t\t\t\t\tfield: parameter.field,\r\n\t\t\t\t\twidth: width + \"%\",\r\n\t\t\t\t\teditor: Soho.Editors.Input\r\n\t\t\t\t};\r\n\t\t\t\tthis.columns.push(newColumn);\r\n\t\t\t});\r\n\t\t\tthis.dataset = inlineDatasource.dataset;\r\n\t\t\tthis.updateNextDisabled();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateNextDisabled(): void {\r\n\t\tif (this.columns.length === 0 || this.dataset.length === 0) {\r\n\t\t\tthis.nextDisabled = true;\r\n\t\t} else {\r\n\t\t\tthis.nextDisabled = false;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.controller(\r\n\t\t\t\"eirInlineListDataserviceWizardCtrl\",\r\n\t\t\tInlineListDataserviceWizardCtrl\r\n\t\t);\r\n\t}\r\n}","// Module\nvar code = \"<div class=dataservice-inline-list-wizard> <div class=container> <div class=grid-button-field> <div class=field> <div id=inlineListProperties xi-datagrid=wizardCtrl.datagridOptions> </div> </div> <div class=buttons> <button class=btn-secondary ng-click=wizardCtrl.addRow() ng-disabled=\\\"wizardCtrl.columns.length === 0\\\">Add Row</button> <button class=btn-secondary ng-click=wizardCtrl.deleteRow() ng-disabled=!wizardCtrl.selectedItem>Delete Row</button> <button class=btn-secondary ng-click=wizardCtrl.addColumn()>Add Column</button> <button class=btn-secondary ng-click=wizardCtrl.deleteColumn() ng-disabled=\\\"wizardCtrl.columns.length === 0\\\">Delete Column</button> </div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"container inline-list-summary\\\"> <div class=row> <h2 class=fieldset-title>Static List Summary</h2> <hr class=hr-field> </div> <div class=row> <div class=field> <span class=label>Name</span> <span class=\\\"data summary {{wizardCtrl.datasource.displayName.length > 0 ? '' : 'warning-field' }}\\\"> {{ wizardCtrl.datasource.displayName.length > 0 ? wizardCtrl.datasource.displayName : 'Empty' }} </span> </div> <div class=field ng-hide=\\\"!wizardCtrl.datasource.description || wizardCtrl.datasource.description.length === 0 \\\"> <span class=label>Description</span> <span class=\\\"data summary\\\">{{ wizardCtrl.datasource.description }}</span> </div> </div> <div class=row> <div class=field> <span class=label>Matrix</span> <eir-inline-list-dataservice-summary-datagrid-component head-title=\\\"Included Values\\\" grid-options=wizardCtrl.datagridOptions> </eir-inline-list-dataservice-summary-datagrid-component> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=add-column-dialog ng-controller=\\\"eirAddNewColumnDialogCtrl as ctrl\\\"> <div class=\\\"field form-name\\\"> <label>Column Name <span>*</span></label> <eir-input-field-component id=column-name field-value=ctrl.columnName field-name=columnName on-component-change=ctrl.notify($data) validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'not-empty'},\\r\\n\\t\\t\\t\\t\\t{type: 'no-space'},\\r\\n\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\tvalidator: 'isUniqueName',\\r\\n\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t}\\\"/> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-click=ctrl.saveForm() ng-disabled=ctrl.isNameInvalid> Add </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=delete-column-dialog ng-controller=\\\"eirDeleteColumnDialogCtrl as ctrl\\\"> <div class=\\\"field with-button\\\"> <label for=delete-column-select> Select Column </label> <select id=delete-column-select class=dropdown ng-model=ctrl.selectedColumn ng-options=\\\"column.name for column in ctrl.columns\\\" xi-drop-down> </select> <button class=btn-icon ng-click=ctrl.deleteColumn() ng-disabled=\\\"ctrl.columns.length == 1\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-delete></use> </svg> <span class=audible>Delete Column</span> </button> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Close</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../../../common/angular-constants\";\r\n\r\nimport { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../../../common/services/dialog-service\";\r\n\r\nexport class DeleteColumnDialogCtrl {\r\n\tpublic dialog: IDialog<IExtendedDataGridColumn[]>;\r\n\tpublic columns: IExtendedDataGridColumn[];\r\n\tpublic selectedColumn: IExtendedDataGridColumn;\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tscope: IDialogBaseScope<IExtendedDataGridColumn[]>\r\n\t) {\r\n\t\tconst dialog: IDialog<IExtendedDataGridColumn[]> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.columns = dialog.parameter;\r\n\t\tthis.selectedColumn = this.columns[0];\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tconst result: IDialogResult<IExtendedDataGridColumn[]> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: this.columns\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic deleteColumn(): void {\r\n\t\tthis.columns = this.columns.filter(item => item.id !== this.selectedColumn.id);\r\n\t\tthis.selectedColumn = this.columns[0];\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirDeleteColumnDialogCtrl\", DeleteColumnDialogCtrl);\r\n\t}\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { InlineListDataserviceSummaryDatagridCtrl } from \"./dataservice-wizard-summary-ctrl\";\r\n\r\nexport class InlineListDataserviceSummaryDatagridComponent implements ng.IComponentOptions {\r\n\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\theadTitle: \"@\",\r\n\t\t\tgridOptions: \"<\",\r\n\t\t\tsummaryDatagridOptions: \"<?\",\r\n\t\t};\r\n\r\n\t\tthis.controller = InlineListDataserviceSummaryDatagridCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./dataservice-summary-datagrid.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirInlineListDataserviceSummaryDatagridComponent\", new InlineListDataserviceSummaryDatagridComponent());\r\n\t}\r\n}\r\n","import { IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nexport class InlineListDataserviceSummaryDatagridCtrl {\r\n\t// component bindings\r\n\tpublic headTitle: string;\r\n\tpublic gridOptions: IDataGridOptions<any>;\r\n\tpublic summaryDatagridOptions: IDataGridOptions<any>;\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.initDatagridOptions();\r\n\t}\r\n\r\n\tprivate initDatagridOptions(): void {\r\n\t\tthis.summaryDatagridOptions = {\r\n\t\t\tcolumns: this.gridOptions.columns,\r\n\t\t\tisList: true,\r\n\t\t\tselectable: false,\r\n\t\t\tdataset: this.gridOptions.dataset,\r\n\t\t\trowHeight: \"short\"\r\n\t\t};\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=field> <span class=label>{{ ctrl.headTitle }}</span> <div xi-datagrid=ctrl.summaryDatagridOptions></div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { componentsModule } from \"../components/module\";\r\n\r\nimport { AppLauncher } from \"./app-launcher.component\";\r\nimport { RuntimeCanvasDirective } from \"./runtime-canvas-directive\";\r\nimport { RuntimeService } from \"./runtime-service\";\r\n\r\nexport const runtimeModule = angular.module(\"runtimeModule\", [\r\n\tcomponentsModule.name\r\n]);\r\n\r\nruntimeModule.config([\"$qProvider\", ($qProvider: any) => {\r\n\t$qProvider.errorOnUnhandledRejections(false);\r\n}]);\r\n\r\nAppLauncher.add(runtimeModule);\r\nRuntimeCanvasDirective.add(runtimeModule);\r\nRuntimeService.add(runtimeModule);\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { AppTypeEnum, InjectNames, Numbers } from \"ng2/common/constants/common.constant\";\r\nimport { ErrorResponse } from \"../common/error-response\";\r\n\r\nimport { RuntimeApp } from \"ng2/common/project/runtime-app\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { Helper } from \"../common/helper\";\r\nimport { DialogService } from \"../common/services/dialog-service\";\r\nimport { RuntimeService } from \"./runtime-service\";\r\n\r\nexport interface IAppLauncherStateParameter extends ng.ui.IStateParamsService {\r\n\tprojectId: string;\r\n\tappType: string;\r\n}\r\n\r\nexport class AppLauncher {\r\n\tshowMashup: boolean = false;\r\n\r\n\tprojectId: string;\r\n\tappType: AppTypeEnum;\r\n\r\n\tprivate windowResizeTimerPromise: ng.IPromise<void>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.RUNTIME_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate runtimeService: RuntimeService,\r\n\t\tprivate dialogService: DialogService\r\n\t) { }\r\n\r\n\t$onInit(): void {\r\n\t\tangular.element(window).bind(\"resize\", this.windowResizeHandler.bind(this));\r\n\r\n\t\tthis.loadProject(this.projectId).then((project: RuntimeApp) => {\r\n\t\t\tthis.showMashup = true;\r\n\t\t\tthis.initProjectUrlVariables(project);\r\n\t\t}).catch((error: ErrorResponse) => {\r\n\t\t\tconsole.error(\"[RuntimeDirective] Failed to load project with id: \" + this.projectId);\r\n\t\t\tthis.dialogService.showError(\"Load Project Error\", error.message);\r\n\t\t});\r\n\t}\r\n\r\n\t$onDestroy(): void {\r\n\t\tangular.element(window).unbind(\"resize\");\r\n\t}\r\n\r\n\tprivate initProjectUrlVariables(project: RuntimeApp): void {\r\n\t\tif (this.appType === AppTypeEnum.APPHUB) {\r\n\t\t\tconst runtimeManifest = project.getManifest();\r\n\t\t\tBackwardCompatible.tryUpdateUrlName(runtimeManifest);\r\n\t\t\tconst myList = Helper.getListByRegex(\"\\(SETVARVALUES((.*))\\)\", runtimeManifest.urlName);\r\n\t\t\tthis.runtimeService.setCurrentUrlValues(myList);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadProject(id: string): ng.IPromise<RuntimeApp> {\r\n\t\tlet promise: ng.IPromise<RuntimeApp>;\r\n\t\tswitch (this.appType) {\r\n\t\t\tcase AppTypeEnum.ADMIN_PREVIEW:\r\n\t\t\t\tpromise = this.runtimeService.loadPublishedProjectNoConstraint(id, this.getCanvasWidth());\r\n\t\t\t\tbreak;\r\n\t\t\tcase AppTypeEnum.RUNTIME:\r\n\t\t\tcase AppTypeEnum.APPHUB:\r\n\t\t\t\tpromise = this.runtimeService.loadPublishedProject(id, this.getCanvasWidth());\r\n\t\t\t\tbreak;\r\n\t\t\tcase AppTypeEnum.DESIGNER_PREVIEW:\r\n\t\t\t\tpromise = this.runtimeService.loadRuntimeProject(id, this.getCanvasWidth());\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconst deferredError = this.$q.defer<any>();\r\n\t\t\t\tdeferredError.reject({\r\n\t\t\t\t\tmessage: \"Error\",\r\n\t\t\t\t\tdetail: \"Invalid appType: \" + this.appType\r\n\t\t\t\t});\r\n\t\t\t\tpromise = deferredError.promise;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tprivate windowResizeHandler(): void {\r\n\t\tif (this.windowResizeTimerPromise) {\r\n\t\t\tthis.$timeout.cancel(this.windowResizeTimerPromise);\r\n\t\t}\r\n\t\tthis.windowResizeTimerPromise = this.$timeout(() => {\r\n\t\t\tthis.updateCurrentBoundary();\r\n\t\t}, Numbers.FIFTY);\r\n\t}\r\n\r\n\tprivate updateCurrentBoundary(): void {\r\n\t\tthis.runtimeService.updateCurrentBoundary(this.getCanvasWidth());\r\n\t}\r\n\r\n\tprivate getCanvasWidth(): number {\r\n\t\treturn window.innerWidth;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirAppLauncher\", {\r\n\t\t\ttemplate: \"<eir-runtime-canvas ng-if='eirRuntimeCtrl.showMashup'></eir-runtime-canvas>\",\r\n\t\t\tbindings: {\r\n\t\t\t\tappType: \"@\",\r\n\t\t\t\tprojectId: \"@\"\r\n\t\t\t},\r\n\t\t\tcontroller: AppLauncher,\r\n\t\t\tcontrollerAs: \"eirRuntimeCtrl\"\r\n\t\t});\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport { IComponentScope } from \"../common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\n\r\nimport { Debugger } from \"../common/debugger\";\r\nimport { Helper } from \"../common/helper\";\r\nimport { ApplicationParent } from \"../components/application-parent\";\r\nimport { FrameworkService } from \"../components/services/framework-service\";\r\nimport { RuntimeService } from \"./runtime-service\";\r\n\r\nclass RuntimeCanvasCtrl {\r\n\r\n\tpublic rootComponent: IJsonComponent;\r\n\tpublic parent: ApplicationParent;\r\n\tpublic context: IContext;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.ROOT_SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.RUNTIME_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $rootScope: ng.IRootScopeService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate runtimeService: RuntimeService\r\n\t) {\r\n\t\tconst project = runtimeService.getCurrentProject();\r\n\t\tthis.loadApplication(project.rootComponent);\r\n\t}\r\n\r\n\tpublic onComponentReady(componentInstance: ILayoutComponent): void {\r\n\t\tDebugger.log(this, \"[RuntimeDirective] Root component ready\");\r\n\r\n\t\tthis.parent.addChildInstance(componentInstance);\r\n\t\tthis.runtimeService.setCurrentRootComponentInstance(componentInstance);\r\n\r\n\t\tthis.runtimeService.runStartupInteractions();\r\n\t\tcomponentInstance.newBoundaryEntered(this.runtimeService.getCurrentBoundary().id);\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\r\n\t\tHelper.appIsReadyForSelenium();\r\n\t}\r\n\r\n\tprivate loadApplication(rootComponent: IJsonComponent): void {\r\n\t\tthis.parent = new ApplicationParent(\r\n\t\t\tApplicationParent.applicationParentDatabearer,\r\n\t\t\tApplicationParent.createSpoofedElement(this.$rootScope.$new() as IComponentScope),\r\n\t\t\tnull,\r\n\t\t\tthis.frameworkService);\r\n\t\tthis.context = {};\r\n\t\t// angular will compile when rootComponent is set\r\n\t\tthis.rootComponent = rootComponent;\r\n\t}\r\n}\r\n\r\nexport class RuntimeCanvasDirective implements ng.IDirective {\r\n\r\n\tpublic template = require(\"./runtime-canvas.html\");\r\n\tpublic controller = RuntimeCanvasCtrl;\r\n\tpublic controllerAs = \"eirRuntimeCanvasCtrl\";\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = () => new RuntimeCanvasDirective();\r\n\t\tm.directive(\"eirRuntimeCanvas\", directive);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<eir-titlebar></eir-titlebar> <section class=\\\"page-container mashupRootContainer runtimeMode\\\"> <eir-component-directive ng-if=eirRuntimeCanvasCtrl.rootComponent component=eirRuntimeCanvasCtrl.rootComponent context=eirRuntimeCanvasCtrl.context parent=eirRuntimeCanvasCtrl.parent component-ready=eirRuntimeCanvasCtrl.onComponentReady(componentInstance)></eir-component-directive> </section>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { InjectNames, } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonChart, IJsonChartDataset } from \"ng2/common/model/databearer/components/json-chart.model\";\r\n\r\nimport { IAvailableSourceField } from \"../../../../common/defines\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { Chart } from \"../../../../components/chart/chart\";\r\nimport { IEditorChart } from \"../../components/editor-chart\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\nimport { SettingsBase } from \"../settings-base\";\r\nimport { ChartDialogActionEnum } from \"./chart-settings\";\r\nimport { IChartDialogOptions, IChartDialogResult } from \"./chart-settings-dialog\";\r\n\r\nexport class ChartContentSettingsCtrl extends SettingsBase {\r\n\tprotected selectedComponent: IEditorChart;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\teditorService: EditorService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\t/**\r\n\t * Used in view to enable/disable dataset settings\r\n\t */\r\n\thasDatasource(): boolean {\r\n\t\treturn this.selectedComponent.datasource !== undefined;\r\n\t}\r\n\r\n\t/**\r\n\t *\tTriggered from view when click on add dataset\r\n\t\t*\r\n\t\t* @param {ChartContentTypeEnum} chartContentType\r\n\t\t*\r\n\t\t* @memberOf ChartSettingsCtrl\r\n\t\t*/\r\n\r\n\tonAddDialog(): void {\r\n\t\tthis.openDialog(ChartDialogActionEnum.ADD);\r\n\t}\r\n\r\n\t/**\r\n\t\t*\tTriggered from view when edit dataset.\r\n\t\t*\r\n\t\t* @param {IJsonChartDataset} chartContent\r\n\t\t* @param {ChartContentTypeEnum} chartContentType\r\n\t\t*\r\n\t\t* @memberOf ChartSettingsCtrl\r\n\t*/\r\n\tonEditDialog(chartContent: IJsonChartDataset): void {\r\n\t\tthis.openDialog(ChartDialogActionEnum.EDIT, chartContent);\r\n\t}\r\n\r\n\tprivate openDialog(\r\n\t\tdialogAction: ChartDialogActionEnum,\r\n\t\tchartContent?: IJsonChartDataset // undefined if onAddDialog, reference to databearer content if edit\r\n\t): void {\r\n\t\tconst emptyContent: IJsonChartDataset = {\r\n\t\t\tname: \"\",\r\n\t\t\tcategories: \"\",\r\n\t\t\tseries: \"\",\r\n\t\t};\r\n\r\n\t\tthis.selectedComponent.getLocalContextMetaData()\r\n\t\t\t.then((sourceFields: IAvailableSourceField[]) => {\r\n\t\t\t\tconst title = dialogAction.toString();\r\n\t\t\t\tconst parameter: IChartDialogOptions = {\r\n\t\t\t\t\tcontent: {\r\n\t\t\t\t\t\tchartContent: chartContent ? chartContent : emptyContent,\r\n\t\t\t\t\t\tsourceFields: sourceFields\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttype: dialogAction,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tconst dialogOptions: IDialogOptions<any> = {\r\n\t\t\t\t\ttitle: title,\r\n\t\t\t\t\tparameter: parameter,\r\n\t\t\t\t\ttemplate: require(\"./chart-content-dialog.html\"),\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.dialogService.show(dialogOptions)\r\n\t\t\t\t\t.then((dialogResult: IDialogResult<IChartDialogResult>) => {\r\n\t\t\t\t\t\tif (dialogResult.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\t\tthis.onDialogResult(dialogResult);\r\n\t\t\t\t\t\t\tthis.selectedComponent.updateChart();\r\n\t\t\t\t\t\t\tthis.editorService.saveCanvas();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate onDialogResult(dialogResult: IDialogResult<IChartDialogResult>): void {\r\n\t\tif (dialogResult) {\r\n\t\t\tswitch (dialogResult.value.dialogAction) {\r\n\t\t\t\tcase ChartDialogActionEnum.ADD:\r\n\t\t\t\t\tthis.add(dialogResult.value.content);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ChartDialogActionEnum.EDIT:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error(\"Unknown option\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate add(content: IJsonChartDataset): void {\r\n\t\tconst selectedDatabearer = this.selectedComponent.getDatabearer();\r\n\t\tselectedDatabearer.datasets.push(content);\r\n\t}\r\n\r\n\tdelete(content: IJsonChartDataset): void {\r\n\t\tconst contents: IJsonChartDataset[] = this.selectedComponent.getDatabearer().datasets;\r\n\r\n\t\tif (contents) {\r\n\t\t\tconst index = contents.findIndex(dataset => dataset.name === content.name);\r\n\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tcontents.splice(index, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.selectedComponent.updateChart();\r\n\t\tthis.editorService.saveCanvas();\r\n\t}\r\n\r\n\tgetDatasets(): IJsonChartDataset[] {\r\n\t\treturn this.selectedComponent.getDatabearer().datasets;\r\n\t}\r\n\r\n\tstatic create(id: string): IJsonChart {\r\n\t\tconst newChart = ComponentSettingsCtrl.create(id, Chart) as IJsonChart;\r\n\t\treturn newChart;\r\n\t}\r\n\r\n}\r\n\r\nexport class ChartContentSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./chart-content-settings.html\");\r\n\tscope = true;\r\n\tcontroller = ChartContentSettingsCtrl;\r\n\tcontrollerAs = \"eirChartContentSettingsCtrl\";\r\n}\r\n","export default \"../designer/images/createPage/01-thumb.png\";","export default \"../designer/images/createPage/010-thumb.png\";","export default \"../designer/images/createPage/011-thumb.png\";","export default \"../designer/images/createPage/012-thumb.png\";","export default \"../designer/images/createPage/013-thumb.png\";","export default \"../designer/images/createPage/03-thumb.png\";","export default \"../designer/images/createPage/04-thumb.png\";","export default \"../designer/images/createPage/05-thumb.png\";","export default \"../designer/images/createPage/06-thumb.png\";","export default \"../designer/images/createPage/07-thumb.png\";","export default \"../designer/images/createPage/08-thumb.png\";","export default \"../designer/images/createPage/09-thumb.png\";","// Module\nvar code = \"<div ng-controller=\\\"eirUrlVariableDialogCtrl as ctrl\\\"> <div class=\\\"new variable\\\"> <div class=\\\"field variable-name\\\"> <eir-input-field-component field-value=ctrl.newVariable field-name=variableName label-name=\\\"New URL Variable\\\" validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tvalidator: 'validate',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\terrorMessage: 'Name has to be unique'\\r\\n\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t\\t\\t{type: 'not-empty'}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.ErrorList\\r\\n\\t\\t\\t\\t}\\\" on-component-change=ctrl.notify($data) parent-announce=ctrl.sharedErrors /> </div> <div class=\\\"field variable-description\\\"> <label>Description</label> <input type=text class=input-short ng-model=ctrl.newDescription /> </div> <button class=\\\"btn-icon new-variable\\\" ng-click=ctrl.addVariable() ng-disabled=\\\"ctrl.hasError || ctrl.newVariable === ''\\\" xi-tooltip=\\\"'Add Variable'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-add></use> </svg> <span class=audible>Add</span> </button> </div> <div class=existing-variables> <label ng-if=ctrl.variables.length>Existing URL Variables</label> <div class=empty-message ng-if=!ctrl.variables.length> <label>This project has no URL variables</label> </div> <div class=variable ng-repeat=\\\"variable in ctrl.variables track by variable.id\\\"> <div class=\\\"field variable-name\\\"> <eir-input-field-component id={{variable.id}} field-value=variable.name field-name={{variable.id}} validation=\\\"{\\r\\n\\t\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tvalidator: 'validate',\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\terrorMessage: 'Name has to be unique'\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t\\t\\t\\t{type: 'not-empty'}\\r\\n\\t\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\t\\terrorList: ctrl.errorList,\\r\\n\\t\\t\\t\\t\\t}\\\" on-component-change=ctrl.notify($data) parent-announce=ctrl.parentAnnounce /> </div> <div class=\\\"field variable-description\\\"> <input type=text class=field ng-model=variable.description /> </div> <button class=btn-icon ng-click=ctrl.removeVariable(variable) xi-tooltip=\\\"'Remove Variable'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-delete></use> </svg> <span class=audible>Remove Variable</span> </button> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-click=ctrl.saveVariables() ng-disabled=ctrl.saveDisabled>Save</button> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=chart-dialog ng-controller=\\\"eirChartSettingsDialogCtrl as ctrl\\\"> <div class=field> <label for=chartSerieName class=required>Name</label> <input id=chartSerieName type=text class=required ng-model=ctrl.content.chartContent.name /> </div> <div class=field> <div class=info-row> <label class=required>Categories</label> <svg class=icon focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'Information to be presented'\\\"> <use xlink:href=#icon-info></use> </svg> </div> <select id=srckey class=\\\"dropdown dropdown-md\\\" ng-model=ctrl.selectedCategory ng-disabled=!ctrl.content.sourceFields ng-options=\\\"sourceField as sourceField.visibleName for sourceField in ctrl.content.sourceFields\\\" ng-change=ctrl.onCategoryChanged() xi-drop-down=ctrl.sourceFields></select> </div> <div class=field> <div class=info-row> <label class=required>Values</label> <svg class=icon focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'Data to be displayed'\\\"> <use xlink:href=#icon-info></use> </svg> </div> <select id=srckey class=\\\"dropdown dropdown-md\\\" ng-model=ctrl.selectedSeries ng-disabled=!ctrl.content.sourceFields ng-options=\\\"sourceField as sourceField.visibleName for sourceField in ctrl.content.sourceFields\\\" ng-change=ctrl.onSeriesChanged() xi-drop-down=ctrl.sourceFields></select> </div> <div class=\\\"modal-buttonset chart-modal\\\"> <button type=button class=btn-modal ng-click=ctrl.cancel()>Cancel</button> <button type=button class=\\\"btn-modal-primary no-validation\\\" ng-click=ctrl.save() ng-disabled=\\\"!ctrl.content.chartContent.name || !ctrl.selectedSeries || !ctrl.selectedCategory\\\"> Save </button> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=link-menu> <h2 class=content-title>Data Sets</h2> <ul class=content-list> <li ng-repeat=\\\"dataset in eirChartContentSettingsCtrl.getDatasets()\\\"> {{dataset.name}} <button class=btn-menu xi-popupmenu> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=popupmenu> <li ng-click=eirChartContentSettingsCtrl.onEditDialog(dataset)><a href=#>Properties</a></li> <li ng-click=eirChartContentSettingsCtrl.delete(dataset)><a>Delete</a></li> </ul> </li> </ul> <button type=button class=btn-tertiary xi-tooltip=\\\"'Create new data set'\\\" ng-click=eirChartContentSettingsCtrl.onAddDialog() ng-disabled=!eirChartContentSettingsCtrl.hasDatasource()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-add-grid-record></use> </svg> <span>Add</span> </button> </div> \";\n// Exports\nmodule.exports = code;","import type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { SettingsBase } from \"../settings-base\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { InjectNames, ChartTypeEnum, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { IEditorChart } from \"../../components/editor-chart\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\n\r\nexport class ChartStyleSettingsCtrl extends SettingsBase {\r\n\tpublic availableChartTypes = [\r\n\t\t{ name: \"Area\", value: ChartTypeEnum.Area },\r\n\t\t{ name: \"Bar\", value: ChartTypeEnum.Bar },\r\n\t\t{ name: \"Bar (Grouped)\", value: ChartTypeEnum.BarGrouped },\r\n\t\t{ name: \"Bar (Stacked)\", value: ChartTypeEnum.BarStacked },\r\n\t\t{ name: \"Column\", value: ChartTypeEnum.Column },\r\n\t\t{ name: \"Column (Grouped)\", value: ChartTypeEnum.ColumnGrouped },\r\n\t\t{ name: \"Column (Stacked)\", value: ChartTypeEnum.ColumnStacked },\r\n\t\t{ name: \"Donut\", value: ChartTypeEnum.Donut },\r\n\t\t{ name: \"Line\", value: ChartTypeEnum.Line },\r\n\t\t{ name: \"Pie\", value: ChartTypeEnum.Pie },\r\n\t\t{ name: \"Radar\", value: ChartTypeEnum.Radar },\r\n\t];\r\n\r\n\tprotected selectedComponent: IEditorChart;\r\n\tpublic chartType: ChartTypeEnum;\r\n\tpublic legendDisplay: boolean;\r\n\tpublic startupAnimationEnable: boolean;\r\n\tpublic showLabel: boolean;\r\n\tpublic animationCheckboxDisabled: boolean;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: ng.IScope,\r\n\t\teditorService: EditorService,\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tsuper.onComponentChanged(newComponent);\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getAnimationEnabled(): boolean {\r\n\t\tif (this.hasNoAnimation()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn this.selectedComponent.getBoundarySetting(SettingKeys.CHART_STARTUP_ANIMATION_ENABLE);\r\n\t}\r\n\r\n\tprivate hasNoAnimation(): boolean {\r\n\t\treturn this.chartType === ChartTypeEnum.Donut ||\r\n\t\tthis.chartType === ChartTypeEnum.Pie ||\r\n\t\tthis.chartType === ChartTypeEnum.Radar;\r\n\t}\r\n\r\n\tpublic refresh(): void {\r\n\t\tthis.chartType = this.selectedComponent.getBoundarySetting(SettingKeys.CHART_TYPE);\r\n\t\tthis.showLabel = this.selectedComponent.getBoundarySetting(SettingKeys.SHOW_LABEL);\r\n\t\tthis.legendDisplay = this.selectedComponent.getBoundarySetting(SettingKeys.CHART_LEGEND_DISPLAY);\r\n\t\tthis.startupAnimationEnable = this.getAnimationEnabled();\r\n\t\tthis.animationCheckboxDisabled = this.hasNoAnimation();\r\n\t}\r\n\r\n\tpublic onChangeValue(ref: string, newValue: any): void {\r\n\t\tconst settingsMeta: IComponentFieldSetting = { ref, boundarySetting: true };\r\n\t\tsuper.onChangeSetting(settingsMeta, newValue);\r\n\t\tthis.refresh();\r\n\t}\r\n}\r\n\r\nexport class ChartStyleSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./chart-style-settings.html\");\r\n\tscope = true;\r\n\tcontroller = ChartStyleSettingsCtrl;\r\n\tcontrollerAs = \"eirChartStyleSettingsCtrl\";\r\n}\r\n","// Module\nvar code = \"<div class=setting-category> <div class=\\\"accordion last-one-setting\\\" xi-control=accordion> <div class=accordion-header> <a class=title href=#> <span>Style</span> </a> </div> <div class=accordion-pane> <div class=accordion-content> <div class=row> <div class=field> <input type=checkbox class=checkbox name=show-header-option id=show-header-option ng-model=eirChartStyleSettingsCtrl.showLabel ng-change=\\\"eirChartStyleSettingsCtrl.onChangeValue('showLabel', eirChartStyleSettingsCtrl.showLabel)\\\"> <label for=show-header-option class=checkbox-label>Show Header</label> </div> <div class=field> <input type=checkbox class=checkbox name=show-legend-option id=show-legend-option ng-model=eirChartStyleSettingsCtrl.legendDisplay ng-change=\\\"eirChartStyleSettingsCtrl.onChangeValue('legendDisplay', eirChartStyleSettingsCtrl.legendDisplay)\\\"> <label for=show-legend-option class=checkbox-label>Show Legend</label> </div> <div class=field> <input type=checkbox class=checkbox name=show-animate-option id=show-animate-option ng-model=eirChartStyleSettingsCtrl.startupAnimationEnable ng-change=\\\"eirChartStyleSettingsCtrl.onChangeValue('startupAnimationEnable', eirChartStyleSettingsCtrl.startupAnimationEnable)\\\" ng-disabled=eirChartStyleSettingsCtrl.animationCheckboxDisabled> <label for=show-animate-option class=checkbox-label>Show Animation</label> </div> </div> <div class=\\\"field-short with-button\\\"> <label>Chart Type</label> <select class=\\\"dropdown dropdown-md\\\" ng-model=eirChartStyleSettingsCtrl.chartType ng-change=\\\"eirChartStyleSettingsCtrl.onChangeValue('chartType', eirChartStyleSettingsCtrl.chartType)\\\" ng-options=\\\"chartType.value as chartType.name for chartType in eirChartStyleSettingsCtrl.availableChartTypes\\\" xi-drop-down> </select> </div> </div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { DEFAULT_BOUNDARY, Numbers, RowHeight } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonDatagrid } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\n\r\nimport { Datagrid } from \"../../../../components/datagrid/datagrid\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { ISettingsClassInstance } from \"../../defines\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\nimport { DatagridContentSettingsDirective } from \"./datagrid-content-settings\";\r\n\r\nexport class DatagridSettings implements ISettingsClassInstance {\r\n\tprivate static instance: DatagridSettings = new DatagridSettings();\r\n\tprotected selectedComponent: IEditorComponent;\r\n\r\n\tpublic constructor() {\r\n\t\tif (DatagridSettings.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use DataGridSettings.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static getInstance(): DatagridSettings {\r\n\t\treturn DatagridSettings.instance;\r\n\t}\r\n\r\n\tpublic contentSettingsDirective: ng.IDirective = new DatagridContentSettingsDirective();\r\n\r\n\tpublic create(id: string): IJsonDatagrid {\r\n\t\tconst newDatagrid = ComponentSettingsCtrl.create(id, Datagrid) as IJsonDatagrid;\r\n\t\tnewDatagrid.boundarySettings[DEFAULT_BOUNDARY.id].rowHeight = RowHeight.MEDIUM;\r\n\t\tnewDatagrid.columns = [];\r\n\t\tnewDatagrid.usePaging = false;\r\n\r\n\t\tconst divideBy = 3.0;\r\n\t\tconst numberOfColumns = 3;\r\n\t\tconst width = (Numbers.HUNDRED / divideBy).toString() + \"%\";\r\n\t\tfor (let i = 1; i <= numberOfColumns; i++) {\r\n\t\t\tconst newId: string = id + \"Column\" + i;\r\n\t\t\tconst newName: string = \"Column \" + i;\r\n\t\t\tnewDatagrid.columns.push({\r\n\t\t\t\tid: newId,\r\n\t\t\t\tname: newName,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tresizable: true,\r\n\t\t\t\twidth: width,\r\n\t\t\t\ttextOverflow: \"ellipsis\",\r\n\t\t\t\teditable: false,\r\n\t\t\t\tsummarize: false,\r\n\t\t\t\talign: \"left\"\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn newDatagrid;\r\n\t}\r\n}\r\n","import { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { Debugger } from \"common/debugger\";\r\nimport type { IAvailableSourceField } from \"common/defines\";\r\nimport { UpsertDatagridColumnContentSettings } from \"editor/component-settings/upsert-datagrid-columns-content-settings\";\r\nimport type { IEditorDatagrid } from \"editor/components/editor-datagrid\";\r\n\r\nexport interface IEditColumnOptions {\r\n\tcolumn: IExtendedDataGridColumn;\r\n\tsourceFields: IAvailableSourceField[];\r\n\tcomponent: IEditorDatagrid;\r\n}\r\n\r\nexport interface IDatagridContentSettingsScope extends ng.IScope {\r\n\teirDatagridContentSettingsCtrl: DatagridContentSettingsCtrl;\r\n}\r\n\r\nexport class DatagridContentSettingsCtrl extends UpsertDatagridColumnContentSettings {\r\n\tprotected selectedComponent: IEditorDatagrid;\r\n\r\n\tprotected addTitle = \"Add Datagrid Column\";\r\n\tprotected editTitle = \"Edit Datagrid Column\";\r\n}\r\n\r\nexport class DatagridContentSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./datagrid-content-settings.html\");\r\n\tscope = true;\r\n\tcontroller = DatagridContentSettingsCtrl;\r\n\tcontrollerAs = \"eirDatagridContentSettingsCtrl\";\r\n\r\n\tlink(scope: IDatagridContentSettingsScope): void {\r\n\t\tscope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tDebugger.log(this, \"Destroy\");\r\n\t\t\tscope.eirDatagridContentSettingsCtrl.unsubscribers.forEach(unsubscribe => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div id=autoAddColumnsDialog ng-controller=\\\"eirAutoAddColumnCtrl as ctrl\\\"> <div class=row> <div class=field> <p>Which columns do you want to add from the data service metadata?</p> </div> <div class=field> <div id=metadata-grid class=datagrid-contained xi-datagrid=ctrl.datagridOptions> </div> </div> <div class=row> <div class=field> <input id=auto-formatter-checkbox type=checkbox class=checkbox ng-model=ctrl.autoFormatColumns> <label for=auto-formatter-checkbox>Auto Format Columns</label> </div> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.cancel()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.ok()>Add Columns</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div id=upsert-column ng-controller=\\\"eirUpsertColumn as ctrl\\\"> <div class=with-button> <label for=columnDisplayName class=required>Name</label> <input id=columnDisplayName type=text class=required ng-model=ctrl.column.name xi-autocomplete=ctrl.autocompleteOptions xi-lookup=ctrl.lookupOptions ng-model-options=\\\"{ debounce: 300 }\\\"/> <button class=btn-icon xi-tooltip=\\\"'Translations'\\\" ng-if=::ctrl.isFeatureTranslationEnabled() ng-click=ctrl.openTranslations()> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-translate></use> </svg> <span class=audible>Translations</span> </button> </div> <div id=accordion-column-field-source class=\\\"accordion panel\\\"> <div class=accordion-header> <a href=#><span>Source Field</span></a> </div> <div class=accordion-pane> <div class=accordion-content> <div class=field> <label>Value</label> <select id=upsert-column-dialog-source-field class=dropdown-md ng-model=ctrl.selectedSourceField ng-disabled=!ctrl.sourceFields ng-options=\\\"sourceField as sourceField.visibleName + (sourceField.currentValue ? '('+ sourceField.currentValue +')' : '') for sourceField in ctrl.sourceFields\\\" ng-change=ctrl.onFieldSelected() xi-drop-down> </select> </div> <div class=with-button ng-if=\\\"ctrl.selectedSourceField.type === '{Static Value}'\\\"> <input id=staticColumnName type=text class=required ng-model=ctrl.selectedSourceField.currentValue ng-change=ctrl.onFieldSelected() ng-model-options=\\\"{ debounce: 200 }\\\"/> <button class=btn-icon xi-tooltip=\\\"'Translations'\\\" ng-if=::ctrl.isFeatureTranslationEnabled() ng-click=ctrl.openTranslations()> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-translate></use> </svg> <span class=audible>Translations</span> </button> </div> </div> </div> </div> <div id=accordion-column-options class=\\\"accordion panel\\\"> <div class=accordion-header> <a href=#><span>Options</span></a> </div> <div class=accordion-pane> <div class=accordion-content> <div class=field> <label>Align</label> <select id=upsert-column-dialog-column-align class=dropdown-md ng-model=ctrl.column.align ng-options=\\\"align.value as align.name for align in ctrl.availableAlignment\\\" xi-drop-down> </select> </div> <div class=field ng-repeat=\\\"(option, value) in ::ctrl.getColumnOptions() track by $index\\\"> <input type=checkbox class=checkbox id=\\\"checkbox{{ $index }}\\\" ng-click=ctrl.onSelectColumnOption(option) ng-model=ctrl.column[option]> <label for=\\\"checkbox{{ $index }}\\\" class=\\\"checkbox-label capitalize\\\">{{ option }}</label> </div> </div> </div> </div> <div id=accordion-column-formatters class=\\\"accordion panel\\\" ng-show=ctrl.isDataGrid> <div class=accordion-header> <a href=#><span>Formatter</span></a> </div> <div class=accordion-pane> <div class=accordion-content> <div class=field> <label>Type</label> <select id=upsert-column-dialog-column-formatter class=dropdown-md ng-model=ctrl.selectedFormatter ng-options=\\\"formatter as formatter.name for formatter in ctrl.columnFormatters\\\" ng-change=ctrl.onSelectColumnFormatter() ng-disabled=ctrl.column.substitute xi-drop-down> </select> </div> <div class=field ng-if=\\\"ctrl.selectedFormatter.type === 1\\\"> <div class=data-service-label> <label>Data Service</label> <svg class=icon focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'Shows only data services with no input parameters.'\\\"> <use xlink:href=#icon-info></use> </svg> </div> <select id=upsert-column-dialog-column-list-source class=dropdown-md ng-model=ctrl.selectedListSource ng-options=\\\"dataservice as dataservice.displayName for dataservice in ctrl.availableDataservices track by dataservice.id\\\" ng-change=ctrl.setSelectedListSource() xi-drop-down> </select> </div> <div class=field ng-if=\\\"ctrl.selectedFormatter.type === 1\\\"> <label>Display Value</label> <select id=upsert-column-dialog-column-list-source class=dropdown-md ng-model=ctrl.selectedListOutput ng-options=\\\"parameter as parameter.key for parameter in ctrl.listSourceOutputParameters track by parameter.id\\\" ng-change=ctrl.setSelectedListOutput() xi-drop-down> </select> </div> <div ng-if=\\\"ctrl.selectedFormatter.type === 2\\\"> <div class=field> <label>Link Address</label> <input type=text ng-model=ctrl.column.hyperlinkOptions.value ng-model-options=\\\"{ debounce: 200 }\\\"/> <button class=btn-icon ng-click=ctrl.openLinkDialog() xi-tooltip=\\\"'Build Link'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-compose></use> </svg> </button> </div> <input type=checkbox class=checkbox id=checkboxDrillback ng-model=ctrl.column.hyperlinkOptions.isDrillback> <label for=checkboxDrillback class=checkbox-label>Use as Drillback</label> </div> </div> </div> </div> <div id=accordion-column-summary-row class=\\\"accordion panel\\\" ng-show=ctrl.isDataGrid> <div class=accordion-header> <a href=#><span>Summary Row</span></a> </div> <div class=accordion-pane> <div class=accordion-content> <div class=field> <input type=checkbox class=checkbox id=checkbox-summarize ng-click=ctrl.toggleSummaryRow() ng-model=ctrl.column.summarize> <label for=checkbox-summarize class=\\\"checkbox-label capitalize\\\">Enable</label> </div> <div class=field> <label for=columnSummaryText>Text</label> <input id=columnSummaryText type=text ng-model=ctrl.column.summaryText ng-model-options=\\\"{ debounce: 300 }\\\" ng-disabled=!ctrl.column.summarize ng-trim=false /> </div> <div class=field> <label>Text Placement</label> <fieldset class=radio-group> <div ng-repeat=\\\"placement in ctrl.availableTextPlacement track by placement.value\\\"> <input type=radio class=radio name=placement-option id={{placement.name}} value={{placement.value}} ng-model=ctrl.column.summaryTextPlacement ng-disabled=!ctrl.column.summarize> <label for={{placement.name}} class=radio-label>{{ placement.name }}</label> </div> </fieldset> </div> </div> </div> </div> <div id=accordion-column-substitute class=\\\"accordion panel\\\" ng-show=ctrl.isDataGrid> <div class=accordion-header> <a href=#><span>Substitute Value</span></a> </div> <div class=accordion-pane> <div class=accordion-content> <div class=field> <input type=checkbox class=checkbox id=checkbox-substitute ng-click=ctrl.toggleSubstitution() ng-model=ctrl.column.substitute> <label for=checkbox-substitute class=\\\"checkbox-label capitalize\\\">Enable</label> </div> <div class=field> <div class=data-service-label> <label>Data Service</label> <svg class=icon focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'Shows only data services with no input parameters.'\\\"> <use xlink:href=#icon-info></use> </svg> </div> <select id=upsert-column-dialog-column-substitute-source class=dropdown-md ng-model=ctrl.selectedSubstituteSource ng-options=\\\"dataservice as dataservice.displayName for dataservice in ctrl.availableDataservices track by dataservice.id\\\" ng-change=ctrl.setSelectedSubstitutionSource() ng-disabled=!ctrl.column.substitute xi-drop-down> </select> </div> <div class=field> <label>Source</label> <select id=upsert-column-dialog-column-substitute-from class=dropdown-md ng-model=ctrl.selectedFromSubstituteOutput ng-options=\\\"parameter as parameter.key for parameter in ctrl.substituteSourceOutputParameters track by parameter.id\\\" ng-change=ctrl.updateSubstitute() ng-disabled=!ctrl.column.substitute xi-drop-down> </select> </div> <div class=field> <label>Display Value</label> <select id=upsert-column-dialog-column-substitute-to class=dropdown-md ng-model=ctrl.selectedToSubstituteOutput ng-options=\\\"parameter as parameter.key for parameter in ctrl.substituteSourceOutputParameters track by parameter.id\\\" ng-change=ctrl.updateSubstitute() ng-disabled=!ctrl.column.substitute xi-drop-down> </select> </div> </div> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.cancel()>Cancel </button> <button type=button class=\\\"btn-modal-primary no-validation\\\" ng-click=ctrl.save() ng-disabled=!ctrl.validForm()> Save </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=link-menu> <h2 class=content-title>Columns</h2> <ul class=\\\"arrange list content-list\\\" data-arrange-handle=.handle xi-arrange=eirDatagridContentSettingsCtrl> <li ng-repeat=\\\"column in eirDatagridContentSettingsCtrl.Columns track by column.id\\\"> <span class=\\\"handle draggable\\\"> <svg class=\\\"icon icon-handle\\\" focusable=false aria-hidden=true role=presentation> <use href=#icon-drag></use> </svg> </span> {{column.value ? column.value : eirDatagridContentSettingsCtrl.htmlDecode(column.name)}} <button class=btn-menu xi-popupmenu> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=popupmenu> <li ng-click=eirDatagridContentSettingsCtrl.onEditColumn(column)> <a href=#>Properties</a> </li> <li ng-click=eirDatagridContentSettingsCtrl.deleteColumn(column)> <a>Delete</a> </li> </ul> </li> </ul> <button type=button class=btn-tertiary ng-click=eirDatagridContentSettingsCtrl.onAddColumn()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-add-grid-record></use> </svg> <span>Add Column</span> </button> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \" <div class=link-menu> <h2 class=content-title>Flexbox Layout</h2> <div class=flexbox-layout-container ng-if=\\\"eirFlexboxContentSettingsCtrl.flexChildrenAmount === 0\\\"> <button type=button class=btn-tertiary ng-click=eirFlexboxContentSettingsCtrl.addFirstRow()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-add-grid-row></use> </svg> <span>Split Into Rows</span> </button> <button type=button class=btn-tertiary ng-click=eirFlexboxContentSettingsCtrl.addFirstColumn()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-add-grid-record></use> </svg> <span>Split Into Columns</span> </button> </div> <div class=flexbox-layout-container ng-if=\\\"eirFlexboxContentSettingsCtrl.flexChildrenAmount > 0\\\"> <div class=flex-count-container> <span class=flex-text> Number of {{eirFlexboxContentSettingsCtrl.currentOrientation === 1 ? \\\"Columns\\\" : \\\"Rows\\\"}} </span> <button class=box-icon ng-click=eirFlexboxContentSettingsCtrl.removeChild() ng-disabled=\\\"eirFlexboxContentSettingsCtrl.flexChildrenAmount < 1\\\"> <svg focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-minus></use> </svg> </button> <div class=\\\"flex-count flex-text\\\">{{eirFlexboxContentSettingsCtrl.flexChildrenAmount}}</div> <button class=box-icon ng-click=eirFlexboxContentSettingsCtrl.addChild() ng-disabled=\\\"eirFlexboxContentSettingsCtrl.flexChildrenAmount === 12\\\"> <svg focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-add></use> </svg> </button> </div> </div> <div class=\\\"child-list flex-children\\\" ng-if=\\\"eirFlexboxContentSettingsCtrl.flexChildrenAmount > 0\\\"> <h2 class=content-title>{{eirFlexboxContentSettingsCtrl.currentOrientation === 1 ? \\\"Columns\\\" : \\\"Rows\\\"}}</h2> <div class=\\\"child-item visible-{{child.isVisible}}\\\" ng-repeat=\\\"child in eirFlexboxContentSettingsCtrl.selectedComponent.children track by child.getId()\\\" ng-mouseover=\\\"eirFlexboxContentSettingsCtrl.onMouseEnter(child, $event)\\\" ng-mouseleave=\\\"eirFlexboxContentSettingsCtrl.onMouseLeave(child, $event)\\\" ng-click=\\\"eirFlexboxContentSettingsCtrl.selectComponent(child, $event)\\\"> <label xi-tooltip=::eirFlexboxContentSettingsCtrl.htmlEncode(child.databearer.displayName)>{{child.databearer.displayName}}</label> <svg class=icon ng-if=!child.isVisible xi-tooltip=\\\"'Not Visible'\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-hidden></use> </svg> </div> </div> </div> <div class=child-list ng-if=\\\"eirFlexboxContentSettingsCtrl.selectedComponent.children.length > 0 && eirFlexboxContentSettingsCtrl.flexChildrenAmount === 0\\\"> <div class=accordion xi-control=accordion> <div class=accordion-header> <a class=title href=#> <span>Components</span> </a> </div> <div class=accordion-pane> <div class=accordion-content> <div class=\\\"child-item visible-{{child.isVisible}}\\\" ng-repeat=\\\"child in eirFlexboxContentSettingsCtrl.selectedComponent.children track by child.getId()\\\" ng-mouseover=\\\"eirFlexboxContentSettingsCtrl.onMouseEnter(child, $event)\\\" ng-mouseleave=\\\"eirFlexboxContentSettingsCtrl.onMouseLeave(child, $event)\\\" ng-click=\\\"eirFlexboxContentSettingsCtrl.selectComponent(child, $event)\\\"> <label xi-tooltip=::eirFlexboxContentSettingsCtrl.htmlEncode(child.databearer.displayName)>{{child.databearer.displayName}}</label> <svg class=icon ng-if=!child.isVisible xi-tooltip=\\\"'Not Visible'\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-hidden></use> </svg> </div> </div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport {\r\n\tInjectNames,\r\n\tSettingKeys\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nimport { EditorService } from \"editor/services/editor-service\";\r\nimport { SettingsBase } from \"editor/component-settings/settings-base\";\r\nimport { ListSettings } from \"editor/component-settings/list/list-settings\";\r\n\r\nexport interface IEditorList extends IEditorComponent {\r\n\trefresh(): void;\r\n\tforEachView(fn: (view: IJsonComponent) => void): void;\r\n\tforEachItemTemplate(fn: (view: IJsonComponent) => void): void;\r\n}\r\n\r\nexport class ListStyleSettingsCtrl extends SettingsBase {\r\n\r\n\tpublic get availableTemplates(): { id: string, displayName: string }[] {\r\n\t\treturn ListSettings.getInstance().availableTemplates;\r\n\t}\r\n\r\n\tprotected selectedComponent: IEditorList;\r\n\r\n\tpublic settingTemplate: { id: string, displayName: string };\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\t$scope: ng.IScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(currentBoundary: IBoundary): void {\r\n\t\tthis.updateTemplateComponent();\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tsuper.onComponentChanged(newComponent);\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.updateTemplateComponent();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateTemplateComponent(): void {\r\n\t\tconst templateComponent =\r\n\t\t\tthis.selectedComponent.getBoundarySetting<IJsonComponent>(SettingKeys.ITEM_TEMPLATE);\r\n\t\tconst availableTemplates = this.availableTemplates;\r\n\t\tfor (let i = 0; i < availableTemplates.length; i++) {\r\n\t\t\tif (templateComponent.id === availableTemplates[i].id) {\r\n\t\t\t\tthis.settingTemplate = availableTemplates[i];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onChangeTemplate(): void {\r\n\t\tconst template = ListSettings.getInstance().getTemplate(\r\n\t\t\tthis.settingTemplate.id,\r\n\t\t\tthis.selectedComponent.getId()\r\n\t\t);\r\n\t\tthis.selectedComponent.setBoundarySetting<IJsonComponent>(\r\n\t\t\tSettingKeys.ITEM_TEMPLATE,\r\n\t\t\ttemplate\r\n\t\t);\r\n\t\tif (this.selectedComponent.datasource) {\r\n\t\t\tthis.selectedComponent.datasource.getMetaData().then((metaData) => {\r\n\t\t\t\tthis.editorService.setDefaultBindings(template, metaData.outputFields);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.editorService.saveCanvas();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.editorService.saveCanvas();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class ListStyleSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./list-style-settings.html\");\r\n\tscope = true;\r\n\tcontroller = ListStyleSettingsCtrl;\r\n\tcontrollerAs = \"eirListStyleSettingsCtrl\";\r\n}\r\n","// Module\nvar code = \"<div class=setting-category> <div class=\\\"accordion last-one-setting\\\" xi-control=accordion> <div class=accordion-header> <a class=title href=#> <span>Template</span> </a> </div> <div class=accordion-pane> <div class=\\\"accordion-content setting-content\\\"> <div class=field-short> <label>Cell Template</label> <select id=DataListPanelSettingsSelected class=\\\"dropdown dropdown-md\\\" ng-model=eirListStyleSettingsCtrl.settingTemplate ng-change=eirListStyleSettingsCtrl.onChangeTemplate() ng-options=\\\"template.displayName for template in eirListStyleSettingsCtrl.availableTemplates track by template.id\\\" xi-drop-down></select> </div> </div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { DEFAULT_BOUNDARY, RowHeight } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport { ISettingsClassInstance } from \"../../defines\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\n\r\nimport { Lookup } from \"../../../../components/lookup/lookup\";\r\nimport { LookupContentSettingsDirective } from \"./lookup-content-settings\";\r\n\r\nexport class LookupSettings implements ISettingsClassInstance {\r\n\tprivate static instance = new LookupSettings();\r\n\r\n\tpublic static getInstance(): LookupSettings {\r\n\t\treturn LookupSettings.instance;\r\n\t}\r\n\r\n\tpublic constructor() {\r\n\t\tif (LookupSettings.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use LookupSettings.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic contentSettingsDirective: ng.IDirective = new LookupContentSettingsDirective();\r\n\r\n\tpublic create(id: string): IJsonLookup {\r\n\t\tconst lookupSettings = ComponentSettingsCtrl.create(id, Lookup) as IJsonLookup;\r\n\t\tlookupSettings.boundarySettings[DEFAULT_BOUNDARY.id].rowHeight = RowHeight.MEDIUM;\r\n\t\tlookupSettings.columns = [];\r\n\r\n\t\treturn lookupSettings;\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { Debugger } from \"../../../../common/debugger\";\r\nimport { DialogService } from \"../../../../common/services/dialog-service\";\r\nimport { Defines } from \"../../../../components/defines\";\r\nimport { Lookup } from \"../../../../components/lookup/lookup\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { UpsertDatagridColumnContentSettings } from \"../upsert-datagrid-columns-content-settings\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport type { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport type { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\n\r\nexport interface ILookupContentSettingsScope extends ng.IScope {\r\n\teirLookupContentSettingsCtrl: LookupContentSettingsCtrl;\r\n}\r\n\r\nexport class LookupContentSettingsCtrl extends UpsertDatagridColumnContentSettings {\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tprotected addTitle = \"Add Lookup Datagrid Column\";\r\n\tprotected editTitle = \"Edit Lookup Datagrid Column\";\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\teditorService: EditorService,\r\n\t\tdialogService: DialogService,\r\n\t\ttranslationManagementService: TranslationManagementService\r\n\t) {\r\n\t\tsuper(\r\n\t\t\t$scope,\r\n\t\t\teditorService,\r\n\t\t\tdialogService,\r\n\t\t\ttranslationManagementService\r\n\t\t);\r\n\r\n\t\tconst dataservice = this.selectedComponent.getDatasource();\r\n\t\tif (dataservice) {\r\n\t\t\tdataservice.getMetaData()\r\n\t\t\t\t.then(metadata => this.setLookupOutputOptions(metadata));\r\n\t\t}\r\n\t}\r\n\r\n\trefreshMetaSettings(dataservice: IDatasource): ng.IPromise<void> {\r\n\t\tconst newDeferred = this.editorService.getNewDeferred<void>();\r\n\t\tif (dataservice) {\r\n\t\t\tconst result = dataservice.getMetaData()\r\n\t\t\t\t.then(metadata => {\r\n\t\t\t\t\tthis.setLookupOutputOptions(metadata);\r\n\t\t\t\t\tthis.addColumns(metadata.outputFields, true);\r\n\t\t\t\t});\r\n\t\t\tnewDeferred.resolve(result);\r\n\t\t} else {\r\n\t\t\tnewDeferred.resolve(this.setLookupOutputOptions());\r\n\t\t}\r\n\r\n\t\treturn newDeferred.promise;\r\n\t}\r\n\r\n\tprotected refreshComponent(): void {\r\n\t\tsuper.refreshComponent();\r\n\t\tthis.updateLookupColumns();\r\n\t}\r\n\r\n\tprivate setLookupOutputOptions(metadata?: IMetaData): void {\r\n\t\tconst fieldSettings =\r\n\t\t\tDefines.allComponents[this.selectedComponent.getTypedef()].class.SETTING_FIELDS;\r\n\r\n\t\tconst lookupOutputSetting = fieldSettings.find(fieldSetting => {\r\n\t\t\treturn fieldSetting.title === Lookup.OUTPUT_SETTING_TITLE;\r\n\t\t}).settings[0] as IComponentFieldSetting;\r\n\r\n\t\tlookupOutputSetting.dataset = metadata ? metadata.outputFields\r\n\t\t\t.map(outputField => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tname: outputField.FLDS,\r\n\t\t\t\t\tvalue: outputField.FLNM\r\n\t\t\t\t};\r\n\t\t\t}) : [];\r\n\r\n\t\tthis.editorService.refreshSettingEvent.raise(lookupOutputSetting.ref);\r\n\r\n\t\tconst lookup = this.selectedComponent.getDatabearer() as IJsonLookup;\r\n\t\tif (!lookup.lookupOutputId && lookupOutputSetting.dataset.length > 0) {\r\n\t\t\tlookup.lookupOutputId = lookupOutputSetting.dataset[0].value;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateLookupColumns(): void {\r\n\t\tconst databearer = this.selectedComponent.getDatabearer();\r\n\t\tconst lookupApi = this.selectedComponent.getSohoXiApi();\r\n\r\n\t\tif (lookupApi) {\r\n\t\t\tconst settings = lookupApi.settings;\r\n\t\t\tsettings.options.columns = databearer.columns;\r\n\t\t\tlookupApi.updated(settings);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class LookupContentSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./lookup-content-settings.html\");\r\n\tscope = true;\r\n\tcontroller = LookupContentSettingsCtrl;\r\n\tcontrollerAs = \"eirLookupContentSettingsCtrl\";\r\n\r\n\tlink(scope: ILookupContentSettingsScope): void {\r\n\t\tscope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tDebugger.log(this, \"Destroy\");\r\n\t\t\tscope.eirLookupContentSettingsCtrl.unsubscribers.forEach(unsubscribe => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=link-menu> <h2 class=content-title>Columns</h2> <ul class=\\\"arrange list content-list\\\" data-arrange-handle=.handle xi-arrange=eirLookupContentSettingsCtrl> <li ng-repeat=\\\"column in eirLookupContentSettingsCtrl.Columns track by column.id\\\"> <span class=\\\"handle draggable\\\"> <svg class=\\\"icon icon-handle\\\" focusable=false aria-hidden=true role=presentation> <use href=#icon-drag></use> </svg> </span> {{column.value ? column.value : eirLookupContentSettingsCtrl.htmlDecode(column.name)}} <button class=btn-menu xi-popupmenu> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=popupmenu> <li ng-click=eirLookupContentSettingsCtrl.onEditColumn(column)> <a href=#>Properties</a> </li> <li ng-click=eirLookupContentSettingsCtrl.deleteColumn(column)> <a>Delete</a> </li> </ul> </li> </ul> <button type=button class=btn-tertiary ng-click=eirLookupContentSettingsCtrl.onAddColumn()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-add-grid-record></use> </svg> <span>Add Column</span> </button> </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { IJsonRadioButtons, IRadioButton } from \"../../../../common/model/component/radiobutton.model\";\r\nimport { ISettingsClassInstance } from \"../../defines\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\n\r\nimport { RadioButton } from \"../../../../components/radiobutton/radiobutton\";\r\nimport { RadioButtonContentSettingsDirective } from \"./radiobutton-content-settings\";\r\n\r\nexport class RadioButtonSettings implements ISettingsClassInstance {\r\n\tprivate static instance: RadioButtonSettings = new RadioButtonSettings();\r\n\r\n\tpublic static getInstance(): RadioButtonSettings {\r\n\t\treturn RadioButtonSettings.instance;\r\n\t}\r\n\r\n\tpublic constructor() {\r\n\t\tif (RadioButtonSettings.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use RadioButtonSettings.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic contentSettingsDirective: ng.IDirective = new RadioButtonContentSettingsDirective();\r\n\r\n\tpublic create(id: string): IJsonRadioButtons {\r\n\t\tconst newRadioButton = ComponentSettingsCtrl.create(id, RadioButton) as IJsonRadioButtons;\r\n\t\tconst numberOfButtons = 3;\r\n\t\tconst componentRadioButton: IRadioButton = {\r\n\t\t\tid: \"radiobuttonId\",\r\n\t\t\tname: \"radiobuttonNames\"\r\n\t\t};\r\n\r\n\t\tnewRadioButton.componentRadioButtons = [];\r\n\t\tfor (let i = 1; i <= numberOfButtons; i++) {\r\n\t\t\tconst newId: string = id + \"Button\" + i;\r\n\t\t\tcomponentRadioButton.id = newId;\r\n\t\t\tcomponentRadioButton.name = \"Radio \" + i;\r\n\r\n\t\t\tnewRadioButton.componentRadioButtons.push(angular.copy(componentRadioButton));\r\n\t\t}\r\n\t\treturn newRadioButton;\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { InjectNames, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IAvailableSourceField } from \"../../../../common/defines\";\r\nimport { IRadioButton } from \"../../../../common/model/component/radiobutton.model\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { IEditorRadioButtons } from \"../../components/editor-radiobutton\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { SettingsBase } from \"../settings-base\";\r\nimport { IEditRadioButtonDialogParameter } from \"./edit-radiobutton-dialog\";\r\nimport type { IArrangeEvent } from \"common/model/sohoxi/sohoxi.model\";\r\n\r\nimport { ComponentsHelper } from \"../../../../components/helper\";\r\nimport { EditorHelper } from \"../../helper\";\r\n\r\nexport class RadioButtonContentSettingsCtrl extends SettingsBase {\r\n\tprotected selectedComponent: IEditorRadioButtons;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\teditorService: EditorService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate translationManagementService: TranslationManagementService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tsuper.onComponentChanged(newComponent);\r\n\t}\r\n\r\n\tgetComponentRadioButton(): IRadioButton[] {\r\n\t\treturn this.selectedComponent.getDatabearer().componentRadioButtons;\r\n\t}\r\n\r\n\tonArrange(event: IArrangeEvent): void {\r\n\t\tconst componentRadioButtons = this.selectedComponent.getDatabearer().componentRadioButtons;\r\n\t\tEditorHelper.moveByIndex(componentRadioButtons, event.startIndex, event.endIndex);\r\n\t\tthis.save(false);\r\n\t}\r\n\r\n\taddRadioButton(): void {\r\n\t\tconst databearer = this.selectedComponent.getDatabearer();\r\n\r\n\t\tconst radiobuttonIds: string[] = databearer.componentRadioButtons.map((radioButton: any) => {\r\n\t\t\treturn radioButton.id;\r\n\t\t});\r\n\r\n\t\tconst index: number = ComponentsHelper.nextNumber(radiobuttonIds);\r\n\t\tconst newId: string = this.selectedComponent.getId() + \"Button\" + index;\r\n\t\tconst newName: string = \"Radio \" + index;\r\n\r\n\t\tdatabearer.componentRadioButtons.push({\r\n\t\t\tid: newId,\r\n\t\t\tname: newName\r\n\t\t});\r\n\r\n\t\tthis.translationManagementService.createGeneralLanguageComponent(databearer.id, newId, newName);\r\n\t\tthis.save();\r\n\t}\r\n\r\n\teditRadioButton(radioButton: IRadioButton): void {\r\n\t\tthis.selectedComponent.getContextMetaData().then((sourceFields: IAvailableSourceField[]) => {\r\n\t\t\tconst options: IDialogOptions<IEditRadioButtonDialogParameter> = {\r\n\t\t\t\ttitle: \"Edit Radio\",\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\tcomponent: this.selectedComponent,\r\n\t\t\t\t\tradio: angular.copy(radioButton)\r\n\t\t\t\t},\r\n\t\t\t\ttemplate: require(\"./edit-radiobutton-dialog.html\")\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<IRadioButton | string>) => {\r\n\t\t\t\tif (result && result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.updateRadioButton(result.value as IRadioButton);\r\n\t\t\t\t\t// TODO: use events for updating this MUPS-1654\r\n\t\t\t\t\tthis.selectedComponent.updateValuesWithTranslations();\r\n\t\t\t\t\tthis.save();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tdeleteRadioButton(deletedRadioButton: IRadioButton): void {\r\n\t\tconst databearer = this.selectedComponent.getDatabearer();\r\n\t\tconst radioButtons: IRadioButton[] = databearer.componentRadioButtons;\r\n\r\n\t\tconst index = radioButtons.indexOf(deletedRadioButton);\r\n\t\tradioButtons.splice(index, 1);\r\n\r\n\t\tif (this.selectedComponent.selectedRadioButtonId === deletedRadioButton.id) {\r\n\t\t\tthis.selectedComponent.setCurrentItem(radioButtons[0]);\r\n\t\t}\r\n\r\n\t\tthis.translationManagementService.removeTranslation(databearer.id, deletedRadioButton.id);\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tdisableDelete(): boolean {\r\n\t\tconst minimalRadioButtonCount = 2;\r\n\t\treturn this.selectedComponent.getDatabearer().componentRadioButtons.length === minimalRadioButtonCount;\r\n\t}\r\n\r\n\tprivate updateRadioButton(editedRadioButton: IRadioButton): void {\r\n\t\tconst selectedComponent = this.selectedComponent;\r\n\t\tconst radioButton = this.selectedComponent.getDatabearer().componentRadioButtons.find((radiobutton) => {\r\n\t\t\treturn editedRadioButton.id === radiobutton.id;\r\n\t\t});\r\n\t\tradioButton.field = editedRadioButton.field;\r\n\t\tif (selectedComponent.selectedRadioButtonId === editedRadioButton.id) {\r\n\t\t\tselectedComponent.currentItemValue = editedRadioButton.field;\r\n\t\t\tselectedComponent.currentItemName = editedRadioButton.name;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate save(saveTranslations = true): void {\r\n\t\tthis.editorService.saveCanvas();\r\n\t\tif (saveTranslations) {\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.TRANSLATIONS);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class RadioButtonContentSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./radiobutton-content-settings.html\");\r\n\tscope = true;\r\n\tcontroller = RadioButtonContentSettingsCtrl;\r\n\tcontrollerAs = \"eirRadioButtonContentSettingsCtrl\";\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirEditRadioButtonCtrl as ctrl\\\"> <div class=\\\"field with-button\\\"> <label for=duplicateName class=required>Name</label> <input id=duplicateName type=text class=required ng-model=ctrl.radioButton.name ng-change=ctrl.onChangeRadioButtonName() xi-autocomplete=ctrl.autocompleteOptions xi-lookup=ctrl.lookupOptions ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> <button class=btn-icon xi-tooltip=\\\"'Translations'\\\" ng-if=::ctrl.isFeatureTranslationEnabled() ng-click=ctrl.openTranslations()> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-translate></use> </svg> <span class=audible>Translations</span> </button> </div> <div class=field> <label for=radio-button-value>Value</label> <input id=radio-button-value class=\\\"dropdown dropdown-md\\\" ng-model=ctrl.radioButton.field /> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.cancel()> Cancel </button> <button type=button class=\\\"btn-modal-primary no-validation\\\" ng-click=ctrl.save() ng-disabled=!ctrl.radioButton.name> Save </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=link-menu> <h2 class=content-title>Radio Buttons</h2> <ul class=\\\"arrange list content-list\\\" data-arrange-handle=.handle xi-arrange=eirRadioButtonContentSettingsCtrl> <li ng-repeat=\\\"radio in eirRadioButtonContentSettingsCtrl.getComponentRadioButton() track by radio.id\\\"> <span class=\\\"handle draggable\\\"> <svg class=\\\"icon icon-handle\\\" focusable=false aria-hidden=true role=presentation> <use href=#icon-drag></use> </svg> </span> {{radio.name}} <button class=btn-menu xi-popupmenu> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=popupmenu> <li ng-click=eirRadioButtonContentSettingsCtrl.editRadioButton(radio)> <a href=#>Properties</a> </li> <li ng-click=eirRadioButtonContentSettingsCtrl.deleteRadioButton(radio) ng-class=\\\"{'is-disabled': eirRadioButtonContentSettingsCtrl.disableDelete()}\\\"> <a>Delete</a> </li> </ul> </li> </ul> <button type=button class=btn-tertiary ng-click=eirRadioButtonContentSettingsCtrl.addRadioButton()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-add></use> </svg> <span>Add Radio Button</span> </button> </div> \";\n// Exports\nmodule.exports = code;","import { IJsonTabComponent, IJsonTabs } from \"../../../../common/model/component/tabs.model\";\r\nimport { Tabs } from \"../../../../components/tabs/tabs\";\r\nimport { IEditorTabs } from \"../../components/editor-tabs\";\r\nimport { ISettingsClassInstance } from \"../../defines\";\r\nimport { ComponentSettingsCtrl } from \"../component-settings\";\r\nimport { TabPanelSettings } from \"./tab-panel-settings\";\r\nimport { TabsContentSettingsDirective } from \"./tabs-content-settings\";\r\n\r\nexport class TabsSettings implements ISettingsClassInstance {\r\n\tstatic getInstance(): TabsSettings {\r\n\t\treturn TabsSettings.instance;\r\n\t}\r\n\tprivate static instance: TabsSettings = new TabsSettings();\r\n\tcontentSettingsDirective: ng.IDirective = new TabsContentSettingsDirective();\r\n\tprotected selectedComponent: IEditorTabs;\r\n\r\n\tconstructor() {\r\n\t\tif (TabsSettings.instance) {\r\n\t\t\tthrow new Error(\"Error: Instantiation failed: Use TabsSettings.getInstance() instead of new.\");\r\n\t\t}\r\n\t}\r\n\r\n\tcreate(id: string): IJsonTabs {\r\n\t\tconst newTabs = ComponentSettingsCtrl.create(id, Tabs) as IJsonTabs;\r\n\t\tconst numberOfTabs = 4;\r\n\t\t//Create each tab and a flexbox for every tab\r\n\t\tnewTabs.children = [];\r\n\t\tnewTabs.componentTabs = [];\r\n\t\tfor (let i = 1; i <= numberOfTabs; i++) {\r\n\t\t\tconst newId: string = id + \"Panel\" + i;\r\n\t\t\tconst componentTab: IJsonTabComponent = {\r\n\t\t\t\tid: newId,\r\n\t\t\t\tname: \"Tab \" + i\r\n\t\t\t};\r\n\t\t\tnewTabs.componentTabs.push(componentTab);\r\n\t\t\tnewTabs.children.push(TabPanelSettings.getInstance().create(newId, i));\r\n\t\t}\r\n\r\n\t\treturn newTabs;\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport type { IAvailableSourceField } from \"../../../../common/defines\";\r\nimport type { IJsonTabComponent } from \"../../../../common/model/component/tabs.model\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport type { IEditorFlexbox } from \"../../components/editor-flexbox\";\r\nimport type { IEditorTabs } from \"../../components/editor-tabs\";\r\nimport type { IInsertPoints } from \"../../defines\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nimport type { IEditTabDialogParameter } from \"./edit-tab-dialog\";\r\n\r\nimport { InjectNames, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IArrangeEvent } from \"common/model/sohoxi/sohoxi.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nexport class TabsContentSettingsCtrl extends SettingsBase {\r\n\tprotected selectedComponent: IEditorTabs;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\teditorService: EditorService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate translationManagementService: TranslationManagementService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tsuper.onComponentChanged(newComponent);\r\n\t}\r\n\r\n\tonArrange(event: IArrangeEvent): void {\r\n\t\tthis.selectedComponent.updateTabPosition(event);\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tgetComponentTabs(): IJsonTabComponent[] {\r\n\t\treturn this.selectedComponent.getDatabearer().componentTabs;\r\n\t}\r\n\r\n\topenTab(chosenTab: IJsonTabComponent): void {\r\n\t\tthis.selectedComponent.switchFocusTab(chosenTab);\r\n\t}\r\n\r\n\taddTab(): void {\r\n\t\tconst tabComponent = this.selectedComponent.addTab();\r\n\r\n\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\tthis.selectedComponent.getId(),\r\n\t\t\ttabComponent.id,\r\n\t\t\ttabComponent.name\r\n\t\t);\r\n\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tupdateTab(tab: IJsonTabComponent): void {\r\n\t\tthis.selectedComponent.getContextMetaData()\r\n\t\t\t.then((sourceFields: IAvailableSourceField[]) => {\r\n\t\t\t\tthis.openEditTabDialog(tab, sourceFields)\r\n\t\t\t\t\t.then((result: IDialogResult<IJsonTabComponent | string>) => {\r\n\t\t\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\t\tconst tabResult = result.value as IJsonTabComponent;\r\n\t\t\t\t\t\t\tthis.selectedComponent.updateTab(tab, tabResult);\r\n\t\t\t\t\t\t\tthis.selectedComponent.updateValuesWithTranslations();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (result.button !== DialogButtonType.Cancel) {\r\n\t\t\t\t\t\t\tthis.save();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tdeleteTab(tab: IJsonTabComponent): void {\r\n\t\tthis.selectedComponent.deleteTab(tab);\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tprivate save(saveTranslations = true): void {\r\n\t\tthis.editorService.saveCanvas();\r\n\t\tif (saveTranslations) {\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.TRANSLATIONS);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate openEditTabDialog(\r\n\t\ttab: IJsonTabComponent,\r\n\t\tsourceFields: IAvailableSourceField[]\r\n\t): ng.IPromise<IDialogResult<IJsonTabComponent | string>> {\r\n\t\tconst options: IDialogOptions<IEditTabDialogParameter> = {\r\n\t\t\ttitle: \"Edit Tab\",\r\n\t\t\tparameter: {\r\n\t\t\t\ttab: angular.copy(tab),\r\n\t\t\t\tsourceFields: sourceFields,\r\n\t\t\t\tcomponent: this.selectedComponent\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./edit-tab-dialog.html\")\r\n\t\t};\r\n\r\n\t\treturn this.dialogService.show(options);\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\tstatic getInsertPoints(flexbox: IEditorFlexbox): IInsertPoints {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport class TabsContentSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./tabs-content-settings.html\");\r\n\tscope = true;\r\n\tcontroller = TabsContentSettingsCtrl;\r\n\tcontrollerAs = \"eirTabsContentSettingsCtrl\";\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirEditTabCtrl as ctrl\\\"> <div class=\\\"field with-button\\\"> <label for=tabDisplayName class=required>Name</label> <input id=tabDisplayName type=text class=required ng-model=ctrl.tab.name ng-change=ctrl.onChangeTabName() xi-autocomplete=ctrl.autocompleteOptions xi-lookup=ctrl.lookupOptions ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> <button class=btn-icon xi-tooltip=\\\"'Translations'\\\" ng-if=::ctrl.isFeatureTranslationEnabled() ng-click=ctrl.openTranslations()> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-translate></use> </svg> <span class=audible>Translations</span> </button> </div> <div class=field> <label>Source Field</label> <select id=srckey class=\\\"dropdown dropdown-md\\\" ng-model=ctrl.selectedSourceField ng-disabled=!ctrl.sourceFields ng-options=\\\"sourceField as sourceField.visibleName for sourceField in ctrl.sourceFields\\\" ng-change=ctrl.onFieldSelected() xi-drop-down=ctrl.sourceFields></select> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.cancel()>Cancel</button> <button type=button class=\\\"btn-modal-primary no-validation\\\" ng-click=ctrl.save() ng-disabled=!ctrl.tab.name>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=link-menu> <h2 class=content-title>Tabs</h2> <ul class=\\\"arrange list content-list\\\" data-arrange-handle=.handle xi-arrange=eirTabsContentSettingsCtrl> <li ng-repeat=\\\"tab in eirTabsContentSettingsCtrl.getComponentTabs() track by tab.id\\\" ng-click=eirTabsContentSettingsCtrl.openTab(tab)> <span class=\\\"handle draggable\\\"> <svg class=\\\"icon icon-handle\\\" focusable=false aria-hidden=true role=presentation> <use href=#icon-drag></use> </svg> </span> {{ tab.name }} <button class=btn-menu xi-popupmenu> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=popupmenu> <li ng-click=eirTabsContentSettingsCtrl.updateTab(tab)><a href=#>Properties</a></li> <li ng-click=eirTabsContentSettingsCtrl.deleteTab(tab)><a>Delete</a></li> </ul> </li> </ul> <button type=button class=btn-tertiary ng-click=eirTabsContentSettingsCtrl.addTab()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xmlns:xlink=http://www.w3.org/1999/xlink xlink:href=#icon-add-grid-record></use> </svg> <span>Add Tab</span> </button> </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { DateFormat, InjectNames, MaskProcess } from \"ng2/common/constants/common.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJSonMaskSettings } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\n\r\nimport { DialogButtonType, DialogService, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { IEditorTextbox } from \"../../components/editor-textbox\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { SettingsBase } from \"../settings-base\";\r\nimport { TextboxSettings } from \"./textbox-settings\";\r\n\r\nexport class TextboxStyleSettingsCtrl extends SettingsBase {\r\n\r\n\tpublic get availableMasks(): IDataPair[] {\r\n\t\treturn TextboxSettings.getInstance().availableMasks;\r\n\t}\r\n\r\n\tpublic settingMask: IDataPair;\r\n\tprotected selectedComponent: IEditorTextbox;\r\n\tprivate mask: IJSonMaskSettings;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\t$scope: ng.IScope,\r\n\t\teditorService: EditorService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t\tthis.initiationMaskProcess();\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tsuper.onComponentChanged(newComponent);\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.initiationMaskProcess();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic openMaskSettings(): void {\r\n\t\tconst options = {\r\n\t\t\ttitle: \"Masking Options\",\r\n\t\t\tparameter: angular.copy(this.selectedComponent.getMask()),\r\n\t\t\ttemplate: require(\"./mask-setting-dialog.html\")\r\n\t\t};\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<IJSonMaskSettings>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.selectedComponent.updateMaskOptions(result.value);\r\n\t\t\t\tthis.editorService.saveCanvas();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onChangeProcess(): void {\r\n\t\t//Give mask a default value\r\n\t\tswitch (this.settingMask.value) {\r\n\t\t\tcase MaskProcess.NUMBER:\r\n\t\t\t\tconst limit = 10;\r\n\t\t\t\tthis.mask = {\r\n\t\t\t\t\tprocess: this.settingMask.value,\r\n\t\t\t\t\tallowNegative: false,\r\n\t\t\t\t\tintegerLimit: limit,\r\n\t\t\t\t\tdecimalLimit: 0,\r\n\t\t\t\t\tallowThousandsSeparator: false,\r\n\t\t\t\t\tprefix: \"\"\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase MaskProcess.DATE_TIME:\r\n\t\t\t\tthis.mask = {\r\n\t\t\t\t\tprocess: this.settingMask.value,\r\n\t\t\t\t\tformat: DateFormat.FORMAT_1\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase MaskProcess.STRING:\r\n\t\t\t\tthis.mask = {\r\n\t\t\t\t\tprocess: this.settingMask.value,\r\n\t\t\t\t\tformat: \"****-****-****\"\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// Password & None\r\n\t\t\t\tthis.mask = { process: this.settingMask.value };\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.selectedComponent.updateMaskOptions(this.mask);\r\n\t\tthis.editorService.saveCanvas();\r\n\t}\r\n\r\n\tprivate initiationMaskProcess(): void {\r\n\t\tconst mask = this.selectedComponent.getMask();\r\n\t\tconst availableMasks = this.availableMasks;\r\n\t\tfor (let i = 0; i < availableMasks.length; i++) {\r\n\t\t\tif (mask.process === availableMasks[i].value) {\r\n\t\t\t\tthis.settingMask = availableMasks[i];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class TextboxStyleSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./textbox-style-settings.html\");\r\n\tscope = true;\r\n\tcontroller = TextboxStyleSettingsCtrl;\r\n\tcontrollerAs = \"eirTextboxStyleSettingsCtrl\";\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirMaskSettingsDialogCtrl as ctrl\\\" class=mask-setting-dialog> <div ng-if=\\\"ctrl.maskSetting === 'number'\\\"> <div class=field> <input type=checkbox class=checkbox id=checkbox-negative ng-change=ctrl.onChangeMask() ng-model=ctrl.mask.allowNegative> <label for=checkbox-negative class=\\\"checkbox-label capitalize\\\">Allow Negative</label> </div> <div class=field> <input type=checkbox class=checkbox id=checkbox-separator ng-change=ctrl.onChangeMask() ng-model=ctrl.mask.allowThousandsSeparator> <label for=checkbox-separator class=\\\"checkbox-label capitalize\\\">Allow Thousands Separator</label> </div> <div class=field> <label>Integer Limit</label> <input type=number class=input-mm ng-model=ctrl.mask.integerLimit ng-change=ctrl.onChangeMask() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 400, 'blur': 0}}\\\"/> </div> <div class=field> <label>Decimal Limit</label> <input type=number class=input-mm ng-model=ctrl.mask.decimalLimit ng-change=ctrl.onChangeMask() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 400, 'blur': 0}}\\\"/> </div> <div class=field> <label>Prefix</label> <eir-input-field-component id=prefix field-value=ctrl.mask.prefix field-name=prefix on-component-change=ctrl.notify($data) validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{type: 'no-numeric'}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t}\\\"/> </div> </div> <div ng-if=\\\"ctrl.maskSetting === 'date'\\\"> <div class=add-source ng-if=\\\"ctrl.maskSetting === 'date'\\\"> <label>Format</label> <select class=\\\"dropdown dropdown-md\\\" ng-model=ctrl.mask.format ng-options=\\\"format.value as format.name for format in ctrl.AVAILABLE_FORMATS\\\" xi-drop-down> </select> </div> <div class=\\\"field with-button\\\"> <label>Custom Format</label> <input type=text class=input-mm ng-model=ctrl.mask.format ng-change=ctrl.onChangeMask() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 400, 'blur': 0}}\\\"/> <button class=btn-icon ng-click=ctrl.openMaskHelp() xi-tooltip=\\\"'Help'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-info></use> </svg> </button> </div> </div> <div ng-if=\\\"ctrl.maskSetting === 'string'\\\"> <div class=\\\"field with-button\\\"> <label>Pattern</label> <input type=text class=input-mm ng-model=ctrl.mask.format ng-change=ctrl.onChangeMask() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 400, 'blur': 0}}\\\"/> <button class=btn-icon ng-click=ctrl.openMaskHelp() xi-tooltip=\\\"'Help'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-info></use> </svg> </button> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=\\\"button btn-primary\\\" class=btn-modal ng-click=ctrl.save() ng-disabled=ctrl.isPrefixInvalid>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=setting-category> <div class=\\\"accordion last-one-setting\\\" xi-control=accordion> <div class=accordion-header> <a class=title href=#> <span>Masking</span> </a> </div> <div class=accordion-pane> <div class=accordion-content> <div class=\\\"field-short with-button\\\"> <label>Type</label> <select class=\\\"dropdown dropdown-md\\\" ng-model=eirTextboxStyleSettingsCtrl.settingMask ng-change=eirTextboxStyleSettingsCtrl.onChangeProcess() ng-options=\\\"mask.name for mask in eirTextboxStyleSettingsCtrl.availableMasks track by mask.value\\\" xi-drop-down> </select> <button class=btn-icon ng-disabled=\\\"eirTextboxStyleSettingsCtrl.settingMask.value === 'none' || eirTextboxStyleSettingsCtrl.settingMask.value === 'password'\\\" ng-click=eirTextboxStyleSettingsCtrl.openMaskSettings() xi-tooltip=\\\"'Mask Options'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-settings></use> </svg> </button> </div> </div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=manage-dialog ng-controller=\\\"eirManageCompositesCtrl as ctrl\\\"> <div class=\\\"local-datagrid manage-datagrid\\\"> <div class=toolbar role=toolbar> <div class=buttonset> <label class=audible for=searchfield-local-composite>Keyword Search</label> <input id=searchfield-local-composite name=searchfield-local-composite class=searchfield /> <button class=btn-tertiary type=button ng-click=ctrl.openGlobalRepository() xi-tooltip=\\\"'Add From Repository'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-new-document></use> </svg> <span>Add from Repository</span> </button> <button class=btn-tertiary type=button ng-disabled=!ctrl.itemSelected ng-click=ctrl.deleteItem() xi-tooltip=\\\"'Delete'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> <button class=btn-tertiary type=button xi-tooltip=\\\"'Import Composite Component'\\\" ng-click=ctrl.import()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-import></use> </svg> <span>Import from File</span> </button> <button class=btn-tertiary type=button xi-tooltip=\\\"'Export Composite Component'\\\" ng-disabled=!ctrl.itemSelected ng-click=ctrl.export()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-import></use> </svg> <span>Export to File</span> </button> </div> </div> <div xi-datagrid=ctrl.datagridOptions id=local-grid class=datagrid-contained></div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Close</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=interaction-wizard ng-controller=\\\"eirInteractionSettingsCtrl as eirInteractionSettingsCtrl\\\"> <div ng-controller=\\\"eirInteractionWizardCtrl as wizardCtrl\\\" class=\\\"wizard-base wizard-page-{{wizardCtrl.currentTick}}\\\"> <div class=wizard xi-control=wizard> <div class=wizard-header> <div class=bar> <div class=completed-range></div> <a class=\\\"tick current\\\"><span class=label>1. Trigger Event</span></a> <a class=tick><span class=label>2. Action</span></a> <a class=tick><span class=label>3. Data Mapping</span></a> <a class=tick><span class=label>4. Summary</span></a> </div> </div> </div> <div class=wizard-content ng-repeat=\\\"step in ::wizardCtrl.steps\\\" ng-if=\\\"wizardCtrl.currentTick === $index\\\"> <div ng-include src=step.id></div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=wizardCtrl.cancel()>Cancel</button> <button type=button class=btn-modal ng-click=wizardCtrl.back() ng-disabled=\\\"wizardCtrl.currentTick === 0\\\">Back</button> <button type=button class=btn-modal-primary ng-click=wizardCtrl.next() ng-disabled=wizardCtrl.nextDisabled> {{wizardCtrl.currentTick === wizardCtrl.maxTick ? 'Finish' : 'Next'}} </button> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AppState } from \"../../../app.state\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\nimport { ViewEnum } from \"../../../common/defines\";\r\nimport type { IErrorResponse } from \"../../../common/error-response\";\r\nimport { CommonService } from \"../../../common/services/common-service\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogResult,\r\n\tIMessageDialogOptions, StandardDialogButtons\r\n} from \"../../../common/services/dialog-service\";\r\nimport type { IValidatorError } from \"../../../common/shared-components/base/field-validation\";\r\nimport type { IExpandedRowItem, IRowItem } from \"../../../common/sohoxi/datagrid-helper\";\r\nimport { DesignerService } from \"../../services/designer-service\";\r\nimport { ProjectService } from \"../../services/project-service\";\r\n\r\nimport {\r\n\tConfig,\r\n\tDashboardStates,\r\n\tDashboardViewStates,\r\n\tINewProject,\r\n\tInjectNames,\r\n\tNumbers,\r\n\tSortEnum,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { FormatterEnum, SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\nimport type {\r\n\tIDatagridApi,\r\n\tIDataGridColumn,\r\n\tIDataGridOptions,\r\n\tIDataGridRow,\r\n} from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport type { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { IProjectInfo, ProjectInfo } from \"ng2/common/project/project-info\";\r\nimport \"../../images/createPage/02-thumb.png\";\r\n\r\nexport class DashboardCtrl {\r\n\tget isLoading(): boolean {\r\n\t\treturn Config.IS_FIRST_LOAD;\r\n\t}\r\n\r\n\tprivate errorList: IValidatorError[] = [];\r\n\tstate = DashboardStates.LIST;\r\n\tviewState = DashboardViewStates.TILE;\r\n\tprojects: IProjectInfo[];\r\n\tcurrentPage: IDesignerManifest[];\r\n\tcurrentProject: DesignerMashup;\r\n\tdashboardLoading: boolean;\r\n\tsearchString = \"\";\r\n\tnewProject: INewProject;\r\n\tisProjectChanged: boolean;\r\n\r\n\tfilterTypeOptions: IDataPair[] = [\r\n\t\t{ name: \"All Projects\", value: undefined },\r\n\t\t{\r\n\t\t\tname: \"Created by me\", value: {\r\n\t\t\t\tmanifest: {\r\n\t\t\t\t\tcreatedBy: Config.USER.name\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t];\r\n\r\n\tsortPropertiesOptions: IDataPair[] = [\r\n\t\t{ name: \"Changed Date\", value: \"manifest.lastChangedTime\" },\r\n\t\t{ name: \"Created Date\", value: \"manifest.createdTime\" },\r\n\t\t{ name: \"Name\", value: \"manifest.displayName\" }\r\n\t];\r\n\r\n\tfilterEnum = SortEnum;\r\n\tfilterContainer: string[] = [];\r\n\tdatagridOptions: IDataGridOptions<IProjectInfo>;\r\n\tselectedProjects: IProjectInfo[] = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.STATE_SERVICE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.DESIGNER_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.PROJECT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $stateService: ng.ui.IStateService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate designerService: DesignerService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate projectService: ProjectService\r\n\t) {\r\n\t\tthis.designerService.setView(ViewEnum.DASHBOARD);\r\n\t\tthis.loadProjects().then(() => {\r\n\t\t\tthis.currentProject = commonService.getCurrentProject() as DesignerMashup;\r\n\t\t});\r\n\r\n\t\tthis.commonService.onDuplicateProjectChangedEvent.on(() => {\r\n\t\t\tthis.loadProjects();\r\n\t\t});\r\n\t}\r\n\r\n\tinitDatagrid(): void {\r\n\t\tthis.initGridOptions();\r\n\t}\r\n\r\n\tfinishedLoadingProjects(): void {\r\n\t\tthis.commonService.$timeout(_ =>\r\n\t\t\tConfig.IS_FIRST_LOAD = false, Numbers.ONE_THOUSAND);\r\n\t}\r\n\r\n\tprivate loadProjects(): ng.IPromise<void> {\r\n\t\tthis.dashboardLoading = true;\r\n\t\treturn this.commonService.loadProjects().then((projectInfo: IProjectInfo[]) => {\r\n\t\t\tthis.dashboardLoading = false;\r\n\t\t\t// Convert JSON to Class and put to projects\r\n\t\t\tthis.projects = projectInfo.map((projectInfo: IProjectInfo) => {\r\n\t\t\t\treturn new ProjectInfo(projectInfo);\r\n\t\t\t});\r\n\t\t\tthis.datagridOptions.dataset = this.projects;\r\n\r\n\t\t\tif (this.projects.length === 0) {\r\n\t\t\t\tthis.finishedLoadingProjects();\r\n\t\t\t}\r\n\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\tthis.dashboardLoading = false;\r\n\t\t\tthis.dialogService.showError(\"List projects\", errorResponse.message);\r\n\t\t});\r\n\t}\r\n\r\n\tinitGridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tcolumns.push({\r\n\t\t\tid: \"selectionCheckbox\",\r\n\t\t\tsortable: false,\r\n\t\t\tresizable: false,\r\n\t\t\twidth: 50,\r\n\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\talign: \"center\"\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"displayName\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"manifest.displayName\",\r\n\t\t\twidth: 250,\r\n\t\t\tsortable: true,\r\n\t\t\ttextOverflow: FormatterEnum.Ellipsis,\r\n\t\t\tformatter: Soho.Formatters.Expander\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"createdBy\",\r\n\t\t\tname: \"Created By\",\r\n\t\t\tfield: \"manifest.createdByDisplayName\",\r\n\t\t\twidth: 150,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"createdTime\",\r\n\t\t\tname: \"Created\",\r\n\t\t\tfield: \"manifest.createdTime\",\r\n\t\t\twidth: 100,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Date\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"lastChangedBy\",\r\n\t\t\tname: \"Last Changed By\",\r\n\t\t\tfield: \"manifest.lastChangedByDisplayName\",\r\n\t\t\twidth: 150,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"lastChangedTime\",\r\n\t\t\tname: \"Last Changed\",\r\n\t\t\tfield: \"manifest.lastChangedTime\",\r\n\t\t\twidth: 100,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Date\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"open\",\r\n\t\t\tname: \"Action\",\r\n\t\t\twidth: 50,\r\n\t\t\tformatter: Soho.Formatters.Button,\r\n\t\t\ticon: \"launch\",\r\n\t\t\ttooltip: \"Open Project\",\r\n\t\t\tresizable: false,\r\n\t\t\talign: \"center\",\r\n\t\t\tclick: (_: JQueryEventObject, rows: IDataGridRow<any>[]) => {\r\n\t\t\t\tconst project = rows[0].item as IProjectInfo;\r\n\t\t\t\tthis.$stateService.go(AppState.EDITOR.name, {\r\n\t\t\t\t\tid: project.manifest.id,\r\n\t\t\t\t\treloadProject: false,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.datagridOptions = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: SelectableEnum.Multiple,\r\n\t\t\tpaging: true,\r\n\t\t\tpagesize: 10,\r\n\t\t\texpandableRow: true,\r\n\t\t\tonExpandRow: ( data: IExpandedRowItem<IProjectInfo>, response: Function) => {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tconst manifest = data.item.manifest;\r\n\t\t\t\t\tconst image = manifest.previewImg ? manifest.previewImg : \"designer/images/02-thumb.png\";\r\n\t\t\t\t\tlet rowTemplate = `\r\n\t\t\t\t\t<div class=\"datagrid-cell-layout\">\r\n\t\t\t\t\t\t<div class=\"img-container\">\r\n\t\t\t\t\t\t\t<img src=\"${ image }\" alt=\"No image\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"datagrid-cell-layout\">\r\n\t\t\t\t\t\t<p class=\"datagrid-row-heading\">${ manifest.displayName }</p>\r\n\t\t\t\t\t\t<p class=\"datagrid-row-micro-text\">${ manifest.title }</p>\r\n\t\t\t\t\t\t<span class=\"datagrid-wrapped-text\">${ manifest.description }</span>\r\n\t\t\t\t\t\t<p class=\"datagrid-row-micro-text\">Version: ${ manifest.version }</p>\r\n\t\t\t\t\t\t<div class=\"tag-container tag-list\">`;\r\n\r\n\t\t\t\t\tdata.item.tags.forEach((tag) => {\r\n\t\t\t\t\t\tconst tagElement = `<span class=\"tag\">${ tag.name }</span>`;\r\n\t\t\t\t\t\trowTemplate += tagElement;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\trowTemplate += \"</div>\";\r\n\r\n\t\t\t\t\tresponse(rowTemplate);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Projects\",\r\n\t\t\t\tresults: true,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tadvancedFilter: true,\r\n\t\t\t\tactions: true,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true\r\n\t\t\t},\r\n\t\t\tenableTooltips: true\r\n\t\t};\r\n\r\n\t\t// Any cast needed since jQuery only expects one argument on handler\r\n\t\tthis.getGridElement().on(\"selected\", (e: any, args: IRowItem<IProjectInfo>[]) => {\r\n\t\t\t// Using evalAsync due to method called multiple times from grid component\r\n\t\t\tthis.$scope.$evalAsync(() => {\r\n\t\t\t\tif (args.length > 0) {\r\n\t\t\t\t\tthis.selectedProjects = args.map((rowObject) => { return rowObject.data; });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.selectedProjects = [];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\texportProject(): void {\r\n\t\tconst projectId = this.selectedProjects[0].manifest.id;\r\n\t\tconst displayName = this.selectedProjects[0].manifest.displayName;\r\n\t\tthis.projectService.export(projectId, displayName);\r\n\t}\r\n\r\n\tlaunchProject(): void {\r\n\t\tconst projectId = this.selectedProjects[0].manifest.id;\r\n\t\tthis.projectService.launchProject(projectId);\r\n\t}\r\n\r\n\tduplicateProject(): void {\r\n\t\tconst manifest = this.selectedProjects[0].manifest;\r\n\t\tthis.projectService.duplicate(manifest);\r\n\t}\r\n\r\n\tpublishProject(): void {\r\n\t\tconst projectId = this.selectedProjects[0].manifest.id;\r\n\t\tconst displayName = this.selectedProjects[0].manifest.displayName;\r\n\t\tthis.projectService.publish(projectId, displayName);\r\n\t}\r\n\r\n\tdeleteProjects(): void {\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: \"Delete Project(s)\",\r\n\t\t\tmessage: \"Please confirm that you want to delete the selected project(s).\",\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo,\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(options).then((result: IDialogResult<string>) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Yes) {\r\n\t\t\t\tconst projectIds: string[] = [];\r\n\t\t\t\tthis.selectedProjects.forEach((project) => {\r\n\t\t\t\t\tprojectIds.push(project.manifest.id);\r\n\t\t\t\t});\r\n\t\t\t\tthis.projectService.deleteByIds(projectIds).then(() => {\r\n\t\t\t\t\tthis.getSohoXiApi().unSelectAllRows();\r\n\t\t\t\t\tthis.loadProjects();\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\t\t\ttitle: \"Delete Project(s)\",\r\n\t\t\t\t\t\tmessage: errorResponse.message,\r\n\t\t\t\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\t\t\t\tisError: true,\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tthis.dialogService.showMessage(options);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getSohoXiApi(): IDatagridApi {\r\n\t\treturn this.getGridElement().data(\"datagrid\");\r\n\t}\r\n\r\n\tprivate getGridElement(): ng.IAugmentedJQuery {\r\n\t\treturn this.$element.find(\"#projects-grid\");\r\n\t}\r\n\r\n\tsetView(view: DashboardViewStates): void {\r\n\t\tthis.viewState = view;\r\n\t}\r\n}\r\n\r\nexport class DashboardDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirDashboard\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tscope: true,\r\n\t\t\t\ttemplate: require(\"./dashboard.html\"),\r\n\t\t\t\tcontroller: DashboardCtrl,\r\n\t\t\t\tcontrollerAs: \"eirDashboardCtrl\",\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"angularAnimate-fade designer-splash gray\\\" ng-if=eirDashboardCtrl.isLoading xi-busy=eirDashboardCtrl.isLoading busy-delay=500 transparent-overlay=true> </div> <header class=header> <eir-all-projects-toolbar search-string=eirDashboardCtrl.searchString on-load-projects=eirDashboardCtrl.loadProjects() state=eirDashboardCtrl.state is-project-changed=eirDashboardCtrl.isProjectChanged view-state=eirDashboardCtrl.viewState ng-show=\\\"eirDashboardCtrl.state === 0\\\"> </eir-all-projects-toolbar> <eir-create-toolbar ng-show=\\\"eirDashboardCtrl.state === 1\\\" new-project=eirDashboardCtrl.newProject state=eirDashboardCtrl.state error-list=eirDashboardCtrl.errorList> </eir-create-toolbar> </header> <div class=\\\"page-container scrollable\\\"> <eir-create-project ng-if=\\\"eirDashboardCtrl.state === 1\\\" class=\\\"row create\\\" new-project=eirDashboardCtrl.newProject error-list=eirDashboardCtrl.errorList> </eir-create-project> </div> <div id=dashboard-tabs class=\\\"tab-container alternate\\\" ng-if=\\\"eirDashboardCtrl.state === 0\\\" xi-tabs> <ul class=tab-list role=tablist aria-multiselectable=false> <li class=\\\"tab is-selected\\\" xi-tooltip=\\\"'Tile View'\\\" ng-click=eirDashboardCtrl.setView(0)> <a href=#dashboard-card-tab class=hyperlink> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-tile></use> </svg> <span class=audible>Tile View</span> </a> </li> <li class=tab xi-tooltip=\\\"'Grid View'\\\" ng-click=eirDashboardCtrl.setView(1)> <a href=#dashboard-grid-tab class=hyperlink> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-columns></use> </svg> <span class=audible>Grid View</span> </a> </li> </ul> </div> <div id=dashboard-card-tab ng-if=\\\"eirDashboardCtrl.state === 0\\\"> <div class=list xi-busy=eirDashboardCtrl.dashboardLoading busy-delay=100> <eir-filter-toolbar-component ng-if=::eirDashboardCtrl.projects filter-type-options=eirDashboardCtrl.filterTypeOptions sort-properties-options=eirDashboardCtrl.sortPropertiesOptions filter-target=eirDashboardCtrl.projects local-prefix=builder-> </eir-filter-toolbar-component> <div class=project-container> <eir-project-card class=card ng-repeat=\\\"project in collection = (eirDashboardCtrl.searchString === '' ?\\r\\n\\t\\t\\t\\t\\teirDashboardCtrl.currentPage : eirDashboardCtrl.projects)\\r\\n\\t\\t\\t\\t\\t| filter: { manifest: { displayName: eirDashboardCtrl.searchString }} track by project.manifest.id\\\" ng-class=\\\"::{'selected': eirDashboardCtrl.currentProject.getId() === project.manifest.id }\\\" ng-mouseenter=\\\"project.manifest.showCardOverlay = true\\\" ng-mouseleave=\\\"project.manifest.showCardOverlay = false\\\" manifest=project.manifest tags=project.tags is-project-changed=eirDashboardCtrl.isProjectChanged on-load-projects=eirDashboardCtrl.loadProjects() ng-init=\\\"$last && eirDashboardCtrl.finishedLoadingProjects()\\\"> </eir-project-card> </div> <eir-paginator ng-if=::eirDashboardCtrl.projects ng-hide=\\\"eirDashboardCtrl.searchString !== ''\\\" paging-values=eirDashboardCtrl.projects current-page=eirDashboardCtrl.currentPage> </eir-paginator> </div> </div> <div id=dashboard-grid-tab class=row ng-if=\\\"eirDashboardCtrl.state === 0\\\" ng-init=eirDashboardCtrl.initDatagrid()> <div class=list> <div class=toolbar role=toolbar> <div class=buttonset> <label class=audible for=searchfield-projects>Keyword Search</label> <input id=searchfield-local-datasource name=searchfield-projects class=searchfield data-options=\\\"{ collapsible: false }\\\"/> <button class=btn-tertiary type=button ng-disabled=\\\"eirDashboardCtrl.selectedProjects.length === 0\\\" ng-click=eirDashboardCtrl.deleteProjects() xi-tooltip=\\\"'Delete'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> <button class=btn-actions type=button xi-tooltip=\\\"'Add Data Service'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=\\\"popupmenu is-padded\\\"> <li class=\\\"{{eirDashboardCtrl.selectedProjects.length > 1 || eirDashboardCtrl.selectedProjects.length === 0 ? 'is-disabled' : ''}}\\\"> <a ng-click=eirDashboardCtrl.exportProject()>Export to File</a> </li> <li class=\\\"{{eirDashboardCtrl.selectedProjects.length > 1 || eirDashboardCtrl.selectedProjects.length === 0 ? 'is-disabled' : ''}}\\\"> <a ng-click=eirDashboardCtrl.publishProject()>Publish</a> </li> <li class=\\\"{{eirDashboardCtrl.selectedProjects.length > 1 || eirDashboardCtrl.selectedProjects.length === 0 ? 'is-disabled' : ''}}\\\"> <a ng-click=eirDashboardCtrl.duplicateProject()>Duplicate</a> </li> <li class=\\\"{{eirDashboardCtrl.selectedProjects.length > 1 || eirDashboardCtrl.selectedProjects.length === 0 ? 'is-disabled' : ''}}\\\"> <a ng-click=eirDashboardCtrl.launchProject()>Launch</a> </li> </ul> </div> </div> <div xi-datagrid=eirDashboardCtrl.datagridOptions id=projects-grid></div> </div> </div> <footer> <eir-licenses-button app-name=\\\"Infor App Builder\\\"></eir-licenses-button> </footer>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { IDialogBaseScope } from \"../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../common/services/dialog-service\";\r\n\r\nexport class DuplicateProjectCtrl {\r\n\tprivate projectName: string;\r\n\tprivate dialog: IDialog<string>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE\r\n\t];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<string>) {\r\n\t\tconst dialog: IDialog<string> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.projectName = dialog.parameter;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic duplicate(): void {\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tvalue: this.projectName,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirDuplicateProjectCtrl\", DuplicateProjectCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { ReplaceEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../common/services/dialog-service\";\r\nimport { IConflictDialogParameter } from \"./id-conflict-dialog\";\r\n\r\nexport class DisplayNameConflictCtrl {\r\n\tprivate dialog: IDialog<IConflictDialogParameter>;\r\n\tpublic newName: string;\r\n\tpublic oldName: string;\r\n\tpublic message: string;\r\n\tpublic option: ReplaceEnum;\r\n\r\n\tpublic ReplaceEnum = ReplaceEnum;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE\r\n\t];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<IConflictDialogParameter>) {\r\n\t\tthis.dialog = scope.eirDialog;\r\n\t\tconst parameter = this.dialog.parameter;\r\n\t\tthis.newName = parameter.newDisplayName;\r\n\t\tthis.oldName = parameter.oldDisplayName;\r\n\t\tthis.message = parameter.message;\r\n\t\tthis.option = ReplaceEnum.DONOTHING;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic import(): void {\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tvalue:  this.newName,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirDisplayNameConflictCtrl\", DisplayNameConflictCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport {\r\n\tABFormScriptMethod, ComponentConstants, Config, DashboardStates,\r\n\tDashboardViewStates, ElementDataKeys, InjectNames, Numbers, ReplaceEnum, Subcodes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IJsonDesignerMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { Debugger } from \"../../../../common/debugger\";\r\nimport { IErrorResponse } from \"../../../../common/error-response\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult, IToastOptions } from \"../../../../common/services/dialog-service\";\r\nimport { IConflictChoice, IConflictDialogParameter } from \"../../import-dialog/id-conflict-dialog\";\r\n\r\nimport { CommonService } from \"../../../../common/services/common-service\";\r\nimport { ConflictResolutonService } from \"../../../../common/services/conflict-resolution-service\";\r\nimport { ProjectService } from \"../../../services/project-service\";\r\n\r\nexport class AllProjectsToolbarComponent {\r\n\tpublic state: number;\r\n\tpublic currentProject: DesignerMashup;\r\n\tpublic isProjectChanged: boolean;\r\n\tpublic searchString: string;\r\n\tpublic onLoadProjects: Function;\r\n\tpublic viewState: DashboardViewStates;\r\n\r\n\tpublic get isDeveloper(): boolean {\r\n\t\treturn Debugger.isEnabled() && Config.IS_DEV;\r\n\t}\r\n\r\n\tprivate importTitle = \"Import Project\";\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.PROJECT_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.CONFLICT_RESOLUTION_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate projectService: ProjectService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate conflictResolutionService: ConflictResolutonService,\r\n\t) {\r\n\t\tthis.currentProject = commonService.getCurrentProject() as DesignerMashup;\r\n\t\tthis.$element.data(ElementDataKeys.allProjectsToolbar, this);\r\n\t}\r\n\r\n\tpublic setState(): void {\r\n\t\t// Triggers dropdown and popover to close (soho xi)\r\n\t\tangular.element(\"body\").click();\r\n\t\tthis.state = DashboardStates.CREATE;\r\n\t}\r\n\r\n\tpublic importProject(): void {\r\n\t\tWSForm.call({\r\n\t\t\tname: ABFormScriptMethod.SHOW_OPEN_FILE_DIALOG,\r\n\t\t\tparameters: [\r\n\t\t\t\t\"ABProject.iap\", // Filename\r\n\t\t\t\t\"Import Project\",  // Caption\r\n\t\t\t\t\"AppBuilder Project (*.iap)|*.iap\" // Filter\r\n\t\t\t],\r\n\t\t\tonCompleted: (response) => response !== \"-1\" ?\r\n\t\t\t\tthis.importProjectFile(response) : response\r\n\t\t});\r\n\t}\r\n\r\n\tprivate importProjectFile(\r\n\t\tfilePath: string,\r\n\t\treplaceOption: ReplaceEnum = ReplaceEnum.DONOTHING,\r\n\t\tnewDisplayName: string = null\r\n\t): void {\r\n\t\tthis.projectService\r\n\t\t\t.importProject(filePath, replaceOption, newDisplayName)\r\n\t\t\t.then(importedProject => {\r\n\t\t\t\tthis.onLoadProjects();\r\n\t\t\t\tthis.validateData(importedProject);\r\n\r\n\t\t\t\tconst options: IToastOptions = {\r\n\t\t\t\t\ttitle: \"Imported\",\r\n\t\t\t\t\tmessage: \"Successfully imported project\",\r\n\t\t\t\t\tposition: \"top right\",\r\n\t\t\t\t\tprogressBar: true,\r\n\t\t\t\t\ttimeout: 3000,\r\n\t\t\t\t};\r\n\t\t\t\tthis.dialogService.showToast(options);\r\n\t\t\t})\r\n\t\t\t.catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\tthis.handleImportError(\r\n\t\t\t\t\terrorResponse,\r\n\t\t\t\t\tfilePath);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate importIdConflict(\r\n\t\tconflictingManifest: IJsonManifest,\r\n\t\tfilePath: string,\r\n\t\terrorResponse: IErrorResponse\r\n\t): void {\r\n\t\tthis.commonService.loadProjects().then((projects) => {\r\n\t\t\tconst importDisplayName = conflictingManifest.displayName;\r\n\t\t\tconst options: IDialogOptions<IConflictDialogParameter> = {\r\n\t\t\t\ttitle: this.importTitle,\r\n\t\t\t\ttemplate: require(\"../../import-dialog/id-conflict-dialog.html\"),\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\tmessage: errorResponse.message,\r\n\t\t\t\t\toldDisplayName: importDisplayName,\r\n\t\t\t\t\tnewDisplayName: Helper.getProposedNewDisplayName(\r\n\t\t\t\t\t\timportDisplayName + ComponentConstants.COPY_SUFFIX,\r\n\t\t\t\t\t\tprojects\r\n\t\t\t\t\t),\r\n\t\t\t\t\tnewDisplayNameOverwrite: Helper.getProposedNewDisplayName(importDisplayName, projects, conflictingManifest.id)\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService\r\n\t\t\t\t.show(options)\r\n\t\t\t\t.then((result: IDialogResult<IConflictChoice>) => {\r\n\t\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\tconst option: ReplaceEnum = result.value.option;\r\n\t\t\t\t\t\tconst newDisplayName = result.value.newDisplayName;\r\n\t\t\t\t\t\tthis.importProjectFile(filePath, option, newDisplayName);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}).catch((error: IErrorResponse) => {\r\n\t\t\tthis.dialogService.showError(\"Did not load projects\", error.message);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate importDisplayNameConflict(\r\n\t\tconflictedManifest: IJsonManifest,\r\n\t\tfilePath: string,\r\n\t\terrorResponse: IErrorResponse\r\n\t): void {\r\n\t\tthis.commonService.loadProjects().then((projects) => {\r\n\t\t\tconst options: IDialogOptions<IConflictDialogParameter> = {\r\n\t\t\t\ttitle: this.importTitle,\r\n\t\t\t\ttemplate: require(\"../../import-dialog/displayname-conflict-dialog.html\"),\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\tmessage: errorResponse.message,\r\n\t\t\t\t\toldDisplayName: conflictedManifest.displayName,\r\n\t\t\t\t\tnewDisplayName: Helper.getProposedNewDisplayName(\r\n\t\t\t\t\t\tconflictedManifest.displayName + ComponentConstants.COPY_SUFFIX,\r\n\t\t\t\t\t\tprojects\r\n\t\t\t\t\t)\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService\r\n\t\t\t\t.show(options)\r\n\t\t\t\t.then((result: IDialogResult<string>) => {\r\n\t\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\tconst newDisplayName = result.value;\r\n\t\t\t\t\t\tthis.importProjectFile(filePath, ReplaceEnum.COPYNEW, newDisplayName);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}).catch((error: IErrorResponse) => {\r\n\t\t\tthis.dialogService.showError(\"Did not load projects\", error.message);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Small Easter egg summer 2020\r\n\t */\r\n\tpublic onSearch(): void {\r\n\t\tif (this.searchString.toLowerCase() === \"imperial march\") {\r\n\t\t\tthis.searchString = \"\";\r\n\t\t\tconst projectCards = $(\"eir-project-card\");\r\n\t\t\tprojectCards.each((_index, element) => {\r\n\t\t\t\tconst plusOrMinus = Math.random() < Numbers.HALF ? -1 : 1;\r\n\t\t\t\tconst pixel = plusOrMinus * Math.floor(Math.random() * Numbers.ONE_THOUSAND) + \"px\";\r\n\t\t\t\t$(element).animate({ left: pixel, top: pixel });\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate handleImportError(errorResponse: IErrorResponse, filePath: string): void {\r\n\t\tif (errorResponse.subcode === Subcodes.PROJECT_ID_CONFLICT) {\r\n\t\t\tconst conflictedManifest: IJsonManifest = JSON.parse(errorResponse.detail);\r\n\t\t\tthis.importIdConflict(conflictedManifest, filePath, errorResponse);\r\n\t\t} else if (errorResponse.subcode === Subcodes.PROJECT_DISPLAYNAME_CONFLICT) {\r\n\t\t\tconst conflictedManifest: IJsonManifest = JSON.parse(errorResponse.detail);\r\n\t\t\tthis.importDisplayNameConflict(conflictedManifest, filePath, errorResponse);\r\n\t\t} else {\r\n\t\t\tthis.showImportProjectErrorMessage(errorResponse.message);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate validateData(project: IJsonDesignerMashup): void {\r\n\t\tthis.conflictResolutionService.checkIfInvalidImportedItems<IJsonDatasource>(\r\n\t\t\t\"data service(s)\",\r\n\t\t\tproject.datasources,\r\n\t\t).catch((errorDialogOptions) => this.dialogService.showMessage(errorDialogOptions));\r\n\t\tthis.conflictResolutionService.checkIfInvalidImportedItems<IJsonCompositeComponent>(\r\n\t\t\t\"composite(s)\",\r\n\t\t\tproject.compositeComponents,\r\n\t\t).catch((errorDialogOptions) => this.dialogService.showMessage(errorDialogOptions));\r\n\t}\r\n\r\n\tprivate showImportProjectErrorMessage(reasonMessage: string): void {\r\n\t\tconst message = `Failed to import project: ${reasonMessage}`;\r\n\t\tthis.dialogService.showError(this.importTitle, message);\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirAllProjectsToolbar\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tstate: \"=\",\r\n\t\t\t\tonLoadProjects: \"&\",\r\n\t\t\t\tsearchString: \"=\",\r\n\t\t\t\tisProjectChanged: \"=\",\r\n\t\t\t\tviewState: \"<\"\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./all-projects-toolbar.html\"),\r\n\t\t\tcontroller: AllProjectsToolbarComponent,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirIdConflictCtrl as ctrl\\\"> <fieldset class=radio-group> <legend>{{::ctrl.message}}</legend> <input type=radio checked=checked class=radio name=import id=importReplace ng-value=ctrl.ReplaceEnum.OVERWRITE ng-model=ctrl.option /> <label for=importReplace class=radio-label>Import &amp; Replace</label> <br> <label class=extra-label>Replace the existing project with the project you are importing. New name will be <b>{{::ctrl.newDisplayNameOverwrite}}</b>. </label> <br> <input type=radio class=radio name=import id=importCopy ng-value=ctrl.ReplaceEnum.COPYNEW ng-model=ctrl.option /> <label for=importCopy class=radio-label>Import as a New Project</label> <br> <label class=extra-label>The new project will be named <b>{{::ctrl.newDisplayName}}</b>.</label> <br> </fieldset> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.import()>Import</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div ng-controller=\\\"eirDisplayNameConflictCtrl as ctrl\\\"> <fieldset class=radio-group> <legend>{{::ctrl.message}}</legend> <input type=radio class=radio name=import id=importNewDisplayName ng-value=ctrl.ReplaceEnum.DONOTHING ng-model=ctrl.option /> <label for=importNewDisplayName class=radio-label>Import with new name</label> <br> <label class=extra-label>The new project will be named <b>{{::ctrl.newName}}</b></label> <br> </fieldset> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.import()>Import</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=toolbar role=toolbar xi-control=toolbar> <div class=title> <h1>Projects</h1> </div> <div class=buttonset> <div class=\\\"searchfield-wrapper toolbar-searchfield-wrapper\\\" ng-hide=\\\"ctrl.viewState === 1\\\"> <label class=audible for=regular-toolbar-searchfield>Toolbar Searchfield</label> <input class=searchfield placeholder=keyword id=regular-toolbar-searchfield name=regular-toolbar-searchfield ng-model=ctrl.searchString ng-change=ctrl.onSearch() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 800, 'blur': 0}}\\\"/> </div> <button type=button xi-tooltip=\\\"'Create new Project'\\\" xi-button class=btn-primary ng-click=ctrl.setState();> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-add></use> </svg> <span>New Project</span> </button> <button xi-tooltip=\\\"'More...'\\\" class=btn-actions xi-popupmenu> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More</span> </button> <ul class=popupmenu> <li ng-click=ctrl.importProject()> <a>Import Project</a> </li> <li class=separator></li> <li ui-sref=repository> <a>Repository</a> </li> <li ng-if=::ctrl.isDeveloper ui-sref=developer> <a>Developer Tools</a> </li> <li ng-if=::ctrl.isDeveloper ui-sref=\\\"ng2AppLauncher({ projectId: '6cb726da-1309-499f-8714-b6b725e3a966' })\\\"> <a>Ng2 App Launcher</a> </li> </ul> </div> <div class=return-container> <span class=return-to-project ng-if=ctrl.currentProject ui-sref=\\\"editor({ id: ctrl.currentProject.getId(), reloadProject: true })\\\"> Return to Current Project </span> </div> </div>\";\n// Exports\nmodule.exports = code;","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { KeyCodeEnum } from \"../../../../common/defines\";\r\nimport { IErrorResponse } from \"../../../../common/error-response\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogResult,\r\n\tIMessageDialogOptions, StandardDialogButtons\r\n} from \"../../../../common/services/dialog-service\";\r\nimport { ProjectService } from \"../../../services/project-service\";\r\n\r\nexport class ProjectCardComponent {\r\n\tpublic manifest: IJsonManifest;\r\n\tpublic tags: IJsonTag[];\r\n\tpublic isProjectChanged: boolean;\r\n\tpublic onLoadProjects: Function;\r\n\r\n\tpublic editingManifest: IJsonManifest;\r\n\tpublic editingManifestOldDisplayName: string;\r\n\r\n\tpublic static $inject = [\r\n\t\tInjectNames.PROJECT_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate projectService: ProjectService,\r\n\t\tprivate dialogService: DialogService,\r\n\t) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.isProjectChanged = false;\r\n\t}\r\n\r\n\tpublic openRuntime(): void {\r\n\t\tthis.projectService.launchProject(this.manifest.id);\r\n\t}\r\n\r\n\tpublic publishProject(): void {\r\n\t\tthis.projectService.publish(this.manifest.id, this.manifest.displayName);\r\n\t}\r\n\r\n\tpublic exportProject(): void {\r\n\t\tthis.projectService.export(this.manifest.id, this.manifest.displayName);\r\n\t}\r\n\r\n\tpublic duplicateProject(): void {\r\n\t\tthis.projectService.duplicate(this.manifest);\r\n\t}\r\n\r\n\tpublic deleteProject(): void {\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: \"Delete Project\",\r\n\t\t\tmessage: \"Please confirm that you want to delete this project.\",\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo,\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(options).then((result: IDialogResult<string>) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.projectService.deleteById(this.manifest.id).then(() => {\r\n\t\t\t\t\tthis.onLoadProjects();\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\t\t\ttitle: \"Delete Project\",\r\n\t\t\t\t\t\tmessage: errorResponse.message,\r\n\t\t\t\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\t\t\t\tisError: true,\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tthis.dialogService.showMessage(options);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onStartEditProjectName(): void {\r\n\t\tthis.editingManifest = this.manifest;\r\n\t\tthis.editingManifestOldDisplayName = this.editingManifest.displayName;\r\n\t}\r\n\r\n\tpublic onDoneEditProjectName(): void {\r\n\t\tconst oldDisplayName = this.editingManifestOldDisplayName;\r\n\t\tconst newDisplayName = this.editingManifest.displayName;\r\n\r\n\t\t// Save only when name changed value\r\n\t\tif (newDisplayName && newDisplayName !== oldDisplayName) {\r\n\t\t\tthis.projectService\r\n\t\t\t\t.renameProject(this.editingManifest.id, newDisplayName)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tthis.isProjectChanged = true;\r\n\t\t\t\t\tthis.editingManifestOldDisplayName = null;\r\n\t\t\t\t\tthis.onLoadProjects();\r\n\t\t\t\t})\r\n\t\t\t\t.catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\t// Revert back to old displayName when fail\r\n\t\t\t\t\tthis.editingManifest.displayName = oldDisplayName;\r\n\t\t\t\t\tconst message = `\r\n\t\t\t\t\t\tFailed to change project name from ${oldDisplayName} to ${newDisplayName}. Reason: ${errorResponse.message}`;\r\n\r\n\t\t\t\t\tthis.dialogService.showError(\"Operation Failed\", message);\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (!newDisplayName) {\r\n\t\t\t\tthis.editingManifest.displayName = oldDisplayName;\r\n\t\t\t\tconst message = `Project name can not be empty`;\r\n\t\t\t\tthis.dialogService.showError(\"Operation Failed\", message);\r\n\t\t\t}\r\n\t\t\tthis.editingManifestOldDisplayName = null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic isProjectDisplayNameEditMode(): boolean {\r\n\t\treturn this.editingManifestOldDisplayName ? true : false;\r\n\t}\r\n\r\n\tpublic onKeyUpEvent(keyCode: number): void {\r\n\t\tif (keyCode === KeyCodeEnum.ENTER) {\r\n\t\t\tthis.onDoneEditProjectName();\r\n\t\t} else if (keyCode === KeyCodeEnum.ESCAPE) {\r\n\t\t\tthis.onAbortEditProjectName();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onAbortEditProjectName(): void {\r\n\t\tthis.editingManifest.displayName = this.editingManifestOldDisplayName;\r\n\t\tthis.editingManifestOldDisplayName = null;\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirProjectCard\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tmanifest: \"<\",\r\n\t\t\t\ttags: \"<\",\r\n\t\t\t\tisProjectChanged: \"=\",\r\n\t\t\t\tonLoadProjects: \"&\"\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./project-card.html\"),\r\n\t\t\tcontroller: ProjectCardComponent,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=card-header> <h2 class=widget-title xi-tooltip=\\\"ctrl.manifest.displayName | eirHtmlEncode\\\" ng-click=ctrl.onStartEditProjectName() ng-if=!ctrl.isProjectDisplayNameEditMode()> {{ ctrl.manifest.displayName }} </h2> <div ng-if=ctrl.isProjectDisplayNameEditMode()> <input class=editing-display-name-field ng-blur=ctrl.onDoneEditProjectName() ng-keyup=ctrl.onKeyUpEvent($event.keyCode) ng-model=ctrl.editingManifest.displayName type=text /> </div> </div> <div class=card-content> <div class=image-container> <img ng-src=\\\"{{::ctrl.manifest.previewImg ? ctrl.manifest.previewImg : 'designer/images/02-thumb.png'}}\\\" alt=\\\"No image\\\"/> </div> <div class=\\\"description small-thin-text\\\"> <div> <span>Created by</span> <span>{{::ctrl.manifest.createdByDisplayName}}</span> <span class=date>{{::ctrl.manifest.createdTime | date:'yyyy-MM-dd HH:mm:ss'}}</span> </div> <hr/> <div> <span>Changed by</span> <span>{{::ctrl.manifest.lastChangedByDisplayName}}</span> <span class=date>{{::ctrl.manifest.lastChangedTime | date:'yyyy-MM-dd HH:mm:ss'}}</span> </div> </div> <div class=card-overlay ng-if=ctrl.manifest.showCardOverlay ui-sref=\\\"editor({ id: ctrl.manifest.id, reloadProject: true })\\\"> <div class=open-project> <label>Open Project</label> </div> <div class=project-description> <span>{{ ::ctrl.manifest.description }}</span> </div> <eir-project-tags tags=ctrl.tags></eir-project-tags> <div class=overlay-buttons ng-click=$event.stopPropagation()> <a xi-tooltip=\\\"'Delete Project'\\\" ng-click=\\\"$event.stopPropagation(); ctrl.deleteProject();\\\"> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </a> <a xi-tooltip=\\\"'Duplicate Project'\\\" ng-click=\\\"$event.stopPropagation(); ctrl.duplicateProject();\\\"> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-copy></use> </svg> <span>Duplicate</span> </a> <a xi-tooltip=\\\"'Export Project'\\\" ng-click=\\\"$event.stopPropagation(); ctrl.exportProject();\\\"> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-export></use> </svg> <span>Export</span> </a> <a xi-tooltip=\\\"'Launch Project'\\\" ng-click=\\\"$event.stopPropagation(); ctrl.openRuntime();\\\"> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-rocket></use> </svg> <span>Launch</span> </a> <a xi-tooltip=\\\"'Publish Project'\\\" ng-click=\\\"$event.stopPropagation(); ctrl.publishProject();\\\"> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-url></use> </svg> <span>Publish</span> </a> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { INewProject } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { IValidatorError } from \"common/shared-components/base/field-validation\";\r\nimport { IApplicationTemplate, IPageTemplate, PAGE_TEMPLATES } from \"designer/defines\";\r\n\r\nexport class CreateProjectComponent {\r\n\tnewProjectBinding: INewProject;\r\n\tprivate errorList: IValidatorError[];\r\n\r\n\tget newProject(): INewProject {\r\n\t\treturn this.newProjectBinding;\r\n\t}\r\n\r\n\tset newProject(value: INewProject) {\r\n\t\tthis.newProjectBinding = {\r\n\t\t\tprojectName: \"\",\r\n\t\t\tprojectDescription: \"\",\r\n\t\t\ttemplateNumber: undefined,\r\n\t\t\ttags: []\r\n\t\t};\r\n\t}\r\n\r\n\tget templates(): IPageTemplate[] {\r\n\t\treturn PAGE_TEMPLATES;\r\n\t}\r\n\r\n\tselectTemplate(template: IApplicationTemplate | IPageTemplate): void {\r\n\t\tthis.newProjectBinding.templateNumber = template.idx;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirCreateProject\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tnewProject: \"=\",\r\n\t\t\t\terrorList: \"=\"\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./create-project.html\"),\r\n\t\t\tcontroller: CreateProjectComponent,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<form> <div class=layoutForm> <div class=field> <eir-input-field-component label-name=\\\"Project Name\\\" field-value=ctrl.newProject.projectName validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{type: 'max-length', value: 128},\\r\\n\\t\\t\\t\\t\\t\\t{type: 'not-empty'}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t}\\\"/> </div> <div class=field> <eir-textarea-field-component label-name=Description field-value=ctrl.newProject.projectDescription validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{type: 'max-length', value: 2000}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t}\\\"/> </div> <eir-tag-dropdown class=light project=ctrl.newProject selected-tags=[]></eir-tag-dropdown> </div> <div id=newProject-container> <div class=template-header> <div id=page-template-header> <h4>Page Templates</h4> </div> <div class=separator /> </div> <div class=template-container> <div ng-repeat=\\\"template in ::ctrl.templates | orderBy:'idx'\\\" ng-class=\\\"{'selected': ctrl.newProject.templateNumber === template.idx}\\\" class=\\\"tmplListItem layoutTemplate\\\"> <input id=newProject-page-template-{{template.idx}} type=radio name=newProject-page-template ng-model=ctrl.newProject.templateNumber ng-value=template.idx /> <label for=newProject-page-template-{{template.idx}} ng-click=ctrl.selectTemplate(template)> <img ng-src={{::template.imgSrc}} alt=\\\"No image\\\"/> </label> </div> </div> </div> </form>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport {\r\n\tDashboardStates, DEFAULT_BOUNDARY, FlexSizeTypeEnum, INewProject,\r\n\tInjectNames, LanguageConsts, MimeTypes, Numbers, ProjectFileKeys,\r\n\tProjectLayout, SettingKeys,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IJsonDesignerMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport { IJsonLanguageComponent, ILanguage } from \"ng2/common/model/language.model\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { FileMetaData } from \"../../../../../app-builder/common/project/manifest/file-metadata\";\r\nimport { AppState } from \"../../../../app.state\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { IErrorResponse } from \"../../../../common/error-response\";\r\nimport { IValidatorError } from \"../../../../common/shared-components/base/field-validation\";\r\n\r\nimport { Helper } from \"../../../../common/helper\";\r\n\r\nimport { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport { DialogService } from \"../../../../common/services/dialog-service\";\r\nimport { FlexboxSettings } from \"../../../editor/component-settings/flexbox/flexbox-settings\";\r\nimport { EditorService } from \"../../../editor/services/editor-service\";\r\nimport { ProjectService } from \"../../../services/project-service\";\r\n\r\nexport class CreateToolbarComponent {\r\n\tpublic state: number;\r\n\tpublic newProject: INewProject;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.STATE_SERVICE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.PROJECT_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tprivate errorList: IValidatorError[];\r\n\tpublic get isDisabled(): boolean {\r\n\t\treturn this.errorList.length !== 0;\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tprivate $state: ng.ui.IStateService,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate projectService: ProjectService,\r\n\t\tprivate dialogService: DialogService,\r\n\t) {\r\n\t\tthis.$timeout(() => {\r\n\t\t\tangular.element(\"#new-project-name-field\").focus();\r\n\t\t}, 1);\r\n\t}\r\n\r\n\tpublic setState(): void {\r\n\t\tthis.state = DashboardStates.LIST;\r\n\t}\r\n\r\n\tpublic createProject(): void {\r\n\t\tconst hasError = !this.newProject.projectName\r\n\t\t\t|| !this.newProject.templateNumber;\r\n\r\n\t\tif (hasError) {\r\n\t\t\tthis.showCreateProjectErrorMessage(\"Please fill in a project name and choose a template\");\r\n\t\t} else {\r\n\t\t\tconst newProjectDatabearer = this.prepareNewProject(this.newProject);\r\n\r\n\t\t\tthis.projectService.createProject(newProjectDatabearer)\r\n\t\t\t\t.then((mashup: DesignerMashup) => {\r\n\t\t\t\t\tthis.editorService.clearIdCounter();\r\n\t\t\t\t\tthis.editorService.setCurrentBoundary(DEFAULT_BOUNDARY);\r\n\t\t\t\t\tthis.$state.go(AppState.EDITOR.name, {\r\n\t\t\t\t\t\tid: mashup.manifest.id,\r\n\t\t\t\t\t\treloadProject: true, // MUPS-2682: reloadProject\r\n\t\t\t\t\t});\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tthis.showCreateProjectErrorMessage(errorResponse.message);\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate prepareNewProject(newProjectDefinition: INewProject): IJsonDesignerMashup {\r\n\t\tconst manifest = new DesignerManifest(this.newProject.projectName, this.newProject.projectDescription);\r\n\t\tconst rootComponent = this.getTemplate(this.newProject.templateNumber);\r\n\t\tmanifest.fileMetaData[ProjectFileKeys.ROOT_COMPONENT] =\r\n\t\t\tnew FileMetaData(rootComponent.id, MimeTypes.COMPONENT);\r\n\t\tmanifest.mashupBoundaries = [DEFAULT_BOUNDARY];\r\n\t\tconst headerTranslations: ILanguage[] = [{\r\n\t\t\tlocale: LanguageConsts.DEFAULT.key,\r\n\t\t\tvalue: manifest.title\r\n\t\t}];\r\n\t\tconst translations: IJsonLanguageComponent[] = [\r\n\t\t\t{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tcomponentId: rootComponent.id,\r\n\t\t\t\tproperty: SettingKeys.APPLICATION_HEADER,\r\n\t\t\t\ttranslations: headerTranslations\r\n\t\t\t}\r\n\t\t];\r\n\t\tconst tags = newProjectDefinition.tags;\r\n\t\treturn { manifest, rootComponent, translations, tags };\r\n\t}\r\n\r\n\tprivate showCreateProjectErrorMessage(message: string): void {\r\n\t\tthis.dialogService.showError(\"Create New Project\", message);\r\n\t}\r\n\r\n\t// Page templates for new projects and insertions into layout components\r\n\t// TODO ids to better explained layouts\r\n\tprivate getTemplate(id: number): IJsonLayoutComponent {\r\n\t\tlet newIDs: string[];\r\n\t\tlet template: IJsonFlexbox;\r\n\r\n\t\tconst flexPanelClassName = \"Flexbox\";\r\n\t\tconst templateComponent = FlexboxSettings.getInstance().createWithoutPadding(\"AppPanel\");\r\n\t\tswitch (id) {\r\n\t\t\tcase ProjectLayout.ONE:\r\n\t\t\t\treturn templateComponent;\r\n\t\t\tcase ProjectLayout.TWO:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.TWO);\r\n\t\t\t\treturn this.buildTemplate(templateComponent, newIDs, OrientationEnum.HORIZONTAL);\r\n\t\t\tcase ProjectLayout.THREE:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.THREE);\r\n\t\t\t\treturn this.buildTemplate(templateComponent, newIDs, OrientationEnum.HORIZONTAL);\r\n\t\t\tcase ProjectLayout.FOUR:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.TWO);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs, OrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\t(template.children[0] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].sizeType =\r\n\t\t\t\t\tFlexSizeTypeEnum.PIXELS;\r\n\t\t\t\t(template.children[0] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].size =\r\n\t\t\t\t\tNumbers.THREE_HUNDRED;\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tcase ProjectLayout.FIVE:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.FOUR);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs.slice(0, Numbers.TWO), OrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\t(template.children[0] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].sizeType =\r\n\t\t\t\t\tFlexSizeTypeEnum.PIXELS;\r\n\t\t\t\t(template.children[0] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].size =\r\n\t\t\t\t\tNumbers.THREE_HUNDRED;\r\n\r\n\t\t\t\tthis.buildTemplate(template.children[1] as any, newIDs.slice(Numbers.TWO, Numbers.FOUR));\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tcase ProjectLayout.SIX:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.TWO);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs);\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tcase ProjectLayout.SEVEN:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.THREE);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs);\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tcase ProjectLayout.EIGHT:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.SIX);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs.slice(0, Numbers.TWO));\r\n\r\n\t\t\t\tthis.buildTemplate(\r\n\t\t\t\t\ttemplate.children[0] as any,\r\n\t\t\t\t\tnewIDs.slice(Numbers.TWO, Numbers.FOUR),\r\n\t\t\t\t\tOrientationEnum.HORIZONTAL);\r\n\t\t\t\tthis.buildTemplate(\r\n\t\t\t\t\ttemplate.children[1] as any,\r\n\t\t\t\t\tnewIDs.slice(Numbers.FOUR, Numbers.SIX),\r\n\t\t\t\t\tOrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tcase ProjectLayout.NINE:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.FOUR);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs.slice(0, Numbers.TWO));\r\n\r\n\t\t\t\tthis.buildTemplate(\r\n\t\t\t\t\ttemplate.children[0] as any,\r\n\t\t\t\t\tnewIDs.slice(Numbers.TWO, Numbers.FOUR),\r\n\t\t\t\t\tOrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tcase ProjectLayout.TEN:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.FOUR);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs.slice(0, Numbers.TWO));\r\n\r\n\t\t\t\tthis.buildTemplate(\r\n\t\t\t\t\ttemplate.children[1] as any,\r\n\t\t\t\t\tnewIDs.slice(Numbers.TWO, Numbers.FOUR),\r\n\t\t\t\t\tOrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tcase ProjectLayout.ELEVEN:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.THREE);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs);\r\n\r\n\t\t\t\t(template.children[1] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].size = Numbers.TWO;\r\n\t\t\t\t(template.children[Numbers.TWO] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].size = Numbers.TWO;\r\n\r\n\t\t\t\treturn template;\r\n\r\n\t\t\tcase ProjectLayout.TWELVE:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.SEVEN);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs.slice(0, Numbers.THREE));\r\n\r\n\t\t\t\t(template.children[1] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].size = Numbers.TWO;\r\n\t\t\t\t(template.children[Numbers.TWO] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].size = Numbers.TWO;\r\n\r\n\t\t\t\tthis.buildTemplate(\r\n\t\t\t\t\ttemplate.children[1] as any,\r\n\t\t\t\t\tnewIDs.slice(Numbers.THREE, Numbers.FIVE),\r\n\t\t\t\t\tOrientationEnum.HORIZONTAL);\r\n\t\t\t\tthis.buildTemplate(\r\n\t\t\t\t\ttemplate.children[Numbers.TWO] as any,\r\n\t\t\t\t\tnewIDs.slice(Numbers.FIVE, Numbers.SEVEN),\r\n\t\t\t\t\tOrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tcase ProjectLayout.THIRTEEN:\r\n\t\t\t\tnewIDs = this.generateIds(flexPanelClassName, Numbers.FOUR);\r\n\t\t\t\ttemplate = this.buildTemplate(templateComponent, newIDs.slice(0, Numbers.TWO));\r\n\t\t\t\ttemplate.boundarySettings[DEFAULT_BOUNDARY.id].orientation = OrientationEnum.VERTICAL;\r\n\r\n\t\t\t\t(template.children[1] as IJsonFlexbox).boundarySettings[DEFAULT_BOUNDARY.id].size = Numbers.FOUR;\r\n\r\n\t\t\t\tthis.buildTemplate(\r\n\t\t\t\t\ttemplate.children[1] as any,\r\n\t\t\t\t\tnewIDs.slice(Numbers.TWO, Numbers.FOUR),\r\n\t\t\t\t\tOrientationEnum.HORIZONTAL);\r\n\r\n\t\t\t\treturn template;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[DashboardCtrl] Invalid template chosen\");\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate buildTemplate(\r\n\t\ttemplate: IJsonFlexbox,\r\n\t\tnumberOfCells: string[],\r\n\t\torientation: OrientationEnum = OrientationEnum.VERTICAL\r\n\t): IJsonFlexbox {\r\n\t\tconst cells: IJsonFlexbox[] = [];\r\n\t\tfor (let i = 0; i < numberOfCells.length; i++) {\r\n\t\t\tcells[i] = FlexboxSettings.getInstance().create(numberOfCells[i]);\r\n\t\t\ttemplate.children.push(cells[i]);\r\n\t\t}\r\n\t\ttemplate.boundarySettings[DEFAULT_BOUNDARY.id].orientation = orientation;\r\n\t\treturn template;\r\n\t}\r\n\r\n\tprivate generateIds(componentTypeName: string, numberOfIds: number): string[] {\r\n\t\tconst newIDs: string[] = [];\r\n\r\n\t\tfor (let index = 0; index < numberOfIds; index++) {\r\n\t\t\tnewIDs[index] = componentTypeName + index;\r\n\t\t}\r\n\r\n\t\treturn newIDs;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirCreateToolbar\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tstate: \"=\",\r\n\t\t\t\tnewProject: \"<\",\r\n\t\t\t\terrorList: \"<\",\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./create-toolbar.html\"),\r\n\t\t\tcontroller: CreateToolbarComponent,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"toolbar has-title\\\"> <div class=title> <h1><span>New Project</span></h1> </div> <div class=buttonset> <button xi-button class=btn type=button ng-click=ctrl.setState();> Cancel </button> <button ng-disabled=ctrl.isDisabled ng-click=ctrl.createProject(); xi-button class=btn type=button> Create </button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { CanvasModeEnum, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { EditorService } from \"./editor/services/editor-service\";\r\n\r\nexport interface IComponentValueScope extends ng.IScope {\r\n\tcontent: any;\r\n}\r\n\r\nexport class ComponentValueController {\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic defaultValue: string  = \"<Empty>\";\r\n\r\n\tpublic showLabelEmpty: boolean;\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IComponentValueScope,\r\n\t\tprivate editorService: EditorService\r\n\t) { }\r\n\r\n\tpublic watchChange(): void {\r\n\t\tthis.scope.$watch(\"content\",\r\n\t\t\t() => {\r\n\t\t\t\tconst isRuntimeMode = this.editorService.getCanvasMode();\r\n\t\t\t\tthis.setLabel(isRuntimeMode);\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tthis.scope.$watch(\r\n\t\t\t() => {\r\n\t\t\t\treturn this.editorService.getCanvasMode();\r\n\t\t\t},\r\n\t\t\t(isRuntimeMode: CanvasModeEnum) => {\r\n\t\t\t\tthis.setLabel(isRuntimeMode);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tprivate setLabel(isRuntimeMode: CanvasModeEnum): void {\r\n\t\tconst rawJson = JSON.stringify(this.scope.content);\r\n\t\tif (rawJson) {\r\n\t\t\tif ((isRuntimeMode === CanvasModeEnum.SELECTION ||\r\n\t\t\t\tisRuntimeMode === CanvasModeEnum.INSERT) &&\r\n\t\t\t\trawJson.match(/\"\"/i)) {\r\n\t\t\t\tthis.showLabelEmpty = true;\r\n\t\t\t} else if (isRuntimeMode === CanvasModeEnum.RUNTIME\r\n\t\t\t) {\r\n\t\t\t\tthis.showLabelEmpty = false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class ComponentValueDirective implements ng.IDirective {\r\n\tscope = {\r\n\t\tcontent: \"=content\"\r\n\t};\r\n\r\n\ttemplate = \"{{!content && vm.showLabelEmpty ? vm.defaultValue : content }}\";\r\n\r\n\tcontroller = ComponentValueController;\r\n\tcontrollerAs = \"vm\";\r\n\r\n\tlink = (\r\n\t\tscope: IComponentValueScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattribute: ng.IAttributes,\r\n\t\tcontroller: ComponentValueController\r\n\t) => {\r\n\t\tcontroller.watchChange();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = () => new ComponentValueDirective();\r\n\r\n\t\tm.directive(\"eirComponentValue\", directive);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { colors } from \"ng2/common/constants/colors.constant\";\r\nimport {\r\n\tCanvasModeEnum,\r\n\tCSSClasses,\r\n\tInjectNames,\r\n\tSaveFlagsEnum,\r\n\tThemeEnum\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\nimport { Helper } from \"../../../common/helper\";\r\nimport { IComponentScope } from \"../../../common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"../../../common/interface/ilayout-component\";\r\nimport { ApplicationParent } from \"../../../components/application-parent\";\r\nimport { FrameworkService } from \"../../../components/services/framework-service\";\r\nimport { EditorApplicationParent } from \"../components/editor-application-parent\";\r\nimport { EditorLayoutComponentCtrl, IEditorLayoutComponent } from \"../components/editor-layout-component\";\r\nimport { EditorService } from \"../services/editor-service\";\r\nimport { InteractionManagementService } from \"../services/interaction-management-service\";\r\nimport { IUndoAction, UndoService } from \"../services/undo-service\";\r\n\r\nexport interface ICanvasStyle {\r\n\tbackgroundColor: String;\r\n\tbackgroundImage?: String;\r\n}\r\n\r\nexport class CanvasCtrl {\r\n\tpublic canvasMode: CanvasModeEnum;\r\n\tpublic currentTheme: ThemeEnum;\r\n\r\n\tpublic rootComponent: IJsonComponent;\r\n\tpublic parent: ApplicationParent;\r\n\tpublic context: IContext;\r\n\t// TODO: When undo redo is smarter, move template to canvas.html\r\n\tprivate originalComponentDirective = `\r\n\t\t<eir-component-directive\r\n\t\t\tng-if=\"eirCanvasCtrl.rootComponent\"\r\n\t\t\tcomponent=\"eirCanvasCtrl.rootComponent\"\r\n\t\t\tparent=\"eirCanvasCtrl.parent\"\r\n\t\t\tcontext=\"eirCanvasCtrl.context\"\r\n\t\t\tcomponent-ready=\"eirCanvasCtrl.onComponentReady(componentInstance)\"\r\n\t\t></eir-component-directive>`;\r\n\tpublic canvasStyle: ICanvasStyle = {backgroundColor: colors.slate08};\r\n\r\n\tprivate mashupRootContainer: ng.IAugmentedJQuery;\r\n\tprivate unsubscribers: Array<Function> = [];\r\n\tprivate renderComponentsTimeout: ng.IPromise<any>;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.ROOT_SCOPE,\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.UNDO_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $compile: ng.ICompileService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $rootScope: ng.IRootScopeService,\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate interactionManagementService: InteractionManagementService,\r\n\t\tprivate undoService: UndoService\r\n\t) {\r\n\r\n\t\tthis.mashupRootContainer = $element.find(\".\" + CSSClasses.mashupRootContainer);\r\n\t\t// Init the unsubscribers\r\n\t\tthis.initUnsubscribers();\r\n\r\n\t\t// Current project will always exist before controller initialization\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tthis.openProject(currentProject);\r\n\r\n\t\t// Init the canvas\r\n\t\tthis.initCanvas();\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Initiate the canvas to its correct values\r\n\t *\r\n\t * @private\r\n\t *\r\n\t * @memberof CanvasCtrl\r\n\t */\r\n\tprivate initCanvas(): void {\r\n\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\tthis.currentTheme = this.editorService.getCurrentCanvasTheme();\r\n\t\tthis.canvasStyle = this.getCanvasStyle(this.currentTheme);\r\n\t}\r\n\r\n\t/**\r\n\t * Initiate all the unsubscribers\r\n\t *\r\n\t * @private\r\n\t * @param {UndoService} undoService\r\n\t * @param {EditorService} editorService\r\n\t *\r\n\t * @memberof CanvasCtrl\r\n\t */\r\n\tprivate initUnsubscribers(): void {\r\n\t\tconst {undoService, editorService} = this;\r\n\t\tthis.unsubscribers.push(undoService.undoActionEvent.on((undoAction: IUndoAction) => {\r\n\t\t\tthis.updateCanvas(undoAction);\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(editorService.canvasModeChangedEvent.on((newMode: CanvasModeEnum) => {\r\n\t\t\tthis.canvasMode = newMode;\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(editorService.currentCanvasThemeChangedEvent.on((theme: ThemeEnum) => {\r\n\t\t\tthis.currentTheme = theme;\r\n\t\t\tthis.canvasStyle = this.getCanvasStyle(theme);\r\n\t\t}));\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the canvas styling depending on what the theme is\r\n\t *\r\n\t * @private\r\n\t * @param {ThemeEnum} theme\r\n\t * @returns {ICanvasStyle}\r\n\t *\r\n\t * @memberof CanvasCtrl\r\n\t */\r\n\tprivate getCanvasStyle(theme: ThemeEnum): ICanvasStyle {\r\n\t\tconst style: ICanvasStyle = {\r\n\t\t\tbackgroundColor: colors.graphite01\r\n\t\t};\r\n\t\tswitch (theme) {\r\n\t\t\tcase ThemeEnum.LIGHT:\r\n\t\t\t\tstyle.backgroundColor = colors.graphite01;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ThemeEnum.LIGHT_TRANSPARENT:\r\n\t\t\t\tstyle.backgroundColor = colors.graphite01;\r\n\t\t\t\tstyle.backgroundImage = `url(\"designer/images/transparent-grid.png\")`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ThemeEnum.DARK:\r\n\t\t\t\tstyle.backgroundColor = colors.slate08;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ThemeEnum.DARK_TRANSPARENT:\r\n\t\t\t\tstyle.backgroundColor = colors.slate08;\r\n\t\t\t\tstyle.backgroundImage = `url(\"designer/images/transparent-grid-light.png\")`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ThemeEnum.HIGH_CONTRAST:\r\n\t\t\t\tstyle.backgroundColor = colors.graphite03;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tstyle.backgroundColor = colors.graphite01;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn style;\r\n\t}\r\n\r\n\tprivate openProject(project: DesignerMashup): void {\r\n\t\tthis.parent = new EditorApplicationParent(\r\n\t\t\tApplicationParent.applicationParentDatabearer,\r\n\t\t\tApplicationParent.createSpoofedElement(this.$rootScope.$new() as IComponentScope),\r\n\t\t\tnull,\r\n\t\t\tthis.frameworkService);\r\n\t\tthis.context = {};\r\n\t\tthis.rootComponent = project.rootComponent;\r\n\t\tthis.compileComponent();\r\n\t\tthis.undoService.clearActions();\r\n\t\tthis.undoService.pushUndoAction(project);\r\n\t}\r\n\r\n\tpublic onComponentReady(componentInstance: ILayoutComponent): void {\r\n\t\tthis.$timeout.cancel(this.renderComponentsTimeout);\r\n\t\tthis.parent.addChildInstance(componentInstance);\r\n\t\tthis.editorService.setCurrentRootComponentInstance(componentInstance);\r\n\r\n\t\t//TODO: backwards compatibility, remove in the distant future\r\n\t\tthis.editorService.createLanguageComponentFromOldComponents();\r\n\r\n\t\tthis.interactionManagementService.runStartupInteractions();\r\n\t\t// New boundary entered will recursively update styles and classes\r\n\t\tcomponentInstance.newBoundaryEntered(this.editorService.getCurrentBoundary().id);\r\n\t\t//Trigger expressions on startup\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\r\n\t\tHelper.appIsReadyForSelenium();\r\n\t}\r\n\r\n\tprivate updateCanvas(undoAction: IUndoAction): void {\r\n\t\tconst component: IJsonLayoutComponent = undoAction.stateRootComponent;\r\n\t\tconst interactions: Interaction[] = undoAction.stateInteractions;\r\n\t\tconst translations: IMap<IJsonLanguageComponent[]> = undoAction.stateTranslations;\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\r\n\t\tcurrentProject.setRoot(component);\r\n\t\tthis.rootComponent = component;\r\n\t\t//sync translations, do not set\r\n\t\tthis.editorService.syncTranslations(translations);\r\n\t\tcurrentProject.setInteractions(interactions);\r\n\r\n\t\t// not saving canvas due to not wanting a new undo stack\r\n\t\t// tslint:disable:no-bitwise\r\n\t\tthis.editorService.saveCurrent(\r\n\t\t\tSaveFlagsEnum.CANVAS_COMPONENTS |\r\n\t\t\tSaveFlagsEnum.TRANSLATIONS |\r\n\t\t\tSaveFlagsEnum.INTERACTIONS\r\n\t\t);\r\n\t\t// tslint:enable:no-bitwise\r\n\t\tthis.compileComponent();\r\n\t\tthis.editorService.deselectComponent();\r\n\t}\r\n\r\n\tprivate compileComponent(): void {\r\n\t\tconst newScope = this.$scope.$new() as IComponentScope;\r\n\t\tnewScope.component = this.rootComponent;\r\n\t\tnewScope.parent = this.parent;\r\n\t\tnewScope.context = this.context;\r\n\t\tconst tenSecondsInMillis = 10000;\r\n\t\tthis.renderComponentsTimeout = this.$timeout(() => {\r\n\t\t\tif (this.parent.children.length < 1) {\r\n\t\t\t\t// Show error in dialog here for user\r\n\t\t\t\tthrow new Error(\"[Canvas] Problem opening project\");\r\n\t\t\t}\r\n\t\t}, tenSecondsInMillis);\r\n\t\tconst template = EditorLayoutComponentCtrl.createTemplate(this.rootComponent.typedef);\r\n\t\ttemplate.attr(\"component-ready\", \"eirCanvasCtrl.onComponentReady(componentInstance)\");\r\n\t\ttemplate.attr(\"component-destroyed\", \"eirCanvasCtrl.onComponentDestroyed(componentInstance)\");\r\n\r\n\t\tthis.$compile(template)(newScope, (clone) => {\r\n\t\t\tthis.mashupRootContainer.empty();\r\n\t\t\tthis.mashupRootContainer.append(clone);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onComponentDestroyed(component: IEditorLayoutComponent): void {\r\n\t\t// Rootcomponent gets destroyed when navigating to dashboard\r\n\t}\r\n}\r\n\r\nexport class CanvasDirective {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirCanvas\", [\r\n\t\t\t() => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tscope: {},\r\n\t\t\t\t\ttemplate: require(\"./canvas.html\"),\r\n\t\t\t\t\tcontroller: CanvasCtrl,\r\n\t\t\t\t\tcontrollerAs: \"eirCanvasCtrl\"\r\n\t\t\t\t};\r\n\t\t\t}]);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<eir-ruler class=noSelect></eir-ruler> <div id=insideRuler> <eir-titlebar></eir-titlebar> <div ng-style=eirCanvasCtrl.canvasStyle class=\\\"page-container mashupRootContainer\\\" ng-class=\\\"{ runtimeMode: eirCanvasCtrl.canvasMode === 0, \\r\\n\\t\\tselectionMode: eirCanvasCtrl.canvasMode === 1, \\r\\n\\t\\tinsertMode: eirCanvasCtrl.canvasMode === 2,\\r\\n\\t\\tfinderMode: eirCanvasCtrl.canvasMode === 3}\\\"> </div> <eir-resize-handler></eir-resize-handler> <eir-canvas-slider></eir-canvas-slider> </div> <eir-statusbar></eir-statusbar>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { DEFAULT_BOUNDARY, InjectNames, ProjectLimit, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { STANDARD_BOUNDARIES } from \"ng2/common/constants/standard-boundaries.constant\";\r\n\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult, IToastOptions } from \"common/services/dialog-service\";\r\nimport { BoundaryManagementService } from \"editor/services/boundary-management-service\";\r\nimport { EditorService } from \"editor/services/editor-service\";\r\nimport { IStandardBoundariesDialogParameter, StandardBoundariesCtrl } from \"editor/canvas//standard-boundaries-dialog\";\r\n\r\nimport \"jquery-ui/ui/widgets/draggable\";\r\n\r\nexport class CanvasSliderCtrl {\r\n\tstandardBoundaries: StandardBoundariesCtrl;\r\n\tprivate insideRulerElement: JQuery;\r\n\tprivate unsubscribers: Array<Function> = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.BOUNDARY_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate boundaryManagementService: BoundaryManagementService\r\n\t) {\r\n\r\n\t\tthis.insideRulerElement = $element.parent();\r\n\r\n\t\tthis.initDraggable();\r\n\r\n\t\tthis.unsubscribers.push(boundaryManagementService.newBoundaryAddedEvent.on((boundary: IBoundary) => {\r\n\t\t\tthis.positionCanvasResizer(boundary);\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(boundaryManagementService.boundaryMovedEvent.on((boundary: IBoundary) => {\r\n\t\t\tthis.positionCanvasResizer(boundary);\r\n\t\t}));\r\n\r\n\t\tthis.positionCanvasResizer(editorService.getCurrentBoundary());\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initDraggable(): void {\r\n\t\tconst dragCanvasWidth: JQueryUI.DraggableEvent = (event, ui) => {\r\n\t\t\tif (ui.position.left > 0) {\r\n\t\t\t\tconst margin: number = 18;\r\n\t\t\t\t//Moving 18px so the slider is inside the canvas\r\n\t\t\t\tthis.insideRulerElement.width(ui.position.left + margin);\r\n\t\t\t\tangular.element(window).trigger(\"resize\");\r\n\t\t\t} else {\r\n\t\t\t\tui.position.left = 0;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.$element.draggable({\r\n\t\t\taxis: \"x\",\r\n\t\t\tdrag: dragCanvasWidth.bind(this),\r\n\t\t\tstart: dragCanvasWidth.bind(this),\r\n\t\t\tcontainment: $(\"mashupCanvas\"),\r\n\t\t\tscroll: false,\r\n\t\t\tsnap: $(\".hBoundaryMarker\")\r\n\t\t});\r\n\t}\r\n\r\n\taddBoundaryMarker(): void {\r\n\t\tconst offsetX: number = angular.element(\"#insideRuler\").width();\r\n\t\tthis.boundaryManagementService.addNewBoundaryMarker(offsetX);\r\n\t}\r\n\r\n\tshowStandardBoundariesDialog(): void {\r\n\t\tconst projectBoundaries = this.editorService.getCurrentProject().getBoundaries();\r\n\t\tconst oldBoundaryIds: string[] = [];\r\n\t\tlet newBoundaryIds: string[] = [];\r\n\t\tconst addedboundaries: string[] = [];\r\n\t\tconst notAddedBoundaries: string[] = [];\r\n\t\tlet save: boolean = false;\r\n\t\t// Saving the old boundaries before the potential changed from the dialog\r\n\t\tSTANDARD_BOUNDARIES.forEach((standardBoundary: IBoundary) => {\r\n\t\t\tconst inProject = projectBoundaries.some((projectBoundary: IBoundary): boolean => {\r\n\t\t\t\treturn projectBoundary.id === standardBoundary.id &&\r\n\t\t\t\t\tprojectBoundary.displayName === standardBoundary.displayName;\r\n\t\t\t});\r\n\t\t\tif (inProject) {\r\n\t\t\t\toldBoundaryIds.push(standardBoundary.id);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst options: IDialogOptions<IStandardBoundariesDialogParameter> = {\r\n\t\t\ttitle: \"Standard Boundaries\",\r\n\t\t\ttemplate: require(\"./standard-boundaries-dialog.html\"),\r\n\t\t\tparameter: { standardBoundaries: STANDARD_BOUNDARIES, selectedStandardBoundaryIds: oldBoundaryIds }\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show<IStandardBoundariesDialogParameter, string[]>(options)\r\n\t\t\t.then((standardBoundariesDialogResult: IDialogResult<string[]>) => {\r\n\t\t\t\tif (standardBoundariesDialogResult.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tnewBoundaryIds = standardBoundariesDialogResult.value;\r\n\r\n\t\t\t\t\tSTANDARD_BOUNDARIES.forEach((boundary) => {\r\n\t\t\t\t\t\t//Remove first to make place for eventually new ones\r\n\t\t\t\t\t\tif (oldBoundaryIds.indexOf(boundary.id) !== -1 && newBoundaryIds.indexOf(boundary.id) === -1) {\r\n\t\t\t\t\t\t\tthis.boundaryManagementService.removeProjectBoundary(boundary);\r\n\t\t\t\t\t\t\tsave = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}).then(() => {\r\n\t\t\t\tSTANDARD_BOUNDARIES.forEach((boundary) => {\r\n\t\t\t\t\tif (oldBoundaryIds.indexOf(boundary.id) === -1 && newBoundaryIds.indexOf(boundary.id) !== -1) {\r\n\r\n\t\t\t\t\t\tconst numberOfBoundaries = this.editorService\r\n\t\t\t\t\t\t\t.getCurrentProject()\r\n\t\t\t\t\t\t\t.getBoundaries()\r\n\t\t\t\t\t\t\t.length;\r\n\r\n\t\t\t\t\t\tif (numberOfBoundaries < ProjectLimit.MAX_BOUNDARIES) {\r\n\t\t\t\t\t\t\tthis.boundaryManagementService.addProjectBoundary(boundary);\r\n\t\t\t\t\t\t\taddedboundaries.push(boundary.displayName);\r\n\t\t\t\t\t\t\tsave = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnotAddedBoundaries.push(boundary.displayName);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis.onMaxBoundariesReached(notAddedBoundaries);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tif (save) {\r\n\t\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.MANIFEST).then(() => {\r\n\t\t\t\t\t\tif (addedboundaries.length > 0) {\r\n\t\t\t\t\t\t\tconst options: IToastOptions = {\r\n\t\t\t\t\t\t\t\ttitle: \"New Boundary\",\r\n\t\t\t\t\t\t\t\tmessage: \"Successfully added the \" + addedboundaries.toString(),\r\n\t\t\t\t\t\t\t\tposition: \"top right\",\r\n\t\t\t\t\t\t\t\tprogressBar: true\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tthis.dialogService.showToast(options);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.onMaxBoundariesReached(notAddedBoundaries);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate onMaxBoundariesReached(boundaries: string[]): void {\r\n\t\tif (boundaries.length > 0) {\r\n\t\t\tconst title = \"Error\";\r\n\t\t\tconst message = `Unsuccessfully added ${boundaries.toString()}. ` +\r\n\t\t\t\t`Max boundaries are reached, try to delete one first.`;\r\n\t\t\tthis.dialogService.showError(title, message);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate positionCanvasResizer(boundary: IBoundary): void {\r\n\t\tif (boundary === DEFAULT_BOUNDARY) {\r\n\t\t\t// set back to default position. TODO: solv with ngClass?\r\n\t\t\tthis.insideRulerElement.width(\"\");\r\n\t\t\tthis.$element.css({ left: \"calc(100% - 18px)\" });\r\n\t\t} else {\r\n\t\t\tconst margin: number = 18;\r\n\t\t\tthis.insideRulerElement.width(boundary.limitX);\r\n\t\t\t//Moving 18px so the slider is inside the canvas\r\n\t\t\tthis.$element.css({ left: boundary.limitX - margin});\r\n\t\t}\r\n\t\tangular.element(window).trigger(\"resize\");\r\n\t}\r\n}\r\n\r\nexport class CanvasSliderDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirCanvasSlider\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tscope: {},\r\n\t\t\t\ttemplate: require(\"./canvas-slider.html\"),\r\n\t\t\t\tcontroller: CanvasSliderCtrl,\r\n\t\t\t\tcontrollerAs: \"eirCanvasSliderCtrl\",\r\n\t\t\t\treplace: true\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirStandardBoundariesCtrl as ctrl\\\"> <div ng-repeat=\\\"standardBoundary in ::ctrl.standardBoundaries track by standardBoundary.id\\\"> <div class=field-short> <input type=checkbox class=checkbox id=standardBoundariesDialog_{{standardBoundary.id}} ng-model=standardBoundary.selected> <label for=standardBoundariesDialog_{{standardBoundary.id}} class=checkbox-label>{{standardBoundary.displayName}}</label> <label class=checkbox-label style=float:right;margin-left:20px> {{standardBoundary.limitX}} px </label> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal-primary ng-click=ctrl.ok()>OK</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div id=canvasSlider data-html2canvas-ignore> <div id=boundaryAdder ng-click=eirCanvasSliderCtrl.addBoundaryMarker() xi-tooltip=\\\"{ content: 'Create new Boundary', placement: 'left' }\\\"></div> <div id=dragHandler></div> <div id=standardBoundaryAdder ng-click=eirCanvasSliderCtrl.showStandardBoundariesDialog() xi-tooltip=\\\"{ content: 'Add Standard Boundaries', placement: 'left' }\\\"></div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport { BindingTypes, InjectNames, ValueObject } from \"ng2/common/constants/common.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IAvailableSourceField } from \"../../../../../common/defines\";\r\nimport { ISourceItem } from \"../../../../../common/model/component/hyperlink.model\";\r\n\r\nimport { FrameworkService } from \"../../../../../components/services/framework-service\";\r\nimport { EditorService } from \"../../../services/editor-service\";\r\n\r\nexport interface IUrlSourceScope extends ng.IScope {\r\n\tsource: ISourceItem;\r\n\tavailableSources: IDataPair[];\r\n\tbuildLink(): () => {};\r\n\tchangeSourceAlias(item: INewOldAlias): () => {};\r\n\tremoveSource(item: ISourceItem): () => {};\r\n\tindex: string;\r\n}\r\n\r\nexport interface INewOldAlias {\r\n\toldAlias: string;\r\n\tnewAlias: string;\r\n}\r\n\r\nexport class UrlSourceFieldCtrl {\r\n\tpublic source: ISourceItem;\r\n\tpublic availableSources: IDataPair[] = [];\r\n\tpublic availableBindings: IAvailableSourceField[] = [];\r\n\tpublic currentSourceAlias: string;\r\n\tpublic componentName: string;\r\n\tpublic index: string;\r\n\tprivate unsubscribers: Function[] = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IUrlSourceScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate frameworkService: FrameworkService\r\n\t) {\r\n\t\tthis.source = $scope.source;\r\n\t\tthis.index = $scope.index;\r\n\t\tthis.availableSources = $scope.availableSources;\r\n\t\tthis.getAvailableBindings(true);\r\n\t\tthis.currentSourceAlias = angular.copy(this.source.alias);\r\n\t\tthis.setSourceName();\r\n\t\tthis.unsubscribers.push(editorService.hyperlinkAliasChangedEvent.on((alias) => {\r\n\t\t\t// Handle error (review this on SoHo 4.15)\r\n\t\t\tif (alias.index === this.index) {\r\n\t\t\t\tconst aliasElement = this.$element.find(\"#alias-id-\" + this.index);\r\n\t\t\t\tif (alias.new === \"\") {\r\n\t\t\t\t\taliasElement.addError({ message: \"Alias can not be empty.\" });\r\n\t\t\t\t} else if (alias.old === this.source.alias) {\r\n\t\t\t\t\taliasElement.addError({ message: \"Alias already exists.\" });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.source.alias = this.currentSourceAlias;\r\n\t\t\t\t\taliasElement.removeError();\r\n\t\t\t\t\tthis.$element.find(\".icon-error\").remove();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onChangeAlias(): void {\r\n\t\tif (this.currentSourceAlias !== this.source.alias) {\r\n\t\t\tconst aliases: INewOldAlias = {\r\n\t\t\t\toldAlias: this.source.alias,\r\n\t\t\t\tnewAlias: this.currentSourceAlias\r\n\t\t\t};\r\n\t\t\tthis.$scope.changeSourceAlias(aliases);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onBuildLink(): void {\r\n\t\tthis.$scope.buildLink();\r\n\t}\r\n\r\n\tpublic onRemoveSource(): void {\r\n\t\tthis.$scope.removeSource(this.source);\r\n\t}\r\n\r\n\tpublic getAvailableBindings(init: boolean = false): void {\r\n\t\tconst component = this.editorService.getComponentInstanceById(this.source.type);\r\n\t\tif (component) {\r\n\t\t\tcomponent.getBindingMetaData().then((availableBindings) => {\r\n\t\t\t\tthis.addSourceValue(availableBindings, init);\r\n\t\t\t});\r\n\t\t} else if (this.source.type === BindingTypes.CONTEXT) {\r\n\t\t\tconst selectedComponent = this.editorService.getSelectedComponent();\r\n\t\t\tselectedComponent.getContextMetaData().then((availableBindings) => {\r\n\t\t\t\tthis.addSourceValue(availableBindings, init);\r\n\t\t\t});\r\n\t\t\tthis.frameworkService.registerContextBinding(selectedComponent, \"linkvalue\", this.source.value, \"{$value}\");\r\n\t\t} else {\r\n\t\t\tthis.onRemoveSource();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addSourceValue(availableBindings: IAvailableSourceField[], init: boolean = false): void {\r\n\t\tthis.availableBindings = availableBindings;\r\n\t\tif (availableBindings.length > 0) {\r\n\t\t\tif (!init || this.source.value === \"\") {\r\n\t\t\t\tthis.source.value = availableBindings[0].sourceKey;\r\n\t\t\t}\r\n\t\t\tthis.onBuildLink();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setSourceName(): void {\r\n\t\t//Component name is used in UI\r\n\t\tif (this.source.type === BindingTypes.CONTEXT) {\r\n\t\t\tthis.componentName = ValueObject.TARGET_CONTEXT;\r\n\t\t} else {\r\n\t\t\tthis.componentName = this.editorService.getComponentInstanceById(this.source.type).getDisplayName();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class UrlSourceFieldDirective implements ng.IDirective {\r\n\ttemplate = require(\"./url-source-field.html\");\r\n\tscope = {\r\n\t\tsource: \"=\",\r\n\t\tavailableSources: \"<\",\r\n\t\tbuildLink: \"&\",\r\n\t\tremoveSource: \"&\",\r\n\t\tchangeSourceAlias: \"&\",\r\n\t\tindex: \"<\"\r\n\t};\r\n\tcontroller = UrlSourceFieldCtrl;\r\n\tcontrollerAs = \"eirUrlSourceFieldCtrl\";\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirUrlSourceField\", () => new UrlSourceFieldDirective());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=source-item> <div class=field> <input type=text class=input-sm ng-model=eirUrlSourceFieldCtrl.componentName disabled=disabled /> </div> <div class=source-input> <select class=\\\"dropdown dropdown-sm\\\" ng-model=eirUrlSourceFieldCtrl.source.value ng-change=eirUrlSourceFieldCtrl.onBuildLink() ng-options=\\\"availBinding.sourceKey as availBinding.visibleName for availBinding in eirUrlSourceFieldCtrl.availableBindings\\\" xi-drop-down> </select> </div> <div class=field> <input type=text class=input-sm id=alias-id-{{eirUrlSourceFieldCtrl.index}} ng-model=eirUrlSourceFieldCtrl.currentSourceAlias ng-change=eirUrlSourceFieldCtrl.onChangeAlias() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 400, 'blur': 0}}\\\"/> </div> <button class=btn-icon xi-tooltip=\\\"'Remove Source'\\\" ng-click=eirUrlSourceFieldCtrl.onRemoveSource()> <svg class=icon focusable=false> <use xlink:href=#icon-delete></use> </svg> <span class=audible>Remove Source</span> </button> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AppState } from \"../../app.state\";\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\n\r\nimport { CSSClasses, InjectNames, Numbers } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IDesignerMashup } from \"ng2/common/model/project/mashup/designer-mashup.model\";\r\nimport { ISidebarView, SidebarViewEnum } from \"./defines\";\r\n\r\nimport { DialogService } from \"../../common/services/dialog-service\";\r\nimport { EditorService } from \"./services/editor-service\";\r\nimport { UndoService } from \"./services/undo-service\";\r\n\r\nexport interface IEditorStateParameter extends ng.ui.IStateParamsService {\r\n\tid: string;\r\n\treloadProject?: string;\r\n}\r\n\r\nexport class EditorCtrl {\r\n\tpublic showEditor: boolean = false;\r\n\tpublic sidebarView: SidebarViewEnum;\r\n\tpublic isSidebarVisible: boolean;\r\n\r\n\tprivate windowResizeTimerPromise: ng.IPromise<void>;\r\n\tprivate unsubscribers: Array<Function> = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.STATE_PARAMS,\r\n\t\tAngularConstants.STATE_SERVICE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.UNDO_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\t$stateParams: IEditorStateParameter,\r\n\t\t$state: ng.ui.IStateService,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tundoService: UndoService,\r\n\t\tdialogService: DialogService\r\n\t) {\r\n\t\tconst params: IEditorStateParameter = $stateParams;\r\n\r\n\t\tif (params && params.id) {\r\n\t\t\tconst currentProject = editorService.getCurrentProject();\r\n\t\t\tconst reloadProject = params.reloadProject === \"true\";\r\n\r\n\t\t\tif (!reloadProject && currentProject &&\r\n\t\t\t\tcurrentProject.manifest.id === params.id\r\n\t\t\t) {\r\n\t\t\t\tthis.resetProjectState(currentProject);\r\n\t\t\t\tthis.showEditor = true;\r\n\t\t\t} else { // Load project\r\n\t\t\t\tif (currentProject) {\r\n\t\t\t\t\teditorService.removeCacheObject(currentProject.getId());\r\n\t\t\t\t}\r\n\r\n\t\t\t\teditorService.loadProject(params.id, this.getCanvasWidth())\r\n\t\t\t\t\t.then((designerMashup) => {\r\n\t\t\t\t\t\tundoService.clearActions();\r\n\t\t\t\t\t\teditorService.sidebarChangedEvent.raise(true);\r\n\t\t\t\t\t\tthis.showEditor = true;\r\n\t\t\t\t\t}).catch((e: any) => {\r\n\t\t\t\t\t\tconsole.error(\"[EditorCtrl] Failed to load project with ID \" + params.id, e);\r\n\t\t\t\t\t\tdialogService.showError(\r\n\t\t\t\t\t\t\t\"Unable to load project\",\r\n\t\t\t\t\t\t\t\"See console for details, you will be redirected to dashboard\"\r\n\t\t\t\t\t\t).then(() => {\r\n\t\t\t\t\t\t\t$state.go(AppState.HOME.name);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\teditorService.unloadProject();\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[EditorCtrl] No project ID was provided\");\r\n\t\t\t$state.go(AppState.HOME.name);\r\n\t\t}\r\n\r\n\t\teditorService.setView();\r\n\t\tconst sidebarView = editorService.getSidebarView();\r\n\t\tthis.sidebarView = sidebarView.view;\r\n\t\tthis.isSidebarVisible = sidebarView.isSidebarVisible;\r\n\r\n\t\tthis.unsubscribers.push(editorService.sidebarViewChangedEvent.on((view: ISidebarView) => {\r\n\t\t\tif (view) {\r\n\t\t\t\tthis.sidebarView = view.view;\r\n\t\t\t\tthis.isSidebarVisible = view.isSidebarVisible;\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tangular.element(window).bind(\"resize\", this.windowResizeHandler.bind(this));\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.element(window).unbind(\"resize\");\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Method to reset project to its startup states\r\n\t *\r\n\t * - Reset selected component\r\n\t * - Reset theme to manifest's default theme\r\n\t */\r\n\tprivate resetProjectState(project: IDesignerMashup): void {\r\n\t\tthis.editorService.deselectComponent();\r\n\r\n\t\tconst defaultTheme = (project.manifest as IJsonManifest).defaultTheme;\r\n\t\tthis.editorService.setCanvasTheme(defaultTheme);\r\n\r\n\t}\r\n\r\n\tprivate getCanvasWidth(): number {\r\n\t\tlet canvasWidth: number;\r\n\t\tconst rootContainer = angular.element(\".\" + CSSClasses.mashupRootContainer);\r\n\t\tif (rootContainer.length) {\r\n\t\t\tcanvasWidth = rootContainer.width();\r\n\t\t} else {\r\n\t\t\tconst canvasOffsetLeft = 319;\r\n\t\t\tcanvasWidth = window.innerWidth - canvasOffsetLeft;\r\n\t\t}\r\n\t\treturn canvasWidth;\r\n\t}\r\n\r\n\tprivate windowResizeHandler(): void {\r\n\t\tif (this.windowResizeTimerPromise) {\r\n\t\t\tthis.$timeout.cancel(this.windowResizeTimerPromise);\r\n\t\t}\r\n\t\tthis.windowResizeTimerPromise = this.$timeout(() => {\r\n\t\t\tthis.updateCurrentBoundary();\r\n\t\t}, Numbers.FIFTY);\r\n\t}\r\n\r\n\tprivate updateCurrentBoundary(): void {\r\n\t\tthis.editorService.updateCurrentBoundary(this.getCanvasWidth());\r\n\t}\r\n}\r\n\r\nexport class EditorDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirEditor\", () => {\r\n\t\t\treturn {\r\n\t\t\t\ttemplate: require(\"./editor.html\"),\r\n\t\t\t\tcontroller: EditorCtrl,\r\n\t\t\t\tcontrollerAs: \"eirEditorCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=chrome-canvas ng-if=eirEditorCtrl.showEditor> <eir-topbar></eir-topbar> <div class=canvas-content> <eir-new-component-tabs class=sidebar ng-if=\\\"eirEditorCtrl.isSidebarVisible && eirEditorCtrl.sidebarView.value === 'newcomponent'\\\"></eir-new-component-tabs> <eir-settings class=sidebar ng-if=\\\"eirEditorCtrl.isSidebarVisible && eirEditorCtrl.sidebarView.value === 'settings'\\\"></eir-settings> <eir-canvas id=mainCanvas></eir-canvas> </div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport {\r\n\tCanvasModeEnum, CssConstantKeys, CssConstantValues,\r\n\tEventTypes, InjectNames, InsertEventTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { IJQueryDragEventObject } from \"../../../../common/defines\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport { Defines, IComponentListEntry } from \"../../../../components/defines\";\r\nimport { ComponentsHelper } from \"../../../../components/helper\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport { ComponentSettingsCtrl } from \"../../component-settings/component-settings\";\r\nimport { ISettingsClassInstance } from \"../../defines\";\r\nimport { EditorHelper } from \"../../helper\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { InsertComponentService } from \"../../services/insert-component-service\";\r\n\r\nexport class NewComponentCtrl {\r\n\tpublic components: IMap<IComponentListEntry>;\r\n\tpublic selectedNewComponent: IJsonComponent;\r\n\r\n\tprivate unsubscribers: Function[] = [];\r\n\tprivate bodyElement: ng.IAugmentedJQuery;\r\n\tprivate designerElement: ng.IAugmentedJQuery;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.INSERT_COMPONENT_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\t$scope: ng.IScope,\r\n\t\t$timeout: ng.ITimeoutService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate insertComponentService: InsertComponentService,\r\n\t\tprivate translationManagementService: TranslationManagementService\r\n\t) {\r\n\t\tthis.bodyElement = angular.element(\"body\");\r\n\t\tthis.designerElement = angular.element(\"#designer\");\r\n\t\tthis.components = Defines.allComponents;\r\n\r\n\t\tthis.unsubscribers.push(editorService.canvasModeChangedEvent.on((canvasMode) => {\r\n\t\t\tif (canvasMode !== CanvasModeEnum.INSERT && this.selectedNewComponent) {\r\n\t\t\t\tthis.insertComponentService.cancelInserting();\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\t// Timeout needed to wait for ng-repeat, alternative is to create new controller for registering startdragevent\r\n\t\t$timeout(() => {\r\n\t\t\t$(\".newComponent\").on(EventTypes.DRAGSTART, (event: IJQueryDragEventObject) => {\r\n\t\t\t\tthis.selectDrag(event);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tconst bodyClickListener = this.cancel.bind(this);\r\n\t\tthis.designerElement.on(EventTypes.CLICK, bodyClickListener);\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tthis.designerElement.off(EventTypes.CLICK, bodyClickListener);\r\n\t\t\tthis.cancel();\r\n\t\t\tthis.unsubscribers.forEach((unsubscriber) => {\r\n\t\t\t\tunsubscriber();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate cancel(): void {\r\n\t\tif (this.selectedNewComponent) {\r\n\t\t\tthis.insertComponentService.cancelInserting();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic selectDrag(event: IJQueryDragEventObject): void {\r\n\t\tconst target = $(event.target);\r\n\t\tconst className = target.data(\"componentClass\");\r\n\t\tif (Helper.isSafari() || Helper.isEdge()) {\r\n\t\t\t$(\".componentIconOverlay\").css(CssConstantKeys.CURSOR, \"no-drop\");\r\n\t\t}\r\n\t\tthis.select(className);\r\n\t}\r\n\r\n\tpublic selectClick(className: string): void {\r\n\t\tconst insertComponent = this.insertComponentService.getInsertComponent();\r\n\t\tif (insertComponent && insertComponent.typedef === className) {\r\n\t\t\t// Deselect\r\n\t\t\tthis.insertComponentService.cancelInserting();\r\n\t\t\tthis.resetToSelectionMode();\r\n\t\t} else {\r\n\t\t\tthis.bodyElement.css(CssConstantKeys.CURSOR, CssConstantValues.CURSOR_NODROP);\r\n\t\t\tthis.select(className);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate resetToSelectionMode(): void {\r\n\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\tdelete this.selectedNewComponent;\r\n\t\tthis.bodyElement.css(CssConstantKeys.CURSOR, CssConstantValues.AUTO);\r\n\t}\r\n\r\n\tprivate select(className: string): void {\r\n\t\tlet newComponent: IJsonComponent;\r\n\t\tconst newId = this.editorService.generateId(ComponentsHelper.getComponentDisplayName(className));\r\n\t\tconst componentSettingsClass: ISettingsClassInstance = EditorHelper.getComponentSettingsClass(className);\r\n\t\t//If component has a settingclass on its own\r\n\t\tif (componentSettingsClass) {\r\n\t\t\tnewComponent = componentSettingsClass.create(newId);\r\n\t\t} else {\r\n\t\t\tconst componentClass = Defines.allComponents[className].class;\r\n\t\t\tnewComponent = ComponentSettingsCtrl.create(newId, componentClass);\r\n\t\t}\r\n\t\tthis.selectedNewComponent = newComponent;\r\n\r\n\t\tthis.insertComponentService.startInserting(newComponent, InsertEventTypes.COPY).then(() => {\r\n\t\t\t// A component was inserted\r\n\t\t\tthis.translationManagementService.createDefaultLanguageComponents(newComponent);\r\n\t\t\tthis.editorService.saveCanvas();\r\n\t\t\tthis.resetToSelectionMode();\r\n\t\t}).catch(() => {\r\n\t\t\t// Remain in insert mode when clicking on a new component type\r\n\t\t\tif (this.selectedNewComponent && this.selectedNewComponent.typedef === newComponent.typedef) {\r\n\t\t\t\tthis.resetToSelectionMode();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class NewComponentDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirNewComponent\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tscope: true,\r\n\t\t\t\ttemplate: require(\"./new-component.html\"),\r\n\t\t\t\tcontroller: NewComponentCtrl,\r\n\t\t\t\tcontrollerAs: \"eirNewComponentCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=components> <div class=componentIcon ng-repeat=\\\"(className, component) in eirNewComponentCtrl.components\\\" ng-if=component.available ng-click=eirNewComponentCtrl.selectClick(className);$event.stopPropagation(); ng-class=\\\"{selected: eirNewComponentCtrl.selectedNewComponent.typedef === className}\\\"> <label class=title>{{(component.displayName ? component.displayName : className)}}</label> <span class=\\\"image image-{{className}}\\\"></span> <span class=extra-{{className}}></span> <div class=\\\"componentIconOverlay newComponent\\\" draggable=true data-component-class={{className}}> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { CanvasModeEnum, InjectNames, InsertEventTypes, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonCompositeComponent, IJsonCompositeComponentManifest } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\nimport { Helper } from \"../../../../common/helper\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { InsertComponentService } from \"../../services/insert-component-service\";\r\nimport { InteractionManagementService } from \"../../services/interaction-management-service\";\r\n\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport { CompositeComponentManagementService } from \"../../services/composite-component-management-service\";\r\n\r\nexport class NewCompositeCtrl {\r\n\tpublic selectedComponent: IEditorComponent;\r\n\tpublic htmlEncode = Helper.htmlEncode;\r\n\tpublic selectedManifest: IJsonCompositeComponentManifest;\r\n\tpublic compositeComponents: IJsonCompositeComponent[];\r\n\tpublic compositeComponentManifests: IJsonCompositeComponentManifest[];\r\n\r\n\tprivate unsubscribers: Function[] = [];\r\n\tprivate bodyClickListener: (eventObject: JQueryEventObject, ...args: any[]) => any;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.INSERT_COMPONENT_SERVICE,\r\n\t\tInjectNames.COMPOSITE_COMPONENT_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\t$scope: ng.IScope,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate insertComponentService: InsertComponentService,\r\n\t\tprivate compositeComponentManagementService: CompositeComponentManagementService,\r\n\t\tprivate interactionManagementService: InteractionManagementService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t) {\r\n\r\n\t\tthis.unsubscribers.push(editorService.compositeComponentsChangedEvent\r\n\t\t\t.on((compositeComponents: IJsonCompositeComponent[]) => {\r\n\t\t\t\tthis.updateCompositeComponents(compositeComponents);\r\n\t\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(editorService.canvasModeChangedEvent.on((canvasMode) => {\r\n\t\t\tif (canvasMode !== CanvasModeEnum.INSERT && this.selectedManifest) {\r\n\t\t\t\tthis.insertComponentService.cancelInserting();\r\n\t\t\t\tthis.selectedManifest = null;\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis.editorService.selectedComponentChangedEvent.on((component: IEditorComponent) => {\r\n\t\t\tthis.selectedComponent = component;\r\n\t\t});\r\n\t\tthis.selectedComponent = editorService.getSelectedComponent();\r\n\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tthis.updateCompositeComponents(currentProject.getCompositeComponents());\r\n\r\n\t\tthis.bodyClickListener = this.cancel.bind(this);\r\n\t\tangular.element(\"body\").on(\"click\", this.bodyClickListener);\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tthis.unsubscribers.forEach((unsubscriber) => {\r\n\t\t\t\tunsubscriber();\r\n\t\t\t});\r\n\t\t\tangular.element(\"body\").off(\"click\", this.bodyClickListener);\r\n\t\t\tthis.cancel();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate cancel(): void {\r\n\t\tif (this.selectedManifest) {\r\n\t\t\tthis.insertComponentService.cancelInserting();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic manageCompositeComponents(): void {\r\n\t\tthis.compositeComponentManagementService.manageCompositeComponents();\r\n\t}\r\n\r\n\tprivate updateCompositeComponents(compositeComponents: IJsonCompositeComponent[]): void {\r\n\t\tthis.compositeComponents = compositeComponents;\r\n\t\tthis.compositeComponentManifests =\r\n\t\t\tthis.compositeComponents.map((compositeComponent) => { return compositeComponent.manifest; });\r\n\t}\r\n\r\n\tpublic createComposite(): void {\r\n\t\tthis.compositeComponentManagementService.createNewViaWizard(this.selectedComponent.getDatabearer());\r\n\t}\r\n\r\n\tpublic deleteComposite(compositeId: string): void {\r\n\t\tthis.compositeComponentManagementService.removeViaDialog(compositeId);\r\n\t}\r\n\r\n\tpublic selectDrag(id: string): void {\r\n\t\tthis.select(id);\r\n\t}\r\n\r\n\tpublic selectClick(id: string): void {\r\n\t\tangular.element(\"body\").css(\"cursor\", \"no-drop\");\r\n\t\tif (this.selectedManifest && this.selectedManifest.id === id) {\r\n\t\t\t// Deselect\r\n\t\t\tthis.insertComponentService.cancelInserting();\r\n\t\t\tthis.selectedManifest = null;\r\n\t\t} else {\r\n\t\t\tthis.select(id);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getCompositeComponentById(id: string): IJsonCompositeComponent {\r\n\t\treturn this.compositeComponents.find((composite) => {\r\n\t\t\treturn composite.manifest.id === id;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate redirectInteraction(interaction: IJsonInteraction, oldToNewIdMap: IMap<string>): void {\r\n\t\tinteraction.sourceName = oldToNewIdMap[interaction.sourceName];\r\n\t\tinteraction.targetName = oldToNewIdMap[interaction.targetName];\r\n\t\tif (interaction.parameters) {\r\n\t\t\tinteraction.parameters.forEach((parameter) => {\r\n\t\t\t\tparameter.valueSource.sourceName = oldToNewIdMap[parameter.valueSource.sourceName];\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate redirectExpression(expression: IJsonExpression, oldToNewIdMap: IMap<string>): void {\r\n\t\tif (expression.source !== \"<static>\" && expression.source !== \"Application\") {\r\n\t\t\texpression.source = oldToNewIdMap[expression.source];\r\n\t\t}\r\n\t\tif (expression.target !== \"<static>\" && expression.target !== \"Application\") {\r\n\t\t\texpression.target = oldToNewIdMap[expression.target];\r\n\t\t}\r\n\r\n\t\texpression.usedBy = oldToNewIdMap[expression.usedBy];\r\n\t}\r\n\r\n\tprivate select(id: string): void {\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tconst compositeComponent = this.getCompositeComponentById(id);\r\n\t\tthis.selectedManifest = compositeComponent.manifest;\r\n\t\tthis.compositeComponentManagementService.setCurrentValuesToCurrentLanguage(compositeComponent);\r\n\t\tconst oldToNewIdMap: IMap<string> = {};\r\n\t\tconst newComponent = this.editorService.copy(compositeComponent.component, oldToNewIdMap);\r\n\t\tconst addedDatasources: IJsonDatasource[] = [];\r\n\t\tconst addedInteractions: Interaction[] = [];\r\n\r\n\t\tif (compositeComponent.datasources) {\r\n\t\t\tcompositeComponent.datasources.forEach((datasource) => {\r\n\t\t\t\tif (!currentProject.getDatasource(datasource.id)) {\r\n\t\t\t\t\tcurrentProject.addDatasource(datasource);\r\n\t\t\t\t\taddedDatasources.push(datasource);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (compositeComponent.interactions) {\r\n\t\t\tangular.copy(compositeComponent.interactions).forEach((interactionCopy) => {\r\n\t\t\t\tthis.redirectInteraction(interactionCopy, oldToNewIdMap);\r\n\t\t\t\tinteractionCopy.id = this.interactionManagementService.generateInteractionId();\r\n\t\t\t\tconst newInteraction = new Interaction(interactionCopy);\r\n\t\t\t\tcurrentProject.addInteraction(newInteraction);\r\n\t\t\t\taddedInteractions.push(newInteraction);\r\n\t\t\t});\r\n\r\n\t\t\tthis.interactionManagementService.projectInteractionsChanged\r\n\t\t\t\t.raise(currentProject.getInteractions());\r\n\t\t}\r\n\t\tthis.insertComponentService.startInserting(newComponent, InsertEventTypes.COPY).then(() => {\r\n\t\t\t// CompositeComponent was inserted\r\n\t\t\tif (compositeComponent.translations) {\r\n\t\t\t\tthis.editorService.copyTranslationsToCurrentProject(\r\n\t\t\t\t\tcompositeComponent.translations,\r\n\t\t\t\t\toldToNewIdMap,\r\n\t\t\t\t\tnewComponent\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.editorService.forEachComponent(newComponent, (child) => {\r\n\t\t\t\t\tthis.translationManagementService.createDefaultLanguageComponents(child);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (compositeComponent.expressions) {\r\n\t\t\t\tangular.copy(compositeComponent.expressions).forEach((expressionCopy) => {\r\n\t\t\t\t\tthis.redirectExpression(expressionCopy, oldToNewIdMap);\r\n\t\t\t\t\texpressionCopy.id = Helper.generateUniqueId();\r\n\t\t\t\t\tif (expressionCopy.source && expressionCopy.target) {\r\n\t\t\t\t\t\tcurrentProject.addExpression(expressionCopy);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t/* tslint:disable:no-bitwise */\r\n\t\t\tthis.editorService.saveCanvas();\r\n\t\t\tthis.editorService.saveCurrent(\r\n\t\t\t\tSaveFlagsEnum.DATASOURCES |\r\n\t\t\t\tSaveFlagsEnum.INTERACTIONS |\r\n\t\t\t\tSaveFlagsEnum.TRANSLATIONS |\r\n\t\t\t\tSaveFlagsEnum.EXPRESSIONS\r\n\t\t\t);\r\n\t\t\t/* tslint:enable:no-bitwise */\r\n\t\t}).catch(() => {\r\n\t\t\taddedDatasources.forEach((datasource) => {\r\n\t\t\t\tcurrentProject.removeDatasource(datasource.id);\r\n\t\t\t});\r\n\t\t\taddedInteractions.forEach((interaction) => {\r\n\t\t\t\tcurrentProject.removeInteraction(interaction);\r\n\t\t\t});\r\n\t\t}).finally(() => {\r\n\t\t\tif (this.selectedManifest && this.selectedManifest.id === id) { // Just inserted composite\r\n\t\t\t\tthis.selectedManifest = null;\r\n\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\t\t\tangular.element(\"body\").css(\"cursor\", \"auto\");\r\n\t\t\t} else if (!this.selectedManifest) { // Deselected composite\r\n\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\t\t\tangular.element(\"body\").css(\"cursor\", \"auto\");\r\n\t\t\t} else { // New composite selected\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class NewCompositeDirective {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirNewComposite\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tscope: true,\r\n\t\t\t\ttemplate: require(\"./new-composite.html\"),\r\n\t\t\t\tcontroller: NewCompositeCtrl,\r\n\t\t\t\tcontrollerAs: \"eirNewCompositeCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=components> <div class=componentIcon xi-tooltip=::eirNewCompositeCtrl.htmlEncode(manifest.displayName) ng-repeat=\\\"manifest in eirNewCompositeCtrl.compositeComponentManifests\\\" ng-dragstart=\\\"eirNewCompositeCtrl.selectDrag(manifest.id); $event.stopPropagation();\\\" ng-click=\\\"eirNewCompositeCtrl.selectClick(manifest.id); $event.stopPropagation();\\\" ng-mouseenter=\\\"showMenu=true\\\" ng-mouseleave=\\\"showMenu=false\\\" ng-class=\\\"{selected: eirNewCompositeCtrl.selectedManifest.id === manifest.id}\\\"> <label class=title>{{manifest.displayName}}</label> <span class=\\\"image image-{{eirNewCompositeCtrl.compositeComponents[$index].component.typedef}}\\\"></span> <span class=extra-{{eirNewCompositeCtrl.compositeComponents[$index].component.id}}></span> <div class=componentIconOverlay draggable=true> <div class=actions ng-if=showMenu> <button class=\\\"btn-actions composite-btn-menu\\\" ng-click=eirNewCompositeCtrl.deleteComposite(manifest.id)> <svg class=icon focusable=false> <use xlink:href=#icon-delete></use> </svg> <span class=audible>Actions</span> </button> </div> </div> </div> <div id=below-components> <label class=no-components-label ng-show=\\\"eirNewCompositeCtrl.compositeComponentManifests.length === 0\\\">No composite components on current project</label> <button class=\\\"btn-tertiary add-composite-btn\\\" ng-disabled=!eirNewCompositeCtrl.selectedComponent ng-click=eirNewCompositeCtrl.createComposite()> <svg role=presentation aria-hidden=true focusable=false class=icon> <use xlink:href=#icon-add-comp /> </svg> <span>Create New</span> </button> </div> <div class=manage-link> <button class=hyperlink xi-tooltip=\\\"'Manage Composite Components'\\\" ng-click=eirNewCompositeCtrl.manageCompositeComponents()> Manage Composite Components </button> </div> </div> \";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { EditorService } from \"../services/editor-service\";\r\n\r\nexport class NewComponentTabsCtrl {\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\t$scope: ng.IScope,\r\n\t\tprivate editorService: EditorService\r\n\t) { }\r\n\r\n\tpublic hideSidebar(): void {\r\n\t\tthis.editorService.setSidebarVisibility(false);\r\n\t}\r\n}\r\n\r\nexport class NewComponentTabsDirective {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirNewComponentTabs\", () => {\r\n\t\t\treturn {\r\n\t\t\t\ttemplate: require(\"./new-component-tabs.html\"),\r\n\t\t\t\tcontroller: NewComponentTabsCtrl,\r\n\t\t\t\tcontrollerAs: \"eirNewComponentTabsCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=sidebar-header> <div class=headline> <h3>Components</h3> <div class=\\\"buttonContainer sidebar-options\\\"> <button class=btn-icon ng-click=eirNewComponentTabsCtrl.hideSidebar() ng-disabled=eirNewComponentTabsCtrl.showOverlay xi-tooltip=\\\"'Close'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-close></use> </svg> <span>Hide</span> </button> </div> </div> </div> <div class=sidebar-content> <div id=new-component-tabs class=tab-container xi-tabs> <ul class=tab-list> <li class=tab> <a href=#new-component-tabs-components>Basic</a> </li> <li class=tab> <a href=#new-component-tabs-composite>Composite</a> </li> </ul> <div id=new-component-tabs-components> <eir-new-component></eir-new-component> </div> <div id=new-component-tabs-composite> <eir-new-composite></eir-new-composite> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nimport { DEFAULT_BOUNDARY, InjectNames, Numbers, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { IJQueryDragEventObject } from \"common/defines\";\r\nimport { STANDARD_BOUNDARIES, STANDARD_ID_PREFIX } from \"ng2/common/constants/standard-boundaries.constant\";\r\n\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult,\r\n\tIMessageDialogOptions, StandardDialogButtons\r\n} from \"common/services/dialog-service\";\r\nimport { BoundaryManagementService } from \"editor/services/boundary-management-service\";\r\nimport { EditorService } from \"editor/services/editor-service\";\r\n\r\nexport class RulerCtrl {\r\n\tcurrentBoundary: IBoundary;\r\n\tprojectBoundaries: IBoundary[];\r\n\tprivate unsubscribers: Array<Function> = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.BOUNDARY_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate boundaryManagementService: BoundaryManagementService\r\n\t) {\r\n\r\n\t\tthis.unsubscribers.push(editorService.currentBoundaryChangedEvent.on((boundary: IBoundary) => {\r\n\t\t\tthis.currentBoundary = boundary;\r\n\t\t}));\r\n\t\tthis.currentBoundary = editorService.getCurrentBoundary();\r\n\r\n\t\tthis.unsubscribers.push(editorService.projectBoundariesChangedEvent.on((boundaries: IBoundary[]) => {\r\n\t\t\tthis.projectBoundaries = boundaries;\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\tthis.initBoundaryDraggable();\r\n\t\t\t}, Numbers.TEN);\r\n\t\t}));\r\n\r\n\t\t// Current project always exists before controller\r\n\t\tthis.onCurrentProjectChanged(editorService.getCurrentProject());\r\n\r\n\t\t$timeout(() => {\r\n\t\t\tthis.initBoundaryDraggable();\r\n\t\t}, Numbers.TWO_HUNDRED);\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.convertOldStandardBoundariesToNormalBoundaries();\r\n\t}\r\n\r\n\t/**\r\n\t * Backward compatiblity method. Turn previous standard boundaries to normal boundaries\r\n\t */\r\n\tprivate convertOldStandardBoundariesToNormalBoundaries(): void {\r\n\t\tconst projectBoundaries = this.boundaryManagementService.getProjectBoundaries();\r\n\t\tprojectBoundaries.forEach((projectBoundary) => {\r\n\t\t\tif (projectBoundary.id.indexOf(STANDARD_ID_PREFIX) === 0 &&\r\n\t\t\t\t!STANDARD_BOUNDARIES.find((standardBoundary) => {\r\n\t\t\t\t\treturn projectBoundary.displayName === standardBoundary.displayName;\r\n\t\t\t\t})) {\r\n\t\t\t\tprojectBoundary.id = this.boundaryManagementService.generateBoundaryId();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate onCurrentProjectChanged(newProject: DesignerMashup): void {\r\n\t\tthis.projectBoundaries = newProject.manifest.mashupBoundaries;\r\n\t}\r\n\r\n\tprivate isSingleClick: boolean;\r\n\r\n\tboundaryClick(boundary: IBoundary, $event: Event): void {\r\n\t\tthis.isSingleClick = true;\r\n\t\tthis.$timeout(() => {\r\n\t\t\tif (this.isSingleClick) {\r\n\t\t\t\tthis.selectBoundary(boundary, $event);\r\n\t\t\t}\r\n\t\t}, Numbers.TWO_HUNDRED);\r\n\t}\r\n\r\n\tboundaryDblClick(boundary: IBoundary): void {\r\n\t\tthis.isSingleClick = false; // To prevent single click trigger\r\n\t\tthis.boundaryMarkerEditor(boundary);\r\n\t}\r\n\r\n\tprivate selectBoundary(boundary: IBoundary, $event?: Event): void {\r\n\t\t// check if boundary marker is being dragged to prevent click on drop\r\n\t\tif ($event && $event.target && $($event.target).data(\"dragStop\") === true) {\r\n\t\t\t$($event.target).data(\"dragStop\", false);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// if boundary already selected - unmark back to default.\r\n\t\tboundary = boundary === this.editorService.getCurrentBoundary() ? DEFAULT_BOUNDARY : boundary;\r\n\t\t// Select boundary\r\n\t\tthis.boundaryManagementService.goToCurrentBoundaryMarker(boundary);\r\n\t\tthis.editorService.setCurrentBoundary(boundary);\r\n\t}\r\n\r\n\ttoggleDefaultBoundary(): void {\r\n\t\tthis.selectBoundary(DEFAULT_BOUNDARY);\r\n\t}\r\n\r\n\tprivate initBoundaryDraggable(): void {\r\n\t\tthis.projectBoundaries.forEach((boundary: IBoundary) => {\r\n\t\t\tif (!this.boundaryManagementService.isBoundaryReadOnly(boundary)) {\r\n\t\t\t\tthis.$element.find(\"#\" + boundary.id).draggable({\r\n\t\t\t\t\taxis: \"x\",\r\n\t\t\t\t\tcontainment: \"parent\",\r\n\r\n\t\t\t\t\tdrag: (event: Event, ui: JQueryUI.DraggableEventUIParams) => {\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\tconst boundaryId = ui.helper.attr(\"id\");\r\n\t\t\t\t\t\tconst boundary = this.boundaryManagementService.getBoundary(boundaryId);\r\n\t\t\t\t\t\tlet offsetX = ui.position.left;\r\n\t\t\t\t\t\tconst oldOffsetX = boundary.limitX;\r\n\r\n\t\t\t\t\t\toffsetX = Math.round(offsetX / Numbers.TEN) * Numbers.TEN;\r\n\t\t\t\t\t\tboundary.limitX = offsetX;\r\n\r\n\t\t\t\t\t\tif (offsetX !== oldOffsetX) {\r\n\t\t\t\t\t\t\tthis.boundaryManagementService.boundaryMovedEvent.raise(boundary);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tstop: (event: IJQueryDragEventObject, ui: JQueryUI.DraggableEventUIParams) => {\r\n\t\t\t\t\t\t$(event.originalEvent.target).data(\"dragStop\", true);\r\n\t\t\t\t\t\tthis.$scope.$evalAsync();\r\n\t\t\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.MANIFEST);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate boundaryMarkerEditor(boundary: IBoundary): void {\r\n\t\tif (!this.boundaryManagementService.isBoundaryReadOnly(boundary)) {\r\n\t\t\tconst options: IDialogOptions<IBoundary> = {\r\n\t\t\t\ttitle: \"Edit Boundary Marker\",\r\n\t\t\t\ttemplate: require(\"./boundary-editor-dialog/boundary-editor-dialog.html\"),\r\n\t\t\t\tparameter: angular.copy(boundary) // Copy to avoid setting value before Save is pressed\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<IBoundary>) => {\r\n\t\t\t\tif (result && result.button === DialogButtonType.Ok &&\r\n\t\t\t\t\tJSON.stringify(result.value) !== JSON.stringify(angular.copy(boundary))) {\r\n\t\t\t\t\tthis.boundaryManagementService.updateBoundaryMarker(result.value);\r\n\t\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.MANIFEST);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tsetBoundaryMarker($event: JQueryEventObject): void {\r\n\t\tlet offsetX = $event.offsetX;\r\n\t\toffsetX = Math.round(offsetX / Numbers.TEN) * Numbers.TEN;\r\n\r\n\t\t// Pressed scalenumber\r\n\t\tif ($event.target.classList.contains(\"scaleNumber\")) {\r\n\t\t\t// Get the offset from the scale number.\r\n\t\t\toffsetX = Number($event.target.textContent);\r\n\t\t}\r\n\r\n\t\tthis.boundaryManagementService.addNewBoundaryMarker(offsetX);\r\n\t}\r\n\r\n\tdeleteBoundaryMarker(boundary: IBoundary): void {\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: \"Are you sure?\",\r\n\t\t\tmessage: \"All component settings for this boundary limit will also be removed from the project. \" +\r\n\t\t\t\"Are you sure you want to continue?\",\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo\r\n\t\t};\r\n\r\n\t\tthis.dialogService.showMessage(options).then((result: IDialogResult<void>) => {\r\n\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.boundaryManagementService.removeProjectBoundary(boundary);\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.MANIFEST);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class RulerDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirRuler\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tscope: {},\r\n\t\t\t\ttemplate: require(\"./ruler.html\"),\r\n\t\t\t\tcontroller: RulerCtrl,\r\n\t\t\t\tcontrollerAs: \"eirRulerCtrl\",\r\n\t\t\t\tlink: ($scope, $element, $attrs) => {\r\n\t\t\t\t\tconst step = 100;\r\n\t\t\t\t\tconst moveLeft = 2;\r\n\t\t\t\t\tconst moveTop = 4;\r\n\t\t\t\t\tconst maxLength = Math.max($(document).outerWidth(), $(document).outerHeight());\r\n\r\n\t\t\t\t\tfor (let i = 0; i < maxLength; i += step) {\r\n\t\t\t\t\t\t$(\"<div class='scaleNumber'></div>\").appendTo(\r\n\t\t\t\t\t\t\t$element.find(\"#rulerHorizontal\")).css(\"left\", i + moveLeft).text(i);\r\n\t\t\t\t\t\t$(\"<div class='scaleNumber'></div>\").appendTo(\r\n\t\t\t\t\t\t\t$element.find(\"#rulerVertical\")).css(\"top\", i + moveTop).text(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirBoundaryEditorCtrl as ctrl\\\"> <div class=field> <label for=boundaryName>Name</label> <input id=boundaryName type=text ng-model=ctrl.boundary.displayName /> </div> <div class=field> <label for=boundaryLimit>Boundary Limit</label> <input id=boundaryLimit type=text class=spinbox ng-model=ctrl.settingLimitX xi-spinbox/> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button ng-disabled=\\\"!(ctrl.settingLimitX > 0)\\\" class=btn-modal-primary ng-click=ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div id=hRulerContainer> <div class=ruler-horizontal id=rulerHorizontal ng-dblclick=\\\"eirRulerCtrl.setBoundaryMarker($event); $event.stopPropagation();\\\"> <div ng-repeat=\\\"boundary in eirRulerCtrl.projectBoundaries\\\" ng-if=\\\"boundary.id != 'Default'\\\" id={{boundary.id}} ng-class=\\\"{ 'hBoundaryMarker selected' : boundary.id == eirRulerCtrl.currentBoundary.id , 'hBoundaryMarker' : boundary.id != eirRulerCtrl.currentBoundary.id }\\\" ng-style=\\\"{'left':(boundary.limitX - 2)+'px'}\\\" ng-click=\\\"eirRulerCtrl.boundaryClick(boundary, $event); $event.stopPropagation();\\\" ng-dblclick=\\\"eirRulerCtrl.boundaryDblClick(boundary); $event.stopPropagation();\\\"> <div class=boundaryName>{{boundary.displayName}}</div> <svg class=boundaryMarkerPin focusable=false> <polygon points=\\\"0,0.1 5,0.1 5,8.4 2.5,11.3 0,8.4 \\\"/> </svg> <div class=right> <div class=boundaryNumber>{{boundary.limitX}}</div> <button class=boundaryCloseBtn ng-click=\\\"eirRulerCtrl.deleteBoundaryMarker(boundary); $event.stopPropagation();\\\" xi-tooltip=\\\"'Remove Boundary'\\\"> <svg class=\\\"icon smallIcon\\\" focusable=false> <circle fill=#ffffff cx=6 cy=6 r=6 /> <g> <line fill=none stroke-width=1.5 stroke=#313236 x1=3.5 y1=3.5 x2=8.5 y2=8.5 /> <line fill=none stroke-width=1.5 stroke=#313236 x1=3.5 y1=8.5 x2=8.5 y2=3.5 /> </g> </svg> </button> </div> </div> <div class=defaultBoundaryToggle ng-click=\\\"eirRulerCtrl.toggleDefaultBoundary(); $event.stopPropagation()\\\" ng-dblclick=$event.stopPropagation();> </div> </div> </div> <div id=vRulerContainer> <div class=ruler-vertical id=rulerVertical></div> </div> <div id=rulerFiller></div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { InjectNames, Numbers, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { IJQueryMouseEventObject, KeyCodeEnum } from \"../../../common/defines\";\r\nimport { IComponentScope } from \"../../../common/interface/icomponent-scope\";\r\nimport { Flexbox } from \"../../../components/flexbox/flexbox\";\r\nimport { TabPanel } from \"../../../components/tabs/tab-panel\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { IEditorFlexbox } from \"../components/editor-flexbox\";\r\nimport { InteractionManagementService } from \"../services/interaction-management-service\";\r\n\r\nimport { CompositeComponentManagementService } from \"../services/composite-component-management-service\";\r\nimport { EditorService } from \"../services/editor-service\";\r\nimport { HotkeyService } from \"../services/hotkey-service\";\r\n\r\nexport interface IContextAction {\r\n\tid: string;\r\n\ticon?: string;\r\n\torientation?: number;\r\n\tname: string;\r\n\tactionMethod: Function;\r\n\tsubmenu?: boolean;\r\n\tenable: boolean;\r\n\tdisabled?: boolean;\r\n}\r\n\r\nexport class SelectionBoxCtrl {\r\n\tpublic componentNameForm: any;\r\n\tpublic isComponentNameEditMode = false;\r\n\tpublic contextActions: IContextAction[];\r\n\tpublic componentInstance: IEditorComponent;\r\n\tpublic flexOrientation: OrientationEnum;\r\n\tprivate unsubscribers: Array<Function> = [];\r\n\r\n\tprivate actionKeys = {\r\n\t\tORIENTATION: \"orientation\",\r\n\t\tINTERACTION: \"interaction\",\r\n\t\tCOMPOSITE: \"composite\",\r\n\t\tDELETE: \"delete\"\r\n\t};\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.COMPOSITE_COMPONENT_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.HOTKEY_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IComponentScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate compositeComponentManagementService: CompositeComponentManagementService,\r\n\t\tprivate hotkeyService: HotkeyService,\r\n\t\tprivate interactionManagementService: InteractionManagementService\r\n\t) {\r\n\t\tconst componentInstance = this.$scope.componentInstance as IEditorComponent;\r\n\t\tthis.componentInstance = componentInstance;\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.currentFlexOrientationChangedEvent.on((value: OrientationEnum) => {\r\n\t\t\tthis.setOrientationIcon(value);\r\n\t\t\tthis.flexOrientation = value;\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.currentFlexIsParentChangedEvent.on((value: boolean) => {\r\n\t\t\tthis.updateOrientationMenuVisibility(value);\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.selectedDatasourceChangedEvent\r\n\t\t\t.on(newDatasource => {\r\n\t\t\t\tthis.setSelectionBoxOptions(\r\n\t\t\t\t\tthis.isLayoutComponentWithNoDataservice(newDatasource));\r\n\t\t\t}));\r\n\r\n\t\tconst keyHandler = (event: JQueryEventObject) => {\r\n\t\t\t// Body focus to solve blur in IE/Edge\r\n\t\t\tif (event.keyCode === KeyCodeEnum.ESCAPE) {\r\n\t\t\t\tthis.isComponentNameEditMode = false;\r\n\t\t\t\tthis.componentNameForm.$rollbackViewValue();\r\n\t\t\t\t$(\"body\").focus();\r\n\t\t\t} else if (event.keyCode === KeyCodeEnum.ENTER) {\r\n\t\t\t\tthis.isComponentNameEditMode = false;\r\n\t\t\t\t$(\"body\").focus();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t$element.on(\"keydown\", keyHandler);\r\n\r\n\t\tthis.setSelectionBoxOptions(this.isLayoutComponentWithNoDataservice());\r\n\r\n\t\tthis.flexOrientation = this.componentInstance.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION);\r\n\t\tthis.setOrientationIcon(this.flexOrientation);\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\t$element.off(\"keydown\", keyHandler);\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.updateSize();\r\n\t}\r\n\r\n\tprivate isLayoutComponentWithNoDataservice(datasource?: IDatasource): boolean {\r\n\t\tconst component = this.editorService.getSelectedComponent();\r\n\t\tconst newDatasource = datasource ? datasource : component.getDatasource();\r\n\r\n\t\treturn component.isLayoutComponent() && !newDatasource;\r\n\t}\r\n\r\n\tprivate setSelectionBoxOptions(isLayoutComponentWithNoDataservice: boolean): void {\r\n\t\tthis.contextActions = [\r\n\t\t\t{\r\n\t\t\t\tid: this.actionKeys.ORIENTATION,\r\n\t\t\t\torientation: this.checkOrientationOnFlexbox(),\r\n\t\t\t\tname: \"Change Orientation\",\r\n\t\t\t\tactionMethod: () => { this.changeOrientation(); },\r\n\t\t\t\tsubmenu: true,\r\n\t\t\t\tenable: this.isFlexboxWithFlexChildren(),\r\n\t\t\t}, {\r\n\t\t\t\tid: this.actionKeys.INTERACTION,\r\n\t\t\t\ticon: \"action-interaction\",\r\n\t\t\t\tname: \"Create Interaction\",\r\n\t\t\t\tactionMethod: () => {\r\n\t\t\t\t\tthis.interactionManagementService.startInteractionWizard(\r\n\t\t\t\t\t\tthis.componentInstance);\r\n\t\t\t\t},\r\n\t\t\t\tenable: true,\r\n\t\t\t\tdisabled: isLayoutComponentWithNoDataservice,\r\n\t\t\t}, {\r\n\t\t\t\tid: this.actionKeys.COMPOSITE,\r\n\t\t\t\ticon: \"save\",\r\n\t\t\t\tname: \"Save as Composite Component\",\r\n\t\t\t\tactionMethod: () => {\r\n\t\t\t\t\tthis.compositeComponentManagementService.createNewViaWizard(\r\n\t\t\t\t\t\tthis.componentInstance.getDatabearer());\r\n\t\t\t\t},\r\n\t\t\t\tenable: true\r\n\t\t\t}, {\r\n\t\t\t\tid: this.actionKeys.DELETE,\r\n\t\t\t\tname: \"Delete\",\r\n\t\t\t\tactionMethod: () => { this.hotkeyService.deleteComponent(); },\r\n\t\t\t\tenable: true,\r\n\t\t\t\tdisabled: this.getSelectionOptionDisabledStatus()\r\n\t\t\t}\r\n\t\t];\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true, to 'disable' delete option  if componentInstance is:\r\n\t * \tAppPanel\r\n\t * \tTabPanel\r\n\t * \tGenerated component\r\n\t */\r\n\tprivate getSelectionOptionDisabledStatus(): boolean {\r\n\t\tconst componentInstance = this.componentInstance;\r\n\r\n\t\treturn componentInstance.getId() === \"AppPanel\" ||\r\n\t\t\tcomponentInstance.getTypedef() === TabPanel.name ||\r\n\t\t\tcomponentInstance.isGenerated;\r\n\t}\r\n\r\n\tprivate updateSize(): void {\r\n\t\tconst extraDisplayNameWidth = 6;\r\n\t\tconst extraWrapperWitdh = 33;\r\n\t\tconst newWidth = this.componentInstance.getDisplayName().length * extraDisplayNameWidth;\r\n\t\tthis.$element.find(\".selectionbox-wrapper\").css(\"width\", newWidth + extraWrapperWitdh);\r\n\t\tthis.$element.find(\".selBoxComponentNameInput\").css(\"width\", newWidth);\r\n\t}\r\n\r\n\tpublic checkPopupPosition(): void {\r\n\t\t//If outside of screen move the popup inside of canvas.\r\n\t\tconst menuElement = this.$element.find(\".icon-selectionbox\");\r\n\t\tconst popupElement = this.$element.find(\".popupmenu-wrapper\");\r\n\t\tconst left = menuElement.offset().left - Numbers.HUNDRED;\r\n\t\tconst canvasWidth = angular.element(\"#insideRuler\").width();\r\n\r\n\t\tconst isEntirelyVisible = (left <= canvasWidth);\r\n\r\n\t\tif (!isEntirelyVisible) {\r\n\t\t\tpopupElement.addClass(\"edge\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateOrientationMenuVisibility(showOrientationAction: boolean): void {\r\n\t\tconst actionItem = this.getContextAction(this.actionKeys.ORIENTATION);\r\n\t\tactionItem.enable = showOrientationAction;\r\n\t}\r\n\r\n\tprivate setOrientationIcon(orientation: OrientationEnum): void {\r\n\t\tconst actionItem = this.getContextAction(this.actionKeys.ORIENTATION);\r\n\t\tactionItem.icon = \"action-orientation-\" + orientation;\r\n\t\tactionItem.orientation = this.checkOrientationOnFlexbox();\r\n\t}\r\n\r\n\tprivate checkOrientationOnFlexbox(): number {\r\n\t\treturn this.componentInstance.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION);\r\n\t}\r\n\r\n\tprivate getContextAction(id: string): IContextAction {\r\n\t\tfor (let i = 0; i < this.contextActions.length; i++) {\r\n\t\t\tconst actionItem = this.contextActions[i];\r\n\t\t\tif (actionItem.id === id) {\r\n\t\t\t\treturn actionItem;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconsole.warn(\"Context action '\" + id + \"' does not exist\");\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate changeOrientation(): void {\r\n\t\tif (this.flexOrientation === OrientationEnum.HORIZONTAL) {\r\n\t\t\tthis.flexOrientation = OrientationEnum.VERTICAL;\r\n\t\t} else {\r\n\t\t\tthis.flexOrientation = OrientationEnum.HORIZONTAL;\r\n\t\t}\r\n\r\n\t\tthis.componentInstance.setBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, this.flexOrientation);\r\n\t\tconst actionItem = this.getContextAction(this.actionKeys.ORIENTATION);\r\n\t\tactionItem.orientation = this.checkOrientationOnFlexbox();\r\n\t\tthis.editorService.currentFlexOrientationChangedEvent.raise(this.flexOrientation);\r\n\t\tthis.editorService.refreshSettingEvent.raise(SettingKeys.ORIENTATION);\r\n\t\tthis.editorService.saveCanvas();\r\n\t}\r\n\r\n\tprivate isFlexboxWithFlexChildren(): boolean {\r\n\t\treturn (\r\n\t\t\tthis.componentInstance.getTypedef() === Flexbox.name ||\r\n\t\t\tthis.componentInstance.getTypedef() === TabPanel.name) &&\r\n\t\t\t(this.componentInstance as IEditorFlexbox).isFlexParent;\r\n\t}\r\n\r\n\tpublic onBlur(): void {\r\n\t\tthis.updateSize();\r\n\t\tthis.isComponentNameEditMode = false;\r\n\t\tthis.editorService.saveCanvas();\r\n\t}\r\n\r\n\tpublic onDoubleClick(event: IJQueryMouseEventObject): void {\r\n\t\tthis.isComponentNameEditMode = true;\r\n\r\n\t\t// MUPS-687 Inline editing of component names\r\n\t\t// Strangly. Having a timeout and trigger blur and then trigger focus fix for Edge and IE.\r\n\t\tsetTimeout(() => {\r\n\t\t\t(event.target as HTMLInputElement).blur();\r\n\t\t\t(event.target as HTMLInputElement).focus();\r\n\t\t}, 1);\r\n\t}\r\n}\r\n\r\nexport class SelectionBoxDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirSelectionBox\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tcontroller: SelectionBoxCtrl,\r\n\t\t\t\tcontrollerAs: \"eirSelectionBoxCtrl\",\r\n\t\t\t\ttemplate: require(\"./selection-box.html\")\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<form class=component-name-wrapper name=eirSelectionBoxCtrl.componentNameForm ng-click=$event.stopPropagation() ng-dblclick=$event.stopPropagation()> <div class=selectionbox-wrapper> <input class=\\\"selBoxComponentNameInput small-thin-text\\\" type=text name=compName autocomplete=off ng-readonly=!eirSelectionBoxCtrl.isComponentNameEditMode ng-dblclick=eirSelectionBoxCtrl.onDoubleClick($event) ng-model=eirSelectionBoxCtrl.componentInstance.databearer.displayName ng-model-options=\\\"{ updateOn: 'blur' }\\\" ng-change=eirSelectionBoxCtrl.onBlur() /> </div> <div class=actions> <button type=button class=\\\"btn-actions btn-menu\\\" ng-click=eirSelectionBoxCtrl.checkPopupPosition() xi-popupmenu> <svg class=icon-selectionbox focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>Actions</span> </button> <ul id=selection-box class=\\\"popupmenu selection-box-popup\\\"> <li class=\\\"{{contextAction.submenu ? 'submenu' : ''}} {{contextAction.disabled ? 'is-disabled' : ''}}\\\" ng-if=contextAction.enable ng-repeat=\\\"contextAction in eirSelectionBoxCtrl.contextActions\\\"> <hr class=horizontal-ruler-menu ng-if=\\\"contextAction.id === 'delete'\\\"> <a class=\\\"{{contextAction.submenu ? 'disabled' : ''}} {{contextAction.disabled ? 'is-disabled' : ''}}\\\" ng-click=\\\"contextAction.disabled || contextAction.actionMethod()\\\"> <span>{{contextAction.name}}</span> <svg class=\\\"icon arrow icon-dropdown\\\" focusable=false aria-hidden=true role=presentation ng-if=contextAction.submenu> <use xlink:href=#icon-dropdown></use> </svg> </a> <ul ng-if=contextAction.submenu class=popupmenu> <li> <a class=\\\"enable-option-{{contextAction.orientation === 2}}\\\" ng-click=contextAction.actionMethod()>Horizontal</a> </li> <li> <a class=\\\"enable-option-{{contextAction.orientation === 1}}\\\" ng-click=contextAction.actionMethod()>Vertical</a> </li> </ul> </li> </ul> </div> </form> <div class=arrow-down-outer> <div class=arrow-down-inner></div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { CanvasModeEnum, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJQueryMouseEventObject } from \"common/defines\";\r\n\r\nimport { IErrorResponse } from \"common/error-response\";\r\nimport { EditorApplicationParent } from \"editor/components/editor-application-parent\";\r\n\r\nimport { EditorService } from \"editor/services/editor-service\";\r\nimport { SaveService } from \"editor/services/save-service\";\r\nclass StatusbarCtrl {\r\n\tprivate components: IEditorComponent[];\r\n\tprivate applicationParent: EditorApplicationParent;\r\n\tprivate selectedComponent: IEditorComponent;\r\n\tprivate unsubscribers: Array<Function> = [];\r\n\r\n\tpublic saveUpdate: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.SAVE_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tscope: ng.IScope,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate saveService: SaveService\r\n\t) {\r\n\t\tthis.unsubscribers.push(editorService.selectedComponentChangedEvent.on((component: IEditorComponent) => {\r\n\t\t\tthis.selectedComponent = component;\r\n\t\t\tthis.updateStatusbar(component);\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(saveService.saveStateEvent.on((value: string | IErrorResponse) => {\r\n\t\t\tthis.updateSave(value);\r\n\t\t}));\r\n\r\n\t\tscope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateStatusbar(component: IEditorComponent): void {\r\n\t\tconst components: IEditorComponent[] = [];\r\n\t\tif (!component) {\r\n\t\t\tcomponents.push(this.getApplicationParent());\r\n\t\t} else if (this.isApplicationComponent(component)) {\r\n\t\t\tcomponents.push(component);\r\n\t\t} else {\r\n\t\t\twhile (component) {\r\n\t\t\t\tcomponents.unshift(component);\r\n\t\t\t\tcomponent = component.parent;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.components = components;\r\n\t}\r\n\r\n\tprivate getApplicationParent(): EditorApplicationParent {\r\n\t\tif (!this.applicationParent) {\r\n\t\t\tthis.applicationParent = this.editorService.getApplicationParent();\r\n\t\t}\r\n\t\treturn this.applicationParent;\r\n\t}\r\n\r\n\tprivate isApplicationComponent(component: IEditorComponent): boolean {\r\n\t\treturn component.getId() === this.getApplicationParent().getId();\r\n\t}\r\n\r\n\tpublic updateSave(value: string | IErrorResponse): void {\r\n\t\tlet outValue: string = \"\";\r\n\r\n\t\tif (typeof (value) === \"string\") {\r\n\t\t\toutValue = value;\r\n\t\t\tif (value === this.saveService.saveStates.saved) {\r\n\t\t\t\tconst cutString = 8;\r\n\t\t\t\tlet currentTime = new Date().toTimeString();\r\n\t\t\t\tcurrentTime = currentTime.substring(0, cutString);\r\n\t\t\t\toutValue = value + currentTime;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\toutValue = value.message;\r\n\t\t}\r\n\r\n\t\tthis.saveUpdate = outValue;\r\n\t}\r\n\r\n\t// Public since used in view\r\n\tpublic selectComponent(component: IEditorComponent, event: IJQueryMouseEventObject): void {\r\n\t\tconst isApplication = this.isApplicationComponent(component);\r\n\t\tconst canvasMode = this.editorService.getCanvasMode();\r\n\t\tif (!isApplication) {\r\n\t\t\t// TODO Allow context to be set to ApplicationComponent?\r\n\t\t\tcomponent.onClick(event);\r\n\t\t} else {\r\n\t\t\tif (canvasMode === CanvasModeEnum.SELECTION) {\r\n\t\t\t\tthis.editorService.deselectComponent();\r\n\t\t\t} else if (canvasMode === CanvasModeEnum.FINDER) {\r\n\t\t\t\tthis.editorService.selectFinderComponent(component);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onMouseEnter(component: IEditorComponent, $event: IJQueryMouseEventObject): void {\r\n\t\tif (!this.isApplicationComponent(component)) {\r\n\t\t\tcomponent.onMouseOver($event);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onMouseLeave(component: IEditorComponent, $event: IJQueryMouseEventObject): void {\r\n\t\tif (!this.isApplicationComponent(component)) {\r\n\t\t\tcomponent.onMouseLeave($event);\r\n\t\t}\r\n\t}\r\n\r\n\t/*private isSelectedComponent(component: IEditorComponent): boolean {\r\n\t\treturn this.selectedComponent && component.getId() === this.selectedComponent.getId();\r\n\t}*/\r\n}\r\n\r\nexport class StatusbarDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirStatusbar\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tcontroller: StatusbarCtrl,\r\n\t\t\t\tcontrollerAs: \"eirStatusbarCtrl\",\r\n\t\t\t\ttemplate: require(\"./statusbar.html\")\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-repeat=\\\"component in eirStatusbarCtrl.components\\\" ng-click=\\\"eirStatusbarCtrl.selectComponent(component, $event)\\\" ng-mouseover=\\\"eirStatusbarCtrl.onMouseEnter(component, $event)\\\" ng-mouseleave=\\\"eirStatusbarCtrl.onMouseLeave(component, $event)\\\"> <span>{{component.databearer.displayName}}</span> </div> <label class=save-status> {{eirStatusbarCtrl.saveUpdate}} </label>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { Datagrid } from \"../../../components/datagrid/datagrid\";\r\nimport { TranslationManagementService } from \"../../../components/services/translation-management-service\";\r\nimport type { IFinderModeOptions } from \"../../defines\";\r\nimport { DesignerHelper } from \"../../helper\";\r\nimport { ProjectService } from \"../../services/project-service\";\r\nimport type { IExpressionData } from \"../components/editor-component\";\r\nimport type { IEditorDatagrid } from \"../components/editor-datagrid\";\r\nimport { ISidebarView, SidebarViewEnum } from \"../defines\";\r\nimport { EditorService } from \"../services/editor-service\";\r\nimport { HotkeyService } from \"../services/hotkey-service\";\r\nimport { InsertComponentService } from \"../services/insert-component-service\";\r\nimport { SaveService } from \"../services/save-service\";\r\nimport { UndoService } from \"../services/undo-service\";\r\n\r\nimport { CanvasModeEnum, ConditionType, Config, IChanged, InjectNames, ProjectTypeEnum, SaveFlagsEnum, SettingKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IMingleLanguage } from \"ng2/common/model/language.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { Debugger } from \"common/debugger\";\r\nimport type { IErrorResponse } from \"common/error-response\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\n\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult\r\n} from \"common/services/dialog-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\n\r\nexport enum OverlayStateEnum {\r\n\tHIDDEN = \"HIDDEN\",\r\n\tOVERLAY = \"OVERLAY\",\r\n\tFINDER_OVERLAY = \"FINDER_OVERLAY\",\r\n}\r\n\r\nexport class TopbarCtrl {\r\n\tsidebarView: SidebarViewEnum;\r\n\tisSidebarVisible = true;\r\n\toverlayState: OverlayStateEnum = OverlayStateEnum.HIDDEN;\r\n\toverlayStateEnum = OverlayStateEnum;\r\n\tfinderOptions: IFinderModeOptions;\r\n\tprojectSaveState: string;\r\n\tcanCut: boolean;\r\n\tcanCopy: boolean;\r\n\tcanDelete: boolean;\r\n\thasClipboardComponent: boolean;\r\n\tisRuntime: boolean;\r\n\tsupportedLanguages: IMingleLanguage[];\r\n\tcurrentLanguage: string;\r\n\tprivate saveError: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.WINDOW,\r\n\t\tAngularConstants.STATE_SERVICE,\r\n\t\tInjectNames.HOTKEY_SERVICE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.SAVE_SERVICE,\r\n\t\tInjectNames.UNDO_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.INSERT_COMPONENT_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.PROJECT_SERVICE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t];\r\n\r\n\tget isDeveloper(): boolean {\r\n\t\treturn Debugger.isEnabled() && Config.IS_DEV;\r\n\t}\r\n\r\n\tget isBaseBuilder(): boolean {\r\n\t\treturn Config.IS_BASE_BUILDER;\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $window: ng.IWindowService,\r\n\t\tprivate $state: ng.ui.IStateService,\r\n\t\tprivate hotKeyService: HotkeyService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate saveService: SaveService,\r\n\t\tprivate undoService: UndoService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate insertComponentService: InsertComponentService,\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tprivate projectService: ProjectService,\r\n\t\tprivate commonService: CommonService\r\n\r\n\t) {\r\n\t\tconst sidebarView = editorService.getSidebarView();\r\n\t\tthis.sidebarView = sidebarView.view;\r\n\t\tthis.isSidebarVisible = sidebarView.isSidebarVisible;\r\n\t\tthis.isRuntime = this.editorService.isRuntimeMode();\r\n\t\tthis.supportedLanguages = this.languageService.getSupportedLanguages();\r\n\t\tthis.currentLanguage = this.languageService.getLanguage();\r\n\t\tthis.initiateSubscribers($scope);\r\n\t}\r\n\r\n\topenExpressions(): void {\r\n\t\tconst options: IDialogOptions<IExpressionData> = {\r\n\t\t\ttitle: \"Project Expressions\",\r\n\t\t\tparameter: {\r\n\t\t\t\tcomponent: null,\r\n\t\t\t\toption: ConditionType.ALL\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"../component-settings/expression-dialog/expression-dialog.html\")\r\n\t\t};\r\n\t\tthis.dialogService.show(options);\r\n\t}\r\n\r\n\topenTranslations(): void {\r\n\t\tthis.translationManagementService.openTranslations().then((result) => {\r\n\t\t\tconst data = result.value as IChanged;\r\n\t\t\tif (result.button === DialogButtonType.Ok && data.savedComponentStrings.length > 0) {\r\n\t\t\t\tdata.savedComponentStrings.forEach((value) => {\r\n\t\t\t\t\tconst component = this.editorService.getComponentInstanceById(value.component);\r\n\t\t\t\t\tcomponent.forEachBindable((binding) => {\r\n\t\t\t\t\t\tif (binding.ref === value.reference) {\r\n\t\t\t\t\t\t\tconst field = component.getBindableField(value.reference);\r\n\t\t\t\t\t\t\tfield.value = value.newValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// check if titlebar is changed\r\n\t\t\t\tconst titlebarChanged = data.savedComponentStrings.find((translation) => {\r\n\t\t\t\t\treturn translation.reference === SettingKeys.APPLICATION_HEADER;\r\n\t\t\t\t});\r\n\t\t\t\tif (titlebarChanged) {\r\n\t\t\t\t\tthis.updateStringHeader(titlebarChanged.newValue);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Check if selected component is changed\r\n\t\t\t\tconst selectedComponent = this.editorService.getSelectedComponent();\r\n\t\t\t\tif (selectedComponent) {\r\n\t\t\t\t\tconst selectedIsChanged = data.savedComponentStrings.filter((translation) => {\r\n\t\t\t\t\t\treturn translation.component === selectedComponent.getId();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (selectedIsChanged) {\r\n\t\t\t\t\t\tselectedIsChanged.forEach((updatedTranslation) => {\r\n\t\t\t\t\t\t\tthis.editorService.translationChangedEvent.raise(updatedTranslation);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.TRANSLATIONS);\r\n\t\t\t}\r\n\t\t\t//If global translations is saved\r\n\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, data.savedGlobalStrings)) {\r\n\t\t\t\tthis.translationManagementService.saveGlobalTranslations(result.value.savedGlobalStrings).then(() => {\r\n\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t//If global translations is deleted\r\n\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, data.deletedGlobalStrings)) {\r\n\t\t\t\tthis.translationManagementService.deleteGlobalTranslations(result.value.deletedGlobalStrings)\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateStringHeader(newString: string): void {\r\n\t\tconst manifest = this.editorService.getCurrentProject().getManifest();\r\n\t\tmanifest.title = newString;\r\n\t\tthis.editorService.setManifest(manifest);\r\n\t\tthis.editorService.projectSettingsChangedEvent.raise(\r\n\t\t\tthis.editorService.getCurrentProject().getManifest()\r\n\t\t);\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.MANIFEST);\r\n\t}\r\n\r\n\t/**\r\n\t * Initiate the subscribers.\r\n\t *\tAlso unsubscribe when scope is destroyed.\r\n\t\t*\r\n\t\t* @private\r\n\t\t* @param {ng.IScope} scope\r\n\t\t*\r\n\t\t* @memberof TopbarCtrl\r\n\t\t*/\r\n\tprivate initiateSubscribers(scope: ng.IScope): void {\r\n\t\tconst subscribers = [\r\n\t\t\t// Update the sidebarview according to the editorservice\r\n\t\t\tthis.editorService.sidebarViewChangedEvent.on((view: ISidebarView) => {\r\n\t\t\t\tif (view) {\r\n\t\t\t\t\tthis.sidebarView = view.view;\r\n\t\t\t\t\tthis.isSidebarVisible = view.isSidebarVisible;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t// Check if the new selected component and be cut, copied or deleted\r\n\t\t\tthis.editorService.selectedComponentChangedEvent.on((component: IEditorComponent) => {\r\n\t\t\t\tif (component && this.editorService.isMovable(component)) {\r\n\t\t\t\t\tthis.canCut = this.editorService.canCut(component);\r\n\t\t\t\t\tthis.canCopy = this.editorService.canCopy(component);\r\n\t\t\t\t\tthis.canDelete = component.canDelete();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.canCut = false;\r\n\t\t\t\t\tthis.canCopy = false;\r\n\t\t\t\t\tthis.canDelete = false;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t// Set the overlayState value based on the canvas current mode\r\n\t\t\tthis.editorService.canvasModeChangedEvent.on((mode: CanvasModeEnum) => {\r\n\t\t\t\tif (mode === CanvasModeEnum.RUNTIME) {\r\n\t\t\t\t\tthis.isRuntime = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.isRuntime = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (mode === CanvasModeEnum.FINDER) {\r\n\t\t\t\t\tthis.overlayState = OverlayStateEnum.FINDER_OVERLAY;\r\n\t\t\t\t\tthis.finderOptions = this.editorService.getFinderModeOptions();\r\n\t\t\t\t} else if (mode === CanvasModeEnum.WIZARD) {\r\n\t\t\t\t\tthis.overlayState = OverlayStateEnum.OVERLAY;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.overlayState = OverlayStateEnum.HIDDEN;\r\n\t\t\t\t}\r\n\t\t\t\tscope.$applyAsync();\r\n\t\t\t}),\r\n\t\t\t// On clipboard component changes\r\n\t\t\tthis.insertComponentService.clipboardComponentChangedEvent.on((component: IJsonComponent) => {\r\n\t\t\t\tif (component) {\r\n\t\t\t\t\tthis.hasClipboardComponent = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.hasClipboardComponent = false;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\t// Update the save state on saveStateEvent\r\n\t\t\tthis.saveService.saveStateEvent.on((value: string | IErrorResponse) => {\r\n\t\t\t\tthis.updateSaveState(value);\r\n\t\t\t}),\r\n\t\t];\r\n\r\n\t\tscope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tsubscribers.forEach((unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tsaveBase(): void {\r\n\t\tconst options: IDialogOptions<string> = {\r\n\t\t\ttitle: \"Define Stratus Base Template\",\r\n\t\t\ttemplate: require(\"./base-modal/base.html\")\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tconst manifest = this.editorService.getCurrentProject().getManifest();\r\n\t\t\t\tmanifest.typeDef = ProjectTypeEnum.BASE;\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.QUESTIONS);\r\n\t\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.MANIFEST);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tchangeLanguage(language: IMingleLanguage): void {\r\n\t\tif (language.key !== this.currentLanguage) {\r\n\t\t\tthis.languageService.changeCurrentLanguage(language.key).then(() => {\r\n\t\t\t\tthis.currentLanguage = this.languageService.getLanguage();\r\n\t\t\t\tthis.languageService.loadSohoLocale(this.currentLanguage)\r\n\t\t\t\t\t.done(() => {\r\n\t\t\t\t\t\tthis.editorService.getAllComponents()\r\n\t\t\t\t\t\t\t.forEach(component => {\r\n\t\t\t\t\t\t\t\t// switch case on components which can have locale specific data\r\n\t\t\t\t\t\t\t\tswitch (component.getTypedef()) {\r\n\t\t\t\t\t\t\t\t\tcase Datagrid.name:\r\n\t\t\t\t\t\t\t\t\t\t(component as IEditorDatagrid).updateValuesWithTranslations();\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\tthis.languageService.loadGlobalStrings(this.currentLanguage).then(() => {\r\n\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\tthis.updateStringHeader(this.translationManagementService.getTranslatableHeaderString());\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\ttoggleRuntimeMode(): void {\r\n\t\tlet mode = CanvasModeEnum.SELECTION;\r\n\t\tif (this.editorService.getCanvasMode() === mode) {\r\n\t\t\tmode = CanvasModeEnum.RUNTIME;\r\n\t\t} else {\r\n\t\t\tmode = CanvasModeEnum.SELECTION;\r\n\t\t}\r\n\t\tthis.editorService.setCanvasMode(mode);\r\n\t\tthis.isRuntime = this.editorService.isRuntimeMode();\r\n\t}\r\n\r\n\tcopyToForm(): void {\r\n\t\tconst options: IDialogOptions<string> = {\r\n\t\t\ttitle: \"Copy To Mongoose Form\",\r\n\t\t\tparameter: this.editorService.getCurrentProject().getManifest().displayName,\r\n\t\t\ttemplate: require(\"./copy-form/copy-form.html\")\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tconst projectId = this.editorService.getCurrentProject().getId();\r\n\t\t\t\tthis.projectService.copyToForm(projectId, result.value);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\trefresh(): void {\r\n\t\tthis.$state.reload();\r\n\t}\r\n\r\n\tshowProjectSettings(): void {\r\n\t\tconst manifest = this.editorService.getCurrentProject().getManifest();\r\n\t\tconst options: IDialogOptions<DesignerManifest> = {\r\n\t\t\ttitle: \"Project Settings\",\r\n\t\t\tparameter: manifest,\r\n\t\t\tstyle: \"max-width: 350px;\",\r\n\t\t\ttemplate: require(\"../project-settings/project-settings-dialog.html\")\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show<DesignerManifest, void>(options);\r\n\t}\r\n\r\n\tshowKeyboardShortcuts(): void {\r\n\t\tconst keydialog: IDialogOptions<any> = {\r\n\t\t\ttitle: \"Keyboard Shortcuts\",\r\n\t\t\ttemplate: require(\"./key-dialog/key-dialog.html\"),\r\n\t\t\tbuttons: [{\r\n\t\t\t\ttext: \"OK\",\r\n\t\t\t\tvalue: \"Cancel\",\r\n\t\t\t\tisDefault: false\r\n\t\t\t}]\r\n\t\t};\r\n\t\tthis.dialogService.show(keydialog);\r\n\t}\r\n\r\n\tsaveProject(): void {\r\n\t\tthis.saveError = null;\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.PROJECT)\r\n\t\t\t.catch((errResponse: IErrorResponse) => {\r\n\t\t\t\tthis.saveError = errResponse.message;\r\n\t\t\t});\r\n\t}\r\n\r\n\tcutComponent(): void {\r\n\t\tthis.hotKeyService.cutComponent();\r\n\t}\r\n\r\n\tcopyComponent(): void {\r\n\t\tthis.hotKeyService.copyComponent();\r\n\t}\r\n\r\n\tpasteComponent(): void {\r\n\t\tthis.hotKeyService.pasteComponent();\r\n\t}\r\n\r\n\tdeleteComponent(): void {\r\n\t\tthis.hotKeyService.deleteComponent();\r\n\t}\r\n\r\n\tscreenshotCanvas(): void {\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.SCREENSHOT);\r\n\t}\r\n\r\n\tdisplayClipboardName(): string {\r\n\t\tlet displayName = \"\";\r\n\t\tif (this.insertComponentService.getClipboardComponent()) {\r\n\t\t\tdisplayName = this.insertComponentService.getClipboardComponent().displayName;\r\n\t\t}\r\n\t\treturn displayName;\r\n\t}\r\n\r\n\ttypeDefClipboard(): string {\r\n\t\tlet typedef = \"\";\r\n\t\tif (this.insertComponentService.getClipboardComponent()) {\r\n\t\t\ttypedef = this.insertComponentService.getClipboardComponent().typedef;\r\n\t\t}\r\n\t\treturn typedef;\r\n\t}\r\n\r\n\tshowClipboard(): IJsonComponent {\r\n\t\treturn this.insertComponentService.getClipboardComponent();\r\n\t}\r\n\r\n\topenNewComponent(): void {\r\n\t\tthis.editorService.setSidebarView(SidebarViewEnum.NEW_COMPONENT);\r\n\t\tthis.showSidebar();\r\n\t}\r\n\r\n\topenSettings(): void {\r\n\t\tthis.editorService.setSidebarView(SidebarViewEnum.SETTINGS);\r\n\t\tthis.showSidebar();\r\n\t}\r\n\r\n\tprivate showSidebar(): void {\r\n\t\tthis.editorService.setSidebarVisibility(true);\r\n\t}\r\n\r\n\topenRuntime(): void {\r\n\t\tDesignerHelper.openRuntime(\r\n\t\t\tthis.editorService.getCurrentProject().getId(),\r\n\t\t\tthis.$window,\r\n\t\t\tthis.editorService.getActiveUrlBindings(),\r\n\t\t\tthis.editorService.getUrlMetaData());\r\n\t}\r\n\r\n\topenHelp(): void {\r\n\t\tthis.commonService.openHelp();\r\n\t}\r\n\r\n\topenUrlSettings(): void {\r\n\t\tthis.editorService.openURLDialog();\r\n\t}\r\n\r\n\tundoAction(): void {\r\n\t\tthis.hotKeyService.removeClipboardComponentByUndoStack();\r\n\t\tthis.undoService.undoAction();\r\n\t}\r\n\r\n\tredoAction(): void {\r\n\t\tthis.undoService.redoAction();\r\n\t}\r\n\r\n\tisUndoActionAvailable(): boolean {\r\n\t\treturn this.undoService.isUndoAvailable();\r\n\t}\r\n\r\n\tisRedoActionAvailable(): boolean {\r\n\t\treturn this.undoService.isRedoAvailable();\r\n\t}\r\n\r\n\tupdateSaveState(value: string | IErrorResponse): void {\r\n\t\tif (typeof value === \"string\") {\r\n\t\t\tthis.projectSaveState = value;\r\n\t\t\tthis.saveError = null;\r\n\t\t} else {\r\n\t\t\tthis.projectSaveState = this.saveService.saveStates.failed;\r\n\t\t\tthis.saveError = value.message;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class TopbarDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirTopbar\", () => {\r\n\t\t\treturn {\r\n\t\t\t\ttemplate: require(\"./topbar.html\"),\r\n\t\t\t\tscope: true,\r\n\t\t\t\ttransclude: true,\r\n\t\t\t\tcontroller: TopbarCtrl,\r\n\t\t\t\tcontrollerAs: \"eirTopbarCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirBaseDialogController as ctrl\\\"> <div class=base-template-dialog> <div class=toolbar role=toolbar> <div class=buttonset> <label class=audible for=searchfield-questions>Keyword Search</label> <input id=searchfield-questions name=searchfield-questions class=searchfield /> <button class=btn-tertiary type=button xi-tooltip=\\\"'Add Question'\\\" ng-click=ctrl.addQuestion()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>Add</span> </button> <button class=btn-tertiary type=button xi-tooltip=\\\"'Delete Question'\\\" ng-disabled=!ctrl.selectedQuestion ng-click=ctrl.deleteQuestion()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> </div> </div> <div id=datagrid-questions class=questions-grid xi-datagrid=ctrl.datagridOptions></div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Close</button> <button type=button class=btn-modal ng-click=ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=copy-form-dialog ng-controller=\\\"eirCopyFormDialogController as ctrl\\\"> <div class=\\\"field form-name\\\"> <label>New Form Name <span>*</span></label> <eir-input-field-component id=new-form-name field-value=ctrl.formName field-name=formName validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\ttype: 'not-empty'\\r\\n\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t}\\\"/> </div> <div class=\\\"text-emphasis field\\\"> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-alert></use> </svg> <span>Note: Some components, interactions and data services may require manual editing in Mongoose.</span> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-click=ctrl.saveForm() ng-disabled=ctrl.isNameInvalid> Copy </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div ng-controller=\\\"eirProjectSettingsCtrl as ctrl\\\"> <div class=field ng-if=\\\"ctrl.manifest.typeDef === 1\\\"> <p>This project is a Stratus Template</p> </div> <div class=field> <eir-input-field-component label-name=\\\"Project Name\\\" field-value=ctrl.manifest.displayName validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'max-length', value: 128},\\r\\n\\t\\t\\t\\t\\t{type: 'not-empty'}\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t}\\\"/> </div> <div class=field> <eir-input-field-component label-name=\\\"App Header Title\\\" field-value=ctrl.manifest.title validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'max-length', value: 128},\\r\\n\\t\\t\\t\\t\\t{type: 'not-empty'}\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t}\\\"/> </div> <div class=field> <eir-textarea-field-component label-name=Description field-value=ctrl.manifest.description validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'max-length', value: 2000}\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t}\\\"/> </div> <div class=field> <eir-tag-dropdown on-save-tags=ctrl.saveTags($tags) project=ctrl.currentProject.manifest selected-tags=ctrl.currentProject.tags /> </div> <div class=field> <eir-input-field-component label-name=Version field-value=ctrl.manifest.version validation=\\\"{\\r\\n\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t{type: 'max-length', value: 128},\\r\\n\\t\\t\\t\\t\\t{type: 'not-empty'}\\r\\n\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t}\\\"/> </div> <div class=field> <label for=defaultThemeDropdown>Default Theme</label> <select id=defaultThemeDropdown class=dropdown ng-model=ctrl.defaultTheme ng-options=\\\"v.name for (_key, v) in ctrl.themes\\\" xi-drop-down> </select> </div> <div class=field> <input id=showTitleBarInput type=checkbox class=checkbox ng-model=ctrl.manifest.showTitleBar /> <label for=showTitleBarInput class=checkbox-label>Use titlebar</label> </div> <div class=field> <input id=showThemeSwitchInput type=checkbox class=checkbox ng-model=ctrl.manifest.themeSwitchEnabled /> <label for=showThemeSwitchInput class=checkbox-label>Enable theme switch</label> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.save() ng-disabled=ctrl.isManifestInvalid> Save</button> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=shortcutsModal> <div class=shortcutsWrapper> <label class=shortcut-label>Canvas Shortcuts</label> <div class=shortcutsModal-content> <ul> <li> <dl> <dt>Cut Selected</dt> <dd> <kbd>Ctrl</kbd> + <kbd>X</kbd> </dd> </dl> </li> <li> <dl> <dt>Copy Selected</dt> <dd> <kbd>Ctrl</kbd> + <kbd>C</kbd> </dd> </dl> </li> <li> <dl> <dt>Paste Selected</dt> <dd> <kbd>Ctrl</kbd> + <kbd>V</kbd> </dd> </dl> </li> <li> <dl> <dt>Delete Selected</dt> <dd> <kbd>Del</kbd> </dd> </dl> </li> </ul> </div> <div class=shortcutsModal-content> <ul> <li> <dl> <dt>Undo Change</dt> <dd> <kbd>Ctrl</kbd> + <kbd>Z</kbd> </dd> </dl> </li> <li> <dl> <dt>Redo Change</dt> <dd> <kbd>Ctrl</kbd> + <kbd>Y</kbd> </dd> </dl> </li> </ul> </div> <label class=shortcut-label>Project Shortcuts</label> <div class=shortcutsModal-content> <ul> <li> <dl> <dt>Save Project</dt> <dd> <kbd>Ctrl</kbd> + <kbd>S</kbd> </dd> </dl> </li> <li> <dl> <dt>Toggle Preview</dt> <dd> <kbd>Ctrl</kbd> + <kbd>&lt;</kbd> </dd> </dl> </li> </ul> </div> <div class=shortcutsModal-content> <ul> <li> <dl> <dt>Open Dropdown</dt> <dd> <kbd>Space</kbd> </dd> </dl> </li> <li> <dl> <dt>Close Dropdown</dt> <dd> <kbd>Esc</kbd> </dd> </dl> </li> </ul> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<header class=\\\"header design\\\"> <div class=left> <div class=buttonContainer> <button class=\\\"btn-icon icon-left\\\" ng-disabled=\\\"eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ui-sref=home xi-tooltip=\\\"'Return to Dashboard'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-warehouse></use> </svg> </button> <button id=elementTopbar class=\\\"btn-icon icon-left\\\" ng-disabled=\\\"eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.openNewComponent() ng-class=\\\"{selected: eirTopbarCtrl.isSidebarVisible && eirTopbarCtrl.sidebarView.value === 'newcomponent'}\\\" xi-tooltip=\\\"'Components'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-component></use> </svg> </button> <button id=settingsTopbar class=\\\"btn-icon icon-left\\\" ng-disabled=\\\"eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.openSettings() ng-class=\\\"{selected: eirTopbarCtrl.isSidebarVisible && eirTopbarCtrl.sidebarView.value === 'settings'}\\\" xi-tooltip=\\\"'Component Properties'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-settings></use> </svg> </button> </div> </div> <div class=middle> <div class=buttonContainer> <button class=\\\"btn-icon icon-middle\\\" ng-disabled=\\\"!eirTopbarCtrl.isUndoActionAvailable() || eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.undoAction() xi-tooltip=\\\"'Undo (Ctrl+Z)'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-undo></use> </svg> </button> <button class=\\\"btn-icon icon-middle\\\" ng-disabled=\\\"!eirTopbarCtrl.isRedoActionAvailable() || eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.redoAction() xi-tooltip=\\\"'Redo (Ctrl+Y)'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-redo></use> </svg> </button> <button class=\\\"btn-icon icon-middle\\\" ng-disabled=\\\"!eirTopbarCtrl.canCut || eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.cutComponent() xi-tooltip=\\\"'Cut (Ctrl+X)'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-cut></use> </svg> </button> <button class=\\\"btn-icon icon-middle\\\" ng-disabled=\\\"!eirTopbarCtrl.canCopy || eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.copyComponent() xi-tooltip=\\\"'Copy (Ctrl+C)'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-copy></use> </svg> </button> <button class=\\\"btn-icon icon-middle\\\" ng-disabled=\\\"!eirTopbarCtrl.hasClipboardComponent || eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.pasteComponent();$event.stopPropagation(); xi-tooltip=\\\"'Paste (Ctrl+V)'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-paste></use> </svg> </button> <button class=\\\"btn-icon icon-middle\\\" ng-disabled=\\\"!eirTopbarCtrl.canDelete || eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.deleteComponent() xi-tooltip=\\\"'Delete (Del)'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-delete></use> </svg> </button> </div> </div> <div class=right> <div class=buttonContainer> <button ng-class=\\\"{'btn-tertiary no-caps toggled': eirTopbarCtrl.isRuntime, 'btn-icon' : !eirTopbarCtrl.isRuntime}\\\" ng-disabled=\\\"eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.toggleRuntimeMode() xi-tooltip=\\\"'Preview'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-update-preview></use> </svg> <span>{{eirTopbarCtrl.isRuntime ? 'Preview' : ''}}</span> </button> <button class=btn-icon ng-disabled=\\\"eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.openRuntime() xi-tooltip=\\\"'Launch'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-rocket></use> </svg> </button> <button class=btn-icon ng-disabled=\\\"eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\" ng-click=eirTopbarCtrl.saveProject() xi-tooltip=\\\"eirTopbarCtrl.saveError ? eirTopbarCtrl.saveError : 'Save'\\\"> <svg class=icon focusable=false> <use xlink:href=#icon-save></use> </svg> <svg class=\\\"icon icon-confirm alert\\\" focusable=false aria-hidden=true role=presentation ng-if=\\\"eirTopbarCtrl.projectSaveState === eirTopbarCtrl.saveService.saveStates.saved\\\"> <use xlink:href=#icon-confirm></use> </svg> <svg class=\\\"icon icon-in-progress alert\\\" focusable=false aria-hidden=true role=presentation ng-if=\\\"eirTopbarCtrl.projectSaveState === eirTopbarCtrl.saveService.saveStates.inProgress\\\"> <use xlink:href=#icon-in-progress></use> </svg> <svg class=\\\"icon icon-error alert\\\" focusable=false aria-hidden=true role=presentation ng-if=\\\"eirTopbarCtrl.projectSaveState === eirTopbarCtrl.saveService.saveStates.failed\\\"> <use xlink:href=#icon-error></use> </svg> </button> <button class=btn-actions xi-tooltip=\\\"'More...'\\\" xi-popupmenu ng-disabled=\\\"eirTopbarCtrl.overlayState != eirTopbarCtrl.overlayStateEnum.HIDDEN\\\"> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More</span> </button> <ul class=popupmenu> <li ng-click=eirTopbarCtrl.showProjectSettings()> <a>Project Settings</a> </li> <li ng-click=eirTopbarCtrl.screenshotCanvas()> <a>Create App Thumbnail</a> </li> <li ng-click=eirTopbarCtrl.copyToForm()> <a>Copy To Form</a> </li> <li class=separator></li> <li ui-sref=repository> <a>Repository</a> </li> <li ng-click=eirTopbarCtrl.showKeyboardShortcuts()> <a>Keyboard Shortcuts</a> </li> <li ng-click=eirTopbarCtrl.refresh()> <a>Refresh</a> </li> <li class=submenu> <a><span>Language</span> <svg class=\\\"icon arrow icon-dropdown\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-dropdown></use> </svg> </a> <ul class=\\\"popupmenu is-padded is-selectable\\\"> <li ng-repeat=\\\"language in eirTopbarCtrl.supportedLanguages\\\" ng-click=eirTopbarCtrl.changeLanguage(language); class=\\\"{{eirTopbarCtrl.currentLanguage === language.key ? 'is-checked' : ''}}\\\"> <a>{{language.value}}</a> </li> </ul> </li> <li class=submenu> <a><span>Manage</span> <svg class=\\\"icon arrow icon-dropdown\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-dropdown></use> </svg> </a> <ul class=popupmenu> <li ng-click=eirTopbarCtrl.openTranslations()> <a>Translations</a> </li> <li ng-click=eirTopbarCtrl.openUrlSettings()> <a>URL Variables</a> </li> <li ng-click=eirTopbarCtrl.openExpressions()> <a>Expressions</a> </li> </ul> </li> <li ng-if=::eirTopbarCtrl.isDeveloper ui-sref=developer> <a>Developers tools</a> </li> <li ng-if=::eirTopbarCtrl.isBaseBuilder> <a ng-click=eirTopbarCtrl.saveBase()>Save as Base</a> </li> <li> <a ng-click=eirTopbarCtrl.openHelp()> Help </a> </li> </ul> </div> </div> </header> <div class=header-overlay ng-if=\\\"eirTopbarCtrl.overlayState == eirTopbarCtrl.overlayStateEnum.OVERLAY\\\"> </div> <div class=\\\"header-overlay finder-overlay\\\" ng-if=\\\"eirTopbarCtrl.overlayState == eirTopbarCtrl.overlayStateEnum.FINDER_OVERLAY\\\"> <span>{{eirTopbarCtrl.finderOptions.title}}</span> <button class=btn-teritary ng-if=\\\"eirTopbarCtrl.finderOptions.hideCancel === false\\\" ng-click=eirTopbarCtrl.finderOptions.cancel()> Cancel </button> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { FeatureSwitchService } from \"../../../../common/services/feature-switch-service\";\r\nimport { Defines } from \"../../../../components/defines\";\r\nimport { Flexbox } from \"../../../../components/flexbox/flexbox\";\r\nimport { FrameworkService } from \"../../../../components/services/framework-service\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { IWizardStep, WizardCtrl } from \"../../wizard/wizard-ctrl\";\r\n\r\nimport { DEFAULT_BOUNDARY, InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\n\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type {\r\n\tIJsonCompositeComponent,\r\n\tIJsonCompositeComponentManifest\r\n} from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport type { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport type { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\n\r\nexport interface ICompositeComponentWizardScope extends IDialogBaseScope<IJsonComponent> {\r\n}\r\n\r\nexport class CompositeComponentWizardCtrl extends WizardCtrl {\r\n\r\n\tsteps: IWizardStep[] = [\r\n\t\t{\r\n\t\t\tid: \"composite-component-wizard-name.html\",\r\n\t\t\ttitle: \"Name\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./composite-component-wizard-name.html\")\r\n\t\t}, {\r\n\t\t\tid: \"composite-component-wizard-include.html\",\r\n\t\t\ttitle: \"Include\",\r\n\t\t\tuserTip: \"Which parts do you want included?\",\r\n\t\t\ttemplate: require(\"./composite-component-wizard-include.html\")\r\n\t\t}, {\r\n\t\t\tid: \"composite-component-wizard-summary.html\",\r\n\t\t\ttitle: \"Summary\",\r\n\t\t\tuserTip: \"Does this seem correct to you?\",\r\n\t\t\ttemplate: require(\"./composite-component-wizard-summary.html\")\r\n\t\t}\r\n\t];\r\n\r\n\tselectedComponent: IJsonComponent;\r\n\tsettingCompositeName: string;\r\n\tsettingIncludeDatasources = true;\r\n\tsettingIncludeInteractions = true;\r\n\tsettingIncludeTranslations = true;\r\n\tsettingIncludeExpressions = true;\r\n\tsettingIncludeBoundaries = true;\r\n\tcompositeComponent: IJsonCompositeComponent;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TEMPLATE_CACHE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ICompositeComponentWizardScope,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$templateCache: ng.ITemplateCacheService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t) {\r\n\t\tsuper(\r\n\t\t\t$scope,\r\n\t\t\t$element,\r\n\t\t\t$templateCache,\r\n\t\t\tfeatureService\r\n\t\t);\r\n\t\tthis.initWizard();\r\n\r\n\t\tthis.onComponentSelected(this.dialog.parameter);\r\n\r\n\t\tthis.settingIncludeTranslations = this.isFeatureTranslationEnabled();\r\n\t}\r\n\r\n\tonChangeCompositeName(): void {\r\n\t\tif (this.settingCompositeName) {\r\n\t\t\tthis.nextDisabled = false;\r\n\t\t} else {\r\n\t\t\tthis.nextDisabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onComponentSelected(component: IJsonComponent): void {\r\n\t\tthis.selectedComponent = component;\r\n\t\tthis.settingCompositeName = component.displayName;\r\n\t\tthis.onChangeCompositeName();\r\n\t}\r\n\r\n\tprivate getDatasources(): IJsonDatasource[] {\r\n\t\tconst datasourceIds: IMap<string> = {};\r\n\t\tthis.frameworkService.forEachComponent(this.selectedComponent, (component) => {\r\n\t\t\tif (component.datasource) {\r\n\t\t\t\tdatasourceIds[component.datasource] = \"\";\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn Object.keys(datasourceIds).map((datasourceId) => {\r\n\t\t\treturn this.frameworkService.getDatasource(datasourceId);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getInteractions(): IJsonInteraction[] {\r\n\t\tconst interactions: IJsonInteraction[] = [];\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\r\n\t\tcurrentProject.getInteractionDatabearers().forEach((interaction: IJsonInteraction) => {\r\n\t\t\tconst newInteraction = angular.copy(interaction);\r\n\t\t\tconst source = this.getComponentIdBySourceId(newInteraction.sourceName);\r\n\t\t\tconst target = this.getComponentIdBySourceId(newInteraction.targetName);\r\n\r\n\t\t\tif ((source || interaction.sourceName === \"Application\") && (target || interaction.targetName === \"Application\")) {\r\n\t\t\t\tif (interactions.indexOf(newInteraction) === -1) {\r\n\t\t\t\t\tinteractions.push(newInteraction);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn interactions;\r\n\t}\r\n\r\n\tprivate getTranslations(): IMap<IJsonLanguageComponent[]> {\r\n\t\tconst translations: IMap<IJsonLanguageComponent[]> = {};\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\r\n\t\tthis.frameworkService.forEachComponent(this.selectedComponent, component => {\r\n\t\t\t// Flexbox should never have translations except AppPanel\r\n\t\t\t// AppPanel has app header, do not include that.\r\n\t\t\tif (component.typedef !== Flexbox.name) {\r\n\t\t\t\tconst translation = currentProject.getTranslation(component.id);\r\n\t\t\t\tif (translation) {\r\n\t\t\t\t\ttranslations[component.id] = translation;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn angular.copy(translations);\r\n\t}\r\n\r\n\tprivate getExpressions(): IJsonExpression[] {\r\n\t\tconst expressions: IJsonExpression[] = [];\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\r\n\t\tthis.frameworkService.forEachComponent(this.selectedComponent, component => {\r\n\t\t\tif (component.typedef !== Flexbox.name) {\r\n\t\t\t\tconst componentExpressions = currentProject.getExpressionsByComponentId(component.id);\r\n\t\t\t\tif (componentExpressions.length > 0) {\r\n\t\t\t\t\texpressions.push(...componentExpressions);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn angular.copy(expressions);\r\n\t}\r\n\r\n\tprivate discardOutOfReachBindings(): void {\r\n\t\tlet binding: IJsonValueSource;\r\n\r\n\t\tthis.frameworkService.forEachComponent(this.selectedComponent, (component: any) => {\r\n\t\t\tDefines.allComponents[component.typedef].class.BINDABLE_FIELDS_2.forEach((field: any) => {\r\n\t\t\t\tbinding = component[field.ref];\r\n\t\t\t\tif (binding && binding.Type === BindingTypeEnum.BINDING) {\r\n\t\t\t\t\tconst source = this.getComponentIdBySourceId(binding.sourceName);\r\n\t\t\t\t\tif (!source) {\r\n\t\t\t\t\t\tbinding.sourceName = null;\r\n\t\t\t\t\t\tbinding.sourceKey = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getComponentIdBySourceId(valueName: string): string {\r\n\t\tlet componentId: string;\r\n\t\tthis.frameworkService.forEachComponent(this.selectedComponent, (component: IJsonComponent) => {\r\n\t\t\tif (valueName === component.id) {\r\n\t\t\t\tcomponentId = component.id;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn componentId;\r\n\t}\r\n\r\n\tprotected onChangeCurrentStep(): void {\r\n\t\tif (this.currentStep === this.steps[this.steps.length - 1]) {\r\n\t\t\tthis.compositeComponent = this.getFinishParameter();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected getFinishParameter(): IJsonCompositeComponent {\r\n\r\n\t\tconst manifest: IJsonCompositeComponentManifest = {\r\n\t\t\tid: null,\r\n\t\t\tdisplayName: this.settingCompositeName,\r\n\t\t\tauthor: null,\r\n\t\t\tcreationDate: null\r\n\t\t};\r\n\t\tthis.discardOutOfReachBindings();\r\n\t\tconst newCompositeComponent: IJsonCompositeComponent = {\r\n\t\t\tmanifest: manifest,\r\n\t\t\tcomponent: this.selectedComponent,\r\n\t\t};\r\n\t\tif (this.settingIncludeDatasources) {\r\n\t\t\tnewCompositeComponent.datasources = this.getDatasources();\r\n\t\t}\r\n\t\tif (this.settingIncludeInteractions) {\r\n\t\t\tnewCompositeComponent.interactions = this.getInteractions();\r\n\t\t}\r\n\t\tif (this.settingIncludeTranslations) {\r\n\t\t\tnewCompositeComponent.translations = this.getTranslations();\r\n\t\t}\r\n\t\tif (this.settingIncludeExpressions) {\r\n\t\t\tnewCompositeComponent.expressions = this.getExpressions();\r\n\t\t}\r\n\t\tif (!this.settingIncludeBoundaries) {\r\n\t\t\tthis.editorService.forEachComponent(newCompositeComponent.component, (component) => {\r\n\t\t\t\tconst defaultBoundarySettings = component.boundarySettings[DEFAULT_BOUNDARY.id];\r\n\t\t\t\tcomponent.boundarySettings = {};\r\n\t\t\t\tcomponent.boundarySettings[DEFAULT_BOUNDARY.id] = defaultBoundarySettings;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn newCompositeComponent;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirCompositeComponentWizardCtrl\", CompositeComponentWizardCtrl);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=field-short> <label>Name</label> <input type=text class=input-md ng-model=wizardCtrl.settingCompositeName ng-change=wizardCtrl.onChangeCompositeName() /> </div> <label>Selected Component</label> <div class=componentIcon> <label class=title>{{wizardCtrl.selectedComponent.displayName}}</label> <span class=\\\"image image-{{wizardCtrl.selectedComponent.typedef}}\\\"></span> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \" <div class=\\\"field-short include-wizard\\\"> <input type=checkbox class=checkbox id=wiz-include-datasource ng-model=wizardCtrl.settingIncludeDatasources> <label for=wiz-include-datasource class=checkbox-label>Data Services</label> </div> <div class=\\\"field-short include-wizard\\\"> <input type=checkbox class=checkbox id=wiz-include-interactions ng-model=wizardCtrl.settingIncludeInteractions> <label for=wiz-include-interactions class=checkbox-label>Interactions</label> </div> <div class=\\\"field-short include-wizard\\\" ng-if=::wizardCtrl.isFeatureTranslationEnabled()> <input type=checkbox class=checkbox id=wiz-include-translations ng-model=wizardCtrl.settingIncludeTranslations> <label for=wiz-include-translations class=checkbox-label>Translations</label> </div> <div class=\\\"field-short include-wizard\\\"> <input type=checkbox class=checkbox id=wiz-include-expressions ng-model=wizardCtrl.settingIncludeExpressions> <label for=wiz-include-expressions class=checkbox-label>Expressions</label> </div> <div class=\\\"field-short include-wizard\\\"> <input type=checkbox class=checkbox id=wiz-include-boundaries ng-model=wizardCtrl.settingIncludeBoundaries> <label for=wiz-include-boundaries class=checkbox-label>Boundaries</label> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<fieldset> <div class=summary-legend> <span>Name</span> <button xi-tooltip=\\\"'Edit Source'\\\" class=btn-tertiary type=button ng-click=wizardCtrl.selectWizardStepByIndex(0)> Edit </button> </div> <div class=summary-form> <div class=field> <span class=label>Name:</span> <span class=data>{{wizardCtrl.settingCompositeName}}</span> </div> </div> </fieldset> <fieldset> <div class=summary-legend> <span>Include</span> <button xi-tooltip=\\\"'Edit Source'\\\" class=btn-tertiary type=button ng-click=wizardCtrl.selectWizardStepByIndex(1)> Edit </button> </div> <div class=summary-form> <div class=field ng-if=wizardCtrl.settingIncludeDatasources> <span class=label>Data Services:</span> <span class=data ng-repeat=\\\"datasource in ::wizardCtrl.compositeComponent.datasources\\\">{{datasource.displayName}}</span> </div> </div> <div class=summary-form> <div class=field ng-if=wizardCtrl.settingIncludeInteractions> <span class=label>Interactions:</span> <span class=data ng-repeat=\\\"interactions in ::wizardCtrl.compositeComponent.interactions\\\">{{interactions.sourceName}}.{{interactions.sourceTriggerName}}->{{interactions.targetName}}.{{interactions.targetActionName}}</span> </div> </div> <div class=summary-form> <div class=field ng-if=\\\"::wizardCtrl.isFeatureTranslationEnabled() && wizardCtrl.settingIncludeTranslations\\\"> <span class=label>Translations: Included</span> </div> <div class=summary-form> <div class=field ng-if=::wizardCtrl.settingIncludeExpressions> <span class=label>Expressions: Included</span> </div> <div class=summary-form> <div class=field ng-if=::wizardCtrl.settingIncludeBoundaries> <span class=label>Boundaries: Included</span> </div> </div></div></div></fieldset> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=setting-category ng-repeat=\\\"settingCategory in eirGenericSettingsCtrl.relevantSettings\\\"> <div class=\\\"eir-content-component-settings general-content-settings is-default\\\"> <div class=\\\"accordion last-one-setting\\\" xi-control=accordion> <div class=accordion-header> <a class=title href=#> <span>{{settingCategory.title}}</span> </a> </div> <div class=accordion-pane> <div class=\\\"accordion-content setting-content\\\"> <div ng-switch=settingMeta.inputType ng-repeat=\\\"settingMeta in settingCategory.settings\\\"> <eir-checkbox-setting ng-switch-when=checkbox setting-meta=settingMeta register=\\\"eirGenericSettingsCtrl.registerSetting(settingCtrl, settingRef)\\\"></eir-checkbox-setting> <eir-switch-setting ng-switch-when=switch setting-meta=settingMeta register=\\\"eirGenericSettingsCtrl.registerSetting(settingCtrl, settingRef)\\\"></eir-switch-setting> <eir-dropdown-setting ng-switch-when=dropdown|color-picker ng-switch-when-separator=| setting-meta=settingMeta register=\\\"eirGenericSettingsCtrl.registerSetting(settingCtrl, settingRef)\\\"></eir-dropdown-setting> <eir-radiobutton-setting ng-switch-when=radiobutton setting-meta=settingMeta register=\\\"eirGenericSettingsCtrl.registerSetting(settingCtrl, settingRef)\\\"></eir-radiobutton-setting> <eir-text-setting ng-switch-when=text setting-meta=settingMeta register=\\\"eirGenericSettingsCtrl.registerSetting(settingCtrl, settingRef)\\\"></eir-text-setting> <eir-text-setting ng-switch-when=number setting-meta=settingMeta register=\\\"eirGenericSettingsCtrl.registerSetting(settingCtrl, settingRef)\\\"></eir-text-setting> <eir-margin-setting ng-switch-when=margin setting-meta=settingMeta register=\\\"eirGenericSettingsCtrl.registerSetting(settingCtrl, settingRef)\\\"></eir-margin-setting> <eir-border-setting ng-switch-when=border setting-meta=settingMeta register=\\\"eirGenericSettingsCtrl.registerSetting(settingCtrl, settingRef)\\\"></eir-border-setting> <div ng-switch-default> <div ng-include=settingMeta.url></div> </div> </div> </div> </div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=manage-dialog ng-controller=\\\"eirManageDatasourcesCtrl as ctrl\\\"> <div class=\\\"local-datagrid manage-datagrid\\\"> <div class=toolbar role=toolbar> <div class=buttonset> <div class=\\\"searchfield-wrapper toolbar-searchfield-wrapper\\\"> <label class=audible for=searchfield-local-datasource>Keyword Search</label> <input id=searchfield-local-datasource name=searchfield-local-datasource class=searchfield data-options=\\\"{ collapsible: true }\\\"/> </div> <button class=\\\"btn btn-menu\\\" type=button xi-tooltip=\\\"'Add Data Service'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>Add Data Service</span> </button> <ul class=\\\"popupmenu is-padded\\\"> <li> <a ng-click=ctrl.createLocalDatasource(true)> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-magic-wand></use> </svg> <span>Create from Wizard</span> </a> </li> <li class=separator></li> <li> <a ng-click=ctrl.openGlobalRepository()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add-from-repository></use> </svg> <span>Add from Repository</span> </a> </li> <li> <a ng-click=ctrl.import()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-import></use> </svg> <span>Import from File</span> </a> </li> <li> <a ng-click=ctrl.openMapper()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-compose></use> </svg> <span>Configure Data Service Manually</span> </a> </li> </ul> <button class=btn-tertiary type=button xi-tooltip=\\\"'Edit Data Service'\\\" ng-disabled=\\\"ctrl.selectedItems.length !== 1\\\" ng-click=ctrl.editDatasource()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-edit></use> </svg> <span>Edit</span> </button> <button class=btn-tertiary type=button xi-tooltip=\\\"'Delete'\\\" ng-disabled=!ctrl.itemSelected ng-click=ctrl.deleteItem()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> <button class=btn-tertiary type=button xi-tooltip=\\\"'Export Data Service'\\\" ng-disabled=!ctrl.itemSelected ng-click=ctrl.export()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-export></use> </svg> <span>Export</span> </button> </div> </div> <div xi-datagrid=ctrl.datagridOptions id=local-grid class=datagrid-contained></div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()> Close </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=sidebar-header> <div class=headline> <h3>Properties</h3> <div class=\\\"buttonContainer sidebar-options\\\"> <button class=btn-icon xi-tooltip=\\\"'Close'\\\" ng-click=eirSettingsCtrl.hideSidebar() ng-disabled=eirSettingsCtrl.showOverlay> <svg class=icon focusable=false> <use xlink:href=#icon-close></use> </svg> <span>Hide</span> </button> </div> </div> <h4>{{eirSettingsCtrl.selectedComponentClassName}}</h4> <div ng-show=eirSettingsCtrl.selectedComponent class=\\\"data-source-bar settingstopic\\\"> <div class=\\\"component-name field-short\\\"> <label for=displayNameSetting>Component Name</label> <input id=displayNameSetting class=input-md type=text ng-model=eirSettingsCtrl.selectedComponent.databearer.displayName ng-change=eirSettingsCtrl.onChangeDisplayName() ng-disabled=eirSettingsCtrl.showOverlay ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=field-short> <div class=datasource-labels> <label for=datasourceSetting>Data Service</label> <label class=\\\"hyperlink datasource-link\\\" ng-click=eirSettingsCtrl.manageDatasources()>Manage Data Services</label> </div> <select id=datasourceSetting class=dropdown-md ng-disabled=eirSettingsCtrl.showOverlay ng-model=eirSettingsCtrl.settingDatasource ng-change=\\\"eirSettingsCtrl.onChangeDatasource('{{eirSettingsCtrl.settingDatasource.id}}')\\\" ng-options=\\\"datasource.displayName for datasource in eirSettingsCtrl.availableDatasources track by datasource.id\\\" xi-drop-down=eirSettingsCtrl.dropdownSettings> </select> </div> </div> </div> <div class=sidebar-content> <div id=settings-tabs class=tab-container ng-if=eirSettingsCtrl.selectedComponent xi-tabs> <ul class=tab-list> <li class=tab ng-class=\\\"{'is-disabled': eirSettingsCtrl.showOverlay }\\\" ng-click=\\\"eirSettingsCtrl.changeSidebarTab('content')\\\"> <a href=#settings-tabs-content>Content</a> </li> <li class=tab ng-class=\\\"{'is-disabled': eirSettingsCtrl.showOverlay }\\\"> <a href=#settings-tabs-interactions>Interactions</a> </li> <li class=\\\"tab is-selected\\\" ng-class=\\\"{'is-disabled': eirSettingsCtrl.showOverlay }\\\" ng-click=\\\"eirSettingsCtrl.changeSidebarTab('style')\\\"> <a href=#settings-tabs-style>Style</a> </li> </ul> <div id=settings-tabs-content class=scrollable> <eir-content-settings-switch></eir-content-settings-switch> </div> <div id=settings-tabs-interactions class=scrollable> <eir-interaction-settings></eir-interaction-settings> </div> <div id=settings-tabs-style class=scrollable> <div class=boundary-info> <svg class=\\\"icon screen\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-screen></use> </svg> <p class=selectedBoundaryLabel> Style settings affects {{eirSettingsCtrl.currentBoundary.limitX ? eirSettingsCtrl.currentBoundary.limitX + ' px' : 'default' }} screen width and smaller </p> </div> <eir-style-settings-switch></eir-style-settings-switch> </div> </div> </div> <div class=sidebar-message ng-if=!(eirSettingsCtrl.selectedComponent)> <h4>No Component Selected</h4> </div> <div class=sidebar-overlay ng-if=eirSettingsCtrl.showOverlay> </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport type { IGenericSettingScope, ISettingController } from \"../generic-settings\";\r\n\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nimport { BorderType, InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonBorder } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nclass BorderSettingsCtrl extends SettingsBase implements ISettingController {\r\n\r\n\tborder: IJsonBorder;\r\n\tborderType: BorderType;\r\n\tborderAllValue: number;\r\n\tsettingTitle: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: IGenericSettingScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\tthis.onComponentChanged(this.selectedComponent);\r\n\t}\r\n\r\n\trefresh(): void {\r\n\t\tthis.settingTitle = \"Border\";\r\n\t\tconst border = angular.copy(this.readSettingValue<IJsonBorder>(this.$scope.settingMeta));\r\n\t\tif (border) {\r\n\t\t\tthis.border = border;\r\n\t\t\tthis.borderType =\r\n\t\t\t\tborder.top === border.right && border.right === border.bottom && border.bottom === border.left\r\n\t\t\t\t\t? BorderType.ALL\r\n\t\t\t\t\t: BorderType.INDIVIDUAL;\r\n\t\t\tthis.borderAllValue = border.top || 0;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tif (newComponent) {\r\n\t\t\tthis.selectedComponent = newComponent;\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(newBoundary: IBoundary): void {\r\n\t\tsuper.onBoundaryChanged(newBoundary);\r\n\t\tthis.refresh();\r\n\t}\r\n\r\n\tonChangeBorderType(type: BorderType): void {\r\n\t\tthis.borderType = type;\r\n\t\tthis.onChangeBorder();\r\n\t}\r\n\r\n\tonChangeBorder(): void {\r\n\t\tthis.checkForNull();\r\n\r\n\t\tif (this.borderType === BorderType.ALL) {\r\n\t\t\tthis.setBorderValues();\r\n\t\t}\r\n\t\tthis.onChangeSetting(this.$scope.settingMeta, this.border);\r\n\t}\r\n\r\n\tprivate checkForNull(): void {\r\n\t\tfor (const key in this.border) {\r\n\t\t\tif (this.border[key] === null) {\r\n\t\t\t\tthis.border[key] = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setBorderValues(): void {\r\n\t\tconst value = this.borderAllValue || 0;\r\n\t\tthis.border.top = value;\r\n\t\tthis.border.right = value;\r\n\t\tthis.border.bottom = value;\r\n\t\tthis.border.left = value;\r\n\t}\r\n}\r\n\r\nexport class BorderSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./border-setting.html\");\r\n\tscope = {\r\n\t\tsettingMeta: \"=\",\r\n\t\tregister: \"&\"\r\n\t};\r\n\tcontroller = BorderSettingsCtrl;\r\n\tcontrollerAs = \"eirBorderSettingsCtrl\";\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirBorderSetting\", () => new BorderSettingsDirective());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=content> <fieldset class=radio-group> <div class=field> <input type=radio class=radio name=border id=borderAll ng-value=1 ng-model=eirBorderSettingsCtrl.borderType ng-change=eirBorderSettingsCtrl.onChangeBorderType(1) /> <label for=borderAll class=radio-label>All Sides</label> </div> <div class=field> <input type=radio class=radio name=border id=borderIndividual ng-value=2 ng-model=eirBorderSettingsCtrl.borderType ng-change=eirBorderSettingsCtrl.onChangeBorderType(2) /> <label for=borderIndividual class=radio-label>Individual</label> </div> </fieldset> <div class=field-short ng-if=\\\"eirBorderSettingsCtrl.borderType === 1\\\"> <label>{{eirBorderSettingsCtrl.settingTitle}}</label> <input class=input-md type=number ng-model=eirBorderSettingsCtrl.borderAllValue ng-change=eirBorderSettingsCtrl.onChangeBorder() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=individual-settings> <div class=field-short ng-if=\\\"eirBorderSettingsCtrl.borderType === 2\\\"> <label>{{eirBorderSettingsCtrl.settingTitle}} Top</label> <input class=input-md type=number ng-model=eirBorderSettingsCtrl.border.top ng-change=eirBorderSettingsCtrl.onChangeBorder() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=field-short ng-if=\\\"eirBorderSettingsCtrl.borderType === 2\\\"> <label>{{eirBorderSettingsCtrl.settingTitle}} Right</label> <input class=input-md type=number ng-model=eirBorderSettingsCtrl.border.right ng-change=eirBorderSettingsCtrl.onChangeBorder() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=field-short ng-if=\\\"eirBorderSettingsCtrl.borderType === 2\\\"> <label>{{eirBorderSettingsCtrl.settingTitle}} Bottom</label> <input class=input-md type=number ng-model=eirBorderSettingsCtrl.border.bottom ng-change=eirBorderSettingsCtrl.onChangeBorder() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=field-short ng-if=\\\"eirBorderSettingsCtrl.borderType === 2\\\"> <label>{{eirBorderSettingsCtrl.settingTitle}} Left</label> <input class=input-md type=number ng-model=eirBorderSettingsCtrl.border.left ng-change=eirBorderSettingsCtrl.onChangeBorder() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { IGenericSettingScope, ISettingController } from \"../generic-settings\";\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nclass CheckboxSettingsCtrl extends SettingsBase implements ISettingController {\r\n\tpublic isChecked: boolean;\r\n\tpublic tooltip: string;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: IGenericSettingScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\t$scope.register({ settingCtrl: this, settingRef: $scope.settingMeta.ref });\r\n\t\tthis.tooltip =  $scope.settingMeta.tooltip;\r\n\t\tthis.button = $scope.settingMeta.button;\r\n\t\tthis.settingsRef = $scope.settingMeta.ref;\r\n\r\n\t\tthis.onComponentChanged(this.editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tpublic refresh(): void {\r\n\t\tthis.isChecked = this.readSettingValue<boolean>(this.$scope.settingMeta);\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tthis.selectedComponent = newComponent;\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(newBoundary: IBoundary): void {\r\n\t\tsuper.onBoundaryChanged(newBoundary);\r\n\t\tthis.refresh();\r\n\t}\r\n}\r\n\r\nexport class CheckboxSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./checkbox-setting.html\");\r\n\tscope = {\r\n\t\tsettingMeta: \"=\",\r\n\t\tregister: \"&\"\r\n\t};\r\n\tcontroller = CheckboxSettingsCtrl;\r\n\tcontrollerAs = \"eirCheckboxSettingsCtrl\";\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirCheckboxSetting\", () => new CheckboxSettingsDirective());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"{{eirCheckboxSettingsCtrl.button ? 'field with-button' : 'field'}}\\\"> <input class=checkbox type=checkbox id=toolbox-{{settingMeta.ref}} ng-model=eirCheckboxSettingsCtrl.isChecked ng-change=\\\"eirCheckboxSettingsCtrl.onChangeSetting(settingMeta, eirCheckboxSettingsCtrl.isChecked)\\\"/> <label class=checkbox-label for=toolbox-{{settingMeta.ref}} xi-tooltip=eirCheckboxSettingsCtrl.tooltip>{{settingMeta.title}}</label> <button class=btn-icon ng-if=eirCheckboxSettingsCtrl.button ng-click=eirCheckboxSettingsCtrl.onIconClick() xi-tooltip=\\\"'{{eirCheckboxSettingsCtrl.button.tooltip}}'\\\"> <svg class=icon focusable=false> <use xlink:href={{eirCheckboxSettingsCtrl.button.icon}}></use> </svg> </button> </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport type { IGenericSettingScope, ISettingController } from \"../generic-settings\";\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nimport { InjectNames, SettingInputKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nclass DropdownSettingsCtrl extends SettingsBase implements ISettingController {\r\n\tsettingValue: string;\r\n\ttooltip: string;\r\n\tisColorPicker: boolean;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprotected $scope: IGenericSettingScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\t$scope.register({ settingCtrl: this, settingRef: $scope.settingMeta.ref });\r\n\t\tthis.isColorPicker = $scope.settingMeta.inputType === SettingInputKeys.COLOR_PICKER;\r\n\t\tthis.button = $scope.settingMeta.button;\r\n\t\tthis.tooltip = $scope.settingMeta.tooltip;\r\n\t\tthis.settingsRef = $scope.settingMeta.ref;\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\r\n\t\tif (this.isColorPicker) {\r\n\t\t\tthis.initColorpicker();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* angularjs ng-change does not work well with color-picker\r\n\t* hijacking the change event instead\r\n\t*/\r\n\tprivate initColorpicker(): void {\r\n\t\tsetTimeout(() => {\r\n\t\t\tconst colorpickerElement = angular.element(\"#colorpickerLabel\" + this.settingsRef);\r\n\t\t\tcolorpickerElement.on(\"change\", () => {\r\n\t\t\t\tthis.onChangeSetting(this.$scope.settingMeta, this.settingValue);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\trefresh(): void {\r\n\t\tconst settingMeta = this.$scope.settingMeta;\r\n\t\tlet value = this.readSettingValue<string>(settingMeta);\r\n\t\tif (Helper.isUndefinedOrNull(value)) {\r\n\t\t\tvalue = settingMeta.defaultValue;\r\n\r\n\t\t\tif (Helper.isUndefined(value) && settingMeta.dataset?.length > 0) {\r\n\t\t\t\tvalue = settingMeta.dataset[0].value;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.settingValue = value;\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tthis.selectedComponent = newComponent;\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(newBoundary: IBoundary): void {\r\n\t\tsuper.onBoundaryChanged(newBoundary);\r\n\t\tthis.refresh();\r\n\t}\r\n}\r\n\r\nexport class DropdownSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./dropdown-setting.html\");\r\n\tscope = {\r\n\t\tsettingMeta: \"=\",\r\n\t\tregister: \"&\"\r\n\t};\r\n\tcontroller = DropdownSettingsCtrl;\r\n\tcontrollerAs = \"eirDropdownSettingsCtrl\";\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirDropdownSetting\", () => new DropdownSettingsDirective());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"field-short {{eirDropdownSettingsCtrl.button ? 'with-button' : ''}}\\\"> <div class=label-tooltip-field> <label ng-if=settingMeta.title>{{settingMeta.title}}</label> <svg ng-if=eirDropdownSettingsCtrl.tooltip class=icon focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'{{eirDropdownSettingsCtrl.tooltip}}'\\\"> <use xlink:href=#icon-info></use> </svg> </div> <select ng-if=!eirDropdownSettingsCtrl.isColorPicker id=dropdownLabel{{settingMeta.ref}} class=\\\"dropdown dropdown-md\\\" ng-model=eirDropdownSettingsCtrl.settingValue ng-change=\\\"eirDropdownSettingsCtrl.onChangeSetting(settingMeta, eirDropdownSettingsCtrl.settingValue)\\\" ng-options=\\\"item.value as item.name for item in settingMeta.dataset\\\" xi-drop-down=settingMeta.dataset> </select> <input class=\\\"colorpicker colorpicker-input-lg\\\" id=colorpickerLabel{{settingMeta.ref}} ng-if=eirDropdownSettingsCtrl.isColorPicker xi-color-picker ng-model=eirDropdownSettingsCtrl.settingValue> <button class=btn-icon ng-if=eirDropdownSettingsCtrl.button ng-click=eirDropdownSettingsCtrl.onIconClick() xi-tooltip=\\\"'{{eirDropdownSettingsCtrl.button.tooltip}}'\\\"> <svg class=icon focusable=false> <use xlink:href={{eirDropdownSettingsCtrl.button.icon}}></use> </svg> </button> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { InjectNames, MarginType } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonMargin } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { IGenericSettingScope, ISettingController } from \"../generic-settings\";\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nclass MarginSettingsCtrl extends SettingsBase implements ISettingController {\r\n\r\n\tpublic margin: IJsonMargin;\r\n\tpublic marginType: MarginType;\r\n\tpublic marginAllValue: number;\r\n\tpublic settingTitle: string;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: IGenericSettingScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\tthis.onComponentChanged(this.selectedComponent);\r\n\t}\r\n\r\n\tpublic refresh(): void {\r\n\t\tthis.settingTitle = this.selectedComponent.isLayoutComponent() ? \"Padding\" : \"Margin\";\r\n\r\n\t\tconst margin = angular.copy(this.readSettingValue<IJsonMargin>(this.$scope.settingMeta));\r\n\t\tthis.margin = margin;\r\n\t\tthis.marginType =\r\n\t\t\tmargin.top === margin.right && margin.right === margin.bottom && margin.bottom === margin.left\r\n\t\t\t\t? MarginType.ALL\r\n\t\t\t\t: MarginType.INDIVIDUAL;\r\n\t\tthis.marginAllValue = margin.top || 0;\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tif (newComponent) {\r\n\t\t\tthis.selectedComponent = newComponent;\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(newBoundary: IBoundary): void {\r\n\t\tsuper.onBoundaryChanged(newBoundary);\r\n\t\tthis.refresh();\r\n\t}\r\n\r\n\tpublic onChangeMarginType(type: MarginType): void {\r\n\t\tthis.marginType = type;\r\n\t\tthis.onChangeMargin();\r\n\t}\r\n\r\n\tpublic onChangeMargin(): void {\r\n\t\tthis.checkForNull();\r\n\r\n\t\tif (this.marginType === MarginType.ALL) {\r\n\t\t\tthis.setMarginValues();\r\n\t\t}\r\n\t\tthis.onChangeSetting(this.$scope.settingMeta, this.margin);\r\n\t}\r\n\r\n\tprivate checkForNull(): void {\r\n\t\tfor (const key in this.margin) {\r\n\t\t\tif (this.margin[key] === null) {\r\n\t\t\t\tthis.margin[key] = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setMarginValues(): void {\r\n\t\tconst value = this.marginAllValue || 0;\r\n\t\tthis.margin.top = value;\r\n\t\tthis.margin.right = value;\r\n\t\tthis.margin.bottom = value;\r\n\t\tthis.margin.left = value;\r\n\t}\r\n}\r\n\r\nexport class MarginSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./margin-setting.html\");\r\n\tscope = {\r\n\t\tsettingMeta: \"=\",\r\n\t\tregister: \"&\"\r\n\t};\r\n\tcontroller = MarginSettingsCtrl;\r\n\tcontrollerAs = \"eirMarginSettingsCtrl\";\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirMarginSetting\", () => new MarginSettingsDirective());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=content> <fieldset class=radio-group> <div class=field> <input type=radio class=radio name=margin id=marginAll ng-value=1 ng-model=eirMarginSettingsCtrl.marginType ng-change=eirMarginSettingsCtrl.onChangeMarginType(1) /> <label for=marginAll class=radio-label>All Sides</label> </div> <div class=field> <input type=radio class=radio name=margin id=marginIndividual ng-value=2 ng-model=eirMarginSettingsCtrl.marginType ng-change=eirMarginSettingsCtrl.onChangeMarginType(2) /> <label for=marginIndividual class=radio-label>Individual</label> </div> </fieldset> <div class=field-short ng-if=\\\"eirMarginSettingsCtrl.marginType === 1\\\"> <label>{{eirMarginSettingsCtrl.settingTitle}}</label> <input class=input-md type=number ng-model=eirMarginSettingsCtrl.marginAllValue ng-change=eirMarginSettingsCtrl.onChangeMargin() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=individual-settings> <div class=field-short ng-if=\\\"eirMarginSettingsCtrl.marginType === 2\\\"> <label>{{eirMarginSettingsCtrl.settingTitle}} Top</label> <input class=input-md type=number ng-model=eirMarginSettingsCtrl.margin.top ng-change=eirMarginSettingsCtrl.onChangeMargin() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=field-short ng-if=\\\"eirMarginSettingsCtrl.marginType === 2\\\"> <label>{{eirMarginSettingsCtrl.settingTitle}} Right</label> <input class=input-md type=number ng-model=eirMarginSettingsCtrl.margin.right ng-change=eirMarginSettingsCtrl.onChangeMargin() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=field-short ng-if=\\\"eirMarginSettingsCtrl.marginType === 2\\\"> <label>{{eirMarginSettingsCtrl.settingTitle}} Bottom</label> <input class=input-md type=number ng-model=eirMarginSettingsCtrl.margin.bottom ng-change=eirMarginSettingsCtrl.onChangeMargin() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=field-short ng-if=\\\"eirMarginSettingsCtrl.marginType === 2\\\"> <label>{{eirMarginSettingsCtrl.settingTitle}} Left</label> <input class=input-md type=number ng-model=eirMarginSettingsCtrl.margin.left ng-change=eirMarginSettingsCtrl.onChangeMargin() ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { IGenericSettingScope, ISettingController } from \"../generic-settings\";\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nclass RadiobuttonSettingsCtrl extends SettingsBase implements ISettingController {\r\n\tpublic radioSetting: string;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: IGenericSettingScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\t$scope.register({ settingCtrl: this, settingRef: $scope.settingMeta.ref });\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tpublic refresh(): void {\r\n\t\tthis.radioSetting = this.readSettingValue<string>(this.$scope.settingMeta);\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tthis.selectedComponent = newComponent;\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(newBoundary: IBoundary): void {\r\n\t\tsuper.onBoundaryChanged(newBoundary);\r\n\t\tthis.refresh();\r\n\t}\r\n}\r\n\r\nexport class RadiobuttonSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./radiobutton-setting.html\");\r\n\tscope = {\r\n\t\tsettingMeta: \"=\",\r\n\t\tregister: \"&\"\r\n\t};\r\n\tcontroller = RadiobuttonSettingsCtrl;\r\n\tcontrollerAs = \"eirRadiobuttonSettingsCtrl\";\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirRadiobuttonSetting\", () => new RadiobuttonSettingsDirective());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<fieldset class=radio-group> <div class=field ng-repeat=\\\"item in settingMeta.dataset track by item.value\\\"> <input type=radio class=radio id=radiosetting-{{::settingMeta.ref}}-{{::item.value}} ng-value=item.value ng-model=eirRadiobuttonSettingsCtrl.radioSetting name=radiosetting-{{::settingMeta.ref}} ng-change=\\\"eirRadiobuttonSettingsCtrl.onChangeSetting(settingMeta, eirRadiobuttonSettingsCtrl.radioSetting)\\\"/> <label for=radiosetting-{{::settingMeta.ref}}-{{::item.value}} class=radio-label>{{item.name}}</label> </div> </fieldset>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { IGenericSettingScope, ISettingController } from \"../generic-settings\";\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nclass SwitchSettingsCtrl extends SettingsBase implements ISettingController {\r\n\tpublic isSwitched: boolean;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: IGenericSettingScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\t$scope.register({ settingCtrl: this, settingRef: $scope.settingMeta.ref });\r\n\t\tthis.button = $scope.settingMeta.button;\r\n\t\tthis.settingsRef = $scope.settingMeta.ref;\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tpublic refresh(): void {\r\n\t\tthis.isSwitched = this.readSettingValue<boolean>(this.$scope.settingMeta);\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tthis.selectedComponent = newComponent;\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(newBoundary: IBoundary): void {\r\n\t\tsuper.onBoundaryChanged(newBoundary);\r\n\t\tthis.refresh();\r\n\t}\r\n}\r\n\r\nexport class SwitchSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./switch-setting.html\");\r\n\tscope = {\r\n\t\tsettingMeta: \"=\",\r\n\t\tregister: \"&\"\r\n\t};\r\n\tcontroller = SwitchSettingsCtrl;\r\n\tcontrollerAs = \"eirSwitchSettingsCtrl\";\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirSwitchSetting\", () => new SwitchSettingsDirective());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"switch {{eirCheckboxSettingsCtrl.button ? 'with-button' : ''}}\\\"> <input class=switch type=checkbox id=toolbox-{{settingMeta.ref}} ng-model=eirSwitchSettingsCtrl.isSwitched ng-change=\\\"eirSwitchSettingsCtrl.onChangeSetting(settingMeta, eirSwitchSettingsCtrl.isSwitched)\\\"/> <label class=checkbox-label for=toolbox-{{settingMeta.ref}}>{{settingMeta.title}}</label> <button class=btn-icon ng-if=eirSwitchSettingsCtrl.button ng-click=eirSwitchSettingsCtrl.onIconClick() xi-tooltip=\\\"'{{eirSwitchSettingsCtrl.button.tooltip}}'\\\"> <svg class=icon focusable=false> <use xlink:href={{eirSwitchSettingsCtrl.button.icon}}></use> </svg> </button> </div>\";\n// Exports\nmodule.exports = code;","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { IGenericSettingScope, ISettingController } from \"../generic-settings\";\r\nimport { SettingsBase } from \"../settings-base\";\r\n\r\nexport class TextSettingsCtrl extends SettingsBase implements ISettingController {\r\n\tpublic textSetting: string;\r\n\tpublic inputType: string;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: IGenericSettingScope,\r\n\t\teditorService: EditorService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\t\t$scope.register({ settingCtrl: this, settingRef: $scope.settingMeta.ref });\r\n\t\tthis.inputType = $scope.settingMeta.inputType;\r\n\t\tthis.button = $scope.settingMeta.button;\r\n\t\tthis.settingsRef = $scope.settingMeta.ref;\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tpublic refresh(): void {\r\n\t\tthis.textSetting = this.readSettingValue<string>(this.$scope.settingMeta);\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tthis.selectedComponent = newComponent;\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\t}\r\n\r\n\tprotected onBoundaryChanged(newBoundary: IBoundary): void {\r\n\t\tsuper.onBoundaryChanged(newBoundary);\r\n\t\tthis.refresh();\r\n\t}\r\n}\r\n\r\nexport class TextSettingsDirective implements ng.IDirective {\r\n\ttemplate = require(\"./text-setting.html\");\r\n\tscope = {\r\n\t\tsettingMeta: \"=\",\r\n\t\tregister: \"&\"\r\n\t};\r\n\tcontroller = TextSettingsCtrl;\r\n\tcontrollerAs = \"eirTextSettingsCtrl\";\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirTextSetting\", () => new TextSettingsDirective());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"field-short {{eirTextSettingsCtrl.button ? 'with-button' : ''}}\\\"> <label>{{settingMeta.title}}</label> <input type={{eirTextSettingsCtrl.inputType}} class=input-md ng-model=eirTextSettingsCtrl.textSetting ng-change=\\\"eirTextSettingsCtrl.onChangeSetting(settingMeta, eirTextSettingsCtrl.textSetting)\\\" ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> <button class=btn-icon ng-if=eirTextSettingsCtrl.button ng-click=eirTextSettingsCtrl.onIconClick() xi-tooltip=\\\"'{{eirTextSettingsCtrl.button.tooltip}}'\\\"> <svg class=icon focusable=false> <use xlink:href={{eirTextSettingsCtrl.button.icon}}></use> </svg> </button> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { InjectNames, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { DialogService } from \"../../../common/services/dialog-service\";\r\nimport { Defines } from \"../../../components/defines\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { ISourceComponent, SourceComponent } from \"../defines\";\r\nimport { EditorService } from \"../services/editor-service\";\r\nimport { SettingsBase } from \"./settings-base\";\r\n\r\nexport class AttributeSettingsCtrl extends SettingsBase {\r\n\r\n\tpublic bindableFieldDefinitions: IJsonBindableField[];\r\n\tpublic availableSources: ISourceComponent[];\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: ng.IScope,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\teditorService: EditorService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tsuper($scope, editorService);\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tthis.selectedComponent = newComponent;\r\n\r\n\t\tthis.bindableFieldDefinitions = [];\r\n\t\t// Using timeout to re-initialize all valuesource-settings\r\n\t\tthis.$timeout(() => {\r\n\t\t\tif (this.selectedComponent) {\r\n\t\t\t\tconst availableSources = [\r\n\t\t\t\t\tSourceComponent.STATIC_VALUE_OBJECT,\r\n\t\t\t\t\tSourceComponent.TARGET_CONTEXT_OBJECT,\r\n\t\t\t\t\tSourceComponent.URL_VALUE_OBJECT\r\n\t\t\t\t];\r\n\r\n\t\t\t\tconst components = this.editorService.getAllBindableComponents();\r\n\t\t\t\tcomponents.forEach((component) => {\r\n\t\t\t\t\tavailableSources.push({\r\n\t\t\t\t\t\tid: component.getId(),\r\n\t\t\t\t\t\tname: component.getDisplayName(),\r\n\t\t\t\t\t\tisComponent: true\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.availableSources = availableSources;\r\n\t\t\t\tconst bindableFieldDefinitions: IJsonBindableField[] =\r\n\t\t\t\t\tDefines.allComponents[this.selectedComponent.getTypedef()].class.BINDABLE_FIELDS_2;\r\n\r\n\t\t\t\tthis.bindableFieldDefinitions =\r\n\t\t\t\t\tbindableFieldDefinitions.filter((bField) => {\r\n\t\t\t\t\t\treturn bField.write;\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic save(saveTranslations: boolean): void {\r\n\t\t// dont save undo here\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.CANVAS_COMPONENTS);\r\n\t\tif (saveTranslations) {\r\n\t\t\tthis.editorService.getAllTranslatableComponents().forEach((component) => {\r\n\t\t\t\tcomponent.initializeBindings();\r\n\t\t\t});\r\n\t\t\tthis.editorService.projectSettingsChangedEvent.raise(\r\n\t\t\t\tthis.editorService.getCurrentProject().getManifest()\r\n\t\t\t);\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.TRANSLATIONS);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class AttributeSettingsDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirAttributeSettings\", () => {\r\n\t\t\treturn {\r\n\t\t\t\ttemplate: require(\"./attribute-settings.html\"),\r\n\t\t\t\tscope: {},\r\n\t\t\t\tcontroller: AttributeSettingsCtrl,\r\n\t\t\t\tcontrollerAs: \"eirAttributeSettingsCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=settingstopic ng-if=eirAttributeSettingsCtrl.selectedComponent ng-repeat=\\\"bindableFieldDefinition in eirAttributeSettingsCtrl.bindableFieldDefinitions track by bindableFieldDefinition.ref\\\" ng-show=\\\"{{bindableFieldDefinition.condition ? 'eirGenericSettingsCtrl.selectedComponent.'+bindableFieldDefinition.condition : true}}\\\"> <eir-valuesource-settings target-component=eirAttributeSettingsCtrl.selectedComponent target-field-metadata=bindableFieldDefinition value-source-object=eirAttributeSettingsCtrl.selectedComponent.getBindableField(bindableFieldDefinition.ref) available-sources=eirAttributeSettingsCtrl.availableSources expandable-setting=true on-save=eirAttributeSettingsCtrl.save($saveTranslations)> </eir-valuesource-settings> </div>\";\n// Exports\nmodule.exports = code;","import { Defines } from \"../defines\";\r\nimport { EditorHelper } from \"../helper\";\r\n\r\nexport class SettingsSwitchers {\r\n\tprivate static contentSettingsTemplate: string;\r\n\tprivate static styleSettingsTemplate: string;\r\n\r\n\tprivate static commonStyleSettingsTemplate =\r\n\t\t\"<eir-generic-settings settings-tab=\\\"'style'\\\"></eir-generic-settings>\";\r\n\tprivate static commonContentSettingsTemplate =\r\n\t\"<eir-attribute-settings>\" +\r\n\t\"</eir-attribute-settings>\" +\r\n\t\"<eir-generic-settings settings-tab=\\\"'content'\\\"></eir-generic-settings>\";\r\n\r\n\tprivate static addComponentSettingsSwitches(m: ng.IModule): void {\r\n\t\tlet contentSettingsTemplate = \"<div>\";\r\n\t\tcontentSettingsTemplate += \"<div ng-switch on='eirSettingsCtrl.selectedComponent.getTypedef()'>\";\r\n\r\n\t\tlet styleSettingsTemplate = \"<div>\";\r\n\t\tstyleSettingsTemplate += \"<div ng-switch on='eirSettingsCtrl.selectedComponent.getTypedef()'>\";\r\n\r\n\t\tfor (const componentName in Defines.allSettingsComponents) {\r\n\t\t\tconst settingsClass = EditorHelper.getComponentSettingsClass(componentName);\r\n\t\t\tif (settingsClass.contentSettingsDirective) {\r\n\t\t\t\tconst contentSettingDirectiveName = \"contentsetting\" + componentName.toLowerCase();\r\n\t\t\t\tm.directive(contentSettingDirectiveName, () => settingsClass.contentSettingsDirective);\r\n\t\t\t\tcontentSettingsTemplate +=\r\n\t\t\t\t\t`<${contentSettingDirectiveName} ng-switch-when=${componentName}></${contentSettingDirectiveName}>`;\r\n\t\t\t}\r\n\t\t\tif (settingsClass.styleSettingsDirective) {\r\n\t\t\t\tconst styleSettingDirectiveName = \"stylesetting\" + componentName.toLowerCase();\r\n\t\t\t\tm.directive(styleSettingDirectiveName, () => settingsClass.styleSettingsDirective);\r\n\r\n\t\t\t\tstyleSettingsTemplate +=\r\n\t\t\t\t\t`<${styleSettingDirectiveName} ng-switch-when=${componentName}></${styleSettingDirectiveName}>`;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcontentSettingsTemplate += \"</div>\" + this.commonContentSettingsTemplate + \"</div>\";\r\n\t\tstyleSettingsTemplate += \"</div>\" + this.commonStyleSettingsTemplate + \"</div>\";\r\n\t\tthis.contentSettingsTemplate = contentSettingsTemplate;\r\n\t\tthis.styleSettingsTemplate = styleSettingsTemplate;\r\n\t}\r\n\r\n\tstatic addComponentSettings(m: ng.IModule): void {\r\n\t\tthis.addComponentSettingsSwitches(m);\r\n\r\n\t\tm.directive(\"eirStyleSettingsSwitch\", [() => {\r\n\t\t\treturn {\r\n\t\t\t\trestrict: \"E\",\r\n\t\t\t\treplace: true,\r\n\t\t\t\tscope: true,\r\n\t\t\t\ttemplate: this.styleSettingsTemplate,\r\n\t\t\t\tlink: ($scope: ng.IScope, $element: ng.IAugmentedJQuery) => {\r\n\t\t\t\t\t// important to stop \"updated\" from bubbling to tab-control\r\n\t\t\t\t\t$element.on(\"updated\", (e: JQueryEventObject) => {\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}]);\r\n\r\n\t\tm.directive(\"eirContentSettingsSwitch\", [() => {\r\n\t\t\treturn {\r\n\t\t\t\trestrict: \"E\",\r\n\t\t\t\treplace: true,\r\n\t\t\t\tscope: true,\r\n\t\t\t\ttemplate: this.contentSettingsTemplate,\r\n\t\t\t\tlink: ($scope: ng.IScope, $element: ng.IAugmentedJQuery) => {\r\n\t\t\t\t\t// important to stop \"updated\" from bubbling to tab-control\r\n\t\t\t\t\t$element.on(\"updated\", (e: JQueryEventObject) => {\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}]);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { isNil } from \"lodash\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { IChanged, InjectNames, RegexStrings, SaveFlagsEnum, SubstitutionTags } from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { ILanguage, IMongooseString } from \"ng2/common/model/language.model\";\r\nimport { IAvailableSourceField } from \"../../../../common/defines\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport { IComponent } from \"../../../../common/IComponent\";\r\nimport { IAutoCompleteOptions } from \"../../../../common/model/sohoxi/sohoxi-autocomplete.model\";\r\nimport { ILookupOptions } from \"../../../../common/model/sohoxi/sohoxi-lookup.model\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../../../common/services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"../../../../common/shared-components/base/feature-switch-ctrl\";\r\nimport { Datagrid } from \"../../../../components/datagrid/datagrid\";\r\nimport { Dropdown } from \"../../../../components/dropdown/dropdown\";\r\nimport { List } from \"../../../../components/list/list\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { ISourceComponent, SourceComponent } from \"../../defines\";\r\nimport { BindingManagementService } from \"../../services/binding-management-service\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { InteractionManagementService } from \"../../services/interaction-management-service\";\r\nimport { IEditBindingDialogParameter } from \"./edit-binding-dialog\";\r\n\r\nexport interface IValueSourceSettingsScope extends ng.IScope {\r\n\ttargetComponent: IEditorComponent;\r\n\tcreateBindings: boolean;\r\n\ttargetFieldMetadata: IJsonBindableField;\r\n\tvalueSourceObject: IJsonValueSource;\r\n\tavailableSources: ISourceComponent[];\r\n\tisContextAvailable: boolean;\r\n\texpandableSetting: boolean;\r\n\tonSave: Function;\r\n}\r\n\r\nexport class ValuesourceSettingsCtrl extends FeatureSwitchCtrl {\r\n\t// createBindings is set to false from ParameterHandlerCtrl\r\n\tprivate createBindings: boolean;\r\n\tpublic expandableSetting: boolean;\r\n\r\n\tpublic htmlEncode = Helper.htmlEncode;\r\n\tpublic ValueTypeEnum = ValueTypeEnum;\r\n\tpublic BindingTypeEnum = BindingTypeEnum;\r\n\tpublic targetComponent: IEditorComponent;\r\n\tpublic isFinderActive = false;\r\n\r\n\t// all sources. dropdown 1\r\n\tpublic availableSources: ISourceComponent[];\r\n\t// all sources fields. dropdown 2\r\n\tpublic availableSourceFields: IAvailableSourceField[] = [];\r\n\r\n\t// chosen value from dropdown 1\r\n\tpublic settingSource: ISourceComponent;\r\n\t// chosen value from dropdown 2\r\n\tpublic settingSourceField: IAvailableSourceField;\r\n\r\n\t// static value in field 2\r\n\tpublic settingStaticValue: string | boolean;\r\n\t// resulting value from substituted string\r\n\tpublic filteredValue = {\r\n\t\tname: \"\",\r\n\t\ttooltip: \"\"\r\n\t};\r\n\tpublic onSave: Function;\r\n\tpublic lookupOptions: ILookupOptions;\r\n\tpublic autocompleteOptions: IAutoCompleteOptions;\r\n\tprotected unsubscribers: Function[] = [];\r\n\tprivate selectedComponent: IEditorComponent;\r\n\tpublic isLocalized: boolean;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.BINDING_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprotected $scope: IValueSourceSettingsScope,\r\n\t\tprotected $element: ng.IAugmentedJQuery,\r\n\t\tprotected $timeout: ng.ITimeoutService,\r\n\t\tprotected editorService: EditorService,\r\n\t\tprivate bindingManagementService: BindingManagementService,\r\n\t\tprivate interactionManagementService: InteractionManagementService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tfeatureService: FeatureSwitchService\r\n\t) {\r\n\t\tsuper(featureService);\r\n\t\tthis.createBindings = !($scope.createBindings === false);\r\n\t\tthis.expandableSetting = !Helper.isUndefinedOrNull($scope.expandableSetting);\r\n\r\n\t\tthis.availableSources = $scope.availableSources;\r\n\t\tthis.targetComponent = $scope.targetComponent;\r\n\t\tthis.onSave = $scope.onSave;\r\n\t\tthis.isLocalized = this.$scope.targetFieldMetadata.valueType === ValueTypeEnum.LOCALIZED_STRING;\r\n\t\tthis.selectedComponent = this.targetComponent;\r\n\r\n\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\r\n\t\tthis.unsubscribers.push(editorService.selectedDatasourceChangedEvent.on(() => {\r\n\t\t\tif (this.createBindings) { // Changeing Datasource sometimes auto-sets bindableField\r\n\t\t\t\tthis.$scope.valueSourceObject = this.selectedComponent.getBindableField(this.$scope.targetFieldMetadata.ref);\r\n\t\t\t}\r\n\t\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t\t}), editorService.urlVariableChangedEvent.on(() => {\r\n\t\t\tthis.onComponentChanged(editorService.getSelectedComponent());\r\n\t\t\tthis.onSourceChanged();\r\n\t\t}), editorService.translationChangedEvent.on((componentTranslation) => {\r\n\t\t\tif (this.selectedComponent.getId() === componentTranslation.component\r\n\t\t\t\t&& this.$scope.targetFieldMetadata.ref === componentTranslation.reference) {\r\n\t\t\t\tthis.settingStaticValue = componentTranslation.newValue;\r\n\t\t\t\tthis.onStaticValueChanged();\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t//Init xi-components\r\n\t\tthis.lookupOptions = this.translationManagementService.getLookupOptions();\r\n\t\tthis.autocompleteOptions = this.translationManagementService.getAutoOptions();\r\n\t}\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.$timeout(() => {\r\n\t\t\tthis.initInputElement();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initInputElement(): void {\r\n\t\tconst inputElement = this.$element.find(\"input#staticvalue\" + this.$scope.targetFieldMetadata.ref);\r\n\t\tinputElement.on(\"selected\", () => {\r\n\t\t\tthis.settingStaticValue = \"{\" + inputElement.val() + \"}\";\r\n\t\t\tthis.onStaticValueChanged();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate save(): void {\r\n\t\tthis.onSave({ $saveTranslations: this.isLocalized });\r\n\t}\r\n\r\n\t/**\r\n\t * Helper method to reset settingSource, and scope.valueSourceObject\r\n\t *\r\n\t * @private\r\n\t *\r\n\t * @memberOf ValuesourceSettingsCtrl\r\n\t */\r\n\tprivate resetSources(): void {\r\n\t\t// reset setting source\r\n\t\tthis.settingSource = SourceComponent.STATIC_VALUE_OBJECT;\r\n\t\tthis.settingSourceField = null;\r\n\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\r\n\t\t// remove bindings\r\n\t\tconst oldSourceKey = valueSourceObject.sourceKey;\r\n\t\tif (oldSourceKey) {\r\n\t\t\tthis.unregisterPossibleBindings();\r\n\t\t}\r\n\r\n\t\t// reset scope.valueSourceObject\r\n\t\tvalueSourceObject.Type = BindingTypeEnum.STATIC_VALUE;\r\n\t\tvalueSourceObject.value = \"\";\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * This method is for very long values for dropdowns in the UI\r\n\t *\r\n\t * @public\r\n\t * @param {string} currentValue\r\n\t * @returns {string}\r\n\t * @memberOf ValuesourceSettingsCtrl\r\n\t */\r\n\tpublic getExampleData(currentValue: string): string {\r\n\t\tconst maxLength = 30;\r\n\t\treturn currentValue.length > maxLength ? currentValue.substr(0, maxLength) + \"...\" : currentValue;\r\n\t}\r\n\r\n\tpublic getTypedef(): string {\r\n\t\treturn this.selectedComponent.getTypedef();\r\n\t}\r\n\r\n\t/**\r\n\t * Method to open the translation dialog\r\n\t *\r\n\t * @public\r\n\t *\r\n\t * @memberOf ValuesourceSettingsCtrl\r\n\t */\r\n\tpublic openTranslations(): void {\r\n\t\tconst propertyName = this.$scope.targetFieldMetadata.ref;\r\n\t\tthis.translationManagementService.openTranslations(this.selectedComponent, propertyName).then((result) => {\r\n\t\t\tconst okButton = result.button === DialogButtonType.Ok;\r\n\t\t\tconst data = result.value as IChanged;\r\n\t\t\tconst selectedChanged = data.savedComponentStrings.filter((translation) => {\r\n\t\t\t\treturn translation.component === this.selectedComponent.getId();\r\n\t\t\t});\r\n\t\t\tif (okButton && selectedChanged) {\r\n\t\t\t\tselectedChanged.forEach((updatedTranslation) => {\r\n\t\t\t\t\tif (updatedTranslation.reference === this.$scope.targetFieldMetadata.ref) {\r\n\t\t\t\t\t\tthis.settingStaticValue = updatedTranslation.newValue;\r\n\t\t\t\t\t\tthis.onStaticValueChanged();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// if selected component changed add undo\r\n\t\t\t\tthis.editorService.addUndoStack(this.editorService.getCurrentProject());\r\n\t\t\t}\r\n\t\t\tif (okButton) {\r\n\t\t\t\tif (data.savedComponentStrings.length > 0) {\r\n\t\t\t\t\tdata.savedComponentStrings.forEach((value) => {\r\n\t\t\t\t\t\tconst component = this.editorService.getComponentInstanceById(value.component);\r\n\t\t\t\t\t\tcomponent.forEachBindable((binding) => {\r\n\t\t\t\t\t\t\tif (binding.ref === value.reference) {\r\n\t\t\t\t\t\t\t\tconst field = component.getBindableField(value.reference);\r\n\t\t\t\t\t\t\t\tfield.value = value.newValue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t}\r\n\r\n\t\t\t//If global translations is changed\r\n\t\t\tif (okButton && !angular.equals({}, data.savedGlobalStrings)) {\r\n\t\t\t\tthis.translationManagementService.saveGlobalTranslations(data.savedGlobalStrings).then(() => {\r\n\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t//If global translations is deleted\r\n\t\t\tif (okButton && !angular.equals({}, data.deletedGlobalStrings)) {\r\n\t\t\t\tthis.translationManagementService.deleteGlobalTranslations(result.value.deletedGlobalStrings).then(() => {\r\n\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (okButton) {\r\n\t\t\t\tthis.save();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic useFinder(componentToSet: string): void {\r\n\t\tthis.isFinderActive = true;\r\n\t\tthis.editorService.startFinderMode({ title: \"Select Component\" })\r\n\t\t\t.then((component: IEditorComponent) => {\r\n\t\t\t\tconst typedef = component.getTypedef();\r\n\t\t\t\tif ((component.isLayoutComponent() ||\r\n\t\t\t\t\ttypedef === Dropdown.name ||\r\n\t\t\t\t\ttypedef === List.name ||\r\n\t\t\t\t\ttypedef === Datagrid.name) &&\r\n\t\t\t\t\tisNil(component.getDatasource())) {\r\n\t\t\t\t\tconst title = \"Error\";\r\n\t\t\t\t\tconst message = \"The selected \" + typedef.toLowerCase() + \" component is empty and does not have any data to bind from.\\n\" +\r\n\t\t\t\t\t\t\"Please select another component or attach a data service to the selected component.\";\r\n\t\t\t\t\tthis.dialogService.showError(title, message);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (componentToSet === \"parameterSource\") {\r\n\t\t\t\t\t\tthis.settingSource = this.createSettingSource(component);\r\n\t\t\t\t\t\tthis.onSourceChanged();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.isFinderActive = false;\r\n\t\t\t});\r\n\t}\r\n\r\n\tprotected onComponentChanged(newComponent: IEditorComponent): void {\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tconst targetContextComponent = this.targetComponent ? this.targetComponent : this.selectedComponent;\r\n\t\tconst targetFieldMetadata = this.$scope.targetFieldMetadata;\r\n\r\n\t\tif (targetContextComponent) {\r\n\t\t\tif ((valueSourceObject && targetFieldMetadata && targetFieldMetadata.valueType !== ValueTypeEnum.BOOLEAN) ||\r\n\t\t\t\t!targetFieldMetadata\r\n\t\t\t) {\r\n\t\t\t\tconst bindingType = valueSourceObject.Type;\r\n\t\t\t\tthis.setSettingSource(bindingType, targetContextComponent);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setSettingSource(bindingType: BindingTypeEnum, component: IEditorComponent): void {\r\n\t\tconst bindingValueValid = (value: string) => {\r\n\t\t\t// Fallback for old projects that (unnessesarily) saved current value in the \"value\"-property\r\n\t\t\tif (value && value.indexOf(SubstitutionTags.VALUE) > -1) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tswitch (bindingType) {\r\n\t\t\tcase BindingTypeEnum.STATIC_VALUE:\r\n\t\t\t\tthis.settingSource = SourceComponent.STATIC_VALUE_OBJECT;\r\n\t\t\t\tthis.settingSourceField = null;\r\n\t\t\t\tthis.settingStaticValue = valueSourceObject.value;\r\n\t\t\t\tbreak;\r\n\t\t\tcase BindingTypeEnum.BINDING:\r\n\t\t\t\tif (!bindingValueValid(valueSourceObject.value)) {\r\n\t\t\t\t\tvalueSourceObject.value = SubstitutionTags.VALUE;\r\n\t\t\t\t}\r\n\t\t\t\tconst sourceComponentInstance =\r\n\t\t\t\t\tthis.editorService.getComponentInstanceById(valueSourceObject.sourceName);\r\n\t\t\t\tif (sourceComponentInstance) {\r\n\t\t\t\t\tthis.settingSource = this.createSettingSource(sourceComponentInstance);\r\n\t\t\t\t\tsourceComponentInstance.getBindingMetaData().then((availableBindings) => {\r\n\t\t\t\t\t\tthis.setAvailableBindings(availableBindings);\r\n\t\t\t\t\t\tthis.setSelectedBinding(valueSourceObject.sourceKey);\r\n\t\t\t\t\t\tthis.updateBinding(valueSourceObject.sourceKey, valueSourceObject.value);\r\n\t\t\t\t\t\tthis.updatePreviewValue();\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {// If the target component has been removed, go to static mode\r\n\t\t\t\t\tthis.resetSources();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase BindingTypeEnum.CONTEXT_BINDING:\r\n\t\t\t\tif (!bindingValueValid(valueSourceObject.value)) {\r\n\t\t\t\t\tvalueSourceObject.value = SubstitutionTags.VALUE;\r\n\t\t\t\t}\r\n\t\t\t\tthis.settingSource = SourceComponent.TARGET_CONTEXT_OBJECT;\r\n\t\t\t\t// MUPS-488 Should be applied here, optimize by getting contextMetaData in attribute-settings/parameterHandler\r\n\t\t\t\tcomponent.getContextMetaData().then((availableBindings) => {\r\n\t\t\t\t\tthis.setAvailableBindings(availableBindings);\r\n\t\t\t\t\tthis.setSelectedBinding(valueSourceObject.sourceKey);\r\n\t\t\t\t\tthis.updateBinding(valueSourceObject.sourceKey, valueSourceObject.value);\r\n\t\t\t\t\tthis.updatePreviewValue();\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase BindingTypeEnum.URL_BINDING: {\r\n\t\t\t\tthis.settingSource = SourceComponent.URL_VALUE_OBJECT;\r\n\t\t\t\tconst availableBindings = this.editorService.getUrlMetaData();\r\n\t\t\t\tthis.setAvailableBindings(availableBindings);\r\n\t\t\t\tthis.setSelectedBinding(valueSourceObject.sourceKey);\r\n\t\t\t\tthis.updatePreviewValue();\r\n\t\t\t\tthis.settingStaticValue = valueSourceObject.value;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\"[ValuesourceSettingsDirective] Unknown binding type\", valueSourceObject.Type);\r\n\r\n\t\t\t\t// elements needs to update because sometimes the dropdown can't be opened.\r\n\t\t\t\tangular.element(\"#srckey\" + this.$scope.targetFieldMetadata.ref).data(\"dropdown\").updated();\r\n\t\t\t\tangular.element(\"#srcctrl\" + this.$scope.targetFieldMetadata.ref).data(\"dropdown\").updated();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setAvailableBindings(availableBindings: IAvailableSourceField[]): void {\r\n\t\tthis.availableSourceFields = availableBindings;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates source setting\r\n\t *\r\n\t * @private\r\n\t * @param {IComponent} componentInstance\r\n\t * @returns {ISourceComponent}\r\n\t *\r\n\t * @memberOf ValuesourceSettingsCtrl\r\n\t */\r\n\tprivate createSettingSource(componentInstance: IComponent): ISourceComponent {\r\n\t\tconst settingSource = {\r\n\t\t\tid: componentInstance.getId(),\r\n\t\t\tname: componentInstance.getDisplayName(),\r\n\t\t\tisComponent: true\r\n\t\t};\r\n\t\treturn settingSource;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets selected binding if any\r\n\t *\r\n\t * @private\r\n\t * @param {string} sourceKey\r\n\t *\r\n\t * @memberOf ValuesourceSettingsCtrl\r\n\t */\r\n\tprivate setSelectedBinding(sourceKey: string): void {\r\n\t\tif (sourceKey) {\r\n\t\t\tthis.settingSourceField = this.availableSourceFields.find(sourceField =>\r\n\t\t\t\tsourceField.sourceKey.toLowerCase() === sourceKey.toLowerCase());\r\n\r\n\t\t\tif (!this.settingSourceField) {\r\n\t\t\t\tthis.settingSourceField = this.availableSourceFields[0];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onSourceChanged(): void {\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tconst settingSource = this.settingSource;\r\n\r\n\t\tthis.unregisterPossibleBindings();\r\n\r\n\t\t// Reset all available resources and\r\n\t\tthis.availableSourceFields = [];\r\n\t\tthis.settingSourceField = null;\r\n\t\tvalueSourceObject.value = \"\";\r\n\r\n\t\tif (settingSource.isComponent) {\r\n\t\t\tvalueSourceObject.Type = BindingTypeEnum.BINDING;\r\n\t\t\tconst componentInstance = this.editorService.getComponentInstanceById(settingSource.id);\r\n\t\t\tthis.setAvailableBindingsByComponentMetaData(componentInstance);\r\n\r\n\t\t} else { // Local context,static value or Url value selected\r\n\t\t\tvalueSourceObject.sourceName = null;\r\n\t\t\tvalueSourceObject.sourceKey = null;\r\n\r\n\t\t\tswitch (settingSource.id) {\r\n\t\t\t\tcase SourceComponent.STATIC_VALUE_OBJECT.id:\r\n\t\t\t\t\tvalueSourceObject.Type = BindingTypeEnum.STATIC_VALUE;\r\n\t\t\t\t\tthis.onStaticValueChanged();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase SourceComponent.URL_VALUE_OBJECT.id:\r\n\t\t\t\t\tvalueSourceObject.Type = BindingTypeEnum.URL_BINDING;\r\n\t\t\t\t\tconst availableBindings = this.editorService.getUrlMetaData();\r\n\t\t\t\t\tthis.availableSourceFields = availableBindings;\r\n\t\t\t\t\tthis.settingSourceField = availableBindings[0];\r\n\t\t\t\t\tif (this.settingSourceField) {\r\n\t\t\t\t\t\tthis.onSourceFieldChanged();\r\n\t\t\t\t\t\tthis.updateCurrentSource();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.settingStaticValue = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: //case SourceComponent.TARGET_CONTEXT_OBJECT.id:\r\n\t\t\t\t\tvalueSourceObject.Type = BindingTypeEnum.CONTEXT_BINDING;\r\n\t\t\t\t\tconst contextComponent = this.targetComponent ? this.targetComponent : this.selectedComponent;\r\n\r\n\t\t\t\t\tcontextComponent.getContextMetaData().then((availableBindings: IAvailableSourceField[]) => {\r\n\t\t\t\t\t\tthis.availableSourceFields = availableBindings;\r\n\t\t\t\t\t\tthis.settingSourceField = availableBindings[0];\r\n\t\t\t\t\t\tthis.onSourceFieldChanged();\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onUrlValueChanged(): void {\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tif (this.settingStaticValue !== valueSourceObject.value) {\r\n\t\t\tconst urlVariables = this.editorService.getUrlMetaData();\r\n\t\t\tconst myUrlVariable = urlVariables.find((urlVariable) => {\r\n\t\t\t\treturn urlVariable.sourceKey === valueSourceObject.sourceKey;\r\n\t\t\t});\r\n\t\t\tmyUrlVariable.currentValue = this.settingStaticValue;\r\n\t\t\tthis.editorService.setUrlMetaData(urlVariables);\r\n\t\t\tvalueSourceObject.value = this.settingStaticValue;\r\n\r\n\t\t\t// Update potential bindings on all components/interactions\r\n\t\t\tthis.updateBindingValues();\r\n\t\t\tthis.interactionManagementService.updateAndSaveParameters(\r\n\t\t\t\tmyUrlVariable.sourceKey,\r\n\t\t\t\tthis.settingStaticValue as string\r\n\t\t\t);\r\n\t\t\tthis.editorService.initializeUrlBindings(myUrlVariable.currentValue, myUrlVariable.sourceKey);\r\n\r\n\t\t\t//Save without translations\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.CANVAS_COMPONENTS);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic openUrlDialog(): void {\r\n\t\tthis.editorService.openURLDialog();\r\n\t}\r\n\r\n\tprivate setAvailableBindingsByComponentMetaData(component: IEditorComponent): void {\r\n\t\tcomponent.getBindingMetaData().then((availableBindings) => {\r\n\t\t\tif (availableBindings.length) {\r\n\t\t\t\tthis.availableSourceFields = availableBindings;\r\n\t\t\t\tthis.settingSourceField = availableBindings[0];\r\n\t\t\t\tthis.onSourceFieldChanged();\r\n\t\t\t} else { // If it's a component with no available bindings, set to static\r\n\t\t\t\tthis.resetSources();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * For updating the current source to correct one\r\n\t *\r\n\t * @private\r\n\t * @memberof ValuesourceSettingsCtrl\r\n\t */\r\n\tprivate updateCurrentSource(): void {\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tvalueSourceObject.sourceName = this.settingSource.id;\r\n\t\tvalueSourceObject.sourceKey = this.settingSourceField.sourceKey;\r\n\t}\r\n\r\n\tprivate unregisterPossibleBindings(): void {\r\n\t\tthis.bindingManagementService.unregisterBinding(\r\n\t\t\tthis.selectedComponent,\r\n\t\t\tthis.$scope.targetFieldMetadata.ref,\r\n\t\t\tthis.$scope.valueSourceObject\r\n\t\t);\r\n\t\tthis.bindingManagementService.unregisterContextBinding(\r\n\t\t\tthis.selectedComponent,\r\n\t\t\tthis.$scope.valueSourceObject.sourceKey,\r\n\t\t\tthis.$scope.targetFieldMetadata.ref\r\n\t\t);\r\n\r\n\t\t//Removing the sourceKey on potential URL-binding\r\n\t\tthis.$scope.valueSourceObject.sourceKey = null;\r\n\t}\r\n\r\n\tpublic onSourceFieldChanged(): void {\r\n\t\tconst newSourceField = this.settingSourceField;\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tconst oldSourceKey = this.$scope.valueSourceObject.sourceKey;\r\n\t\tconst targetKey = this.$scope.targetFieldMetadata.ref;\r\n\r\n\t\tif (oldSourceKey && this.createBindings) {\r\n\t\t\tthis.unregisterPossibleBindings();\r\n\t\t}\r\n\r\n\t\tif (newSourceField) {\r\n\t\t\tconst isContextBinding = valueSourceObject.Type === BindingTypeEnum.CONTEXT_BINDING;\r\n\t\t\tconst isBinding = valueSourceObject.Type === BindingTypeEnum.BINDING;\r\n\t\t\tconst isUrlBinding = valueSourceObject.Type === BindingTypeEnum.URL_BINDING;\r\n\t\t\tif (isContextBinding || isBinding) {\r\n\t\t\t\tif (valueSourceObject.value === \"\") {\r\n\t\t\t\t\tvalueSourceObject.value = SubstitutionTags.VALUE;\r\n\t\t\t\t}\r\n\t\t\t\t// Special fix for List. Should be removed once List is refactored.\r\n\t\t\t\tconst generatingParent = this.selectedComponent.getGeneratingParent() as IComponent;\r\n\t\t\t\tif (generatingParent.getTypedef() === List.name) {\r\n\t\t\t\t\tconst parentListComponent = generatingParent as List;\r\n\t\t\t\t\tparentListComponent.refresh();\r\n\t\t\t\t}\r\n\t\t\t\tthis.updateBinding(targetKey, valueSourceObject.value);\r\n\t\t\t}\r\n\t\t\tif (isUrlBinding) {\r\n\t\t\t\tif (newSourceField.currentValue) {\r\n\t\t\t\t\tthis.settingStaticValue = newSourceField.currentValue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.settingStaticValue = \"\";\r\n\t\t\t\t}\r\n\t\t\t\tthis.updateCurrentSource();\r\n\t\t\t\tthis.onUrlValueChanged();\r\n\t\t\t}\r\n\t\t\tif (isContextBinding) {\r\n\t\t\t\tvalueSourceObject.visibleName = newSourceField.visibleName.replace(\"(\" + newSourceField.sourceKeyShort + \")\", \"\");\r\n\t\t\t}\r\n\t\t\tthis.save();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateBinding(targetKey: string, value: string): void {\r\n\t\tthis.updateCurrentSource();\r\n\t\tthis.updateBindingValues();\r\n\t\tif (!this.selectedComponent.isGenerated &&\r\n\t\t\tthis.selectedComponent.isTranslatableComponent()\r\n\t\t) {\r\n\t\t\tthis.setTranslation(this.selectedComponent.getId(), targetKey, value);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onStaticValueChanged(): void {\r\n\t\tthis.$scope.valueSourceObject.value = this.settingStaticValue;\r\n\t\tconst property = this.$scope.targetFieldMetadata.ref;\r\n\r\n\t\tif (typeof this.settingStaticValue === \"string\") {\r\n\t\t\tlet exists = true;\r\n\t\t\tconst trimmedValue = this.settingStaticValue.match(RegexStrings.GLOBALSTRING);\r\n\t\t\tif (trimmedValue && trimmedValue[1]) {\r\n\t\t\t\tif (trimmedValue[0] !== SubstitutionTags.VALUE) {\r\n\t\t\t\t\texists = this.checkGlobalValue(trimmedValue[1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (exists || !trimmedValue) {\r\n\t\t\t\tthis.updateSave();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.updateSave();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate checkGlobalValue(value: string): boolean {\r\n\t\tlet exists = true;\r\n\t\tconst globalValue = this.translationManagementService.getGlobalString(value);\r\n\t\tif (!globalValue) {\r\n\t\t\texists = false;\r\n\t\t\tangular.element(\"#autocomplete-list\").hide();\r\n\t\t\tthis.createNewString(value).then((result) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.updateSave();\r\n\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn exists;\r\n\t}\r\n\r\n\tprivate updateSave(): void {\r\n\t\tthis.updateBindingValues();\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tprivate createNewString(value: string): ng.IPromise<IDialogResult<IMongooseString>> {\r\n\t\treturn this.translationManagementService.openNewStringDialog(value).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.settingStaticValue = \"{\" + result.value.Name + \"}\";\r\n\t\t\t\tthis.translationManagementService.addGlobalString(result.value);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updatePreviewValue(): void {\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tconst value = valueSourceObject.value;\r\n\t\tconst isContextBinding = valueSourceObject.Type === BindingTypeEnum.CONTEXT_BINDING;\r\n\t\tconst isBinding = valueSourceObject.Type === BindingTypeEnum.BINDING;\r\n\t\tif (isContextBinding || isBinding) {\r\n\t\t\t// If value is falsy or only contains substitution tag, default to \"\"\r\n\t\t\tif (!value || value === SubstitutionTags.VALUE) {\r\n\t\t\t\tthis.filteredValue = {\r\n\t\t\t\t\tname: \"\",\r\n\t\t\t\t\ttooltip: \"\"\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tthis.filteredValue.name = Helper.joinWithDefauldEmptyString(\r\n\t\t\t\t\tvalueSourceObject.value.split(SubstitutionTags.VALUE),\r\n\t\t\t\t\tthis.settingSourceField.currentValue\r\n\t\t\t\t);\r\n\t\t\t\tthis.filteredValue.tooltip = Helper.htmlEncode(this.filteredValue.name);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateBindingValues(): void {\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tconst metadata = this.$scope.targetFieldMetadata;\r\n\t\tconst selectedComponent = this.selectedComponent;\r\n\r\n\t\tthis.updatePreviewValue();\r\n\t\t// dont register if valueSource is on Event Parameter\r\n\t\tif (this.createBindings) {\r\n\t\t\tif (selectedComponent.isGenerated) {\r\n\t\t\t\tconst generatingParent = selectedComponent.getGeneratingParent() as IComponent;\r\n\t\t\t\tif (generatingParent.getTypedef() === List.name) {\r\n\t\t\t\t\tconst parentListComponent = generatingParent as List;\r\n\t\t\t\t\tthis.editorService.forEachComponent(parentListComponent.currentTemplate, (subComponent) => {\r\n\t\t\t\t\t\tif (subComponent.id === selectedComponent.getId()) {\r\n\t\t\t\t\t\t\t(subComponent as any)[metadata.ref] = valueSourceObject;\r\n\t\t\t\t\t\t\t// TODO: break\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tswitch (valueSourceObject.Type) {\r\n\t\t\t\t\tcase BindingTypeEnum.BINDING:\r\n\t\t\t\t\t\tif (metadata.valueType === ValueTypeEnum.LOCALIZED_STRING) {\r\n\t\t\t\t\t\t\tthis.setTranslation(selectedComponent.getId(), metadata.ref, valueSourceObject.value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.bindingManagementService.registerBinding(\r\n\t\t\t\t\t\t\tselectedComponent,\r\n\t\t\t\t\t\t\tmetadata.ref,\r\n\t\t\t\t\t\t\tvalueSourceObject\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.CONTEXT_BINDING:\r\n\t\t\t\t\t\tif (metadata.valueType === ValueTypeEnum.LOCALIZED_STRING) {\r\n\t\t\t\t\t\t\tthis.setTranslation(selectedComponent.getId(), metadata.ref, valueSourceObject.value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.bindingManagementService.registerContextBinding(\r\n\t\t\t\t\t\t\tselectedComponent,\r\n\t\t\t\t\t\t\tmetadata.ref,\r\n\t\t\t\t\t\t\tvalueSourceObject\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.URL_BINDING:\r\n\t\t\t\t\t\tselectedComponent.setBindableValue(metadata.ref,\r\n\t\t\t\t\t\t\tthis.editorService.getUrlValue(valueSourceObject.sourceKey));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.STATIC_VALUE:\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tif (metadata.valueType === ValueTypeEnum.LOCALIZED_STRING) {\r\n\t\t\t\t\t\t\tthis.setTranslation(selectedComponent.getId(), metadata.ref, this.settingStaticValue as string);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tselectedComponent.setBindableValue(metadata.ref, this.settingStaticValue);\r\n\t\t\t\t}\r\n\t\t\t\t// if selected component value is changed, add undo.\r\n\t\t\t\tthis.editorService.addUndoStack(this.editorService.getCurrentProject());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setTranslation(componentId: string, reference: string, value: string): void {\r\n\t\tconst currentLanguageKey = this.translationManagementService.getSelectedLocale();\r\n\t\tconst newValue: ILanguage = {\r\n\t\t\tlocale: currentLanguageKey,\r\n\t\t\tvalue: value\r\n\t\t};\r\n\t\tthis.translationManagementService.setTranslatableStringByProperty(componentId, reference, newValue);\r\n\t}\r\n\r\n\tpublic editBinding(): void {\r\n\t\tconst valueSourceObject = this.$scope.valueSourceObject;\r\n\t\tconst dialogOptions: IDialogOptions<IEditBindingDialogParameter> = {\r\n\t\t\ttemplate: require(\"./edit-binding-dialog.html\"),\r\n\t\t\ttitle: \"Edit binding\",\r\n\t\t\tcssClass: \"edit-binding-dialog\",\r\n\t\t\tparameter: {\r\n\t\t\t\tbindingString: valueSourceObject.value,\r\n\t\t\t\tvalueType: this.$scope.targetFieldMetadata.valueType,\r\n\t\t\t\tproperty: this.$scope.targetFieldMetadata.ref\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.dialogService.show(dialogOptions).then((result) => {\r\n\t\t\tconst buttonOK = result.button === DialogButtonType.Ok;\r\n\t\t\tconst isValueChanged = valueSourceObject.value !== result.value;\r\n\t\t\tif (buttonOK && isValueChanged) {\r\n\t\t\t\tvalueSourceObject.value = result.value;\r\n\t\t\t\tthis.updateBindingValues();\r\n\t\t\t\tthis.save();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class ValuesourceSettingsDirective {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirValuesourceSettings\", () => {\r\n\t\t\treturn {\r\n\t\t\t\ttemplate: require(\"./valuesource-settings.html\"),\r\n\t\t\t\tscope:\r\n\t\t\t\t{\r\n\t\t\t\t\ttargetComponent: \"=?\",\r\n\t\t\t\t\ttargetFieldMetadata: \"=\",\r\n\t\t\t\t\tvalueSourceObject: \"=\",\r\n\t\t\t\t\tavailableSources: \"=\",\r\n\t\t\t\t\tcreateBindings: \"=?\",\r\n\t\t\t\t\texpandableSetting: \"<?\",\r\n\t\t\t\t\tonSave: \"&\"\r\n\t\t\t\t},\r\n\t\t\t\tcontroller: ValuesourceSettingsCtrl,\r\n\t\t\t\tcontrollerAs: \"eirValuesourceSettingsCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirEditBindingCtrl as $ctrl\\\"> <div class=with-button> <label for=binding-string></label> <input id=binding-string type=text class=\\\"{{$ctrl.isLocalized ? 'lookup' : 'no-lookup'}}\\\" ng-model=$ctrl.bindingString ng-change=$ctrl.onChangeBindingString() xi-lookup=$ctrl.lookupOptions /> <button class=btn-icon xi-tooltip=\\\"'Translations'\\\" ng-if=\\\"::$ctrl.isFeatureTranslationEnabled() && $ctrl.isLocalized\\\" ng-click=$ctrl.openTranslations()> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-translate></use> </svg> <span class=audible>Translations</span> </button> </div> <label ng-show=$ctrl.invalidString>You need to include substitution tag: \\\"{{$ctrl.substitutionTag}}\\\"</label> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=$ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-disabled=$ctrl.invalidString ng-click=$ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \" <div ng-if=\\\"::(expandableSetting !== true)\\\"> <div class=metadata-setting ng-show=\\\"targetFieldMetadata.valueType !== eirValuesourceSettingsCtrl.ValueTypeEnum.BOOLEAN\\\"> <p class=metadata-heading>{{targetFieldMetadata ? targetFieldMetadata.name : 'None'}}</p> <div class=\\\"field-short with-button\\\"> <label for=srcctrl{{targetFieldMetadata.ref}}>Source</label> <select id=srcctrl{{targetFieldMetadata.ref}} class=\\\"dropdown dropdown-sm\\\" ng-model=eirValuesourceSettingsCtrl.settingSource ng-change=eirValuesourceSettingsCtrl.onSourceChanged() ng-disabled=eirValuesourceSettingsCtrl.isFinderActive ng-options=\\\"availableSource as availableSource.name for availableSource in availableSources track by availableSource.id\\\" xi-drop-down=eirValuesourceSettingsCtrl.dropdownSettings> </select> <button class=btn-icon xi-tooltip=\\\"'Find Component'\\\" ng-click=\\\"eirValuesourceSettingsCtrl.useFinder('parameterSource')\\\" ng-disabled=eirValuesourceSettingsCtrl.isFinderActive> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-map-pin></use> </svg> <span class=audible>Find Component</span> </button> </div> <div class=\\\"field-short with-button\\\" ng-show=\\\"valueSourceObject.Type !== eirValuesourceSettingsCtrl.BindingTypeEnum.STATIC_VALUE\\\"> <label for=srckey{{targetFieldMetadata.ref}}>Data Field</label> <select id=srckey{{targetFieldMetadata.ref}} class=\\\"dropdown dropdown-sm\\\" ng-model=eirValuesourceSettingsCtrl.settingSourceField ng-disabled=eirValuesourceSettingsCtrl.isFinderActive ng-change=eirValuesourceSettingsCtrl.onSourceFieldChanged() ng-options=\\\"availBinding as availBinding.visibleName + (availBinding.currentValue ? '('+ eirValuesourceSettingsCtrl.getExampleData(availBinding.currentValue) +') ' : '') for availBinding in eirValuesourceSettingsCtrl.availableSourceFields\\\" xi-drop-down=eirValuesourceSettingsCtrl.dropdownSettings> </select> <button class=btn-icon xi-tooltip=\\\"'Open Url Management Dialog'\\\" ng-show=\\\"valueSourceObject.Type === eirValuesourceSettingsCtrl.BindingTypeEnum.URL_BINDING\\\" ng-click=eirValuesourceSettingsCtrl.openUrlDialog()> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-link></use> </svg> <span class=audible>Url Management Dialog</span> </button> <button class=btn-icon xi-tooltip=\\\"'Edit binding'\\\" ng-hide=\\\"valueSourceObject.Type === eirValuesourceSettingsCtrl.BindingTypeEnum.URL_BINDING\\\" ng-click=eirValuesourceSettingsCtrl.editBinding() ng-disabled=eirValuesourceSettingsCtrl.isFinderActive> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-edit></use> </svg> <span class=audible>Edit Binding</span> </button> <label class=value-preview xi-tooltip=eirValuesourceSettingsCtrl.filteredValue.tooltip ng-show=eirValuesourceSettingsCtrl.filteredValue.name>{{eirValuesourceSettingsCtrl.filteredValue.name}}</label> </div> <div class=field-short ng-show=\\\"valueSourceObject.Type === eirValuesourceSettingsCtrl.BindingTypeEnum.STATIC_VALUE\\\" ng-class=\\\"{ 'with-button': eirValuesourceSettingsCtrl.isFeatureTranslationEnabled() && eirValuesourceSettingsCtrl.isLocalized }\\\"> <label for=staticvalue{{targetFieldMetadata.ref}}>Display Value</label> <input type=text id=staticvalue{{targetFieldMetadata.ref}} class=\\\"input-sm {{eirValuesourceSettingsCtrl.isLocalized ? 'lookup' : 'no-lookup'}}\\\" ng-disabled=\\\"(eirValuesourceSettingsCtrl.getTypedef() === 'Dropdown' && targetFieldMetadata.ref === 'displayValue') || eirValuesourceSettingsCtrl.isFinderActive\\\" ng-model=eirValuesourceSettingsCtrl.settingStaticValue ng-change=eirValuesourceSettingsCtrl.onStaticValueChanged() xi-autocomplete=eirValuesourceSettingsCtrl.autocompleteOptions xi-lookup=eirValuesourceSettingsCtrl.lookupOptions ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> <button class=btn-icon xi-tooltip=\\\"'Translations'\\\" ng-if=\\\"::eirValuesourceSettingsCtrl.isFeatureTranslationEnabled() && eirValuesourceSettingsCtrl.isLocalized\\\" ng-click=eirValuesourceSettingsCtrl.openTranslations()> <svg class=icon focusable=false> <use xlink:href=#translate-icon></use> </svg> <span class=audible>Translations</span> </button> </div> <div class=\\\"field-short with-button\\\" ng-show=\\\"valueSourceObject.Type === eirValuesourceSettingsCtrl.BindingTypeEnum.URL_BINDING\\\"> <div class=url-value-label> <label for=urlvalue{{targetFieldMetadata.ref}}>URL Value</label> <svg class=icon focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'This is a temporary value for testing purposes only'\\\"> <use xlink:href=#icon-info></use> </svg> </div> <input type=text id=urlvalue{{targetFieldMetadata.ref}} class=input-md ng-model=eirValuesourceSettingsCtrl.settingStaticValue ng-change=eirValuesourceSettingsCtrl.onUrlValueChanged() ng-disabled=!valueSourceObject.sourceKey ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> </div> </div> <div class=accordion ng-if=\\\"::(expandableSetting === true)\\\" xi-control=accordion> <div class=accordion-header> <a class=title href=#> <span>{{targetFieldMetadata ? targetFieldMetadata.name : 'None'}}</span> </a> </div> <div class=accordion-pane> <div class=accordion-content ng-show=\\\"targetFieldMetadata.valueType !== eirValuesourceSettingsCtrl.ValueTypeEnum.BOOLEAN\\\"> <div class=\\\"field-short with-button\\\"> <label for=srcctrl{{targetFieldMetadata.ref}}>Source</label> <select id=srcctrl{{targetFieldMetadata.ref}} class=\\\"dropdown dropdown-sm\\\" ng-model=eirValuesourceSettingsCtrl.settingSource ng-change=eirValuesourceSettingsCtrl.onSourceChanged() ng-disabled=eirValuesourceSettingsCtrl.isFinderActive ng-options=\\\"availableSource as availableSource.name for availableSource in availableSources track by availableSource.id\\\" xi-drop-down=eirValuesourceSettingsCtrl.dropdownSettings> </select> <button class=btn-icon xi-tooltip=\\\"'Find Component'\\\" ng-click=\\\"eirValuesourceSettingsCtrl.useFinder('parameterSource')\\\" ng-disabled=eirValuesourceSettingsCtrl.isFinderActive> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-map-pin></use> </svg> <span class=audible>Find Component</span> </button> </div> <div class=\\\"field-short with-button\\\" ng-show=\\\"valueSourceObject.Type !== eirValuesourceSettingsCtrl.BindingTypeEnum.STATIC_VALUE\\\"> <label for=srckey{{targetFieldMetadata.ref}}>Data Field</label> <select id=srckey{{targetFieldMetadata.ref}} class=\\\"dropdown dropdown-sm\\\" ng-model=eirValuesourceSettingsCtrl.settingSourceField ng-disabled=eirValuesourceSettingsCtrl.isFinderActive ng-change=eirValuesourceSettingsCtrl.onSourceFieldChanged() ng-options=\\\"availBinding as availBinding.visibleName + (availBinding.currentValue ? '('+ eirValuesourceSettingsCtrl.getExampleData(availBinding.currentValue) +') ' : '') for availBinding in eirValuesourceSettingsCtrl.availableSourceFields\\\" xi-drop-down=eirValuesourceSettingsCtrl.dropdownSettings> </select> <button class=btn-icon xi-tooltip=\\\"'Open Url Management Dialog'\\\" ng-show=\\\"valueSourceObject.Type === eirValuesourceSettingsCtrl.BindingTypeEnum.URL_BINDING\\\" ng-click=eirValuesourceSettingsCtrl.openUrlDialog()> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-link></use> </svg> <span class=audible>Url Management Dialog</span> </button> <button class=btn-icon xi-tooltip=\\\"'Edit binding'\\\" ng-hide=\\\"valueSourceObject.Type === eirValuesourceSettingsCtrl.BindingTypeEnum.URL_BINDING\\\" ng-click=eirValuesourceSettingsCtrl.editBinding() ng-disabled=eirValuesourceSettingsCtrl.isFinderActive> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-edit></use> </svg> <span class=audible>Edit Binding</span> </button> <label class=value-preview xi-tooltip=eirValuesourceSettingsCtrl.filteredValue.tooltip ng-show=eirValuesourceSettingsCtrl.filteredValue.name>{{eirValuesourceSettingsCtrl.filteredValue.name}}</label> </div> <div class=field-short ng-if=\\\"valueSourceObject.Type === eirValuesourceSettingsCtrl.BindingTypeEnum.STATIC_VALUE\\\" ng-class=\\\"{ 'with-button': eirValuesourceSettingsCtrl.isFeatureTranslationEnabled() && eirValuesourceSettingsCtrl.isLocalized }\\\"> <label for=staticvalue{{targetFieldMetadata.ref}}>Display Value</label> <input type=text id=staticvalue{{targetFieldMetadata.ref}} class=\\\"input-sm {{eirValuesourceSettingsCtrl.isLocalized ? 'lookup' : 'no-lookup'}}\\\" ng-disabled=\\\"(eirValuesourceSettingsCtrl.getTypedef() === 'Dropdown' && targetFieldMetadata.ref === 'displayValue') || eirValuesourceSettingsCtrl.isFinderActive\\\" ng-model=eirValuesourceSettingsCtrl.settingStaticValue ng-change=eirValuesourceSettingsCtrl.onStaticValueChanged() xi-autocomplete=eirValuesourceSettingsCtrl.autocompleteOptions xi-lookup=eirValuesourceSettingsCtrl.lookupOptions ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> <button class=btn-icon xi-tooltip=\\\"'Translations'\\\" ng-if=\\\"::eirValuesourceSettingsCtrl.isFeatureTranslationEnabled() && eirValuesourceSettingsCtrl.isLocalized\\\" ng-click=eirValuesourceSettingsCtrl.openTranslations()> <svg class=icon focusable=false> <use xlink:href=#icon-translate></use> </svg> <span class=audible>Translations</span> </button> </div> <div class=\\\"field-short with-button\\\" ng-if=\\\"valueSourceObject.Type === eirValuesourceSettingsCtrl.BindingTypeEnum.URL_BINDING\\\"> <div class=url-value-label> <label for=urlvalue{{targetFieldMetadata.ref}}>URL Value</label> <svg class=icon focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'This is a temporary value for testing purposes only'\\\"> <use xlink:href=#icon-info></use> </svg> </div> <input type=text id=urlvalue{{targetFieldMetadata.ref}} class=input-md ng-model=eirValuesourceSettingsCtrl.settingStaticValue ng-change=eirValuesourceSettingsCtrl.onUrlValueChanged() ng-disabled=!valueSourceObject.sourceKey ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> </div> <div class=accordion-content ng-if=\\\"targetFieldMetadata.valueType === eirValuesourceSettingsCtrl.ValueTypeEnum.BOOLEAN\\\"> <input type=checkbox class=checkbox id={{targetFieldMetadata.name}} ng-model=eirValuesourceSettingsCtrl.settingStaticValue ng-change=eirValuesourceSettingsCtrl.onStaticValueChanged()> <label for={{targetFieldMetadata.name}} class=checkbox-label>{{targetFieldMetadata.name}}</label> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=interaction-container> <div class=interaction-list xi-listview ng-if=\\\"eirInteractionSettingsCtrl.relevantInteractions.length > 0\\\"> <ul> <li class=interaction-list-item xi-tooltip=interaction.displayName ng-click=eirInteractionSettingsCtrl.selectInteraction(interaction) ng-repeat=\\\"interaction in eirInteractionSettingsCtrl.relevantInteractions track by interaction.databearer.id\\\"> <span>{{interaction.triggerString}}</span> <div> <svg class=icon focusable=false> <use xlink:href=#icon-caret-right></use> </svg> </div> <span>{{interaction.targetString}}</span> </li> </ul> </div> <div class=add-interaction-link ng-if=\\\"eirInteractionSettingsCtrl.relevantInteractions.length < 1\\\"> <button class=\\\"hyperlink gray-hyperlink\\\" ng-click=eirInteractionSettingsCtrl.createNewInteraction()>Create Interaction</button> </div> <div class=buttonContainer ng-if=\\\"eirInteractionSettingsCtrl.relevantInteractions.length > 0\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation id=multicall-tooltip xi-tooltip=\\\"'To enable multiple calls, separate each value with a %% suffix'\\\" ng-show=eirInteractionSettingsCtrl.selectedInteraction> <use xlink:href=#icon-info></use> </svg> <button class=btn-icon xi-tooltip=\\\"'Create new Interaction'\\\" ng-click=eirInteractionSettingsCtrl.createNewInteraction() ng-disabled=eirInteractionSettingsCtrl.isFinderActive> <svg class=icon focusable=false> <use xlink:href=#icon-add></use> </svg> <span>Create</span> </button> <button class=btn-icon xi-tooltip=\\\"'Run selected Interaction'\\\" ng-click=eirInteractionSettingsCtrl.manualRunSelected() ng-show=eirInteractionSettingsCtrl.selectedInteraction ng-disabled=eirInteractionSettingsCtrl.isFinderActive> <svg class=icon focusable=false> <use xlink:href=#icon-next-page></use> </svg> <span>Run</span> </button> <button class=btn-icon xi-tooltip=\\\"'Delete selected Interaction'\\\" ng-click=eirInteractionSettingsCtrl.removeSelectedInteraction() ng-show=eirInteractionSettingsCtrl.selectedInteraction ng-disabled=eirInteractionSettingsCtrl.isFinderActive> <svg class=icon focusable=false> <use xlink:href=#icon-delete></use> </svg> <span>Remove</span> </button> </div> </div> <div class=\\\"settingstopic edit-topic\\\" ng-show=\\\"eirInteractionSettingsCtrl.selectedInteraction && !eirInteractionSettingsCtrl.isWizard\\\"> <div class=settingstopic> <div class=settings-title> <label>Trigger Event</label> </div> <div class=settings-content> <div class=\\\"field-short with-button\\\"> <label>Component</label> <select id=interactionSourceSelect class=\\\"dropdown dropdown-sm\\\" ng-model=eirInteractionSettingsCtrl.settingSourceComponent ng-change=eirInteractionSettingsCtrl.onChangeSourceComponent() ng-options=\\\"component as component.displayName + (component.id === eirInteractionSettingsCtrl.selectedComponent.databearer.id ? ' (This Component)' : '') for component in eirInteractionSettingsCtrl.availableSources\\\" ng-disabled=eirInteractionSettingsCtrl.isFinderActive xi-drop-down> </select> <button class=btn-icon xi-tooltip=\\\"'Find Component'\\\" ng-click=\\\"eirInteractionSettingsCtrl.useFinder('source')\\\" ng-disabled=eirInteractionSettingsCtrl.isFinderActive> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-map-pin></use> </svg> <span class=audible>Find Component</span> </button> </div> <div class=field-short> <label for=interactionSourceTriggerSelect>Event</label> <select id=interactionSourceTriggerSelect class=\\\"dropdown dropdown-md\\\" ng-model=eirInteractionSettingsCtrl.settingSourceTrigger ng-change=eirInteractionSettingsCtrl.onChangeSourceTrigger() ng-disabled=eirInteractionSettingsCtrl.isFinderActive ng-options=\\\"trigger as trigger.name for trigger in eirInteractionSettingsCtrl.availableSourceTriggers\\\" xi-drop-down> </select> </div> </div> </div> <div class=settingstopic> <div class=settings-title> <label>Target Action</label> </div> <div class=settings-content> <div class=\\\"field-short with-button\\\"> <label>Component</label> <select id=interactionTargetSelect class=\\\"dropdown dropdown-sm\\\" ng-disabled=eirInteractionSettingsCtrl.isFinderActive ng-model=eirInteractionSettingsCtrl.settingTargetComponent ng-change=eirInteractionSettingsCtrl.onChangeTargetComponent() ng-options=\\\"component as component.displayName + (component.id === eirInteractionSettingsCtrl.selectedComponent.databearer.id ? ' (This Component)' : '') for component in eirInteractionSettingsCtrl.availableTargets\\\" xi-drop-down> </select> <button class=btn-icon xi-tooltip=\\\"'Find Component'\\\" ng-click=\\\"eirInteractionSettingsCtrl.useFinder('target')\\\" ng-disabled=eirInteractionSettingsCtrl.isFinderActive> <svg class=\\\"finderBtn icon\\\" focusable=false> <use xlink:href=#icon-map-pin></use> </svg> <span class=audible>Find Component</span> </button> </div> <div class=field-short> <label for=eventTargetActionSelect>Action</label> <select id=eventTargetActionSelect class=\\\"dropdown dropdown-md\\\" ng-disabled=\\\"eirInteractionSettingsCtrl.isFinderActive || !eirInteractionSettingsCtrl.hasAvailableTargetActions\\\" ng-model=eirInteractionSettingsCtrl.settingTargetAction ng-change=eirInteractionSettingsCtrl.onChangeTargetAction() ng-options=\\\"action.name for action in eirInteractionSettingsCtrl.availableTargetActions\\\" xi-drop-down> </select> </div> </div> </div> <div class=settingstopic> <div class=settings-title> <label>Data Mapping</label> </div> <div class=data-mapping-content> <eir-parameter-handler ng-if=!eirInteractionSettingsCtrl.isWizard interaction=eirInteractionSettingsCtrl.selectedInteraction interaction-changed-event=eirInteractionSettingsCtrl.interactionChangedEvent target-action-changed-event=eirInteractionSettingsCtrl.targetActionChangedEvent source-trigger-changed-event=eirInteractionSettingsCtrl.sourceTriggerChangedEvent> </eir-parameter-handler> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { CanvasModeEnum, InjectNames, Numbers, SaveFlagsEnum, SettingTypes, WizardFocusEnum } from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\nimport { InteractionParameter } from \"ng2/components/interaction/interaction-parameter\";\r\nimport { IDialogBaseScope, KeyCodeEnum } from \"../../../../common/defines\";\r\nimport { IComponent } from \"../../../../common/IComponent\";\r\nimport { IDialog, IDialogEvent, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { SourceComponent } from \"../../defines\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { InteractionManagementService } from \"../../services/interaction-management-service\";\r\nimport { IWizardStep } from \"../../wizard/wizard-ctrl\";\r\n\r\nexport enum WizardTick {\r\n\tTRIGGER_EVENT,\r\n\tACTION,\r\n\tDATA_MAPPING,\r\n\tSUMMARY,\r\n}\r\n\r\nexport enum WizardStates {\r\n\tSOURCE_COMPONENT,\r\n\tTARGET_COMPONENT,\r\n\tSUMMARY,\r\n\tCLOSE_WIZARD\r\n}\r\n\r\nexport interface IInteractionWizardScope extends IDialogBaseScope<IEditorComponent> {\r\n\tcomponent: IEditorComponent;\r\n}\r\n\r\nexport interface IDataMappingSummaryItem {\r\n\ttargetField: string;\r\n\tsourceContext: string;\r\n\tsourceField: string;\r\n\tisMandatory: boolean;\r\n}\r\n\r\nexport class InteractionWizardCtrl {\r\n\t//Keeping title and usertip for when implementing the new wizard is made.\r\n\tpublic steps: IWizardStep[] = [\r\n\t\t{\r\n\t\t\tid: \"interaction-wizard-source.html\",\r\n\t\t\ttitle: \"\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./interaction-wizard-source.html\"),\r\n\t\t}, {\r\n\t\t\tid: \"interaction-wizard-target.html\",\r\n\t\t\ttitle: \"\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./interaction-wizard-target.html\"),\r\n\t\t}, {\r\n\t\t\tid: \"interaction-wizard-datamapping.html\",\r\n\t\t\ttitle: \"\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./interaction-wizard-datamapping.html\"),\r\n\t\t}, {\r\n\t\t\tid: \"interaction-wizard-summary.html\",\r\n\t\t\ttitle: \"\",\r\n\t\t\tuserTip: \"\",\r\n\t\t\ttemplate: require(\"./interaction-wizard-summary.html\"),\r\n\t\t}\r\n\t];\r\n\tpublic currentTick: number;\r\n\tpublic maxTick = 3;\r\n\tpublic userTip: string;\r\n\tpublic nextDisabled: boolean = true;\r\n\r\n\tpublic settingTargetAction: IDataPair;\r\n\tpublic settingSourceTrigger: IDataPair;\r\n\tpublic selectedInteraction: Interaction;\r\n\tpublic settingSourceComponent: IJsonComponent;\r\n\tpublic settingTargetComponent: IJsonComponent;\r\n\tpublic dataMappingSummaryItems: IDataMappingSummaryItem[];\r\n\tprivate component: IComponent;\r\n\tprivate wizardElement: ng.IAugmentedJQuery;\r\n\tprivate dialog: IDialog<IComponent>;\r\n\r\n\tprotected unsubscribers: Function[] = [];\r\n\r\n\tpublic get isSummaryPage(): boolean { return this.currentTick === this.maxTick; }\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TEMPLATE_CACHE,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.INTERACTION_MANAGEMENT_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IInteractionWizardScope,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $templateCache: ng.ITemplateCacheService,\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate interactionManagementService: InteractionManagementService,\r\n\t) {\r\n\t\tthis.initTemplates();\r\n\t\tthis.initializeUnsubscribers();\r\n\r\n\t\tconst dialog: IDialog<IEditorComponent> = $scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tif (dialog.parameter) {\r\n\t\t\t$scope.component = dialog.parameter;\r\n\t\t\tthis.component = $scope.component;\r\n\t\t\tthis.settingSourceComponent = this.editorService.getSelectedComponent().getDatabearer();\r\n\t\t\tthis.settingTargetComponent = this.editorService.getApplicationParent().getDatabearer();\r\n\t\t\tthis.selectedInteraction = this.interactionManagementService.createNew(dialog.parameter);\r\n\t\t\t//To remove selected component label\r\n\t\t\tangular.element(\"#\" + this.component.getId()).addClass(\"inWizard\");\r\n\t\t\tthis.editorService.newWizardInteractionEvent.raise(this.selectedInteraction);\r\n\t\t\tthis.editorService.isWizardChangedEvent.raise(true);\r\n\t\t}\r\n\r\n\t\tconst dialogElement = $element.parents(\".draggable-dialog\");\r\n\t\tdialogElement.draggable({\r\n\t\t\tdistance: 10,\r\n\t\t\tstart: () => {\r\n\t\t\t\tdialogElement.css(\"transition\", \"none\");\r\n\t\t\t\tdialogElement.css(\"transform\", \"none\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdialog.closing = (dialogEvent?: IDialogEvent<any>) => {\r\n\t\t\tthis.editorService.selectedInteractionChangedEvent.raise(null);\r\n\t\t\tthis.editorService.setFinderComponent();\r\n\t\t\tthis.exitWizard();\r\n\t\t\tdialogElement.fadeOut();\r\n\r\n\t\t\tconst cancelOnEscape = (results: IDialogResult<any>): IDialogResult<any> => {\r\n\t\t\t\tif (results.value === KeyCodeEnum.ESCAPE) {\r\n\t\t\t\t\tthis.cancel();\r\n\t\t\t\t}\r\n\t\t\t\treturn results;\r\n\t\t\t};\r\n\r\n\t\t\treturn dialogEvent && dialogEvent.dialog.getPromise().then(cancelOnEscape);\r\n\t\t};\r\n\r\n\t\tthis.wizardElement = $element.find(\".wizard\");\r\n\t\tconst self = this;\r\n\t\tthis.wizardElement.on(\"activated\", (event: JQueryEventObject, element: JQuery) => {\r\n\t\t\tconst selectedTick: number = self.wizardElement.data(\"wizard\").ticks.index(element);\r\n\t\t\tself.gotoWizardTick(selectedTick);\r\n\t\t});\r\n\r\n\t\tthis.wizardElement.on(\"afteractivate\", (event: JQueryEventObject, element: JQuery) => {\r\n\t\t\t$scope.$apply();\r\n\t\t});\r\n\r\n\t\tthis.currentTick = 0;\r\n\t\t$timeout(() => {\r\n\t\t\tthis.gotoWizardTick(this.currentTick);\r\n\t\t}, Numbers.TEN);\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic initTemplates(): void {\r\n\t\tthis.steps.forEach(step => {\r\n\t\t\tif (!this.$templateCache.get(step.id)) {\r\n\t\t\t\tthis.$templateCache.put(step.id, step.template);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic initializeUnsubscribers(): void {\r\n\t\tthis.unsubscribers.push(this.editorService.wizardCloseEvent.on(() => {\r\n\t\t\tthis.cancel();\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.triggerSourceComponentChangedEvent.on((component: IComponent) => {\r\n\t\t\tthis.settingSourceComponent = component.getDatabearer();\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.targetActionComponentChangedEvent.on((component: IComponent) => {\r\n\t\t\tthis.settingTargetComponent = component.getDatabearer();\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.setSourceTriggerEvent.on((sourceTrigger: IDataPair) => {\r\n\t\t\tthis.settingSourceTrigger = sourceTrigger;\r\n\t\t\tthis.updateDisabled();\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.setTargetActionEvent.on((targetAction: IDataPair) => {\r\n\t\t\tthis.settingTargetAction = targetAction;\r\n\t\t\tthis.updateDisabled();\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(this.editorService.wizardTickChangedEvent.on((tick: number) => {\r\n\t\t\tthis.gotoWizardTick(tick);\r\n\t\t}));\r\n\t}\r\n\r\n\tpublic selectWizardStep(stepNumber: number): void {\r\n\t\tthis.setWizardTick(stepNumber);\r\n\t\tthis.gotoWizardTick(stepNumber);\r\n\t}\r\n\r\n\tpublic gotoWizardTick(tickNumber: number): void {\r\n\t\tthis.userTip = \"\";\r\n\r\n\t\tswitch (tickNumber) {\r\n\t\t\tcase WizardTick.TRIGGER_EVENT: // Trigger Event\r\n\t\t\t\t// Setting canvas mode to selection will reject the useFinder promise\r\n\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\t\t\tthis.userTip = `Please select the event that will trigger the action. If you want to change component\r\n\t\t\t\t\tsimply click on a component on the canvas. You can also choose to select an application event by clicking  `;\r\n\t\t\t\tthis.editorService.wizardSetFinderModeEvent.raise(\"source\");\r\n\t\t\t\tthis.checkWizardStates(tickNumber);\r\n\t\t\t\tbreak;\r\n\t\t\tcase WizardTick.ACTION: // Action\r\n\t\t\t\t// Setting canvas mode to selection will reject the useFinder promise\r\n\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\t\t\tthis.editorService.wizardSetFinderModeEvent.raise(\"target\");\r\n\t\t\t\tthis.userTip = `Please select a target component and action. If you want to change component simply click on a\r\n\t\t\t\t\tcomponent on the canvas or select the `;\r\n\t\t\t\tthis.checkWizardStates(tickNumber);\r\n\t\t\t\tbreak;\r\n\t\t\tcase WizardTick.DATA_MAPPING: // Data Mapping\r\n\t\t\t\tthis.editorService.setCanvasMode(CanvasModeEnum.WIZARD);\r\n\t\t\t\tthis.userTip = `Configure the data field mapping by selecting target action data field,\r\n\t\t\t\t\tand the source component and field.`;\r\n\t\t\t\tthis.checkWizardStates(tickNumber);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: // WizardTick.SUMMARY //Summary\r\n\t\t\t\tthis.refreshDataMappingSummaryItems();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.currentTick = tickNumber;\r\n\t}\r\n\r\n\tpublic cancel(): void {\r\n\t\tthis.interactionManagementService.removeInteraction(this.selectedInteraction);\r\n\t\tthis.checkWizardStates(WizardStates.CLOSE_WIZARD);\r\n\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic next(): void {\r\n\t\tif (this.isSummaryPage) {\r\n\t\t\tthis.dialog.close();\r\n\t\t} else {\r\n\t\t\tthis.selectWizardStep(this.currentTick + 1);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic back(): void {\r\n\t\tthis.selectWizardStep(this.currentTick - 1);\r\n\t}\r\n\r\n\tprivate setWizardTick(tickNumber: number): void {\r\n\t\t// Do not select the same tick as current.\r\n\t\tif (tickNumber !== this.currentTick) {\r\n\t\t\tthis.wizardElement.data(\"wizard\").select(tickNumber);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateDisabled(): void {\r\n\t\tswitch (this.currentTick) {\r\n\t\t\tcase WizardTick.TRIGGER_EVENT:\r\n\t\t\t\tthis.nextDisabled = !this.selectedInteraction.sourceName;\r\n\t\t\t\tbreak;\r\n\t\t\tcase WizardTick.ACTION:\r\n\t\t\t\tthis.nextDisabled = !this.selectedInteraction.targetName;\r\n\t\t\t\tbreak;\r\n\t\t\tcase WizardTick.DATA_MAPPING:\r\n\t\t\t\tthis.nextDisabled = !this.selectedInteraction.sourceName || !this.selectedInteraction.targetName;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: //WizardTick.SUMMARY\r\n\t\t\t\tthis.nextDisabled = false;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate checkWizardStates(state: number): void {\r\n\t\tswitch (state) {\r\n\t\t\tcase WizardStates.CLOSE_WIZARD:\r\n\t\t\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\t\t\tWizardFocusEnum.UNFOCUSED, this.settingTargetComponent, SettingTypes.TARGET);\r\n\t\t\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\t\t\tWizardFocusEnum.UNFOCUSED, this.settingSourceComponent, SettingTypes.SOURCE);\r\n\t\t\t\tangular.element(\"#\" + this.component.getId()).removeClass(\"inWizard\"); //To show selected component label\r\n\t\t\t\tbreak;\r\n\t\t\tcase WizardStates.SOURCE_COMPONENT:\r\n\t\t\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\t\t\tWizardFocusEnum.UNFOCUSED, this.settingTargetComponent, SettingTypes.TARGET);\r\n\t\t\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\t\t\tWizardFocusEnum.FOCUSED, this.settingSourceComponent, SettingTypes.SOURCE);\r\n\t\t\t\tbreak;\r\n\t\t\tcase WizardStates.TARGET_COMPONENT:\r\n\t\t\t\tif (this.settingSourceComponent.id !== this.settingTargetComponent.id) {\r\n\t\t\t\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\t\t\t\tWizardFocusEnum.RESTING, this.settingSourceComponent, SettingTypes.SOURCE);\r\n\t\t\t\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\t\t\t\tWizardFocusEnum.FOCUSED, this.settingTargetComponent, SettingTypes.TARGET);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: //Data Mapping or Summary\r\n\t\t\t\tif (this.settingSourceComponent.id !== this.settingTargetComponent.id) {\r\n\t\t\t\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\t\t\t\tWizardFocusEnum.RESTING, this.settingTargetComponent, SettingTypes.TARGET);\r\n\t\t\t\t\tthis.editorService.setWizardFocusComponent(\r\n\t\t\t\t\t\tWizardFocusEnum.RESTING, this.settingSourceComponent, SettingTypes.SOURCE);\r\n\t\t\t\t}\r\n\t\t}\r\n\t\tthis.updateDisabled();\r\n\t}\r\n\r\n\tprivate exitWizard(): void {\r\n\t\tthis.checkWizardStates(WizardStates.CLOSE_WIZARD);\r\n\t\tthis.editorService.isWizardChangedEvent.raise(false);\r\n\t\tthis.editorService.setFinderActivity(false);\r\n\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t}\r\n\r\n\tprivate refreshDataMappingSummaryItems(): ng.IPromise<void> {\r\n\t\treturn this.makeDataMappingSummaryItems().then(summaryItems => {\r\n\t\t\tthis.dataMappingSummaryItems = summaryItems;\r\n\t\t}).catch(err => {\r\n\t\t\tthis.dataMappingSummaryItems = [];\r\n\t\t\tconsole.warn(\"[InteractionWizardCtrl] Failed to make setting parameters:\", err);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate makeDataMappingSummaryItems(): ng.IPromise<IDataMappingSummaryItem[]> {\r\n\t\tconst interactionParameters = this.selectedInteraction.getParameters();\r\n\t\tconst promisedSummaryItems = interactionParameters.map(parameter => {\r\n\t\t\treturn this.makeDataMappingSummaryItem(parameter);\r\n\t\t});\r\n\t\treturn this.$q.all(promisedSummaryItems);\r\n\t}\r\n\r\n\tprivate makeDataMappingSummaryItem(parameter: InteractionParameter): ng.IPromise<IDataMappingSummaryItem> {\r\n\t\tswitch (parameter.valueSource.Type) {\r\n\t\t\tcase BindingTypeEnum.STATIC_VALUE:\r\n\t\t\t\treturn this.makeStaticDataMappingSummaryItem(parameter);\r\n\t\t\tcase BindingTypeEnum.BINDING:\r\n\t\t\t\treturn this.makeComponentBindingDataMappingSummaryItem(parameter);\r\n\t\t\tcase BindingTypeEnum.CONTEXT_BINDING:\r\n\t\t\t\treturn this.makeContextBindingDataMappingSummaryItem(parameter);\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.$q.reject(`Unknown parameter type: ${parameter.valueSource.Type}`);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate makeStaticDataMappingSummaryItem(parameter: InteractionParameter): ng.IPromise<IDataMappingSummaryItem> {\r\n\t\treturn this.$q.resolve({\r\n\t\t\ttargetField: parameter.targetField.Meta.name,\r\n\t\t\tsourceContext: SourceComponent.STATIC_VALUE_OBJECT.name,\r\n\t\t\tsourceField: parameter.valueSource.value,\r\n\t\t\tisMandatory: parameter.targetField.isMandatory,\r\n\t\t});\r\n\t}\r\n\r\n\tprivate makeComponentBindingDataMappingSummaryItem(\r\n\t\tparameter: InteractionParameter\r\n\t): ng.IPromise<IDataMappingSummaryItem> {\r\n\t\tconst componentId = parameter.valueSource.sourceName;\r\n\t\tconst component = this.editorService.getComponentInstanceById(componentId);\r\n\t\treturn component.getBindingMetaData().then(bindings => {\r\n\t\t\tconst { visibleName } = bindings.find(binding => binding.sourceKey === parameter.valueSource.sourceKey);\r\n\t\t\treturn {\r\n\t\t\t\ttargetField: parameter.targetField.Meta.name,\r\n\t\t\t\tsourceContext: component.getDisplayName(),\r\n\t\t\t\tsourceField: visibleName,\r\n\t\t\t\tisMandatory: parameter.targetField.isMandatory,\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\tprivate makeContextBindingDataMappingSummaryItem(\r\n\t\tparameter: InteractionParameter\r\n\t): ng.IPromise<IDataMappingSummaryItem> {\r\n\t\tconst targetComponentId = this.selectedInteraction.targetName;\r\n\t\tconst targetComponent = this.editorService.getComponentInstanceById(targetComponentId);\r\n\t\treturn targetComponent.getContextMetaData().then(bindings => {\r\n\t\t\tconst { visibleName } = bindings.find(binding => binding.sourceKey === parameter.valueSource.sourceKey);\r\n\t\t\treturn {\r\n\t\t\t\ttargetField: parameter.targetField.Meta.name,\r\n\t\t\t\tsourceContext: SourceComponent.TARGET_CONTEXT_OBJECT.name,\r\n\t\t\t\tsourceField: visibleName,\r\n\t\t\t\tisMandatory: parameter.targetField.isMandatory,\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirInteractionWizardCtrl\", InteractionWizardCtrl);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=padded-content> <p class=\\\"user-tip label\\\"> {{wizardCtrl.userTip}} <a class=hyperlink ng-click=eirInteractionSettingsCtrl.selectSourceApplication()>here</a></p> <div ng-if=!eirInteractionSettingsCtrl.selectedInteraction.sourceName> <p class=grey-text>Source not selected</p> </div> <div class=interaction-step ng-if=eirInteractionSettingsCtrl.selectedInteraction.sourceName> <label>Component</label> <label class=component-name-label>{{eirInteractionSettingsCtrl.settingSourceComponent.displayName}}</label> <div class=field-short> <label for=wiz-interactionSourceTriggerSelect>Event</label> <select id=wiz-interactionSourceTriggerSelect class=\\\"dropdown dropdown-md\\\" ng-model=eirInteractionSettingsCtrl.settingSourceTrigger ng-change=eirInteractionSettingsCtrl.onChangeSourceTrigger() ng-options=\\\"trigger as trigger.name for trigger in eirInteractionSettingsCtrl.availableSourceTriggers\\\" xi-drop-down=eirInteractionSettingsCtrl.dropdownSettingsWide> </select> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=padded-content> <p class=\\\"user-tip label\\\"> {{wizardCtrl.userTip}}<a class=hyperlink ng-click=eirInteractionSettingsCtrl.setSourceAsTarget()> source as target.</a></p> <div ng-if=!eirInteractionSettingsCtrl.selectedInteraction.targetName> <p class=grey-text>Target not selected</p> </div> <div class=interaction-step ng-if=eirInteractionSettingsCtrl.selectedInteraction.targetName> <label>Component</label> <label class=component-name-label>{{eirInteractionSettingsCtrl.settingTargetComponent.displayName}}</label> <div class=field-short> <label for=wiz-interactionTargetActionSelect>Action</label> <select id=wiz-interactionTargetActionSelect class=\\\"dropdown dropdown-md\\\" ng-model=eirInteractionSettingsCtrl.settingTargetAction ng-change=eirInteractionSettingsCtrl.onChangeTargetAction() ng-options=\\\"action as action.name for action in eirInteractionSettingsCtrl.availableTargetActions\\\" ng-disabled=!eirInteractionSettingsCtrl.hasAvailableTargetActions xi-drop-down=eirInteractionSettingsCtrl.dropdownSettingsWide> </select> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=padded-content> <p class=\\\"user-tip label\\\">{{wizardCtrl.userTip}}</p> </div> <div class=parameter-wrapper> <eir-parameter-handler interaction=eirInteractionSettingsCtrl.selectedInteraction interaction-changed-event=eirInteractionSettingsCtrl.interactionChangedEvent target-action-changed-event=eirInteractionSettingsCtrl.targetActionChangedEvent source-trigger-changed-event=eirInteractionSettingsCtrl.sourceTriggerChangedEvent> </eir-parameter-handler> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=summary-wrapper> <fieldset> <div class=summary-header> <h4>Trigger Event Properties</h4> <button xi-tooltip=\\\"'Edit Source'\\\" class=btn-tertiary type=button ng-click=wizardCtrl.selectWizardStep(0)> EDIT </button> </div> <div class=summary-form> <div class=field> <label class=label>Component</label> <span class=data>{{eirInteractionSettingsCtrl.settingSourceComponent.displayName}}</span> </div> <div class=field> <label class=label>Event</label> <span class=data>{{eirInteractionSettingsCtrl.settingSourceTrigger.name}}</span> </div> </div> </fieldset> <fieldset> <div class=summary-header> <h4>Action Properties</h4> <button xi-tooltip=\\\"'Edit Target'\\\" class=btn-tertiary type=button ng-click=wizardCtrl.selectWizardStep(1)> EDIT </button> </div> <div class=summary-form> <div class=field> <label class=label>Component</label> <span class=data>{{eirInteractionSettingsCtrl.settingTargetComponent.displayName}}</span> </div> <div class=field> <label class=label>Action</label> <span class=data>{{eirInteractionSettingsCtrl.settingTargetAction.name}}</span> </div> </div> </fieldset> <fieldset> <div class=summary-header> <h4>Data Mapping</h4> <button xi-tooltip=\\\"'Edit Data Mapping'\\\" class=btn-tertiary type=button ng-click=wizardCtrl.selectWizardStep(2)> EDIT </button> </div> <div class=parameter-wrapper> <div class=parameter-summary ng-repeat=\\\"item in ::wizardCtrl.dataMappingSummaryItems | orderBy:['-isMandatory','targetField']\\\"> <div class=field> <label class=label>Action Data Field <p>{{item.targetField}}</p> </label></div> <hr> <div class=field> <label class=label>Source <p>{{item.sourceContext}}</p> </label></div> <div class=field> <label class=label>Data Field <p>{{item.sourceField}}</p> </label></div> </div> </div> </fieldset> </div> \";\n// Exports\nmodule.exports = code;","import { CanvasModeEnum, InjectNames, InteractionTriggerEnum, SaveFlagsEnum } from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { IJsonInteractionParameter } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IAvailableTargetField } from \"ng2/common/model/interaction/available-target-field.model\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\nimport { InteractionParameter } from \"ng2/components/interaction/interaction-parameter\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport { IComponent } from \"../../../../common/IComponent\";\r\nimport { InstanceEvent } from \"../../../../common/instance-event\";\r\nimport { FrameworkService } from \"../../../../components/services/framework-service\";\r\nimport { ISourceComponent, SourceComponent } from \"../../defines\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\n\r\nexport interface IParameterSettingsScope extends ng.IScope {\r\n\tinteraction: Interaction;\r\n\tinteractionChangedEvent: InstanceEvent<Interaction>;\r\n\ttargetActionChangedEvent: InstanceEvent<string>;\r\n\tsourceTriggerChangedEvent: InstanceEvent<string>;\r\n}\r\n\r\nexport class ParameterCtrl {\r\n\r\n\tpublic availableSources: ISourceComponent[];\r\n\tpublic availableTargetFields: IAvailableTargetField[];\r\n\tpublic interactionParameters: InteractionParameter[];\r\n\tpublic isAddAvailable: boolean = true;\r\n\tpublic metadataLoading: boolean = false;\r\n\tpublic targetComponent: IComponent;\r\n\tpublic userNote: string;\r\n\tpublic interaction: Interaction;\r\n\r\n\tprivate interactionChangedEvent: InstanceEvent<Interaction>;\r\n\tprivate targetActionChangedEvent: InstanceEvent<string>;\r\n\tprivate sourceTriggerChangedEvent: InstanceEvent<string>;\r\n\tprivate unsubscribers: Function[] = [];\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $scope: IParameterSettingsScope,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate frameworkService: FrameworkService\r\n\t) {\r\n\t\tthis.interactionChangedEvent = $scope.interactionChangedEvent;\r\n\t\tthis.targetActionChangedEvent = $scope.targetActionChangedEvent;\r\n\t\tthis.sourceTriggerChangedEvent = $scope.sourceTriggerChangedEvent;\r\n\r\n\t\tthis.unsubscribers.push(this.sourceTriggerChangedEvent.on(() => {\r\n\t\t\tthis.onInteractionTargetActionChanged(this.interaction.targetActionName);\r\n\t\t}));\r\n\t\tthis.unsubscribers.push(this.targetActionChangedEvent.on(() => {\r\n\t\t\tthis.onInteractionTargetActionChanged(this.interaction.targetActionName);\r\n\t\t}));\r\n\t\tthis.unsubscribers.push(this.interactionChangedEvent.on(this.onNewInteractionSelected.bind(this)));\r\n\r\n\t\tthis.onNewInteractionSelected($scope.interaction);\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tthis.unsubscribers.forEach((unsubscriber) => {\r\n\t\t\t\tunsubscriber();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getUnusedParameters(): IAvailableTargetField[] {\r\n\t\treturn this.availableTargetFields.filter((availableTargetField) => {\r\n\t\t\treturn !this.interaction.getParameters().some((parameter) => {\r\n\t\t\t\treturn parameter.targetKey === availableTargetField.targetKey;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateView(): void {\r\n\t\tthis.isAddAvailable = (this.getUnusedParameters().length > 0);\r\n\t\t// Empty interactionParameters and evasAsync for ng-repeat to update\r\n\t\tthis.interactionParameters = [];\r\n\t\tthis.$scope.$applyAsync(() => {\r\n\t\t\tthis.interactionParameters = this.interaction.getParameters();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic save(): void {\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t}\r\n\r\n\tprivate onNewInteractionSelected(newInteraction: Interaction): void {\r\n\t\tthis.interaction = newInteraction;\r\n\t\tif (newInteraction) {\r\n\t\t\tconst availableSources = [\r\n\t\t\t\tSourceComponent.STATIC_VALUE_OBJECT,\r\n\t\t\t\tSourceComponent.TARGET_CONTEXT_OBJECT,\r\n\t\t\t\tSourceComponent.URL_VALUE_OBJECT\r\n\t\t\t];\r\n\t\t\t// Supplied for valueSourceSettings\r\n\t\t\tconst edgeComponents = this.editorService.getAllBindableComponents();\r\n\t\t\tedgeComponents.forEach((component) => {\r\n\t\t\t\tavailableSources.push({ id: component.getId(), name: component.getDisplayName(), isComponent: true });\r\n\t\t\t});\r\n\t\t\tthis.availableSources = availableSources;\r\n\r\n\t\t\tthis.onInteractionTargetActionChanged(newInteraction.targetActionName);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onInteractionTargetActionChanged(newTargetAction: string): void {\r\n\t\tthis.availableTargetFields = [];\r\n\t\tconst targetComponent = this.editorService.getComponentInstanceById(this.interaction.targetName);\r\n\r\n\t\tthis.targetComponent = targetComponent;\r\n\t\tthis.updateView();\r\n\r\n\t\tif (targetComponent) {\r\n\t\t\tthis.metadataLoading = true;\r\n\t\t\ttargetComponent.getParameterMetadata(this.interaction.targetActionName).then((availableTargetFields) => {\r\n\t\t\t\tthis.availableTargetFields = availableTargetFields;\r\n\t\t\t\tavailableTargetFields.forEach((targetField) => {\r\n\t\t\t\t\tconst foundParameter: InteractionParameter = this.interaction.getParameter(targetField.targetKey);\r\n\t\t\t\t\tif (foundParameter) {\r\n\t\t\t\t\t\t// If parameter have been added to interaction, map availableTargetField with InteractionParameter\r\n\t\t\t\t\t\tfoundParameter.targetField = targetField;\r\n\t\t\t\t\t} else if (targetField.isMandatory) {\r\n\t\t\t\t\t\tthis.createParameter(targetField);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}).catch(() => {\r\n\t\t\t\t// uneccessary error to console\r\n\t\t\t\t//console.error(\"[ParameterCtrl] No metadata available\");\r\n\t\t\t\tthis.userNote = \"No metadata available\";\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.updateView();\r\n\t\t\t\tthis.metadataLoading = false;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[ParameterCtrl] No targetComponent\");\r\n\t\t\tthis.userNote = \"No target component set\";\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpublic onChangeTargetField(parameter: InteractionParameter): void {\r\n\t\tif (parameter.targetField) {\r\n\t\t\tparameter.targetKey = parameter.targetField.targetKey;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate checkForMandatoryParameter(): IAvailableTargetField {\r\n\t\tconst parametersList = this.getUnusedParameters();\r\n\t\tlet newTarget = parametersList[0];\r\n\t\tfor (let i = 0; i < parametersList.length; i++) {\r\n\t\t\tif (parametersList[i].isMandatory) {\r\n\t\t\t\tnewTarget = parametersList[i];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn newTarget;\r\n\t}\r\n\r\n\tpublic createParameter(newTarget?: IAvailableTargetField): void {\r\n\t\tif (!newTarget) {\r\n\t\t\tnewTarget = this.checkForMandatoryParameter();\r\n\t\t}\r\n\t\tconst newParameter: IJsonInteractionParameter = {\r\n\t\t\ttargetKey: newTarget.targetKey\r\n\t\t} as any;\r\n\r\n\t\tconst sourceComponentInAvailableSources = this.availableSources.some((availableSource) => {\r\n\t\t\treturn availableSource.id === this.interaction.sourceName;\r\n\t\t});\r\n\t\tif (sourceComponentInAvailableSources) {\r\n\t\t\t// Setting sourceKey to same key as targetKey, value-source-settings will handle if it is available or not\r\n\t\t\tnewParameter.valueSource = {\r\n\t\t\t\tType: BindingTypeEnum.BINDING,\r\n\t\t\t\tsourceName: this.interaction.sourceName,\r\n\t\t\t\tsourceKey: this.interaction.sourceTriggerName === InteractionTriggerEnum.CURRENT_ITEM_CHANGED ?\r\n\t\t\t\t\t\"currentItem.\" + newTarget.targetKey : newTarget.targetKey\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tnewParameter.valueSource = { Type: BindingTypeEnum.STATIC_VALUE };\r\n\t\t}\r\n\r\n\t\tconst newParameterInstance = new InteractionParameter(newParameter);\r\n\t\tnewParameterInstance.targetField = newTarget;\r\n\t\tthis.interaction.addParameter(newParameterInstance);\r\n\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t\tthis.updateView();\r\n\t}\r\n\r\n\tpublic removeParameter(index: number): void {\r\n\t\tthis.interaction.removeParameter(index);\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.INTERACTIONS);\r\n\t\tthis.editorService.setCanvasMode(CanvasModeEnum.SELECTION);\r\n\t\tthis.updateView();\r\n\t}\r\n\r\n\tprivate removeAllParameters(): void {\r\n\t\tthis.interaction.removeAllParameters();\r\n\t}\r\n}\r\n\r\nexport class ParameterHandlerDirective {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirParameterHandler\", () => {\r\n\t\t\treturn {\r\n\t\t\t\ttemplate: require(\"./parameter-handler.html\"),\r\n\t\t\t\tscope: {\r\n\t\t\t\t\tinteraction: \"=\",\r\n\t\t\t\t\tinteractionChangedEvent: \"=\",\r\n\t\t\t\t\ttargetActionChangedEvent: \"=\",\r\n\t\t\t\t\tsourceTriggerChangedEvent: \"=\"\r\n\t\t\t\t},\r\n\t\t\t\tcontroller: ParameterCtrl,\r\n\t\t\t\tcontrollerAs: \"eirParameterCtrl\"\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=parameter-item ng-repeat=\\\"parameter in eirParameterCtrl.interactionParameters track by $index\\\"> <div class=field-short> <button ng-if=!parameter.targetField.isMandatory class=delete-icon ng-click=eirParameterCtrl.removeParameter($index)> <svg class=icon focusable=false> <use xlink:href=#icon-close></use> </svg> <span class=audible>Delete</span> </button> <label for=newTargetFieldSelect{{$index}}>Action Data Field</label> <select id=newTargetFieldSelect{{$index}} class=\\\"dropdown dropdown-md\\\" ng-disabled=parameter.targetField.isMandatory ng-model=parameter.targetField ng-change=eirParameterCtrl.onChangeTargetField(parameter) ng-options=\\\"field.visibleName for field in eirParameterCtrl.availableTargetFields | eirExcludeFrom:eirParameterCtrl.interactionParameters:'targetKey':parameter.targetField track by field.targetKey\\\" xi-drop-down=eirParameterCtrl.interactionParameters> </select> </div> <hr/> <eir-valuesource-settings target-component=eirParameterCtrl.targetComponent target-field-metadata=parameter.targetField.Meta value-source-object=parameter.valueSource available-sources=eirParameterCtrl.availableSources create-bindings=false on-save=eirParameterCtrl.save()> </eir-valuesource-settings> </div> <button class=\\\"btn-primary parameter-btn\\\" ng-click=eirParameterCtrl.createParameter() ng-disabled=!eirParameterCtrl.isAddAvailable xi-button type=button> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-add></use> </svg> <span>ADDITIONAL DATA MAPPING</span> </button> \";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { DeveloperToolCtrl } from \"./developer-tool-ctrl\";\r\n\r\nexport class DeveloperToolComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {};\r\n\r\n\t\tthis.controller = DeveloperToolCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./developer-tool-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirDeveloperTool\", new DeveloperToolComponent());\r\n\t}\r\n}\r\n","import isNil from \"lodash-es/isNil\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { AppState } from \"../../app.state\";\r\n\r\nimport { Config, DeveloperConstants, InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { Debugger } from \"common/debugger\";\r\nimport { ViewEnum } from \"common/defines\";\r\n\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport { DialogService } from \"common/services/dialog-service\";\r\nimport { RepositoryService } from \"designer/repository/repository-service\";\r\nimport { DesignerService } from \"designer/services/designer-service\";\r\nimport { ProjectService } from \"designer/services/project-service\";\r\n\r\nexport class DeveloperToolCtrl {\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.STATE_SERVICE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.PROJECT_SERVICE,\r\n\t\tInjectNames.REPOSITORY_SERVICE,\r\n\t\tInjectNames.DESIGNER_SERVICE,\r\n\t];\r\n\r\n\tget isDeveloper(): boolean {\r\n\t\treturn Debugger.isEnabled() && Config.IS_DEV;\r\n\t}\r\n\tget mgConfigName(): string {\r\n\t\treturn Config.MG_CONFIG_NAME;\r\n\t}\r\n\tset mgConfigName(value: string) {\r\n\t\tConfig.MG_CONFIG_NAME = value;\r\n\t}\r\n\tget ionApiToken(): string {\r\n\t\tconst token = localStorage.getItem(DeveloperConstants.ION_TOKEN);\r\n\t\treturn token;\r\n\t}\r\n\tset ionApiToken(value: string) {\r\n\t\tthis.commonService.httpService\r\n\t\t\t.executePut(\r\n\t\t\t\t\"/settings/token\",\r\n\t\t\t\t{ path: \"token\", data: value}\r\n\t\t\t)\r\n\t\t\t.then(response => localStorage\r\n\t\t\t\t.setItem(DeveloperConstants.ION_TOKEN, response as string));\r\n\t}\r\n\r\n\tcurrentProject: string;\r\n\r\n\tisIonProxyActive: boolean;\r\n\tisLaunchWithAngular: boolean;\r\n\tisProcessing: boolean;\r\n\tcanNavigateBack: boolean;\r\n\r\n\tprivate acceptanceTestProjectIdList: string[];\r\n\tprivate acceptanceTestDataserviceIdList: string[];\r\n\tprivate progressApi: any;\r\n\r\n\tprivate fromEditor: boolean;\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $state: ng.ui.IStateService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate projectService: ProjectService,\r\n\t\tprivate repositoryService: RepositoryService,\r\n\t\tprivate designerService: DesignerService,\r\n\t) { }\r\n\r\n\t$onInit(): void {\r\n\t\tthis.setCanNavigateBack();\r\n\r\n\t\tif (this.isDeveloper) {\r\n\t\t\tlet value = localStorage.getItem(DeveloperConstants.ION_PROXY);\r\n\t\t\tthis.isIonProxyActive = !isNil(value) && value === \"true\";\r\n\r\n\t\t\tvalue = localStorage.getItem(DeveloperConstants.LAUNCH_WITH_ANGULAR);\r\n\t\t\tthis.isLaunchWithAngular = !isNil(value) && value === \"true\";\r\n\r\n\t\t} else {\r\n\t\t\tlocalStorage.removeItem(DeveloperConstants.ION_PROXY);\r\n\t\t\tlocalStorage.removeItem(DeveloperConstants.LAUNCH_WITH_ANGULAR);\r\n\t\t\tthis.$state.go(AppState.HOME.name);\r\n\t\t}\r\n\r\n\t\tconst filterAcceptanceTestItems = (list: { id: string, name: string}[]): string[] => {\r\n\t\t\treturn list\r\n\t\t\t\t.filter(item => item.name.indexOf(\"ACCTEST\") === 0)\r\n\t\t\t\t.map(item => item.id);\r\n\t\t};\r\n\r\n\t\tthis.commonService.loadProjects()\r\n\t\t\t.then(projects => {\r\n\t\t\t\treturn projects.map(project => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tid: project.manifest.id,\r\n\t\t\t\t\t\tname: project.manifest.displayName,\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.then(filterAcceptanceTestItems)\r\n\t\t\t.then(result => this.acceptanceTestProjectIdList = result);\r\n\r\n\t\tthis.repositoryService.getDatasources()\r\n\t\t\t.then(dataservices => {\r\n\t\t\t\treturn dataservices.map(dataservice => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tid: dataservice.id,\r\n\t\t\t\t\t\tname: dataservice.displayName,\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.then(filterAcceptanceTestItems)\r\n\t\t\t.then(result => this.acceptanceTestDataserviceIdList = result);\r\n\r\n\t\tthis.progressApi = this.$element.find(\"#progress-bar\").progress().data(\"progress\");\r\n\r\n\t\t// load the current project textarea field\r\n\t\tthis.loadCurrentProjectDatabearer();\r\n\t}\r\n\r\n\tprivate loadCurrentProjectDatabearer(): void {\r\n\r\n\t\tconst projectId = this.commonService.getCurrentProject()?.getId();\r\n\r\n\t\tif (!isUndefined(projectId)) {\r\n\t\t\tthis.commonService.loadProject(projectId)\r\n\t\t\t\t.then(project => this.currentProject = JSON.stringify(project));\r\n\t\t} else {\r\n\t\t\tthis.currentProject = \"No project loaded\";\r\n\t\t}\r\n\t}\r\n\r\n\tstatic resolve(): void {\r\n\t\tDebugger.initialize();\r\n\t}\r\n\r\n\tdeleteAllAcceptanceTestProjects(): void {\r\n\t\tconst amount = this.acceptanceTestProjectIdList.length;\r\n\t\tconst promises: ng.IPromise<void>[] = [];\r\n\t\tthis.isProcessing = true;\r\n\r\n\t\tthis.acceptanceTestProjectIdList.forEach((projectId, index) => {\r\n\t\t\tpromises.push(this.projectService.deleteById(projectId)\r\n\t\t\t\t.then(() => this.dialogService.showToast({\r\n\t\t\t\t\ttitle: \"Deleted\",\r\n\t\t\t\t\tmessage: `Deleted ${projectId}, still ${amount - index - 1} of ${amount} to process`,\r\n\r\n\t\t\t\t}))\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\t// tslint:disable-next-line:no-magic-numbers\r\n\t\t\t\t\tconst processed =  100 - (100 / (amount / (amount - index - 1.0)));\r\n\t\t\t\t\tthis.progressApi.update(processed.toString());\r\n\t\t\t\t}));\r\n\t\t});\r\n\r\n\t\tthis.$q.all(promises)\r\n\t\t\t.then(() => this.dialogService.showToast({\r\n\t\t\t\ttitle: \"Result\",\r\n\t\t\t\tmessage: \"All acceptance test projects deleted\",\r\n\t\t\t}))\r\n\t\t\t.finally(() => {\r\n\t\t\t\tthis.acceptanceTestProjectIdList.length = 0;\r\n\t\t\t\tthis.isProcessing = false;\r\n\t\t\t});\r\n\t}\r\n\r\n\tdeleteAllAcceptanceTestDataservices(): void {\r\n\t\tthis.repositoryService.deleteDatasources(this.acceptanceTestDataserviceIdList)\r\n\t\t\t.finally(() => this.acceptanceTestDataserviceIdList.length = 0);\r\n\t}\r\n\r\n\tonEnableIonProxy(value: boolean): void {\r\n\t\tthis.isIonProxyActive = value;\r\n\t\tif (value) {\r\n\t\t\tlocalStorage.setItem(DeveloperConstants.ION_PROXY, \"true\");\r\n\t\t} else {\r\n\t\t\tlocalStorage.removeItem(DeveloperConstants.ION_PROXY);\r\n\t\t}\r\n\t}\r\n\r\n\tonLaunchAppWithAngular(value: boolean): void {\r\n\t\tthis.isLaunchWithAngular = value;\r\n\t\tif (value) {\r\n\t\t\tlocalStorage.setItem(DeveloperConstants.LAUNCH_WITH_ANGULAR, \"true\");\r\n\t\t} else {\r\n\t\t\tlocalStorage.removeItem(DeveloperConstants.LAUNCH_WITH_ANGULAR);\r\n\t\t}\r\n\t}\r\n\r\n\tnavigateBack(): void {\r\n\t\tif (this.canNavigateBack) {\r\n\t\t\tif (this.fromEditor) {\r\n\t\t\t\tthis.$state.go(AppState.EDITOR.name, {\r\n\t\t\t\t\tid: this.designerService.getCurrentProject().getId(),\r\n\t\t\t\t\treloadProject: false,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.$state.go(AppState.HOME.name);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setCanNavigateBack(): void {\r\n\t\tconst currentView = this.designerService.getView();\r\n\r\n\t\tthis.canNavigateBack = currentView === ViewEnum.DASHBOARD || currentView === ViewEnum.EDITOR;\r\n\t\tif (this.canNavigateBack) {\r\n\t\t\tthis.fromEditor = currentView === ViewEnum.EDITOR;\r\n\t\t}\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=container ng-show=::ctrl.isDeveloper> <div class=page-container> <header class=\\\"header is-personalizable\\\"> <div class=toolbar> <div class=title> <button class=\\\"btn-icon application-menu-trigger\\\" type=button ng-if=ctrl.canNavigateBack ng-click=ctrl.navigateBack()> <span class=\\\"icon app-header go-back\\\"> <span class=one></span> <span class=two></span> <span class=three></span> </span> </button> <h1><span>Developer Tools</span></h1> </div> </div> </header> <div class=\\\"page-container scrollable\\\" id=maincontent role=main> <div class=\\\"row top-padding\\\"> <div class=\\\"twelve columns\\\"> <div class=row> <div class=field> <button class=btn-primary ng-click=ctrl.deleteAllAcceptanceTestProjects() ng-disabled=\\\"ctrl.acceptanceTestProjectIdList.length === 0\\\"> Delete all acceptance test projects </button> <br/><br/> <button class=btn-primary ng-click=ctrl.deleteAllAcceptanceTestDataservices() ng-disabled=\\\"ctrl.acceptanceTestDataserviceIdList.length === 0\\\"> Delete all acceptance test data services </button> </div> <div class=field> <div class=switch> <input type=checkbox id=ion-proxy name=ion-proxy class=switch ng-checked=ctrl.isIonProxyActive ng-click=ctrl.onEnableIonProxy(!ctrl.isIonProxyActive) /> <label for=ion-proxy>Enable ION Proxy</label> </div> </div> <div class=field> <div class=switch> <input type=checkbox id=launch-with-angular name=launch-with-angular class=switch ng-checked=ctrl.isLaunchWithAngular ng-click=ctrl.onLaunchAppWithAngular(!ctrl.isLaunchWithAngular) /> <label for=launch-with-angular>Launch App with Angular</label> </div> </div> <div class=field> <label for=mg-config-name>Mongoose Config</label> <input type=text id=mgName-config-name name=mg-config-name ng-model=ctrl.mgConfigName> </div> <div class=field> <label for=ion-api-token>ION API Token</label> <input type=text id=ion-api-token name=ion-api-token ng-model=ctrl.ionApiToken> </div> <div class=field> <label for=current-loaded-project>Current Loaded Project</label> <textarea class=textarea id=current-loaded-project name=current-loaded-project ng-model=ctrl.currentProject></textarea> </div> <div class=field ng-show=ctrl.isProcessing> <label id=pr-label1>Percent complete</label> <div class=progress> <div class=progress-bar id=progress-bar data-value=0 aria-labelledby=pr-label1></div> </div> </div> </div> </div> </div> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","import { ButtonStyle, ComponentClassNames, SettingKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonButton } from \"ng2/common/model/databearer/components/json-button.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nimport { Button } from \"components/button/button\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { IMessageDialogOptions } from \"common/services/dialog-service\";\r\n\r\nexport interface IEditorButton extends IEditorComponent, Button {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonButton;\r\n}\r\n\r\nexport class EditorButtonCtrl extends EditorComponentCtrl {\r\n\r\n\tsetSetting(settingMeta: IComponentFieldSetting, newSettingValue: any): void {\r\n\t\tlet saveSetting = true;\r\n\t\tif (settingMeta.ref === SettingKeys.STYLE) {\r\n\t\t\tif (newSettingValue === ButtonStyle.FILL) {\r\n\t\t\t\tsaveSetting = this.component.parent.children.length === 1;\r\n\t\t\t\tif (!saveSetting) {\r\n\t\t\t\t\tthis.component.parent.getTypedef();\r\n\t\t\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\t\t\ttitle: \"Warning\",\r\n\t\t\t\t\t\tcssClass: \"warning-text\",\r\n\t\t\t\t\t\tmessage: \"The Button cannot fill due to too many components in the \" + this.component.parent.getTypedef()\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.dialogService.showMessage(options);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setSize(SizeTypeEnum.PERCENT);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.setSize(SizeTypeEnum.AUTO);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (saveSetting) {\r\n\t\t\tsuper.setSetting(settingMeta, newSettingValue);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setSize(sizeType: SizeTypeEnum): void {\r\n\t\tthis.setBoundarySetting(SettingKeys.WIDTH, { sizeType });\r\n\t\tthis.setBoundarySetting(SettingKeys.HEIGHT, { sizeType });\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Button.name,\r\n\t\t\tEditorButtonCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorButton;\r\n\r\n}\r\n","import { ComponentClassNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonCheckbox } from \"common/model/component/checkbox.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { Checkbox } from \"components/checkbox/checkbox\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorCheckbox extends IEditorComponent, Checkbox {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonCheckbox;\r\n}\r\n\r\nexport class EditorCheckboxCtrl extends EditorComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Checkbox.name,\r\n\t\t\tEditorCheckboxCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorCheckbox;\r\n\r\n}\r\n","import {\r\n\tComponentClassNames,\r\n\tComponentNames,\r\n\tSettingKeys,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\n\r\nimport type { IEditorComponentWithUpsertDatagridColumnSettings } from \"editor/component-settings/upsert-datagrid-columns-content-settings\";\r\nimport { EditorComponentCtrl } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorDatagrid extends IEditorComponentWithUpsertDatagridColumnSettings { }\r\n\r\nexport class EditorDatagridCtrl extends EditorComponentCtrl {\r\n\tprotected component: IEditorDatagrid;\r\n\r\n\tprotected clearData(): void {\r\n\t\tsuper.clearData();\r\n\t\tthis.component.clear();\r\n\t}\r\n\r\n\tgetMetaData(fieldRef: string, onSuccess: Function): void {\r\n\t\tconst datasource = this.component.getDatasource();\r\n\t\tif ((fieldRef === SettingKeys.SELECTED_ITEM || fieldRef === SettingKeys.DIRTY_ITEMS) && datasource) {\r\n\t\t\tdatasource.getMetaData().then((metaData) => {\r\n\t\t\t\tonSuccess(metaData.outputFields);\r\n\t\t\t});\r\n\t\t} else if (fieldRef === SettingKeys.SUMMARY_OUTPUT) {\r\n\t\t\tconst outputFields: IMetaDataField[] = [];\r\n\t\t\tconst component = this.component as any; // Datagrid\r\n\t\t\tif (component.summaryOutput) {\r\n\t\t\t\tObject.entries(component.summaryOutput).forEach(([key]) => {\r\n\t\t\t\t\toutputFields.push({\r\n\t\t\t\t\t\tFLNM: key,\r\n\t\t\t\t\t\tFLDS: key,\r\n\t\t\t\t\t\tMAND: \"0\"\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tonSuccess(outputFields);\r\n\t\t\t}\r\n\t\t} else if (fieldRef === SettingKeys.ROW_COUNT_OUTPUT) {\r\n\t\t\tconst rowCount: IMetaDataField[] = [];\r\n\t\t\tconst component = this.component as any; // Datagrid\r\n\t\t\tif (component.rowCountOutput) {\r\n\t\t\t\tObject.entries(component.rowCountOutput).forEach(([key]) => {\r\n\t\t\t\t\trowCount.push({\r\n\t\t\t\t\t\tFLNM: key,\r\n\t\t\t\t\t\tFLDS: \"\",\r\n\t\t\t\t\t\tMAND: \"0\"\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tonSuccess(rowCount);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetDatasource(newDatasource: IDatasource): ng.IPromise<void> {\r\n\t\treturn super.setDatasource(newDatasource).then(() => {\r\n\t\t\tthis.component.updateColumns();\r\n\t\t});\r\n\t}\r\n\r\n\trefreshMetaSettings(): void {\r\n\t\tthis.component.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + ComponentNames.Datagrid,\r\n\t\t\tEditorDatagridCtrl\r\n\t\t);\r\n\t}\r\n}\r\n","import { ComponentClassNames, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IJsonDatepicker } from \"common/model/component/datepicker.model\";\r\nimport { IDatepickerApi } from \"common/model/sohoxi/sohoxi-datepicker.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { Datepicker } from \"components/datepicker/datepicker\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorDatepicker extends IEditorComponent, Datepicker {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonDatepicker;\r\n\tgetSohoXiApi(): IDatepickerApi;\r\n}\r\n\r\nexport class EditorDatepickerCtrl extends EditorComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Datepicker.name,\r\n\t\t\tEditorDatepickerCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorDatepicker;\r\n\r\n\tpublic setSetting(settingMeta: IComponentFieldSetting, newSettingValue: any): void {\r\n\t\tsuper.setSetting(settingMeta, newSettingValue);\r\n\t\tswitch (settingMeta.ref) {\r\n\t\t\tcase SettingKeys.DATE_FORMAT_SHOW:\r\n\t\t\t\tthis.refresh();\r\n\t\t\t\t/* TODO: This timeout could be removed if we use syncronous way to update datepicker,\r\n\t\t\t\t\ti.e. not using xi-datepicker, but run element.datepicker(options); in DatePicker class\r\n\t\t\t\t*/\r\n\t\t\t\tconst waitTimeForXidatepickerOptionsToUpdate = 10;\r\n\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\tthis.component.datePickerApi.setValue(this.component.dateValue);\r\n\t\t\t\t}, waitTimeForXidatepickerOptionsToUpdate);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SettingKeys.DATE_FORMAT_BINDING:\r\n\t\t\t\t// Resetting value will update formatted binding\r\n\t\t\t\tthis.component.setDateValue(this.component.dateValue);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SettingKeys.DATE_FORMAT_INPUT:\r\n\t\t\t\tconst unparsedDateValue = this.editorService.readValueSource(\r\n\t\t\t\t\tthis.component.getDatabearer().dateValue,\r\n\t\t\t\t\tthis.component.getContext()\r\n\t\t\t\t);\r\n\t\t\t\t// Resetting bindable value will re-parse input\r\n\t\t\t\tthis.component.setBindableValue(SettingKeys.DATE_VALUE, unparsedDateValue);\r\n\t\t\t\tbreak;\r\n\t\t\tcase SettingKeys.DATE_TODAY:\r\n\t\t\t\tthis.component.updateDatepickerValue();\r\n\t\t\t\tbreak;\r\n\t\t\tcase SettingKeys.IS_READONLY:\r\n\t\t\t\tthis.component.updateDatepickerReadonlyValue();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// Other settings\r\n\t\t}\r\n\t}\r\n\r\n\tprivate refresh(): void {\r\n\t\tconst inputElement = this.component.datePickerApi.element;\r\n\t\t// nulling placeholder to make soho update it\r\n\t\tinputElement.attr(\"placeholder\", \"\");\r\n\t\t// Soho does not clean this attribute\r\n\t\tinputElement.attr(\"data-validate\", \"\");\r\n\t\tthis.component.setDatepickerOptions();\r\n\t}\r\n}\r\n","import { InteractionActionEnum, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IJsonDropdown } from \"ng2/common/model/databearer/components/json-dropdown.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport { IAvailableTargetField } from \"ng2/common/model/interaction/available-target-field.model\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { Dropdown } from \"components/dropdown/dropdown\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorDropdown extends IEditorComponent, Dropdown {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonDropdown;\r\n}\r\n\r\nexport class EditorDropdownCtrl extends EditorComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"editor-Dropdown\", EditorDropdownCtrl);\r\n\t}\r\n\r\n\tprotected component: IEditorDropdown;\r\n\r\n\tpublic getParameterMetadata(action: InteractionActionEnum): ng.IPromise<IAvailableTargetField[]> {\r\n\t\tconst component = this.component;\r\n\t\tconst datasource = this.component.datasource;\r\n\t\tif (action === InteractionActionEnum.SET_CURRENT_ITEM && datasource) {\r\n\t\t\treturn datasource.getMetaData().then((dataserviceMetadata) => {\r\n\t\t\t\treturn dataserviceMetadata.outputFields.map((outputField) => {\r\n\t\t\t\t\tlet currentValue: string;\r\n\t\t\t\t\tif (component.currentItem) {\r\n\t\t\t\t\t\tcurrentValue = Helper.trimIfPossible(component.currentItem[outputField.FLNM]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tvisibleName: outputField.FLDS + (currentValue !== undefined ? `(${currentValue})` : \"\"),\r\n\t\t\t\t\t\ttargetKey: outputField.FLNM,\r\n\t\t\t\t\t\tisMandatory: false,\r\n\t\t\t\t\t\tMeta: {\r\n\t\t\t\t\t\t\tname: outputField.FLDS,\r\n\t\t\t\t\t\t\tref: outputField.FLNM,\r\n\t\t\t\t\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\t\t\t\t\twrite: true,\r\n\t\t\t\t\t\t\tread: true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} as IAvailableTargetField;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\treturn super.getParameterMetadata(action);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getMetaData(fieldRef: string, onSuccess: Function): void {\r\n\t\tconst datasource = this.component.getDatasource();\r\n\t\tif (fieldRef === SettingKeys.CURRENT_ITEM && datasource) {\r\n\t\t\tdatasource.getMetaData().then((metaData) => {\r\n\t\t\t\tonSuccess(metaData.outputFields);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setDatasource(newDatasource: IDatasource | null): ng.IPromise<void> {\r\n\t\tconst promise = super.setDatasource(newDatasource);\r\n\t\tif (newDatasource) {\r\n\t\t\tnewDatasource.getMetaData().then((metaData) => {\r\n\t\t\t\tconst component = this.component;\r\n\t\t\t\tconst availableOutput: IMetaDataField[] = $.extend([], metaData.outputFields, true).reverse();\r\n\t\t\t\tconst newValueSource: IJsonValueSource = {\r\n\t\t\t\t\tType: BindingTypeEnum.CONTEXT_BINDING,\r\n\t\t\t\t\tsourceKey: availableOutput.pop().FLNM\r\n\t\t\t\t};\r\n\t\t\t\tthis.bindingManagementService.registerContextBinding(component, SettingKeys.DISPLAY_VALUE, newValueSource);\r\n\t\t\t\tcomponent.getDatabearer().displayValue = newValueSource;\r\n\t\t\t\tcomponent.displayValue = newValueSource;\r\n\t\t\t\tcomponent.loadInteraction(this.interactionManagementService.createNewOnTheFly(InteractionActionEnum.LIST));\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tprotected clearData(): void {\r\n\t\tsuper.clearData();\r\n\t\tconst component = this.component;\r\n\t\tconst dropdownDatabearer = component.getDatabearer();\r\n\t\tconst sourceKey = dropdownDatabearer.displayValue.sourceKey;\r\n\t\tthis.bindingManagementService.unregisterContextBinding(component, sourceKey, SettingKeys.DISPLAY_VALUE);\r\n\t\tconst newvalueSource: IJsonValueSource = { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" };\r\n\t\tdropdownDatabearer.displayValue = newvalueSource;\r\n\t\tcomponent.displayValue = newvalueSource;\r\n\t}\r\n}\r\n","import { IJsonPersistentComponent } from \"ng2/common/model/databearer/components/base/json-persistent-components.model\";\r\nimport { IJsonComponent, IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonDropdown extends IJsonComponent, IJsonPersistentComponent {\r\n\tdisplayValue: IJsonValueSource;\r\n\tlabel: IJsonValueSource;\r\n\tshowLabel: IJsonValueSource; // Deprecated\r\n\tboundarySettings: IMap<IJsonDropdownSettings>;\r\n}\r\n\r\nexport interface IJsonDropdownSettings extends IJsonComponentSettings {\r\n\tshowLabel: boolean;\r\n\tboxWidth: string;\r\n}\r\n\r\nexport interface IStaticValueDropdown {\r\n\tvalue: number;\r\n\tlabel: string;\r\n}\r\n","import type { IBuildLinkParameter, IBuildLinkResponse } from \"../component-settings/build-link-dialog/build-link-dialog\";\r\n\r\nimport { ComponentClassNames, SettingKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\n\r\nimport type { IJsonHyperlink } from \"common/model/component/hyperlink.model\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { Hyperlink } from \"components/hyperlink/hyperlink\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { DialogButtonType, IDialogOptions, IDialogResult } from \"common/services/dialog-service\";\r\n\r\nexport interface IEditorHyperlink extends IEditorComponent, Hyperlink {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonHyperlink;\r\n}\r\n\r\nexport class EditorHyperlinkCtrl extends EditorComponentCtrl {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Hyperlink.name,\r\n\t\t\tEditorHyperlinkCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorHyperlink;\r\n\r\n\topenDialog(settingKey: string): ng.IPromise<void> {\r\n\t\tsuper.openDialog(settingKey);\r\n\t\tconst deferred = this.editorService.getNewDeferred<void>();\r\n\t\tif (settingKey === SettingKeys.LINK_VALUE) {\r\n\t\t\tconst options: IDialogOptions<IBuildLinkParameter> = {\r\n\t\t\t\ttitle: \"Hyperlink - Build link\",\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\tlink: this.component.link,\r\n\t\t\t\t\tsources: this.component.sources,\r\n\t\t\t\t\tcomponent: this.component\r\n\t\t\t\t},\r\n\t\t\t\ttemplate: require(\"../component-settings/build-link-dialog/build-link-dialog.html\")\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<IBuildLinkResponse>) => {\r\n\t\t\t\tconst okButton = result.button === DialogButtonType.Ok;\r\n\t\t\t\tif (okButton) {\r\n\t\t\t\t\tthis.component.link = result.value.link;\r\n\t\t\t\t\tthis.component.sources = result.value.sources;\r\n\t\t\t\t\tthis.component.setProperty(SettingKeys.LINK_VALUE, result.value.link);\r\n\t\t\t\t\tthis.component.setProperty(\"sources\", result.value.sources);\r\n\t\t\t\t\tthis.component.renderURL();\r\n\t\t\t\t\tthis.registerSourceBindings();\r\n\t\t\t\t\tdeferred.resolve();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tsetSetting(settingMeta: IComponentFieldSetting, newSettingValue: string): void {\r\n\t\tsuper.setSetting(settingMeta, newSettingValue);\r\n\t\tif (settingMeta.ref === SettingKeys.LINK_VALUE) {\r\n\t\t\tthis.component.renderURL();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate registerSourceBindings(): void {\r\n\t\tthis.component.sources.forEach((source) => {\r\n\t\t\tconst valueSourceObject: IJsonValueSource = {\r\n\t\t\t\tType: BindingTypeEnum.BINDING,\r\n\t\t\t\tsourceKey: source.value,\r\n\t\t\t\tsourceName: source.type\r\n\t\t\t};\r\n\t\t\tthis.bindingManagementService.registerBinding(this.component, source.alias, valueSourceObject);\r\n\t\t});\r\n\t}\r\n}\r\n","import { ComponentClassNames, ContextKeys, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IJsonImage } from \"common/model/component/image.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { Image } from \"components/image/image\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorImage extends IEditorComponent, Image {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonImage;\r\n}\r\n\r\nexport class EditorImageCtrl extends EditorComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Image.name,\r\n\t\t\tEditorImageCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorImage;\r\n\r\n\tpublic setDatasource(newDatasource: IDatasource | null): ng.IPromise<void> {\r\n\t\tconst promise = super.setDatasource(newDatasource);\r\n\t\tif (newDatasource) {\r\n\t\t\tconst newValueSource = { Type: BindingTypeEnum.CONTEXT_BINDING, sourceKey: ContextKeys.DETAIL_RESULT };\r\n\t\t\tthis.bindingManagementService.registerContextBinding(this.component, SettingKeys.SOURCE, newValueSource);\r\n\t\t\tthis.component.getDatabearer().source = newValueSource;\r\n\t\t}\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tprotected clearData(): void {\r\n\t\tsuper.clearData();\r\n\t\tthis.bindingManagementService.unregisterContextBinding(this.component, ContextKeys.DETAIL_RESULT);\r\n\t\tthis.component.getDatabearer().source = { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" };\r\n\t}\r\n}\r\n","import { ComponentClassNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { IJsonLabel } from \"ng2/common/model/databearer/components/json-label.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { Label } from \"components/label/label\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nexport interface IEditorLabel extends IEditorComponent, Label {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonLabel;\r\n}\r\n\r\nexport class EditorLabelCtrl extends EditorComponentCtrl {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Label.name,\r\n\t\t\tEditorLabelCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorLabel;\r\n\r\n}\r\n","import { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport interface IJsonLabel extends IJsonComponent {\r\n\tcontent: IJsonValueSource;\r\n\ttoolTip: IJsonValueSource;\r\n\tfontStyle: string;\r\n\tfontChar: string;\r\n\tcolor: string;\r\n}\r\n","\r\nimport {\r\n\tComponentClassNames,\r\n\tInteractionActionEnum,\r\n\tSettingKeys,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport type { IJsonList } from \"ng2/common/model/databearer/components/json-list.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { List } from \"components/list/list\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nexport interface IEditorList extends IEditorComponent, List {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonList;\r\n\tcalcNewSizes(orientation?: OrientationEnum): void;\r\n}\r\n\r\nexport class EditorListCtrl extends EditorComponentCtrl {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + List.name,\r\n\t\t\tEditorListCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorList;\r\n\r\n\tgetMetaData(fieldRef: string, onSuccess: Function): void {\r\n\t\tconst datasource = this.component.getDatasource();\r\n\t\tif (fieldRef === SettingKeys.CURRENT_ITEM && datasource) {\r\n\t\t\tdatasource.getMetaData().then((metaData) => {\r\n\t\t\t\tonSuccess(metaData.outputFields);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tsetDatasource(newDatasource: IDatasource | null): ng.IPromise<void> {\r\n\t\tconst promise = super.setDatasource(newDatasource);\r\n\r\n\t\tif (newDatasource) {\r\n\t\t\tnewDatasource.getMetaData().then((metaData) => {\r\n\t\t\t\tthis.component.forEachItemTemplate((templateComponent) => {\r\n\t\t\t\t\tthis.editorService.setDefaultBindings(templateComponent, metaData.outputFields);\r\n\t\t\t\t});\r\n\t\t\t\tthis.component\r\n\t\t\t\t\t.loadInteraction(this.interactionManagementService.createNewOnTheFly(InteractionActionEnum.LIST));\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tsetSetting(settingMeta: IComponentFieldSetting, newSettingValue: any): void {\r\n\t\tsuper.setSetting(settingMeta, newSettingValue);\r\n\t\tswitch (settingMeta.ref) {\r\n\t\t\tcase SettingKeys.SEARCH:\r\n\t\t\t\tthis.component.clearSearch();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tprotected clearData(): void {\r\n\t\tsuper.clearData();\r\n\t\tthis.component.refresh();\r\n\t}\r\n}\r\n","import { ComponentClassNames, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nimport { Lookup } from \"components/lookup/lookup\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\n\r\nexport interface IEditorLookup extends IEditorComponent {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonLookup;\r\n}\r\n\r\nexport class EditorLookupCtrl extends EditorComponentCtrl {\r\n\r\n\tpublic getMetaData(fieldRef: string, onSuccess: Function): void {\r\n\t\tconst datasource = this.component.getDatasource();\r\n\t\tif (fieldRef === SettingKeys.SELECTED_ITEM && datasource) {\r\n\t\t\tdatasource.getMetaData().then((metaData) => {\r\n\t\t\t\tonSuccess(metaData.outputFields);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setDatasource(newDatasource: IDatasource | null): ng.IPromise<void> {\r\n\t\tconst promise = super.setDatasource(newDatasource);\r\n\t\t(this.component.getDatabearer() as IJsonLookup).lookupOutputId = undefined;\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Lookup.name,\r\n\t\t\tEditorLookupCtrl\r\n\t\t);\r\n\t}\r\n}\r\n","import { ComponentClassNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonTabPanel } from \"common/model/component/tabs.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { TabPanel } from \"components/tabs/tab-panel\";\r\nimport type { IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport { EditorFlexboxCtrl, IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\nimport type { IEditorTabs } from \"editor/components/editor-tabs\";\r\n\r\nexport interface IEditorTabPanel extends IEditorFlexbox, TabPanel {\r\n\tchildren: IEditorComponent[];\r\n\tparent: IEditorTabs;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonTabPanel;\r\n}\r\n\r\nexport class EditorTabPanelCtrl extends EditorFlexboxCtrl {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + TabPanel.name,\r\n\t\t\tEditorTabPanelCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorTabPanel;\r\n\r\n}\r\n","import { ComponentClassNames, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\n\r\nimport type { IJsonTextArea } from \"common/model/component/textarea.model\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nimport { TextArea } from \"components/textarea/textarea\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\nexport interface IEditorTextArea extends IEditorComponent, TextArea {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonTextArea;\r\n}\r\n\r\nexport class EditorTextAreaCtrl extends EditorComponentCtrl {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + TextArea.name,\r\n\t\t\tEditorTextAreaCtrl\r\n\t\t);\r\n\t}\r\n\tprotected component: IEditorTextArea;\r\n\r\n\tpublic setSetting(settingMeta: IComponentFieldSetting, newSettingValue: number): void {\r\n\t\tsuper.setSetting(settingMeta, newSettingValue);\r\n\t\tswitch (settingMeta.ref) {\r\n\t\t\tcase SettingKeys.MAX_LENGTH:\r\n\t\t\t\tthis.component.updateMaxLength();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// Other settings\r\n\t\t}\r\n\t}\r\n}\r\n","import { ComponentClassNames, SettingKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonTimepicker } from \"common/model/component/timepicker.model\";\r\nimport type { ITimepickerApi } from \"common/model/sohoxi/sohoxi-timepicker.model\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { Timepicker } from \"components/timepicker/timepicker\";\r\nimport { EditorComponentCtrl, IEditorComponentScope } from \"editor/components/editor-component\";\r\nimport type { IEditorFlexbox } from \"editor/components/editor-flexbox\";\r\n\r\nexport interface IEditorTimepicker extends IEditorComponent, Timepicker {\r\n\tparent: IEditorFlexbox;\r\n\t// Overrides to make dual extend work\r\n\tgetScope(): IEditorComponentScope;\r\n\tgetDatabearer(): IJsonTimepicker;\r\n\tgetSohoXiApi(): ITimepickerApi;\r\n}\r\n\r\nexport class EditorTimepickerCtrl extends EditorComponentCtrl {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\r\n\t\t\tComponentClassNames.EDITOR_COMPONENT_PREFIX + Timepicker.name,\r\n\t\t\tEditorTimepickerCtrl\r\n\t\t);\r\n\t}\r\n\r\n\tprotected component: IEditorTimepicker;\r\n\r\n\tsetSetting(settingMeta: IComponentFieldSetting, newSettingValue: any): void {\r\n\t\tsuper.setSetting(settingMeta, newSettingValue);\r\n\t\tswitch (settingMeta.ref) {\r\n\t\t\tcase SettingKeys.IS_READONLY:\r\n\t\t\tcase SettingKeys.TIME_FORMAT:\r\n\t\t\tcase SettingKeys.ENABLE_SECONDS:\r\n\t\t\t\tthis.component.refreshTimepicker();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { ICustomComponentDefinition } from \"ng2/common/model/components/custom-component-definition.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { IModalDialog, IModalOptions } from \"../../../../common/model/sohoxi/sohoxi.model\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport { ISettingsScope } from \"../settings\";\r\n\r\nexport interface ICustomComponentCtrlScope extends ISettingsScope {\r\n\tnewCustom: Function;\r\n\teditCustom: Function;\r\n\tdeleteCustom: Function;\r\n\tcustomComponent: ICustomComponentDefinition;\r\n\tnewBindable: Function;\r\n\tupdateUI: Function;\r\n\r\n\tsplitCSV: (value: string) => string[];\r\n\tgetCustomComponents: () => void;\r\n}\r\n\r\nexport class CustomComponentCtrl {\r\n\tpublic idCounter = 0;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TEMPLATE_CACHE,\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: ICustomComponentCtrlScope,\r\n\t\tprivate $templateCache: ng.ITemplateCacheService,\r\n\t\tprivate $compile: ng.ICompileService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate editorService: EditorService\r\n\t) {\r\n\t\t$scope.newCustom = () => { this.newCustom(); };\r\n\t\t$scope.editCustom = (customComponentId: string) => { this.editCustom(customComponentId); };\r\n\t\t$scope.deleteCustom = (customComponentId: string) => { this.deleteCustom(customComponentId); };\r\n\t\t$scope.updateUI = () => { this.updateDialogUi(); };\r\n\r\n\t\t$scope.getCustomComponents = () => {\r\n\t\t\treturn this.editorService.getCurrentProject().getCustomComponentDefinitions();\r\n\t\t};\r\n\r\n\t\t$scope.newBindable = () => {\r\n\t\t\tconst bindableField: IJsonBindableField = {\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tref: \"\",\r\n\t\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\t\twrite: true,\r\n\t\t\t\tread: true\r\n\t\t\t};\r\n\r\n\t\t\tif (!$scope.customComponent.bindableFields) {\r\n\t\t\t\t$scope.customComponent.bindableFields = [];\r\n\t\t\t}\r\n\r\n\t\t\t$scope.customComponent.bindableFields.push(bindableField);\r\n\t\t};\r\n\r\n\t\t$scope.splitCSV = (value: string) => {\r\n\t\t\tif (value) {\r\n\t\t\t\treturn value.split(\",\");\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tprivate newCustom(): void {\r\n\t\tconst customComponents = this.editorService.getCurrentProject().getCustomComponentDefinitions();\r\n\t\tconst generatedId = this.generateId(\"custom_component\", Object.keys(customComponents));\r\n\t\tconst customComponent: ICustomComponentDefinition = {\r\n\t\t\tid: generatedId,\r\n\t\t\tdisplayName: generatedId\r\n\t\t};\r\n\r\n\t\tcustomComponent.htmlTemplate = \"<span>TJENA</span>\";\r\n\t\tcustomComponent.init = 'console.info(\"[CustomComponentCtrl] ID: \" + this.Id);';\r\n\t\tcustomComponent.bindableFields = [];\r\n\r\n\t\tthis.editorService.getCurrentProject().addCustomComponentDefinition(customComponent);\r\n\t\tthis.editCustom(customComponent.id);\r\n\t}\r\n\r\n\tprivate editCustom(customComponentId: string): void {\r\n\t\tconst template = this.$templateCache.get<string>(\"designer/editor/component-settings/custom/new-custom-dialog.html\");\r\n\t\tif (template) {\r\n\t\t\tthis.$scope.customComponent =\r\n\t\t\t\tthis.editorService.getCurrentProject().getCustomComponentDefinitions()[customComponentId];\r\n\r\n\t\t\tif (this.$scope.customComponent) {\r\n\t\t\t\tif (!this.$scope.customComponent.sourceTriggers) {\r\n\t\t\t\t\tthis.$scope.customComponent.sourceTriggers = [];\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.$scope.customComponent.targetActions) {\r\n\t\t\t\t\tthis.$scope.customComponent.targetActions = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst ctemplate = this.$compile(template)(this.$scope);\r\n\t\t\t\tconst settings: IModalOptions = {\r\n\t\t\t\t\ttitle: \"Edit Custom Component\",\r\n\t\t\t\t\tcontent: ctemplate,\r\n\t\t\t\t\tbuttons: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttext: \"OK\",\r\n\t\t\t\t\t\t\tclick: (event: JQueryEventObject, modal: IModalDialog) => {\r\n\t\t\t\t\t\t\t\tmodal.close();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttext: \"Cancel\",\r\n\t\t\t\t\t\t\tisDefault: true,\r\n\t\t\t\t\t\t\tclick: (event: JQueryEventObject, modal: IModalDialog) => {\r\n\t\t\t\t\t\t\t\tmodal.close();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t};\r\n\t\t\t\tangular.element(\"body\").modal(settings);\r\n\t\t\t\tangular.element(\"customComponentDialog\").find(\".tab-panel\").bind(\"updated\", (e: JQueryEventObject) => {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t});\r\n\t\t\t\tthis.updateDialogUi();\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn(\"[CustomComponentCtrl] Invalid custom component ID\");\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.error(\"[CustomComponentCtrl] TEMPLATE error\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate deleteCustom(customComponentId: string): void {\r\n\t\t//var template = this.$templateCache.get(\"designer/editor/component-settings/custom/new-custom-dialog.html\");\r\n\t\tthis.$scope.customComponent =\r\n\t\t\tthis.editorService.getCurrentProject().getCustomComponentDefinitions()[customComponentId];\r\n\r\n\t\tif (this.$scope.customComponent) {\r\n\t\t\t//var ctemplate = this.$compile(template)(this.$scope);\r\n\t\t\tconst settings: IModalOptions = {\r\n\t\t\t\ttitle: \"Confirm delete\",\r\n\t\t\t\tcontent: \"Really delete Custom component: \" + this.$scope.customComponent.displayName,\r\n\t\t\t\tbuttons: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: \"Delete\",\r\n\t\t\t\t\t\tclick: (event: JQueryEventObject, modal: IModalDialog) => {\r\n\t\t\t\t\t\t\tconsole.warn(\"[CustomComponentCtrl] TODO implement delete custom component\");\r\n\t\t\t\t\t\t\tmodal.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttext: \"Cancel\",\r\n\t\t\t\t\t\tisDefault: true,\r\n\t\t\t\t\t\tclick: (event: JQueryEventObject, modal: IModalDialog) => {\r\n\t\t\t\t\t\t\tmodal.close();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\t$(\"body\").modal(settings);\r\n\r\n\t\t\tthis.updateDialogUi();\r\n\t\t} else {\r\n\t\t\tconsole.error(\"[CustomComponentCtrl] TEMPLATE error\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate generateId(key: string, scDefsIds: string[]): string {\r\n\t\tconst newId = key + this.idCounter++;\r\n\t\tfor (const i in scDefsIds) {\r\n\t\t\tif (scDefsIds[i] === newId) {\r\n\t\t\t\treturn this.generateId(key, scDefsIds);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newId;\r\n\t}\r\n\r\n\tprivate updateDialogUi(): void {\r\n\t\tthis.$timeout(() => {\r\n\t\t\t$(\"customComponentDialog\").find(\"select\").trigger(\"updated\");\r\n\t\t}, 1);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirCustomComponentCtrl\", CustomComponentCtrl);\r\n\t}\r\n}\r\n","\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport type { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport type { ISourceItem } from \"../../../../common/model/component/hyperlink.model\";\r\nimport { BindingManagementService } from \"../../services/binding-management-service\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\n\r\nimport { BindingTypes, InjectNames, ValueObject } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\n\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\n\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"common/services/dialog-service\";\r\n\r\nexport interface IAlias {\r\n\tnew?: string;\r\n\told?: string;\r\n\tindex: string;\r\n}\r\n\r\nexport interface IBuildLinkResponse {\r\n\tlink: string,\r\n\tsources: ISourceItem[]\r\n}\r\n\r\nexport interface IBuildLinkParameter {\r\n\tlink: string,\r\n\tsources: ISourceItem[],\r\n\tcomponent: IEditorComponent\r\n}\r\n\r\nexport class BuildLinkCtrl {\r\n\tmyLink: string;\r\n\tavailableSources: IDataPair[] = [];\r\n\tnewTypeValue: string;\r\n\tprivate dialog: IDialog<IBuildLinkParameter>;\r\n\tlink: string;\r\n\tsources: ISourceItem[];\r\n\tcomponent: IEditorComponent;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.BINDING_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tscope: IDialogBaseScope<IBuildLinkParameter>,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate bindingManagementService: BindingManagementService\r\n\t) {\r\n\t\tconst dialog: IDialog<IBuildLinkParameter> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.link = dialog.parameter.link;\r\n\t\tthis.sources = dialog.parameter.sources;\r\n\t\tthis.component = dialog.parameter.component;\r\n\r\n\t\tthis.buildLink();\r\n\t\tthis.availableSources = this.getAvailableSources();\r\n\t}\r\n\r\n\tupdateAlias(oldAlias: string, newAlias: string, index: string): void {\r\n\t\tlet link = this.link;\r\n\t\tconst oldSourceAlias = `{${oldAlias}}`;\r\n\t\tconst oldAliasExists = link.indexOf(oldSourceAlias) !== -1;\r\n\r\n\t\tif (newAlias) { //New alias can not be empty\r\n\t\t\tif (oldAliasExists) { //Old alias should exist in link\r\n\t\t\t\tconst newSourceAlias = `{${newAlias}}`;\r\n\t\t\t\tconst newAliasExists = link.indexOf(newSourceAlias) !== -1;\r\n\r\n\t\t\t\tif (!newAliasExists) {\r\n\t\t\t\t\tlink = link.replace(oldSourceAlias, newSourceAlias);\r\n\t\t\t\t\tthis.editorService.hyperlinkAliasChangedEvent.raise({ index: index });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.editorService.hyperlinkAliasChangedEvent.raise({\r\n\t\t\t\t\t\told: oldAlias,\r\n\t\t\t\t\t\tindex: index\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.link = link;\r\n\t\t\t} else {\r\n\t\t\t\tthis.editorService.hyperlinkAliasChangedEvent.raise({ index: index });\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.editorService.hyperlinkAliasChangedEvent.raise({\r\n\t\t\t\tnew: newAlias,\r\n\t\t\t\tindex: index\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t//components using build-link-dialog need to have a buildLink function\r\n\tbuildLink(): void {\r\n\t\tconst component = this.component as any;\r\n\t\tthis.myLink = component.buildLink(this.link, this.sources);\r\n\t}\r\n\r\n\taddSource(): void {\r\n\t\tconst sources = this.sources;\r\n\t\t//Default to first\r\n\t\tlet newSourceName = \"source1\";\r\n\t\tif (sources.length > 0) {\r\n\t\t\t//Get next number\r\n\t\t\tconst newNumber = parseInt(sources[sources.length - 1].alias.replace(\"source\", \"\")) + 1;\r\n\t\t\tif (newNumber) {\r\n\t\t\t\tnewSourceName = `source${newNumber}`;\r\n\t\t\t}\r\n\t\t}\r\n\t\tsources.push({\r\n\t\t\talias: newSourceName,\r\n\t\t\tvalue: \"\",\r\n\t\t\ttype: this.newTypeValue\r\n\t\t});\r\n\t\tthis.link = `${this.link}{${newSourceName}}`;\r\n\t\tthis.availableSources = this.getAvailableSources();\r\n\t}\r\n\r\n\tremoveSource(source: ISourceItem): void {\r\n\t\tconst indexToRemove = this.sources.findIndex(item => item.alias === source.alias);\r\n\t\tthis.sources.splice(indexToRemove, 1);\r\n\t\tthis.link = this.link.replace(`{${source.alias}}`, \"\");\r\n\t\tthis.buildLink();\r\n\t\tthis.availableSources = this.getAvailableSources();\r\n\t\tthis.unregisterBinding(source);\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\tconst result: IDialogResult<IBuildLinkResponse> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: {\r\n\t\t\t\tlink: this.link,\r\n\t\t\t\tsources: this.sources\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tclose(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tprivate unregisterBinding(source: ISourceItem): void {\r\n\t\tif (source.type === BindingTypes.CONTEXT) {\r\n\t\t\tthis.bindingManagementService.unregisterContextBinding(this.component, source.value, \"linkvalue\");\r\n\t\t} else {\r\n\t\t\tconst valueSourceObject: IJsonValueSource = {\r\n\t\t\t\tType: BindingTypeEnum.BINDING,\r\n\t\t\t\tsourceKey: source.value,\r\n\t\t\t\tsourceName: source.type\r\n\t\t\t};\r\n\t\t\tthis.bindingManagementService.unregisterBinding(this.component, source.alias, valueSourceObject);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getAvailableSources(): IDataPair[] {\r\n\t\tconst availableSources: IDataPair[] = [{\r\n\t\t\tvalue: BindingTypes.CONTEXT,\r\n\t\t\tname: ValueObject.TARGET_CONTEXT\r\n\t\t}];\r\n\t\tconst components = this.editorService.getAllBindableComponents();\r\n\t\tcomponents.forEach((component) => {\r\n\t\t\tconst sourceExists = this.sources.find((source) => {\r\n\t\t\t\treturn source.type === component.getId();\r\n\t\t\t});\r\n\t\t\tif (!sourceExists) {\r\n\t\t\t\tavailableSources.push({\r\n\t\t\t\t\tvalue: component.getId(),\r\n\t\t\t\t\tname: component.getDisplayName()\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (availableSources.length > 0) {\r\n\t\t\tthis.newTypeValue = availableSources[0].value;\r\n\t\t} else {\r\n\t\t\tthis.newTypeValue = null;\r\n\t\t}\r\n\t\treturn availableSources;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirBuildLinkCtrl\", BuildLinkCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport { IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { IRowItem } from \"../../../../common/sohoxi/datagrid-helper\";\r\n\r\nexport interface IAutoAddColumnResponse {\r\n\tselectedColumns: IMetaDataField[];\r\n\tautoFormatColumns: boolean;\r\n}\r\n\r\nexport class AutoAddColumnCtrl {\r\n\r\n\tpublic datagridOptions: IDataGridOptions<any>;\r\n\tpublic autoFormatColumns = false;\r\n\r\n\tprivate dialog: IDialog<IMetaDataField[]>;\r\n\tprivate metadata: IMetaDataField[];\r\n\tprivate selectedFields: IMetaDataField[];\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate scope: IDialogBaseScope<IMetaDataField[]>,\r\n\t\tprivate element: ng.IAugmentedJQuery\r\n\t) {\r\n\t\tconst dialog: IDialog<IMetaDataField[]> = this.scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.metadata = dialog.parameter;\r\n\t\tthis.datagridOptions = this.initDatagridOptions();\r\n\t\tthis.initSelectEvent();\r\n\t}\r\n\r\n\tpublic cancel(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic ok(): void {\r\n\t\tconst result: IDialogResult<IAutoAddColumnResponse> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: {\r\n\t\t\t\tselectedColumns: this.selectedFields,\r\n\t\t\t\tautoFormatColumns: this.autoFormatColumns\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tprivate initDatagridOptions(): IDataGridOptions<IMetaDataField> {\r\n\t\tconst columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\tid: \"selectionCheckbox\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\t\talign: \"center\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"flnm\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"FLNM\",\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: \"50%\",\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"flds\",\r\n\t\t\t\tname: \"Description\",\r\n\t\t\t\tfield: \"FLDS\",\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\twidth: \"50%\",\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t}\r\n\t\t];\r\n\t\treturn {\r\n\t\t\tcolumns,\r\n\t\t\tdataset: this.metadata,\r\n\t\t\trowHeight: \"short\",\r\n\t\t\tselectable: SelectableEnum.Multiple\r\n\t\t};\r\n\t}\r\n\r\n\tprivate initSelectEvent(): void {\r\n\t\tthis.element.find(\"#metadata-grid\").on(\"selected\", (event, rowItems: IRowItem<IMetaDataField>[]) => {\r\n\t\t\tif (rowItems.length > 0) {\r\n\t\t\t\tthis.selectedFields = rowItems.map(rowObject => rowObject.data);\r\n\t\t\t} else {\r\n\t\t\t\tthis.selectedFields = [];\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirAutoAddColumnCtrl\", AutoAddColumnCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport type { IAvailableSourceField, IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport type { IAccordionApi } from \"../../../../common/model/sohoxi/sohoxi-accordion.model\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../../../common/services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"../../../../common/shared-components/base/feature-switch-ctrl\";\r\nimport { DatagridHelper } from \"../../../../common/sohoxi/datagrid-helper\";\r\nimport { Datagrid } from \"../../../../components/datagrid/datagrid\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\nimport type { IBuildLinkParameter, IBuildLinkResponse } from \"../build-link-dialog/build-link-dialog\";\r\nimport type { IEditorComponentWithUpsertDatagridColumnSettings, IUpsertOption } from \"../upsert-datagrid-columns-content-settings\";\r\n\r\nimport { ColumnFormatterType, IChanged, InjectNames, SummaryTextPlacement, TextAlignment, ValueObject } from \"ng2/common/constants/common.constant\";\r\nimport { ColumnOptionEnum, FormatterEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport type { ISourceItem } from \"common/model/component/hyperlink.model\";\r\nimport type { IAutoCompleteOptions } from \"common/model/sohoxi/sohoxi-autocomplete.model\";\r\nimport type { ILookupOptions } from \"common/model/sohoxi/sohoxi-lookup.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IColumnFormatter {\r\n\tname: string;\r\n\tvalue: string;\r\n\ttype: number;\r\n}\r\n\r\nexport class UpsertColumnCtrl extends FeatureSwitchCtrl {\r\n\tavailableDataservices: IJsonGenericDatasource2[];\r\n\tisAdd: boolean;\r\n\tselectedSourceField: IAvailableSourceField;\r\n\tselectedFormatter: IColumnFormatter;\r\n\tselectedListSource: IJsonGenericDatasource2;\r\n\tselectedSubstituteSource: IJsonGenericDatasource2;\r\n\tselectedListOutput: IParameterObject;\r\n\tselectedToSubstituteOutput: IParameterObject;\r\n\tselectedFromSubstituteOutput: IParameterObject;\r\n\tlistSourceOutputParameters: IParameterObject[];\r\n\tsubstituteSourceOutputParameters: IParameterObject[];\r\n\tisDataGrid: boolean;\r\n\tlookupOptions: ILookupOptions;\r\n\tautocompleteOptions: IAutoCompleteOptions;\r\n\r\n\tavailableTextPlacement: IDataPair[] = [\r\n\t\t{ name: \"Before\", value: SummaryTextPlacement.BEFORE },\r\n\t\t{ name: \"After\", value: SummaryTextPlacement.AFTER },\r\n\t];\r\n\r\n\tavailableAlignment: IDataPair[] = [\r\n\t\t{ name: \"Left\", value: TextAlignment.LEFT },\r\n\t\t{ name: \"Right\", value: TextAlignment.RIGHT },\r\n\t\t{ name: \"Center\", value: TextAlignment.CENTER }\r\n\t]\r\n\r\n\tcolumnFormatters: IColumnFormatter[] = [\r\n\t\t{\r\n\t\t\tname: \"None\",\r\n\t\t\tvalue: \"none\",\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Checkbox\",\r\n\t\t\tvalue: FormatterEnum.Checkbox,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Date Picker\",\r\n\t\t\tvalue: FormatterEnum.Date,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Date/Time Picker\",\r\n\t\t\tvalue: FormatterEnum.Datetime,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Decimal\",\r\n\t\t\tvalue: FormatterEnum.Decimal,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Hyperlink\",\r\n\t\t\tvalue: FormatterEnum.Hyperlink,\r\n\t\t\ttype: ColumnFormatterType.HYPERLINK\r\n\t\t}, {\r\n\t\t\tname: \"Integer\",\r\n\t\t\tvalue: FormatterEnum.Integer,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Text Area\",\r\n\t\t\tvalue: FormatterEnum.Textarea,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Time Picker\",\r\n\t\t\tvalue: FormatterEnum.Time,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Button\",\r\n\t\t\tvalue: FormatterEnum.Button,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}, {\r\n\t\t\tname: \"Dropdown\",\r\n\t\t\tvalue: FormatterEnum.Dropdown,\r\n\t\t\ttype: ColumnFormatterType.LIST\r\n\t\t}, {\r\n\t\t\tname: \"Auto-complete\",\r\n\t\t\tvalue: FormatterEnum.Autocomplete,\r\n\t\t\ttype: ColumnFormatterType.LIST\r\n\t\t}, {\r\n\t\t\tname: \"Lookup\",\r\n\t\t\tvalue: FormatterEnum.Lookup,\r\n\t\t\ttype: ColumnFormatterType.LIST\r\n\t\t}, {\r\n\t\t\tname: \"Absolute Value\",\r\n\t\t\tvalue: FormatterEnum.AbsoluteValue,\r\n\t\t\ttype: ColumnFormatterType.BASIC\r\n\t\t}\r\n\t];\r\n\r\n\tprivate component: IEditorComponentWithUpsertDatagridColumnSettings;\r\n\tprivate column: IExtendedDataGridColumn;\r\n\tprivate sourceFields: IAvailableSourceField[];\r\n\tprivate dialog: IDialog<IUpsertOption>;\r\n\r\n\tprivate accordionApiList: IMap<IAccordionApi> = {\r\n\t\t\"accordion-column-field-source\": undefined,\r\n\t\t\"accordion-column-options\": undefined,\r\n\t\t\"accordion-column-formatters\": undefined,\r\n\t\t\"accordion-column-summary-row\": undefined,\r\n\t\t\"accordion-column-substitute\": undefined,\r\n\t};\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<IUpsertOption>,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tfeatureSwitchService: FeatureSwitchService,\r\n\t\tprotected dialogService: DialogService\r\n\t) {\r\n\t\tsuper(featureSwitchService);\r\n\t\tconst dialog: IDialog<IUpsertOption> = $scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tconst parameter: IUpsertOption = dialog.parameter;\r\n\t\tthis.setAvailableDataservices();\r\n\t\tthis.initSourceFields(parameter);\r\n\t\tthis.isAdd = parameter.isAdd;\r\n\r\n\t\tthis.setColumn(parameter.column);\r\n\t\tthis.setSelectedSourceField(this.column.field);\r\n\t\tthis.initSelectedListSource();\r\n\t\tthis.initSelectedSubstitutionSource();\r\n\r\n\t\tthis.component = parameter.component;\r\n\t\tthis.isDataGrid = parameter.component.getTypedef() === Datagrid.name ? true : false;\r\n\t\tthis.column.name = this.column.value ? this.column.value : Helper.htmlDecode(this.column.name);\r\n\r\n\t\t//Init xi-components\r\n\t\tthis.lookupOptions = this.translationManagementService.getLookupOptions();\r\n\t\tthis.autocompleteOptions = this.translationManagementService.getAutoOptions();\r\n\r\n\t\tthis.initAccordionElements($element);\r\n\t}\r\n\r\n\tprivate initSelectedSubstitutionSource(): void {\r\n\t\tif (this.column.substituteOptions) {\r\n\t\t\tif (this.column.substituteOptions.source) {\r\n\t\t\t\tconst selectedSource = this.availableDataservices.find((dataservice) => {\r\n\t\t\t\t\treturn dataservice.id === this.column.substituteOptions.source;\r\n\t\t\t\t});\r\n\t\t\t\t// Data service could be deleted\r\n\t\t\t\tif (selectedSource) {\r\n\t\t\t\t\tthis.selectedSubstituteSource = selectedSource;\r\n\t\t\t\t\tthis.substituteSourceOutputParameters = selectedSource.outputParameters;\r\n\r\n\t\t\t\t\tif (this.column.substituteOptions.from) {\r\n\t\t\t\t\t\tconst selectedParameter = this.selectedSubstituteSource.outputParameters.find((parameter) => {\r\n\t\t\t\t\t\t\treturn parameter.id === this.column.substituteOptions.from;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.selectedFromSubstituteOutput = selectedParameter;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.column.substituteOptions.to) {\r\n\t\t\t\t\t\tconst selectedParameter = this.selectedSubstituteSource.outputParameters.find((parameter) => {\r\n\t\t\t\t\t\t\treturn parameter.id === this.column.substituteOptions.to;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.selectedToSubstituteOutput = selectedParameter;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.selectedSubstituteSource = this.availableDataservices[0];\r\n\t\t\tthis.setSelectedSubstitutionSource();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initSourceFields(parameter: IUpsertOption): void {\r\n\t\tthis.sourceFields = [\r\n\t\t\t{\r\n\t\t\t\tvisibleName: \"Static Value\",\r\n\t\t\t\tsourceKey: ValueObject.STATIC_VALUE,\r\n\t\t\t\tsourceKeyShort: ValueObject.STATIC_VALUE,\r\n\t\t\t\ttype: ValueObject.STATIC_VALUE,\r\n\t\t\t\tcurrentValue: parameter.column.text\r\n\t\t\t}\r\n\t\t];\r\n\t\tthis.sourceFields.push(...parameter.sourceFields);\r\n\t}\r\n\r\n\tprivate setColumn(column: IExtendedDataGridColumn): void {\r\n\t\tthis.column = column;\r\n\r\n\t\t// backward compatbility\r\n\t\tif (Helper.isUndefinedOrNull(this.column.editable)) {\r\n\t\t\tthis.column.editable = false;\r\n\t\t}\r\n\r\n\t\t// backward compatbility\r\n\t\tif (Helper.isUndefinedOrNull(this.column.summaryTextPlacement)) {\r\n\t\t\tthis.column.summaryTextPlacement = SummaryTextPlacement.AFTER;\r\n\t\t}\r\n\r\n\t\t// backward compatbility\r\n\t\tif (Helper.isUndefinedOrNull(this.column.align)) {\r\n\t\t\tthis.column.align = TextAlignment.LEFT;\r\n\t\t}\r\n\r\n\t\t// set column formatters\r\n\t\tconst selectedFormatter = this.columnFormatters.find((formatter) => {\r\n\t\t\treturn formatter.value === this.column.formatterName;\r\n\t\t});\r\n\t\tthis.selectedFormatter = selectedFormatter ? selectedFormatter : this.columnFormatters[0];\r\n\t}\r\n\r\n\tprivate setSelectedSourceField(field: string): void {\r\n\t\tconst result = this.sourceFields.find((sourceField) => {\r\n\t\t\treturn sourceField.sourceKeyShort === field;\r\n\t\t});\r\n\t\tif (result) {\r\n\t\t\tthis.selectedSourceField = result;\r\n\t\t} else if (this.sourceFields.length === 1) {\r\n\t\t\tthis.selectedSourceField = this.sourceFields[0];\r\n\t\t\tthis.column.field = this.sourceFields[0].sourceKeyShort;\r\n\t\t} else if (this.sourceFields.length > 1) {\r\n\t\t\tthis.selectedSourceField = this.sourceFields[1];\r\n\t\t\tthis.column.name = this.sourceFields[1].visibleName;\r\n\t\t\tthis.column.field = this.sourceFields[1].sourceKeyShort;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initSelectedListSource(): void {\r\n\t\tif (this.column.listOptions) {\r\n\t\t\tif (this.column.listOptions.sourceId) {\r\n\t\t\t\tconst selectedSource = this.availableDataservices.find((dataservice) => {\r\n\t\t\t\t\treturn dataservice.id === this.column.listOptions.sourceId;\r\n\t\t\t\t});\r\n\t\t\t\t// Data service could be deleted\r\n\t\t\t\tif (selectedSource) {\r\n\t\t\t\t\tthis.selectedListSource = selectedSource;\r\n\t\t\t\t\tthis.listSourceOutputParameters = selectedSource.outputParameters;\r\n\r\n\t\t\t\t\tif (this.column.listOptions.parameterId) {\r\n\t\t\t\t\t\tconst selectedParameter = this.selectedListSource.outputParameters.find((parameter) => {\r\n\t\t\t\t\t\t\treturn parameter.id === this.column.listOptions.parameterId;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.selectedListOutput = selectedParameter;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetSelectedSubstitutionSource(): void {\r\n\t\tif (this.selectedSubstituteSource) {\r\n\t\t\tthis.substituteSourceOutputParameters = this.selectedSubstituteSource.outputParameters;\r\n\t\t\tthis.selectedFromSubstituteOutput = this.substituteSourceOutputParameters[0];\r\n\t\t\tthis.selectedToSubstituteOutput = this.substituteSourceOutputParameters[0];\r\n\t\t\tthis.updateSubstitute();\r\n\t\t}\r\n\t}\r\n\r\n\tupdateSubstitute(): void {\r\n\t\tthis.column.substituteOptions = {\r\n\t\t\tsource: this.selectedSubstituteSource.id,\r\n\t\t\tfrom: this.selectedFromSubstituteOutput.id,\r\n\t\t\tto: this.selectedToSubstituteOutput.id\r\n\t\t};\r\n\t}\r\n\r\n\ttoggleSubstitution(): void {\r\n\t\tif (!this.column.substitute) {\r\n\t\t\tthis.selectedFormatter = this.columnFormatters[0];\r\n\t\t\tthis.onSelectColumnFormatter();\r\n\t\t\tthis.column.substitute = true;\r\n\t\t\tthis.setSelectedSubstitutionSource();\r\n\t\t} else if (this.column.formatterName !== FormatterEnum.Dropdown) {\r\n\t\t\tthis.column.options = null;\r\n\t\t}\r\n\t}\r\n\r\n\tsetAvailableDataservices(): void {\r\n\t\tconst dataservices =\r\n\t\t\tthis.editorService.getCurrentProject().getDatasourceDatabearers() as IJsonGenericDatasource2[];\r\n\t\tthis.availableDataservices = dataservices.filter((dataservice) => {\r\n\t\t\tif (dataservice.inputParameters) {\r\n\t\t\t\treturn !dataservice.inputParameters.find((inputParameter) => {\r\n\t\t\t\t\treturn inputParameter.required;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\r\n\tsetSelectedListOutput(): void {\r\n\t\tthis.selectedListOutput =\r\n\t\t\tthis.selectedListOutput ? this.selectedListOutput : this.listSourceOutputParameters[0];\r\n\t\tthis.column.listOptions = {\r\n\t\t\tsourceId: this.selectedListSource.id,\r\n\t\t\tparameterId: this.selectedListOutput.id\r\n\t\t};\r\n\t\tthis.component.loadOptions(this.column);\r\n\t}\r\n\r\n\tsetSelectedListSource(): void {\r\n\t\tif (this.selectedListSource) {\r\n\t\t\tthis.listSourceOutputParameters = this.selectedListSource.outputParameters;\r\n\t\t\tthis.column.listOptions = {\r\n\t\t\t\tsourceId: this.selectedListSource.id,\r\n\t\t\t\tparameterId: \"\"\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\topenLinkDialog(): void {\r\n\t\tconst options: IDialogOptions<IBuildLinkParameter> = {\r\n\t\t\ttitle: \"Hyperlink - Build link\",\r\n\t\t\tparameter: {\r\n\t\t\t\tlink: this.column.hyperlinkOptions.value,\r\n\t\t\t\tsources: this.column.hyperlinkOptions.sources,\r\n\t\t\t\tcomponent: this.component\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"../../../editor/component-settings/build-link-dialog/build-link-dialog.html\")\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<IBuildLinkResponse>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.column.hyperlinkOptions.value = result.value.link;\r\n\t\t\t\tthis.column.hyperlinkOptions.sources = result.value.sources;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\topenTranslations(): void {\r\n\t\tthis.translationManagementService\r\n\t\t\t.openTranslations(this.component, this.column.id)\r\n\t\t\t.then((result: IDialogResult<IChanged>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst changes = result.value;\r\n\t\t\t\t\tif (changes.savedComponentStrings.length > 0) {\r\n\t\t\t\t\t\tconst selectedChanged = changes.savedComponentStrings.find((translation) => {\r\n\t\t\t\t\t\t\treturn translation.component === this.component.getId() &&\r\n\t\t\t\t\t\t\t\ttranslation.reference === this.column.id;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (selectedChanged) {\r\n\t\t\t\t\t\t\tthis.column.name = selectedChanged.newValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//If global translations is changed\r\n\t\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, result.value.savedGlobalStrings)) {\r\n\t\t\t\t\tthis.translationManagementService.saveGlobalTranslations(result.value.savedGlobalStrings)\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t//If global translations is deleted\r\n\t\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, result.value.deletedGlobalStrings)) {\r\n\t\t\t\t\tthis.translationManagementService.deleteGlobalTranslations(result.value.deletedGlobalStrings)\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate cleanColumn(column: IExtendedDataGridColumn): void {\r\n\t\tdelete column.formatter;\r\n\t\tdelete column.formatterName;\r\n\t\tdelete column.readonly;\r\n\t}\r\n\r\n\ttoggleSummaryRow(): void {\r\n\t\tDatagridHelper.ToggleSummarizeOnColumn(this.column);\r\n\t}\r\n\r\n\tonSelectColumnFormatter(): void {\r\n\t\tconst formatter = this.selectedFormatter;\r\n\t\tconst column = this.column;\r\n\t\tthis.cleanColumn(column);\r\n\r\n\t\tif (formatter.value !== \"none\") {\r\n\t\t\tcolumn.formatterName = Object.keys(FormatterEnum)\r\n\t\t\t\t.find(item => item.toLowerCase() === formatter.value)\r\n\t\t\t\t.toLowerCase();\r\n\r\n\t\t\tconst locale = this.translationManagementService.getCurrentLanguage();\r\n\t\t\tDatagridHelper.setColumnSettings(column, locale);\r\n\t\t}\r\n\r\n\t\tif (formatter.type === ColumnFormatterType.LIST) {\r\n\t\t\tthis.selectedListSource = this.availableDataservices[0];\r\n\t\t\tthis.setSelectedListSource();\r\n\t\t\tthis.setSelectedListOutput();\r\n\t\t} else {\r\n\t\t\t// Clear list specific properties\r\n\t\t\tthis.selectedListOutput = null;\r\n\t\t\tthis.selectedListSource = null;\r\n\t\t\tif (this.column.listOptions) {\r\n\t\t\t\tthis.column.listOptions.parameterId = null;\r\n\t\t\t\tthis.column.listOptions.sourceId = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (formatter.type === ColumnFormatterType.HYPERLINK) {\r\n\t\t\tconst sources: ISourceItem[] = [];\r\n\t\t\tif (this.column.field && this.column.field !== ValueObject.STATIC_VALUE) {\r\n\t\t\t\tsources.push(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\talias: \"link\",\r\n\t\t\t\t\t\tvalue: this.column.field,\r\n\t\t\t\t\t\ttype: \"<target>\"\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tthis.column.hyperlinkOptions = {\r\n\t\t\t\tvalue: sources.length > 0 ? \"{link}\" : \"https://\",\r\n\t\t\t\tisDrillback: false,\r\n\t\t\t\tsources\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\t//Clear hyperlink options\r\n\t\t\tif (this.column.hyperlinkOptions) {\r\n\t\t\t\tthis.column.hyperlinkOptions.value = null;\r\n\t\t\t\tthis.column.hyperlinkOptions.isDrillback = false;\r\n\t\t\t\tthis.column.hyperlinkOptions.sources = [];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonSelectColumnOption(option: string): void {\r\n\t\tswitch (option.toLowerCase()) {\r\n\t\t\tcase ColumnOptionEnum.Editable:\r\n\t\t\t\tconst locale = this.translationManagementService.getSelectedLocale();\r\n\t\t\t\tDatagridHelper.setEditableOnColumn(this.column, locale);\r\n\t\t\t\tbreak;\r\n\t\t\tcase ColumnOptionEnum.Resizable:\r\n\t\t\tcase ColumnOptionEnum.Sortable:\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tgetColumnOptions(): IMap<boolean> {\r\n\t\tconst supportedOption = (option: string) => {\r\n\t\t\tswitch (option) {\r\n\t\t\t\tcase ColumnOptionEnum.Editable:\r\n\t\t\t\tcase ColumnOptionEnum.Resizable:\r\n\t\t\t\tcase ColumnOptionEnum.Sortable:\r\n\t\t\t\t\treturn true;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t};\r\n\t\tconst result: IMap<boolean> = {};\r\n\r\n\t\tangular.forEach(this.column, (value, key) => {\r\n\t\t\tif (supportedOption(key)) {\r\n\t\t\t\tif (this.isDataGrid) {\r\n\t\t\t\t\tresult[key] = value;\r\n\t\t\t\t} else if (key !== ColumnOptionEnum.Editable) {\r\n\t\t\t\t\tresult[key] = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn Helper.sortObjectKeys(result);\r\n\t}\r\n\r\n\tonFieldSelected(): void {\r\n\t\tconst selectedSourceField = this.selectedSourceField;\r\n\r\n\t\tif (selectedSourceField.type === ValueObject.STATIC_VALUE) {\r\n\t\t\tthis.column.text = selectedSourceField.currentValue;\r\n\t\t} else {\r\n\t\t\tthis.column.text = null;\r\n\t\t\tthis.column.name = selectedSourceField ?\r\n\t\t\t\tselectedSourceField.visibleName.replace(\"(\" + selectedSourceField.sourceKeyShort + \")\", \"\") : \"\";\r\n\t\t}\r\n\t\tthis.column.field = selectedSourceField ? selectedSourceField.sourceKeyShort : null;\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\t//clear possible global string\r\n\t\tdelete this.column.value;\r\n\r\n\t\tconst result: IDialogResult<IExtendedDataGridColumn> = {\r\n\t\t\tvalue: this.column,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\r\n\t\tthis.dialog.close(result);\r\n\t\tthis.component.initializeBindings();\r\n\t}\r\n\r\n\tvalidForm(): boolean {\r\n\t\treturn !Helper.isUndefinedEmpty(this.column.name);\r\n\t}\r\n\r\n\tprivate initAccordionElements($element: ng.IAugmentedJQuery): void {\r\n\t\tthis.$scope.$applyAsync(() => {\r\n\t\t\tconst closeDropdown = () => {\r\n\t\t\t\t$element\r\n\t\t\t\t\t.find(\"#upsert-column-dialog-source-field\")\r\n\t\t\t\t\t.data(\"dropdown\")\r\n\t\t\t\t\t.close();\r\n\t\t\t};\r\n\r\n\t\t\tangular.forEach(this.accordionApiList, (value, key, obj) => {\r\n\t\t\t\tobj[key] = $element\r\n\t\t\t\t\t.find(`#${key}`)\r\n\t\t\t\t\t.accordion()\r\n\t\t\t\t\t.on(\"expand collapse\", closeDropdown) as any;\r\n\t\t\t});\r\n\r\n\t\t\t$(\".modal\").on(\"beforeclose\", () => {\r\n\t\t\t\tangular.forEach(this.accordionApiList, (api => {\r\n\t\t\t\t\tapi.destroy();\r\n\t\t\t\t}));\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirUpsertColumn\", UpsertColumnCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport { InjectNames, Operators } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport { IAvailableSourceField, IDialogBaseScope } from \"../../../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../../common/services/dialog-service\";\r\nimport { ISourceComponent, SourceComponent } from \"../../../defines\";\r\nimport { EditorService } from \"../../../services/editor-service\";\r\nimport { IConditionData } from \"../expression-dialog\";\r\n\r\nimport { Helper } from \"../../../../../common/helper\";\r\n\r\nexport interface IOperator {\r\n\tvalue: string;\r\n\tname: string;\r\n}\r\n\r\nexport class EditExpressionDialogCtrl {\r\n\tselectedExpression: IJsonExpression;\r\n\tavailableSourceFields: IAvailableSourceField[];\r\n\tavailableSources: ISourceComponent[];\r\n\tavailableTargets: ISourceComponent[];\r\n\tavailableTargetFields: IAvailableSourceField[];\r\n\toperators: IOperator[];\r\n\tprivate availableComponents: ISourceComponent[];\r\n\tprivate dialog: IDialog<IConditionData>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<IConditionData>,\r\n\t\tprivate editorService: EditorService\r\n\t) {\r\n\t\tconst dialog: IDialog<IConditionData> = $scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.availableComponents = this.getAvailableComponents();\r\n\t\tthis.setOperators();\r\n\r\n\t\tif (dialog.parameter.expression) {\r\n\t\t\tthis.selectedExpression = angular.copy(dialog.parameter.expression);\r\n\t\t} else {\r\n\t\t\t// Default values for new\r\n\t\t\tthis.selectedExpression = {\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\tclauseOperator: Operators.EQUALS,\r\n\t\t\t\tsource: this.availableComponents[1].id, //Application\r\n\t\t\t\ttarget: this.availableComponents[0].id, //Static\r\n\t\t\t\ttargetProperty: \"\",\r\n\t\t\t\tusedBy: this.editorService.getSelectedComponent().getId(),\r\n\t\t\t\tconditionType: dialog.parameter.expressionType\r\n\t\t\t};\r\n\t\t}\r\n\t\tthis.setAvailableSourceFields();\r\n\t\tthis.setAvailableTargetFields();\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\t// TODO: stop save if static is empty\r\n\t\tconst result: IDialogResult<IJsonExpression> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: this.selectedExpression\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tconst result: IDialogResult<void> = {\r\n\t\t\tbutton: DialogButtonType.Cancel\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tsetOperators(): void {\r\n\t\tthis.operators = [\r\n\t\t\t{\r\n\t\t\t\tname: \"Equals\",\r\n\t\t\t\tvalue: Operators.EQUALS\r\n\t\t\t}, {\r\n\t\t\t\tname: \"Not Equals\",\r\n\t\t\t\tvalue: Operators.NOT_EQUALS\r\n\t\t\t}, {\r\n\t\t\t\tname: \"Greater than\",\r\n\t\t\t\tvalue: Operators.GREATER\r\n\t\t\t}, {\r\n\t\t\t\tname: \"Equals or Greater\",\r\n\t\t\t\tvalue: Operators.SAME_GREATER\r\n\t\t\t}, {\r\n\t\t\t\tname: \"Lower than\",\r\n\t\t\t\tvalue: Operators.LOWER\r\n\t\t\t}, {\r\n\t\t\t\tname: \"Equals or Lower\",\r\n\t\t\t\tvalue: Operators.SAME_LOWER\r\n\t\t\t}, {\r\n\t\t\t\tname: \"Contains In\",\r\n\t\t\t\tvalue: Operators.INCLUDES\r\n\t\t\t}\r\n\t\t];\r\n\t}\r\n\r\n\tgetAvailableComponents(): ISourceComponent[] {\r\n\t\tconst availableSources = [\r\n\t\t\tSourceComponent.STATIC_VALUE_OBJECT\r\n\t\t];\r\n\r\n\t\tconst components = this.editorService.getAllBindableComponents();\r\n\t\tcomponents.forEach((component) => {\r\n\t\t\tavailableSources.push({\r\n\t\t\t\tid: component.getId(),\r\n\t\t\t\tname: component.getDisplayName(),\r\n\t\t\t\tisComponent: true\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn availableSources;\r\n\t}\r\n\r\n\tonSourceFieldChanged(): void {\r\n\t\tthis.setAvailableSourceFields();\r\n\t\tif (this.selectedExpression.source === \"<static>\") {\r\n\t\t\tthis.selectedExpression.sourceProperty = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tonTargetFieldChanged(): void {\r\n\t\tthis.setAvailableTargetFields();\r\n\t\tif (this.selectedExpression.target === \"<static>\") {\r\n\t\t\tthis.selectedExpression.targetProperty = \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setAvailableSourceFields(): void {\r\n\t\tif (this.selectedExpression.source !== \"<static>\") {\r\n\t\t\tconst sourceComponent = this.editorService.getComponentInstanceById(this.selectedExpression.source);\r\n\t\t\tsourceComponent.getBindingMetaData().then((bindings) => {\r\n\t\t\t\tthis.availableSourceFields = bindings;\r\n\t\t\t\tif (this.selectedExpression) {\r\n\t\t\t\t\tthis.selectedExpression.sourceProperty =\r\n\t\t\t\t\tthis.setCurrentBinding(bindings, this.selectedExpression.sourceProperty);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.availableTargets = this.filterSources(this.selectedExpression.source);\r\n\t}\r\n\r\n\tprivate setAvailableTargetFields(): void {\r\n\t\tif (this.selectedExpression.target !== \"<static>\") {\r\n\t\t\tconst targetComponent = this.editorService.getComponentInstanceById(this.selectedExpression.target);\r\n\t\t\ttargetComponent.getBindingMetaData().then((bindings) => {\r\n\t\t\t\tthis.availableTargetFields = bindings;\r\n\t\t\t\tif (this.selectedExpression) {\r\n\t\t\t\t\tthis.selectedExpression.targetProperty =\r\n\t\t\t\t\tthis.setCurrentBinding(bindings, this.selectedExpression.targetProperty);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.availableSources = this.filterSources(this.selectedExpression.target);\r\n\t}\r\n\r\n\tprivate setCurrentBinding(bindings: IAvailableSourceField[], property: string): string {\r\n\t\tconst foundItem = bindings.find((item) => {\r\n\t\t\treturn item.sourceKey === property;\r\n\t\t});\r\n\r\n\t\treturn foundItem ? foundItem.sourceKey : bindings[0].sourceKey;\r\n\t}\r\n\r\n\tprivate filterSources(filter: string): ISourceComponent[] {\r\n\t\treturn angular.copy(this.availableComponents.filter((component) => {\r\n\t\t\treturn component.id !== filter;\r\n\t\t}));\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirEditExpressionDialogCtrl\", EditExpressionDialogCtrl);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirEditExpressionDialogCtrl as ctrl\\\" class=edit-expression-dialog> <div class=field> <label for=source>Source</label> <select id=source class=dropdown ng-model=ctrl.selectedExpression.source ng-change=ctrl.onSourceFieldChanged() ng-options=\\\"availableSource.id as availableSource.name for availableSource in ctrl.availableSources\\\" xi-drop-down> </select> </div> <div class=field ng-show=\\\"ctrl.selectedExpression.source !== '<static>'\\\"> <label for=sourceProperty>Source Property</label> <select id=sourceProperty class=dropdown ng-model=ctrl.selectedExpression.sourceProperty ng-options=\\\"availableBinding.sourceKey as availableBinding.visibleName for availableBinding in ctrl.availableSourceFields\\\" xi-drop-down> </select> </div> <div class=field ng-show=\\\"ctrl.selectedExpression.source === '<static>'\\\"> <label for=sourceStatic>Static Value</label> <input type=text id=sourceStatic class=input ng-model=ctrl.selectedExpression.sourceProperty ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=field> <label for=source>Operator</label> <select id=source class=dropdown ng-model=ctrl.selectedExpression.clauseOperator ng-options=\\\"operator.value as operator.name for operator in ctrl.operators\\\" xi-drop-down> </select> </div> <div class=field> <label for=target>Target</label> <select id=target class=dropdown ng-model=ctrl.selectedExpression.target ng-change=ctrl.onTargetFieldChanged() ng-options=\\\"availableTarget.id as availableTarget.name for availableTarget in ctrl.availableTargets\\\" xi-drop-down> </select> </div> <div class=field ng-show=\\\"ctrl.selectedExpression.target !== '<static>'\\\"> <label for=targetProperty>Target Property</label> <select id=targetProperty class=dropdown ng-model=ctrl.selectedExpression.targetProperty ng-options=\\\"availableBinding.sourceKey as availableBinding.visibleName for availableBinding in ctrl.availableTargetFields\\\" xi-drop-down> </select> </div> <div class=field ng-show=\\\"ctrl.selectedExpression.target === '<static>'\\\"> <label for=targetStatic>Static Value</label> <input type=text id=targetStatic class=input ng-model=ctrl.selectedExpression.targetProperty ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.cancel()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport {\r\n\tABFormScriptMethod,\r\n\tConfig,\r\n\tMGPlatform,\r\n\tProjectLimit,\r\n\tSaveFlagsEnum,\r\n\tServerPaths,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport { IDataGridColumn, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IExportDialogParams } from \"../../../../common/dialogs/export/export-dialog\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport { DialogButtonType, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { IItemSpecificData, ManageDialogBase } from \"./manage-dialog-base\";\r\n\r\nexport class ManageCompositesCtrl extends ManageDialogBase<IJsonCompositeComponent> {\r\n\r\n\tpublic export(): void {\r\n\t\tconst ids: string[] = this.selectedItems.map((item) => {\r\n\t\t\treturn item.manifest.id;\r\n\t\t});\r\n\t\tconst projectId = this.editorService.getCurrentProject().getId();\r\n\t\tconst exportDefaultName = Helper.getFormattedDate();\r\n\r\n\t\tif (Config.MG_PLATFORM === MGPlatform.WEB) {\r\n\t\t\tconst options: IDialogOptions<IExportDialogParams> = {\r\n\t\t\t\ttitle: \"Export Composite Components\",\r\n\t\t\t\ttemplate: require(\"../../../../common/dialogs/export/export-dialog.html\"),\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\ttype: \"composite component\",\r\n\t\t\t\t\tfilename: exportDefaultName,\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst fileName = result.value;\r\n\t\t\t\t\tthis.save().then(() => {\r\n\t\t\t\t\t\tthis.projectService.exportProjectContent(\r\n\t\t\t\t\t\t\tprojectId, ids, fileName, SaveFlagsEnum.COMPOSITE_COMPONENTS);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else { // MG_PLATFORM === WinStudio\r\n\t\t\tWSForm.call({\r\n\t\t\t\tname: ABFormScriptMethod.SHOW_SAVE_FILE_DIALOG,\r\n\t\t\t\tparameters: [\r\n\t\t\t\t\t`${exportDefaultName}.iac`, // Filename\r\n\t\t\t\t\t\"Export Filename\",  // Caption\r\n\t\t\t\t\t\"AppBuilder Composite Component (*.iac)|*.iac\" // Filter\r\n\t\t\t\t],\r\n\t\t\t\tonCompleted: filePath => {\r\n\t\t\t\t\tthis.projectService.exportProjectContent(\r\n\t\t\t\t\t\tprojectId, ids, filePath, SaveFlagsEnum.COMPOSITE_COMPONENTS);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected getItemSpecificData(): IItemSpecificData {\r\n\t\treturn {\r\n\t\t\tdataName: \"Composite component\",\r\n\t\t\tconflictKey: \"manifest.displayName\",\r\n\t\t\turlName: ServerPaths.COMPOSITE_COMPONENTS,\r\n\t\t\tmaxAllowed: ProjectLimit.MAX_COMPOSITE_COMPONENTS,\r\n\t\t\tmaxErrorMessage: ProjectLimit.COMPOSITE_COMPONENT_ERROR_MESSAGE\r\n\t\t};\r\n\t}\r\n\r\n\tprotected getDataList(): IJsonCompositeComponent[] {\r\n\t\treturn this.editorService.getCurrentProject().getCompositeComponents();\r\n\t}\r\n\r\n\tprotected addItemsToProject(composites: IJsonCompositeComponent[]): void {\r\n\t\tcomposites.forEach((composite) => {\r\n\t\t\tthis.editorService.getCurrentProject().addCompositeComponent(composite);\r\n\t\t});\r\n\t}\r\n\r\n\tprotected initGrid(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tcolumns.push({\r\n\t\t\tid: \"selectionCheckbox\",\r\n\t\t\tsortable: false,\r\n\t\t\tresizable: false,\r\n\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\talign: \"center\"\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"displayName\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"manifest.displayName\",\r\n\t\t\twidth: 266,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"author\",\r\n\t\t\tname: \"Author\",\r\n\t\t\tfield: \"manifest.authorDisplayName\",\r\n\t\t\twidth: 240,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"date\",\r\n\t\t\tname: \"Created\",\r\n\t\t\tfield: \"manifest.creationDate\",\r\n\t\t\twidth: 150,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Date\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"datasources\",\r\n\t\t\tname: \"Data Services\",\r\n\t\t\tfield: \"datasources.length\",\r\n\t\t\twidth: 120,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Integer\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"interactions\",\r\n\t\t\tname: \"Interactions\",\r\n\t\t\tfield: \"interactions.length\",\r\n\t\t\twidth: 120,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Integer\r\n\t\t});\r\n\r\n\t\tcolumns.push({\r\n\t\t\tid: \"expressions\",\r\n\t\t\tname: \"Expressions\",\r\n\t\t\tfield: \"expressions.length\",\r\n\t\t\twidth: 120,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Integer\r\n\t\t});\r\n\r\n\t\tconst datagridOptions: IDataGridOptions<IJsonCompositeComponent> = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: SelectableEnum.Multiple,\r\n\t\t\tenableTooltips: true,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Local Composite Components\",\r\n\t\t\t\tresults: false,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tadvancedFilter: false,\r\n\t\t\t\tactions: false,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true,\r\n\t\t\t\tmaxVisibleButtons: 10,\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.datagridOptions = datagridOptions;\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tthis.datagridOptions.dataset = currentProject.getCompositeComponents();\r\n\t}\r\n\r\n\tprotected save(): ng.IPromise<void> {\r\n\t\treturn this.editorService.saveCurrent(SaveFlagsEnum.COMPOSITE_COMPONENTS + SaveFlagsEnum.MANIFEST);\r\n\t}\r\n\r\n\tprotected deleteItems(idsToDelete: string[]): ng.IPromise<IJsonCompositeComponent[]> {\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tconst removedComposites: IJsonCompositeComponent[] = [];\r\n\t\tconst deferred = this.editorService.getNewDeferred<IJsonCompositeComponent[]>();\r\n\t\tidsToDelete.forEach((id) => {\r\n\t\t\tremovedComposites.push(currentProject.removeCompositeComponent(id));\r\n\t\t});\r\n\t\tdeferred.resolve(removedComposites);\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprotected getItemDisplayName(item: IJsonCompositeComponent): string {\r\n\t\treturn item.manifest.displayName;\r\n\t}\r\n\r\n\tprotected getItemId(item: IJsonCompositeComponent): string {\r\n\t\treturn item.manifest.id;\r\n\t}\r\n\r\n\tprotected setItemId(item: IJsonCompositeComponent, newId: string): void {\r\n\t\titem.manifest.id = newId;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirManageCompositesCtrl\", ManageCompositesCtrl);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=manage-dialog ng-controller=\\\"eirManageRepositoryCtrl as ctrl\\\"> <div class=\\\"global-datagrid manage-datagrid\\\"> <div class=toolbar role=toolbar> <div class=title>Global Repository</div> <div class=buttonset> <label class=audible for=searchfield-global>Keyword Search</label> <input id=searchfield-global name=searchfield-global class=searchfield /> </div> </div> <div xi-datagrid=ctrl.repoDatagridOptions id=repository-grid class=datagrid-contained></div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Close</button> <button type=button class=btn-modal ng-click=ctrl.addToProject()>Add To Project</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { Config, MGPlatform, ProjectLimit, SaveFlagsEnum, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport {\r\n\tIJsonDatasource,\r\n\tIJsonGenericDatasource2,\r\n} from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IDataGridColumn, IDataGridOptions, IDataGridRow } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IExportDialogParams } from \"../../../../common/dialogs/export/export-dialog\";\r\nimport { ITestDataserviceParameters, TestDataserviceDialogType } from \"../../../../common/dialogs/test-dataservice/test-dataservice-dialog\";\r\nimport { IComponent } from \"../../../../common/IComponent\";\r\nimport { DialogButtonType, IDialogOptions, IDialogResult, StandardDialogButtons } from \"../../../../common/services/dialog-service\";\r\nimport { CustomFormatters } from \"../../../../common/sohoxi/custom-formatters\";\r\nimport { IDatasourceWizardParameter } from \"../../../repository/datasource/create-wizard/datasource-wizard-ctrl\";\r\nimport { IUpsertDialogParameter } from \"../../../repository/datasource/datasource-tab-ctrl\";\r\nimport type { IEditorComponent } from \"common/interface/ieditor-component\";\r\nimport { IItemSpecificData, ManageDialogBase } from \"./manage-dialog-base\";\r\n\r\nimport { Helper } from \"../../../../common/helper\";\r\n\r\nexport class ManageDatasourcesCtrl extends ManageDialogBase<IJsonDatasource> {\r\n\r\n\tprotected getItemSpecificData(): IItemSpecificData {\r\n\t\treturn {\r\n\t\t\tdataName: \"Data Service\",\r\n\t\t\tconflictKey: \"displayName\",\r\n\t\t\turlName: ServerPaths.DATASOURCES,\r\n\t\t\tmaxAllowed: ProjectLimit.MAX_DATASOURCES,\r\n\t\t\tmaxErrorMessage: ProjectLimit.DATASOURCE_ERROR_MESSAGE\r\n\t\t};\r\n\t}\r\n\r\n\tprotected getDataList(): IJsonDatasource[] {\r\n\t\treturn this.editorService.getCurrentProject().getDatasourceDatabearers();\r\n\t}\r\n\r\n\tprotected addItemsToProject(datasources: IJsonDatasource[]): void {\r\n\t\tdatasources.forEach((datasource) => {\r\n\t\t\tthis.editorService.getCurrentProject().addDatasource(datasource);\r\n\t\t});\r\n\t}\r\n\r\n\tprotected initGrid(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tcolumns.push({\r\n\t\t\tid: \"selectionCheckbox\",\r\n\t\t\twidth: 50,\r\n\t\t\tsortable: false,\r\n\t\t\tresizable: false,\r\n\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\talign: \"center\"\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"displayName\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"displayName\",\r\n\t\t\twidth: 200,\r\n\t\t\tsortable: true,\r\n\t\t\tresizable: false,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"author\",\r\n\t\t\tname: \"Author\",\r\n\t\t\tfield: \"authorDisplayName\",\r\n\t\t\twidth: 150,\r\n\t\t\tsortable: true,\r\n\t\t\tresizable: false,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"date\",\r\n\t\t\tname: \"Created\",\r\n\t\t\tfield: \"creationDate\",\r\n\t\t\twidth: 150,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Date\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"description\",\r\n\t\t\tname: \"Description\",\r\n\t\t\tfield: \"description\",\r\n\t\t\twidth: 200,\r\n\t\t\tsortable: true,\r\n\t\t\tresizable: false,\r\n\t\t\tformatter: CustomFormatters.Multi(CustomFormatters.DataSourceDescription(), Soho.Formatters.Ellipsis)\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"suite\",\r\n\t\t\tname: \"Type\",\r\n\t\t\tfield: \"suite\",\r\n\t\t\twidth: 100,\r\n\t\t\tsortable: true,\r\n\t\t\tresizable: false,\r\n\t\t\tformatter: CustomFormatters.DatasourceSuiteFormatter()\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"action\",\r\n\t\t\tname: \"Action\",\r\n\t\t\tfield: \"\",\r\n\t\t\twidth: 210,\r\n\t\t\tsortable: true,\r\n\t\t\tresizable: false,\r\n\t\t\talign: \"center\",\r\n\t\t\tformatter: Soho.Formatters.Button,\r\n\t\t\tclick: (_: JQueryEventObject , rowsSelected: IDataGridRow<any>[]) => {\r\n\t\t\t\tconst item: IJsonGenericDatasource2 = rowsSelected[0].item;\r\n\t\t\t\tthis.repositoryService.getDatasources()\r\n\t\t\t\t\t.then((datasources) => this.openTestDataserviceDialog(item))\r\n\t\t\t\t\t.catch((error: Error) => this.dialogService.showError(\"Could not test data service\", error.message));\r\n\t\t\t},\r\n\t\t\ttext: \"Test Data Service\",\r\n\t\t});\r\n\r\n\t\tconst datagridOptions: IDataGridOptions<IJsonDatasource> = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: SelectableEnum.Multiple,\r\n\t\t\tenableTooltips: true,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Data Services\",\r\n\t\t\t\tresults: true,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tadvancedFilter: true,\r\n\t\t\t\tactions: true,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.datagridOptions = datagridOptions;\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\t\tthis.datagridOptions.dataset = currentProject.getDatasourceDatabearers();\r\n\t}\r\n\r\n\tpublic openMapper(): void {\r\n\t\tthis.openDataserviceWizard();\r\n\t}\r\n\r\n\tprotected deleteItems(dataserviceIds: string[]): ng.IPromise<IJsonDatasource[]> {\r\n\t\tconst selectedComponent = this.editorService.getSelectedComponent();\r\n\t\tconst currentProject = this.editorService.getCurrentProject();\r\n\r\n\t\treturn this.getDataserviceIdsToRemove(dataserviceIds).then(dataserviceToRemove => {\r\n\t\t\tthis.removeInteractionsConnectedWithDataservice(dataserviceToRemove);\r\n\r\n\t\t\tconst removedDatasources: IJsonDatasource[] = [];\r\n\t\t\tdataserviceToRemove.forEach((idToDelete: string) => {\r\n\t\t\t\tthis.editorService.getCurrentRootComponentInstance().forEachChild((component: IEditorComponent) => {\r\n\t\t\t\t\tif (component.datasource && component.datasource.id === idToDelete) {\r\n\t\t\t\t\t\tcomponent.removeDatasource();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, false);\r\n\t\t\t\tremovedDatasources.push(currentProject.removeDatasource(idToDelete));\r\n\t\t\t});\r\n\t\t\tthis.datagridOptions.dataset = currentProject.getDatasourceDatabearers();\r\n\t\t\tif (selectedComponent.isGenerated) {\r\n\t\t\t\t// Quickfix to solve that the generated are regenerated\r\n\t\t\t\tthis.editorService.deselectComponent();\r\n\t\t\t} else {\r\n\t\t\t\t// To update UI\r\n\t\t\t\tthis.editorService.setSelectedComponent(selectedComponent);\r\n\t\t\t}\r\n\t\t\treturn removedDatasources;\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tprivate removeInteractionsConnectedWithDataservice(selectedDataserviceIds: string[]): void {\r\n\t\tconst interactions = this.editorService.getCurrentProject().getInteractions();\r\n\r\n\t\tselectedDataserviceIds.forEach(dataserviceId => {\r\n\t\t\tconst components = this.getComponentsUsingDataservice(dataserviceId);\r\n\t\t\tcomponents.forEach(component => {\r\n\t\t\t\tinteractions.forEach(interaction => {\r\n\t\t\t\t\tif (interaction.targetName === component.getId()) {\r\n\t\t\t\t\t\tthis.interactionManagementService.removeInteraction(interaction);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getDataserviceIdsToRemove(selectedDataserviceIds: string[]): ng.IPromise<string[]> {\r\n\t\tconst idsToRemove: string[] = [];\r\n\t\tconst promises: ng.IPromise<void>[] = [];\r\n\r\n\t\tfor (let index = 0; selectedDataserviceIds.length > index; index++) {\r\n\t\t\tconst dataserviceId = selectedDataserviceIds[index];\r\n\t\t\tconst componentsUsingDataservice = this.getComponentsUsingDataservice(dataserviceId);\r\n\r\n\t\t\tif (componentsUsingDataservice.length > 0) {\r\n\t\t\t\tconst dataservice = this.editorService\r\n\t\t\t\t\t.getCurrentProject()\r\n\t\t\t\t\t.getDatasources()[dataserviceId];\r\n\t\t\t\tpromises.push(this.promptConfirmWhenDataserviceUsed(\r\n\t\t\t\t\tdataservice,\r\n\t\t\t\t\tcomponentsUsingDataservice.length)\r\n\t\t\t\t\t.then(dialogResult => {\r\n\t\t\t\t\t\tif (dialogResult.button === DialogButtonType.Yes) {\r\n\t\t\t\t\t\t\tidsToRemove.push(dataserviceId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}));\r\n\t\t\t} else {\r\n\t\t\t\tidsToRemove.push(dataserviceId);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// const dataserviceUsed = idsToDelete.find(dataserviceId => selectedComponent.getDatasource().id === dataserviceId);\r\n\t\treturn this.editorService.onAllPromises(promises)\r\n\t\t\t.then(() => idsToRemove);\r\n\t}\r\n\r\n\tprivate getComponentsUsingDataservice(dataserviceId: string): IComponent[] {\r\n\t\treturn this.editorService\r\n\t\t\t.getAllComponents()\r\n\t\t\t.filter(component => component.getDatasource() &&\r\n\t\t\t\tcomponent.getDatasource().id === dataserviceId);\r\n\t}\r\n\r\n\tprivate promptConfirmWhenDataserviceUsed(\r\n\t\tdataservice: IJsonDatasource,\r\n\t\tnumberOfComponentsUsedIn: number\r\n\t): ng.IPromise<IDialogResult<void>> {\r\n\t\treturn this.dialogService.showYesNo(\r\n\t\t\t\"Warning\",\r\n\t\t\t`The data service \"${dataservice.displayName}\"\r\n\t\t\tis used by ${numberOfComponentsUsedIn}\r\n\t\t\tcomponent${numberOfComponentsUsedIn > 1 ? \"s\" : \"\"}.\r\n\t\t\tDo you want to remove it?`,\r\n\t\t\t\"warning-text\");\r\n\t}\r\n\r\n\tprivate openTestDataserviceDialog(\r\n\t\tdataserviceToTest: IJsonDatasource\r\n\t): ng.IPromise<IDialogResult<string>> {\r\n\t\tconst options: IDialogOptions<ITestDataserviceParameters> = {\r\n\t\t\ttitle: \"Test Data Service\",\r\n\t\t\ttemplate: require(\"../../../../common/dialogs/test-dataservice/test-dataservice-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tdataservice: dataserviceToTest as IJsonGenericDatasource2,\r\n\t\t\t\ttype: TestDataserviceDialogType.UNFORMATTED,\r\n\t\t\t},\r\n\t\t};\r\n\t\treturn this.dialogService.show<ITestDataserviceParameters, string>(options);\r\n\t}\r\n\r\n\t// TODO: make shared functon, same functionality in datasource-tab-ctrl.ts\r\n\tprivate openDataserviceWizard(\r\n\t\tdatasource?: IJsonGenericDatasource2): ng.IPromise<IDialogResult<IJsonDatasource>> {\r\n\t\tconst title = (datasource ? \"Edit\" : \"Create\") + \" Data Service\";\r\n\t\tlet template: string = \"<eir-wizard ng-controller='eirDatasourceWizardCtrl as wizardCtrl'></eir-wizard>\";\r\n\t\tif (datasource) {\r\n\t\t\tswitch (datasource.typedef) {\r\n\t\t\t\tcase DatasourceTypeEnum.IDO:\r\n\t\t\t\t\ttemplate = \"<eir-wizard ng-controller='eirLocalIdoDataserviceWizardCtrl as wizardCtrl'></eir-wizard>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase DatasourceTypeEnum.INLINE_LIST:\r\n\t\t\t\t\ttemplate = \"<eir-wizard ng-controller='eirInlineListDataserviceWizardCtrl as wizardCtrl'></eir-wizard>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst options: IDialogOptions<IDatasourceWizardParameter> = {\r\n\t\t\ttitle: title,\r\n\t\t\tparameter: {\r\n\t\t\t\tdatasource: angular.copy(datasource)\r\n\t\t\t},\r\n\t\t\ttemplate,\r\n\t\t\tcssClass: \"wizard-dialog large\",\r\n\t\t\tid: \"datasource-wizard\"\r\n\t\t};\r\n\r\n\t\treturn this.dialogService.show<IDatasourceWizardParameter, IJsonDatasource>(options).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tif (datasource) {\r\n\t\t\t\t\tthis.updateDatasource(result.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.addDatasource(result.value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t});\r\n\t}\r\n\r\n\tpublic createLocalDatasource(isSearch?: boolean): void {\r\n\t\tconst actionTitle = \"Create from Wizard\";\r\n\t\tconst project = this.editorService.getCurrentProject();\r\n\t\tconst options: IDialogOptions<IUpsertDialogParameter> = {\r\n\t\t\ttitle: actionTitle,\r\n\t\t\tparameter: {\r\n\t\t\t\tdatasources: project.getDatasourceDatabearers(),\r\n\t\t\t\tdatasource: null,\r\n\t\t\t\tisEdit: false\r\n\t\t\t},\r\n\t\t\tcssClass: \"select-source-modal\",\r\n\t\t\tid: \"dataservice-search-wizard\"\r\n\t\t};\r\n\t\tif (Helper.exceedAllowed(ProjectLimit.MAX_DATASOURCES, project.getDatasourceDatabearers())) {\r\n\t\t\tthis.dialogService.showError(actionTitle, ProjectLimit.DATASOURCE_ERROR_MESSAGE);\r\n\t\t} else {\r\n\t\t\tif (isSearch) {\r\n\t\t\t\toptions.template = require(\"../../../repository/datasource/create-from-wizard/select-source.html\"),\r\n\t\t\t\tthis.dialogService.show(options)\r\n\t\t\t\t\t.then((result: IDialogResult<IJsonDatasource>) => {\r\n\t\t\t\t\t\tif (result.button === DialogButtonType.Ok && result.value) {\r\n\t\t\t\t\t\t\tthis.addDatasource(result.value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate populateUserInformation(datasource: IJsonDatasource, isNew?: boolean): void {\r\n\t\tif (isNew) {\r\n\t\t\tdatasource.id = Helper.generateUniqueId();\r\n\t\t\tdatasource.author = Config.USER.name;\r\n\t\t\tdatasource.authorDisplayName = Config.USER.displayName;\r\n\t\t\tdatasource.creationDate = Date.now();\r\n\t\t}\r\n\t\tdatasource.changedBy = Config.USER.name;\r\n\t\tdatasource.changedByDisplayName = Config.USER.displayName;\r\n\t\tdatasource.changedDate = Date.now();\r\n\t}\r\n\r\n\t// Add from wizard or BI-create\r\n\tprivate addDatasource(datasource: IJsonDatasource): void {\r\n\t\tthis.populateUserInformation(datasource, true);\r\n\r\n\t\tthis.addItemsToProject([datasource]);\r\n\t\tthis.datagridOptions.dataset.push(datasource);\r\n\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tprivate updateDatasource(datasource: IJsonDatasource): void {\r\n\t\t//The updated datasource should be the selected\r\n\t\tthis.selectedItems[0] = datasource;\r\n\t\tthis.populateUserInformation(datasource);\r\n\t\t// addDatasource will overwrite old one with same id\r\n\t\tthis.addItemsToProject([datasource]);\r\n\t\tthis.editorService.updateDatasourceOnComponents(datasource);\r\n\r\n\t\tconst selectedComponent = this.editorService.getSelectedComponent();\r\n\t\tif (selectedComponent.isGenerated) {\r\n\t\t\t// Quickfix to solve that the generated are regenerated\r\n\t\t\tthis.editorService.deselectComponent();\r\n\t\t} else {\r\n\t\t\t// To update UI\r\n\t\t\tthis.editorService.setSelectedComponent(selectedComponent);\r\n\t\t}\r\n\r\n\t\tthis.save()\r\n\t\t\t.then(() =>\r\n\t\t\t\t// updates affected entries in datagrid\r\n\t\t\t\tthis.datagridOptions.dataset = this.editorService.getCurrentProject().getDatasourceDatabearers());\r\n\t}\r\n\r\n\tpublic export(): void {\r\n\t\tconst ids: string[] = this.selectedItems.map((item) => {\r\n\t\t\treturn item.id;\r\n\t\t});\r\n\t\tconst projectId = this.editorService.getCurrentProject().getId();\r\n\t\tconst exportDefaultName = Helper.getFormattedDate();\r\n\r\n\t\tif (Config.MG_PLATFORM === MGPlatform.WEB) {\r\n\t\t\tconst options: IDialogOptions<IExportDialogParams> = {\r\n\t\t\t\ttitle: \"Export Data Services\",\r\n\t\t\t\ttemplate: require(\"../../../../common/dialogs/export/export-dialog.html\"),\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\ttype: \"dataservice\",\r\n\t\t\t\t\tfilename: exportDefaultName,\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst fileName = result.value;\r\n\t\t\t\t\t// Saving first because the current dataset may not be present on server\r\n\t\t\t\t\tthis.save().then(() => {\r\n\t\t\t\t\t\tthis.projectService.exportProjectContent(\r\n\t\t\t\t\t\t\tprojectId, ids, fileName, SaveFlagsEnum.DATASOURCES);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected save(): ng.IPromise<void> {\r\n\t\treturn this.editorService.saveCurrent(\r\n\t\t\tSaveFlagsEnum.DATASOURCES + SaveFlagsEnum.MANIFEST + SaveFlagsEnum.INTERACTIONS);\r\n\t}\r\n\r\n\tpublic editDatasource(): void {\r\n\t\tconst selectedDatasource: IJsonDatasource = this.selectedItems[0];\r\n\t\tconst project = this.editorService.getCurrentProject();\r\n\t\t// Only accept generic version 2\r\n\t\tconst version: number = 2;\r\n\t\tconst isCorrectVersion = selectedDatasource.version === version;\r\n\t\tconst typedef = selectedDatasource.typedef;\r\n\r\n\t\tif (isCorrectVersion &&\r\n\t\t\t(typedef === DatasourceTypeEnum.generic ||\r\n\t\t\t\ttypedef === DatasourceTypeEnum.IDO ||\r\n\t\t\t\ttypedef === DatasourceTypeEnum.MONGOOSE ||\r\n\t\t\t\ttypedef === DatasourceTypeEnum.INLINE_LIST)\r\n\t\t) {\r\n\t\t\tthis.openDataserviceWizard(selectedDatasource as IJsonGenericDatasource2);\r\n\t\t} else { // Fallback code, should not get here\r\n\t\t\tthis.dialogService.showMessage({\r\n\t\t\t\ttitle: \"Edit unavailable\",\r\n\t\t\t\tmessage:\r\n\t\t\t\t\t\"Edit of old Data Service of this type is not available.\" +\r\n\t\t\t\t\t\"Please recreate your data service in new Data Service wizard.\",\r\n\t\t\t\tstandardButtons: StandardDialogButtons.Ok\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprotected getItemDisplayName(item: IJsonDatasource): string {\r\n\t\treturn item.displayName;\r\n\t}\r\n\r\n\tprotected getItemId(item: IJsonDatasource): string {\r\n\t\treturn item.id;\r\n\t}\r\n\r\n\tprotected setItemId(item: IJsonDatasource, newId: string): void {\r\n\t\titem.id = newId;\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirManageDatasourcesCtrl\", ManageDatasourcesCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../../common/defines\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogResult } from \"../../../../../common/services/dialog-service\";\r\nimport { IRowItem } from \"../../../../../common/sohoxi/datagrid-helper\";\r\nimport { RepositoryService } from \"../../../../repository/repository-service\";\r\n\r\nexport class ManageRepositoryCtrl {\r\n\tprivate dialog: IDialog<IDataGridOptions<IJsonCompositeComponent | IJsonDatasource>>;\r\n\tprivate selectedItems: (IJsonCompositeComponent | IJsonDatasource)[] = [];\r\n\tpublic loading: boolean = false;\r\n\tpublic repoDatagridOptions: IDataGridOptions<IJsonCompositeComponent | IJsonDatasource>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.REPOSITORY_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<IDataGridOptions<IJsonCompositeComponent | IJsonDatasource>>,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate repositoryService: RepositoryService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.repoDatagridOptions = dialog.parameter;\r\n\r\n\t\t// Any cast needed since jQuery only expects one argument on handler\r\n\t\tthis.$element.find(\"#repository-grid\")\r\n\t\t\t.on(\"selected\", (e: any, args: IRowItem<IJsonCompositeComponent | IJsonDatasource>[]) => {\r\n\t\t\t\tif (args.length > 0) {\r\n\t\t\t\t\tthis.selectedItems = args.map((rowObject) => { return rowObject.data; });\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.selectedItems = [];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic close(result?: IDialogResult<(IJsonCompositeComponent | IJsonDatasource)[]>): void {\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic addToProject(): void {\r\n\t\tconst result: IDialogResult<(IJsonCompositeComponent | IJsonDatasource)[]> = {\r\n\t\t\tvalue: this.selectedItems,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirManageRepositoryCtrl\", ManageRepositoryCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\nimport type { IAvailableSourceField, IDialogBaseScope } from \"../../../../common/defines\";\r\nimport type { IJsonTabComponent } from \"../../../../common/model/component/tabs.model\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../../../common/services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"../../../../common/shared-components/base/feature-switch-ctrl\";\r\nimport { TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\nimport { IEditorTabs } from \"../../components/editor-tabs\";\r\nimport { EditorService } from \"../../services/editor-service\";\r\n\r\nimport { IChanged, InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IAutoCompleteOptions } from \"common/model/sohoxi/sohoxi-autocomplete.model\";\r\nimport type { ILookupOptions } from \"common/model/sohoxi/sohoxi-lookup.model\";\r\nimport type { ILanguage } from \"ng2/common/model/language.model\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport interface IEditTabDialogParameter  {\r\n\ttab: IJsonTabComponent;\r\n\tsourceFields: IAvailableSourceField[];\r\n\tcomponent: IEditorTabs;\r\n}\r\n\r\nexport class EditTabCtrl extends FeatureSwitchCtrl {\r\n\tisDeleteDisabled = false;\r\n\tselectedSourceField: IAvailableSourceField;\r\n\tsourceFields: IAvailableSourceField[];\r\n\ttab: IJsonTabComponent;\r\n\tlookupOptions: ILookupOptions;\r\n\tautocompleteOptions: IAutoCompleteOptions;\r\n\r\n\tprivate dialog: IDialog<IEditTabDialogParameter>;\r\n\tprivate component: IEditorTabs;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<IEditTabDialogParameter>,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate editorService: EditorService,\r\n\t\tfeatureSwitchService: FeatureSwitchService,\r\n\t) {\r\n\t\tsuper(featureSwitchService);\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tconst parameter = dialog.parameter;\r\n\t\tconst tab = parameter.tab;\r\n\t\tconst component = parameter.component;\r\n\t\tconst fields = parameter.sourceFields;\r\n\t\tif (tab.field) {\r\n\t\t\tfor (let i = 0; i < fields.length; i++) {\r\n\t\t\t\tif (fields[i].sourceKeyShort === tab.field) {\r\n\t\t\t\t\tthis.selectedSourceField = fields[i];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.sourceFields = fields;\r\n\t\tthis.tab = tab;\r\n\t\tthis.component = component;\r\n\t\tthis.isDeleteDisabled = component.getDatabearer().componentTabs.length === 1;\r\n\r\n\t\t//Init xi-components\r\n\t\tthis.lookupOptions = this.translationManagementService.getLookupOptions();\r\n\t\tthis.autocompleteOptions = this.translationManagementService.getAutoOptions();\r\n\t}\r\n\r\n\topenTranslations(): void {\r\n\t\tthis.translationManagementService.openTranslations(this.component, this.tab.id)\r\n\t\t\t.then((result: IDialogResult<IChanged>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst changes = result.value;\r\n\t\t\t\t\tif (changes.savedComponentStrings.length > 0) {\r\n\t\t\t\t\t\tconst selectedChanged = changes.savedComponentStrings.find((translation) => {\r\n\t\t\t\t\t\t\treturn translation.component === this.component.getId() &&\r\n\t\t\t\t\t\t\t\ttranslation.reference === this.tab.id;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (selectedChanged) {\r\n\t\t\t\t\t\t\tthis.tab.name = selectedChanged.newValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//If global translations is changed\r\n\t\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, result.value.savedGlobalStrings)) {\r\n\t\t\t\t\tthis.translationManagementService.saveGlobalTranslations(result.value.savedGlobalStrings)\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t//If global translations is deleted\r\n\t\t\t\tif (result.button === DialogButtonType.Ok && !angular.equals({}, result.value.deletedGlobalStrings)) {\r\n\t\t\t\t\tthis.translationManagementService.deleteGlobalTranslations(result.value.deletedGlobalStrings)\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tthis.editorService.updateTranslatables();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tonChangeTabName(): void {\r\n\t\tconst currentLanguageKey = this.translationManagementService.getSelectedLocale();\r\n\t\tconst newValue: ILanguage = {\r\n\t\t\tlocale: currentLanguageKey,\r\n\t\t\tvalue: this.tab.name\r\n\t\t};\r\n\t\tthis.translationManagementService.\r\n\t\t\tsetTranslatableStringByProperty(this.component.getId(), this.tab.id, newValue);\r\n\t}\r\n\r\n\tonFieldSelected(): void {\r\n\t\tconst field = this.selectedSourceField;\r\n\t\tthis.tab.name = field ? field.visibleName.replace(\"(\" + field.sourceKeyShort + \")\", \"\") : \"\";\r\n\t\tthis.onChangeTabName();\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\t// set possible global value\r\n\t\tthis.tab.value = this.frameworkService.getGlobalValue(this.tab.name, this.component);\r\n\r\n\t\tthis.tab.field = this.selectedSourceField ? this.selectedSourceField.sourceKeyShort : null;\r\n\t\tconst result: IDialogResult<IJsonTabComponent> = {\r\n\t\t\tvalue: this.tab,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirEditTabCtrl\", EditTabCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { DateFormat, InjectNames, MaskProcess } from \"ng2/common/constants/common.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJSonMaskSettings } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { IValidatorError } from \"../../../../common/shared-components/base/field-validation\";\r\nimport { NotifiableComponent } from \"../../../../common/shared-components/base/notifiable-component\";\r\n\r\nexport class MaskSettingsDialogCtrl extends NotifiableComponent {\r\n\r\n\tpublic AVAILABLE_FORMATS: IDataPair[] = [\r\n\t\t{ name: `${DateFormat.FORMAT_1}`, value: DateFormat.FORMAT_1 },\r\n\t\t{ name: `${DateFormat.FORMAT_2}`, value: DateFormat.FORMAT_2 },\r\n\t\t{ name: `${DateFormat.FORMAT_3}`, value: DateFormat.FORMAT_3 },\r\n\t\t{ name: `${DateFormat.FORMAT_4}`, value: DateFormat.FORMAT_4 },\r\n\t\t{ name: `ISO8601: ${DateFormat.ISO8601}`, value: DateFormat.ISO8601 },\r\n\t\t//{ name: `M3: ${DateFormat.M3}`, value: DateFormat.M3 } TODO: not supported currently in IDS\r\n\t];\r\n\r\n\tpublic maskSetting: string;\r\n\tpublic mask: IJSonMaskSettings;\r\n\tpublic errorList: IValidatorError[] = [];\r\n\tpublic get isPrefixInvalid(): boolean {\r\n\t\treturn this.errorList.length !== 0;\r\n\t}\r\n\tprivate dialog: IDialog<IJSonMaskSettings>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tscope: IDialogBaseScope<IJSonMaskSettings>,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tsuper();\r\n\t\tconst dialog: IDialog<IJSonMaskSettings> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.maskSetting = dialog.parameter.process;\r\n\t\tthis.mask = dialog.parameter;\r\n\t}\r\n\r\n\tpublic onChangeMask(): void {\r\n\t\tif (this.maskSetting === MaskProcess.NUMBER) {\r\n\t\t\tthis.mask = {\r\n\t\t\t\tprocess: this.maskSetting,\r\n\t\t\t\tallowNegative: this.mask.allowNegative,\r\n\t\t\t\tintegerLimit: this.mask.integerLimit,\r\n\t\t\t\tdecimalLimit: this.mask.decimalLimit,\r\n\t\t\t\tallowThousandsSeparator: this.mask.allowThousandsSeparator,\r\n\t\t\t\tprefix: this.mask.prefix\r\n\t\t\t};\r\n\t\t} else if (this.maskSetting === MaskProcess.DATE_TIME || this.maskSetting === MaskProcess.STRING) {\r\n\t\t\tthis.mask = {\r\n\t\t\t\tprocess: this.maskSetting,\r\n\t\t\t\tformat: this.mask.format\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tpublic openMaskHelp(): void {\r\n\t\tlet message: string;\r\n\t\tif (this.maskSetting === MaskProcess.STRING) {\r\n\t\t\t// tslint:disable:max-line-length\r\n\t\t\tmessage =\r\n\t\t\t\t\"Use these characters to create your string masking patterns:<br><br>\" +\r\n\t\t\t\t\"<b>#</b> - (Pound or number symbol) This character allows only numerals, 0 through 9.<br><br>\" +\r\n\t\t\t\t\"<b>x</b> - (Lower case x) This character allows only alphabetic letters, both upper case and lower case.<br><br>\" +\r\n\t\t\t\t\"<b>*</b> - (Asterisk) This character allows both alphabetic and numeric characters.<br><br>\" +\r\n\t\t\t\t\"<b>a</b> - (Lower case a) This character allows only a, A, p, or P. It is used to represent the first letter in a time period designation (AM or PM). <br><br>\" +\r\n\t\t\t\t\"<b>m</b> - (Lower case m) This character allows only m or M. It is used to represent the second letter in a time period designation (AM or PM). \";\r\n\t\t} else if (this.maskSetting === MaskProcess.DATE_TIME) {\r\n\t\t\tmessage =\r\n\t\t\t\t\"A date format can be constructed by assembling the desired date and time format characters;<br> for example: yyyy-MM-DD HH:mm.<br><br>\" +\r\n\t\t\t\t\"When creating a date-time format, these characters can be used as placeholders for input:<br><br>\" +\r\n\t\t\t\t\"<b>MMMM</b> - Displays the full name of the month; for example, August.<br>\" +\r\n\t\t\t\t\"<b>MMM</b> - Displays the abbreviated name of the month; for example, Aug.<br>\" +\r\n\t\t\t\t\"<b>MM</b> - Displays the number of the month, in 2-digit format; for example, 08 (for August).<br>\" +\r\n\t\t\t\t\"<b>M</b> - Displays the number of the month unpadded.<br><br>\" +\r\n\t\t\t\t\"<b>dd</b> - Displays the day/date padded with zeroes.<br>\" +\r\n\t\t\t\t\"<b>d</b> - Displays the day/date unpadded.<br><br>\" +\r\n\t\t\t\t\"<b>yyyy</b> - Displays the year using a 4-digit format. You should always use this format for the year.<br>\" +\r\n\t\t\t\t\"<b>yy</b> - Accepts input for the year using a 2-digit format, but if used, this is converted to the 4-digit format.<br><br>\" +\r\n\t\t\t\t\"<b>hh</b> - Displays the hour using a 12-hour format, with padding.<br>\" +\r\n\t\t\t\t\"<b>h</b> - Displays the hour using a 12-hour format, without padding.<br>\" +\r\n\t\t\t\t\"<b>HH</b> - Displays the hour using a 24-hour format, with padding.<br>\" +\r\n\t\t\t\t\"<b>H</b> - Displays the hour using a 24-hour format, without padding.<br><br>\" +\r\n\t\t\t\t\"<b>a</b> - Displays the am/pm part of the time with the 12-hour format.<br>\" +\r\n\t\t\t\t\"<b>mm</b> - Displays the minute digits.<br><br>\" +\r\n\t\t\t\t\"<b>ss</b> - Displays the seconds digits.<br>\" +\r\n\t\t\t\t\"<b>SSS</b> - Displays the milliseconds digits.<br><br>\" +\r\n\t\t\t\t\"<b>zz</b> - Displays the time zone name in short form, for example, EST, using the language of the current locale.<br>\" +\r\n\t\t\t\t\"<b>zzzz</b> - Displays the time zone name in long form; for example, Eastern Standard Time, using the language of the current locale.<br><br>\" +\r\n\t\t\t\t\"<b>EEEE</b> - Displays the full name of the day; for example: Monday\";\r\n\t\t}\r\n\t\t// tslint:enable:max-line-length\r\n\r\n\t\tconst showOptions = {\r\n\t\t\tmessage: message,\r\n\t\t\ttitle: \"Masking Help\",\r\n\t\t\tcssClass: \"mask-options-help\"\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(showOptions);\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic save(): void {\r\n\t\tconst result: IDialogResult<IJSonMaskSettings> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: this.mask\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirMaskSettingsDialogCtrl\", MaskSettingsDialogCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport {\r\n\tCssConstantKeys,\r\n\tCssConstantValues,\r\n\tIChanged,\r\n\tInjectNames,\r\n\tLanguageConsts,\r\n\tSettingKeys,\r\n\tSubstitutionTags,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IMingleLanguage, IMongooseString } from \"ng2/common/model/language.model\";\r\nimport { IDataGridColumn, IDatagridColumnArgs, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport { IPageRequest } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { Helper } from \"../../../../common/helper\";\r\nimport { IComponent } from \"../../../../common/IComponent\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogResult, IMessageDialogOptions, StandardDialogButtons } from \"../../../../common/services/dialog-service\";\r\nimport { DatagridHelper, IRowItem } from \"../../../../common/sohoxi/datagrid-helper\";\r\nimport { FrameworkService } from \"../../../../components/services/framework-service\";\r\nimport { IComponentProperty, TranslationManagementService } from \"../../../../components/services/translation-management-service\";\r\n\r\nexport interface ITreePosition {\r\n\trow: number;\r\n\tcolumn: number;\r\n}\r\n\r\nexport interface ITranslationDataset {\r\n\tcomponentId: string;\r\n\treference: string;\r\n\tlocale: string;\r\n\tdisplayName: string;\r\n\tvalue: string;\r\n}\r\n\r\nexport interface ILanguageDataset {\r\n\tid: string;\r\n\tcomponent: {\r\n\t\tid: string,\r\n\t\tdisplayName: string\r\n\t};\r\n\tproperty: {\r\n\t\tref: string,\r\n\t\tdisplayName: string\r\n\t};\r\n\texpanded: boolean;\r\n\tchildren: ITranslationDataset[];\r\n}\r\n\r\nexport enum TranslationTabEnum { COMPONENT, GLOBAL }\r\n\r\nexport class TranslationDialogCtrl {\r\n\tpublic componentDatagridOptions: IDataGridOptions<ILanguageDataset>;\r\n\tpublic globalDatagridOptions: IDataGridOptions<{}>;\r\n\tpublic supportedLanguages: IMingleLanguage[] = [];\r\n\tpublic usedLanguages: IMingleLanguage[] = [];\r\n\tpublic currentLanguageDisplayName: string;\r\n\tpublic tabEnum = TranslationTabEnum;\r\n\tpublic currentTab: TranslationTabEnum = TranslationTabEnum.COMPONENT;\r\n\tpublic selectedGlobalString: IMongooseString;\r\n\tprivate dialog: IDialog<{}>;\r\n\tprivate dataset: ILanguageDataset[] = [];\r\n\tprivate deletedLanguages: IMingleLanguage[] = [];\r\n\tprivate addedLanguages: IMingleLanguage[] = [];\r\n\tprivate isChanged: IChanged = {\r\n\t\tsavedComponentStrings: [],\r\n\t\tsavedGlobalStrings: {},\r\n\t\tdeletedGlobalStrings: {}\r\n\t};\r\n\tprivate invalidPositions: ITreePosition[] = [];\r\n\tprivate validPositions: ITreePosition[] = [];\r\n\tprivate selectedComponent: IComponent;\r\n\tprivate originalComponent: IComponent;\r\n\tprivate selectedProperty: string;\r\n\tprivate currentLocale: string;\r\n\tprivate selectedFilterLanguage: string = \"All\";\r\n\tprivate selectedGlobalLocale: string;\r\n\tprivate globalDataset: IMongooseString[];\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate scope: IDialogBaseScope<IComponentProperty>,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.selectedComponent = this.originalComponent = dialog.parameter.component;\r\n\t\tthis.selectedProperty = dialog.parameter.property;\r\n\t\tthis.buildDataset();\r\n\t\tthis.initComponentGridOptions();\r\n\r\n\t\tthis.buildGlobalDataset();\r\n\t\tthis.initGlobalGridOptions();\r\n\t\tthis.usedLanguages = this.translationManagementService.getProjectLanguages();\r\n\t\tthis.supportedLanguages = this.translationManagementService.getSupportedLanguages();\r\n\r\n\t\tthis.selectedGlobalLocale = this.currentLocale = this.translationManagementService.getCurrentLanguage();\r\n\t\tthis.currentLanguageDisplayName = this.translationManagementService.getLocaleDisplayName(this.currentLocale);\r\n\r\n\t\tthis.updateDataset(); //component vs all\r\n\t}\r\n\r\n\tpublic onChangeTab(tab: TranslationTabEnum): void {\r\n\t\tthis.currentTab = tab;\r\n\t}\r\n\r\n\tpublic save(): void {\r\n\t\tthis.saveToProject();\r\n\t\tconst result: IDialogResult<IChanged> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: this.isChanged\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close({\r\n\t\t\tbutton: DialogButtonType.Cancel\r\n\t\t});\r\n\t}\r\n\r\n\tpublic openLanguage(language: IMingleLanguage): void {\r\n\t\tthis.translationManagementService.fetchGlobalStrings(language.key).then((globalStrings) => {\r\n\t\t\tthis.selectedGlobalLocale = language.key;\r\n\r\n\t\t\tconst stringList = [];\r\n\t\t\tfor (const key in globalStrings) {\r\n\t\t\t\tif (globalStrings.hasOwnProperty(key) && typeof globalStrings[key] !== \"string\") {\r\n\t\t\t\t\tstringList.push(globalStrings[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.reloadGlobalStringDatagrid(stringList);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic toggleAllTranslations(): void {\r\n\t\tif (!this.selectedComponent) {\r\n\t\t\tthis.selectedComponent = this.originalComponent;\r\n\t\t} else {\r\n\t\t\tthis.selectedComponent = null;\r\n\t\t}\r\n\t\tthis.reloadComponentDatagrid();\r\n\t}\r\n\r\n\tpublic filterLanguage(localeKey: string): void {\r\n\t\tif (localeKey !== this.selectedFilterLanguage) {\r\n\t\t\tif (this.selectedFilterLanguage === localeKey) {\r\n\t\t\t\tthis.selectedFilterLanguage = \"All\";\r\n\t\t\t} else {\r\n\t\t\t\tthis.selectedFilterLanguage = localeKey;\r\n\t\t\t}\r\n\t\t\tthis.reloadComponentDatagrid();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addLanguage(language: IMingleLanguage): void {\r\n\t\tconst languageExists = this.usedLanguages.some((usedLanguage) => {\r\n\t\t\treturn usedLanguage.key === language.key;\r\n\t\t});\r\n\t\tif (!languageExists) {\r\n\t\t\tif (!this.translationManagementService.projectHasLanguage(language.key)) {\r\n\t\t\t\tthis.updateLanguageLists(language, this.addedLanguages, this.deletedLanguages);\r\n\t\t\t} else {//if in project delete only from added-list\r\n\t\t\t\tthis.deletedLanguages = this.deletedLanguages.filter((deletedLanguage) => {\r\n\t\t\t\t\treturn language.key !== deletedLanguage.key;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.usedLanguages.push(language);\r\n\t\t\tthis.dataset.forEach((data) => {\r\n\t\t\t\tdata.expanded = this.isExpanded(data.id);\r\n\t\t\t\tconst value = data.children[0].value; // set default value\r\n\t\t\t\tdata.children.push({\r\n\t\t\t\t\tcomponentId: data.component.id,\r\n\t\t\t\t\treference: data.property.ref,\r\n\t\t\t\t\tlocale: language.key,\r\n\t\t\t\t\tdisplayName: language.value,\r\n\t\t\t\t\tvalue: value\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tthis.updateDataset();\r\n\t\t} else {\r\n\t\t\tthis.dialogService.showError(\"Add Language\", \"Language already exists.\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addNewString(): void {\r\n\t\tthis.translationManagementService.openNewStringDialog().then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tconst newString = result.value as IMongooseString;\r\n\t\t\t\tlet alreadyAddedItem = null;\r\n\t\t\t\tif (this.isChanged.savedGlobalStrings.hasOwnProperty(this.selectedGlobalLocale)) {\r\n\t\t\t\t\talreadyAddedItem = this.isChanged.savedGlobalStrings[this.selectedGlobalLocale].find((item) => {\r\n\t\t\t\t\t\treturn item.Name === newString.Name;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!alreadyAddedItem) {\r\n\t\t\t\t\tthis.globalDataset.unshift(result.value);\r\n\t\t\t\t\tthis.globalDatagridOptions.dataset = this.globalDataset;\r\n\t\t\t\t\tthis.saveString(newString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.dialogService.showError(\"Add String\", \"String already added\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic deleteGlobalString(): void {\r\n\t\tconst deletedString = this.selectedGlobalString;\r\n\t\tconst language = this.translationManagementService.getLocaleDisplayName(this.selectedGlobalLocale);\r\n\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: \"Delete \" + this.selectedGlobalString.Name,\r\n\t\t\tmessage:\r\n\t\t\t\t`Are you sure you want to delete this string on language \"${language}\"?`,\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(options).then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\tconst deletedStrings = this.isChanged.deletedGlobalStrings[this.selectedGlobalLocale];\r\n\t\t\t\tif (deletedStrings) {\r\n\t\t\t\t\tconst existingIndex = deletedStrings.findIndex((stringItem) => {\r\n\t\t\t\t\t\treturn stringItem.Name === deletedString.Name;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (existingIndex === -1) {\r\n\t\t\t\t\t\tdeletedStrings.push(deletedString);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdeletedStrings[existingIndex] = deletedString;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.isChanged.deletedGlobalStrings[this.selectedGlobalLocale] = [deletedString];\r\n\t\t\t\t}\r\n\t\t\t\tthis.deleteStringFromDataset(deletedString.Name);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic deleteLanguage(language: IMingleLanguage): void {\r\n\t\tif (language.key !== LanguageConsts.DEFAULT.key) {\r\n\t\t\tif (this.translationManagementService.projectHasLanguage(language.key)) {\r\n\t\t\t\tthis.updateLanguageLists(language, this.deletedLanguages, this.addedLanguages);\r\n\t\t\t} else { //if not in project delete only from added-list\r\n\t\t\t\tthis.addedLanguages = this.addedLanguages.filter((addedLanguage) => {\r\n\t\t\t\t\treturn language.key !== addedLanguage.key;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.usedLanguages = this.usedLanguages.filter((usedLanguage) => {\r\n\t\t\t\treturn usedLanguage.key !== language.key;\r\n\t\t\t});\r\n\t\t\tthis.dataset.forEach((data, datasetIndex) => {\r\n\t\t\t\tdata.expanded = this.isExpanded(data.id);\r\n\t\t\t\tconst translations = data.children;\r\n\t\t\t\tfor (let i = 0; i < translations.length; i++) {\r\n\t\t\t\t\tif (this.translationManagementService.localeEquals(translations[i].locale, language.key)) {\r\n\t\t\t\t\t\ttranslations.splice(i, 1);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.updateDataset();\r\n\t\t} else {\r\n\t\t\tthis.dialogService.showError(\"Delete Language\", \"Can not delete Language: \" + LanguageConsts.DEFAULT.value);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isExpanded(id: string): boolean {\r\n\t\tlet expanded = false;\r\n\t\tconst component = this.componentDatagridOptions.dataset.find((languageComponent) => {\r\n\t\t\treturn languageComponent.id === id;\r\n\t\t});\r\n\t\tif (component) {\r\n\t\t\texpanded = component.expanded;\r\n\t\t}\r\n\r\n\t\treturn expanded;\r\n\t}\r\n\r\n\tprivate reloadComponentDatagrid(): void {\r\n\t\tthis.componentDatagridOptions = null;\r\n\t\tthis.initComponentGridOptions();\r\n\t\tthis.updateDataset();\r\n\t\tthis.$element.find(\"#component-tab\").find(\".datagrid-container\")\r\n\t\t\t.data(\"datagrid\").updateColumns(this.componentDatagridOptions.columns);\r\n\t}\r\n\r\n\tprivate updateDataset(): void {\r\n\t\tlet filteredDataset = angular.copy(this.dataset);\r\n\t\tif (this.selectedComponent) {\r\n\t\t\tfilteredDataset = filteredDataset.filter((languageComponent) => {\r\n\t\t\t\treturn languageComponent.component.id === this.selectedComponent.getId();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfor (let i = 0; i < filteredDataset.length; i++) {\r\n\t\t\tfilteredDataset[i].children = filteredDataset[i].children.filter((child) => {\r\n\t\t\t\treturn this.usedLanguages.find((usedLanguage) => {\r\n\t\t\t\t\treturn usedLanguage.key === child.locale;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.filterDatasetOnLocale(filteredDataset);\r\n\t}\r\n\r\n\tprivate filterDatasetOnLocale(dataset: ILanguageDataset[] = this.dataset): void {\r\n\t\tconst filteredDataset = angular.copy(dataset);\r\n\t\tif (this.selectedFilterLanguage !== \"All\" && filteredDataset[0].children.length > 0) {\r\n\t\t\tfor (let i = 0; i < filteredDataset.length; i++) {\r\n\t\t\t\tfilteredDataset[i].children = filteredDataset[i].children.filter((child) => {\r\n\t\t\t\t\treturn child.locale === this.selectedFilterLanguage;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.componentDatagridOptions.dataset = filteredDataset;\r\n\t}\r\n\r\n\tprivate deleteStringFromDataset(stringName: string): void {\r\n\t\tconst index = this.globalDataset.findIndex((stringItem) => {\r\n\t\t\treturn stringItem.Name === stringName;\r\n\t\t});\r\n\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.globalDataset.splice(index, 1);\r\n\t\t\tthis.selectedGlobalString = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate reloadGlobalStringDatagrid(globalStrings: IMongooseString[]): void {\r\n\t\tthis.globalDataset = globalStrings;\r\n\t\tthis.initGlobalGridOptions();\r\n\t\tthis.$element.find(\"#global-language-grid\").data(\"datagrid\").updated();\r\n\t}\r\n\r\n\tprivate saveString(modifiedString: IMongooseString): void {\r\n\t\tconst modifiedStrings = this.isChanged.savedGlobalStrings[this.selectedGlobalLocale];\r\n\t\tif (modifiedStrings) {\r\n\t\t\tconst existingIndex = modifiedStrings.findIndex((stringItem) => {\r\n\t\t\t\treturn stringItem.Name === modifiedString.Name;\r\n\t\t\t});\r\n\t\t\tif (existingIndex === -1) {\r\n\t\t\t\tmodifiedStrings.push(modifiedString);\r\n\t\t\t} else {\r\n\t\t\t\tmodifiedStrings[existingIndex] = modifiedString;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.isChanged.savedGlobalStrings[this.selectedGlobalLocale] = [modifiedString];\r\n\t\t}\r\n\t}\r\n\r\n\tprivate buildGlobalDataset(): void {\r\n\t\tthis.globalDataset = angular.copy(this.translationManagementService.getCurrentStringsList());\r\n\t}\r\n\r\n\tprivate buildDataset(): void {\r\n\t\tconst newDataset: ILanguageDataset[] = [];\r\n\t\tconst languageComponents = this.frameworkService.getCurrentProject().getTranslationsList();\r\n\t\tlanguageComponents.forEach((languageComponent, componentIndex) => {\r\n\t\t\tconst componentInstance = this.frameworkService.getComponentInstance(languageComponent.componentId);\r\n\r\n\t\t\tif (componentInstance) {\r\n\t\t\t\tlet isExpanded = false;\r\n\t\t\t\tconst datasetComponent = this.dataset[componentIndex];\r\n\t\t\t\tif (datasetComponent) {\r\n\t\t\t\t\tisExpanded = this.dataset[componentIndex].expanded;\r\n\t\t\t\t} else if (this.originalComponent) {\r\n\t\t\t\t\tif (languageComponent.componentId === this.originalComponent.getId() &&\r\n\t\t\t\t\tlanguageComponent.property === this.selectedProperty) {\r\n\t\t\t\t\t\tisExpanded = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (languageComponent.property === this.selectedProperty) {\r\n\t\t\t\t\tisExpanded = true;\r\n\t\t\t\t}\r\n\t\t\t\tconst componentId = languageComponent.componentId;\r\n\t\t\t\tconst property = languageComponent.property;\r\n\t\t\t\tlet componentName = Helper.htmlEncode(componentInstance.getDisplayName());\r\n\t\t\t\tlet propertyName = this.frameworkService.getTranslatableFieldDisplayName(componentId, property);\r\n\t\t\t\tif (property === SettingKeys.APPLICATION_HEADER) {\r\n\t\t\t\t\t// TODO: remove when header is component\r\n\t\t\t\t\tcomponentName = \"Application Header\";\r\n\t\t\t\t\tpropertyName = \"Content\";\r\n\t\t\t\t}\r\n\t\t\t\tconst datasetLanguage: ILanguageDataset = {\r\n\t\t\t\t\tid: languageComponent.id,\r\n\t\t\t\t\tcomponent: {\r\n\t\t\t\t\t\tdisplayName: componentName,\r\n\t\t\t\t\t\tid: componentId\r\n\t\t\t\t\t},\r\n\t\t\t\t\tproperty: {\r\n\t\t\t\t\t\tref: languageComponent.property,\r\n\t\t\t\t\t\tdisplayName: propertyName\r\n\t\t\t\t\t},\r\n\t\t\t\t\tchildren: [],\r\n\t\t\t\t\texpanded: isExpanded\r\n\t\t\t\t};\r\n\t\t\t\tlanguageComponent.translations.forEach((translation, translationIndex) => {\r\n\t\t\t\t\tif (translation.locale === this.selectedFilterLanguage || this.selectedFilterLanguage === \"All\") {\r\n\t\t\t\t\t\tlet value: string;\r\n\t\t\t\t\t\tconst childExists = datasetComponent && datasetComponent.children[translationIndex];\r\n\t\t\t\t\t\tif (childExists) {\r\n\t\t\t\t\t\t\tvalue = datasetComponent.children[translationIndex].value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdatasetLanguage.children.push({\r\n\t\t\t\t\t\t\tcomponentId: componentId,\r\n\t\t\t\t\t\t\treference: property,\r\n\t\t\t\t\t\t\tdisplayName: this.translationManagementService.getLocaleDisplayName(translation.locale),\r\n\t\t\t\t\t\t\tlocale: translation.locale,\r\n\t\t\t\t\t\t\tvalue: value ? value : translation.value\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tnewDataset.push(datasetLanguage);\r\n\t\t\t} else {\r\n\t\t\t\t// Out of sync, delete corrupt translation.\r\n\t\t\t\t// Should not happen.\r\n\t\t\t\tthis.translationManagementService.removeTranslation(languageComponent.componentId);\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t\tthis.dataset = newDataset;\r\n\t}\r\n\r\n\t/*\r\n\t* This method handle the binding and checks if it has substitutiontags before\r\n\t* it is edited. Saving locally to list of valids and invalids determine if you can\r\n\t* save or not.\r\n\t*/\r\n\tprivate validate(args: IDatagridColumnArgs<ITranslationDataset>): void {\r\n\t\tconst cellElement = args.target[0];\r\n\t\tconst position: ITreePosition = { row: args.row, column: args.cell };\r\n\t\tconst tagExistsOld = args.rowData.value.indexOf(SubstitutionTags.VALUE) !== -1;\r\n\t\tconst tagExistsNew = args.value.indexOf(SubstitutionTags.VALUE) !== -1;\r\n\t\tconst isInvalid = this.existsInArray(position, this.invalidPositions);\r\n\t\tconst isValid = this.existsInArray(position, this.validPositions);\r\n\r\n\t\tif (tagExistsOld || isInvalid) {\r\n\t\t\tif (!tagExistsNew && !isValid) {\r\n\t\t\t\tthis.invalidPositions.push(position);\r\n\t\t\t\tcellElement.classList.add(\"error\");\r\n\t\t\t\tcellElement.setAttribute(\"data-errormessage\", \"Required\");\r\n\t\t\t} else if (tagExistsNew) {\r\n\t\t\t\tconst updatedInvalids = this.invalidPositions.filter((position) => {\r\n\t\t\t\t\treturn position.row !== args.row && position.column !== args.cell;\r\n\t\t\t\t});\r\n\t\t\t\tthis.invalidPositions = updatedInvalids;\r\n\t\t\t\tcellElement.classList.remove(\"error\");\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.validPositions.push(position);\r\n\t\t}\r\n\t\tthis.updateSaveButton();\r\n\t}\r\n\r\n\tprivate existsInArray(position: ITreePosition, array: ITreePosition[]): boolean {\r\n\t\treturn array.some((invalidPosition, index) => {\r\n\t\t\treturn invalidPosition.row === position.row && invalidPosition.column === position.column;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateSaveButton(): void {\r\n\t\t// FIXME: ng-disable does not work so it had to be like this\r\n\t\t// some issue with calling this inside a element.on() ?\r\n\t\tconst saveButtonElement = angular.element(\".translation-save\");\r\n\t\tconst errorTextElement = this.$element.find(\".error-text\");\r\n\t\tif (this.invalidPositions.length > 0) {\r\n\t\t\tsaveButtonElement.prop(\"disabled\", true);\r\n\t\t\terrorTextElement.css(CssConstantKeys.DISPLAY, CssConstantValues.INLINE_BLOCK);\r\n\t\t} else {\r\n\t\t\tsaveButtonElement.prop(\"disabled\", false);\r\n\t\t\terrorTextElement.css(CssConstantKeys.DISPLAY, CssConstantValues.NONE);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateLanguageLists(\r\n\t\tupdatedLanguage: IMingleLanguage,\r\n\t\tfirstLanguageList: IMingleLanguage[],\r\n\t\tsecondLanguageList: IMingleLanguage[]\r\n\t): void {\r\n\t\tconst languageExistsInList = firstLanguageList.some((language) => {\r\n\t\t\treturn language.key === updatedLanguage.key;\r\n\t\t});\r\n\t\tif (!languageExistsInList) {\r\n\t\t\tfirstLanguageList.push(updatedLanguage);\r\n\t\t\tsecondLanguageList = secondLanguageList.filter((language) => {\r\n\t\t\t\treturn language.key !== updatedLanguage.key;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate saveToProject(): void {\r\n\t\tif (this.addedLanguages.length > 0) {\r\n\t\t\tthis.addedLanguages.forEach((language) => {\r\n\t\t\t\tthis.translationManagementService.addLanguage(language);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (this.deletedLanguages.length > 0) {\r\n\t\t\tthis.deletedLanguages.forEach((language) => {\r\n\t\t\t\tthis.translationManagementService.deleteLanguage(language);\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.dataset.forEach((data, componentIndex) => {\r\n\t\t\tdata.children.forEach((translation, translationIndex) => {\r\n\t\t\t\tthis.translationManagementService.setTranslatableStringByTranslationIndex(\r\n\t\t\t\t\tcomponentIndex,\r\n\t\t\t\t\ttranslationIndex,\r\n\t\t\t\t\ttranslation.value\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initGlobalGridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Name\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"Name\",\r\n\t\t\twidth: \"50%\",\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Value\",\r\n\t\t\tname: \"Value\",\r\n\t\t\tfield: \"Value\",\r\n\t\t\twidth: \"50%\",\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\teditor: Soho.Editors.Input,\r\n\t\t\tisEditable: () => {\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\r\n\t\tthis.globalDatagridOptions = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [],\r\n\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\teditable: true,\r\n\t\t\tisList: true,\r\n\t\t\tpaging: true,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Translations\",\r\n\t\t\t\tkeywordFilter: true\r\n\t\t\t},\r\n\t\t\tsource: (req: IPageRequest, response: Function) => {\r\n\t\t\t\treq.total = this.globalDataset.length;\r\n\t\t\t\tlet datasetCopy = angular.copy(this.globalDataset);\r\n\t\t\t\tif (req.filterExpr && req.filterExpr[0]) {\r\n\t\t\t\t\tdatasetCopy = DatagridHelper.getSearchResultOnPaths(datasetCopy, req.filterExpr[0], \"Name\");\r\n\t\t\t\t}\r\n\t\t\t\tconst page = DatagridHelper.getPage(datasetCopy, req);\r\n\t\t\t\tresponse(page, req);\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tthis.$element.find(\"#global-language-grid\").on(\"selected\",\r\n\t\t\t(e: JQueryEventObject, args: IRowItem<IMongooseString>[]) => {\r\n\t\t\t\tif (args.length > 0) {\r\n\t\t\t\t\tthis.scope.$evalAsync(() => {\r\n\t\t\t\t\t\tthis.selectedGlobalString = {\r\n\t\t\t\t\t\t\tName: args[0].data.Name,\r\n\t\t\t\t\t\t\tValue: args[0].data.Value\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tthis.$element.find(\"#global-language-grid\").on(\"cellchange\",\r\n\t\t\t(e: JQueryEventObject, args: IDatagridColumnArgs<IMongooseString>) => {\r\n\t\t\t\tconst hasNewValue = args.value !== args.oldValue;\r\n\t\t\t\tif (hasNewValue && args.oldValue !== undefined) {\r\n\t\t\t\t\tconst modifiedString: IMongooseString = {\r\n\t\t\t\t\t\tName: args.rowData.Name,\r\n\t\t\t\t\t\tValue: args.rowData.Value,\r\n\t\t\t\t\t\tScopeInfo: {\r\n\t\t\t\t\t\t\tScopeType: args.rowData.ScopeInfo ? args.rowData.ScopeInfo.ScopeType : null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.saveString(modifiedString);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tprivate initComponentGridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tif (!this.selectedComponent) {\r\n\t\t\tcolumns.push({\r\n\t\t\t\tid: \"component\",\r\n\t\t\t\tname: \"Component\",\r\n\t\t\t\tfield: \"component.displayName\",\r\n\t\t\t\twidth: \"25%\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Tree\r\n\t\t\t});\r\n\t\t}\r\n\t\tcolumns.push({\r\n\t\t\tid: \"property\",\r\n\t\t\tname: \"Property\",\r\n\t\t\tfield: \"property.displayName\",\r\n\t\t\twidth: \"25%\",\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: this.selectedComponent ? Soho.Formatters.Tree : Soho.Formatters.Ellipsis\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"id\",\r\n\t\t\tname: \"Id\",\r\n\t\t\tfield: \"id\",\r\n\t\t\thidden: true\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"name\",\r\n\t\t\tname: \"Language\",\r\n\t\t\tfield: \"displayName\",\r\n\t\t\twidth: \"25%\",\r\n\t\t\tsortable: true,\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"value\",\r\n\t\t\tname: \"Translation\",\r\n\t\t\tfield: \"value\",\r\n\t\t\twidth: \"25%\",\r\n\t\t\tsortable: true,\r\n\t\t\teditor: Soho.Editors.Input,\r\n\t\t\tisEditable: () => {\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\r\n\t\tthis.componentDatagridOptions = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [],\r\n\t\t\ttreeGrid: true,\r\n\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\teditable: true,\r\n\t\t\tisList: true,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Translations\",\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tresults: true,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tadvancedFilter: true,\r\n\t\t\t\tactions: true,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.$element.find(\"#component-language-grid\").on(\"cellchange\",\r\n\t\t\t(_, args: IDatagridColumnArgs<ITranslationDataset>) => {\r\n\t\t\t\tconst hasNewValue = args.value !== args.oldValue;\r\n\t\t\t\tif (hasNewValue && args.rowData.value !== undefined) {\r\n\t\t\t\t\tthis.validate(args);\r\n\t\t\t\t\tthis.syncDataset(args);\r\n\t\t\t\t\tconst currentLocale = this.translationManagementService.getCurrentLanguage();\r\n\t\t\t\t\tif (this.translationManagementService.localeEquals(currentLocale, args.rowData.locale)) {\r\n\t\t\t\t\t\tthis.updateTranslationChange(args);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate syncDataset(item: IDatagridColumnArgs<ITranslationDataset>): void {\r\n\t\tfor (let i = 0; i < this.dataset.length; i++) {\r\n\t\t\tconst correctComponent = this.dataset[i].component.id === item.rowData.componentId;\r\n\t\t\tconst correctProperty = this.dataset[i].property.ref === item.rowData.reference;\r\n\t\t\tif (correctComponent && correctProperty) {\r\n\t\t\t\tfor (let j = 0; j < this.dataset[i].children.length; j++) {\r\n\t\t\t\t\tconst correctLocale = this.dataset[i].children[j].locale === item.rowData.locale;\r\n\t\t\t\t\tif (correctLocale) {\r\n\t\t\t\t\t\tthis.dataset[i].children[j].value = item.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateTranslationChange(datagridArgs: IDatagridColumnArgs<ITranslationDataset>): void {\r\n\t\tconst componentId = datagridArgs.rowData.componentId;\r\n\t\tconst ref = datagridArgs.rowData.reference;\r\n\t\tconst newValue = datagridArgs.value;\r\n\t\tconst existingValue = this.isChanged.savedComponentStrings.find((value) => {\r\n\t\t\treturn value.component === componentId && value.reference === ref;\r\n\t\t});\r\n\t\tif (!existingValue) {\r\n\t\t\tthis.isChanged.savedComponentStrings.push({\r\n\t\t\t\tcomponent: componentId,\r\n\t\t\t\treference: ref,\r\n\t\t\t\tnewValue: newValue\r\n\t\t\t});\r\n\r\n\t\t} else if (existingValue.newValue !== newValue) {\r\n\t\t\texistingValue.newValue = newValue;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirTranslationDialogCtrl\", TranslationDialogCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { InjectNames, SaveFlagsEnum, SettingKeys, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { ILanguage } from \"ng2/common/model/language.model\";\r\nimport { IDesignerMashup } from \"ng2/common/model/project/mashup/designer-mashup.model\";\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { IDialogBaseScope } from \"../../../common/defines\";\r\nimport { FeatureSwitchCtrl } from \"../../../common/shared-components/base/feature-switch-ctrl\";\r\n\r\nimport { DialogButtonType, DialogService, IDialog, IDialogResult } from \"../../../common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../../common/services/feature-switch-service\";\r\nimport { TranslationManagementService } from \"../../../components/services/translation-management-service\";\r\nimport { EditorService } from \"../services/editor-service\";\r\nimport { SaveService } from \"../services/save-service\";\r\n\r\nexport class ProjectSettingsCtrl extends FeatureSwitchCtrl {\r\n\tpublic manifest: DesignerManifest;\r\n\tpublic defaultTheme: any;\r\n\tpublic currentProject: IDesignerMashup;\r\n\tprivate originalManifest: DesignerManifest;\r\n\t// The object is created in this way to actually help with transformation from string to ThemeEnum\r\n\tpublic themes = {\r\n\t\t[ThemeEnum.LIGHT]: { id: ThemeEnum.LIGHT, name: \"LIGHT\" },\r\n\t\t[ThemeEnum.DARK]: { id: ThemeEnum.DARK, name: \"DARK\" },\r\n\t\t[ThemeEnum.HIGH_CONTRAST]: { id: ThemeEnum.HIGH_CONTRAST, name: \"High Contrast\" },\r\n\t\t[ThemeEnum.LIGHT_TRANSPARENT]: { id: ThemeEnum.LIGHT_TRANSPARENT, name: \"LIGHT Transparent\" },\r\n\t\t[ThemeEnum.DARK_TRANSPARENT]: { id: ThemeEnum.DARK_TRANSPARENT, name: \"DARK Transparent\" }\r\n\t} as any;\r\n\tprivate dialog: IDialog<DesignerManifest>;\r\n\tprivate errorList: string[] = [];\r\n\tprivate tagsChanged: boolean = false;\r\n\tprivate newTags: IJsonTag[] = [];\r\n\r\n\tpublic get isManifestInvalid(): boolean {\r\n\t\treturn this.errorList.length !== 0;\r\n\t}\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.SAVE_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<DesignerManifest>,\r\n\t\tprivate editorService: EditorService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate saveService: SaveService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t) {\r\n\t\tsuper(featureService);\r\n\r\n\t\tconst dialog: IDialog<DesignerManifest> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.originalManifest = dialog.parameter;\r\n\t\tthis.manifest = angular.copy(this.originalManifest);\r\n\t\tthis.defaultTheme = this.themes[this.manifest.defaultTheme];\r\n\t\tthis.currentProject = this.editorService.getCurrentProject();\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic saveTags(tags: IJsonTag[]): void {\r\n\t\tthis.tagsChanged = true;\r\n\t\tthis.newTags = tags;\r\n\t}\r\n\r\n\tpublic save(): void {\r\n\t\tif (this.tagsChanged) {\r\n\t\t\tthis.currentProject.setTags(this.newTags);\r\n\t\t}\r\n\t\tif (this.manifest.title !== this.originalManifest.title) {\r\n\t\t\tconst rootId = this.editorService.getCurrentRootComponentInstance().getId();\r\n\t\t\tconst updatedValue: ILanguage = {\r\n\t\t\t\tlocale: this.translationManagementService.getSelectedLocale(),\r\n\t\t\t\tvalue: this.manifest.title\r\n\t\t\t};\r\n\t\t\tthis.translationManagementService.setTranslatableStringByProperty(\r\n\t\t\t\trootId,\r\n\t\t\t\tSettingKeys.APPLICATION_HEADER, updatedValue\r\n\t\t\t);\r\n\t\t}\r\n\t\tif (this.manifest.displayName !== this.originalManifest.displayName) {\r\n\t\t\tthis.editorService.renameProject(this.manifest.id, this.manifest.displayName).then(() => {\r\n\t\t\t\tthis.saveManifest();\r\n\t\t\t}).catch((exception) => {\r\n\t\t\t\tthis.errorOnSave(exception);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.saveManifest();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate errorOnSave(exception: any): void {\r\n\t\tthis.dialogService.showError(\"Server Error\", exception.message);\r\n\t\t// Reset manifest and savestate when save fails\r\n\t\tthis.editorService.setManifest(this.originalManifest);\r\n\t\tthis.saveService.saveStateEvent.raise(this.saveService.saveStates.saved);\r\n\t}\r\n\r\n\tprivate saveManifest(): void {\r\n\t\tthis.manifest.defaultTheme = this.defaultTheme.id;\r\n\t\tthis.editorService.setManifest(this.manifest);\r\n\t\t//tslint:disable:no-bitwise\r\n\t\t/* Manifest needs to be saved first before translation is saved\r\n\t\tdue to save translation also updates lastChanged property in manifest */\r\n\t\tthis.editorService.saveCurrent(SaveFlagsEnum.MANIFEST).then(() => {\r\n\t\t\tthis.editorService.saveCurrent(SaveFlagsEnum.TRANSLATIONS | SaveFlagsEnum.TAGS).then(() => {\r\n\t\t\t\tconst result: IDialogResult<void> = { button: DialogButtonType.Ok };\r\n\t\t\t\tthis.dialog.close(result);\r\n\t\t\t});\r\n\t\t}).catch((exception: any) => {\r\n\t\t\tthis.errorOnSave(exception);\r\n\t\t});\r\n\t\t//tslint:enable:no-bitwise\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirProjectSettingsCtrl\", ProjectSettingsCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../common/services/dialog-service\";\r\n\r\nexport class BoundaryEditorCtrl {\r\n\tprivate boundary: IBoundary;\r\n\tprivate dialog: IDialog<IBoundary>;\r\n\r\n\t// View variables\r\n\tpublic settingLimitX: string; // Soho ticker component uses text\r\n\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<IBoundary>) {\r\n\t\tconst dialog: IDialog<IBoundary> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tconst boundary = dialog.parameter;\r\n\t\tthis.settingLimitX = String(boundary.limitX);\r\n\r\n\t\tthis.boundary = boundary;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tprivate getNewLimitX(): number {\r\n\t\tlet newLimitX: number;\r\n\t\tconst parsedNumber = parseInt(this.settingLimitX);\r\n\t\tif (!parsedNumber) { // If falsey, this covers NaN and 0\r\n\t\t\tnewLimitX = this.boundary.limitX;\r\n\t\t} else {\r\n\t\t\tnewLimitX = parsedNumber;\r\n\t\t}\r\n\t\treturn newLimitX;\r\n\t}\r\n\r\n\tpublic save(): void {\r\n\t\t//When pressing ENTER after changing boundary limit the\r\n\t\t//focus must be on name input for the data to be saved\r\n\t\t$(\"#boundaryName\").focus();\r\n\t\tthis.boundary.limitX = this.getNewLimitX();\r\n\t\tconst result: IDialogResult<IBoundary> = {\r\n\t\t\tvalue: this.boundary,\r\n\t\t\tbutton: DialogButtonType.Ok };\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirBoundaryEditorCtrl\", BoundaryEditorCtrl);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport type { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogOptions, IDialogResult } from \"../../../../common/services/dialog-service\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { QuestionDefinitionsEnum } from \"ng2/common/model/questions/questions.enum\";\r\n\r\nimport type { IJsonQuestion, IJsonSettingQuestion } from \"ng2/common/model/questions/questions.model\";\r\nimport type { IDatagridApi, IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport type { IRowItem } from \"common/sohoxi/datagrid-helper\";\r\n\r\nimport { EditorService } from \"designer/editor/services/editor-service\";\r\n\r\nexport interface IDatasetQuestion {\r\n\tid: string;\r\n\tcomponent: string,\r\n\ttype: string,\r\n\tsetting?: IJsonSettingQuestion;\r\n}\r\n\r\nexport class BaseDialogController {\r\n\tselectedQuestion: IDatasetQuestion;\r\n\tdialog: IDialog<string>;\r\n\tdatagridOptions: IDataGridOptions<IDatasetQuestion>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<string>,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate editorService: EditorService\r\n\t) {\r\n\t\tconst dialog: IDialog<string> = $scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\r\n\t\tthis.initGridOptions();\r\n\t\tthis.initQuestionsData();\r\n\t}\r\n\r\n\tprivate initGridOptions(): void {\r\n\t\tconst columns = [\r\n\t\t\t{\r\n\t\t\t\tid: \"component\",\r\n\t\t\t\tname: \"Component\",\r\n\t\t\t\tfield: \"component\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t\twidth: \"25%\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"type\",\r\n\t\t\t\tname: \"Type\",\r\n\t\t\t\tfield: \"type\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t\twidth: \"25%\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"setting\",\r\n\t\t\t\tname: \"Setting\",\r\n\t\t\t\tfield: \"setting.key\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t\twidth: \"25%\"\r\n\t\t\t}, {\r\n\t\t\t\tid: \"text\",\r\n\t\t\t\tname: \"Text\",\r\n\t\t\t\tfield: \"setting.text\",\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t\twidth: \"25%\"\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tconst options: IDataGridOptions<IDatasetQuestion> = {\r\n\t\t\tdataset: [],\r\n\t\t\tcolumns: columns,\r\n\t\t\tisList: true,\r\n\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\ttoolbar: {\r\n\t\t\t\ttitle: \"Questions\",\r\n\t\t\t\tresults: true,\r\n\t\t\t\tdateFilter: false,\r\n\t\t\t\tkeywordFilter: true,\r\n\t\t\t\tadvancedFilter: true,\r\n\t\t\t\tactions: true,\r\n\t\t\t\tviews: true,\r\n\t\t\t\trowHeight: true\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.datagridOptions = options;\r\n\r\n\t\tthis.$element.find(\"#datagrid-questions\").on(\"selected\", (e: any, args: IRowItem<IDatasetQuestion>[]) => {\r\n\t\t\t// When datagrid get unselected args[0] is undefined\r\n\t\t\tthis.$scope.$evalAsync(() => {\r\n\t\t\t\tif (args.length > 0) {\r\n\t\t\t\t\tthis.selectedQuestion = args[0].data;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.selectedQuestion = null;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initQuestionsData(): void {\r\n\t\tconst projectQuestions = this.editorService.getCurrentProject().getQuestions();\r\n\t\tconst dataset: IDatasetQuestion[] = [];\r\n\t\tprojectQuestions.forEach((question) => {\r\n\t\t\tconst datasetQuestion: IDatasetQuestion = {\r\n\t\t\t\tid: question.id,\r\n\t\t\t\tcomponent: question.componentId,\r\n\t\t\t\ttype: this.getTypeName(question.type)\r\n\t\t\t};\r\n\t\t\tif (question.type === QuestionDefinitionsEnum.COMPONENT_SETTINGS) {\r\n\t\t\t\tquestion.settings.forEach((questionSetting) => {\r\n\t\t\t\t\tdatasetQuestion.setting = {\r\n\t\t\t\t\t\tid: questionSetting.id,\r\n\t\t\t\t\t\ttext: questionSetting.text,\r\n\t\t\t\t\t\tkey: questionSetting.key\r\n\t\t\t\t\t};\r\n\t\t\t\t\tdataset.push(angular.copy(datasetQuestion));\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tdataset.push(datasetQuestion);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.datagridOptions.dataset = dataset;\r\n\t}\r\n\r\n\tdeleteQuestion(): void {\r\n\t\tthis.dialogService.showYesNo(\"Delete Question\", \"Do you want to delete this Question?\").then((result) => {\r\n\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\tconst questionId = this.selectedQuestion.id;\r\n\t\t\t\tconst settingId = this.selectedQuestion.setting?.id;\r\n\t\t\t\tthis.editorService.getCurrentProject().deleteQuestion(questionId, settingId);\r\n\t\t\t\tthis.clearSelected();\r\n\t\t\t\tthis.initQuestionsData();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\taddQuestion(): void {\r\n\t\tconst options: IDialogOptions<string> = {\r\n\t\t\ttitle: \"New Base Question\",\r\n\t\t\ttemplate: require(\"./upsert-question-dialog/upsert-question-dialog.html\")\r\n\t\t};\r\n\r\n\t\tthis.dialogService.show(options).then((result: IDialogResult<IJsonQuestion>) => {\r\n\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\tthis.editorService.getCurrentProject().addQuestion(result.value);\r\n\t\t\t\tthis.initQuestionsData();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate clearSelected(): void {\r\n\t\tthis.selectedQuestion = null;\r\n\t\tconst api = this.$element.find(\"#datagrid-questions\").data(\"datagrid\") as IDatagridApi;\r\n\r\n\t\tif (api) {\r\n\t\t\tapi.deSelectAllRows();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getTypeName(type: QuestionDefinitionsEnum): string {\r\n\t\tswitch (type) {\r\n\t\t\tcase QuestionDefinitionsEnum.COMPONENT_SETTINGS:\r\n\t\t\t\treturn \"Setting\";\r\n\t\t\tcase QuestionDefinitionsEnum.SEEKS_BINDING:\r\n\t\t\t\treturn \"Binding\";\r\n\t\t\tdefault:\r\n\t\t\t\t// type do not exist\r\n\t\t}\r\n\t}\r\n\r\n\tclose(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\tconst result: IDialogResult<void> = {\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirBaseDialogController\", BaseDialogController);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirUpsertQuestionDialogCtrl as ctrl\\\" class=edit-expression-dialog> <div class=field> <label for=component>Component</label> <select id=component class=dropdown ng-model=ctrl.selectedQuestion.componentId ng-change=ctrl.onComponentChange() ng-options=\\\"availableComponent.id as availableComponent.name for availableComponent in ctrl.availableComponents\\\" xi-drop-down> </select> </div> <div class=field> <label for=typeProperty>Type</label> <select id=typeProperty class=dropdown ng-model=ctrl.selectedQuestion.type ng-change=ctrl.onTypeChange() ng-options=\\\"type.value as type.name for type in ctrl.availableTypes\\\" xi-drop-down> </select> </div> <div class=field> <label for=componentSetting>Setting</label> <select id=componentSetting class=dropdown ng-disabled=\\\"ctrl.selectedQuestion.type === 0\\\" ng-model=ctrl.selectedQuestion.settings[0].key ng-options=\\\"setting.value as setting.name for setting in ctrl.availableComponentSettings\\\" xi-drop-down> </select> </div> <div class=field> <label for=textValue>Text</label> <input type=textValue class=input ng-disabled=\\\"ctrl.selectedQuestion.type === 0\\\" ng-model=ctrl.selectedQuestion.settings[0].text ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\"/> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.cancel()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../../common/angular-constants\";\r\n\r\nimport type { IDialogBaseScope } from \"../../../../../common/defines\";\r\n\r\nimport { Helper } from \"../../../../../common/helper\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../../common/services/dialog-service\";\r\nimport type { ISourceComponent } from \"../../../defines\";\r\nimport { EditorService } from \"../../../services/editor-service\";\r\n\r\nimport { InjectNames, SettingInputKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { QuestionDefinitionsEnum } from \"ng2/common/model/questions/questions.enum\";\r\n\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonQuestion } from \"ng2/common/model/questions/questions.model\";\r\n\r\nexport class UpsertQuestionDialogCtrl {\r\n\tselectedQuestion: IJsonQuestion;\r\n\tavailableComponents: ISourceComponent[];\r\n\tavailableTypes: IDataPair[] = [];\r\n\tavailableComponentSettings: IDataPair[] = [];\r\n\tprivate dialog: IDialog<IJsonQuestion>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<IJsonQuestion>,\r\n\t\tprivate editorService: EditorService\r\n\t) {\r\n\t\tconst dialog: IDialog<IJsonQuestion> = $scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\r\n\t\tthis.selectedQuestion = {\r\n\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\tcomponentId: \"\",\r\n\t\t\ttype: QuestionDefinitionsEnum.COMPONENT_SETTINGS,\r\n\t\t\tsettings: [{\r\n\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\ttext: \"\",\r\n\t\t\t\tkey: \"\"\r\n\t\t\t}],\r\n\t\t};\r\n\r\n\t\tthis.getAvailableComponents();\r\n\t\tthis.availableTypes = [\r\n\t\t\t{\r\n\t\t\t\tname: \"Setting\",\r\n\t\t\t\tvalue: QuestionDefinitionsEnum.COMPONENT_SETTINGS\r\n\t\t\t}, {\r\n\t\t\t\tname: \"Binding\",\r\n\t\t\t\tvalue: QuestionDefinitionsEnum.SEEKS_BINDING\r\n\t\t\t}\r\n\t\t];\r\n\t\tthis.getAvailableComponentSettings(this.availableComponents[0].id);\r\n\t}\r\n\r\n\tprivate getType(typeName: string): QuestionDefinitionsEnum {\r\n\t\tswitch (typeName) {\r\n\t\t\tcase \"Setting\":\r\n\t\t\t\treturn QuestionDefinitionsEnum.COMPONENT_SETTINGS;\r\n\t\t\tcase \"Binding\":\r\n\t\t\t\treturn QuestionDefinitionsEnum.SEEKS_BINDING;\r\n\t\t\tdefault:\r\n\t\t\t\t// type do not exist\r\n\t\t}\r\n\t}\r\n\r\n\tsave(): void {\r\n\t\tconst result: IDialogResult<IJsonQuestion> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: this.selectedQuestion\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tconst result: IDialogResult<void> = {\r\n\t\t\tbutton: DialogButtonType.Cancel\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tgetAvailableComponents(): void {\r\n\t\tconst availableSources: ISourceComponent[] = [];\r\n\t\tconst components = this.editorService.getAllComponents();\r\n\t\tcomponents.forEach((component) => {\r\n\t\t\tavailableSources.push({\r\n\t\t\t\tid: component.getId(),\r\n\t\t\t\tname: component.getDisplayName(),\r\n\t\t\t\tisComponent: true\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.availableComponents = availableSources;\r\n\t\tthis.selectedQuestion.componentId = this.availableComponents[0].id;\r\n\t}\r\n\r\n\tonComponentChange(): void {\r\n\t\tthis.getAvailableComponentSettings(this.selectedQuestion.componentId);\r\n\t}\r\n\r\n\tonTypeChange(): void {\r\n\t\tif (this.selectedQuestion.type === QuestionDefinitionsEnum.SEEKS_BINDING) {\r\n\t\t\tthis.selectedQuestion.settings = [];\r\n\t\t} else {\r\n\t\t\tthis.selectedQuestion.settings = [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\t\t\ttext: \"\",\r\n\t\t\t\t\tkey: \"\"\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t\tthis.getAvailableComponentSettings(this.selectedQuestion.componentId);\r\n\t\t}\r\n\t}\r\n\r\n\tgetAvailableComponentSettings(componentId: string): void {\r\n\t\tconst availableSettings: IDataPair[] = [];\r\n\t\tconst component = this.editorService.getComponentInstanceById(componentId);\r\n\t\tconst componentSettings = component.getFieldSettings();\r\n\t\tcomponentSettings.forEach((setting) => {\r\n\t\t\tsetting.settings.forEach((data) => {\r\n\t\t\t\t// Dumb way to see if the setting is boolean\r\n\t\t\t\tif (data.inputType === SettingInputKeys.SWITCH || data.inputType === SettingInputKeys.CHECKBOX) {\r\n\t\t\t\t\tavailableSettings.push({\r\n\t\t\t\t\t\tvalue: data.ref,\r\n\t\t\t\t\t\tname: this.prettyPrint(data.ref)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.availableComponentSettings = availableSettings;\r\n\t\tthis.selectedQuestion.settings[0].key = this.availableComponentSettings[0].value;\r\n\t}\r\n\r\n\tprivate prettyPrint(settingReference: string): string {\r\n\t\treturn settingReference.match(/^[a-z]+|[A-Z][a-z]*/g).map((word) => {\r\n\t\t\treturn word[0].toUpperCase() + word.substr(1).toLowerCase();\r\n\t\t}).join(\" \");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirUpsertQuestionDialogCtrl\", UpsertQuestionDialogCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../../common/angular-constants\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../../common/services/dialog-service\";\r\nimport { IValidatorError } from \"../../../../common/shared-components/base/field-validation\";\r\n\r\nexport class CopyFormDialogController {\r\n\tpublic dialog: IDialog<string>;\r\n\tpublic formName: string = \"\";\r\n\tpublic errorList: IValidatorError[] = [];\r\n\tpublic get isNameInvalid(): boolean {\r\n\t\treturn this.errorList.length !== 0;\r\n\t}\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tscope: IDialogBaseScope<string>\r\n\t) {\r\n\t\tconst dialog: IDialog<string> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.errorList = [];\r\n\t\tthis.formName = this.dialog.parameter;\r\n\t}\r\n\r\n\tpublic saveForm(): void {\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\tvalue: this.formName\r\n\t\t};\r\n\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirCopyFormDialogController\", CopyFormDialogController);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport { IDialogBaseScope } from \"../../../common/defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../../common/services/dialog-service\";\r\nimport { IValidatorError } from \"../../../common/shared-components/base/field-validation\";\r\nimport { IOnComponentChangeNotification, NotifiableComponent } from \"../../../common/shared-components/base/notifiable-component\";\r\n\r\nimport { Helper } from \"../../../common/helper\";\r\nimport { EditorService } from \"../services/editor-service\";\r\n\r\nexport class UrlVariableDialogCtrl extends NotifiableComponent {\r\n\tpublic dialog: IDialog<void>;\r\n\tpublic variables: IJsonUrlVariable[];\r\n\tpublic newVariable: string = \"\";\r\n\tpublic newDescription: string = \"\";\r\n\tpublic saveDisabled: boolean;\r\n\tpublic hasError: boolean;\r\n\tpublic errorList: IValidatorError[] = [];\r\n\tpublic get ErrorList(): IValidatorError[] {\r\n\t\t// TODO: MUPS-Refactor-1:\r\n\t\t// Remove this part also when refactoring done\r\n\t\tthis.hasError = this.errorList\r\n\t\t\t.filter(item => typeof item !== \"boolean\").length > 0;\r\n\t\tthis.updateSaveDisabled();\r\n\t\treturn this.errorList;\r\n\t}\r\n\tprivate oldVariables: IJsonUrlVariable[];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.EDITOR_SERVICE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tscope: IDialogBaseScope<void>,\r\n\t\teditorService: EditorService,\r\n\t\tprivate $timeout: ng.ITimeoutService\r\n\t) {\r\n\t\tsuper();\r\n\r\n\t\tconst dialog: IDialog<void> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.variables = angular.copy(editorService.getCurrentProject().getUrlVariables());\r\n\r\n\t\tthis.errorList = [];\r\n\t\tthis.saveDisabled = true;\r\n\t\tthis.hasError = false;\r\n\t\tthis.oldVariables = angular.copy(this.variables);\r\n\t}\r\n\r\n\tpublic updateSaveDisabled(): void {\r\n\t\tconst hasChange = Helper.isDifferent(this.variables, this.oldVariables);\r\n\t\tconst value = !hasChange || this.hasError;\r\n\t\tif (value !== this.saveDisabled) {\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\tthis.saveDisabled = value;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addVariable(): void {\r\n\t\tthis.variables.push({\r\n\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\tname: this.newVariable,\r\n\t\t\tdescription: this.newDescription\r\n\t\t});\r\n\t\tthis.clearInput();\r\n\t\tthis.updateSaveDisabled();\r\n\t}\r\n\r\n\tpublic removeVariable(variable: IJsonUrlVariable): void {\r\n\t\tthis.variables = this.variables.filter(oldVariable => oldVariable.id !== variable.id);\r\n\t\tthis.updateSaveDisabled();\r\n\t}\r\n\r\n\tpublic saveVariables(): void {\r\n\t\tconst result: IDialogResult<IJsonUrlVariable[]> = {\r\n\t\t\tvalue: this.variables,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic isNameUnique(newVariable: IJsonUrlVariable): boolean {\r\n\t\tconst isUnique = !this.variables.find(variable => {\r\n\t\t\treturn variable.name === newVariable.name &&\r\n\t\t\t\tvariable.id !== newVariable.id;\r\n\t\t});\r\n\t\treturn isUnique;\r\n\t}\r\n\r\n\tpublic validate($data: { validator: string, id: string, value: string, callback: boolean}): boolean {\r\n\t\treturn this.isNameUnique({id: $data.id, name: $data.value});\r\n\t}\r\n\r\n\tpublic getValidation($data: IOnComponentChangeNotification): boolean {\r\n\t\tlet result: boolean;\r\n\t\tif ($data.validator === \"validate\") {\r\n\t\t\tresult = this.validate($data);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate clearInput(): void {\r\n\t\tthis.newVariable = \"\";\r\n\t\tthis.newDescription = \"\";\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirUrlVariableDialogCtrl\", UrlVariableDialogCtrl);\r\n\t}\r\n}\r\n","import { NgModule } from \"@angular/core\";\r\nimport { BrowserModule } from \"@angular/platform-browser\";\r\nimport { UpgradeModule } from \"@angular/upgrade/static\";\r\nimport { UIRouterUpgradeModule } from \"@uirouter/angular-hybrid\";\r\n\r\nimport { appStates } from \"./app.states\";\r\n\r\nimport { appBuilder as ng1RootModule } from \"../appbuilder/app\";\r\n\r\nimport { AppLauncherModule } from \"ng2/app-launcher/app-launcher.module\";\r\n\r\nimport \"./index.less\";\r\n\r\n// The main NgModule for the Angular portion of the hybrid app\r\n@NgModule({\r\n\timports: [\r\n\t\tBrowserModule,\r\n\t\t// Provide angular upgrade capabilities\r\n\t\tUpgradeModule,\r\n\t\t// Provides the @uirouter/angular directives and registers\r\n\t\t// the future state for the lazy loaded contacts module\r\n\t\tUIRouterUpgradeModule.forRoot({ states: appStates }),\r\n\t\tAppLauncherModule,\r\n\t],\r\n\tdeclarations: [],\r\n\tentryComponents: [],\r\n})\r\nexport class RootModule {\r\n\tconstructor(\r\n\t\tprivate upgrade: UpgradeModule\r\n\t) { }\r\n\r\n\tngDoBootstrap(): void {\r\n\t\tthis.upgrade.bootstrap(document.body, [ng1RootModule.name]);\r\n\t}\r\n}\r\n","import { CommonModule } from \"@angular/common\";\r\nimport { NgModule } from \"@angular/core\";\r\n\r\nimport { AppLauncherHybridComponent } from \"ng2/app-launcher/app-launcher-hybrid.component\";\r\nimport { AppLauncherComponent } from \"ng2/app-launcher/app-launcher.component\";\r\nimport { RuntimeCanvasComponent } from \"ng2/app-launcher/runtime-canvas/runtime-canvas.component\";\r\nimport { ComponentsModule } from \"ng2/components/components.module\";\r\n\r\n@NgModule({\r\n\timports: [\r\n\t\tCommonModule,\r\n\t\tComponentsModule,\r\n\t],\r\n\r\n\tdeclarations: [\r\n\t\tAppLauncherHybridComponent,\r\n\t\tAppLauncherComponent,\r\n\t\tRuntimeCanvasComponent\r\n\t],\r\n\r\n\texports: [\r\n\t\tAppLauncherComponent,\r\n\t]\r\n})\r\nexport class AppLauncherModule {\r\n\r\n}\r\n","import {\r\n\tComponent,\r\n\tInput,\r\n\tOnChanges,\r\n\tOnInit,\r\n\tSimpleChanges,\r\n} from \"@angular/core\";\r\nimport type { IWidgetSize } from \"lime\"; // eslint-disable-line import/no-unresolved\r\nimport isEmpty from \"lodash-es/isEmpty\";\r\n\r\nimport { AppLauncherBase } from \"ng2/app-launcher/app-launcher.base\";\r\n\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\n@Component({\r\n\tselector: \"ng2-app-launcher\",\r\n\ttemplate: `\r\n\t\t<ng2-runtime-canvas\r\n\t\t\t*ngIf=\"showMashup\"\r\n\t\t\t[app]=\"runtimeApp\"\r\n\t\t\t[widgetSize]=\"widgetSize\"\r\n\t\t></ng2-runtime-canvas>\r\n\t`,\r\n})\r\nexport class AppLauncherComponent\r\n\textends AppLauncherBase\r\n\timplements OnInit, OnChanges {\r\n\r\n\t@Input() widgetSize: IWidgetSize;\r\n\r\n\tconstructor(\r\n\t\tframeworkService: FrameworkService,\r\n\t) {\r\n\t\tsuper(frameworkService);\r\n\t}\r\n\r\n\tngOnInit(): void {\r\n\r\n\t}\r\n\r\n\tngOnChanges(changes: SimpleChanges): void {\r\n\r\n\t\tconst projectIdChanges = changes.projectId;\r\n\r\n\t\tif (projectIdChanges.previousValue !== projectIdChanges.currentValue &&\r\n\t\t\t!isEmpty(projectIdChanges.currentValue)\r\n\t\t) {\r\n\t\t\tthis.runtimeApp = this.frameworkService\r\n\t\t\t\t.loadProject(projectIdChanges.currentValue);\r\n\r\n\t\t\tthis.showMashup = true;\r\n\t\t}\r\n\t}\r\n}\r\n","import {\r\n\tAfterViewChecked,\r\n\tChangeDetectorRef,\r\n\tComponent,\r\n\tInput,\r\n\tOnInit,\r\n} from \"@angular/core\";\r\nimport type { IWidgetSize } from \"lime\"; // eslint-disable-line import/no-unresolved\r\nimport { take } from \"rxjs/operators\";\r\n\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { ILayoutComponent } from \"ng2/common/model/components/base/layout-component.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport { RuntimeApp } from \"ng2/common/project/runtime-app\";\r\nimport { ApplicationParent } from \"ng2/components/base/application-parent\";\r\n\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\n@Component({\r\n\tselector: \"ng2-runtime-canvas\",\r\n\ttemplate: `\r\n\t\t<ng2-titlebar remove-host\r\n\t\t\t[manifest]=\"app.getManifest()\"\r\n\t\t></ng2-titlebar>\r\n\t\t<section class=\"page-container mashupRootContainer runtimeMode\">\r\n\t\t\t<component-container\r\n\t\t\t\t*ngIf=\"rootComponent\"\r\n\t\t\t\t[component]=\"rootComponent\"\r\n\t\t\t\t[context]=\"context\"\r\n\t\t\t\t[parent]=\"parent\"\r\n\t\t\t\t(componentReady)=\"onComponentReady($event)\"\r\n\t\t\t></component-container>\r\n\t\t</section>\r\n\t`\r\n})\r\nexport class RuntimeCanvasComponent\r\nimplements OnInit, AfterViewChecked {\r\n\r\n\tprivate _app: RuntimeApp;\r\n\t@Input() set app(value: RuntimeApp) {\r\n\t\tthis._app = value;\r\n\t\tthis.loadApplication();\r\n\t}\r\n\r\n\tget app(): RuntimeApp {\r\n\t\treturn this._app;\r\n\t}\r\n\r\n\t@Input() widgetSize?: IWidgetSize;\r\n\r\n\tconstructor(\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate changeDetectorRef: ChangeDetectorRef,\r\n\t) { }\r\n\tcontext: IContext;\r\n\tparent: ApplicationParent;\r\n\trootComponent: IJsonComponent;\r\n\r\n\tngOnInit(): void {\r\n\r\n\t\tthis.loadApplication();\r\n\t}\r\n\r\n\tngAfterViewChecked(): void {\r\n\t\t// Needed otherwise Homepages SDK throws exception\r\n\t\tthis.changeDetectorRef.detectChanges();\r\n\t}\r\n\r\n\tonComponentReady(componentInstance: ILayoutComponent): void {\r\n\t\tconsole.info(\"[RuntimeDirective] Root component ready\");\r\n\r\n\t\tthis.parent.addChildInstance(componentInstance);\r\n\r\n\t\tthis.frameworkService.rootComponentInstance = componentInstance;\r\n\r\n\t\tthis.frameworkService\r\n\t\t\t.runStartupInteractions()\r\n\t\t\t.pipe(take(1))\r\n\t\t\t.subscribe({\r\n\t\t\t\tcomplete: () => {\r\n\r\n\t\t\t\t\tif (this.widgetSize) {\r\n\t\t\t\t\t\tconst cols = this.widgetSize.cols;\r\n\t\t\t\t\t\tthis.frameworkService.currentBoundary =\r\n\t\t\t\t\t\t\tthis.frameworkService.getBoundaryByWidgetSize(cols);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst currentBrowserWidth = window.innerWidth;\r\n\t\t\t\t\t\tthis.frameworkService.currentBoundary =\r\n\t\t\t\t\t\t\tthis.frameworkService.getBoundaryByWidth(currentBrowserWidth);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcomponentInstance\r\n\t\t\t\t\t\t.onBoundaryChange(this.frameworkService.currentBoundary)\r\n\t\t\t\t\t\t.pipe(take(1))\r\n\t\t\t\t\t\t.subscribe({\r\n\t\t\t\t\t\t\tnext: (value) => console.info(value),\r\n\t\t\t\t\t\t\tcomplete: () => this.changeDetectorRef.detectChanges()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t// this.frameworkService.triggerExpressions();\r\n\r\n\t\t// Helper.appIsReadyForSelenium();\r\n\t}\r\n\r\n\tprivate loadApplication(): void {\r\n\r\n\t\tconst manifest = this.app.manifest;\r\n\r\n\t\tthis.parent = new ApplicationParent(\r\n\t\t\tApplicationParent.APPLICATION_PARENT_DATABEARER,\r\n\t\t\tApplicationParent.createSpoofElement(),\r\n\t\t\tnull,\r\n\t\t\tmanifest\r\n\t\t);\r\n\r\n\t\tthis.context = {};\r\n\r\n\t\tthis.rootComponent = this.app.rootComponent;\r\n\r\n\t}\r\n}\r\n","import {\r\n\tInteractionPairOperation,\r\n\tSettingKeys,\r\n\tThemeEnum,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { ILayoutComponent } from \"ng2/common/model/components/base/layout-component.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent, IJsonComponentSettings, IJsonSize, TypeDef } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\n\r\nimport { LayoutComponent } from \"ng2/components/base//layout-component\";\r\n\r\nexport class ApplicationParent extends LayoutComponent {\r\n\r\n\tstatic APPLICATION_PARENT_DATABEARER: IJsonComponent = {\r\n\t\ttypedef: ApplicationParent.name as TypeDef,\r\n\t\tid: \"Application\",\r\n\t\tdisplayName: \"Application\",\r\n\t\tisReadonly: false,\r\n\t\tboundarySettings: {} as IMap<IJsonComponentSettings>\r\n\t};\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"$Language\",\r\n\t\tref: SettingKeys.LANGUAGE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_STARTUP;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.NONE;\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = [InteractionPairOperation.ON_STARTUP];\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.NONE];\r\n\r\n\tcurrentTheme: ThemeEnum = 1;\r\n\tlanguage: string;\r\n\tdatabearer: IJsonComponent;\r\n\r\n\tprivate manifest: IDesignerManifest;\r\n\r\n\tget hasIndividualChildSizes(): boolean {\r\n\t\tif (this.manifest.showTitleBar) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tdatabearer: IJsonComponent,\r\n\t\telement: JQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tmanifest?: IDesignerManifest|IJsonRuntimeManifest\r\n\t) {\r\n\t\tsuper(null, null, null, null, null, null);\r\n\r\n\t\tthis.manifest = manifest as IDesignerManifest;\r\n\t\tthis.language = null;\r\n\t\t// this.getScope().componentInstance = this;\r\n\t}\r\n\r\n\taddChildInstance(child: ILayoutComponent): void {\r\n\t\tthis.children[0] = child;\r\n\t}\r\n\r\n\tstatic createSpoofElement(): JQuery {\r\n\t\tconst element = $(\"<div></div>\");\r\n\t\telement.data(\"eir-scope\", this);\r\n\t\treturn element;\r\n\t}\r\n\r\n\tgetPxPerPercentComponent(ori: OrientationEnum): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n}","import { CommonModule } from \"@angular/common\";\r\nimport { HttpClientModule } from \"@angular/common/http\";\r\nimport { NgModule } from \"@angular/core\";\r\nimport { FormsModule } from \"@angular/forms\";\r\nimport { SohoComponentsModule } from \"ids-enterprise-ng\";\r\n\r\nimport { RemoveHostDirective } from \"ng2/common/directives/remove-host.directive\";\r\n\r\nimport { ButtonComponent } from \"ng2/components/button/button.component\";\r\nimport { ChildrenComponentContainer } from \"ng2/components/containers/children-component-container.component\";\r\nimport { ComponentContainer } from \"ng2/components/containers/component-container.component\";\r\nimport { DropdownComponent } from \"ng2/components/dropdown/dropdown.component\";\r\nimport { FlexboxComponent } from \"ng2/components/layout-components/flexbox/flexbox.component\";\r\nimport { ListComponent } from \"ng2/components/list/list.component\";\r\nimport { LookupComponent } from \"ng2/components/lookup/lookup.component\";\r\nimport { TextboxComponent } from \"ng2/components/textbox/textbox.component\";\r\nimport { TitlebarComponent } from \"ng2/components/titlebar/titlebar.component\";\r\n\r\nimport { ComponentService } from \"ng2/components/services/component.service\";\r\nimport { DataServiceBuilder } from \"ng2/components/services/data-service.service\";\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\nimport { FrameworkService } from \"ng2/components/services/framework.service\";\r\n\r\n@NgModule({\r\n\timports: [\r\n\t\tCommonModule,\r\n\t\tHttpClientModule,\r\n\t\tFormsModule,\r\n\t\tSohoComponentsModule,\r\n\t],\r\n\r\n\texports: [\r\n\t\tChildrenComponentContainer,\r\n\t\tComponentContainer,\r\n\t\tButtonComponent,\r\n\t\tDropdownComponent,\r\n\t\tFlexboxComponent,\r\n\t\tListComponent,\r\n\t\tLookupComponent,\r\n\t\tTitlebarComponent,\r\n\r\n\t\tRemoveHostDirective,\r\n\t],\r\n\r\n\tdeclarations: [\r\n\t\tChildrenComponentContainer,\r\n\t\tComponentContainer,\r\n\t\tButtonComponent,\r\n\t\tDropdownComponent,\r\n\t\tFlexboxComponent,\r\n\t\tListComponent,\r\n\t\tLookupComponent,\r\n\t\tTextboxComponent,\r\n\t\tTitlebarComponent,\r\n\r\n\t\tRemoveHostDirective,\r\n\t],\r\n\r\n\t/* Needed for the dynamic load of component a.k.a. appending to DOM in Runtime\r\n\t\tCan be removed if Ivy is activated */\r\n\tentryComponents: [\r\n\t\tButtonComponent,\r\n\t\tDropdownComponent,\r\n\t\tFlexboxComponent,\r\n\t\tListComponent,\r\n\t\tLookupComponent,\r\n\t\tTextboxComponent,\r\n\t],\r\n\r\n\tproviders: [\r\n\t\tComponentService,\r\n\t\tDataServiceBuilder,\r\n\t\tDynamicComponentService,\r\n\t\tFrameworkService,\r\n\t]\r\n})\r\nexport class ComponentsModule {\r\n\r\n}","import { Directive, ElementRef, OnInit } from \"@angular/core\";\r\n\r\n/*\r\n\tThis directive remove the host element also known as the parent element\r\n\thttps://stackoverflow.com/a/35837189/445600\r\n*/\r\n@Directive({\r\n\tselector: \"[remove-host]\",\r\n})\r\nexport class RemoveHostDirective implements OnInit {\r\n\r\n\tconstructor(\r\n\t\tprivate elementRef: ElementRef\r\n\t) { }\r\n\r\n\tngOnInit(): void {\r\n\r\n\t\tconst nativeElement: HTMLElement = this.elementRef.nativeElement,\r\n\t\t\tparentElement: HTMLElement = nativeElement.parentElement;\r\n\r\n\t\t// move all children out of the element\r\n\t\twhile (nativeElement.firstChild) {\r\n\t\t\tparentElement.insertBefore(nativeElement.firstChild, nativeElement);\r\n\t\t}\r\n\r\n\t\t// remove the empty element(the host)\r\n\t\tparentElement.removeChild(nativeElement);\r\n\t}\r\n}\r\n","import {\r\n\tComponent,\r\n\tEventEmitter,\r\n\tInput,\r\n\tOnInit,\r\n\tOutput,\r\n} from \"@angular/core\";\r\n\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { ILayoutComponent } from \"ng2/common/model/components/base/layout-component.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\n\r\n@Component({\r\n\tselector: \"children-component-container\",\r\n\ttemplate: `\r\n\t\t<component-container\r\n\t\t\t*ngFor=\"let child of parent.getDatabearer().children\"\r\n\t\t\t[component]=\"child\"\r\n\t\t\t[context]=\"context\"\r\n\t\t\t[parent]=\"parent\"\r\n\t\t\t(componentReady)=\"onComponentReady($event)\"\r\n\t\t></component-container>\r\n\t`,\r\n})\r\nexport class ChildrenComponentContainer implements OnInit {\r\n\r\n\t@Input() parent: ILayoutComponent;\r\n\t@Output() onChildrenReady = new EventEmitter();\r\n\r\n\tcontext: IContext;\r\n\r\n\tprivate numberOfChildren: number;\r\n\tprivate parentChildren: IJsonComponent[];\r\n\r\n\tngOnInit(): void {\r\n\r\n\t\tconst parentInstance = this.parent;\r\n\t\tthis.parentChildren =\r\n\t\t\t(parentInstance.getDatabearer() as IJsonLayoutComponent).children;\r\n\r\n\t\tthis.numberOfChildren = this.parentChildren.length;\r\n\t\tif (this.numberOfChildren === 0) {\r\n\t\t\tthis.onChildrenReady.emit();\r\n\t\t}\r\n\r\n\t\tthis.context = parentInstance.context;\r\n\t}\r\n\r\n\tonComponentReady(component: ILayoutComponent): void {\r\n\r\n\t\tthis.numberOfChildren--;\r\n\t\tconsole.info(`ID: ${this.parent.displayName}, TYPEDEF: ${this.parent.typedef}:\r\n\tChild Component: '${component.displayName}' in '${this.parent.displayName}' is ready!\r\n\tNumber of children left ${this.numberOfChildren} to render`);\r\n\r\n\t\tconst index = this.parentChildren.findIndex((child: IJsonComponent) => child.id === component.id);\r\n\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.parent.children[index] = component;\r\n\t\t} else {\r\n\t\t\tthrow Error(\"Should not happen\");\r\n\t\t}\r\n\r\n\t\tif (this.numberOfChildren === 0) {\r\n\t\t\tthis.onChildrenReady.emit();\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import {\r\n\tAfterViewInit,\r\n\tComponent,\r\n\tComponentRef,\r\n\tElementRef,\r\n\tEventEmitter,\r\n\tHostBinding,\r\n\tInput,\r\n\tOnChanges,\r\n\tOutput,\r\n\tRenderer2,\r\n\tSimpleChanges,\r\n\tViewChild,\r\n\tViewContainerRef,\r\n} from \"@angular/core\";\r\nimport { SohoBusyIndicatorDirective } from \"ids-enterprise-ng\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport type { IComponent } from \"ng2/common/model/components/base/component.model\";\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { ILayoutComponent } from \"ng2/common/model/components/base/layout-component.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport { LayoutComponent } from \"ng2/components/base/layout-component\";\r\nimport { ButtonComponent } from \"ng2/components/button/button.component\";\r\nimport { DropdownComponent } from \"ng2/components/dropdown/dropdown.component\";\r\nimport { FlexboxComponent } from \"ng2/components/layout-components/flexbox/flexbox.component\";\r\nimport { ListComponent } from \"ng2/components/list/list.component\";\r\nimport { LookupComponent } from \"ng2/components/lookup/lookup.component\";\r\nimport { TextboxComponent } from \"ng2/components/textbox/textbox.component\";\r\n\r\nimport { DynamicComponentService } from \"ng2/components/services/dynamic-component.service\";\r\n\r\n@Component({\r\n\tselector: \"component-container\",\r\n\ttemplate: `\r\n\t\t<div [hidden]=\"false\"\r\n\t\t\tsoho-busyindicator [activated]=\"true\" [blockUI]=\"true\"\r\n\t\t></div>\r\n\t\t<ng-template #dynamic></ng-template>\r\n\t`,\r\n\tstyles: [`\r\n\t\t.eir2-component {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\t\t}\r\n\t`],\r\n})\r\nexport class ComponentContainer implements\r\n\tAfterViewInit,\r\n\tOnChanges {\r\n\r\n\t@Input() component: IJsonComponent;\r\n\t@Input() context: IContext;\r\n\t@Input() parent: ILayoutComponent;\r\n\t@Output() componentReady = new EventEmitter<IComponent>();\r\n\r\n\t@ViewChild(\"dynamic\", {\r\n\t\tread: ViewContainerRef,\r\n\t}) viewContainerRef: ViewContainerRef;\r\n\r\n\t@ViewChild(SohoBusyIndicatorDirective, {\r\n\t\tstatic: true\r\n\t}) busyIndicator: SohoBusyIndicatorDirective;\r\n\r\n\t@HostBinding(\"id\") id: string;\r\n\t@HostBinding(\"class\") class: string;\r\n\r\n\tcomponentInstance: IComponent | ILayoutComponent;\r\n\ttotalChildren = 0;\r\n\r\n\tconstructor(\r\n\t\tprivate renderer: Renderer2,\r\n\t\tprivate elementRef: ElementRef,\r\n\t\tprivate dynamicComponentService: DynamicComponentService,\r\n\t) { }\r\n\r\n\tngAfterViewInit(): void {\r\n\r\n\t\tthis.dynamicComponentService\r\n\t\t\t.setRootViewContainerRef(this.viewContainerRef);\r\n\r\n\t\tthis.setComponentContainerProperties();\r\n\t\tthis.attachComponent();\r\n\t\tthis.onComponentReady();\r\n\t\tthis.onBoundaryChange();\r\n\t}\r\n\r\n\tngOnChanges(changes: SimpleChanges): void {\r\n\r\n\t\tconst newComponentChange = changes.component;\r\n\t\tif (!isUndefined(newComponentChange.previousValue)) {\r\n\r\n\t\t\tthis.component = newComponentChange.currentValue;\r\n\r\n\t\t\tthis.dynamicComponentService.destroyComponent();\r\n\t\t\t$(\"#child-cage-AppPanel\").remove();\r\n\t\t\tthis.ngAfterViewInit();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setComponentContainerProperties(): void {\r\n\r\n\t\tconst component = this.component;\r\n\r\n\t\tthis.id = component.id;\r\n\t\t// this.isVisible = true;\r\n\r\n\t\tif (component instanceof LayoutComponent || // TODO: verify why it isn't enough to check instance of LayoutComponent\r\n\t\t\tcomponent.children\r\n\t\t) {\r\n\t\t\tthis.totalChildren = component.children.length;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate attachComponent(): void {\r\n\r\n\t\tconst component = this.component;\r\n\t\tconst cssClass = [\"eir2-component\"];\r\n\r\n\t\tlet componentRef: ComponentRef<IComponent|ILayoutComponent>;\r\n\t\tswitch (component.typedef) {\r\n\t\t\tcase \"Button\":\r\n\t\t\t\tcomponentRef = this.dynamicComponentService\r\n\t\t\t\t\t.addComponent(ButtonComponent);\r\n\t\t\t\tcssClass.push(\"eir2-button-component\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"Dropdown\":\r\n\t\t\t\tcomponentRef = this.dynamicComponentService\r\n\t\t\t\t\t.addComponent(DropdownComponent);\r\n\t\t\t\tcssClass.push(\"eir2-dropdown-component\");\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"Flexbox\":\r\n\t\t\t\tcomponentRef = this.dynamicComponentService\r\n\t\t\t\t\t.addComponent(FlexboxComponent);\r\n\t\t\t\tcssClass.push(\"eir2-flexbox-component\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"List\":\r\n\t\t\t\tcomponentRef = this.dynamicComponentService\r\n\t\t\t\t\t.addComponent(ListComponent);\r\n\t\t\t\tcssClass.push(\"eir2-list-component\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Lookup\":\r\n\t\t\t\tcomponentRef = this.dynamicComponentService\r\n\t\t\t\t\t.addComponent(LookupComponent);\r\n\t\t\t\tcssClass.push(\"eir2-lookup-component\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"Textbox\":\r\n\t\t\tcase \"TextBox\":\r\n\t\t\t\tcomponentRef = this.dynamicComponentService\r\n\t\t\t\t\t.addComponent(TextboxComponent);\r\n\t\t\t\tcssClass.push(\"eir2-textbox-component\");\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow Error(\"Invalid component\");\r\n\t\t}\r\n\r\n\t\tthis.class = cssClass.join(\" \");\r\n\r\n\t\tthis.componentInstance = componentRef.instance;\r\n\r\n\t\tthis.setAttachedComponentProperties();\r\n\r\n\t\tthis.componentInstance\r\n\t\t\t.initializeBinding(this.component);\r\n\t}\r\n\r\n\tprivate setAttachedComponentProperties(): void {\r\n\r\n\t\t// Assign more properties?\r\n\t\tthis.componentInstance.id = this.component.id;\r\n\t\tthis.componentInstance.displayName = this.component.displayName;\r\n\t\tthis.componentInstance.typedef = this.component.typedef;\r\n\t\tthis.componentInstance.isReadonly = this.component.isReadonly;\r\n\r\n\t\t// TODO: Shouldn't be specific properties. Make IComponent more generic\r\n\t\t// Assign specific properties\r\n\t\tconst component: any = this.component;\r\n\t\tconst componentInstance: any = this.componentInstance;\r\n\t\tif (component.style) {\r\n\t\t\tcomponentInstance.style = component.style;\r\n\t\t}\r\n\r\n\t\t// End assign properties\r\n\r\n\t\tthis.componentInstance.databearer = this.component;\r\n\t\tthis.componentInstance.parent = this.parent;\r\n\t\tthis.componentInstance.context = this.context;\r\n\t}\r\n\r\n\tprivate onComponentReady(): void {\r\n\t\tthis.componentInstance\r\n\t\t\t.componentReady$\r\n\t\t\t.subscribe({\r\n\t\t\t\tnext: (value) => {\r\n\r\n\t\t\t\t\tif (value instanceof LayoutComponent) {\r\n\t\t\t\t\t\tthis.totalChildren--;\r\n\t\t\t\t\t\tconsole.info(`${value.id} is ready! Number of children left to render ${this.totalChildren}`);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.busyIndicator.activated = value.isLoading;\r\n\t\t\t\t\tthis.componentReady.emit(value);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate onBoundaryChange(): void {\r\n\r\n\t\tthis.componentInstance\r\n\t\t\t.boundaryChange$\r\n\t\t\t.subscribe({\r\n\t\t\t\tnext: (value: IComponent) => {\r\n\r\n\t\t\t\t\tif (value instanceof LayoutComponent) {\r\n\r\n\t\t\t\t\t\tconst componentElement = this.elementRef.nativeElement;\r\n\r\n\t\t\t\t\t\t// TODO: Add more flexbox related boundary cases here\r\n\t\t\t\t\t\tif (!value.isVisible) {\r\n\t\t\t\t\t\t\tthis.renderer.addClass(componentElement, \"is-hidden\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.renderer.removeClass(componentElement, \"is-hidden\");\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconsole.info(`${value.id} has boundary change! isVisible: ${value.isVisible}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n}\r\n","import {\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { BaseComponentMetadata } from \"ng2/components/base/component.metadata\";\r\n\r\nexport class DropdownMetadata {\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.LIST,\r\n\t\tInteractionPairOperation.SET_CURRENT_ITEM,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic SETTING_FIELDS =\r\n\t\t([\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Options\",\r\n\t\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Keep Selection\",\r\n\t\t\t\t\ttooltip: \"Keep previous selected item on reload. (With ION APIs, an object ID is preferred if using this)\",\r\n\t\t\t\t\tref: SettingKeys.KEEP_SELECTED,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Disabled\",\r\n\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t}\r\n\t\t] as IComponentSettingCategory[]).concat(BaseComponentMetadata.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Selected Item\",\r\n\t\tref: SettingKeys.CURRENT_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Display Value\",\r\n\t\tref: SettingKeys.DISPLAY_VALUE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}\r\n\t];\r\n}\r\n","import { colors } from \"ng2/common/constants/colors.constant\";\r\nimport {\r\n\tAlignmentEnum,\r\n\tFlexOverflowEnum,\r\n\tFlexSizeTypeEnum,\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { BaseComponentMetadata } from \"ng2/components/base/component.metadata\";\r\n\r\nexport class FlexboxMetadata {\r\n\tstatic availableOrientations = [\r\n\t\t{ name: \"Vertical\", value: OrientationEnum.VERTICAL },\r\n\t\t{ name: \"Horizontal\", value: OrientationEnum.HORIZONTAL },\r\n\t];\r\n\tstatic availableHorizontalAlignments: IDataPair[] = [\r\n\t\t{ name: \"Left\", value: AlignmentEnum.FLEX_START },\r\n\t\t{ name: \"Center\", value: AlignmentEnum.CENTER },\r\n\t\t{ name: \"Right\", value: AlignmentEnum.FLEX_END },\r\n\t];\r\n\tstatic availableVerticalAlignments: IDataPair[] = [\r\n\t\t{ name: \"Top\", value: AlignmentEnum.FLEX_START },\r\n\t\t{ name: \"Middle\", value: AlignmentEnum.CENTER },\r\n\t\t{ name: \"Bottom\", value: AlignmentEnum.FLEX_END },\r\n\t];\r\n\tstatic availableFlexSizeTypes: IDataPair[] = [\r\n\t\t{ name: \"Relative\", value: FlexSizeTypeEnum.FLEX },\r\n\t\t{ name: \"Pixel\", value: FlexSizeTypeEnum.PIXELS },\r\n\t];\r\n\tstatic availableColors: IDataPair[] = [\r\n\t\t{ name: \"Automatic\", value: undefined },\r\n\t\t{ name: \"Azure 1\", value: colors.azure01 },\r\n\t\t{ name: \"Azure 2\", value: colors.azure02 },\r\n\t\t{ name: \"Azure 3\", value: colors.azure03 },\r\n\t\t{ name: \"Graphite 1\", value: colors.graphite01 },\r\n\t\t{ name: \"Graphite 2\", value: colors.graphite02 },\r\n\t\t{ name: \"Graphite 3\", value: colors.graphite03 },\r\n\t\t{ name: \"Graphite 4\", value: colors.graphite04 },\r\n\t\t{ name: \"Graphite 5\", value: colors.graphite05 },\r\n\t\t{ name: \"White\", value: \"#ffffff\" },\r\n\t];\r\n\tstatic availableOverflows: IDataPair[] = [\r\n\t\t{ name: \"Hidden\", value: FlexOverflowEnum.HIDDEN },\r\n\t\t{ name: \"Wrap\", value: FlexOverflowEnum.WRAP },\r\n\t\t{ name: \"Scroll\", value: FlexOverflowEnum.SCROLL },\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] =\r\n\t\tInteractionDefines.SOURCE_TRIGGERS;\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR,\r\n\t];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [];\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t([\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Orientation\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tref: SettingKeys.ORIENTATION,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\t\tdataset: FlexboxMetadata.availableOrientations,\r\n\t\t\t\t\t\tdefaultValue: OrientationEnum.VERTICAL,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Width\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tcondition: \"parent.orientation === \" + OrientationEnum.HORIZONTAL,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tref: SettingKeys.SIZE_TYPE,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\t\t\tdataset: FlexboxMetadata.availableFlexSizeTypes,\r\n\t\t\t\t\t\tdefaultValue: FlexSizeTypeEnum.FLEX,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Value\",\r\n\t\t\t\t\t\tref: SettingKeys.SIZE,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.TEXT,\r\n\t\t\t\t\t\tdefaultValue: 1,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Height\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tcondition: \"parent.orientation === \" + OrientationEnum.VERTICAL,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tref: SettingKeys.SIZE_TYPE,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\t\t\tdataset: FlexboxMetadata.availableFlexSizeTypes,\r\n\t\t\t\t\t\tdefaultValue: FlexSizeTypeEnum.FLEX,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Value\",\r\n\t\t\t\t\t\tref: SettingKeys.SIZE,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.TEXT,\r\n\t\t\t\t\t\tdefaultValue: 1,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Overflow\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tref: SettingKeys.OVERFLOW,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\t\tdataset: FlexboxMetadata.availableOverflows,\r\n\t\t\t\t\t\tdefaultValue: FlexOverflowEnum.HIDDEN,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Background Color\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tref: SettingKeys.BACKGROUND_COLOR,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\t\tdataset: FlexboxMetadata.availableColors,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Alignment\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Horizontal\",\r\n\t\t\t\t\t\tref: SettingKeys.ALIGNMENT_HORIZONTAL,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tdataset: FlexboxMetadata.availableHorizontalAlignments,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\t\tdefaultValue: AlignmentEnum.FLEX_START,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Vertical\",\r\n\t\t\t\t\t\tref: SettingKeys.ALIGNMENT_VERTICAL,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tdataset: FlexboxMetadata.availableVerticalAlignments,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\t\tdefaultValue: AlignmentEnum.FLEX_START,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Padding\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Padding\",\r\n\t\t\t\t\t\tref: SettingKeys.MARGIN,\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.MARGIN,\r\n\t\t\t\t\t\tdefaultValue: { left: 10, top: 10, right: 10, bottom: 10 },\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t] as IComponentSettingCategory[]).concat(\r\n\t\t\tBaseComponentMetadata.SETTING_FIELDS.filter((settingCategory) => {\r\n\t\t\t// Removing settings \"margin\" from Component settings\r\n\t\t\t// It is replaced by the \"padding\" setting on flexbox\r\n\t\t\t\tif (\r\n\t\t\t\t\tsettingCategory.settings.some((setting) => {\r\n\t\t\t\t\t\treturn setting.ref === SettingKeys.MARGIN;\r\n\t\t\t\t\t})\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t})\r\n\t\t);\r\n}\r\n","import {\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { BaseComponentMetadata } from \"ng2/components/base/component.metadata\";\r\n\r\nexport class LookupMetadata {\r\n\tstatic OUTPUT_SETTING_TITLE = \"Dialog Output Value\";\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = [\r\n\t\tInteractionPairOperation.ON_CLICK\r\n\t];\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_CLICK;\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] =\r\n\t[{\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Text\",\r\n\t\tref: SettingKeys.TEXT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tstatic SETTING_FIELDS =\r\n\t\t([{\r\n\t\t\ttitle: LookupMetadata.OUTPUT_SETTING_TITLE,\r\n\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\tsettings: [{\r\n\t\t\t\tdataset: [],\r\n\t\t\t\ttitle: \"\",\r\n\t\t\t\tref: SettingKeys.LOOKUP_OUTPUT_ID,\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Style\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t}\r\n\t\t\t}]\r\n\t\t}] as IComponentSettingCategory[]\r\n\t\t)\r\n\t\t\t.concat(BaseComponentMetadata.SETTING_FIELDS);\r\n}","import {\r\n\tAfterViewInit,\r\n\tComponent,\r\n\tInput,\r\n\tOnInit,\r\n\tQueryList,\r\n\tViewChildren,\r\n} from \"@angular/core\";\r\nimport { SohoPersonalizeDirective } from \"ids-enterprise-ng\";\r\n\r\nimport { ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonDesignerManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\n\r\n@Component({\r\n\tselector: \"ng2-titlebar\",\r\n\ttemplate: `\r\n\t\t<soho-header *ngIf=\"manifest.showTitleBar\"\r\n\t\t\t[hasToolbar]=\"true\"\r\n\t\t>\r\n\t\t\t<soho-toolbar-flex maxVisibleButtons=\"5\" hasMoreButton=\"true\">\r\n\t\t\t\t<soho-toolbar-flex-section [isTitle]=\"true\">\r\n\t\t\t\t\t<h1>\r\n\t\t\t\t\t\t<span soho-toolbar-flex-page-title>{{ manifest.title }}</span>\r\n\t\t\t\t\t\t<!-- <span soho-toolbar-flex-section-title>{{ manifest.title }}</span> -->\r\n\t\t\t\t\t</h1>\r\n\t\t\t\t</soho-toolbar-flex-section>\r\n\r\n\t\t\t\t<soho-toolbar-flex-more-button>\r\n\t\t\t\t\t<ul class=\"popupmenu\">\r\n\t\t\t\t\t\t<!-- <li *ngFor=\"let theme of themes\" class=\"is-selectable\">\r\n\t\t\t\t\t\t\t<a href=\"#\"\r\n\t\t\t\t\t\t\t\tdata-theme-variant=\"theme.id\"\r\n\t\t\t\t\t\t\t\tdata-translate=\"text\">{{ theme.variantName }}</a>\r\n\t\t\t\t\t\t</li> -->\r\n\t\t\t\t\t\t<li class=\"is-selectable\">\r\n\t\t\t\t\t\t\t<a href=\"#\"\r\n\t\t\t\t\t\t\t\tdata-theme-variant=\"light\"\r\n\t\t\t\t\t\t\t\tdata-translate=\"text\">Light</a>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t<li class=\"is-selectable\">\r\n\t\t\t\t\t\t\t<a href=\"#\"\r\n\t\t\t\t\t\t\t\tdata-theme-variant=\"dark\"\r\n\t\t\t\t\t\t\t\tdata-translate=\"text\">Dark</a>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t<li class=\"is-selectable\">\r\n\t\t\t\t\t\t\t<a href=\"#\"\r\n\t\t\t\t\t\t\t\tdata-theme-variant=\"contrast\"\r\n\t\t\t\t\t\t\t\tdata-translate=\"text\">High Contrast</a>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t\t<div soho-personalize\r\n\t\t\t\t\t\t(changetheme)=\"onChangeTheme($event)\"\r\n\t\t\t\t\t\t(changecolors)=\"onChangeColors($event)\"\r\n\t\t\t\t\t></div>\r\n\t\t\t\t</soho-toolbar-flex-more-button>\r\n\t\t\t</soho-toolbar-flex>\r\n\t\t</soho-header>\r\n\t`\r\n})\r\nexport class TitlebarComponent implements OnInit, AfterViewInit {\r\n\r\n\t@Input() manifest: IJsonDesignerManifest;\r\n\r\n\t@ViewChildren(SohoPersonalizeDirective)\r\n\tprivate queryList: QueryList<SohoPersonalizeDirective>;\r\n\tprivate personalize: SohoPersonalizeDirective;\r\n\r\n\tthemes: SohoTheme[];\r\n\r\n\tngOnInit(): void { }\r\n\r\n\tngAfterViewInit(): void {\r\n\r\n\t\tthis.personalize = this.queryList.first;\r\n\r\n\t\tthis.themes = this.personalize.themes();\r\n\t\tthis.personalize.theme = this.getCurrentTheme();\r\n\t}\r\n\r\n\tprivate getCurrentTheme(): string {\r\n\r\n\t\t// tslint:disable:no-magic-numbers\r\n\t\tswitch (this.manifest.defaultTheme) {\r\n\t\t\tcase ThemeEnum.DARK:\r\n\t\t\t\treturn this.themes[1].id;\r\n\t\t\tcase ThemeEnum.HIGH_CONTRAST:\r\n\t\t\t\treturn this.themes[2].id;\r\n\t\t\tcase ThemeEnum.LIGHT_TRANSPARENT:\r\n\t\t\t\treturn this.themes[3].id;\r\n\t\t\tcase ThemeEnum.DARK_TRANSPARENT:\r\n\t\t\t\treturn this.themes[4].id;\r\n\t\t\tcase ThemeEnum.DEFAULT:\r\n\t\t\tcase ThemeEnum.LIGHT:\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.themes[0].id;\r\n\t\t}\r\n\t\t// tslint:enable:no-magic-numbers\r\n\t}\r\n\r\n\tonChangeTheme(event: SohoChangeThemePersonalizeEvent): void {\r\n\t\tconsole.info(event);\r\n\t}\r\n}\r\n"],"sourceRoot":""}