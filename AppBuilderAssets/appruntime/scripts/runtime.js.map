{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../app-builder/common/constants/common.constant.ts","webpack:///../appbuilder/common/angular-constants.ts","webpack:///../appbuilder/common/helper.ts","webpack:///../appbuilder/components/services/framework-service.ts","webpack:///../appbuilder/common/sohoxi/utils.ts","webpack:///../app-builder/common/enums/value-type.enum.ts","webpack:///../appbuilder/components/component.ts","webpack:///../app-builder/common/enums/size-type.enum.ts","webpack:///../appbuilder/common/services/dialog-service.ts","webpack:///../app-builder/common/model/databearer/components/json-component.model.ts","webpack:///../app-builder/common/model/databearer/json-binding.model.ts","webpack:///../app-builder/common/enums/binding-type.enum.ts","webpack:///../appbuilder/common/defines.ts","webpack:///../app-builder/common/constants/interaction-defines.constant.ts","webpack:///../app-builder/common/project/backward-compatible.ts","webpack:///../appbuilder/common/services/http-service.ts","webpack:///../app-builder/common/model/databearer/dataservice/json-datasource.model.ts","webpack:///../app-builder/common/constants/sohoxi.constant.ts","webpack:///../appbuilder/common/error-response.ts","webpack:///../app-builder/common/model/databearer/json-manifest.model.ts","webpack:///../appbuilder/common/services/common-service.ts","webpack:///../appbuilder/common/IComponent.ts","webpack:///../appbuilder/common/services/language-service.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/etc-assets/user-control-es.ts","webpack:///../app-builder/common/enums/datasource-type.enum.ts","webpack:///../app-builder/common/enums/http-verb.enum.ts","webpack:///../appbuilder/common/debugger.ts","webpack:///../appbuilder/common/model/datasource/datasource.model.ts","webpack:///../app-builder/common/enums/orientation.enum.ts","webpack:///../appbuilder/common/services/feature-switch-service.ts","webpack:///../appbuilder/common/instance-event.ts","webpack:///../appbuilder/components/services/datasource-service.ts","webpack:///../app-builder/common/model/sohoxi/sohoxi-datagrid.model.ts","webpack:///../app-builder/common/model/components/settings/component-setting-category.model.ts","webpack:///../appbuilder/components/helper.ts","webpack:///../app-builder/common/project/manifest/designer-manifest.ts","webpack:///../app-builder/common/enums/parameter-type.enum.ts","webpack:///../app-builder/common/model/dataservice/parameter-object.model.ts","webpack:///../app-builder/common/project/project-info.ts","webpack:///../app-builder/common/model/databearer/json-tag.model.ts","webpack:///../app-builder/common/model/databearer/json-layout-component.model.ts","webpack:///../appbuilder/components/defines.ts","webpack:///../appbuilder/components/layout-component.ts","webpack:///./model/project-settings.ts","webpack:///./administration/services/administration-service.ts","webpack:///../appbuilder/components/services/ion-api-service.ts","webpack:///../appbuilder/common/shared-components/base/feature-switch-ctrl.ts","webpack:///../app-builder/common/model/dataservice/list-data-item.model.ts","webpack:///../app-builder/common/model/dataservice/meta-data.model.ts","webpack:///../app-builder/common/helpers/date.helper.ts","webpack:///../appbuilder/common/services/tag-service.ts","webpack:///../appbuilder/common/shared-components/base/field-validation.ts","webpack:///../appbuilder/common/sohoxi/datagrid-helper.ts","webpack:///./model/project-role.ts","webpack:///../appbuilder/common/services/hash-service.ts","webpack:///../appbuilder/common/services/conflict-resolution-service.ts","webpack:///../app-builder/common/project/mashup.ts","webpack:///../app-builder/components/interaction/interaction.ts","webpack:///../app-builder/common/enums/http-accept-enum.ts","webpack:///../app-builder/common/model/components/settings/component-field-setting.model.ts","webpack:///../app-builder/common/model/databearer/json-interaction.model.ts","webpack:///../appbuilder/common/project/datasource/datasource.ts","webpack:///../appbuilder/common/services/mingle-service.ts","webpack:///../app-builder/common/model/databearer/components/json-datagrid.model.ts","webpack:///../appbuilder/components/application-parent.ts","webpack:///../appbuilder/runtime/runtime-service.ts","webpack:///./app.state.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src lazy namespace object","webpack:///./app.ts","webpack:///../appbuilder/components/module.ts","webpack:///../app-builder/common/model/ion-api/ion-api.model.ts","webpack:///../appbuilder/common/dialogs/export/export-dialog.ts","webpack:///../appbuilder/common/services/theme-service.ts","webpack:///../appbuilder/components/services/local-ido-service.ts","webpack:///../app-builder/common/model/interaction/interaction.model.ts","webpack:///../app-builder/common/model/interaction/interaction-parameter.model.ts","webpack:///../appbuilder/common/project/datasource/generic2.ts","webpack:///../app-builder/common/helpers/json.helper.ts","webpack:///../appbuilder/common/services/expression-service.ts","webpack:///../app-builder/common/project/manifest/runtime-manifest.ts","webpack:///../app-builder/common/enums/infor-owned.enum.ts","webpack:///../app-builder/common/model/project/mashup/designer-manifest.model.ts","webpack:///../app-builder/common/model/databearer/components/json-lookup.model.ts","webpack:///../app-builder/common/model/project/boundary.model.ts","webpack:///../appbuilder/components/flexbox/flexbox.ts","webpack:///../appbuilder/components/tabs/tabs.ts","webpack:///../appbuilder/components/services/translation-management-service.ts","webpack:///../app-builder/common/project/runtime-app.ts","webpack:///./apphub/services/hub-service.ts","webpack:///./administration/services/save-service.ts","webpack:///../app-hub/ng2.component.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/polyfill.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/etc-assets/assets.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/etc-assets/UserControl.js","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/etc-assets/infor-companyon-client.js","webpack:///../main.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/ids-assets/module.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/ids-assets/svg/ids-svg.component.ts","webpack:///D:/Program Files (x86)/Jenkins/workspace/APPBUILDER-MONGOOSE-CLIENT-2-BUILD/server/server-gar/src/main/resources/modules/ids-assets/svg/eir-svg.html","webpack:///../appbuilder/common/module.ts","webpack:///../appbuilder/common/filters.ts","webpack:///../appbuilder/common/dialogs/add-string/add-string.ts","webpack:///../appbuilder/common/services/http-utils.ts","webpack:///../appbuilder/common/dialogs/import-conflict/conflict-decision-dialog.ts","webpack:///../appbuilder/common/dialogs/import-conflict/conflict-decision-dialog.html","webpack:///../appbuilder/common/dialogs/import-error/import-error-dialog.ts","webpack:///../appbuilder/common/dialogs/import/import-dialog.ts","webpack:///../appbuilder/common/dialogs/licenses/licenses-button.ts","webpack:///../app-builder/common/project/manifest/file-metadata.ts","webpack:///../app-builder/components/interaction/interaction-parameter.ts","webpack:///../app-builder/common/model/interaction/available-target-field.model.ts","webpack:///../app-builder/common/helpers/data-service.helper.ts","webpack:///../appbuilder/common/project/datasource/inline-list.ts","webpack:///../appbuilder/common/project/datasource/local-ido.ts","webpack:///../appbuilder/common/project/datasource/mongoose.ts","webpack:///../appbuilder/common/dialogs/licenses/licenses-dialog.ts","webpack:///../appbuilder/common/dialogs/test-dataservice/test-dataservice-dialog.ts","webpack:///../appbuilder/components/datagrid/datagrid-export-dialog-ctrl.ts","webpack:///../appbuilder/common/after-repeat-directive.ts","webpack:///../appbuilder/common/drag-directive.ts","webpack:///../appbuilder/common/helpers/infinite-scroll.ts","webpack:///../appbuilder/common/initialize-directive.ts","webpack:///../appbuilder/common/shared-components/dropdown-field/dropdown-field-component.ts","webpack:///../appbuilder/common/shared-components/base/notifiable-component.ts","webpack:///../appbuilder/common/shared-components/dropdown-field/dropdown-template.html","webpack:///../appbuilder/common/shared-components/filter-popupmenu/filter-popupmenu-component.ts","webpack:///../appbuilder/common/shared-components/filter-popupmenu/filter-popupmenu-ctrl.ts","webpack:///../appbuilder/common/shared-components/filter-popupmenu/filter-popupmenu-template.html","webpack:///../appbuilder/common/shared-components/filter-tag-dropdown/filter-tag-component.ts","webpack:///../appbuilder/common/shared-components/filter-tag-dropdown/filter-tag-ctrl.ts","webpack:///../appbuilder/common/shared-components/filter-tag-dropdown/filter-tag-template.html","webpack:///../appbuilder/common/shared-components/filter-toolbar/filter-toolbar.ts","webpack:///../appbuilder/common/shared-components/filter-toolbar/filter-toolbar.html","webpack:///../appbuilder/common/shared-components/input-field/input-field-component.ts","webpack:///../appbuilder/common/shared-components/input-field/input-field-template.html","webpack:///../appbuilder/common/shared-components/paginator/paginator-component.ts","webpack:///../appbuilder/common/shared-components/paginator/paginator-ctrl.ts","webpack:///../appbuilder/common/shared-components/paginator/paginator-template.html","webpack:///../appbuilder/common/shared-components/project-tags/project-tags-component.ts","webpack:///../appbuilder/common/shared-components/project-tags/project-tags-component.html","webpack:///../appbuilder/common/shared-components/sort-popupmenu/sort-popupmenu-component.ts","webpack:///../appbuilder/common/shared-components/sort-popupmenu/sort-popupmenu-ctrl.ts","webpack:///../appbuilder/common/shared-components/sort-popupmenu/sort-popupmenu-template.html","webpack:///../appbuilder/common/shared-components/tag-dropdown/tag-dropdown-component.ts","webpack:///../appbuilder/common/shared-components/tag-dropdown/tag-dropdown-component.html","webpack:///../appbuilder/common/shared-components/textarea-field/textarea-field-component.ts","webpack:///../appbuilder/common/shared-components/textarea-field/textarea-field-ctrl.ts","webpack:///../appbuilder/common/shared-components/textarea-field/textarea-field-template.html","webpack:///../appbuilder/common/sohoxi/component/about-directive.ts","webpack:///../appbuilder/common/sohoxi/component/application-menu-directive.ts","webpack:///../appbuilder/common/sohoxi/component/arrange-directive.ts","webpack:///../appbuilder/common/sohoxi/component/autocomplete-directive.ts","webpack:///../appbuilder/common/sohoxi/component/busy-directive.ts","webpack:///../appbuilder/common/sohoxi/component/button-directive.ts","webpack:///../appbuilder/common/sohoxi/component/colorpicker-directive.ts","webpack:///../appbuilder/common/sohoxi/component/control-directive.ts","webpack:///../appbuilder/common/sohoxi/component/datagrid-directive.ts","webpack:///../appbuilder/common/sohoxi/custom-formatters.ts","webpack:///../appbuilder/common/sohoxi/locale-helper.ts","webpack:///../appbuilder/common/sohoxi/component/datepicker-directive.ts","webpack:///../appbuilder/common/sohoxi/component/dropdown-directive.ts","webpack:///../appbuilder/common/sohoxi/component/editor-directive.ts","webpack:///../appbuilder/common/sohoxi/component/fileupload-directive.ts","webpack:///../appbuilder/common/sohoxi/component/listview-directive.ts","webpack:///../appbuilder/common/sohoxi/component/lookup-directive.ts","webpack:///../appbuilder/common/sohoxi/component/mask-directive.ts","webpack:///../appbuilder/common/sohoxi/component/multiselect-directive.ts","webpack:///../appbuilder/common/sohoxi/component/popover-directive.ts","webpack:///../appbuilder/common/sohoxi/component/popupmenu-directive.ts","webpack:///../appbuilder/common/sohoxi/component/search-field-directive.ts","webpack:///../appbuilder/common/sohoxi/component/slider-directive.ts","webpack:///../appbuilder/common/sohoxi/component/spinbox-directive.ts","webpack:///../appbuilder/common/sohoxi/component/tabs-directive.ts","webpack:///../appbuilder/common/sohoxi/component/textarea-directive.ts","webpack:///../appbuilder/common/sohoxi/component/timepicker-directive.ts","webpack:///../appbuilder/common/sohoxi/component/toolbar-directive.ts","webpack:///../appbuilder/common/sohoxi/component/tooltip-directive.ts","webpack:///../appbuilder/common/sohoxi/component/trackdirty-directive.ts","webpack:///../appbuilder/common/sohoxi/component/validate-directive.ts","webpack:///../app-builder/common/model/components/custom-component-definition.model.ts","webpack:///../app-builder/common/model/databearer/components/json-custom-component-def.model.ts","webpack:///../app-builder/common/project/designer-mashup.ts","webpack:///../app-builder/common/model/questions/questions.enum.ts","webpack:///../appbuilder/components/button/button.ts","webpack:///../appbuilder/components/button/button.html","webpack:///../appbuilder/components/chart/chart.ts","webpack:///../app-builder/common/model/databearer/components/json-chart.model.ts","webpack:///../appbuilder/components/chart/chart.html","webpack:///../appbuilder/components/checkbox/checkbox.ts","webpack:///../appbuilder/components/checkbox/checkbox.html","webpack:///../appbuilder/components/datagrid/datagrid.ts","webpack:///../appbuilder/components/datagrid/datagrid-export-dialog.html","webpack:///../appbuilder/components/datagrid/datagrid.html","webpack:///../appbuilder/components/datepicker/datepicker.ts","webpack:///../appbuilder/components/datepicker/datepicker.html","webpack:///../appbuilder/components/dropdown/dropdown.ts","webpack:///../appbuilder/components/dropdown/dropdown.html","webpack:///../appbuilder/components/flexbox/flexbox.html","webpack:///../appbuilder/components/hyperlink/hyperlink.ts","webpack:///../appbuilder/components/hyperlink/hyperlink.html","webpack:///../appbuilder/components/image/image.ts","webpack:///../appbuilder/components/image/image.html","webpack:///../appbuilder/components/label/label.ts","webpack:///../app-builder/common/constants/colors.constant.ts","webpack:///../appbuilder/components/label/label.html","webpack:///../appbuilder/components/list/list.ts","webpack:///../appbuilder/components/list/list.html","webpack:///../appbuilder/components/lookup/lookup.ts","webpack:///../appbuilder/components/lookup/lookup.html","webpack:///../appbuilder/components/radiobutton/radiobutton.ts","webpack:///../appbuilder/components/radiobutton/radiobutton.html","webpack:///../appbuilder/components/tabs/tab-panel.ts","webpack:///../appbuilder/components/tabs/tabs.html","webpack:///../appbuilder/components/tabs/tab-panel.html","webpack:///../appbuilder/components/textarea/textarea.ts","webpack:///../appbuilder/components/textarea/textarea.html","webpack:///../appbuilder/components/textbox/textbox.ts","webpack:///../app-builder/common/model/databearer/components/json-textbox.model.ts","webpack:///../appbuilder/components/textbox/textbox.html","webpack:///../appbuilder/components/timepicker/timepicker.ts","webpack:///../appbuilder/components/timepicker/timepicker.html","webpack:///../appbuilder/common/interface/itabs-component.ts","webpack:///../appbuilder/common/model/component/radiobutton.model.ts","webpack:///../appbuilder/common/model/component/tabs.model.ts","webpack:///../app-builder/common/model/databearer/components/json-flexbox.model.ts","webpack:///../appbuilder/designer/editor/component-settings/valuesource-settings/translation-dialog.html","webpack:///../appbuilder/common/dialogs/add-string/add-string.html","webpack:///../appbuilder/components/services/ion-metadata-service.ts","webpack:///../appbuilder/components/component-helper.ts","webpack:///../appbuilder/components/children-directive.ts","webpack:///../appbuilder/components/component-common.ts","webpack:///../appbuilder/components/component-common.html","webpack:///../appbuilder/components/component-directive.ts","webpack:///../appbuilder/components/titlebar/titlebar.ts","webpack:///../appbuilder/components/titlebar/titlebar.html","webpack:///../appbuilder/runtime/module.ts","webpack:///../appbuilder/runtime/app-launcher.component.ts","webpack:///../appbuilder/runtime/runtime-canvas-directive.ts","webpack:///../appbuilder/runtime/runtime-canvas.html","webpack:///./apphub/apphub.ts","webpack:///./apphub/apphub.html","webpack:///./component-value-directive.ts","webpack:///./administration/administration.ts","webpack:///../app-builder/common/model/databearer/components/json-composite-component.model.ts","webpack:///../appbuilder/common/dialogs/import-error/import-error-dialog.html","webpack:///./administration/administration.html","webpack:///./administration/feature-catalog/feature-catalog.ts","webpack:///./administration/feature-catalog/feature-catalog.html","webpack:///./assets/images/02-thumb.png","webpack:///./administration/admin-app-card/admin-app-card.ts","webpack:///../appbuilder/common/dialogs/export/export-dialog.html","webpack:///./administration/admin-app-card/admin-app-card.html","webpack:///./administration/admin-sidebar/add-roles-dialog/add-roles-dialog.ts","webpack:///./administration/admin-sidebar/admin-sidebar.ts","webpack:///./administration/admin-sidebar/version-dialog/version-dialog.html","webpack:///./administration/admin-sidebar/url-value-dialog/url-value-dialog.html","webpack:///./administration/admin-sidebar/add-roles-dialog/add-roles-dialog.html","webpack:///./administration/admin-sidebar/admin-sidebar.html","webpack:///./administration/admin-sidebar/url-value-dialog/url-value-dialog.ts","webpack:///./administration/admin-sidebar/version-dialog/version-dialog.ts","webpack:///./dev/developer-tool-component.ts","webpack:///./dev/developer-tool-ctrl.ts","webpack:///./dev/developer-tool-template.html","webpack:///../app-hub/app.module.ts","webpack:///../app-hub/app.states.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","6","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","p","jsonpArray","window","oldJsonpFunction","slice","CanvasModeEnum","AppStatus","DashboardStates","DashboardViewStates","ReplaceEnum","availableDatasourceTypes","DatasourceTypeEnum","IDM","M3","MONGOOSE","generic","INLINE_LIST","Numbers","ITEM_ID","RECORD_DATE","ROW_POINTER","IdoProperties","BuildEnvTypes","AppEnvTypes","ChartTypeEnum","ProjectLayout","DatagridPageSizesEnum","ColumnFormatterType","HorizontalAlignmentEnum","DirectionEnum","ThemeEnum","FlexSizeTypeEnum","FlexOverflowEnum","WizardFocusEnum","AlignmentEnum","SortEnum","SaveFlagsEnum","SaveProjectSettingEnum","MGPlatform","ION_PROXY","ION_TOKEN","LAUNCH_WITH_ANGULAR","DeveloperConstants","ProjectTypeEnum","APP_ROOT","REST_ROOT","APP_BUILDER_ROOT","APP_BUILDER_REST_ROOT","APP_RUNTIME_ROOT","APP_RUNTIME_REST_ROOT","ION_API_ROOT","ION_API_URL","ION_API_TOKEN","localStorage","getItem","ION_API_PROXY_PORT","TENANT_ID","IS_DEV","IS_BASE_BUILDER","IS_FIRST_LOAD","IS_CONFIG_LOADED","MAX_PROJECTS","MAX_DATASOURCES","MAX_COMPOSITES","MAX_APPS","RUN_PATH","RUN_ROOT","Config","RUN_RUNTIME_ROOT","MG_FORM_NAME","MG_FORM_ONLY","MG_PLATFORM","MG_CONFIG_NAME","MG_HELP_BASE_URL","PROJECT","ADMINISTRATION","RUNTIME","SETTINGS","SWITCHABLE_FEATURES","REPOSITORY","COMPOSITE_COMPONENTS","DATASOURCES","IDO","LOCAL_IDO","DESIGNER","ADMIN","ServerPaths","AppTypeEnum","SOURCE","TARGET","SettingTypes","STATIC","CONTEXT","URL","BindingTypes","CLICK","DRAGEND","DRAGLEAVE","DRAGOVER","DRAGSTART","DROP","KEYDOWN","KEYUP","MOUSEUP","EventTypes","DISPLAY","POINTER_EVENTS","CURSOR","BACKGROUND_COLOR","CssConstantKeys","CURSOR_NODROP","CURSOR_POINTER","AUTO","NONE","INLINE_BLOCK","CssConstantValues","EQUALS","NOT_EQUALS","GREATER","SAME_GREATER","LOWER","SAME_LOWER","INCLUDES","Operators","ALL","DISABLE","HIDE","ConditionType","MOVE","COPY","InsertEventTypes","SMALL","LARGE","ComponentSizeTypes","COPY_SUFFIX","ComponentConstants","HORIZONTAL","VERTICAL","PAGE","OrientationTypes","CONTENT","INTERACTION","STYLE","SidebarTabTypes","CHECKBOX","DROPDOWN","MARGIN","BORDER","NUMBER","RADIO","SWITCH","TEXT","COLOR_PICKER","SettingInputKeys","ADMINISTRATION_SERVICE","APP_ENV_CONSTANT","BINDING_MANAGEMENT_SERVICE","BOUNDARY_MANAGEMENT_SERVICE","BUILD_ENV_CONSTANT","COMMON_SERVICE","COMPOSITE_COMPONENT_MANAGEMENT_SERVICE","CONFLICT_RESOLUTION_SERVICE","DATASOURCE_SERVICE","DESIGNER_COMPONENT_SERVICE","DESIGNER_SERVICE","DIALOG_SERVICE","EDITOR_SERVICE","EXPRESSION_SERVICE","FEATURE_SWITCH_SERVICE","FRAMEWORK_SERVICE","HASH_SERVICE","HOTKEY_SERVICE","HTTP_SERVICE","HUB_SERVICE","INSERT_COMPONENT_SERVICE","INTERACTION_MANAGEMENT_SERVICE","ION_API_SERVICE","ION_METADATA_SERVICE","LANGUAGE_SERVICE","LOCAL_IDO_SERVICE","MINGLE_SERVICE","NO_CACHE_INTERCEPTOR","PROJECT_SERVICE","REPOSITORY_SERVICE","RUNTIME_SERVICE","SAVE_SERVICE","TAG_SERVICE","THEME_SERVICE","TRANSLATION_MANAGEMENT_SERVICE","UNDO_SERVICE","InjectNames","ROOT_COMPONENT","DATASOURCE","CUSTOM_COMPONENT","TRANSLATIONS","ProjectFileKeys","InteractionActionEnum","InteractionTriggerEnum","COMPONENT","MimeTypes","DETAIL_RESULT","LIST_RESULT","ContextKeys","DirectionType","FeatureIdEnum","DEFAULT_BOUNDARY","id","displayName","HEIGHT","VISIBILITY","WIDTH","SHOW_ERROR","SIZE","SIZE_TYPE","ORIENTATION","ALIGNMENT_HORIZONTAL","ALIGNMENT_VERTICAL","OVERFLOW","ITEM_TEMPLATE","KEEP_SELECTED","SEARCH","CHART_VIEW","CHART_TYPE","CHART_LEGEND_DISPLAY","CHART_STARTUP_ANIMATION_ENABLE","CHART_TITLE","CHART_AXIS_CATEGORY_TITLE","CHART_AXIS_CATEGORY_UNITS","CHART_AXIS_VALUES_TITLE","CHART_AXIS_VALUES_UNITS","LOOKUP_OUTPUT_ID","IS_RESIZABLE","MAX_LENGTH","ROW_HEIGHT","USE_PAGING","PAGE_SIZE","SUMMARY_ROW","ROW_COUNT","FILTER_BAR","ENABLE_EXPORT","ROW_COUNT_OUTPUT","SUMMARY_OUTPUT","DATE_FORMAT_SHOW","DATE_FORMAT_BINDING","DATE_FORMAT_INPUT","DATE_FORMATTED","DATE_VALUE","DATE_TODAY","BOX_WIDTH","TIME_FORMAT","ENABLE_SECONDS","TIME_VALUE","LANGUAGE","LANGUAGE_SHORT","USER_NAME","USER_DESCRIPTION","TIMESTAMP","APPLICATION_HEADER","BORDER_COLOR","CHECK_STATE","COLOR","CURRENT_ITEM","CURRENT_ITEM_NAME","CURRENT_ITEM_VALUE","DISPLAY_VALUE","DIRECTION","FONT_STYLE","FONT_CHAR","IS_DEFAULT","IS_DRILLBACK","IS_LIST","IS_READONLY","LABEL","LINK_VALUE","MULTI_SELECT","PLACEHOLDER","POSITION","SELECTED_ITEM","DIRTY_ITEMS","SHOW_LABEL","TOOLTIP","SettingKeys","FORMAT_1","FORMAT_2","FORMAT_3","FORMAT_4","ISO8601","AUTOMATIC","RAW","DateFormat","SUPPORTED_LANGUAGES","DEFAULT","LanguageConsts","ONE","FIVE","TEN","FIFTEEN","MinInterval","TWELVE","TWENTYFOUR","HourMode","PRIMARY","SECONDARY","TERTIARY","FILL","ButtonStyle","VALUE","SubstitutionTags","TARGET_CONTEXT","STATIC_VALUE","URL_VALUE","ValueObject","CLEAR","GET","LIST","ON_LOAD","ON_ITEM_CHANGED","CURRENT_ITEM_CHANGED","ON_ITEM_UPDATED","CURRENT_ITEM_UPDATED","ON_STARTUP","STARTUP","ON_CLOSE","CLOSE","ON_CLICK","ON_CHANGED","CHANGED","IS_CHECKED","CHECKED","IS_UNCHECKED","UNCHECKED","SET_CURRENT_ITEM","InteractionPairOperation","SHORT","MEDIUM","TALL","RowHeight","DATE_TIME","STRING","PASSWORD","MaskProcess","ImagePositions","MarginType","BorderType","ImageBase64","ListTemplateIdEnum","this","maxDatasource","maxCompositeComponent","errorMessage","item","importErrorMessage","MAX_BOUNDARIES","ProjectLimit","CONTACT_SYSTEM_ADMIN","GENERIC_ERROR","UNABLE_TO_UNZIP_ERROR","GENERIC_ID_ERROR","PROJECT_ID_CONFLICT","PROJECT_DISPLAYNAME_CONFLICT","PROJECT_IMPORT_ERROR","DATA_SERVICE_ERROR","Subcodes","success","StatusCodes","DATA_SERVICE","COMPOSITE_COMPONENT","FileExtensions","CSSClasses","ElementDataKeys","EDITOR_COMPONENT_PREFIX","ComponentClassNames","SHOW_OPEN_FILE_DIALOG","SHOW_SAVE_FILE_DIALOG","TOKEN","APPBUILDER_REST","ABFormScriptMethod","GLOBALSTRING","EMAIL","SPECIAL_CHARACTERS","NUMERIC","NO_NUMERIC","NUMERIC_NO_NEGATIVE","NEW_LINES","STARTS_WITH_NUMBER","NO_SPECIAL","TIME","FIRST_CHAR_LETTER","RegexStrings","GridAggregators","SummaryTextPlacement","TextAlignment","EXCEL","CSV","DatagridExportTypes","file","boolean","date","decimal","integer","string","IdoDataType","Chart","Datagrid","Dropdown","Flexbox","List","Lookup","RadioButton","Tabs","TabPanel","TextBox","ComponentNames","CACHE_FACTORY","COMPILE","CONTROLLER","DESTROY","ELEMENT","FILTER","HTTP","INTERVAL","Q","ROOT_SCOPE","ROUTE","SCOPE","STATE_PARAMS","STATE_SERVICE","TEMPLATE_CACHE","TIMEOUT","WINDOW","AngularConstants","RegExpMatchCandidate","getFormattedDate","format","Date","year","getFullYear","formattedMonth","getMonth","toString","padStart","formattedDay","getDate","formattedHour","getHours","formattedMinute","getMinutes","formattedSecond","getSeconds","formattedMilleSecond","getMilliseconds","become","obj","newClass","__proto__","getDeepValue","paths","path","split","len","isUndefinedOrNull","setDeepValue","newValue","secondToLast","stringReplace","str","context","replace","match","$1","$2","trimmed","exec","getStringParameters","map","hit","isUndefined","anyObject","isFloat","isInt","Number","random","stringLength","chars","randomstring","rnum","Math","floor","substring","isUndefinedEmpty","getListByRegex","regex","myString","cleanedString","createQueryParameters","values","join","deepObjectTrim","objectToTrim","deepTrim","keys","forEach","trim","getListFromMap","list","arrayList","concat","sortObjectByProperty","reverse","output","sort","a","b","sortObjectKeys","unordered","doNotSortKey","ordered","sortedKeys","indexOf","unshift","objectHasValue","some","objectHasKey","exceedAllowed","limit","listA","listB","numberOfNewDatasource","wrapKeyInBrackets","wrapInBrackets","sanitizedSourceKey","cleanNulls","propName","undefined","Helper","cleanTemplateLiteral","templateLiteral","htmlEncode","$","text","html","htmlDecode","isMobile","test","navigator","userAgent","generateUniqueId","getTime","MILLION","generateNewDisplayName","oldDisplayName","conflictingCandidates","newDisplayName","splitCopyNumber","oldDisplayNameBase","numbers","filter","maybeString","conflictCandidate","matches","candidateBaseName","BASE_NAME","candidateIsCopy","Boolean","IS_COPY","candidateNumber","parseInt","pop","getListNames","items","itemNames","getProposedNewDisplayName","projectName","projects","exceptID","proposedName","recursiveInnerFunction","counter","index","manifest","joinWithDefauldEmptyString","stringArray","joinChar","appIsReadyForSelenium","element","mashupRootContainer","isMashupReady","parseQueryString","query","rPlus","rQueryParameter","decode","uriEncodedText","decodeURIComponent","urlParams","trimIfPossible","isSafari","myWindow","isChrome","chrome","webstore","HTMLElement","webkitAudioContext","isEdge","isIE","document","documentMode","convertBase64ToSaveableBlob","base64String","type","byteString","atob","arrayBuffer","ArrayBuffer","ia","Uint8Array","charCodeAt","SmartBlob","getBase64FileExtension","toUpperCase","parseBase64","isDifferent","array1","array2","compare","x","y","removeItemFromListByIndex","instanceOfLayoutComponent","instanceOfListComponent","isFirstCharLetter","blobParts","smartBlob","Blob","saveAs","fileName","msSaveOrOpenBlob","createObjectURL","createElement","href","download","body","appendChild","click","setTimeout","removeChild","revokeObjectURL","$window","$compile","$q","$timeout","$cacheFactoryService","commonService","datasourceService","languageService","translationManagementService","mingleService","expressionService","dialogService","datasourceChangedEvent","InstanceEvent","activeBindings","currentCanvasThemeChangedEvent","projectSettingsChangedEvent","currentBoundaryChangedEvent","on","newBoundary","rootComponent","getCurrentRootComponentInstance","newBoundaryEntered","openComponentDialog","options","show","createLanguageComponentFromOldComponents","currentManifest","getCurrentProject","getManifest","createGeneralLanguageComponent","getId","title","raise","forEachChild","componentInstance","forEachBindable","binding","currentValueSource","valueType","ValueTypeEnum","LOCALIZED_STRING","ref","getTypedef","componentTabs","tab","radioButtons","radiobutton","datagridOptions","columns","column","openWindow","url","open","getCurrentLanguage","getSelectedLocale","getTranslatableStringByProperty","componentId","setTranslatableStringByProperty","updatedValue","sendDrillbackMessage","message","getGlobalValue","component","stringValue","cleanedValue","globalValue","getGlobalString","openNewStringDialog","then","button","DialogButtonType","Ok","addGlobalString","initializeBindings","getTranslatableHeaderString","getUrlMetaData","setUrlMetaData","newUrlMetaData","generateUrlMetaData","project","getUrlValue","sourceKey","find","currentValue","getTimeout","getProjectCacheObject","cacheId","getCacheObject","cacheObject","removeCacheObject","destroy","checkIfListTemplate","fn","Defines","allComponents","typedef","class","BINDABLE_FIELDS_2","field","forEachComponent","parent","isLayoutComponent","children","child","getNextProjectBoundary","boundaryId","projectBoundaries","mashupBoundaries","limitX","triggerExpressions","components","getAllComponentInstances","trigger","setCanvasTheme","theme","isDesigner","getCurrentBoundary","getTranslatableFieldDisplayName","reference","getComponentInstance","findIndex","getBindableDisplayName","includes","getDatabearer","bindables","maybeDefinition","bindableDefinition","fromRoot","recursive","foundChild","getComponentInstances","attrName","attrValue","getCustomComponentDefinition","customId","getCustomComponentDefinitions","getNewDeferred","defer","isRuntimeMode","container","hasClass","getDatasource","datasourceId","getDatasourceObject","datasourceInstance","datasourceObject","parseDatasourceToTS","readParameters","parameters","parameter","readValueSource","valueSource","multipleValue","Type","BindingTypeEnum","targetKey","setParameter","sourceComponent","sourceName","applyValuesourceFormatter","BINDING","getValue","console","error","CONTEXT_BINDING","URL_BINDING","getActiveBinding","registerContextBinding","targetComponent","targetComponentScope","getScope","targetComponentId","isGenerated","generatedId","getContextBindingId","$watch","setBindableValue","$on","warn","getBindingId","valueSourceObject","registerBinding","valuesourceObject","sourceComponentId","sourceComponentKey","sourcePath","watchKey","onUpdateValue","source","triggerName","getInteractions","interaction","sourceTriggerName","runInteraction","targetName","targetActionName","loadInteraction","runStartupInteractions","ev","convertImageUrlToBase64","add","ngModule","service","FrameworkService","$inject","getData","Utils","databearer","$element","frameworkService","isVisible","isShowError","canCut","canCopy","datasource","usedBy","scope","isReadonly","updateClassesAndStyle","setGenerated","createCacheObject","canDelete","getDisplayName","is","classs","calcNewSizes","calcNewWidth","calcNewHeight","margin","getBoundarySetting","cssWidth","calcNewSize","OrientationEnum","left","right","cssHeight","top","bottom","sizeObject","orientation","retSize","hasIndividualChildSizes","sizeType","SizeTypeEnum","PERCENT","pxPerPercentComponent","getPxPerPercentComponent","HUNDRED","PIXELS","setBoundarySettingIfChanged","settingId","noTraverse","boundarySettings","componentBoundarySettings","getBindableValue","bindableReference","isTranslatableComponent","Image","updateClasses","removeClass","cssClasses","getClassList","addClass","updateInlineStyle","style","getInlineStyle","css","updateVisibility","updateShowError","classList","width","height","getGeneratingParent","getContext","resetLayout","setErrorTooltip","stopLoading","errorTooltip","startLoading","isLoading","deferred","dataserviceAction","isDataserviceAction","getParameters","getListData","listResult","ListResult","resolve","catch","errResponse","resetContext","reject","getDetailData","detailData","setDetailResultForGetAction","updateItemID","detailResult","DetailResult","refreshBindings","errorResponse","detail","runComponentAction","promise","finally","buildLink","link","sources","renderedLink","copy","valuesource","RegExp","alias","bindable","isBinding","isContextBinding","oldValue","generic2Databearer","method","HttpVerbEnum","PUT","itemIdParameter","inputParameters","interactionParameter","getParameter","bindableField","write","currentStringValue","getComponentTranslation","databearer2","localContext","extend","isOutputFile","outputParameters","clear","translationValue","forEachParent","getPredictedSize","sizePredicter","sizes","appendTo","append","clone","outerHeight","remove","forEachFieldSetting","SETTING_FIELDS","doGenerated","cache","settings","boundarySetting","inputType","defaultValue","icon","tooltip","dialog","Component","StandardDialogButtons","removePopupMenus","popupMenus","close","Util","$rootScope","dialogOptions","Dialog","modalScope","$new","eirDialog","contentTemplate","template","templateUrl","cssClass","draggable","compiledTemplate","hasHideOverlayOption","toggleOverlay","buttons","setSpecificButtons","unsubscribe","createAndOpenModal","each","idx","elem","setAttribute","getAttribute","modal","init","one","$destroy","hideOverlay","showContextualActionPanel","contextualactionpanel","content","showMessage","standardButtons","setDefaultButtons","hasPrimaryButton","isChildDialog","showError","isError","status","audibleLabel","showYesNo","YesNo","toggleClass","showToast","position","timeout","defaults","OkCancel","YesNoCancel","Cancel","isDefault","No","Yes","specificButtons","DialogService","canClose","modalParent","modalGrandParent","closeOnEscape","$event","keyCode","KeyCodeEnum","ESCAPE","off","closing","e","cancel","closed","opened","attr","getPromise","hide","EDITOR","ViewEnum","DASHBOARD","SOURCE_TRIGGERS","TARGET_ACTIONS","InteractionDefines","setDataServiceHeader","headers","Accept","HttpAcceptEnum","APPLICATION_JSON","tryUpdateUrlName","urlName","newUrlName","tryGetMask","mask","process","getShowLabel","defaultBoundary","showLabel","tryGetBoxWidth","tryUpdateButtonStyle","getHref","rowData","hyperlinkOptions","tryConvertLegacyChart","isLegacyChart","isLegacyChartType","chartType","newType","StackedColumn","ColumnStacked","Profile","StackedLine","Line","Bar","hasLegacyChartData","convertToNewChartFormat","legendDisplay","startupAnimationEnable","categories","category","newDataset","series","datasets","BackwardCompatible","http","q","getUrl","getBaseUrl","setOverrideUrl","overrideUrl","executeGet","resource","params","external","execute","executePost","POST","executePut","executeDelete","DELETE","executeRequest","requestConfig","debug","WSForm","JSON","stringify","onCompleted","response","httpResponse","ErrorResponse","executeHttp","upload","files","formFields","formData","FormData","transformRequest","identity","post","encodeURI","errorPayload","code","statusText","reduce","promises","all","outside","rawJson","parse","modifiedHttpResponse","logMessage","toJson","possibleReasons","reason","newStatusText","Debugger","isEnabled","HttpService","SelectableEnum","FormatterEnum","ColumnOptionEnum","DateFormatEnum","stack","httpService","themeService","onDuplicateProjectChangedEvent","urlMetaData","currentBoundary","loadProjects","loadActivatedApps","loadProject","projectId","canvasWidth","loadPublishedProject","locale","getLanguage","loadPublishedProjectNoConstraints","cleanOldDataservices","datasources","removeDatasource","info","loadEnvironmentSettings","loadDBVersions","loadLicensesHtml","loadApplicationVersion","unloadProject","currentProject","currentRootComponentInstance","setCurrentProject","newCurrentProject","updateTheme","defaultTheme","buildPrerequisites","mashup","updateCurrentBoundary","urlAlias","getUrlVariables","urlVar","getVarValue","sourceField","visibleName","sourceKeyShort","setCurrentBoundary","boundary","setCurrentRootComponentInstance","getCurrentTheme","currentCanvasTheme","newTheme","changeThemeCss","getBoundaryForWidth","location","hash","exportProjectContent","contentIds","filePath","saveFlagEnum","resourceName","getProjectContentResourcePath","WEB","filteredBase64","base64","contentType","Error","openHelp","CommonService","ionApiService","featureSwitchService","hashService","currentStrings","supportedLanguages","initializeLanguageSettings","loadSupportedLanguages","detectLanguage","loadSohoLocale","language","loadGlobalStrings","strings","Value","stringItem","savedValue","saveGlobalStrings","getCurrentStrings","fetchGlobalStrings","modifiedStrings","languageKey","globalString","Name","deleteGlobalStrings","deletedStrings","changeCurrentLanguage","localStorageValue","username","USER","setItem","urlSearchParams","search","getLanguageThroughSearchParams","getSupportedLanguages","isFeatureTranslationEnabled","getUrlLanguage","isValid","getMingleLanguage","getLocalStorageLanguage","LOCALE","getBrowserLanguage","isSupported","getDefaultLanguage","currentLanguage","Soho","Locale","getLocale","filename","$language","inforCurrentLanguage","supportedLanguage","isEqual","supportedLanguageKey","languages","hashedFilenames","getHashMap","mapFilenameToSupportedLanguages","cacheBustedFilenames","re","isMatch","fetchSupportedMingleLanguages","executeIonApiAsync","LanguageList","LanguageService","FeatureSwitchCtrl","MG","WSUserControl","DebugState","$routeParams","STORAGE_KEY","ENABLED","enable","disable","DISABLED","initialize","log","classObject","constructor","features","fetchFeatures","fetchedFeatures","feature","getFeatures","getFeature","isFeatureEnabled","enabled","toggleFeatureStatus","FeatureSwitchService","handlers","handler","h","$cacheFactory","localIdoService","getDeferred","localIdoRequest","inputParameterValues","updateIdoCollectionEntry","insertIdoCollectionEntry","deleteIdoCollectionEntry","getIdoCollection","ionApiRequest","urlPath","isBinaryResponse","def","responseType","ionApiResponse","FileReader","readAsText","onloadend","ionApiResponseError","FOUR_HUNDRED","SIX_HUNDRED","isBinary","readAsDataURL","datasourceDatabearer","version","Generic2","Mongoose","LocalIdo","InlineList","DatasourceService","instantiateComponent","parentInstance","instance","componentClass","getComponentDisplayName","className","clazz","isApplicationParent","ApplicationParent","nextNumber","names","highestNumber","lastNumberMatch","suffixNumber","sortComponentList","componentList","naturalCompare","ax","bx","_","Infinity","an","bn","nn","localeCompare","isBase64","base64Str","substr","generateId","prefix","occupiedStrings","idCounter","newId","possibleConflict","findItemIndexById","listResults","itemId","incrementIndex","previousItem","newItem","newIndex","getDefaultComponentSettingValue","settingCategories","componentFieldSetting","componentCategory","setting","truncate","maxlength","ComponentsHelper","arg1","arg2","fileMetaData","createdBy","createdByDisplayName","createdTime","lastChangedBy","lastChangedByDisplayName","lastChangedTime","urlVariables","description","previewImg","showTitleBar","themeSwitchEnabled","typeDef","LIGHT","setHasFile","fileKey","mimeType","FileMetaData","updateLastChangedInformation","newManifest","DesignerManifest","ParameterTypeEnum","projectInfo","tags","RuntimeManifest","ProjectInfo","available","Button","Checkbox","Datepicker","Hyperlink","Label","TextArea","Timepicker","addComponents","componentName","toLowerCase","directive","appendLinkFunction","$scope","LayoutComponent","componentReady","addChild","onChildrenReady","addChildInstance","getPadding","padding","ch","saveService","getIfsRoles","getProjectRoles","loadRuntimeProjects","listProjectVersions","exportProject","exportProjectId","exportFileName","exportResult","importProject","projectFilePath","appId","saveProjectSetting","projectSettings","parts","saveCurrent","activateProjectVersion","deleteRuntimeApp","getRepositoryProject","selectedVersion","AdministrationService","tenantId","token","setTenant","getToken","setToken","setUrl","getHeaderName","getHeaderValue","IonApiContext","getIonApiContextAsync","refresh","hasToken","ionApiContext","getIonBaseUrl","tokenURL","isDeveloperModeActive","proxyURL","executeIonApi","isRetry","contextUrl","HttpUtil","combine","m3Data","nrOfFailedTransactions","results","isUnauthorized","ionApiRetry","retryContext","retryError","IonApiService","featureService","isFeatureCatalogEnabled","ShowFeatureCatalog","datetime","datetimeParts","parseDate","pattern","time","milliseconds","parseFloat","isValidMillisecondTimestamp","MAX_TIMESTAMP","MIN_TIMESTAMP","isValidDate","isNaN","DateHelper","projectInfoChangedEvent","getAvailableTags","TagService","DEFAULT_INPUT_FIELD_NAME","parentAnnounce","isInvalid","$onInit","fieldName","validation","isRequired","validators","fieldValue","validate","$onChanges","changeObjects","isCallback","isFirstChange","currentComponentFieldError","fieldSpecificErrors","sharedError","errorList","previousValue","customValidator","validator","getError","validatorError","labelName","target","custom","onComponentChange","$data","callback","isValidationResult","removeFieldRelatedErrorsFromErrorList","sharedErrors","FieldValidation","getPage","dataset","pageRequest","total","pagesize","activePage","normalizeValue","sortDatasetByField","sortField","sortAsc","itemA","itemB","getSearchResultOnPaths","filterExpression","DatagridHelper","clearSohoProperties","deepValue","getSearchResultOnKeyword","isFiltered","_selected","_isFilteredOut","setEditableOnColumn","editable","editorOptions","formatterName","editor","Editors","Time","timeFormat","cultures","calendars","dateFormat","timestamp","minuteInterval","secondInterval","Datetime","showTime","Input","Textarea","Autocomplete","isEditable","setColumnSettings","textOverflow","Ellipsis","setFormatterOnColumns","formatter","Formatters","isChecked","jQuery","isNumeric","CustomFormatters","LocaleHelper","getDateFormat","Short","Integer","Decimal","Timeformat","Timestamp","SelectionCheckbox","AbsoluteValue","ToggleSummarizeOnColumn","summarize","summaryRowFormatter","aggregator","SummaryRow","SUM","convertDatetimeToTicks","selectedRow","calendar","oldDate","parseOption","setHours","setMinutes","setSeconds","setFullYear","setMonth","setDate","addColumnData","dataservice","autocompleteSource","listItem","listOptions","parameterId","label","lookupData","outputParam","lookupOptions","row","selectable","HashSources","HashSourceTypes","buildEnv","appEnv","DEV","getHashDataSrc","designerMapOfHashes","runtimeMapOfHashes","getHashFromMapOfHashes","srcString","hashSrc","formattedSrcString","getHashFromHashDataDesigner","getHashFromHashDataRuntime","getHash","newSrcString","err","getValueFromMapAndParseToMongooseAssetsPath","mapWithHashes","src","DESIGNER_HASH_SRC","RUNTIME_HASH_SRC","HashService","ConflictResolutionEnum","maxItems","newObjects","currentObjects","conflictKey","objectName","splitConflicting","conflictingObjects","conflicting","notConflicting","deferredResolutions","resolveNextConflict","resolutions","resolutionResult","applyResolutions","toAdd","toRemove","checkIfInvalidImportedItems","errorText","importedItems","oldObjects","newObject","existingObject","getConflictString","resolveConflictDialog","conflictedString","conflictCount","lastAction","remainingCount","REPLACE","deferredResolutionChoice","currentObject","nextIndex","dialogValue","resolution","action","newName","SKIP","sameForRemaining","resolvedCompositeComponents","valuesToRemove","objsToRemove","valueToRemove","ConflictResolutonService","interactions","customComponentDefinitions","compositeComponents","translations","expressions","setRoot","componentObject","getExpressions","getExpressionsByComponentId","expression","addExpression","deleteExpression","deletedExpression","removeExpression","saveExpression","savedExpression","expressionIndex","getDatasources","dsName","getDatasourceDatabearers","datasourceDatabearers","addDatasource","removedDataservice","getInteractionDatabearers","setInteractions","addInteraction","removeInteraction","toRemoveInteraction","addCustomComponentDefinition","customComponent","getCompositeComponents","addCompositeComponent","compositeComponent","getCompositeComponent","compositeId","cmp","removeCompositeComponent","compositeToDelete","getTags","setTags","setUrlVariables","variables","getBoundaries","setTranslations","getTranslations","getTranslationsList","translationList","getTranslation","removeTranslation","addTranslation","translation","setPreviewImage","base64Img","appType","manifestType","entry","newInteraction","Interaction","Mashup","InteractionParameter","param","addParameter","removeParameter","removeAllParameters","fillInParameters","extraParameters","ionApiParameter","Datasource","getLogicalId","logicalId","MingleService","DEFAULT_LID","setupMessageHandler","messageType","infor","companyon","client","registerMessageHandler","sendApplicationInitComplete","sendMessage","MESSAGETYPE_APPINITCOMPLETE","sendPrepareDrillbackMessage","sendBusinessContextMessage","appName","MESSAGETYPE_BUSINESSCONTEXT","getOriginatingTime","generateContextId","getDrillbackUrl","MESSAGETYPE_SHORTCUTCONTEXT","sendClearContextMessage","encodeURIComponent","MESSAGETYPE_CLEARCONTEXT","MESSAGETYPE_APPLICATIONDRILLBACK","MESSAGETYPE_FAVORITECONTEXT","currentTheme","languageShort","userName","userDescription","now","createSpoofedElement","resizableChildren","direction","ori","applicationParentDatabearer","read","DEFAULT_WIDTH","DEFAULT_HEIGHT","DEFAULT_TRIGGER","DEFAULT_ACTION","loadRuntimeProject","parseAndSetApp","loadPublishedProjectNoConstraint","instantiateDataservice","setCurrentUrlValues","urlDataset","urlData","lastIndexOf","jsonMashup","RuntimeApp","fromObj","RuntimeService","config","$stateProvider","$urlRouterProvider","state","HOME","APP_LAUNCHER","ADMIN_APP_LAUNCHER","DEVELOPER","otherwise","isFromAdmin","reloadOnSearch","$stateParams","ADMIN_PREVIEW","AppState","webpackEmptyAsyncContext","req","Promise","runtimeApp","upgradeModule","idsAssetsModule","componentsModule","runtimeModule","$qProvider","$compileProvider","errorOnUnhandledRejections","debugInfoEnabled","commentDirectivesEnabled","cssClassDirectivesEnabled","run","$state","onReady","App","doUnloadPrompt","initUrl","go","AppHubDirective","HubService","ComponentValueDirective","AdministrationDirective","FeatureCatalog","SaveService","AdminAppCard","AdminSidebar","AddRolesDialog","VersionDialogCtrl","UrlValueDialogCtrl","DeveloperToolComponent","commonModule","IonMetadataService","LocalIdoService","TranslationManagementService","ChildrenDirective","ComponentCommonDirective","ComponentDirective","TitlebarDirective","getFormattedFilename","formattedFilename","fileExtension","getFileExtension","defaultFilename","export","controller","ExportProjectCtrl","mainTheme","changeStylesheetPromises","updateCanvasCss","canvasTheme","cssUrl","linkId","getCssTheme","srcHashData","hashedString","bodyElement","LIGHT_TRANSPARENT","DARK_TRANSPARENT","linkElement","changeStylesheet","DARK","HIGH_CONTRAST","ThemeService","getIdoProjectList","getIdoCollectionList","pageNo","getIdoProperties","collectionName","recordCap","orderBy","filterQuery","parsedParameters","parseParameters","isTestIDO","initParameters","isValidUpsertRequest","parameterValues","parameterNames","targetInput","inputParameter","rowPointer","parameterType","QUERY","required","loadData","detailObject","resultToFormat","getVerifiedResult","outputRootElement","listObject","objectIdPath","getNonParsedData","setSubstitutionTags","bodyParameter","substitutionTag","requestBody","datasourceParameter","PATH","MATRIX","DataServiceHelper","getURLVariable","strToReplace","fullSubstitutionTag","charAt","BODY_PART","getRequestBody","relativeUrl","bodyParameters","schema","JsonHelper","generateSchema","getPropertyType","relativeUrlPath","suite","endpoint","bodyTemplate","ionApiCalls","ionapiParameter","inputparameter","ionApiCall","getMetaData","deferredMetaData","inputFields","outputFields","FLNM","FLDS","MAND","dataType","generateSample","swaggerDoc","tempSchema","$ref","definitions","getSchemaType","default","Array","isArray","sample","properties","getPropertyFormat","TypeError","propertyName","propertyNameMatch","jsonQuery","isCyclic","seenObjects","detect","fixCyclic","prettify","jsonString","spaces","isInvalidJsonPath","root","triggeredConditions","currentProjectComponents","isUsed","conditionType","sourceValue","sourceProperty","getExpressionValue","targetValue","targetProperty","runExpression","triggeredCondition","findComponent","clauseOperator","triggerCondition","targetString","sourceString","getExpressionComponentValue","componentDataservice","componentValue","componentBindableValue","usedByComponent","ExpressionService","InforOwnedEnum","isFlexParent","border","borderColor","updateIsFlexParent","isParent","getAlignment","horizAlignment","verticAlignment","getAlignmentProperty","alignment","alignmentProperty","FLEX_START","CENTER","FLEX_END","generalComponentStyle","backgroundColor","size","flexGrow","flexShrink","flexBasis","classes","WRAP","SCROLL","updateChildrenClasses","childrenHasPercentSizes","childrenClasses","_ori","_percent","pixels","getOrientationSetting","styleOptions","getBorder","availableOrientations","availableHorizontalAlignments","availableVerticalAlignments","availableFlexSizeTypes","FLEX","availableOverflows","HIDDEN","condition","settingCategory","readyChildrenCount","childrenDatabearers","currentTab","DEFAULT_ORIENTAION","updateWhenExist","checkExist","setInterval","clearInterval","tabs","changeTabOnHashChange","hashChangeCallback","onChangeTab","updatePanels","initializeTabs","$applyAsync","onComponentReady","updateValuesWithTranslations","percent","selectedId","selectedTab","onOrientationChanged","tabAPI","tabPanel","innerChild","translatedTitle","onTranslationsChangedEvent","initLookupOptions","openTranslations","getCurrentStringsList","currentStringList","currentStringDictionary","saveGlobalTranslations","globalStrings","deleteGlobalTranslations","getProjectLanguages","localeEquals","propertyId","triggerEvent","addLanguage","newLanguage","translatedValue","componentLanguage","newComponentLanguage","deleteLanguage","deletedlanguage","locale1","locale2","hasLanguageComponent","currentTranslations","hasTranslations","updatedTranslation","setTranslatableStringByTranslationIndex","componentIndex","translationIndex","projectLanguageComponents","languageValue","currentLanguageKey","projectHasLanguage","setTranslationFromComponentLanguage","languageComponent","setTranslatableStringById","projectLanguages","firstTranslation","getLocaleDisplayName","localeDisplayName","createDefaultLanguageComponents","createLanguageComponentFromBindableField","componentRadioButtons","radioButton","getLookupOptions","getAutoOptions","searchInput","done","autoCompleteGlobalStrings","filteredList","resizable","sortable","paging","request","stringList","datasetCopy","filterExpr","sortId","Single","toolbar","keywordFilter","localeNotDefault","openTabIds","setOpenedTabIds","tabIds","getOpenedTabIds","setSelectedTabById","tabId","selectedTabId","getSelectedTabId","saveStates","inProgress","saved","failed","saveStateEvent","raiseSaveStateEvent","save","flags","INFO","saveInfo","ROLES","saveRoles","saveTags","appSettings","roles","ngOnInit","Ng2Component","selector","subscriptions","origin","parentDomain","postMessage","userControlListener","userControlListenerScope","handleParentMessage","readyHandlers","isInitialized","requestId","requestCallbacks","pos","parms","ix","rh","payload","fireEvent","addEventListener","attachEvent","msg","getIsConnected","UserControl","postMessageDirect","alert","generateServerEvent","args","cmd","sendWebUserControlRequest","getQueryParameter","getOrigin","getPlatform","getTheme","getWebClientUrl","getSession","getConfigName","Ajax","cb","onError","XMLHttpRequest","onreadystatechange","readyState","responseText","send","registerListener","invoke","getName","eventName","getFormId","getCompValue","setCompValue","setVarValue","getPropValue","setPropValue","arguments","generate","async","subscribe","getImageSrc","registerCallback","listeningMessageTypes","drillbackSelector","favoritesSelector","MsgType","messageReceiver","executeMessage","parseJSON","registeredHandlers","wildCardHandlers","allHandlers","registeredHandler","sendRelayMessage","proxyMessage","sendMessageToParent","encodedProxyMessage","encodedMessage","containerWindow","opener","sendMessageProxy","focus","testFrameAndSend","frame","frames","sharePointUrl","messageObject","evalJSON","adjustHeight","iframeName","sendPrepareFavoritesMessage","getValueQuerystring","qs","namespace","unRegisterMessageHandler","newHandlers","unbind","getEnvironmentInformation","randomNumber","getRandomNumber","MessageId","getEntityInformation","getInforMingleHomeUrl","relayMessage","ct","fr","contentWindow","iframeId","live","event","preventDefault","ng1Import","ng2Import","RootModule","ng1RootModule","$urlService","deferIntercept","ng2RootModule","platformBrowserDynamic","bootstrapModule","platformRef","urlService","injector","UrlService","NgZone","listen","sync","set","IdsSvgComponent","pathname","pathnameNoIndex","$animateProvider","classNameFilter","animation","enter","doneFn","slideDown","leave","slideUp","fadeIn","fadeOut","AddStringCtrl","ImportConflictCtrl","ImportErrorCtrl","ImportProjectCtrl","LicensesButton","LicensesDialogCtrl","TestDataserviceDialogCtrl","DatagridExportDialogCtrl","DragDirective","InitializeDirective","InfiniteScrollDirective","RepeatDoneDirective","Filters","DropdownFieldComponent","FilterPopupmenuComponent","FilterTagComponent","FilterToolbarComponent","InputFieldComponent","PaginatorComponent","ProjectTagsComponent","TagDropdownComponent","TextareaFieldComponent","SortPopupmenuComponent","AboutDirective","ArrangeDirective","AutocompleteDirective","BusyDirective","ButtonDirective","ColorPickerDirective","ControlDirective","DatagridDirective","DatepickerDirective","DropDownDirective","EditorDirective","FileuploadDirective","ListviewDirective","LookupDirective","MaskDirective","MultiSelectDirective","PopupmenuDirective","PopoverDirective","SearchFieldDirective","SliderDirective","SpinboxDirective","TabsDirective","TextareaDirective","TimepickerDirective","ToolbarDirective","TooltipDirective","TrackDirtyDirective","ValidateDirective","ApplicationMenuDirective","inputArray","criteria","itemProperty","selectedItem","keepItem","compareValue1","item2","compareValue2","itemProperty1","itemProperty2","input","ExcludeFromFilter","OnlyIncludeFilter","HtmlEncode","stringName","url1","url2","end","sameForAll","resolutionOption","onChangeOption","currentActionName","stateBasedOnSubcode","subcode","information","extraInfo","confirmButtonDisplayName","confirmButton","None","confirm","chosenFile","import","dbVersion","productName","aboutOptions","useDefaultCopyright","bindings","controllerAs","getNextId","resourceUrl","deconstructPath","matrix","pathParameters","getPathParameters","matrixParameters","getSpecificParameters","queryParameters","pathMatch","matrixMatch","queryMatch","hashMatch","paramType","regexp","urlComponentRegexBracket","urlComponentRegex","queryPath","validatePath","validateUrlPart","emptyItem","pathRegex","deliminator","nameMatch","newEntry","parseListData","idoParameter","idoEntry","Items","remapItemProperties","parsedResponse","parsedItems","$sce","licensesHtml","applicationVersion","dbVersions","htmlCode","trustAsHtml","TestDataserviceDialogType","responseData","fetching","testDialogTypes","initDatagridOptions","initGenericState","handleError","runApi","runGenericApi","copyToClipboard","select","execCommand","onKeyPress","which","ENTER","mandatory","paramForInput","acc","UNFORMATTED","getUnFormattedData","FORMATTED","getFormattedData","maybeNewKey","newKey","formatResults","fillResponseData","exportName","exportType","attrs","$last","$eval","repeatDone","ngDragEventDirectives","directiveName","$parse","restrict","compile","ngDragEventHandler","$digest","$interval","THROTTLE_MILLISECONDS","scrollDistanceThreshold","bounceDistance","EDGE_BOUNCE_INTERVAL_MILLIESECONDS","lastScrollTop","edgeBounceInterval","up","down","loadMore","eirInfiniteScroll","scrollEnabled","throttle","evt","currentTarget","scrollingDown","scrollTop","scrollingUp","distanceFromBottom","scrollHeight","offsetHeight","$apply","distanceFromTop","bounceEdges","func","wait","previous","later","remaining","eirInfiniteScrollEnabled","InfiniteScrollCtrl","isDevelopment","maxProjects","maxApps","maxComposites","maxDatasources","user","mgFormName","mgFormOnly","mgPlatform","mgConfigName","mgHelpBaseUrl","setBaseBuilder","stop","basebuilder","InitializeCtrl","$static","onChange","DropdownFieldCtrl","readonly","listValues","notify","getValidation","NotifiableComponent","filterOptions","filterValues","localPrefix","FilterPopupmenuCtrl","$filter","filterOn","storageName","storedFilter","originalValues","currentSelectedFilter","filterOption","doFilter","$doCheck","previousValues","previousFilterValues","currentValues","equalLengthsNotSameContent","onFilter","equals","FilterTagCtrl","tagService","selectedTags","currentTag","unsubscribers","updateValues","projectItem","filterProject","addTag","tag","deleteTag","selectedTag","projectTag","originalProject","filterTypeOptions","sortPropertiesOptions","filterTarget","InputFieldCtrl","pagingValues","currentPage","PaginatorCtrl","createPages","pagerOptions","pageSizeSelectorText","pagesizes","showPageSizeSelector","showFirstButton","enableFirstButton","showPreviousButton","enablePreviousButton","showNextButton","enableNextButton","showLastButton","enableLastButton","onFirstPage","_elem","_args","resetCurrentPage","onPreviousPage","pageNumber","previousPage","onNextPage","nextPage","onLastPage","pages","updateButtons","onPageSizeChange","getPagerElement","pager","currentList","previousList","page","pagingTarget","pageIndex","getPagerApi","last","next","first","updated","tagsOverflowed","checkOverflow","tagContainerElement","moreTagInit","popoverOptions","popover","placement","extraClass","sortOptions","sortValues","SortPopupmenuCtrl","OrderEnum","sortOrderTypes","sortOn","sortOrder","bindingSortValues","currentSelected","currentSelectedSortOrder","doSort","sortOption","onSort","onSortOrder","DESCENDING","ASCENDING","availableTags","availableTagNames","initAvailableTags","initSearchFieldEvent","changeObject","getAvailableTag","getNewTag","onKeyPressed","inforOwned","FALSE","tagName","availableTag","onSaveTags","$tags","TextareaFieldCtrl","textareaOptions","autoGrow","autoGrowAnimate","attributes","DIRECTIVE_NAME","unbindWatcher","newOptions","aboutComponent","about","modalData","applicationMenu","arrangeElement","arrange","xiArrange","onArrange","childNodes","$watchCollection","autocomplete","autoCompleteData","delay","busyDelay","transparentOverlay","displayDelay","busyindicator","isRunning","busyData","require","ngModel","api","selectedColor","val","colorpicker","color","setColor","assign","functionName","expandablearea","accordion","wizard","ex","exc","DATAGRID_RENDERED","columnName","datagrid","finishedResult","oldOptions","oldDataset","preserveSelected","updateDatagrid","DataSourceDescription","cell","col","m3Datasource","operations","descriptionValue","dataParameters","DataSourceParameterType","Multi","formatters","DataPairPresenter","dataPairList","foundItem","datapair","DatasourceSuiteFormatter","RequiredFormatter","checkValue","trimedValue","formatDate","parsedValue","abs","currentLocale","datepicker","modelWatcher","disabledWatcher","dropdown","setDisplayedValues","modelAttr","disabledAttr","ngDisabled","editorData","fileupload","fileUploadData","LISTVIEW_RENDERED","closest","listview","stopPropagation","selectedItems","selected","listViewData","lookup","thousands","String","mustComplete","showCurrency","maskData","multiselect","multiSelectApi","tooltipData","popupmenu","popupMenuData","searchfield","searchFieldData","slider","sliderData","spinbox","spinBoxData","modalId","resize","tabToSelect","tabData","textareaApi","textarea","textAreaData","timepicker","timePickerData","toolbarData","isInstantiated","xiTooltip","disabledTooltip","trackdirty","questions","deleteQuestion","questionId","question","addQuestion","newQuestion","QuestionDefinitionsEnum","COMPONENT_SETTINGS","sameQuestion","getQuestion","SEEKS_BINDING","getQuestions","setQuestions","getQuestionById","DesignerMashup","availableButtonStyles","updateChart","interactionPromise","datasourceChanged","newDatasource","getSohoChartType","chartEnum","getExampleData","getDataset","datasetsMetadata","datasetMetadata","dataItem","Column","Donut","Pie","BarGrouped","BarStacked","ColumnGrouped","chartElement","hasLabel","chartWrapper","chart","axisLabels","axisValuesTitle","axisCategoryTitle","showLegend","animate","isArea","Area","isDonut","isGrouped","isStacked","checkboxState","checked","showDatagrid","selectHandler","onItemSelected","changeHandler","onItemChanged","settingsChangedHandler","onSettingsChanged","rerenderTbody","datagridApi","getSohoXiApi","pagerInfo","pagerAPI","render","afterPaging","SOURCE_SETTING","keepSelected","rowCount","filterBar","enableExport","initiateDatagridOptions","detachEvents","initClasses","refreshDatagrid","usePaging","togglePager","pageSize","isList","setRowCountOutput","multiSelect","toggleMultiSelection","toggleToolbar","translatedCellText","refreshSubstitutions","refreshColumns","refreshDatagridTriggers","emptyMessage","setDatagridOptions","updateGrid","rowHeight","attachEvents","setSummaryRowOutput","datagridBearer","initial","columnDefinitions","hasSummaryRow","shouldHaveSummaryRow","selectType","getSelectType","saveColumns","TWENTYFIVE","showDirty","showSelectAllCheckBox","enableTooltips","summaryRow","previousAttributes","setSelection","substituteValues","exportToExcel","exportToCsv","summaryOutput","summary","rowCountOutput","Multiple","substitute","substituteOptions","dropdownOptions","from","to","updateColumns","outParam","moveIndex","toggleSelected","currentDataLength","previousLength","syncAndDeselectAll","previousRow","previousSortOrder","deSelectAllRows","setActivePage","setSortColumn","selectRow","clearDirty","syncSelectedRowsIdx","dirtyItems","clearSummaryRow","getGridElement","blankId","addClickEvent","addHyperlinkEvent","loadOptions","checkboxExists","checkbox","align","rowsSelected","isDrillback","drillbacklink","hrefString","datagridElement","updateBindableItem","$evalAsync","listData","arg","argData","newData","selectedRows","setSelectedItem","dirtyRows","ON_COLUMN_UPDATED","sourceId","autoData","summaryRowCells","availableRowHeights","AVAILABE_PAGE_SIZES","OPTION1","OPTION2","OPTION3","OPTION4","OBJECT","dateFormatted","dateFormatShow","dateFormatBinding","dateFormatInput","isDefaultTodayDate","setDatepickerOptions","datepickerOptions","placeholder","setValue","isStaticSet","updateDatepickerValue","newDate","setDateValue","dateValue","datepickerApi","setToday","initializeDatepicker","updateDatepickerReadonlyValue","addPreventDefault","ulPath","THREE_HUNDRED","datePickerApi","parseDateFormatAutomatic","availableDateFormats","$attrs","currentItemIndex","emptyValue","currentItem","setCurrentItem","updateCurrentItem","newCurrentItem","setPseudoElemDisplayText","onListUpdated","firstItem","displayValue","getSoHoDropdown","pseudoElem","executeSetSelectedItemAction","interactionDeferred","valueToFind","actualValue","removeEmptyValue","setEmptyValue","AVAILABLE_WIDTHS","bindableRef","renderURL","onLinkClick","availableDirectionTypes","BACK","DIRECTIONAL","setImageSource","webkitURL","setImageFromUrlToSource","base64result","put","availablePositionTypes","FIT","fontStyle","fontChar","availableStyles","availableCharacteristics","availableColors","colors","graphite10","componentNameBackgroundColor","azure01","azure02","azure03","azure04","azure05","azure06","azure07","azure08","azure09","azure10","amber01","amber02","amber03","amber04","amber05","amber06","amber07","amber08","amber09","amber10","amethyst01","amethyst02","amethyst03","amethyst04","amethyst05","amethyst06","amethyst07","amethyst08","amethyst09","amethyst10","turquoise01","turquoise02","turquoise03","turquoise04","turquoise05","turquoise06","turquoise07","turquoise08","turquoise09","turquoise10","ruby01","ruby02","ruby03","ruby04","ruby05","ruby06","ruby07","ruby08","ruby09","ruby10","emerald01","emerald02","emerald03","emerald04","emerald05","emerald06","emerald07","emerald08","emerald09","emerald10","graphite01","graphite02","graphite03","graphite04","graphite05","graphite06","graphite07","graphite08","graphite09","slate01","slate02","slate03","slate04","slate05","slate06","slate07","slate08","slate09","slate10","filterValue","clearSearch","getFilteredList","filterList","currentTemplate","updateCurrentTemplateHeight","renderChildren","realIndex","getRealIndexFromGeneratedId","currItem","selectedGeneratedId","forEachItemTemplate","itemTemplate","onLoad","childInstance","subChild","loadFillOptimal","childrenReadyDeferred","getChildContext","childKey","infiniteScrollEnabled","newRowCount","getRowsPerPage","realIndexMax","remainingSlots","deletedChild","getNewGeneratedComponent","realIndexMin","getActiveFieldsFromTemplate","checkObjectforFilterMatch","activeIDs","breakdown","toolTip","objectValues","activeFields","entries","firstLiElement","currentTemplateHeight","goToPage","moveScroll","listresult","getGeneratedPrefix","generatedIndex","optimalRowCount","SCROLLABLE_PAGE_FACTOR","listElement","dataLength","remainingTilOptimaleCount","remainingDataLength","min","updateView","returnNumber","eachHeight","hasListResults","hasData","noData","lookupOutputId","beforeShow","lookupCallback","openLookupDialog","OUTPUT_SETTING_TITLE","selectedRadioButtonId","currentItemName","currentItemValue","tabsParent","visibility","maxLength","updateMaxLength","characterCounter","DEFAULT_MAX_LENGTH","charRemainingText","lengthWarning","updateMaskOptions","getMask","maskOptions","editType","maskApi","patternOptions","allowDecimal","decimalLimit","allowNegative","integerLimit","allowThousandsSeparator","newBoxWidth","boxWidth","enableSeconds","formatString","updateReadonly","timepickerApi","timeValue","setTimepickerOptions","upperCaseTime","isValidTime","setTime","refreshTimepicker","timepickerOptions","finalTime","availableHourMode","initCache","getApiSuites","makeIonRequest","searchOperations","suiteContext","searchCriteria","OPERATIONS_PAGE_SIZE","getSwaggerDoc","fullPath","swaggerPath","resp","dereferenced","ComponentHelper","dereferenceSwagger","relativePath","doc","mapObject","lookupRef","prop","mapFunc","newProp","k","upperPropName","firstMatch","restOfPath","$compileService","childrenReady","nrChildrenReady","onChildReady","childScope","createTemplate","componentTemplate","ComponentCommonCtrl","$controller","componentDestroyed","controllerExists","controllerName","editorControllerName","outerHTML","empty","commonPart","themes","updateSettings","showTitlebar","showThemeSwitch","changeCanvasTheme","TitlebarCtrl","AppLauncher","RuntimeCanvasDirective","runtimeService","showMashup","windowResizeHandler","initProjectUrlVariables","$onDestroy","APPHUB","runtimeManifest","myList","getCanvasWidth","DESIGNER_PREVIEW","deferredError","windowResizeTimerPromise","FIFTY","innerWidth","loadApplication","RuntimeCanvasCtrl","hubService","tabList","tabsAPI","setTabActivatedBehavior","setTabCloseBehavior","setOpenTabBehaviour","manifests","openTabs","administrator","removedTabId","setOpenedTabs","createStartTab","createTabs","setupMingleDrillbacks","applicationDrillback","$appId","addTab","setupMingleFavoritesContext","favoriteContext","tabContent","createTabContent","setTabFocused","getSoHoXiAPI","openMenu","isDuplicateTab","tablist","removeStartTab","tabHtmlContent","isDismissible","ApphubCtrl","DEFAULT_VALUE","attribute","administrationService","conflictResolutionService","filterEnum","filterTypes","sortPropertiesTypes","searchfieldOptions","collapsible","clearable","apps","app","newApps","newProjectInfo","showSettingPanel","isSelectedProjectModified","selectedProjectSetting","hideSettingPanel","isModified","importProjectFile","DONOTHING","importedProject","progressBar","validateData","handleImportAppError","errorDialogOptions","handleReplace","OVERWRITE","appProject","appManifest","imported","FIVE_THOUSAND","openFeatureCatalog","deleteProject","ONLINE","navigateBack","AdministrationCtrl","toggleEnabled","___HTML_LOADER_GET_SOURCE_FROM_IMPORT___","toggleActivated","projectStatus","OFFLINE","projectSetting","onDelete","selectedRoles","initDatagrid","refreshSohoIcons","actions","collapsibleFilter","initDatagridOnSelectEvent","rowItems","rowObject","onRemove","removeSelected","disabledButtonSet","ifsRoles","limitUrl","URL_LIMIT","innerProjectSetting","previousProjectSetting","roleListViewOptions","newProject","oldProject","newRoles","oldRoles","newTags","oldTags","deepListEquals","listOfObj1","listOfObj2","result1","newRole","oldRole","result2","previousProjectId","setSidebarBaseURL","appUrl","showMore","copyUrl","textArea","upgradeProject","currentVersion","buildUrl","editUrlValues","onAddRoles","getFilteredAddedRoles","ifsRole","groupId","onRemoveRole","selectedRole","getSelected","indexToRemove","urlValues","urlString","urlVariable","variable","urlValue","filteredRoles","projectRoles","projectRole","discard","noToast","doVersionUpgrade","newVersion","illegalCharactersRegex","initUrlVariablesValues","updateUrlValue","updatedUrlValue","datagridUrlVariable","hasNewValue","showCellError","adminService","versions","switch","DeveloperToolCtrl","adminstrationService","isDeveloper","runtimeApps","acceptanceTestAppIdList","activatedAcceptanceTestAppList","deleteAllAcceptanceTestApps","amount","deactivateAllApps","stuff","upgrade","ngDoBootstrap","bootstrap","NgModule","imports","BrowserModule","UpgradeModule","UIRouterUpgradeModule","forRoot","states","appStates","declarations","entryComponents","providers","ng2RootState","nestedState"],"mappings":"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AK,aAAY,YAAYE,QAI3C,iBAAAxZ,KAAP,WACCtU,KAAK8qB,MAAMxW,OACXtI,EAAE,OAAOhM,KAAK8qB,MAAM8C,KAAK,aAAY,YAAYtZ,QAEnD,OAzGA,K,wJCjwBA,wBACA,yB,kHCGA,wBACA,wBACA,yB,gJCNA,SAAYkI,iBACX,+DACA,qDACA,qEACA,6DAJD,CAAY,QAAAA,kBAAA,QAAAA,gBAAe,M,+JCO3B,wBAMC,kBAAmB/yB,OAAA,KAAAA,YAEpB,OAPe,SAAAskC,OAAS,IAAIC,SAAS,UACtB,SAAAC,UAAY,IAAID,SAAS,aACzB,SAAA3+B,WAAa,IAAI2+B,SAAS,cAC1B,SAAAr+B,MAAQ,IAAIq+B,SAAS,SAIpC,SARA,GAAa,QAAAA,kBAUb,SAAYZ,aACX,iDACA,qCACA,0CACA,0CACA,wCACA,sCACA,0CACA,kDACA,4CACA,0CACA,8CACA,kDACA,sCACA,wCACA,oDACA,gDACA,sDACA,oDACA,4CACA,4CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,0CACA,kDACA,oDACA,4CACA,gDACA,gDACA,gDACA,gDACA,iDACA,iDACA,iDACA,iDACA,iDACA,iDACA,iDACA,uCACA,iDACA,+CACA,6CACA,qCACA,qCACA,qCACA,qCACA,qCACA,qCACA,qCACA,qCACA,qCACA,uCACA,uCACA,uCACA,iDACA,uDACA,mDACA,6CACA,2CACA,yCACA,6CACA,2DACA,yDACA,yDACA,qDACA,2DACA,yDACA,mDApGD,CAAY,QAAAA,cAAA,QAAAA,YAAW,M,mJCjBvB,6CAGA,6DAGA,OAFwB,mBAAAc,gBAA+B,CAAC,kBAAAhvB,yBAAyBjB,SACzD,mBAAAkwB,eAA8B,CAAC,kBAAAjvB,yBAAyBnB,KAChF,mBAHA,GAAa,QAAAqwB,uC,qQC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","file":"runtime.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t6: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"scripts/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([385,5,7,1,0,2,3,4,8]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\n\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport type { IGridUser } from \"ng2/common/model/environment-settings.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IMingleLanguage, IMongooseString } from \"ng2/common/model/language.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nexport enum CanvasModeEnum { RUNTIME, SELECTION, INSERT, FINDER, WIZARD }\r\nexport enum AppStatus { OFFLINE, ONLINE }\r\nexport enum DashboardStates { LIST, CREATE }\r\nexport enum DashboardViewStates { TILE , GRID }\r\nexport enum ReplaceEnum { DONOTHING, OVERWRITE, COPYNEW }\r\nexport const availableDatasourceTypes = [\r\n\t{ name: \"IDM\", value: DatasourceTypeEnum.IDM },\r\n\t{ name: \"M3\", value: DatasourceTypeEnum.M3 },\r\n\t{ name: \"MONGOOSE\", value: DatasourceTypeEnum.MONGOOSE },\r\n\t{ name: \"Generic\", value: DatasourceTypeEnum.generic },\r\n\t{ name: \"Static List\", value: DatasourceTypeEnum.INLINE_LIST }\r\n];\r\n\r\nexport class IdoProperties {\r\n\tstatic ITEM_ID = \"ItemID\";\r\n\tstatic RECORD_DATE = \"RecordDate\";\r\n\tstatic ROW_POINTER = \"RowPointer\";\r\n}\r\n\r\nexport enum BuildEnvTypes {\r\n\tDEV = \"DEV\",\r\n\tPROD = \"PROD\",\r\n\tCI = \"CI\"\r\n}\r\nexport type BuildEnvType = BuildEnvTypes.DEV | BuildEnvTypes.PROD | BuildEnvTypes.CI;\r\n\r\nexport enum AppEnvTypes {\r\n\tRUNTIME = \"RUNTIME\",\r\n\tDESIGNER = \"DESIGNER\",\r\n}\r\nexport type AppEnvType = AppEnvTypes.DESIGNER | AppEnvTypes.RUNTIME;\r\n\r\nexport enum ChartTypeEnum {\r\n\tArea = (\"Area\") as any,\r\n\tBar = (\"Bar\") as any,\r\n\tBarGrouped = (\"BarGrouped\") as any,\r\n\tBarStacked = (\"BarStacked\") as any,\r\n\tColumn = (\"Column\") as any,\r\n\tColumnGrouped  = (\"ColumnGrouped\") as any,\r\n\tColumnStacked = (\"ColumnStacked\") as any,\r\n\tDonut = (\"Donut\") as any,\r\n\tLine = (\"Line\") as any,\r\n\tPie = (\"Pie\") as any,\r\n\tRadar = (\"Radar\") as any,\r\n\tProfile = (\"Profile\") as any, // backwards compatibility, legacy type\r\n\tStackedLine = (\"StackedLine\") as any, // backwards compatibility, legacy type\r\n\tStackedColumn = (\"StackedColumn\") as any, // backwards compatibility, legacy type\r\n}\r\n\r\nexport enum Numbers {\r\n\tHALF = 0.5,\r\n\tZERO = 0,\r\n\tONE = 1,\r\n\tTWO = 2,\r\n\tTHREE = 3,\r\n\tFOUR = 4,\r\n\tFIVE = 5,\r\n\tSIX = 6,\r\n\tSEVEN = 7,\r\n\tTEN = 10,\r\n\tTWENTY = 20,\r\n\tTWENTYFIVE = 25,\r\n\tFIFTY = 50,\r\n\tSEVENTYFIVE = 75,\r\n\tHUNDRED = 100,\r\n\tTWO_HUNDRED = 200,\r\n\tTHREE_HUNDRED = 300,\r\n\tFOUR_HUNDRED = 400,\r\n\tSIX_HUNDRED = 600,\r\n\tONE_THOUSAND = 1000,\r\n\tFIVE_THOUSAND = 5000,\r\n\tMILLION = 1000000\r\n}\r\n\r\nexport enum ProjectLayout {\r\n\tONE = 1,\r\n\tTWO = 2,\r\n\tTHREE = 3,\r\n\tFOUR = 4,\r\n\tFIVE = 5,\r\n\tSIX = 6,\r\n\tSEVEN = 7,\r\n\tEIGHT = 8,\r\n\tNINE = 9,\r\n\tTEN = 10,\r\n\tELEVEN = 11,\r\n\tTWELVE = 12,\r\n\tTHIRTEEN = 13\r\n}\r\n\r\n/**\r\n * Enums for datagrid page sizes\r\n *\r\n * @export\r\n * @enum {number}\r\n */\r\nexport enum DatagridPageSizesEnum {\r\n\tOPTION1 = (Numbers.TEN) as any,\r\n\tOPTION2 = (Numbers.TWENTYFIVE) as any,\r\n\tOPTION3 = (Numbers.FIFTY) as any,\r\n\tOPTION4 = (Numbers.SEVENTYFIVE) as any,\r\n}\r\n\r\nexport enum ColumnFormatterType { BASIC, LIST, HYPERLINK }\r\n\r\nexport enum HorizontalAlignmentEnum { LEFT = 1, CENTER = 2, RIGHT = 3 }\r\nexport enum DirectionEnum { RIGHT = 1, LEFT = 2, UP = 3, DOWN = 4, AUTO = 5 }\r\n/**\r\n * TODO: Reorder or change values of the enums as it has an awkward sequence\r\n * Remember to also that these are stored in the DB and changing the values on\r\n * these will affect how the data from the DB is interpreted.\r\n */\r\nexport enum ThemeEnum {\r\n\tDEFAULT = 0,\r\n\tLIGHT = 1,\r\n\tDARK = 2,\r\n\tHIGH_CONTRAST = 3,\r\n\tLIGHT_TRANSPARENT = 4,\r\n\tDARK_TRANSPARENT = 5,\r\n}\r\nexport enum FlexSizeTypeEnum { PIXELS = 1, FLEX = 2 }\r\nexport enum FlexOverflowEnum { HIDDEN = 1, WRAP = 2, SCROLL = 3 }\r\nexport enum WizardFocusEnum { FOCUSED = 1, RESTING = 2, UNFOCUSED = 3 }\r\nexport enum AlignmentEnum { FLEX_START = 1, CENTER = 2, FLEX_END = 3 }\r\nexport enum SortEnum {\r\n\tSELECTED_SORT_ORDER,\r\n\tSELECTED_SORT_PROPERTY,\r\n\tFILTER_USER_NAME,\r\n\tFILTER_NAME,\r\n\tSORT_DEFINITION,\r\n\tFILTER_STATUS\r\n}\r\n\r\n// tslint:disable:no-magic-numbers\r\nexport enum SaveFlagsEnum {\r\n\tMANIFEST = (2 ** 0),\r\n\tCANVAS_COMPONENTS = (2 ** 1),\r\n\tINTERACTIONS = (2 ** 2),\r\n\tDATASOURCES = (2 ** 3),\r\n\tSCREENSHOT = (2 ** 4),\r\n\tCUSTOMCOMPONENTS = (2 ** 5),\r\n\tCOMPOSITE_COMPONENTS = (2 ** 6),\r\n\tTRANSLATIONS = (2 ** 7),\r\n\tTAGS = (2 ** 8),\r\n\tURL_VARIABLES = (2 ** 9),\r\n\tEXPRESSIONS = (2 ** 10),\r\n\tQUESTIONS = (2 ** 11),\r\n\tPROJECT = (\r\n\t\tMANIFEST +\r\n\t\tCANVAS_COMPONENTS +\r\n\t\tINTERACTIONS +\r\n\t\tDATASOURCES +\r\n\t\tCOMPOSITE_COMPONENTS +\r\n\t\tTRANSLATIONS +\r\n\t\tTAGS +\r\n\t\tURL_VARIABLES +\r\n\t\tEXPRESSIONS\r\n\t)\r\n}\r\n//tslint:enable:no-magic-numbers\r\n\r\nexport enum SaveProjectSettingEnum {\r\n\tINFO = 1,\r\n\tROLES = 2,\r\n\tALL = 3\r\n}\r\n\r\nexport enum MGPlatform {\r\n\tWEB = \"Web\",\r\n\tWIN_FORMS = \"WinForms\"\r\n}\r\n\r\nexport class DeveloperConstants {\r\n\tstatic readonly ION_PROXY = \"dev-ion-proxy\";\r\n\tstatic readonly ION_TOKEN = \"dev-ion-token\";\r\n\tstatic readonly LAUNCH_WITH_ANGULAR = \"dev-launch-with-angular\";\r\n}\r\n\r\nexport enum ProjectTypeEnum {\r\n\tAPP,\r\n\tBASE\r\n}\r\n\r\nexport class Config {\r\n\t/* APP_ROOT and REST_ROOT are set from common/module.ts, by running the method window.setContextRoots.\r\n\tBecause they need to be set before common and component modules are initialized,\r\n\tbut use different paths depending on builder or runtime. These are defaulted to empty string to detect errors */\r\n\tstatic APP_ROOT = \"\";\r\n\tstatic REST_ROOT = \"\";\r\n\tstatic APP_BUILDER_ROOT = \"/appbuilder/\";\r\n\tstatic APP_BUILDER_REST_ROOT = \"/appbuilderrest/\";\r\n\tstatic APP_RUNTIME_ROOT = \"/appruntime/\";\r\n\tstatic APP_RUNTIME_REST_ROOT = \"/appruntimerest/\";\r\n\tstatic ION_API_ROOT = \"/ionapi\";\r\n\tstatic ION_API_URL = \"\";\r\n\tstatic ION_API_TOKEN = localStorage.getItem(DeveloperConstants.ION_TOKEN);\r\n\tstatic ION_API_PROXY_PORT = \"8083\";\r\n\tstatic TENANT_ID = \"\";\r\n\tstatic IS_DEV = false;\r\n\tstatic IS_BASE_BUILDER = false;\r\n\tstatic IS_FIRST_LOAD = true;\r\n\r\n\tstatic IS_CONFIG_LOADED = false;\r\n\t//0 because it will get the real values from server.\r\n\tstatic MAX_PROJECTS = 0;\r\n\tstatic MAX_DATASOURCES = 0;\r\n\tstatic MAX_COMPOSITES = 0;\r\n\tstatic MAX_APPS = 0;\r\n\tstatic RUN_PATH = \"run/\";\r\n\tstatic RUN_ROOT = Config.APP_BUILDER_ROOT + Config.RUN_PATH;\r\n\tstatic RUN_RUNTIME_ROOT = Config.APP_RUNTIME_ROOT + Config.RUN_PATH;\r\n\tstatic USER: IGridUser;\r\n\tstatic LOCALE: string;\r\n\tstatic MG_FORM_NAME = \"\";\r\n\tstatic MG_FORM_ONLY = false;\r\n\tstatic MG_PLATFORM = \"\";\r\n\tstatic MG_CONFIG_NAME = \"\";\r\n\tstatic MG_HELP_BASE_URL = \"\";\r\n}\r\n\r\nexport class ServerPaths {\r\n\t// REST paths\r\n\tstatic readonly PROJECT = \"project/\";\r\n\tstatic readonly ADMINISTRATION = \"administration/\";\r\n\tstatic readonly RUNTIME = \"runtime/\";\r\n\tstatic readonly SETTINGS = \"settings/\";\r\n\tstatic readonly SWITCHABLE_FEATURES = \"switchableFeatures/\";\r\n\tstatic readonly REPOSITORY = \"repository/\";\r\n\tstatic readonly COMPOSITE_COMPONENTS = \"compositeComponents/\";\r\n\tstatic readonly DATASOURCES = \"datasources/\";\r\n\tstatic readonly IDO = \"ido/\";\r\n\tstatic readonly LOCAL_IDO = \"local-ido/\";\r\n\tstatic readonly DESIGNER = \"designer/\";\r\n\t// Application paths\r\n\tstatic readonly ADMIN = \"admin/\";\r\n}\r\n\r\nexport enum AppTypeEnum {\r\n\tADMIN_PREVIEW = \"ADMIN_PREVIEW\",\r\n\tRUNTIME = \"RUNTIME\",\r\n\tDESIGNER_PREVIEW = \"DESIGNER_PREVIEW\",\r\n\tAPPHUB = \"APPHUB\"\r\n}\r\n\r\nexport class SettingTypes {\r\n\tstatic SOURCE = \"wizard-source\";\r\n\tstatic TARGET = \"wizard-target\";\r\n}\r\n\r\nexport class BindingTypes {\r\n\tstatic STATIC = \"<static>\";\r\n\tstatic CONTEXT = \"<target>\";\r\n\tstatic URL = \"<url>\";\r\n}\r\n\r\nexport class EventTypes {\r\n\tstatic CLICK = \"click\";\r\n\tstatic DRAGEND = \"dragend\";\r\n\tstatic DRAGLEAVE = \"dragleave\";\r\n\tstatic DRAGOVER = \"dragover\";\r\n\tstatic DRAGSTART = \"dragstart\";\r\n\tstatic DROP = \"drop\";\r\n\tstatic KEYDOWN = \"keydown\";\r\n\tstatic KEYUP = \"keyup\";\r\n\tstatic MOUSEUP = \"mouseup\";\r\n}\r\n\r\nexport class CssConstantKeys {\r\n\tstatic DISPLAY = \"display\";\r\n\tstatic POINTER_EVENTS = \"pointer-events\";\r\n\tstatic CURSOR = \"cursor\";\r\n\tstatic BACKGROUND_COLOR = \"background-color\";\r\n}\r\n\r\nexport class CssConstantValues {\r\n\tstatic CURSOR_NODROP = \"no-drop\";\r\n\tstatic CURSOR_POINTER = \"pointer\";\r\n\tstatic AUTO = \"auto\";\r\n\tstatic NONE = \"none\";\r\n\tstatic INLINE_BLOCK = \"inline-block\";\r\n}\r\n\r\nexport class Operators {\r\n\tstatic EQUALS = \"=\";\r\n\tstatic NOT_EQUALS = \"<>\";\r\n\tstatic GREATER = \">\";\r\n\tstatic SAME_GREATER = \">=\";\r\n\tstatic LOWER = \"<\";\r\n\tstatic SAME_LOWER = \"<=\";\r\n\tstatic INCLUDES = \"*\";\r\n}\r\n\r\nexport class ConditionType {\r\n\tstatic ALL = \"all\";\r\n\tstatic DISABLE = \"disable\";\r\n\tstatic HIDE = \"hide\";\r\n}\r\n\r\nexport class InsertEventTypes {\r\n\tstatic MOVE = \"move\";\r\n\tstatic COPY = \"copy\";\r\n}\r\n\r\nexport class ComponentSizeTypes {\r\n\tstatic SMALL = \"small-component\";\r\n\tstatic LARGE = \"big-component\";\r\n}\r\n\r\nexport class ComponentConstants {\r\n\tstatic COPY_SUFFIX = \"_Copy\";\r\n}\r\n\r\nexport class OrientationTypes {\r\n\tstatic HORIZONTAL = \"Horizontal\";\r\n\tstatic VERTICAL = \"Vertical\";\r\n\tstatic PAGE = \"Page\";\r\n}\r\n\r\nexport class SidebarTabTypes {\r\n\tstatic CONTENT = \"content\";\r\n\tstatic INTERACTION = \"interaction\";\r\n\tstatic STYLE = \"style\";\r\n}\r\n\r\nexport class SettingInputKeys {\r\n\tstatic CHECKBOX = \"checkbox\";\r\n\tstatic DROPDOWN = \"dropdown\";\r\n\tstatic MARGIN = \"margin\";\r\n\tstatic BORDER = \"border\";\r\n\tstatic NUMBER = \"number\";\r\n\tstatic RADIO = \"radiobutton\";\r\n\tstatic SWITCH = \"switch\";\r\n\tstatic TEXT = \"text\";\r\n\tstatic COLOR_PICKER = \"color-picker\";\r\n}\r\n\r\nexport class InjectNames {\r\n\tstatic ADMINISTRATION_SERVICE = \"eirAdminisrationService\";\r\n\tstatic APP_ENV_CONSTANT = \"APP_ENV\";\r\n\tstatic BINDING_MANAGEMENT_SERVICE = \"eirBindingManagementService\";\r\n\tstatic BOUNDARY_MANAGEMENT_SERVICE = \"eirBoundaryManagementService\";\r\n\tstatic BUILD_ENV_CONSTANT = \"BUILD_ENV\";\r\n\tstatic COMMON_SERVICE = \"eirCommonService\";\r\n\tstatic COMPOSITE_COMPONENT_MANAGEMENT_SERVICE = \"eirCompositeComponentService\";\r\n\tstatic CONFLICT_RESOLUTION_SERVICE = \"eirConflictResolutionService\";\r\n\tstatic DATASOURCE_SERVICE = \"eirDatasourceService\";\r\n\tstatic DESIGNER_COMPONENT_SERVICE = \"eirFrameworkService\";\r\n\tstatic DESIGNER_SERVICE = \"eirDesignerService\";\r\n\tstatic DIALOG_SERVICE = \"eirDialogService\";\r\n\tstatic EDITOR_SERVICE = \"eirEditorService\";\r\n\tstatic EXPRESSION_SERVICE = \"eirExpressionService\";\r\n\tstatic FEATURE_SWITCH_SERVICE = \"eirFeatureSwitchService\";\r\n\tstatic FRAMEWORK_SERVICE = \"eirFrameworkService\";\r\n\tstatic HASH_SERVICE = \"eirHashService\";\r\n\tstatic HOTKEY_SERVICE = \"eirHotkeyService\";\r\n\tstatic HTTP_SERVICE = \"eirHttpService\";\r\n\tstatic HUB_SERVICE = \"eirHubService\";\r\n\tstatic INSERT_COMPONENT_SERVICE = \"eirInsertComponentService\";\r\n\tstatic INTERACTION_MANAGEMENT_SERVICE = \"eirInteractionManagementService\";\r\n\tstatic ION_API_SERVICE = \"eirIonApiService\";\r\n\tstatic ION_METADATA_SERVICE = \"eirIonMetadataService\";\r\n\tstatic LANGUAGE_SERVICE = \"eirLanguageService\";\r\n\tstatic LOCAL_IDO_SERVICE = \"eirLocalIdoService\";\r\n\tstatic MINGLE_SERVICE = \"eirMingleService\";\r\n\tstatic NO_CACHE_INTERCEPTOR = \"noCacheInterceptor\";\r\n\tstatic PROJECT_SERVICE = \"eirProjectService\";\r\n\tstatic REPOSITORY_SERVICE = \"eirRepositoryService\";\r\n\tstatic RUNTIME_SERVICE = \"eirRuntimeService\";\r\n\tstatic SAVE_SERVICE = \"eirSaveService\";\r\n\tstatic TAG_SERVICE = \"eirTagService\";\r\n\tstatic THEME_SERVICE = \"eirThemeService\";\r\n\tstatic TRANSLATION_MANAGEMENT_SERVICE = \"eirTranslationManagementService\";\r\n\tstatic UNDO_SERVICE = \"eirUndoService\";\r\n}\r\n\r\nexport class ProjectFileKeys {\r\n\tstatic ROOT_COMPONENT = \"rootcomponent\";\r\n\tstatic DATASOURCE = \"datasources\";\r\n\tstatic INTERACTION = \"interactions\";\r\n\tstatic CUSTOM_COMPONENT = \"customcomponents\";\r\n\tstatic COMPOSITE_COMPONENTS = \"compositecomponents\";\r\n\tstatic TRANSLATIONS = \"translations\";\r\n\r\n}\r\n\r\nexport class MimeTypes {\r\n\tstatic COMPONENT = \"component\";\r\n\tstatic DATASOURCE = \"datasources\";\r\n\tstatic INTERACTION = \"interactions\";\r\n\tstatic CUSTOM_COMPONENT = \"customcomponents\";\r\n\tstatic COMPOSITE_COMPONENTS = \"compositecomponents\";\r\n\tstatic TRANSLATIONS = \"translations\";\r\n}\r\n\r\nexport enum InteractionActionEnum {\r\n\tADD_TEXT = \"AddText\",\r\n\tDISABLE = \"Disable\",\r\n\tGET = \"Get\",\r\n\tLIST = \"List\",\r\n\tSET_CURRENT_ITEM = \"SetCurrentItem\",\r\n\tCLEAR = \"Clear\"\r\n}\r\n\r\nexport enum InteractionTriggerEnum {\r\n\tAPPLY = \"Apply\",\r\n\tBROADCAST = \"Broadcast\",\r\n\tBROWSE = \"Browse\",\r\n\tCLEAR = \"Clear\",\r\n\tCLICK = \"Click\",\r\n\tCHANGED = \"Changed\",\r\n\tCHECKED = \"IsChecked\",\r\n\tCLOSE = \"Close\",\r\n\tCREATE = \"Create\",\r\n\tCURRENT_ITEM_CHANGED = \"CurrentItemChanged\",\r\n\tCURRENT_ITEM_UPDATED = \"CurrentItemUpdated\",\r\n\tDELETE = \"Delete\",\r\n\tFILL_FORM = \"FillForm\",\r\n\tGO_TO_PAGE = \"GoToPage\",\r\n\tINITIALIZED = \"Initialized\",\r\n\tKEY_PRESS = \"KeyPress\",\r\n\tNEXT_PAGE = \"NextPage\",\r\n\tNONE = \"None\",\r\n\tON_LOAD = \"OnLoad\",\r\n\tON_COLUMN_UPDATED = \"OnColumnUpdated\",\r\n\tOPEN = \"Open\",\r\n\tPREV_PAGE = \"PrevPage\",\r\n\tREAD = \"Read\",\r\n\tRECEIVED = \"Received\",\r\n\tREFRESH = \"Refresh\",\r\n\tRIGHT_CLICK = \"RightClick\",\r\n\tRUNNING = \"Running\",\r\n\tSEND = \"Send\",\r\n\tSTARTUP = \"Startup\",\r\n\tTIME_RELAPSED = \"Elapsed\",\r\n\tTIMER_START = \"Start\",\r\n\tTIMER_STOP = \"Stop\",\r\n\tUNCHECKED = \"IsUnChecked\",\r\n\tUPDATE = \"Update\",\r\n\tUPDATE_COMPLETE = \"UpdateComplete\"\r\n}\r\n\r\nexport class ContextKeys {\r\n\tstatic DETAIL_RESULT = \"DetailResult\";\r\n\tstatic LIST_RESULT = \"ListResult\";\r\n}\r\n\r\nexport enum DirectionType {\r\n\tNONE = \"none\",\r\n\tBACK = \"back\",\r\n\tDIRECTIONAL = \"directional\"\r\n}\r\n\r\n// MUPS-1534: This is where we define ID:s for switched features\r\nexport enum FeatureIdEnum {\r\n\tShowFeatureCatalog = \"ShowFeatureCatalog\",\r\n\tTranslationService = \"TranslationService\"\r\n}\r\n\r\nexport const DEFAULT_BOUNDARY: IBoundary = {\r\n\tid: \"Default\",\r\n\tdisplayName: \"Default\",\r\n};\r\n\r\nexport class SettingKeys {\r\n\t// IJsonComponentSettings\r\n\tstatic readonly HEIGHT = \"height\";\r\n\tstatic readonly MARGIN = \"margin\";\r\n\tstatic readonly VISIBILITY = \"visibility\";\r\n\tstatic readonly WIDTH = \"width\";\r\n\tstatic readonly SHOW_ERROR = \"showError\";\r\n\t// IJsonFlexboxSettings\r\n\tstatic readonly SIZE = \"size\";\r\n\tstatic readonly SIZE_TYPE = \"sizeType\";\r\n\tstatic readonly ORIENTATION = \"orientation\";\r\n\tstatic readonly ALIGNMENT_HORIZONTAL = \"horizontalAlignment\";\r\n\tstatic readonly ALIGNMENT_VERTICAL = \"verticalAlignment\";\r\n\tstatic readonly OVERFLOW = \"overflow\";\r\n\t// IJsonListSettings\r\n\tstatic ITEM_TEMPLATE = \"itemTemplate\";\r\n\tstatic KEEP_SELECTED = \"keepSelected\";\r\n\tstatic readonly SEARCH = \"search\";\r\n\t// IJsonChartSettings\r\n\tstatic CHART_VIEW = \"chartView\";\r\n\tstatic readonly CHART_TYPE = \"chartType\";\r\n\tstatic readonly CHART_LEGEND_DISPLAY = \"legendDisplay\";\r\n\tstatic readonly CHART_STARTUP_ANIMATION_ENABLE = \"startupAnimationEnable\";\r\n\tstatic readonly CHART_TITLE = \"title\";\r\n\tstatic readonly CHART_AXIS_CATEGORY_TITLE = \"axisCategoryTitle\";\r\n\tstatic readonly CHART_AXIS_CATEGORY_UNITS = \"axisCategoryUnits\";\r\n\tstatic readonly CHART_AXIS_VALUES_TITLE = \"axisValuesTitle\";\r\n\tstatic readonly CHART_AXIS_VALUES_UNITS = \"axisValuesUnits\";\r\n\t// IJsonLookupSettings\r\n\tstatic readonly LOOKUP_OUTPUT_ID = \"lookupOutputId\";\r\n\t// IJsonTextAreaSettings\r\n\tstatic readonly IS_RESIZABLE = \"resizable\";\r\n\tstatic readonly MAX_LENGTH = \"maxLength\";\r\n\t// IJsonDatagridSettings\r\n\tstatic readonly ROW_HEIGHT = \"rowHeight\";\r\n\tstatic readonly USE_PAGING = \"usePaging\";\r\n\tstatic readonly PAGE_SIZE = \"pageSize\";\r\n\tstatic readonly SUMMARY_ROW = \"summaryRow\";\r\n\tstatic readonly ROW_COUNT = \"rowCount\";\r\n\tstatic readonly FILTER_BAR = \"filterBar\";\r\n\tstatic readonly ENABLE_EXPORT = \"enableExport\";\r\n\tstatic readonly ROW_COUNT_OUTPUT = \"rowCountOutput\";\r\n\tstatic readonly SUMMARY_OUTPUT = \"summaryOutput\";\r\n\t// IJsonDatepicker\r\n\tstatic readonly DATE_FORMAT_SHOW = \"dateFormatShow\";\r\n\tstatic readonly DATE_FORMAT_BINDING = \"dateFormatBinding\";\r\n\tstatic readonly DATE_FORMAT_INPUT = \"dateFormatInput\";\r\n\tstatic readonly DATE_FORMATTED = \"dateFormatted\";\r\n\tstatic readonly DATE_VALUE = \"dateValue\";\r\n\tstatic readonly DATE_TODAY = \"isDefaultTodayDate\";\r\n\t//TextBox\r\n\tstatic readonly BOX_WIDTH = \"boxWidth\";\r\n\t//IJsonTimepicker\r\n\tstatic readonly TIME_FORMAT = \"timeFormat\";\r\n\tstatic readonly ENABLE_SECONDS = \"enableSeconds\";\r\n\tstatic readonly TIME_VALUE = \"timeValue\";\r\n\r\n\t// ApplicationParent\r\n\tstatic readonly LANGUAGE = \"language\";\r\n\tstatic readonly LANGUAGE_SHORT = \"languageShort\";\r\n\tstatic readonly USER_NAME = \"userName\";\r\n\tstatic readonly USER_DESCRIPTION = \"userDescription\";\r\n\tstatic readonly TIMESTAMP = \"timestamp\";\r\n\tstatic readonly APPLICATION_HEADER = \"applicationHeader\";\r\n\r\n\t//Settings\r\n\tstatic readonly BACKGROUND_COLOR = \"backgroundColor\";\r\n\tstatic readonly BORDER = \"border\";\r\n\tstatic readonly BORDER_COLOR = \"borderColor\";\r\n\tstatic readonly CHECK_STATE = \"checkboxState\";\r\n\tstatic readonly COLOR = \"color\";\r\n\tstatic readonly CONTENT = \"content\";\r\n\tstatic readonly CURRENT_ITEM = \"currentItem\";\r\n\tstatic readonly CURRENT_ITEM_NAME = \"currentItemName\";\r\n\tstatic readonly CURRENT_ITEM_VALUE = \"currentItemValue\";\r\n\tstatic readonly DISPLAY_VALUE = \"displayValue\";\r\n\tstatic readonly DIRECTION = \"direction\";\r\n\tstatic readonly FONT_STYLE = \"fontStyle\";\r\n\tstatic readonly FONT_CHAR = \"fontChar\";\r\n\tstatic readonly IS_DEFAULT = \"isDefault\";\r\n\tstatic readonly IS_DRILLBACK = \"isDrillback\";\r\n\tstatic readonly IS_LIST = \"isList\";\r\n\tstatic readonly IS_READONLY = \"isReadonly\";\r\n\tstatic readonly LABEL = \"label\";\r\n\tstatic readonly LINK_VALUE = \"link\";\r\n\tstatic readonly MULTI_SELECT = \"multiSelect\";\r\n\tstatic readonly PLACEHOLDER = \"placeholder\";\r\n\tstatic readonly POSITION = \"position\";\r\n\tstatic readonly SELECTED_ITEM = \"selectedItem\";\r\n\r\n\tstatic readonly DIRTY_ITEMS = \"dirtyItems\";\r\n\tstatic readonly SHOW_LABEL = \"showLabel\";\r\n\tstatic readonly SOURCE = \"source\";\r\n\tstatic readonly STYLE = \"style\";\r\n\tstatic readonly TEXT = \"text\";\r\n\tstatic readonly TOOLTIP = \"toolTip\";\r\n}\r\n\r\nexport class DateFormat {\r\n\tstatic FORMAT_1 = \"MM/dd/yyyy\";\r\n\tstatic FORMAT_2 = \"yyyy/MM/dd\";\r\n\tstatic FORMAT_3 = \"dd-MM-yyyy\";\r\n\tstatic FORMAT_4 = \"dd/MM/yyyy hh:mm\";\r\n\tstatic ISO8601 = \"yyyy-MM-dd\";\r\n\tstatic M3 = \"yyyyMMdd\";\r\n\tstatic AUTOMATIC = \"AUTO\";\r\n\tstatic RAW = \"RAW\";\r\n}\r\n\r\nexport class LanguageConsts {\r\n\t/*static UNSUPPORTED_LANGUAGES = [\r\n\t\t\"ar-SA\",\r\n\t\t\"he-IL\",\r\n\t\t\"zh-TW\",\r\n\t\t\"pt-BR\"\r\n\t];*/\r\n\r\n\tstatic readonly SUPPORTED_LANGUAGES = [\r\n\t\t{ key: \"ar-SA\", value: \"Arabic (Saudi Arabia)\" },\r\n\t\t{ key: \"zh-CN\", value: \"Chinese (S)\" },\r\n\t\t{ key: \"zh-TW\", value: \"Chinese (T)\" },\r\n\t\t{ key: \"cs-CZ\", value: \"Czech (Czech Republic)\" },\r\n\t\t{ key: \"da-DK\", value: \"Danish (Denmark)\" },\r\n\t\t{ key: \"nl-NL\", value: \"Dutch (Netherlands)\" },\r\n\t\t{ key: \"en-US\", value: \"English (United States)\" },\r\n\t\t{ key: \"fi-FI\", value: \"Finnish (Finland)\" },\r\n\t\t{ key: \"fr-FR\", value: \"French (France)\" },\r\n\t\t{ key: \"de-DE\", value: \"German (Germany)\" },\r\n\t\t{ key: \"he-IL\", value: \"Hebrew (Israel)\" },\r\n\t\t{ key: \"hu-HU\", value: \"Hungarian (Hungary)\" },\r\n\t\t{ key: \"it-IT\", value: \"Italian (Italy)\" },\r\n\t\t{ key: \"ja-JP\", value: \"Japanese (Japan)\" },\r\n\t\t{ key: \"nb-NO\", value: \"Norwegian (Norway)\" },\r\n\t\t{ key: \"pl-PL\", value: \"Polish (Poland)\" },\r\n\t\t{ key: \"pt-BR\", value: \"Portuguese (Brazil)\" },\r\n\t\t{ key: \"ru-RU\", value: \"Russian (Russia)\" },\r\n\t\t{ key: \"es-ES\", value: \"Spanish (Spain)\" },\r\n\t\t{ key: \"sv-SE\", value: \"Swedish (Sweden)\" },\r\n\t\t{ key: \"th-TH\", value: \"Thai (Thailand)\" },\r\n\t\t{ key: \"tr-TR\", value: \"Turkish (Turkey)\" },\r\n\t\t{ key: \"vi-VN\", value: \"Vietnamese (Vietnam)\" },\r\n\t\t{ key: \"el-GR\", value: \"Greek (Greece)\" },\r\n\t\t{ key: \"af-ZA\", value: \"Afrikaans (South Africa)\" },\r\n\t\t{ key: \"pt-PT\", value: \"Portuguese (Portugal)\" },\r\n\t\t{ key: \"uk-UA\", value: \"Ukrainian (Ukraine)\" }\r\n\t] as IMingleLanguage[];\r\n\r\n\t//tslint:disable:no-magic-numbers\r\n\tstatic DEFAULT = LanguageConsts.SUPPORTED_LANGUAGES[6] as IMingleLanguage;\r\n\t//tslint:enable:no-magic-numbers\r\n}\r\n\r\nexport class MinInterval {\r\n\tstatic ONE = 1;\r\n\tstatic FIVE = 5;\r\n\tstatic TEN = 10;\r\n\tstatic FIFTEEN = 15;\r\n}\r\n\r\nexport class HourMode {\r\n\tstatic TWELVE = \"h:mm a\";\r\n\tstatic TWENTYFOUR = \"HH:mm\";\r\n}\r\n\r\nexport interface IRowHeight {\r\n\tname: string;\r\n\tvalue: string;\r\n}\r\n\r\nexport class ButtonStyle {\r\n\tstatic PRIMARY = \"primary\";\r\n\tstatic SECONDARY = \"secondary\";\r\n\tstatic TERTIARY = \"tertiary\";\r\n\tstatic FILL = \"full-width\";\r\n}\r\n\r\nexport class SubstitutionTags {\r\n\tstatic readonly VALUE = \"{$value}\";\r\n}\r\n\r\nexport class ValueObject {\r\n\tstatic TARGET_CONTEXT = \"{In Context Value}\";\r\n\tstatic STATIC_VALUE = \"{Static Value}\";\r\n\tstatic URL_VALUE = \"{URL Value}\";\r\n}\r\n\r\nexport class InteractionPairOperation {\r\n\tstatic readonly CLEAR: IDataPair = { name: \"Clear\", value: InteractionActionEnum.CLEAR };\r\n\tstatic readonly GET: IDataPair = { name: \"Get\", value: InteractionActionEnum.GET };\r\n\tstatic readonly LIST: IDataPair = { name: \"List\", value: InteractionActionEnum.LIST };\r\n\tstatic readonly ON_LOAD: IDataPair = { name: \"On Load\", value: InteractionTriggerEnum.ON_LOAD };\r\n\tstatic readonly ON_ITEM_CHANGED: IDataPair = {\r\n\t\tname: \"On Selection Changed\", value: InteractionTriggerEnum.CURRENT_ITEM_CHANGED\r\n\t};\r\n\tstatic readonly ON_ITEM_UPDATED: IDataPair = {\r\n\t\tname: \"On Row Updated\", value: InteractionTriggerEnum.CURRENT_ITEM_UPDATED\r\n\t};\r\n\tstatic readonly ON_STARTUP: IDataPair = { name: \"On Startup\", value: InteractionTriggerEnum.STARTUP };\r\n\tstatic readonly ON_CLOSE: IDataPair = { name: \"On Close\", value: InteractionTriggerEnum.CLOSE };\r\n\tstatic readonly ON_CLICK: IDataPair = { name: \"On Click\", value: InteractionTriggerEnum.CLICK };\r\n\tstatic readonly ON_CHANGED: IDataPair = { name: \"On Changed\", value: InteractionTriggerEnum.CHANGED };\r\n\tstatic readonly IS_CHECKED: IDataPair = { name: \"On Checked\", value: InteractionTriggerEnum.CHECKED };\r\n\tstatic readonly IS_UNCHECKED: IDataPair = { name: \"On Not Checked\", value: InteractionTriggerEnum.UNCHECKED };\r\n\tstatic readonly NONE: IDataPair = { name: \"None\", value: \"\" };\r\n\tstatic readonly SET_CURRENT_ITEM: IDataPair = {\r\n\t\tname: \"Set Selection\",\r\n\t\tvalue: InteractionActionEnum.SET_CURRENT_ITEM\r\n\t};\r\n}\r\n\r\nexport class RowHeight {\r\n\tstatic SHORT = \"short\";\r\n\tstatic MEDIUM = \"medium\";\r\n\tstatic TALL = \"tall\";\r\n}\r\n\r\nexport class MaskProcess {\r\n\tstatic NONE = \"none\";\r\n\tstatic NUMBER = \"number\";\r\n\tstatic DATE_TIME = \"date\";\r\n\tstatic STRING = \"string\";\r\n\tstatic PASSWORD = \"password\";\r\n}\r\n\r\nexport interface IFilter {\r\n\tname: string;\r\n\tdefaultValue: any;\r\n}\r\n\r\nexport interface INewProject {\r\n\tprojectName: string;\r\n\tprojectDescription: string;\r\n\ttemplateNumber: number;\r\n\ttags?: IJsonTag[];\r\n}\r\n\r\nexport enum ImagePositions {\r\n\tFILL = \"fill\",\r\n\tFIT = \"fit\",\r\n\tCENTER = \"center\"\r\n}\r\n\r\nexport interface IWizardFocusType {\r\n\tfocus: number;\r\n\tcomponent: IJsonComponent;\r\n\tsetting: string;\r\n}\r\n\r\nexport enum MarginType {\r\n\tALL = 1,\r\n\tINDIVIDUAL = 2\r\n}\r\nexport enum BorderType {\r\n\tALL = 1,\r\n\tINDIVIDUAL = 2\r\n}\r\nexport interface IChanged {\r\n\tsavedComponentStrings: IComponentTranslation[];\r\n\tsavedGlobalStrings: IMap<IMongooseString[]>;\r\n\tdeletedGlobalStrings: IMap<IMongooseString[]>;\r\n}\r\n\r\nexport interface IComponentTranslation {\r\n\tcomponent: string;\r\n\treference: string;\r\n\tnewValue: string;\r\n}\r\n\r\n/* tslint:disable:max-line-length */\r\nexport class ImageBase64 {\r\n\tstatic DEFAULT = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAMAAAGiQbecAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFEUExURQAAAFtbW1tbW1paWlxcXFtbW1paWlhYWFxcXFpaWlxcXFlZWVtbW11dXVtbW1paWl1dXVlZWV1dXVtbW1xcXFpaWllZWf///2RkZFxcXFtbW11dXV1dXVxcXFtbW0hISFpaWqqqqlpaWltbW1xcXFtbW1lZWVtbW1xcXF1dXVpaWlxcXF1dXVxcXFlZWVxcXFxcXFpaWlpaWlpaWl5eXl5eXltbW19fX1lZWVRUVFtbW39/f1xcXF5eXltbW1tbW3FxcVxcXFpaWlpaWltbW1tbW11dXVtbW1paWktLS1tbW1paWlpaWltbW1lZWVxcXFpaWl9fX2FhYVtbW1VVVVpaWmBgYF9fX1hYWFtbW19fX1tbW1paWltbW1paWltbW1xcXFtbW11dXVxcXFlZWVlZWVpaWmZmZl1dXVtbW1VVVVtbW8YYTK4AAABsdFJOUwCDxJ5Ci6Y0+u/n9xlSyU9taojRo5jhARwWcin/2bMHzgPpegu7b1SoOd6VJoKlw7Dm0z4bNlkI0BL2AnQrTv4JfHGyQ8W9880R4Lro+1tmrzAVnAwiHTgX+FORx5m0hu0yv9r9FLwKc5YG17qYuwUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAItSURBVFhH7ZjpW9NAEMbXW/HEuzoV8UJFxWor9UJRwFsoqBUUwQPP//+7s5M36SapOVsefJ75fejO7My7s0k3x8YUhSywGcccd+xwWsjpH1LGryPtgphe5JnrUMhZh7kVoTOtX2gBB16ZH9byDwN4R8NsjwbqPkfQo+RlE84tsxNdHs7yCa8k8WhfYAawd+duYDqQ/QvXlqpiulDDq8xr9V+BZnQo/OP1tXDgK/KZAXQpSlmwpKIg2oVOrLUNBt/QMgm+0T1Y6QI7iTfcvpOuNEFFJs3Yq311jK6mCYLLL2Aur6CZLOgKooqiKBuf4d24c4WZRDhOFRlREI5To3lYLomCt7DMyn4YGQWjTlYmwc08glt0wZjfXo8lTWCfVcvWq0hfquCinMgZY3bRDjNkexMFxz9KPtHpJ/zziOhhiiB4iAbcziuwL8IIx1kPwXu8PDskCV5i0CgIx7mChAhTCCuKoiiKomxszp29XMvKQflwnY8TeDvKRoGvmmdYNjuRiRecClUOaqwKdhvJLPSswMmjRIuv4XToXYEt3EeH4HToQYGRmUFpJ66dGjwmlkvZAsMHFtmmD7yR6U65AuOjD+zwlk/elqx942lLDJ8yBSrXZWif6ftmRDbXq3tN/Tv99FKLF6hcsoMlsWz3jCUKxD+Bxviyp88F6E+/CzRLFJhvyxDJVAsWGGDVUqOVzuf240IFDtvZZeY5VHlobMbTJJ3zW6FRFEVR/kuM+QtaNbQNSNPAaQAAAABJRU5ErkJggg==\";\r\n}\r\n/* tslint:enable:max-line-length */\r\n\r\nexport enum ListTemplateIdEnum {\r\n\tOneLabelFlexbox = \"OneLabelFlexbox\",\r\n\tTwoVerticalLabels = \"TwoVerticalLabels\",\r\n\tImageAndLabels = \"ImageAndLabels\",\r\n\tOneHyperlink = \"OneHyperlink\",\r\n\tOneHyperlinkAndLabel = \"OneHyperlinkAndLabel\",\r\n\tImageLabelAndHyperlink = \"ImageLabelAndHyperlink\"\r\n}\r\n\r\n/**\r\n * Class contain limit setting for max datasource, and composite component in project\r\n *\r\n * @export\r\n * @class ProjectLimit\r\n */\r\nexport class ProjectLimit {\r\n\tstatic readonly MAX_BOUNDARIES: number = 11; //10 + default boundary\r\n\tprivate static maxDatasource = 50;\r\n\tstatic get MAX_DATASOURCES(): number { return this.maxDatasource; }\r\n\r\n\tprivate static maxCompositeComponent = 50;\r\n\tstatic get MAX_COMPOSITE_COMPONENTS(): number { return this.maxCompositeComponent; }\r\n\r\n\tprivate static errorMessage(item: string): string {\r\n\t\treturn \"The maximum amount of \" + item + \" has been reached. Please delete \" + item + \"(s) before adding new ones.\";\r\n\t}\r\n\r\n\tprivate static importErrorMessage(item: string): string {\r\n\t\treturn \"Import would exceed allowed \" + item + \". Please delete \" + item + \"(s) before importing new ones.\";\r\n\t}\r\n\r\n\tstatic get COMPOSITE_COMPONENT_ERROR_MESSAGE(): string { return this.errorMessage(\"composite components\"); }\r\n\tstatic get COMPOSITE_COMPONENT_IMPORT_ERROR_MESSAGE(): string {\r\n\t\treturn this.importErrorMessage(\"composite component\");\r\n\t}\r\n\r\n\tstatic get DATASOURCE_ERROR_MESSAGE(): string { return this.errorMessage(\"data services\"); }\r\n\tstatic get DATASOURCE_IMPORT_ERROR_MESSAGE(): string {\r\n\t\treturn this.importErrorMessage(\"data service\");\r\n\t}\r\n}\r\n\r\n/**\r\n * The different subcodes that the server gives.\r\n *\thttps://wiki.infor.com/confluence/display/IAB/Server+error+types\r\n\t*\r\n\t* @export\r\n\t* @class Subcodes\r\n\t*/\r\nexport class Subcodes {\r\n\tstatic readonly CONTACT_SYSTEM_ADMIN = \"Please contact system administrator\";\r\n\r\n\tstatic readonly GENERIC_ERROR = 4000;\r\n\tstatic readonly UNABLE_TO_UNZIP_ERROR = 4001;\r\n\tstatic readonly GENERIC_ID_ERROR = 4100;\r\n\tstatic readonly PROJECT_ID_CONFLICT = 4101;\r\n\tstatic readonly PROJECT_DISPLAYNAME_CONFLICT = 4102;\r\n\tstatic readonly PROJECT_IMPORT_ERROR = 4103;\r\n\tstatic readonly DATA_SERVICE_ERROR = 4104;\r\n}\r\n\r\nexport class StatusCodes {\r\n\tstatic success = [\r\n\t\t\"200\",\r\n\t\t\"201\",\r\n\t\t\"202\",\r\n\t\t\"203\",\r\n\t\t\"204\",\r\n\t\t\"205\",\r\n\t\t\"206\"\r\n\t];\r\n}\r\n\r\nexport class FileExtensions {\r\n\tstatic readonly PROJECT = \"iap\";\r\n\tstatic readonly DATA_SERVICE = \"iads\";\r\n\tstatic readonly COMPOSITE_COMPONENT = \"iac\";\r\n}\r\n\r\nexport enum CSSClasses {\r\n\tmashupRootContainer = \"mashupRootContainer\",\r\n}\r\n\r\nexport enum ElementDataKeys {\r\n\tisMashupReady = \"isMashupReady\",\r\n\tmanageCompositesCtrl = \"manageCompositesCtrl\",\r\n\tcompositeTabCtrl = \"compositeTabCtrl\",\r\n\tallProjectsToolbar = \"allProjectsToolbar\"\r\n}\r\n\r\nexport class ComponentClassNames {\r\n\tstatic readonly EDITOR_COMPONENT_PREFIX = \"editor-\";\r\n\tstatic readonly COMPONENT = \"Component\";\r\n}\r\n\r\n//#region Mongoose Constant\r\nexport class ABFormScriptMethod {\r\n\tstatic readonly SHOW_OPEN_FILE_DIALOG = \"ShowOpenFileDialog\";\r\n\tstatic readonly SHOW_SAVE_FILE_DIALOG = \"ShowSaveFileDialog\";\r\n\tstatic readonly TOKEN = \"token\";\r\n\tstatic readonly APPBUILDER_REST = \"appbuilderrest\";\r\n}\r\n//#endregion\r\n\r\nexport class RegexStrings {\r\n\tstatic GLOBALSTRING = \"\\{([^)]+)\\}\";\r\n\r\n\t/* tslint:disable-next-line:max-line-length */\r\n\tstatic EMAIL = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n\tstatic SPECIAL_CHARACTERS = /[?!@#\\$%\\^\\&*\\)\\(+=._-]+/;\r\n\tstatic NUMERIC = /^-?[0-9]+$/;\r\n\tstatic NO_NUMERIC = /\\d+/g;\r\n\tstatic NUMERIC_NO_NEGATIVE = /^[0-9]+$/;\r\n\tstatic NEW_LINES = /(\\r\\n|\\n|\\r)/gm;\r\n\tstatic STARTS_WITH_NUMBER = /^\\d/;\r\n\tstatic NO_SPECIAL = /[^a-zA-Z0-9-_.]/g;\r\n\tstatic TIME = /(?:(?:0?[0-9]|1[0-2]):[0-5][0-9](:[0-5][0-9])? [aApP][mM]|(?:[01][0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?)$/;\r\n\tstatic FIRST_CHAR_LETTER = /^[a-zA-Z]/;\r\n}\r\n\r\nexport enum  GridAggregators {\r\n\tSUM = \"sum\",\r\n}\r\n\r\nexport enum  SummaryTextPlacement {\r\n\tBEFORE = \"before\",\r\n\tAFTER = \"after\",\r\n}\r\n\r\nexport enum TextAlignment {\r\n\tLEFT = \"left\",\r\n\tRIGHT = \"right\",\r\n\tCENTER = \"center\"\r\n}\r\n\r\nexport class DatagridExportTypes {\r\n\tstatic readonly EXCEL = \"excel\";\r\n\tstatic readonly CSV = \"csv\";\r\n}\r\n\r\nexport class IdoDataType {\r\n\tstatic readonly file = \"File\";\r\n\tstatic readonly boolean = \"Boolean\";\r\n\tstatic readonly date = \"Date\";\r\n\tstatic readonly decimal = \"Decimal\";\r\n\tstatic readonly integer = \"Integer\";\r\n\tstatic readonly string = \"String\";\r\n}\r\n\r\nexport class ComponentNames {\r\n\tstatic readonly Chart = \"Chart\"\r\n\tstatic readonly Datagrid = \"Datagrid\"\r\n\tstatic readonly Dropdown = \"Dropdown\"\r\n\tstatic readonly Flexbox = \"Flexbox\"\r\n\tstatic readonly List = \"List\"\r\n\tstatic readonly Lookup = \"Lookup\"\r\n\tstatic readonly RadioButton = \"RadioButton\"\r\n\tstatic readonly Tabs = \"Tabs\"\r\n\tstatic readonly TabPanel = \"TabPanel\"\r\n\tstatic readonly TextBox = \"TextBox\"\r\n}\r\n","export class AngularConstants {\r\n\tpublic static readonly CACHE_FACTORY = \"$cacheFactory\";\r\n\tpublic static readonly COMPILE = \"$compile\";\r\n\tpublic static readonly CONTROLLER = \"$controller\";\r\n\tpublic static readonly DESTROY = \"$destroy\";\r\n\tpublic static readonly ELEMENT = \"$element\";\r\n\tpublic static readonly FILTER = \"$filter\";\r\n\tpublic static readonly HTTP = \"$http\";\r\n\tpublic static readonly INTERVAL = \"$interval\";\r\n\tpublic static readonly Q = \"$q\";\r\n\tpublic static readonly ROOT_SCOPE = \"$rootScope\";\r\n\tpublic static readonly ROUTE = \"$route\";\r\n\tpublic static readonly SCOPE = \"$scope\";\r\n\tpublic static readonly STATE_PARAMS = \"$stateParams\";\r\n\tpublic static readonly STATE_SERVICE = \"$state\";\r\n\tpublic static readonly TEMPLATE_CACHE = \"$templateCache\";\r\n\tpublic static readonly TIMEOUT = \"$timeout\";\r\n\tpublic static readonly WINDOW = \"$window\";\r\n}\r\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\r\n// TODO: Fix the so that documentMode is in document global\r\nimport angular from \"angular\";\r\nimport filter from \"lodash-es/filter\";\r\nimport find from \"lodash-es/find\";\r\nimport union from \"lodash-es/union\";\r\n\r\nimport type { ILayoutComponent } from \"./interface/ilayout-component\";\r\n\r\nimport type { IListComponent } from \"./interface/ilist-component\";\r\n\r\nimport {\r\n\tComponentConstants,\r\n\tCSSClasses,\r\n\tElementDataKeys,\r\n\tNumbers,\r\n\tRegexStrings,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport type { IProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nexport enum RegExpMatchCandidate { BASE_NAME = 1, IS_COPY = 2, NUMBER = 3 }\r\n\r\nexport class Helper {\r\n\r\n\t/**\r\n\t * Gets the date based on the format param\r\n\t * Supported formats:\r\n\t *\r\n\t *\t* yyyy-mm-dd\r\n\t\t*\r\n\t\t* Defaults to yyyy-mm-ddThh:mm\r\n\t\t*\r\n\t\t* @static\r\n\t\t* @param {(\"yyyy-mm-dd\" | undefined)} format\r\n\t\t* @returns {string}\r\n\t\t* @memberof Helper\r\n\t\t*/\r\n\tstatic getFormattedDate(format = \"yyyy-mm-dd\"): string {\r\n\t\t//tslint:disable:no-magic-numbers\r\n\t\tconst date = new Date();\r\n\t\tconst year = date.getFullYear();\r\n\r\n\t\tconst month = (date.getMonth() + 1).toString();\r\n\t\tconst formattedMonth = month.padStart(2, \"0\");\r\n\r\n\t\tconst day = date.getDate().toString();\r\n\t\tconst formattedDay = day.padStart(2, \"0\");\r\n\r\n\t\tconst hour = date.getHours().toString();\r\n\t\tconst formattedHour = hour.padStart(2, \"0\");\r\n\r\n\t\tconst minute = date.getMinutes().toString();\r\n\t\tconst formattedMinute = minute.padStart(2, \"0\");\r\n\r\n\t\tconst second = date.getSeconds().toString();\r\n\t\tconst formattedSecond = second.padStart(2, \"0\");\r\n\r\n\t\tconst millisecond = date.getMilliseconds().toString();\r\n\t\tconst formattedMilleSecond = millisecond.padStart(3, \"0\");\r\n\t\t//tslint:enable:no-magic-numbers\r\n\r\n\t\t//tslint:disable:max-line-length\r\n\t\tswitch (format) {\r\n\t\t\tcase \"yyyy-mm-dd\":\r\n\t\t\t\treturn `${year}-${formattedMonth}-${formattedDay}`;\r\n\t\t\tcase \"yyyymmdd HH:mm:ss.fff\":\r\n\t\t\t\treturn `${year}${formattedMonth}${formattedDay} ${formattedHour}:${formattedMinute}:${formattedSecond}.${formattedMilleSecond}`;\r\n\t\t\tdefault: //YYYY-MM-DDTHH:mm\r\n\t\t\t\treturn `${year}-${formattedMonth}-${formattedDay}T${formattedHour}:${formattedMinute}`;\r\n\t\t}\r\n\t\t//tslint:enable:max-line-length\r\n\t}\r\n\r\n\tstatic become(obj: any, newClass: any): void {\r\n\t\tobj.__proto__ = ((new newClass())).__proto__;\r\n\t}\r\n\r\n\tstatic getDeepValue(obj: any, paths: string): any | null {\r\n\t\tfor (let i = 0, path = paths.split(\".\"), len = path.length; i < len; i++) {\r\n\t\t\tif (!this.isUndefinedOrNull(obj[path[i]])) {\r\n\t\t\t\tobj = obj[path[i]];\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tstatic setDeepValue(obj: any, paths: string, newValue: any): void {\r\n\t\tfor (var i = 0, path = paths.split(\".\"), secondToLast = path.length - 1; i < secondToLast; i++) {\r\n\t\t\tif (!obj[path[i]]) {\r\n\t\t\t\tobj[path[i]] = {};\r\n\t\t\t}\r\n\t\t\tobj = obj[path[i]];\r\n\t\t}\r\n\t\tobj[path[i]] = newValue;\r\n\t}\r\n\r\n\tstatic stringReplace(str: string, context: IMap<string>): string {\r\n\t\tconst reg = /({\\w+})/g;\r\n\t\treturn str.replace(reg, (match: string, $1: any, $2: any) => {\r\n\t\t\tconst trimmed = /{(\\w+)}/.exec(match)[1];\r\n\r\n\t\t\treturn context[trimmed];\r\n\t\t});\r\n\t}\r\n\r\n\tstatic getStringParameters(str: string): string[] {\r\n\t\tconst reg = /({\\w+})/g;\r\n\t\tconst match = str.match(reg);\r\n\t\tif (match) {\r\n\t\t\treturn match.map((hit) => {\r\n\t\t\t\treturn hit.match(/\\w+/g)[0];\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn [];\r\n\t}\r\n\r\n\tstatic isUndefined(anyObject: any): boolean {\r\n\t\treturn typeof anyObject === \"undefined\";\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if object is undefined or null\r\n\t * @param anyObject\r\n\t */\r\n\tstatic isUndefinedOrNull(anyObject: any): boolean {\r\n\t\treturn anyObject === undefined || anyObject === null;\r\n\t}\r\n\r\n\tstatic isFloat(value: string | number): boolean {\r\n\t\treturn !this.isInt(value);\r\n\t}\r\n\r\n\tstatic isInt(value: string | number): boolean {\r\n\t\treturn Number(value) % 1 === 0;\r\n\t}\r\n\r\n\tprivate static chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\r\n\r\n\t/**\r\n\t * Creates a string with random uppercase letters and numbers.\r\n\t * The default length is 16 if the stringLength parameter is omitted.\r\n\t */\r\n\tstatic random(stringLength = 16): string {\r\n\t\tconst chars = this.chars;\r\n\t\tlet randomstring = \"\";\r\n\t\tfor (let i = 0; i < stringLength; i++) {\r\n\t\t\tconst rnum = Math.floor(Math.random() * chars.length);\r\n\t\t\trandomstring += chars.substring(rnum, rnum + 1);\r\n\t\t}\r\n\r\n\t\treturn randomstring;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if string is undefined, null or empty\r\n\t *\r\n\t * @static\r\n\t * @param {string} item\r\n\t * @returns {string}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic isUndefinedEmpty(item: string): boolean {\r\n\t\treturn (item === undefined || item === null || item === \"\") ? true : false;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a list of strings by regex\r\n\t *\r\n\t * @static\r\n\t * @param {string} regex\r\n\t * @param {string} myString\r\n\t * @returns {string[]}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic getListByRegex(regex: string, myString: string): string[] {\r\n\t\tconst group = 2;\r\n\t\tconst cleanedString = myString.match(regex)[group];\r\n\t\tconst readyList = cleanedString.substring(1, cleanedString.length - 1).split(\",\");\r\n\t\treturn readyList;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a query parameter string with same key for all values\r\n\t *\r\n\t * @param {string[]} values\r\n\t * @param {string} key\r\n\t */\r\n\tstatic createQueryParameters(values: string[], key: string): string {\r\n\t\treturn values.map((value) => {\r\n\t\t\treturn key + \"=\" + value;\r\n\t\t}).join(\"&\");\r\n\t}\r\n\r\n\t/**\r\n\t * Deep trim trailing whitespace in object\r\n\t *\r\n\t * @param {string[]} array\r\n\t * @returns {string[]}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic deepObjectTrim(objectToTrim: Object): Object {\r\n\t\tconst deepTrim = (object: any) => {\r\n\t\t\tconst properties = Object.keys(object);\r\n\t\t\tproperties.forEach((property: string) => {\r\n\t\t\t\tif (typeof object[property] === \"string\") {\r\n\t\t\t\t\tobject[property] = object[property].trim();\r\n\t\t\t\t} else if (typeof object[property] === \"object\") {\r\n\t\t\t\t\tdeepTrim(object[property]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\tdeepTrim(objectToTrim);\r\n\t\treturn objectToTrim;\r\n\t}\r\n\r\n\tstatic getListFromMap<T>(list: IMap<T[]>): T[] {\r\n\t\tlet arrayList: T[] = [];\r\n\t\tfor (const key in list) {\r\n\t\t\tarrayList = arrayList.concat(list[key]);\r\n\t\t}\r\n\t\treturn arrayList;\r\n\t}\r\n\r\n\t/**\r\n\t * Sorts an object based on selected property\r\n\t *\r\n\t * @static\r\n\t * @template T\r\n\t * @param {any[]} object\r\n\t * @param {string} property\r\n\t * @returns {any[]}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic sortObjectByProperty(object: any[], property: string, reverse = false): any[] {\r\n\t\tconst output = reverse ? [1, -1] : [-1, 1];\r\n\t\treturn object.sort((a, b): number => {\r\n\t\t\tif (a[property] < b[property]) {\r\n\t\t\t\treturn output[0];\r\n\t\t\t}\r\n\t\t\tif (a[property] > b[property]) {\r\n\t\t\t\treturn output[1];\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t}\r\n\r\n\tstatic sortObjectKeys<T>(unordered: IMap<T>, doNotSortKey?: string): IMap<T> {\r\n\t\tconst ordered: IMap<T> = {};\r\n\t\tconst sortedKeys = Object.keys(unordered).sort();\r\n\r\n\t\tif (doNotSortKey) {\r\n\t\t\tsortedKeys.splice(sortedKeys.indexOf(doNotSortKey), 1);\r\n\t\t\tsortedKeys.unshift(doNotSortKey);\r\n\t\t}\r\n\r\n\t\tsortedKeys.forEach(key => {\r\n\t\t\tordered[key] = unordered[key];\r\n\t\t});\r\n\r\n\t\treturn ordered;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if object has property with value\r\n\t *\r\n\t * @static\r\n\t * @template T\r\n\t * @param {*} object\r\n\t * @param {T} value\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic objectHasValue<T>(object: any, value: T): boolean {\r\n\t\tconst keys = Object.keys(object);\r\n\t\treturn keys.some((key: string) => {\r\n\t\t\treturn object[key] === value;\r\n\t\t});\r\n\t}\r\n\r\n\tstatic objectHasKey<T>(object: any, value: string): boolean {\r\n\t\tconst keys = Object.keys(object);\r\n\t\treturn keys.some((key: string) => {\r\n\t\t\treturn key === value;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Compares one or two lists if its total exceeds limit\r\n\t *\r\n\t * @static\r\n\t * @param {number} limit\r\n\t * @param {any[]} listA\r\n\t * @param {any[]} [listB]\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic exceedAllowed(limit: number, listA: any[], listB?: any[]): boolean {\r\n\t\tconst numberOfNewDatasource = listB ? listB.length : 1;\r\n\t\tconst totalDatasources = listA.length + numberOfNewDatasource;\r\n\r\n\t\treturn totalDatasources > limit;\r\n\t}\r\n\r\n\t/**\r\n\t * Wrap key(s) in brackets. Good to use if property contains spaces\r\n\t *\r\n\t * @static\r\n\t * @param {string} key\r\n\t * @returns {string}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic wrapKeyInBrackets(key: string): string {\r\n\t\tconst wrapInBrackets = (item: string) => { return \"['\" + item + \"']\"; };\r\n\t\tlet sanitizedSourceKey = [];\r\n\t\tif (key.indexOf(\" \") && key.indexOf(\".\")) {\r\n\t\t\tsanitizedSourceKey = key.split(\".\").map(wrapInBrackets);\r\n\t\t} else {\r\n\t\t\tsanitizedSourceKey.push(wrapInBrackets(key));\r\n\t\t}\r\n\t\treturn sanitizedSourceKey.join(\"\");\r\n\t}\r\n\r\n\tstatic cleanNulls(obj: IMap<any>): void {\r\n\t\tfor (const propName in obj) {\r\n\t\t\tif (obj[propName] === null || obj[propName] === undefined) {\r\n\t\t\t\tdelete obj[propName];\r\n\t\t\t} else if (typeof obj[propName] === \"object\") {\r\n\t\t\t\tHelper.cleanNulls(obj[propName]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a string clean from new lines and tabs caused by using template literal\r\n\t * @param templateLiteral\r\n\t */\r\n\tstatic cleanTemplateLiteral(templateLiteral: string): string {\r\n\t\treturn templateLiteral\r\n\t\t\t.replace(/(\\r\\n\\t|\\n|\\r\\t)/gm, \"\")\r\n\t\t\t.replace(/[\\t]+/gm, \"\");\r\n\t}\r\n\r\n\t/**\r\n\t * Method to HTML encode any string so it can safely be used in UI\r\n\t * @param value\r\n\t * @returns HTML encoded value\r\n\t */\r\n\tstatic htmlEncode(value: string): string {\r\n\t\treturn $(\"<div/>\").text(value).html();\r\n\t}\r\n\r\n\t/**\r\n\t * Method to HTML decode any string, reverse method of htmlEncode\r\n\t * @param value\r\n\t * @returns HTML value\r\n\t */\r\n\tstatic htmlDecode(value: string): string {\r\n\t\treturn $(\"<div/>\").html(value).text();\r\n\t}\r\n\r\n\tstatic isMobile(): boolean {\r\n\t\treturn /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n\t}\r\n\r\n\t/** Generate unique id. The ID is calculated by current time + a random number\r\n\t*\r\n\t* @return A unique ID\r\n\t*/\r\n\tstatic generateUniqueId(): string {\r\n\t\treturn (new Date()).getTime() + \"\" + Math.floor((Math.random() * Numbers.MILLION) + 1);\r\n\t}\r\n\r\n\t/**\r\n\t * Add the suffix \"_copy\" and a number, depending on the conflicting candidates\r\n\t * As the items in conflictingCandidates can be anything now, this function also checks\r\n\t * that this is a proper string\r\n\t *\r\n\t * @param {string} oldDisplayName\r\n\t * @param {string[]} conflictingCandidates\r\n\t *\r\n\t */\r\n\tstatic generateNewDisplayName(oldDisplayName: string, conflictingCandidates: Array<any> = []): string {\r\n\t\tif (!oldDisplayName) {\r\n\t\t\treturn \"Lasagna al forno\";\r\n\t\t}\r\n\t\tconst splitCopyNumber = /(.+?)(_[Cc]opy(\\d*))?$/;\r\n\t\tlet newDisplayName: string;\r\n\t\tconst splitOldDisplayName = oldDisplayName.match(splitCopyNumber);\r\n\t\tconst oldDisplayNameBase = splitOldDisplayName[1];\r\n\t\tconst numbers: number[] = [];\r\n\t\tconflictingCandidates.filter((maybeString: any) => {\r\n\t\t\treturn (typeof maybeString === \"string\") ? true : false;\r\n\t\t}).forEach((conflictCandidate: string) => {\r\n\t\t\tconst matches = conflictCandidate.match(splitCopyNumber);\r\n\t\t\tconst candidateBaseName = matches[RegExpMatchCandidate.BASE_NAME];\r\n\t\t\tconst candidateIsCopy = Boolean(matches[RegExpMatchCandidate.IS_COPY]);\r\n\t\t\tconst candidateNumber = parseInt(matches[RegExpMatchCandidate.NUMBER]);\r\n\r\n\t\t\tif (oldDisplayNameBase === candidateBaseName && candidateIsCopy) {\r\n\t\t\t\tif (candidateNumber) {\r\n\t\t\t\t\tnumbers.push(parseInt(matches[RegExpMatchCandidate.NUMBER]));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnumbers.push(1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tnewDisplayName = oldDisplayNameBase + ComponentConstants.COPY_SUFFIX;\r\n\t\tif (numbers.length > 0) {\r\n\t\t\tconst highestNum = numbers.sort((a: number, b: number) => {\r\n\t\t\t\treturn a - b;\r\n\t\t\t}).pop();\r\n\t\t\tnewDisplayName += (highestNum + 1);\r\n\t\t}\r\n\t\treturn newDisplayName;\r\n\t}\r\n\r\n\t/**\r\n\t* Can be used for any array with a name-property in it to\r\n\t* populate a list with only the names.\r\n\t*\r\n\t* @param {any[]} items\r\n\t* @returns {string[]}\r\n\t* @memberof Helper\r\n\t*\r\n\t*/\r\n\tstatic getListNames(items: any[]): string[] {\r\n\t\tconst itemNames: string[] = [];\r\n\t\titems.forEach((item) => {\r\n\t\t\titemNames.push((item as any).name);\r\n\t\t});\r\n\t\treturn itemNames;\r\n\t}\r\n\r\n\tstatic getProposedNewDisplayName(projectName: string, projects: IProjectInfo[], exceptID?: string): string {\r\n\t\tlet proposedName = projectName;\r\n\t\tconst recursiveInnerFunction = (counter: number): string => {\r\n\r\n\t\t\tfor (const index in projects) {\r\n\t\t\t\tif (exceptID && exceptID === projects[index].manifest.id) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (projects[index].manifest.displayName === proposedName) {\r\n\t\t\t\t\tproposedName = projectName + counter;\r\n\t\t\t\t\treturn recursiveInnerFunction(counter + 1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn proposedName;\r\n\t\t};\r\n\r\n\t\treturn recursiveInnerFunction(1);\r\n\t}\r\n\r\n\tstatic joinWithDefauldEmptyString(stringArray: string[], joinChar: string): string {\r\n\t\tif (this.isUndefined(joinChar)) {\r\n\t\t\tjoinChar = \"\";\r\n\t\t}\r\n\t\treturn stringArray.join(joinChar);\r\n\t}\r\n\r\n\tstatic appIsReadyForSelenium(): void {\r\n\t\tangular.element(\".\" + CSSClasses.mashupRootContainer).data(ElementDataKeys.isMashupReady, true);\r\n\t}\r\n\r\n\t/**\r\n\t *\tParse query string key-value pairs into a dictionary.\r\n\t\t* @param query a query-string, e.g '?a=1&b=2' or 'x=y'\r\n\t\t*/\r\n\tstatic parseQueryString(query: string): IMap<string> {\r\n\t\tconst rPlus = /\\+/g;\r\n\t\tconst rQueryParameter = /([^&=]+)=?([^&]*)/g;\r\n\t\tconst decode = (uriEncodedText: string) => decodeURIComponent(uriEncodedText.replace(rPlus, \" \"));\r\n\t\tconst urlParams: IMap<string> = {};\r\n\r\n\t\tlet match = rQueryParameter.exec(query);\r\n\t\twhile (match) {\r\n\t\t\tconst nameIndex = 1;\r\n\t\t\tconst valueIndex = 2;\r\n\t\t\tconst name = decode(match[nameIndex]);\r\n\t\t\tconst value = decode(match[valueIndex]);\r\n\t\t\turlParams[name] = value;\r\n\t\t\tmatch = rQueryParameter.exec(query);\r\n\t\t}\r\n\t\treturn urlParams;\r\n\t}\r\n\r\n\t/**\r\n\t * Will trim value if it is string and return it\r\n\t * @param value\r\n\t */\r\n\tstatic trimIfPossible(value: any): string {\r\n\t\tif (typeof value === \"string\") {\r\n\t\t\tvalue = value.trim(); // Trim used to fix MI problem\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if Safari\r\n\t *\r\n\t * @static\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic isSafari(): boolean {\r\n\t\tconst myWindow: any = window;\r\n\t\tconst isChrome = !!myWindow.chrome && !!myWindow.chrome.webstore;\r\n\t\treturn (Object.prototype.toString.call(myWindow.HTMLElement).indexOf(\"Constructor\") > 0 ||\r\n\t\t\t!isChrome && myWindow.webkitAudioContext !== undefined);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if Edge\r\n\t *\r\n\t * @static\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic isEdge(): boolean {\r\n\t\treturn window.navigator.userAgent.indexOf(\"Edge\") > -1;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if IE\r\n\t *\r\n\t * @static\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tstatic isIE(): boolean {\r\n\t\treturn /*@cc_on!@*/false || !!(document as any).documentMode;\r\n\t}\r\n\r\n\tstatic convertBase64ToSaveableBlob(base64String: string, type: { type: string }): SmartBlob {\r\n\t\tconst byteString = atob(base64String);\r\n\t\tconst arrayBuffer = new ArrayBuffer(byteString.length);\r\n\t\tconst ia = new Uint8Array(arrayBuffer);\r\n\r\n\t\tfor (let i = 0; i < byteString.length; i++) {\r\n\t\t\tia[i] = byteString.charCodeAt(i);\r\n\t\t}\r\n\r\n\t\treturn new SmartBlob([arrayBuffer], type);\r\n\t}\r\n\r\n\tstatic getBase64FileExtension(value: string): string {\r\n\t\t//tslint:disable-next-line:no-magic-numbers\r\n\t\tconst data = value.substring(0, 5);\r\n\r\n\t\tswitch (data.toUpperCase()) {\r\n\t\t\tcase \"IVBOR\":\r\n\t\t\t\treturn \"png\";\r\n\t\t\tcase \"/9J/4\":\r\n\t\t\t\treturn \"jpeg\";\r\n\t\t\tcase \"R0lGO\":\r\n\t\t\t\treturn \"gif\";\r\n\t\t\tcase \"UklGR\":\r\n\t\t\t\treturn \"webp\";\r\n\t\t\tcase \"AAAAF\":\r\n\t\t\t\treturn \"mp4\";\r\n\t\t\tcase \"JVBER\":\r\n\t\t\t\treturn \"pdf\";\r\n\t\t\tcase \"AAABA\":\r\n\t\t\t\treturn \"ico\";\r\n\t\t\tcase \"UMFYI\":\r\n\t\t\t\treturn \"rar\";\r\n\t\t\tcase \"E1XYD\":\r\n\t\t\t\treturn \"rtf\";\r\n\t\t\tcase \"U1PKC\":\r\n\t\t\t\treturn \"txt\";\r\n\t\t\tcase \"MQOWM\":\r\n\t\t\tcase \"77U/M\":\r\n\t\t\t\treturn \"srt\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tstatic parseBase64(value: string): string {\r\n\t\tif (value.indexOf(\"data\") === -1) {\r\n\t\t\tconst extension = this.getBase64FileExtension(value);\r\n\r\n\t\t\treturn `data:image/${extension};base64,${value}`\r\n\t\t\t\t.replace(RegexStrings.NEW_LINES, \"\");\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if two arrays of objects are different.\r\n\t *\r\n\t * @static\r\n\t * @param array1 First Array\r\n\t * @param array2 Second Array\r\n\t * @return True if the arrays are different, otherwise false.\r\n\t */\r\n\tstatic isDifferent(array1: any[], array2: any[]): boolean {\r\n\t\tfunction compare(x: any[], y: any[]): any[] {\r\n\t\t\treturn filter(x, (object) => {\r\n\t\t\t\treturn !find(y, object);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn union(compare(array1, array2), compare(array2, array1)).length > 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove an item from list by index number.\r\n\t * This is a mutable change\r\n\t */\r\n\tstatic removeItemFromListByIndex(list: any[], index: number): void {\r\n\t\tlist.splice(index, 1);\r\n\t}\r\n\r\n\tstatic instanceOfLayoutComponent(object: any): object is ILayoutComponent {\r\n\t\treturn \"children\" in object;\r\n\t}\r\n\r\n\tstatic instanceOfListComponent(object: any): object is IListComponent {\r\n\t\treturn \"children\" in object;\r\n\t}\r\n\r\n\tstatic isFirstCharLetter(string: string): boolean {\r\n\t\treturn RegexStrings.FIRST_CHAR_LETTER.test(string);\r\n\t}\r\n}\r\n\r\nexport class SmartBlob {\r\n\tprivate smartBlob: Blob;\r\n\r\n\tconstructor(blobParts?: any[], type?: BlobPropertyBag) {\r\n\t\tthis.smartBlob = new Blob(blobParts, type);\r\n\t}\r\n\r\n\t/**\r\n\t * Save Blob to disk\r\n\t * @param fileName\r\n\t */\r\n\tsaveAs(fileName: string): void {\r\n\t\tif (Helper.isIE() || window.navigator.msSaveOrOpenBlob) {\r\n\t\t\twindow.navigator.msSaveOrOpenBlob(this.smartBlob, fileName);\r\n\t\t} else {\r\n\t\t\tconst url = URL.createObjectURL(this.smartBlob);\r\n\t\t\tconst a = document.createElement(\"a\");\r\n\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = fileName;\r\n\t\t\tdocument.body.appendChild(a);\r\n\t\t\ta.click();\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tdocument.body.removeChild(a);\r\n\t\t\t\twindow.URL.revokeObjectURL(url);\r\n\t\t\t}, 0);\r\n\r\n\t\t}\r\n\t}\r\n}\r\n","import angular, { IPromise } from \"angular\";\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport isNil from \"lodash-es/isNil\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport {\r\n\tCSSClasses, DEFAULT_BOUNDARY, InjectNames, InteractionTriggerEnum, RegexStrings,\r\n\tSettingKeys, SubstitutionTags, ThemeEnum, ComponentNames\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { ICustomComponentDefinition } from \"ng2/common/model/components/custom-component-definition.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\nimport { ILanguage } from \"ng2/common/model/language.model\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { DesignerMashup } from \"ng2/common/project/designer-mashup\";\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport {\tIAvailableSourceField } from \"common/defines\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult } from \"common/services/dialog-service\";\r\nimport { Defines } from \"components/defines\";\r\n\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { IRadioButtonComponent } from \"common/interface/iradiobutton-component\";\r\nimport { ITabsComponent } from \"common/interface/itabs-component\";\r\n\r\nimport { Component } from \"components/component\";\r\n\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport { ExpressionService } from \"common/services/expression-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\nimport { MingleService } from \"common/services/mingle-service\";\r\nimport { DatasourceService } from \"components/services/datasource-service\";\r\nimport { TranslationManagementService } from \"components/services/translation-management-service\";\r\nimport { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\n\r\n/**\r\n * Service used by components in runtime to communicate with our Framework\r\n */\r\nexport class FrameworkService {\r\n\r\n\tdatasourceChangedEvent = new InstanceEvent<string>();\r\n\tcurrentCanvasThemeChangedEvent: InstanceEvent<ThemeEnum>;\r\n\tprojectSettingsChangedEvent: InstanceEvent<DesignerManifest>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.WINDOW,\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.DATASOURCE_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t\tInjectNames.TRANSLATION_MANAGEMENT_SERVICE,\r\n\t\tInjectNames.MINGLE_SERVICE,\r\n\t\tInjectNames.EXPRESSION_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $window: ng.IWindowService,\r\n\t\tprivate $compile: ng.ICompileService,\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $cacheFactoryService: ng.ICacheFactoryService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate datasourceService: DatasourceService,\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate translationManagementService: TranslationManagementService,\r\n\t\tprivate mingleService: MingleService,\r\n\t\tprivate expressionService: ExpressionService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tthis.currentCanvasThemeChangedEvent = commonService.currentCanvasThemeChangedEvent;\r\n\t\tthis.projectSettingsChangedEvent = commonService.projectSettingsChangedEvent;\r\n\r\n\t\tcommonService.currentBoundaryChangedEvent.on((newBoundary) => {\r\n\t\t\tconst rootComponent = commonService.getCurrentRootComponentInstance();\r\n\t\t\tif (rootComponent) {\r\n\t\t\t\trootComponent.newBoundaryEntered(newBoundary.id);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\topenComponentDialog(options: IDialogOptions<any>): IPromise<IDialogResult<any>> {\r\n\t\treturn this.dialogService.show(options);\r\n\t}\r\n\r\n\t/**\r\n\t* Backwards compatibility, checks all components if they have a languageComponent\r\n\t* if not, one is created for that component\r\n\t* @private\r\n\t* @memberof FrameworkService\r\n\t*/\r\n\tcreateLanguageComponentFromOldComponents(): void {\r\n\t\tconst rootComponent = this.commonService.getCurrentRootComponentInstance();\r\n\t\t// TODO: for applicationHeader, remove when header is a component\r\n\t\tconst currentManifest = this.getCurrentProject().getManifest();\r\n\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\trootComponent.getId(),\r\n\t\t\tSettingKeys.APPLICATION_HEADER,\r\n\t\t\tcurrentManifest.title\r\n\t\t);\r\n\r\n\t\tthis.projectSettingsChangedEvent.raise(currentManifest);\r\n\t\trootComponent.forEachChild((componentInstance) => {\r\n\t\t\tcomponentInstance.forEachBindable((binding, currentValueSource) => {\r\n\t\t\t\tconst isLocalized = binding.valueType === ValueTypeEnum.LOCALIZED_STRING;\r\n\t\t\t\tif (isLocalized) {\r\n\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\tbinding.ref,\r\n\t\t\t\t\t\tcurrentValueSource.value\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tswitch (componentInstance.getTypedef()) {\r\n\t\t\t\tcase ComponentNames.Tabs:\r\n\t\t\t\t\t(componentInstance as ITabsComponent).componentTabs.forEach((tab) => {\r\n\t\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\t\ttab.id,\r\n\t\t\t\t\t\t\ttab.name\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ComponentNames.RadioButton:\r\n\t\t\t\t\t(componentInstance as IRadioButtonComponent)\r\n\t\t\t\t\t\t.radioButtons.forEach((radiobutton) => {\r\n\t\t\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\t\t\tradiobutton.id,\r\n\t\t\t\t\t\t\t\tradiobutton.name\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ComponentNames.Datagrid:\r\n\t\t\t\t\t(componentInstance as any).datagridOptions.columns\r\n\t\t\t\t\t\t.forEach((column: IExtendedDataGridColumn) => {\r\n\t\t\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\t\t\tcolumn.id,\r\n\t\t\t\t\t\t\t\tcolumn.name\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tif (column.text) {\r\n\t\t\t\t\t\t\t\tthis.translationManagementService.createGeneralLanguageComponent(\r\n\t\t\t\t\t\t\t\t\tcomponentInstance.getId(),\r\n\t\t\t\t\t\t\t\t\tcolumn.id + \"CellText\",\r\n\t\t\t\t\t\t\t\t\tcolumn.text\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t// TODO: other cases\r\n\t\t\t}\r\n\t\t}, false);\r\n\t}\r\n\r\n\topenWindow(url: string): void {\r\n\t\tthis.$window.open(url, \"_blank\");\r\n\t}\r\n\r\n\t/**\r\n\t * get the current language\r\n\t *\r\n\t * @public\r\n\t * @memberof FrameworkService\r\n\t */\r\n\tgetCurrentLanguage(): string {\r\n\t\treturn this.translationManagementService.getCurrentLanguage();\r\n\t}\r\n\r\n\tgetSelectedLocale(): string {\r\n\t\treturn this.translationManagementService.getSelectedLocale();\r\n\t}\r\n\r\n\t/**\r\n\t * Get the translatable string by the current language.\r\n\t * Used in component.ts therefore in this service.\r\n\t *\r\n\t * @param {string} componentId\r\n\t * @param {string} property\r\n\t *\t@param {string} currentLanguageKey\r\n\t\t*\r\n\t\t* @memberof FrameworkService\r\n\t\t*/\r\n\tgetTranslatableStringByProperty(componentId: string, property: string): string {\r\n\t\treturn this.translationManagementService.getTranslatableStringByProperty(componentId, property);\r\n\t}\r\n\r\n\tsetTranslatableStringByProperty(\r\n\t\tcomponentId: string,\r\n\t\tproperty: string,\r\n\t\tupdatedValue: ILanguage\r\n\t): void {\r\n\t\tthis.translationManagementService.setTranslatableStringByProperty(componentId, property, updatedValue);\r\n\t}\r\n\r\n\tsendDrillbackMessage(message: string): void {\r\n\t\tthis.mingleService.sendDrillbackMessage(message);\r\n\t}\r\n\r\n\tgetGlobalValue(value: string, component: IComponent): string | null {\r\n\t\tlet stringValue = null;\r\n\t\tif (!isNil(value) && typeof (value) !== \"boolean\") {\r\n\t\t\tconst trimmedValue = value.replace(SubstitutionTags.VALUE, \"\");\r\n\t\t\tconst cleanedValue = trimmedValue.match(RegexStrings.GLOBALSTRING);\r\n\t\t\tif (cleanedValue && cleanedValue[1]) {\r\n\t\t\t\tconst globalValue = this.languageService.getGlobalString(cleanedValue[1]);\r\n\t\t\t\tif (globalValue) {\r\n\t\t\t\t\tstringValue = value.replace(cleanedValue[0], globalValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.translationManagementService.openNewStringDialog(cleanedValue[1]).then((result) => {\r\n\t\t\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\t\t\tthis.translationManagementService.addGlobalString(result.value).then(() => {\r\n\t\t\t\t\t\t\t\tcomponent.initializeBindings();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn stringValue;\r\n\t}\r\n\r\n\t/**\r\n\t* get the translatable string on the header via translation management service\r\n\t* TODO: Remove when header is a component\r\n\t*\r\n\t* @returns {string}\r\n\t* @memberof FrameworkService\r\n\t*/\r\n\tgetTranslatableHeaderString(): string {\r\n\t\treturn this.translationManagementService.getTranslatableHeaderString();\r\n\t}\r\n\r\n\tgetCurrentProject(): DesignerMashup {\r\n\t\treturn this.commonService.getCurrentProject() as DesignerMashup;\r\n\t}\r\n\r\n\tgetUrlMetaData(): IAvailableSourceField[] {\r\n\t\treturn this.commonService.getUrlMetaData();\r\n\t}\r\n\r\n\tsetUrlMetaData(newUrlMetaData: IAvailableSourceField[]): void {\r\n\t\treturn this.commonService.setUrlMetaData(newUrlMetaData);\r\n\t}\r\n\r\n\tgenerateUrlMetaData(): ng.IPromise<DesignerMashup> {\r\n\t\tconst project = this.commonService.getCurrentProject();\r\n\t\treturn this.commonService.generateUrlMetaData(project) as ng.IPromise<DesignerMashup>;\r\n\t}\r\n\r\n\tgetUrlValue(sourceKey: string): string {\r\n\t\tlet value = \"\";\r\n\t\tconst metaData = this.getUrlMetaData();\r\n\t\tconst result = metaData.find( data => data.sourceKey === sourceKey);\r\n\r\n\t\tif (result && result.currentValue) {\r\n\t\t\tvalue = result.currentValue;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tgetTimeout(): ng.ITimeoutService {\r\n\t\treturn this.$timeout;\r\n\t}\r\n\r\n\tgetProjectCacheObject(): ng.ICacheObject {\r\n\t\tconst cacheId  = `${this.getCurrentProject().getId()}`;\r\n\t\treturn this.getCacheObject(cacheId);\r\n\t}\r\n\r\n\tgetCacheObject(cacheId?: string): ng.ICacheObject {\r\n\t\tcacheId = cacheId !== undefined ?\r\n\t\t\tcacheId : `${this.getCurrentProject().getId()}`;\r\n\r\n\t\tconst cacheObject = this.$cacheFactoryService.get(cacheId);\r\n\r\n\t\treturn !cacheObject ?\r\n\t\t\tthis.$cacheFactoryService(cacheId) : cacheObject;\r\n\t}\r\n\r\n\tremoveCacheObject(cacheId: string): void {\r\n\t\tconst cacheObject = this.getCacheObject(cacheId);\r\n\r\n\t\tcacheObject.destroy();\r\n\t}\r\n\r\n\tcheckIfListTemplate(componentId: string): boolean {\r\n\t\tif (componentId === \"TwoHorizontalLabels\" || componentId === \"ImageAndLabels\" || componentId === \"Stack\") {\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tforEachBindable(\r\n\t\tcomponent: IJsonComponent, fn: (field: IJsonBindableField, curr: IJsonValueSource) => void\r\n\t): void {\r\n\t\tDefines\r\n\t\t\t.allComponents[component.typedef]\r\n\t\t\t.class\r\n\t\t\t.BINDABLE_FIELDS_2.forEach((field: any) => {\r\n\t\t\t\tfn(field, (component as any)[field.ref]);\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Recursively iterate through all the components and run a function with the component\r\n\t * as an input\r\n\t *\r\n\t * @param {IJsonComponent} component\r\n\t * @param {(component: IJsonComponent, parent: IJsonLayoutComponent) => void} fn\r\n\t *\r\n\t * @memberof FrameworkService\r\n\t */\r\n\tforEachComponent(\r\n\t\tcomponent: IJsonComponent,\r\n\t\tfn: (component: IJsonComponent, parent: IJsonLayoutComponent) => void,\r\n\t\tparent: IJsonLayoutComponent = null\r\n\t): void {\r\n\t\tfn(component, parent);\r\n\t\tif (Defines.allComponents[component.typedef].isLayoutComponent) {\r\n\t\t\t(component as IJsonLayoutComponent).children.forEach((child: IJsonComponent) => {\r\n\t\t\t\tthis.forEachComponent(child, fn, component);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tgetNextProjectBoundary(boundaryId: string): IBoundary {\r\n\t\tif (boundaryId === DEFAULT_BOUNDARY.id) {\r\n\t\t\treturn DEFAULT_BOUNDARY;\r\n\t\t}\r\n\t\tconst projectBoundaries = this.getCurrentProject().manifest.mashupBoundaries;\r\n\r\n\t\tif (projectBoundaries) {\r\n\t\t\t// Sort the array, could be method?\r\n\t\t\tprojectBoundaries.sort((a, b) => {\r\n\t\t\t\tif (\"Default\" === a.id) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t} else if (\"Default\" === b.id) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else if (a.limitX < b.limitX) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else if (b.limitX < a.limitX) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn 0;\r\n\t\t\t});\r\n\r\n\t\t\tfor (let i = 0; i < projectBoundaries.length; i++) {\r\n\t\t\t\tif (projectBoundaries[i].id === boundaryId) {\r\n\t\t\t\t\treturn projectBoundaries[i + 1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn DEFAULT_BOUNDARY;\r\n\t}\r\n\r\n\ttriggerExpressions(): void {\r\n\t\tconst components = this.getAllComponentInstances();\r\n\t\tthis.expressionService.trigger(components);\r\n\t}\r\n\r\n\tsetCanvasTheme(theme: ThemeEnum): void {\r\n\t\tthis.commonService.setCanvasTheme(theme, this.isDesigner());\r\n\t}\r\n\r\n\tgetCurrentBoundary(): IBoundary {\r\n\t\treturn this.commonService.getCurrentBoundary();\r\n\t}\r\n\r\n\tgetTranslatableFieldDisplayName(componentId: string, reference: string): string {\r\n\r\n\t\tlet displayName = \"\";\r\n\t\tconst componentInstance = this.getComponentInstance(componentId);\r\n\r\n\t\tif (componentInstance) {\r\n\t\t\tswitch (componentInstance.getTypedef()) {\r\n\t\t\t\tcase ComponentNames.Tabs: {\r\n\t\t\t\t\tconst newTabIndex = ((componentInstance as ITabsComponent)\r\n\t\t\t\t\t\t.componentTabs\r\n\t\t\t\t\t\t.findIndex((tab) => {\r\n\t\t\t\t\t\t\treturn tab.id === reference;\r\n\t\t\t\t\t\t}) + 1); // Index starting on 1 for humans\r\n\t\t\t\t\tdisplayName = \"Tab \" + newTabIndex;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase ComponentNames.RadioButton:\r\n\t\t\t\t\tif (reference === SettingKeys.LABEL) {\r\n\t\t\t\t\t\tdisplayName = this.getBindableDisplayName(reference, componentId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst newRadioIndex = ((componentInstance as IRadioButtonComponent).radioButtons\r\n\t\t\t\t\t\t\t.findIndex((radiobutton) => {\r\n\t\t\t\t\t\t\t\treturn radiobutton.id === reference;\r\n\t\t\t\t\t\t\t}) + 1); // Index starting on 1 for humans\r\n\t\t\t\t\t\tdisplayName = \"Radio Button \" + newRadioIndex;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ComponentNames.Datagrid: {\r\n\t\t\t\t\tif (reference === SettingKeys.LABEL) {\r\n\t\t\t\t\t\tdisplayName = this.getBindableDisplayName(reference, componentId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet cellName = \"\";\r\n\t\t\t\t\t\tif (reference.includes(\"CellText\")) {\r\n\t\t\t\t\t\t\tcellName = \" Cell Text\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst newColumnIndex = (componentInstance as any).datagridOptions.columns\r\n\t\t\t\t\t\t\t.findIndex((column: IExtendedDataGridColumn) => {\r\n\t\t\t\t\t\t\t\treturn column.id + cellName.replace(/\\s+/g, \"\") === reference;\r\n\t\t\t\t\t\t\t}) + 1; // Index starting on 1 for humans\r\n\t\t\t\t\t\tdisplayName = \"Column \" + newColumnIndex + cellName;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase \"Lookup\": {\r\n\t\t\t\t\tif (reference === SettingKeys.LABEL) {\r\n\t\t\t\t\t\tdisplayName = this.getBindableDisplayName(reference, componentId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst newColumnIndex = (componentInstance.getDatabearer() as IJsonLookup).columns\r\n\t\t\t\t\t\t\t.findIndex((column) => {\r\n\t\t\t\t\t\t\t\treturn column.id === reference;\r\n\t\t\t\t\t\t\t}) + 1; // Index starting on 1 for humans\r\n\t\t\t\t\t\tdisplayName = \"Column \" + newColumnIndex;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t//  more cases\r\n\t\t\t}\r\n\r\n\t\t\tif (!displayName) {\r\n\t\t\t\tdisplayName = this.getBindableDisplayName(reference, componentId);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn displayName;\r\n\t}\r\n\r\n\tprivate getBindableDisplayName(reference: string, componentId: string): string {\r\n\t\tlet displayName = \"\";\r\n\t\tconst componentInstance = this.getComponentInstance(componentId);\r\n\t\tconst staticClass = Defines.allComponents[componentInstance.getTypedef()].class;\r\n\t\tconst bindables: IJsonBindableField[] = staticClass.BINDABLE_FIELDS_2;\r\n\t\tif (bindables.length > 0) {\r\n\t\t\tconst maybeDefinition = bindables.find((bindableDefinition) => {\r\n\t\t\t\treturn bindableDefinition.ref === reference;\r\n\t\t\t});\r\n\t\t\tdisplayName = maybeDefinition ? maybeDefinition.name : displayName;\r\n\t\t}\r\n\t\treturn displayName;\r\n\t}\r\n\r\n\t/**\r\n\t * Get component instance with given componentID\r\n\t *\r\n\t * @param componentId\r\n\t * @param fromRoot (optional) if not given will default to ApplicationParent\r\n\t */\r\n\tgetComponentInstance(componentId: string, fromRoot?: IComponent): IComponent {\r\n\t\tif (!componentId) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst recursive = (component: IComponent) => {\r\n\t\t\tlet foundChild: IComponent;\r\n\t\t\tif (component.getId() === componentId) {\r\n\t\t\t\treturn component;\r\n\t\t\t} else if (Helper.instanceOfLayoutComponent(component)) {\r\n\t\t\t\tfor (const index in component.children) {\r\n\t\t\t\t\tfoundChild = recursive(component.children[index]);\r\n\t\t\t\t\tif (foundChild) {\r\n\t\t\t\t\t\treturn foundChild;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (Helper.instanceOfListComponent(component)) {\r\n\t\t\t\tfor (const index in component.children) {\r\n\t\t\t\t\tfoundChild = recursive(component.children[index]);\r\n\t\t\t\t\tif (foundChild) { // Return first one of the generated instances\r\n\t\t\t\t\t\treturn foundChild;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t};\r\n\t\tif (!fromRoot) {\r\n\t\t\tconst rootComponent = this.commonService.getCurrentRootComponentInstance();\r\n\t\t\tfromRoot = rootComponent.parent;\r\n\t\t}\r\n\t\treturn recursive(fromRoot);\r\n\t}\r\n\r\n\t/*\r\n\t\t* Get all component instances that the attribute has the specified value\r\n\t*/\r\n\tgetComponentInstances(attrName: string, attrValue: string, fromRoot?: IComponent): IComponent[] {\r\n\t\tconst components: IComponent[] = [];\r\n\t\tif (!fromRoot) {\r\n\t\t\tfromRoot = this.commonService.getCurrentRootComponentInstance();\r\n\t\t}\r\n\t\tfromRoot.forEachChild((child) => {\r\n\t\t\tif (Helper.getDeepValue(child, attrName) === attrValue) {\r\n\t\t\t\tcomponents.push(child);\r\n\t\t\t}\r\n\t\t}, true);\r\n\t\treturn components;\r\n\t}\r\n\r\n\t/*\r\n\t\t* Get all component instances\r\n\t*/\r\n\tgetAllComponentInstances(): IComponent[] {\r\n\t\tconst components: IComponent[] = [];\r\n\t\tconst rootComponent = this.commonService.getCurrentRootComponentInstance();\r\n\t\trootComponent.forEachChild((child) => {\r\n\t\t\tcomponents.push(child);\r\n\t\t}, true);\r\n\t\treturn components;\r\n\t}\r\n\r\n\tgetCustomComponentDefinition(customId: string): ICustomComponentDefinition {\r\n\t\treturn this.commonService.getCurrentProject().getCustomComponentDefinitions()[customId];\r\n\t}\r\n\r\n\tgetNewDeferred<T>(): ng.IDeferred<T> {\r\n\t\treturn this.$q.defer<T>();\r\n\t}\r\n\r\n\tisRuntimeMode(): boolean {\r\n\t\t// MUPS-495 should be applied here:\r\n\t\t// A better way to get the runtimeMode would be to save it something global, eg.the rootscope\r\n\t\tconst container = angular.element(\".\" + CSSClasses.mashupRootContainer);\r\n\t\treturn container.length === 0 || container.hasClass(\"runtimeMode\");\r\n\t}\r\n\r\n\tisDesigner(): boolean {\r\n\t\treturn this.commonService.isDesigner();\r\n\t}\r\n\r\n\tgetDatasource(datasourceId: string): IJsonDatasource {\r\n\t\treturn this.commonService.getCurrentProject().getDatasource(datasourceId);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param {string} datasourceId\r\n\t * @returns {IDatasource}\r\n\t *\r\n\t * @memberOf FrameworkService\r\n\t */\r\n\tgetDatasourceObject(datasourceId: string): IDatasource {\r\n\t\tconst datasourceObject: IJsonDatasource = this.commonService.getCurrentProject().getDatasource(datasourceId);\r\n\t\tlet datasourceInstance: IDatasource;\r\n\t\tif (datasourceObject) {\r\n\t\t\tdatasourceInstance = this.datasourceService.parseDatasourceToTS(datasourceObject);\r\n\t\t}\r\n\t\treturn datasourceInstance;\r\n\t}\r\n\r\n\treadParameters(\r\n\t\tparameters: IInteractionParameter[],\r\n\t\tcontext: IMap<string>\r\n\t): IMap<any> {\r\n\t\tconst values: IMap<any> = {};\r\n\t\tparameters.forEach((parameter) => {\r\n\t\t\tconst value = this.readValueSource(parameter.valueSource, context);\r\n\t\t\tif (value) {\r\n\t\t\t\t//Assume %% is a delimiter\r\n\t\t\t\tconst multipleValue = value.split(\"%%\");\r\n\t\t\t\tif (multipleValue.length > 1 && parameter.valueSource.Type !== BindingTypeEnum.STATIC_VALUE) {\r\n\t\t\t\t\tfor (let i = 0; i < multipleValue.length; i++) {\r\n\t\t\t\t\t\tmultipleValue[i] = Helper.trimIfPossible(multipleValue[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvalues[parameter.targetKey] = multipleValue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalues[parameter.targetKey] = Helper.trimIfPossible(value); // Trim used to fix MI problem\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvalues[parameter.targetKey] = \"\";\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn values;\r\n\t}\r\n\r\n\tsetParameter<T>(parameter: IInteractionParameter, newValue: T): void {\r\n\t\tconst valueSource = parameter.valueSource;\r\n\t\tconst sourceComponent = this.getComponentInstance(valueSource.sourceName);\r\n\t\tconst path = valueSource.sourceKey;\r\n\r\n\t\tHelper.setDeepValue(sourceComponent, path, newValue);\r\n\t}\r\n\r\n\t/**\r\n\t * Method for applying string concatenation formatter on Binding and Context type bindings\r\n\t *\r\n\t * @param valuesourceObject\r\n\t * @param value\r\n\t * @returns valuesourceObject.value with {$value} substitution of value parameter\r\n\t */\r\n\tprivate applyValuesourceFormatter(value: string, newValue: string): string {\r\n\t\t// Fallback for old projects that (unnessesarily) saved current value in the \"value\"-property\r\n\t\tif (value && value.indexOf(SubstitutionTags.VALUE) > -1) {\r\n\t\t\treturn Helper.joinWithDefauldEmptyString(\r\n\t\t\t\tvalue.split(SubstitutionTags.VALUE),\r\n\t\t\t\tnewValue\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn newValue;\r\n\t\t}\r\n\t}\r\n\r\n\treadValueSource(valueSource: IJsonValueSource, context: IMap<string>): string | null {\r\n\t\tlet value: string;\r\n\t\tif (valueSource.Type === BindingTypeEnum.BINDING) {\r\n\t\t\tconst sourceComponent = this.getComponentInstance(valueSource.sourceName);\r\n\t\t\tif (sourceComponent && valueSource.sourceKey) {\r\n\t\t\t\tconst result = sourceComponent.getValue(valueSource.sourceKey);\r\n\t\t\t\tvalue = result === null ? \"\" : result;\r\n\t\t\t\tvalue = this.applyValuesourceFormatter(valueSource.value, value);\r\n\t\t\t} else {\r\n\t\t\t\tif (!sourceComponent) {\r\n\t\t\t\t\tconsole.error(\"[DatasourceService] BINDING failed, source component not found\");\r\n\t\t\t\t}\r\n\t\t\t\tif (!valueSource.sourceKey) {\r\n\t\t\t\t\tconsole.error(\"[DatasourceService] BINDING failed, source key not set\");\r\n\t\t\t\t}\r\n\t\t\t\tvalue = null;\r\n\t\t\t}\r\n\t\t} else if (valueSource.Type === BindingTypeEnum.CONTEXT_BINDING) {\r\n\t\t\tif (context) {\r\n\t\t\t\tvalue = context[valueSource.sourceKey];\r\n\t\t\t\tvalue = this.applyValuesourceFormatter(valueSource.value, value);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error(\"[DatasourceService] BINDING failed, no context for CONTEXT_BINDING\");\r\n\t\t\t}\r\n\t\t} else if (valueSource.Type === BindingTypeEnum.URL_BINDING) {\r\n\t\t\tif (this.isRuntimeMode()) {\r\n\t\t\t\tvalue = this.getUrlValue(valueSource.sourceKey);\r\n\t\t\t} else {\r\n\t\t\t\tvalue = valueSource.value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Static value\r\n\t\t\tvalue = valueSource.value;\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\tprivate activeBindings: IMap<Function> = {};\r\n\r\n\tgetActiveBinding(): IMap<Function> {\r\n\t\treturn this.activeBindings;\r\n\t}\r\n\r\n\tregisterContextBinding(\r\n\t\ttargetComponent: IComponent,\r\n\t\ttargetKey: string,\r\n\t\tsourceKey: string,\r\n\t\tvalue: string\r\n\t): void {\r\n\t\tconst targetComponentScope = targetComponent.getScope();\r\n\t\tif (targetComponentScope) {\r\n\t\t\tconst targetComponentId = targetComponent.isGenerated ?\r\n\t\t\t\ttargetComponent.generatedId : targetComponent.getId();\r\n\r\n\t\t\tconst bindingId = this.getContextBindingId(targetComponentId, targetKey, sourceKey);\r\n\t\t\tif (this.activeBindings[bindingId]) {\r\n\t\t\t\tthis.activeBindings[bindingId]();\r\n\t\t\t}\r\n\t\t\tconst dereg = targetComponentScope.$watch(\r\n\t\t\t\t\"context[\\\"\" + sourceKey + \"\\\"]\",\r\n\t\t\t\t(newValue: string) => {\r\n\t\t\t\t\tnewValue = this.applyValuesourceFormatter(value, newValue);\r\n\t\t\t\t\ttargetComponent.setBindableValue(targetKey, newValue ? newValue : \"\");\r\n\t\t\t\t});\r\n\t\t\tthis.activeBindings[bindingId] = dereg;\r\n\r\n\t\t\ttargetComponentScope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\t\tdereg();\r\n\t\t\t\tdelete this.activeBindings[bindingId];\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[FrameworkService] No element/scope on target component, CONTEXT_BINDING not registered\");\r\n\t\t}\r\n\t}\r\n\r\n\tgetBindingId(targetComponentId: string, targetKey: string, valueSourceObject: IJsonValueSource): string {\r\n\t\tconst sourceName = valueSourceObject.sourceName;\r\n\t\tconst sourceKey = valueSourceObject.sourceKey;\r\n\t\treturn sourceName + sourceKey + targetComponentId + targetKey;\r\n\t}\r\n\r\n\tgetContextBindingId(targetComponentId: string, targetKey: string, sourceKey: string): string {\r\n\t\treturn \"context\" + sourceKey + targetComponentId + targetKey;\r\n\t}\r\n\r\n\tregisterBinding(\r\n\t\ttargetComponent: IComponent,\r\n\t\ttargetKey: string,\r\n\t\tvaluesourceObject: IJsonValueSource,\r\n\t\tvalue: string\r\n\t): void {\r\n\t\tconst sourceComponentId = valuesourceObject.sourceName;\r\n\t\tconst sourceComponentKey = valuesourceObject.sourceKey;\r\n\t\tconst isLayoutComponentWithDatasource = (component: IComponent) => {\r\n\t\t\treturn component.isLayoutComponent() && component.getDatasource() !== undefined;\r\n\t\t};\r\n\t\tconst sourceComponent = this.getComponentInstance(sourceComponentId);\r\n\t\tif (sourceComponent) {\r\n\t\t\tconst bindingId = this.getBindingId(targetComponent.getId(), targetKey, valuesourceObject);\r\n\t\t\tif (this.activeBindings[bindingId]) {\r\n\t\t\t\tthis.activeBindings[bindingId]();\r\n\t\t\t}\r\n\t\t\tlet sourcePath = Helper.wrapKeyInBrackets(sourceComponentKey);\r\n\t\t\tsourcePath = isLayoutComponentWithDatasource(sourceComponent) ?\r\n\t\t\t\t\".scope.context\" + sourcePath : sourcePath;\r\n\t\t\tconst watchKey = \"componentInstance\" + sourcePath;\r\n\t\t\tconst dereg = sourceComponent.getScope().$watch(\r\n\t\t\t\twatchKey,\r\n\t\t\t\t(newValue: string) => {\r\n\t\t\t\t\tif (newValue === undefined || newValue === null) {\r\n\t\t\t\t\t\tnewValue = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnewValue = this.applyValuesourceFormatter(value, newValue);\r\n\t\t\t\t\ttargetComponent.setBindableValue(targetKey, newValue);\r\n\t\t\t\t\ttargetComponent.onUpdateValue();\r\n\t\t\t\t});\r\n\r\n\t\t\tthis.activeBindings[bindingId] = dereg;\r\n\t\t\tsourceComponent.getScope().$on(AngularConstants.DESTROY, () => {\r\n\t\t\t\tdereg();\r\n\t\t\t\tdelete this.activeBindings[bindingId];\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.warn(`[FrameworkService] Dead binding on component id: ${targetComponent.getId()}`);\r\n\t\t}\r\n\t}\r\n\r\n\ttrigger(source: Component, triggerName: string): void {\r\n\t\tthis.commonService.getCurrentProject().getInteractions().forEach((interaction) => {\r\n\t\t\tif (interaction.sourceName === source.getId() &&\r\n\t\t\t\tinteraction.sourceTriggerName === triggerName\r\n\t\t\t) {\r\n\t\t\t\tthis.runInteraction(interaction);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\trunInteraction(interaction: Interaction): void {\r\n\t\tif (interaction.targetName && interaction.targetActionName) {\r\n\t\t\tconst targetCtrls = this.getComponentInstances(\"databearer.id\", interaction.targetName);\r\n\t\t\ttargetCtrls.forEach((component: IComponent) => {\r\n\t\t\t\tcomponent.loadInteraction(interaction);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[FrameworkService] Interaction: \" + interaction.getId() +\r\n\t\t\t\t\" did not run, not all prerequisites were present\");\r\n\t\t}\r\n\t}\r\n\r\n\trunStartupInteractions(): void {\r\n\t\tconst startupInteraction = this.commonService.getCurrentProject().getInteractions().filter((ev) => {\r\n\t\t\treturn (ev.sourceTriggerName === InteractionTriggerEnum.STARTUP);\r\n\t\t});\r\n\r\n\t\tstartupInteraction.forEach((ev) => {\r\n\t\t\tthis.runInteraction(ev);\r\n\t\t});\r\n\t}\r\n\r\n\tconvertImageUrlToBase64(url: string): ng.IPromise<string> {\r\n\t\treturn this.commonService.convertImageUrlToBase64(url);\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.FRAMEWORK_SERVICE, FrameworkService);\r\n\t}\r\n}\r\n","export class Utils {\r\n\r\n\t/**\r\n\t * Util class containing convenience methods related to SohoXi Controls.\r\n\t */\r\n\tstatic getData(element: ng.IAugmentedJQuery, key: string): any {\r\n\t\treturn element.data(key);\r\n\t}\r\n}\r\n","export enum ValueTypeEnum {\r\n\tSTRING = 1,\r\n\tBOOLEAN,\r\n\tNUMBER,\r\n\tOBJECT,\r\n\tLIST,\r\n\tBINARY,\r\n\tLOCALIZED_STRING,\r\n\tDATE\r\n}\r\n","import angular from \"angular\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport {\r\n\tBindingTypes, DEFAULT_BOUNDARY, IdoProperties, InteractionActionEnum, InteractionTriggerEnum,\r\n\tNumbers, SettingInputKeys, SettingKeys, SidebarTabTypes } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IComponentSettings } from \"ng2/common/model/components/settings/component-settings.model\";\r\nimport type { IJsonComponent, IJsonMargin, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport type { IComponentStyle } from \"common/defines\";\r\nimport type { IErrorResponse } from \"common/error-response\";\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { IComponentScope } from \"common/interface/icomponent-scope\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type { ISizeObject } from \"common/ISizeObject\";\r\n\r\nimport { Defines } from \"components/defines\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\nimport { ISourceItem } from \"common/model/component/hyperlink.model\";\r\n\r\nexport abstract class Component implements IComponent {\r\n\r\n\t// TODO: View variables, could probably be private\r\n\tprotected cssHeight: string;\r\n\tprotected cssWidth: string;\r\n\tcssClasses: string;\r\n\tisVisible = true;\r\n\tisReadonly: boolean;\r\n\tisShowError = true;\r\n\tisLoading: boolean;\r\n\terrorTooltip: string;\r\n\r\n\t// TODO: Member variables that should be methods\r\n\tcanCut = true;\r\n\tcanCopy = true;\r\n\r\n\t// TODO: Member variables that should be protected / private\r\n\tprotected databearer: IJsonComponent;\r\n\tdatasource: IDatasource;\r\n\telement: ng.IAugmentedJQuery;\r\n\tgeneratedId: string;\r\n\tisGenerated = false;\r\n\tparent: ILayoutComponent;\r\n\r\n\tprotected cache: ng.ICacheObject;\r\n\tprotected scope: IComponentScope;\r\n\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t[\r\n\t\t{\r\n\t\t\ttitle: \"Margin\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Margin\",\r\n\t\t\t\tref: SettingKeys.MARGIN,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.MARGIN,\r\n\t\t\t\tdefaultValue: { left: 0, top: 0, right: 0, bottom: 0 }\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Visibility\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Component\",\r\n\t\t\t\tref: SettingKeys.VISIBILITY,\r\n\t\t\t\tinputType: SettingInputKeys.SWITCH,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-preview\",\r\n\t\t\t\t\ttooltip: \"Hide Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t},\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Show Error\",\r\n\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Error\",\r\n\t\t\t\tref: SettingKeys.SHOW_ERROR,\r\n\t\t\t\tinputType: SettingInputKeys.SWITCH,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t\tboundarySetting: true\r\n\t\t\t}]\r\n\t\t}\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tdatabearer: IJsonComponent,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tprotected frameworkService: FrameworkService\r\n\t) {\r\n\t\tthis.databearer = databearer;\r\n\t\tif (databearer.datasource) {\r\n\t\t\tthis.datasource = frameworkService.getDatasourceObject(databearer.datasource);\r\n\t\t\tif (this.datasource) {\r\n\t\t\t\tthis.datasource.usedBy.push(this);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn(\"[Component] Missing data service unsetting the property\");\r\n\t\t\t\tdatabearer.datasource = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.element = $element;\r\n\t\tthis.scope = this.element.data(\"eir-scope\");\r\n\t\tthis.parent = parent;\r\n\t\tif (databearer && databearer.typedef !== \"Datagrid\") {\r\n\t\t\tthis.isReadonly = databearer.isReadonly;\r\n\t\t}\r\n\t\tthis.updateClassesAndStyle();\r\n\t\t// Flexbox gives the generatedId on the scope\r\n\t\tif (this.scope.generatedId) {\r\n\t\t\tthis.setGenerated(this.scope.generatedId);\r\n\t\t// While the List gives the generatedId to the child databearers\r\n\t\t} else if (this.databearer.generatedId) {\r\n\t\t\tthis.setGenerated(this.databearer.generatedId);\r\n\t\t}\r\n\r\n\t\tthis.createCacheObject();\r\n\t}\r\n\r\n\tcanDelete(): boolean {\r\n\t\tif (this.isGenerated) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgetScope(): IComponentScope {\r\n\t\treturn this.scope;\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonComponent {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tgetTypedef(): string {\r\n\t\treturn this.databearer.typedef;\r\n\t}\r\n\r\n\tgetId(): string {\r\n\t\treturn this.databearer.id;\r\n\t}\r\n\r\n\tgetDisplayName(): string {\r\n\t\treturn this.databearer.displayName;\r\n\t}\r\n\r\n\tgetDatasource(): IDatasource {\r\n\t\treturn this.datasource;\r\n\t}\r\n\r\n\tsetGenerated(generatedId: string): void {\r\n\t\tthis.isGenerated = true;\r\n\t\tthis.generatedId = generatedId;\r\n\t}\r\n\r\n\tis(classs: any): boolean {\r\n\t\treturn this instanceof classs;\r\n\t}\r\n\r\n\t/**\r\n\t * To be called when new boundary is entered\r\n\t * Could be called when you need component trees to update their values\r\n\t */\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tthis.updateClassesAndStyle();\r\n\t}\r\n\r\n\tcalcNewSizes(): void {\r\n\t\tthis.calcNewWidth();\r\n\t\tthis.calcNewHeight();\r\n\t}\r\n\r\n\tcalcNewWidth(): void {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tthis.cssWidth = this.calcNewSize(\r\n\t\t\tthis.getBoundarySetting<IJsonSize>(SettingKeys.WIDTH),\r\n\t\t\tOrientationEnum.HORIZONTAL, margin.left + margin.right\r\n\t\t);\r\n\t}\r\n\r\n\tcalcNewHeight(): void {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tthis.cssHeight = this.calcNewSize(\r\n\t\t\tthis.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT),\r\n\t\t\tOrientationEnum.VERTICAL, margin.top + margin.bottom\r\n\t\t);\r\n\t}\r\n\r\n\tprotected calcNewSize(sizeObject: IJsonSize, orientation: OrientationEnum, margin = 0): string {\r\n\t\tlet retSize = \"\";\r\n\t\tif (this.parent.hasIndividualChildSizes(orientation)) {\r\n\t\t\tif (sizeObject.sizeType === SizeTypeEnum.PERCENT) {\r\n\t\t\t\tconst pxPerPercentComponent = this.parent.getPxPerPercentComponent(orientation, sizeObject.value);\r\n\t\t\t\tretSize = \"calc(\" + (sizeObject.value || Numbers.HUNDRED) + \"% - \" + (pxPerPercentComponent + margin) + \"px)\";\r\n\t\t\t} else if (sizeObject.sizeType === SizeTypeEnum.PIXELS) {\r\n\t\t\t\tretSize = \"calc(\" + sizeObject.value + \"px)\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn retSize;\r\n\t}\r\n\r\n\tsetBoundarySettingIfChanged<T>(settingId: string): void {\r\n\t\tconst value = this.getBoundarySetting<T>(settingId);\r\n\t\tif (!Helper.isUndefinedOrNull(value) && (this as any)[settingId] !== value) {\r\n\t\t\t(this as any)[settingId] = value;\r\n\t\t}\r\n\t}\r\n\r\n\tgetBoundarySetting<T>(settingId: string, boundaryId?: string, noTraverse?: boolean): T {\r\n\t\tconst frameworkService = this.frameworkService;\r\n\t\tconst componentBoundarySettings = this.databearer.boundarySettings;\r\n\r\n\t\tif (!boundaryId) {\r\n\t\t\tboundaryId = frameworkService.getCurrentBoundary().id;\r\n\t\t}\r\n\t\tif (noTraverse) {\r\n\t\t\t//Should return a copy, List needs some work\r\n\t\t\treturn (componentBoundarySettings[boundaryId] as IMap<T>)[settingId];\r\n\t\t}\r\n\r\n\t\tlet boundarySettings: IComponentSettings;\r\n\t\twhile (!boundarySettings) {\r\n\t\t\tif (!componentBoundarySettings[boundaryId] ||\r\n\t\t\t\t(componentBoundarySettings[boundaryId] as IMap<T>)[settingId] === undefined ||\r\n\t\t\t\t(componentBoundarySettings[boundaryId] as IMap<T>)[settingId] === null) {\r\n\t\t\t\tboundaryId = frameworkService.getNextProjectBoundary(boundaryId).id;\r\n\t\t\t\tif (boundaryId === DEFAULT_BOUNDARY.id) {\r\n\t\t\t\t\tboundarySettings = componentBoundarySettings[DEFAULT_BOUNDARY.id];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tboundarySettings = componentBoundarySettings[boundaryId];\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn (boundarySettings as IMap<T>)[settingId];\r\n\t}\r\n\r\n\tgetBindableValue(bindableReference: string): any {\r\n\t\tconst bindablevalue = (this as any)[bindableReference];\r\n\t\treturn bindablevalue;\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, value: any): void {\r\n\t\tif (bindableReference === SettingKeys.TOOLTIP) {\r\n\t\t\t// always encode tooltip bindables\r\n\t\t\t(this as any)[bindableReference] = Helper.htmlEncode(value);\r\n\t\t} else {\r\n\t\t\t(this as any)[bindableReference] = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Those components with changable values in runtime triggers this.\r\n\t */\r\n\tonUpdateValue(): void {\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\t}\r\n\r\n\tisLayoutComponent(): boolean {\r\n\t\treturn Defines.allComponents[this.getTypedef()].isLayoutComponent;\r\n\t}\r\n\r\n\tisTranslatableComponent(): boolean {\r\n\t\treturn this.getTypedef() !== Image.name\r\n\t\t\t&& !this.isLayoutComponent();\r\n\t}\r\n\r\n\t/**\r\n\t * All update methods is to be called on three occations:\r\n\t * - On startup (via newBoundaryEntered)\r\n\t * - On change setting (when changing a setting that affects the classes)\r\n\t * - On change currentBoundary (via newBoundary Entered)\r\n\t */\r\n\tupdateClasses(): void {\r\n\t\tthis.element.removeClass(this.cssClasses);\r\n\t\tthis.cssClasses = this.getClassList().join(\" \");\r\n\t\tthis.element.addClass(this.cssClasses);\r\n\t}\r\n\r\n\tprotected updateInlineStyle(): void {\r\n\t\tthis.calcNewSizes();\r\n\t\tconst style = this.getInlineStyle();\r\n\t\tthis.element.css(style);\r\n\t}\r\n\r\n\tupdateVisibility(): void {\r\n\t\tthis.isVisible = this.getBoundarySetting<boolean>(SettingKeys.VISIBILITY);\r\n\t}\r\n\r\n\tupdateShowError(): void {\r\n\t\tthis.isShowError = this.getBoundarySetting<boolean>(SettingKeys.SHOW_ERROR);\r\n\t}\r\n\r\n\t/**\r\n\t * Reload all component values\r\n\t * - Boundary settings\r\n\t * - Static settings\r\n\t *\r\n\t */\r\n\tupdateClassesAndStyle(): void {\r\n\t\tthis.updateClasses();\r\n\t\tthis.updateInlineStyle();\r\n\t\tthis.updateVisibility();\r\n\t\tthis.updateShowError();\r\n\t}\r\n\r\n\tprotected getClassList(): string[] {\r\n\t\tconst classList = [\r\n\t\t\t\"eir-component\",\r\n\t\t\t\"eir\" + this.databearer.typedef\r\n\t\t];\r\n\t\tif (this.isGenerated) {\r\n\t\t\tclassList.push(\"generatedComponent\");\r\n\t\t}\r\n\t\treturn classList;\r\n\t}\r\n\r\n\tprotected getInlineStyle(): IComponentStyle {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\treturn {\r\n\t\t\twidth: this.cssWidth,\r\n\t\t\theight: this.cssHeight,\r\n\t\t\tmargin: `${margin.top}px ${margin.right}px ${margin.bottom}px ${margin.left}px`,\r\n\t\t};\r\n\t}\r\n\r\n\tgetGeneratingParent(): ILayoutComponent {\r\n\t\tif (this.parent.isGenerated) {\r\n\t\t\treturn this.parent.getGeneratingParent();\r\n\t\t}\r\n\t\treturn this.parent;\r\n\t}\r\n\r\n\tgetValue(key: string): any {\r\n\t\tlet value = Helper.getDeepValue(this, key);\r\n\t\t// cover case of Flexbox which has values inside scope.context\r\n\t\tif (Helper.isUndefinedOrNull(value) && this.getContext()) {\r\n\t\t\tconst path = \"scope.context.\" + key;\r\n\t\t\tvalue = Helper.getDeepValue(this, path);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Used for resetting the layout of a component. The following is currently reset:\r\n\t *\r\n\t * 1. Error tooltip\r\n\t * 2. Loading is set to false\r\n\t *\r\n\t * @memberof Component\r\n\t */\r\n\tresetLayout(): void {\r\n\t\tthis.setErrorTooltip(null);\r\n\t\tthis.stopLoading();\r\n\t}\r\n\r\n\tsetErrorTooltip(errorMessage?: string): void {\r\n\t\tthis.errorTooltip = errorMessage\r\n\t\t\t? errorMessage\r\n\t\t\t: null;\r\n\t}\r\n\r\n\tprivate startLoading(): void {\r\n\t\tthis.isLoading = true;\r\n\t}\r\n\r\n\tprivate stopLoading(): void {\r\n\t\tthis.isLoading = false;\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst deferred = this.frameworkService.getNewDeferred<any>();\r\n\t\tthis.resetLayout();\r\n\t\tthis.startLoading();\r\n\t\tconst dataserviceAction = this.isDataserviceAction(interaction);\r\n\r\n\t\tif (dataserviceAction && this.datasource) {\r\n\t\t\tconst parameters = this.frameworkService.readParameters(\r\n\t\t\t\tinteraction.getParameters(),\r\n\t\t\t\tthis.getContext()\r\n\t\t\t);\r\n\r\n\t\t\tswitch (interaction.targetActionName) {\r\n\t\t\t\tcase InteractionActionEnum.LIST:\r\n\t\t\t\t\tthis.datasource.getListData(parameters).then((listResult) => {\r\n\t\t\t\t\t\tthis.getContext().ListResult = listResult;\r\n\t\t\t\t\t\tdeferred.resolve(listResult);\r\n\t\t\t\t\t}).catch((errResponse: IErrorResponse) => {\r\n\t\t\t\t\t\tthis.resetContext();\r\n\t\t\t\t\t\tdeferred.reject(errResponse);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase InteractionActionEnum.GET:\r\n\t\t\t\t\tthis.datasource.getDetailData(parameters).then((detailData: any) => {\r\n\t\t\t\t\t\tthis.setDetailResultForGetAction(detailData);\r\n\t\t\t\t\t\tthis.updateItemID(detailData, interaction);\r\n\r\n\t\t\t\t\t\tconst detailResult = this.getContext().DetailResult;\r\n\t\t\t\t\t\tif (detailResult) {\r\n\t\t\t\t\t\t\tdeferred.resolve(detailResult);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdeferred.reject({\r\n\t\t\t\t\t\t\t\tmessage: \"Nothing in response\"\r\n\t\t\t\t\t\t\t} as IErrorResponse);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Timeout needed so that interaction doesn't run before parameters been fully set\r\n\t\t\t\t\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\t\t\t\t\tthis.trigger(InteractionTriggerEnum.ON_LOAD);\r\n\t\t\t\t\t\t\tthis.refreshBindings();\r\n\t\t\t\t\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t\t\t\t\t}, Numbers.TEN);\r\n\r\n\t\t\t\t\t}).catch((errResponse: IErrorResponse) => {\r\n\t\t\t\t\t\tthis.resetContext();\r\n\t\t\t\t\t\tdeferred.reject(errResponse);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.warn(\"[Component] Invalid interaction action\");\r\n\t\t\t}\r\n\t\t} else if (!dataserviceAction) {\r\n\t\t\tthis.runComponentAction(interaction);\r\n\t\t\tdeferred.resolve();\r\n\t\t} else {\r\n\t\t\tconst errorTooltip = `No Data Service available on component: ${this.databearer.displayName}`;\r\n\t\t\tthis.setErrorTooltip(errorTooltip);\r\n\t\t\tconst errorResponse: IErrorResponse = {\r\n\t\t\t\tmessage: errorTooltip,\r\n\t\t\t\tdetail: errorTooltip\r\n\t\t\t};\r\n\t\t\tdeferred.reject(errorResponse);\r\n\t\t}\r\n\t\tdeferred.promise\r\n\t\t\t.catch((errorResponse) => {\r\n\t\t\t\tthis.setErrorTooltip(errorResponse.message);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.stopLoading();\r\n\t\t\t});\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\t/**\r\n\t * Builds a link address from a link string and a sources array\r\n\t * Used by datagrid and hyperlink for their build-link-dialog\r\n\t * @param link - the link string to interpret\r\n\t * @param sources - an array of ISourceItem\r\n\t * @return {string} - link address string\r\n\t */\r\n\tbuildLink(link: string, sources: ISourceItem[]): string {\r\n\t\tlet renderedLink = angular.copy(link);\r\n\t\tsources.forEach((source) => {\r\n\t\t\tlet value = \"\";\r\n\t\t\tconst component = this.frameworkService.getComponentInstance(source.type);\r\n\t\t\tif (component) {\r\n\t\t\t\tif (component.getDatasource()) {\r\n\t\t\t\t\tvalue = component.getValue(source.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue = component.getBindableValue(source.value);\r\n\t\t\t\t}\r\n\t\t\t\tif (Helper.isUndefinedOrNull(value)) {\r\n\t\t\t\t\tvalue = \"\";\r\n\t\t\t\t}\r\n\t\t\t} else if (source.type === BindingTypes.CONTEXT) {\r\n\t\t\t\tconst valuesource: IJsonValueSource = {\r\n\t\t\t\t\tType: BindingTypeEnum.CONTEXT_BINDING,\r\n\t\t\t\t\tsourceKey: source.value\r\n\t\t\t\t};\r\n\t\t\t\tvalue = this.frameworkService.readValueSource(valuesource, this.getContext());\r\n\t\t\t}\r\n\t\t\trenderedLink = renderedLink.replace(new RegExp(`{${source.alias}}`, \"gi\"), value);\r\n\t\t});\r\n\t\treturn renderedLink;\r\n\t}\r\n\r\n\t/**\r\n\t * Refreshes potential values inherited from parent component via context bindings and regular bindings\r\n\t * if value has changed.\r\n\t */\r\n\tprivate refreshBindings(): void {\r\n\t\tif (!isUndefined(this.getContext().DetailResult)) {\r\n\t\t\tthis.forEachChild((child) => {\r\n\t\t\t\tchild.forEachBindable((bindable, valueSource) => {\r\n\t\t\t\t\tif (valueSource) {\r\n\t\t\t\t\t\tconst isBinding =\r\n\t\t\t\t\t\t\tvalueSource.sourceName === this.getId() && valueSource.Type === BindingTypeEnum.BINDING;\r\n\t\t\t\t\t\tconst isContextBinding =\r\n\t\t\t\t\t\t\tvalueSource.sourceName === BindingTypes.CONTEXT &&\r\n\t\t\t\t\t\t\tvalueSource.Type === BindingTypeEnum.CONTEXT_BINDING;\r\n\r\n\t\t\t\t\t\tif (isBinding || isContextBinding) {\r\n\t\t\t\t\t\t\tconst newValue = this.getContext().DetailResult[valueSource.sourceKey];\r\n\t\t\t\t\t\t\tconst oldValue = child.getBindableValue(bindable.ref);\r\n\t\t\t\t\t\t\tif (!isUndefined(oldValue) && !isUndefined(newValue) && (newValue !== oldValue)) {\r\n\t\t\t\t\t\t\t\tchild.setBindableValue(bindable.ref, newValue);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}, false);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Updates current selectedItem's ItemID\r\n\t * if the data services is an local IDO using method PUT\r\n\t * @param detailData\r\n\t * @param interaction\r\n\t */\r\n\tprivate updateItemID(detailData: any, interaction: IInteraction): void {\r\n\t\tconst generic2Databearer = this.datasource.getDatabearer() as IJsonGenericDatasource2;\r\n\r\n\t\tif (generic2Databearer.typedef === DatasourceTypeEnum.IDO &&\r\n\t\t\tgeneric2Databearer.method === HttpVerbEnum.PUT\r\n\t\t) {\r\n\t\t\tconst itemIdParameter = generic2Databearer.inputParameters\r\n\t\t\t\t.find(parameter => parameter.key === IdoProperties.ITEM_ID);\r\n\r\n\t\t\tif (!Helper.isUndefined(itemIdParameter) &&\r\n\t\t\t\t!Helper.isUndefined(detailData[itemIdParameter.id])) {\r\n\t\t\t\tconst interactionParameter = interaction.getParameter(itemIdParameter.id);\r\n\r\n\t\t\t\tthis.frameworkService.setParameter(\r\n\t\t\t\t\tinteractionParameter,\r\n\t\t\t\t\tdetailData[itemIdParameter.id]\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttrigger(triggerName: string): void {\r\n\t\tthis.frameworkService.trigger(this, triggerName);\r\n\t}\r\n\r\n\tgetContext(): IContext {\r\n\t\tif (this.getScope()) {\r\n\t\t\treturn this.getScope().context;\r\n\t\t} else {\r\n\t\t\t// TODO: Find out what case this is, tell Anton if found\r\n\t\t\treturn this.parent.getScope().context;\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tthis.forEachBindable((bindableField, currentValueSource) => {\r\n\t\t\tif (currentValueSource && bindableField.write) {\r\n\t\t\t\tlet value = \"\";\r\n\t\t\t\tif (currentValueSource.Type !== BindingTypeEnum.URL_BINDING) {\r\n\t\t\t\t\tconst currentStringValue = this.getComponentTranslation(bindableField, currentValueSource.value);\r\n\t\t\t\t\tvalue = this.frameworkService.getGlobalValue(currentStringValue, this);\r\n\t\t\t\t\tif (!value) {\r\n\t\t\t\t\t\tcurrentValueSource.value = value = currentStringValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tswitch (currentValueSource.Type) {\r\n\t\t\t\t\tcase BindingTypeEnum.CONTEXT_BINDING:\r\n\t\t\t\t\t\tthis.frameworkService.registerContextBinding(\r\n\t\t\t\t\t\t\tthis,\r\n\t\t\t\t\t\t\tbindableField.ref,\r\n\t\t\t\t\t\t\tcurrentValueSource.sourceKey,\r\n\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.BINDING:\r\n\t\t\t\t\t\tthis.frameworkService.registerBinding(this, bindableField.ref, currentValueSource, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.STATIC_VALUE:\r\n\t\t\t\t\t\tthis.setBindableValue(bindableField.ref, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase BindingTypeEnum.URL_BINDING:\r\n\t\t\t\t\t\tvalue = this.frameworkService.getUrlValue(currentValueSource.sourceKey);\r\n\t\t\t\t\t\tif (value === \"\" && !this.frameworkService.isRuntimeMode()) {\r\n\t\t\t\t\t\t\tvalue = currentValueSource.value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.setBindableValue(bindableField.ref, value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.warn(\"[Component] Invalid valueSource type\");\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setDetailResultForGetAction(detailData: any): void {\r\n\t\tconst databearer2 = this.datasource.getDatabearer() as IJsonGenericDatasource2;\r\n\r\n\t\tconst localContext = this.getContext();\r\n\t\tif (detailData && typeof detailData === \"object\") {\r\n\t\t\tangular.extend(localContext, detailData);\r\n\t\t}\r\n\r\n\t\tif (databearer2.isOutputFile) {\r\n\t\t\tlocalContext.DetailResult = detailData[databearer2.outputParameters[0].id];\r\n\t\t} else {\r\n\t\t\tlocalContext.DetailResult = detailData;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate runComponentAction(interaction: IInteraction): void {\r\n\t\tswitch (interaction.targetActionName) {\r\n\t\t\tcase InteractionActionEnum.CLEAR:\r\n\t\t\t\tthis.clear();\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t//Do nothing\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isDataserviceAction(interaction: IInteraction): boolean {\r\n\t\tswitch (interaction.targetActionName) {\r\n\t\t\tcase InteractionActionEnum.CLEAR:\r\n\t\t\t\treturn false;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getComponentTranslation(field: IJsonBindableField, value: string): string {\r\n\t\tlet translationValue;\r\n\t\tif (field.valueType === ValueTypeEnum.LOCALIZED_STRING) {\r\n\t\t\tconst newValue = this.frameworkService.getTranslatableStringByProperty(this.getId(), field.ref);\r\n\t\t\tif (newValue || newValue === \"\") {\r\n\t\t\t\ttranslationValue = newValue;\r\n\t\t\t} else {\r\n\t\t\t\ttranslationValue = value;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttranslationValue = value;\r\n\t\t}\r\n\t\treturn translationValue;\r\n\t}\r\n\r\n\tforEachParent(fn: (parent: ILayoutComponent) => void): void {\r\n\t\tthis.parent.forEachParent(fn);\r\n\t}\r\n\r\n\tgetPredictedSize(): ISizeObject {\r\n\t\tconst sizes: ISizeObject = {};\r\n\t\tlet sizePredicter: JQuery;\r\n\r\n\t\tif (this.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT).sizeType === SizeTypeEnum.AUTO) {\r\n\t\t\t//let dummyText = this.Content ? this.Content : \"My dummystring\";\r\n\t\t\tsizePredicter = $(\"<div class='sizePredicter'></div>\").appendTo(\"body\");\r\n\t\t\tsizePredicter.append(this.element.clone());\r\n\t\t\tsizes.height = sizePredicter.outerHeight(true);\r\n\r\n\t\t\tsizePredicter.remove();\r\n\t\t}\r\n\r\n\t\treturn sizes;\r\n\t}\r\n\r\n\tforEachBindable(fn: (field: IJsonBindableField, curr: IJsonValueSource) => void): void {\r\n\t\tDefines.allComponents[this.databearer.typedef].class.BINDABLE_FIELDS_2\r\n\t\t\t.forEach((field: any) => {\r\n\r\n\t\t\t\tconst valueSource: IJsonValueSource = (this.databearer as any)[field.ref] ?\r\n\t\t\t\t\t(this.databearer as any)[field.ref] :\r\n\t\t\t\t\t(this as any)[field.ref]; // Quickfix for currentItem\r\n\t\t\t\tfn(field, valueSource);\r\n\t\t\t});\r\n\t}\r\n\r\n\tforEachFieldSetting(fn: (field: IComponentFieldSetting) => void): void {\r\n\t\tDefines.allComponents[this.databearer.typedef].class.SETTING_FIELDS.forEach((field: any) => {\r\n\t\t\tfn(field);\r\n\t\t});\r\n\t}\r\n\r\n\t// To be able to call forEachChild on arbitrary component\r\n\tforEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void {\r\n\t\tfn(this);\r\n\t}\r\n\r\n\tresetContext(): void {\r\n\t\tconst context = this.getContext();\r\n\t\tfor (const key in context) {\r\n\t\t\tdelete context[key];\r\n\t\t}\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\t//Do cool stuff in the future\r\n\t}\r\n\r\n\tprivate createCacheObject(): void {\r\n\t\tthis.cache = this.frameworkService.getProjectCacheObject();\r\n\t}\r\n}\r\n","//Keeping this for applicationParent\r\nexport enum SizeTypeEnum {\r\n\tPIXELS = 1,\r\n\tPERCENT = 2,\r\n\tAUTO = 3\r\n} //, Fractions = 4, Calculate = 5}\r\n","// TODO: Fix the so that contextualactionpanel is in JQuery global\r\nimport angular from \"angular\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { EventTypes, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { AngularConstants } from \"../angular-constants\";\r\nimport { IDialogBaseScope, KeyCodeEnum } from \"../defines\";\r\nimport { Helper } from \"../helper\";\r\n\r\n// Treating dialog-service as an asset\r\n/* tslint:disable */\r\n/**\r\n* UI utility functions.\r\n*/\r\nexport class Util {\r\n\tprivate static chars = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\r\n\r\n\t/**\r\n\t* Removes all popupmenus from the given element.\r\n\t* @param element Element from which to search for and remove xi-popupmenus\r\n\t*/\r\n\tpublic static removePopupMenus(element: JQuery): void {\r\n\t\tconst popupMenus = element.find(\".btn-menu[aria-haspopup]\");\r\n\t\tfor (let i = 0; i < popupMenus.length; i++) {\r\n\t\t\tconst data = $(popupMenus[i]).data(\"popupmenu\");\r\n\t\t\tif (data) {\r\n\t\t\t\tdata.close();\r\n\t\t\t\tdata.destroy();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a string with random uppercase letters and numbers.\r\n\t * The default length is 16 if the stringLength parameter is omitted.\r\n\t */\r\n\tpublic static random(stringLength: number = 16): string {\r\n\t\tconst chars = this.chars;\r\n\t\tlet randomstring = \"\";\r\n\t\tfor (let i = 0; i < stringLength; i++) {\r\n\t\t\tconst rnum = Math.floor(Math.random() * chars.length);\r\n\t\t\trandomstring += chars.substring(rnum, rnum + 1);\r\n\t\t}\r\n\t\treturn randomstring;\r\n\t}\r\n}\r\n\r\n/**\r\n * Represents options for a toast message.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IToastOptions {\r\n\t/**\r\n\t * Gets or sets the toast title.\r\n\t */\r\n\ttitle: string;\r\n\r\n\t/**\r\n\t * Gets or sets the toast message.\r\n\t */\r\n\tmessage: string;\r\n\r\n\t/**\r\n\t * Sting that stated where the toast should be displayed\r\n\t *\r\n\t * Possible values: top right, top left, bottom left, bottom right\r\n\t */\r\n\tposition?: string;\r\n\r\n\t/**\r\n\t * States whether the notification should be audible only.\r\n\t */\r\n\taudibleOnly?: boolean;\r\n\r\n\t/**\r\n\t * States whether or not to display a progress bar.\r\n\t */\r\n\tprogressBar?: boolean;\r\n\r\n\t/**\r\n\t * States for how long the toast should be visible (milliseconds).\r\n\t */\r\n\ttimeout?: number;\r\n}\r\n\r\nexport type MessageDialogStatus = \"error\" | \"alert\" | \"success\";\r\n/**\r\n * Represents options for a message dialog.\r\n *\r\n * Use either the buttons or standardButtons property.\r\n *\r\n * Example options for a message with the standrad buttons Yes and No:\r\n *\r\n *\t\tlet options: lm.IMessageDialogOptions = {\r\n *\t\t\ttitle: \"Confirm Delete\",\r\n\t*\t\t\tmessage: \"Are you sure that you want to delete the selected item?\",\r\n\t*\t\t\tstandardButtons: s.StandardDialogButtons.YesNo\r\n\t*\t\t}\r\n\t*\r\n\t* Example options for a message with custom buttons:\r\n\t*\r\n\t*\t\tlet options: lm.IMessageDialogOptions = {\r\n\t*\t\t\ttitle: \"Remove Widget\",\r\n\t*\t\t\tmessage: \"Are you sure that you want to remove the widget?\",\r\n\t*\t\t\tbuttons: [{\r\n\t*\t\t\t\ttext: \"Remove it!\",\r\n\t*\t\t\t\tvalue: \"Yes\",\r\n\t*\t\t\t\tisDefault: true\r\n\t*\t\t\t}, {\r\n\t*\t\t\t\t\ttext: \"Keep it!\",\r\n\t*\t\t\t\t\tvalue: \"No\",\r\n\t*\t\t\t\t\tisDefault: false\r\n\t*\t\t\t\t}]\r\n\t*\t\t}\r\n\t*\r\n\t* @since 1.0\r\n\t*/\r\nexport interface IMessageDialogOptions {\r\n\t/**\r\n\t * Gets or sets the dialog title.\r\n\t */\r\n\ttitle: string;\r\n\r\n\t/**\r\n\t * Gets or sets the dialog message.\r\n\t */\r\n\tmessage: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional array of dialog buttons.\r\n\t *\r\n\t * Use this property or the standardButtons property.\r\n\t */\r\n\tbuttons?: IDialogButton[];\r\n\r\n\t/**\r\n\t * Gets or sets an optional stanard button configuration.\r\n\t *\r\n\t * Use this property or the buttons property.\r\n\t */\r\n\tstandardButtons?: StandardDialogButtons;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if this is an error message.\r\n\t *\r\n\t * If this property is set to true the message dialog title will be shown with the error styling.\r\n\t */\r\n\tisError?: boolean;\r\n\t/**\r\n\t * Pass a status to style icon and title color ('error', 'alert', 'success')\r\n\t */\r\n\tstatus?: MessageDialogStatus;\r\n\t/**\r\n\t * String to include in message title that is strictly audible.\r\n\t */\r\n\taudibleLabel?: string;\r\n\r\n\t/**\r\n\t * Sets css class on modal.\r\n\t */\r\n\tcssClass?: string;\r\n\r\n\t/**\r\n\t * Specifies wether or not to automatically set primary button styling.\r\n\t *\r\n\t * True is default.\r\n\t */\r\n\thasPrimaryButton?: boolean;\r\n}\r\n\r\n/**\r\n * Defines standard button combinations for a message dialog.\r\n *\r\n * @since 1.0\r\n */\r\nexport enum StandardDialogButtons {\r\n\t/**\r\n\t * Shows an OK button (1).\r\n\t */\r\n\tOk = 1,\r\n\t/**\r\n\t * Shows an OK button and a Cancel button (2).\r\n\t */\r\n\tOkCancel = 2,\r\n\t/**\r\n\t * Shows a Yes and a No button (3).\r\n\t */\r\n\tYesNo = 3,\r\n\t/**\r\n\t * Shows a Yes, No and a Cancel button (4).\r\n\t */\r\n\tYesNoCancel = 4,\r\n}\r\n\r\n/**\r\n * Represents options for a dialog.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialogOptions<ParameterType> {\r\n\t/**\r\n\t * Gets or sets the dialog title.\r\n\t */\r\n\ttitle: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional parameter.\r\n\t *\r\n\t * If this property is set when showing a dialog it will be available on the[[IDialog]] instance.\r\n\t */\r\n\tparameter?: ParameterType;\r\n\r\n\t/**\r\n\t * Gets or sets an optional parent scope.\r\n\t */\r\n\tscope?: ng.IScope;\r\n\r\n\t/**\r\n\t * Gets or sets an optional AngularJS template.\r\n\t */\r\n\ttemplate?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional AngularJS template URL.\r\n\t */\r\n\ttemplateUrl?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional array of dialog buttons.\r\n\t *\r\n\t * This property should not be set if custom buttons are added in the dialog template.\r\n\t */\r\n\tbuttons?: IDialogButton[];\r\n\r\n\t/**\r\n\t * Gets or sets an optional style string that will be applied to the modal dialog instance.\r\n\t */\r\n\tstyle?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional CSS class that will be applied to the modal dialog instance.\r\n\t */\r\n\tcssClass?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional ID of the modal dialog instance.\r\n\t */\r\n\tid?: string;\r\n\r\n\t//Hides the overlay when true. Used in wizard-interaction\r\n\thideOverlay?: boolean;\r\n\tdraggable?: true;\r\n}\r\n\r\n/**\r\n * Represents a dialog button.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialogButton {\r\n\t/**\r\n\t * Gets or sets the text to display on the button.\r\n\t */\r\n\ttext: string;\r\n\r\n\t/**\r\n\t * Gets or sets the type of button defined in [[DialogButtonType]].\r\n\t */\r\n\ttype?: any;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value object that will be returned in the [[IDialogResult]] if set.\r\n\t */\r\n\tvalue?: any;\r\n\r\n\t/**\r\n\t * Gets or sets an optional ID for the button.\r\n\t */\r\n\tid?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if the button is a link.\r\n\t */\r\n\tisLink?: boolean;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if the button is the default button.\r\n\t */\r\n\tisDefault?: boolean;\r\n\r\n\t/**\r\n\t * Gets or sets an optional svg icon path for the button\r\n\t */\r\n\ticon?: string;\r\n\r\n\t/**\r\n\t * Gets or sets an optional css class for the dialog button\r\n\t */\r\n\tcssClass?: string;\r\n\r\n\t/**\r\n\t * FIXME: Do not use this attribute to set a function on your button. This does not work\r\n\t * Rather, set a type on the button and switch on different types in the resolved\r\n\t * promise.\r\n\t */\r\n\tclick?: Function;\r\n}\r\n\r\n/**\r\n * Represents the result from a closed dialog.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialogResult<ResultType> {\r\n\t/**\r\n\t * Gets or sets the type of button clicked, defined in [[DialogButtonType]].\r\n\t *\r\n\t * This property might not be set depending on how the dialog was dismissed.\r\n\t */\r\n\tbutton?: DialogButtonType;\r\n\r\n\t/**\r\n\t * Gets or sets an optional result value.\r\n\t *\r\n\t * This property can be used for a result value object of any type in custom dialog scenarios.\r\n\t */\r\n\tvalue?: ResultType;\r\n}\r\n\r\n/**\r\n * Defines the different types of buttons that can be used in dialogs.\r\n *\r\n * @since 1.0\r\n */\r\nexport enum DialogButtonType {\r\n\t/**\r\n\t * No button is used or the button is unknown (1).\r\n\t */\r\n\tNone = 1,\r\n\t/**\r\n\t * OK button (2).\r\n\t */\r\n\tOk = 2,\r\n\t/**\r\n\t * Cancel button (3).\r\n\t */\r\n\tCancel = 3,\r\n\t/**\r\n\t * Yes button (4).\r\n\t */\r\n\tYes = 4,\r\n\t/**\r\n\t * No button (5).\r\n\t */\r\n\tNo = 5,\r\n\t/**\r\n\t * Custom button (6).\r\n\t */\r\n\tCustom = 6,\r\n\t/**\r\n\t * Back button (7).\r\n\t */\r\n\tBack = 7\r\n}\r\n\r\nexport interface IContextualActionPanelOptions {\r\n\ttitle: string;\r\n\ttemplate?: string;\r\n\ttemplateUrl?: string;\r\n}\r\n\r\n/**\r\n* @internal\r\n*/\r\ninterface IDialogButtonEx extends IDialogButton {\r\n\tclick: Function;\r\n}\r\n\r\nexport class DialogService {\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.ROOT_SCOPE,\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.Q\r\n\t];\r\n\r\n\tprivate dialogOptions: IDialogOptions<any>;\r\n\r\n\tconstructor(private $rootScope: ng.IScope, private $compile: ng.ICompileService, private $q: ng.IQService) { }\r\n\r\n\tpublic show<ParameterType, ResultType>(options: IDialogOptions<ParameterType>): ng.IPromise<IDialogResult<ResultType>> {\r\n\t\tconst deferred = this.$q.defer();\r\n\r\n\t\tlet title: any = null;\r\n\t\tif (options) {\r\n\t\t\ttitle = options.title;\r\n\t\t\tthis.dialogOptions = options;\r\n\t\t}\r\n\t\tif (!title) {\r\n\t\t\ttitle = \"\";\r\n\t\t}\r\n\r\n\t\tconst dialog = new Dialog(deferred);\r\n\r\n\t\tconst modalScope = (options.scope || this.$rootScope).$new() as IDialogBaseScope<ParameterType>;\r\n\t\tif (options && options.parameter) {\r\n\t\t\tdialog.parameter = options.parameter;\r\n\t\t}\r\n\t\tmodalScope.eirDialog = dialog;\r\n\r\n\t\tlet contentTemplate = options.template;\r\n\t\tif (!contentTemplate) {\r\n\t\t\tconst url = options.templateUrl;\r\n\t\t\tif (!url) {\r\n\t\t\t\tthrow \"One of the template and templateUrl properties must be set\";\r\n\t\t\t}\r\n\t\t\tcontentTemplate = \"<div ng-include=\\\"'\" + url + \"'\\\"></div>\";\r\n\t\t}\r\n\r\n\t\t// TODO: Add support for standard buttons\r\n\t\t// TODO: Default style\r\n\r\n\t\tconst style = options.style || \"\";\r\n\t\tconst cssClass = options.cssClass || \"\";\r\n\t\tconst draggable = !!options.draggable;\r\n\t\tconst id = options.id || Util.random(8);\r\n\t\tconst template = `\r\n\t\t<div class=\"modal lm-scroll-no-y ${cssClass} ${options.draggable ? \"draggable-dialog\" : \"\"}\" id=\"${id}\" style=\"${style}\">\r\n\t\t\t<div class=\"modal-content\">\r\n\t\t\t\t<div class=\"modal-header\"></div>\r\n\t\t\t\t<div class=\"modal-body\">${contentTemplate}</div>`;\r\n\r\n\t\tconst element = $(template);\r\n\r\n\t\t// Modify the template slightly depending if it's a regular modal or contextual action panel modal\r\n\t\tconst headerElement = element.find(\".modal-header\");\r\n\t\theaderElement.append($(`<h1 class=\"modal-title\">${ title }<h1>`));\r\n\r\n\t\tconst compiledTemplate = this.$compile(element)(modalScope);\r\n\t\tif (draggable) { // Draggable dialog gets a position: relative added after compile. thus needs to be removed\r\n\t\t\tcompiledTemplate.css(\"position\", \"\");\r\n\t\t}\r\n\r\n\t\t$(\"body\").append(compiledTemplate);\r\n\r\n\t\tif (this.hasHideOverlayOption()) {\r\n\t\t\tthis.toggleOverlay();\r\n\t\t}\r\n\r\n\t\tlet buttons: IDialogButtonEx[] = null;\r\n\t\tif (options.buttons) {\r\n\t\t\tbuttons = this.setSpecificButtons(options.buttons, deferred, dialog);\r\n\t\t}\r\n\t\t/*\r\n\t\t\tTODO: fix for multiple ng-includes and no includes\r\n\t\tmaybe like this: http://www.competa.com/blog/2013/12/how-to-detect-when-all-your-nested-ng-includes-have-loaded-their-content-in-angularjs/\r\n\t\t*/\r\n\t\t//\t\t\tif (options.template && options.template.indexOf(\"ng-include\") === -1) {\r\n\t\t//\t\t\t\tthis.createAndOpenModal(element, dialog, title, buttons, modalScope);\r\n\t\t//\t\t\t} else { // If templateUrl, wait for included content\r\n\t\t//\t\t\t}\r\n\t\tconst unsubscribe = modalScope.$on(\"$includeContentLoaded\", () => {\r\n\t\t\tthis.createAndOpenModal(element, dialog, title, buttons, modalScope);\r\n\t\t\tunsubscribe();\r\n\t\t});\r\n\t\tif (isUndefined(options.templateUrl) && !isUndefined(options.template)) {\r\n\t\t\tthis.createAndOpenModal(element, dialog, title, buttons, modalScope);\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate createAndOpenModal(element: JQuery, dialog: Dialog, title: string, buttons: IDialogButtonEx[], modalScope: ng.IScope): void {\r\n\r\n\t\t/* Fix for SVG icons in IE11 on Windows10\r\n\t\t\trelated articles:\r\n\t\t\thttp://stackoverflow.com/questions/33040911/svg-icons-dissapears-in-windows-10-ie-11-using-jquery-sortable\r\n\t\t\thttp://jira/browse/SOHO-3069\r\n\t\t*/\r\n\t\tif (Helper.isIE()) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\telement.find(\"use\").each((idx: number, elem: Element) => {\r\n\t\t\t\t\telem.setAttribute(\"xlink:href\", elem.getAttribute(\"xlink:href\"));\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst modal = (<any>element).modal({\r\n\t\t\ttitle: title,\r\n\t\t\tbuttons: buttons\r\n\t\t});\r\n\t\tdialog.init(modal);\r\n\r\n\t\tif (!buttons) { // To calculate width of included buttons\r\n\t\t\tmodal.modal(\"addButtons\");\r\n\t\t}\r\n\r\n\t\t// Destroy the modal scope when the modal is closing.\r\n\t\tmodal.one(\"beforeclose\", () => {\r\n\t\t\tmodalScope.$destroy();\r\n\t\t\tUtil.removePopupMenus(element);\r\n\t\t\tif (this.hasHideOverlayOption()) {\r\n\t\t\t\tthis.toggleOverlay();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tmodal.modal(\"open\");\r\n\t}\r\n\r\n\tprivate hasHideOverlayOption<T>(options?: IDialogOptions<T>): boolean {\r\n\t\tconst dialogOptions = this.dialogOptions;\r\n\r\n\t\treturn dialogOptions && dialogOptions.hideOverlay ? true : false;\r\n\t}\r\n\r\n\tpublic showContextualActionPanel(options: IContextualActionPanelOptions): void {\r\n\t\tconst template = options.template || `<div ng-include=\"'${options.templateUrl}'\"></div>`;\r\n\t\tconst element: any = $(template);\r\n\r\n\t\t($(\"body\") as any).contextualactionpanel({\r\n\t\t\ttitle: options.title,\r\n\t\t\tcontent: this.$compile(element)(this.$rootScope.$new()),\r\n\t\t\ttrigger: \"immediate\",\r\n\t\t\tbuttons: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: \"Close\",\r\n\t\t\t\t\tcssClass: \"btn\",\r\n\t\t\t\t\ticon: \"#icon-close\",\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t});\r\n\t}\r\n\r\n\tpublic showMessage(options: IMessageDialogOptions): ng.IPromise<IDialogResult<any>> {\r\n\t\tconst deferred = this.$q.defer();\r\n\t\tconst element: any = $(\"body\");\r\n\t\tthis.dialogOptions = options;\r\n\r\n\t\tif (!options.buttons && !options.standardButtons) {\r\n\t\t\toptions.standardButtons = StandardDialogButtons.Ok;\r\n\t\t}\r\n\r\n\t\tif (options.standardButtons !== null) {\r\n\t\t\toptions.buttons = this.setDefaultButtons(options.standardButtons, deferred, options.hasPrimaryButton === undefined || options.hasPrimaryButton);\r\n\t\t} else if (options.buttons) {\r\n\t\t\toptions.buttons = this.setSpecificButtons(options.buttons, deferred, null);\r\n\t\t}\r\n\r\n\t\telement.message(options);\r\n\r\n\t\tconst isChildDialog = this.hasHideOverlayOption();\r\n\t\tif (isChildDialog) {\r\n\t\t\tthis.toggleOverlay();\r\n\t\t}\r\n\t\treturn deferred.promise.finally(() => {\r\n\t\t\tif (isChildDialog) {\r\n\t\t\t\tthis.toggleOverlay();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic showError(title: string, message: string): ng.IPromise<IDialogResult<void>> {\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: `<span>${title}</span>`,\r\n\t\t\tmessage: message,\r\n\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\tisError: true, //This will change to status: \"error\" in later SoHo Update to support status: \"warning\",\r\n\t\t\tstatus: \"error\",\r\n\t\t\taudibleLabel: \"Error\",\r\n\t\t};\r\n\t\t//if error dialog already exist do not show\r\n\t\tconst errorDialogExists = angular.element(\".is-error.modal-title\");\r\n\t\tif (errorDialogExists.length === 0) {\r\n\t\t\treturn this.showMessage(options);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic showYesNo(\r\n\t\ttitle: string,\r\n\t\tmessage: string,\r\n\t\tcssClass?: string\r\n\t): ng.IPromise<IDialogResult<void>> {\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: title,\r\n\t\t\tmessage: message,\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo,\r\n\t\t\tcssClass: cssClass\r\n\t\t};\r\n\t\treturn this.showMessage(options);\r\n\t}\r\n\r\n\tprivate toggleOverlay(): void {\r\n\t\t$(\"body\").toggleClass(\"no-overlay\");\r\n\t}\r\n\r\n\t/**\r\n\t* Shows a toast notification with the specified options.\r\n\t*\r\n\t* Defaults position to \"bottom right\" and timeout to 3000 if not set.\r\n\t*/\r\n\tpublic showToast(options: IToastOptions): void {\r\n\t\tif (!options.position) {\r\n\t\t\toptions.position = \"bottom right\";\r\n\t\t}\r\n\t\tif (!options.timeout) {\r\n\t\t\toptions.timeout = 3000;\r\n\t\t}\r\n\t\t$(\"body\")[\"toast\"](options);\r\n\t}\r\n\r\n\tprivate setDefaultButtons(defaults: StandardDialogButtons, deferred: ng.IDeferred<any>, hasPrimaryButton: boolean): IDialogButtonEx[] {\r\n\t\tconst buttons: IDialogButtonEx[] = [];\r\n\t\tif (defaults === StandardDialogButtons.OkCancel || defaults === StandardDialogButtons.YesNoCancel) {\r\n\t\t\tbuttons.push({\r\n\t\t\t\ttext: \"Cancel\",\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t\tdeferred.resolve({ button: DialogButtonType.Cancel });\r\n\t\t\t\t},\r\n\t\t\t\tisDefault: false\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (defaults === StandardDialogButtons.Ok || defaults === StandardDialogButtons.OkCancel) {\r\n\t\t\tbuttons.push({\r\n\t\t\t\ttext: \"OK\",\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t\tdeferred.resolve({ button: DialogButtonType.Ok });\r\n\t\t\t\t},\r\n\t\t\t\tisDefault: hasPrimaryButton\r\n\t\t\t});\r\n\t\t} else if (defaults === StandardDialogButtons.YesNo || defaults === StandardDialogButtons.YesNoCancel) {\r\n\t\t\tbuttons.push({\r\n\t\t\t\ttext: \"No\",\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t\tdeferred.resolve({ button: DialogButtonType.No });\r\n\t\t\t\t},\r\n\t\t\t\tisDefault: false\r\n\t\t\t});\r\n\t\t\tbuttons.push({\r\n\t\t\t\ttext: \"Yes\",\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t\tdeferred.resolve({ button: DialogButtonType.Yes });\r\n\t\t\t\t},\r\n\t\t\t\tisDefault: hasPrimaryButton\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn buttons;\r\n\t}\r\n\r\n\tprivate setSpecificButtons(specificButtons: IDialogButton[], deferred: ng.IDeferred<IDialogResult<any>>, dialog: IDialog<any>): IDialogButtonEx[] {\r\n\t\tconst buttons: IDialogButtonEx[] = [];\r\n\t\tspecificButtons.forEach((button: IDialogButtonEx, index: any) => {\r\n\t\t\tbutton.click = function () {\r\n\t\t\t\tif (dialog) {\r\n\t\t\t\t\tdialog.close();\r\n\t\t\t\t} else {\r\n\t\t\t\t\t(<any>$(this)).modal(\"close\");\r\n\t\t\t\t}\r\n\t\t\t\tlet result: any;\r\n\t\t\t\tif (dialog) {\r\n\t\t\t\t\tresult = dialog.result || {};\r\n\t\t\t\t\tresult.button = button.type;\r\n\t\t\t\t\tdeferred.resolve(result);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = { button: button.type };\r\n\t\t\t\t}\r\n\t\t\t\tdeferred.resolve(result);\r\n\t\t\t};\r\n\t\t\tbuttons.push(button);\r\n\t\t});\r\n\r\n\t\treturn buttons;\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule) {\r\n\t\tngModule.service(InjectNames.DIALOG_SERVICE, DialogService);\r\n\t}\r\n}\r\n\r\n/**\r\n * Represents a dialog event.\r\n *\r\n * An instance of this type will be a parameter to the closing and closed events on the [[IDialog]].\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialogEvent<T> {\r\n\t/**\r\n\t * Gets or sets the dialog instance that is the source of the event.\r\n\t */\r\n\tdialog: IDialog<T>;\r\n\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if the event should be cancelled.\r\n\t *\r\n\t * Note that only the closing event can currently be cancelled.\r\n\t */\r\n\tcancel?: boolean;\r\n}\r\n\r\n/**\r\n * Represents a modal dialog instance.\r\n *\r\n * The dialog instance can be retrieved from the scope in a dialog controller using the name \"lmDialog\".\r\n *\r\n * TODO: Add <ResultType> generic type variable.\r\n *\r\n * @since 1.0\r\n */\r\nexport interface IDialog<ParameterType> {\r\n\t/**\r\n\t * Closes the dialog.\r\n\t *\r\n\t * @param result Optional dialog result. The result property will be set if a value is provided.\r\n\t */\r\n\tclose(result?: IDialogResult<any>): void;\r\n\r\n\t/**\r\n\t * Gets or sets a function that will be called when the dialog is closing.\r\n\t *\r\n\t * The closing of the dialog can be cancelled by setting the cancel property to true on the event parameter.\r\n\t */\r\n\tclosing: (e: IDialogEvent<any>) => void;\r\n\r\n\t/**\r\n\t * Gets or sets a function that will be called when the dialog is closed.\r\n\t */\r\n\tclosed: (e: IDialogEvent<any>) => void;\r\n\r\n\t/**\r\n\t * Gets or sets a function that will be called when the dialog is opened.\r\n\t */\r\n\topened: (e: IDialogEvent<any>) => void;\r\n\r\n\t/**\r\n\t * Hides dialog in background without closing it.\r\n\t */\r\n\thide: () => void;\r\n\r\n\t/**\r\n\t * Unhides dialog which previously was hidden.\r\n\t */\r\n\tshow: () => void;\r\n\r\n\t/**\r\n\t * Get promise to hook up any interactions when result is given\r\n\t * TODO: rm this solution when soho has fixed it.\r\n\t * #MUPS-1124\r\n\t */\r\n\tgetPromise: () => ng.IPromise<any>;\r\n\r\n\t/**\r\n\t * Gets or sets an optional parameter.\r\n\t *\r\n\t * This property will have the value set on the [[IDialogOptions]] instance when showing the dialog.\r\n\t */\r\n\tparameter?: ParameterType;\r\n\r\n\t/**\r\n\t * Gets or sets the dialog result.\r\n\t */\r\n\tresult?: IDialogResult<any>;\r\n}\r\n\r\nclass Dialog implements IDialog<any> {\r\n\tpublic closing: (e: IDialogEvent<any>) => void;\r\n\tpublic closed: (e: IDialogEvent<any>) => void;\r\n\tpublic opened: (e: IDialogEvent<any>) => void;\r\n\r\n\tpublic parameter: any;\r\n\tpublic result: IDialogResult<any>;\r\n\r\n\tprivate modal: JQuery;\r\n\tprivate canClose = false;\r\n\r\n\tconstructor(private deferred: ng.IDeferred<any>) { }\r\n\r\n\tprivate resolve(): void {\r\n\t\tconst modal = this.modal;\r\n\t\tif (modal) {\r\n\t\t\t// SOHO FIX MUPS-1107\r\n\t\t\t// Removing excessive nodes: modal-wrapper & modal-page-container when a dialog is closed\r\n\t\t\tconst modalParent = modal.parent();\r\n\t\t\tconst modalGrandParent = modalParent.parent();\r\n\t\t\tif (modalParent.hasClass(\"modal-wrapper\") && modalGrandParent.hasClass(\"modal-page-container\")) {\r\n\t\t\t\tmodalGrandParent.remove();\r\n\t\t\t\tmodalParent.remove();\r\n\t\t\t}\r\n\t\t\tmodal.remove();\r\n\t\t\tthis.modal = null;\r\n\t\t}\r\n\t\tconst result = this.result || {};\r\n\t\tthis.deferred.resolve(result);\r\n\t}\r\n\r\n\tpublic init(modal: JQuery): void {\r\n\t\tthis.modal = modal;\r\n\r\n\t\t// TODO: rm this solution when soho has fixed it.\r\n\t\t// #MUPS-1124\r\n\t\tconst closeOnEscape = ($event: JQueryEventObject) => {\r\n\t\t\tif ($event.keyCode === KeyCodeEnum.ESCAPE) {\r\n\t\t\t\tconst result: IDialogResult<KeyCodeEnum> = { value: KeyCodeEnum.ESCAPE };\r\n\t\t\t\tthis.close(result);\r\n\t\t\t}\r\n\t\t};\r\n\t\tangular.element(\"body\").on(EventTypes.KEYDOWN + \".dialog\", closeOnEscape);\r\n\r\n\t\tmodal.one(\"beforeclose\", () => {\r\n\t\t\tangular.element(\"body\").off(EventTypes.KEYDOWN + \".dialog\", closeOnEscape);\r\n\t\t\tconst closing = this.closing;\r\n\t\t\tif (closing) {\r\n\t\t\t\tconst e = <IDialogEvent<any>>{ dialog: this };\r\n\t\t\t\tclosing(e);\r\n\t\t\t\treturn e.cancel ? false : true;\r\n\t\t\t} else {\r\n\t\t\t\treturn this.canClose;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tmodal.one(\"afterclose\", () => {\r\n\t\t\tconst closed = this.closed;\r\n\t\t\tif (closed) {\r\n\t\t\t\tconst e = <IDialogEvent<any>>{ dialog: this };\r\n\t\t\t\tclosed(e);\r\n\t\t\t}\r\n\t\t\tthis.resolve();\r\n\t\t});\r\n\r\n\t\tmodal.one(\"open\", () => {\r\n\t\t\tconst opened = this.opened;\r\n\r\n\t\t\tmodal.attr(\"dialog-id\", Helper.generateUniqueId());\r\n\t\t\t$(\".overlay:not([id])\").attr(\"id\", modal.attr(\"dialog-id\"));\r\n\t\t\tif (opened) {\r\n\t\t\t\tconst e = <IDialogEvent<any>>{ dialog: this };\r\n\t\t\t\topened(e);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// TODO: rm this solution when soho has fixed it.\r\n\t// #MUPS-1124\r\n\tpublic getPromise(): ng.IPromise<any> {\r\n\t\treturn this.deferred.promise;\r\n\t}\r\n\r\n\tpublic close(result?: IDialogResult<any>): void {\r\n\t\tthis.canClose = true;\r\n\t\tif (result) {\r\n\t\t\tthis.result = result;\r\n\t\t}\r\n\r\n\t\tconst modal = this.modal;\r\n\t\tif (modal) {\r\n\t\t\t(<any>modal).modal(\"close\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tthis.modal.hide();\r\n\t\t$(`div#${this.modal.attr(\"dialog-id\")}.overlay`).hide();\r\n\r\n\t}\r\n\r\n\tpublic show(): void {\r\n\t\tthis.modal.show();\r\n\t\t$(`div#${this.modal.attr(\"dialog-id\")}.overlay`).show();\r\n\t}\r\n}\r\n","import { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonComponent extends IMap<any> {\r\n\ttypedef: TypeDef;\r\n\tid: string;\r\n\tgeneratedId?: string; // ID for component with generated child components e.g. List\r\n\tdisplayName: string;\r\n\tisReadonly: boolean;\r\n\tdatasource?: string;\r\n\tboundarySettings: IMap<IJsonComponentSettings>;\r\n}\r\n\r\nexport interface IJsonComponentSettings {\r\n\twidth?: IJsonSize;\r\n\theight?: IJsonSize;\r\n\tvisibility?: boolean;\r\n\tmargin?: IJsonMargin;\r\n\tshowError?: boolean;\r\n}\r\n\r\nexport interface IJsonSize {\r\n\tsizeType: SizeTypeEnum;\r\n\tvalue?: number;\r\n}\r\n\r\nexport interface IJsonMargin extends IMap<number> {\r\n\ttop: number;\r\n\tright: number;\r\n\tbottom: number;\r\n\tleft: number;\r\n}\r\n\r\nexport type TypeDef =\r\n\t\"ApplicationParent\" |\r\n\t\"Button\" |\r\n\t\"Chart\" |\r\n\t\"Checkbox\" |\r\n\t\"Datagrid\" |\r\n\t\"Datepicker\" |\r\n\t\"Dropdown\" |\r\n\t\"Flexbox\" |\r\n\t\"Hyperlink\" |\r\n\t\"Image\" |\r\n\t\"Label\" |\r\n\t\"List\" |\r\n\t\"Lookup\" |\r\n\t\"RadioButton\" |\r\n\t\"Tabs\" |\r\n\t\"TabPanel\" |\r\n\t\"Textarea\" |\r\n\t\"Textbox\" |\r\n\t\"TextBox\";\r\n","// import { IMap } from \"ng2/common/model/imap.model\";\r\n// import { ValueType } from \"ng2/common/enums/value-type.enum\";\r\n// import { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonValueSource extends IMap<any>  {\r\n\t//Should be lower case\r\n\tType: BindingTypeEnum;\r\n\tvalue?: any;\r\n\tsourceName?: string;\r\n\tsourceKey?: string;\r\n\tvisibleName?: string;\r\n}\r\n\r\nexport interface IJsonBindableField {\r\n\tname: string;\r\n\tref: string;\r\n\tvalueType: ValueTypeEnum;\r\n\twrite: boolean;\r\n\tread: boolean;\r\n\tdefaultValue?: IJsonValueSource;\r\n\tcondition?: string;\r\n}\r\n","export enum BindingTypeEnum {\r\n\tSTATIC_VALUE = 1,\r\n\tBINDING = 2,\r\n\tCONTEXT_BINDING = 3,\r\n\tURL_BINDING = 4\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDialog } from \"./services/dialog-service\";\r\n\r\nexport interface IDialogBaseScope<ParameterType> extends ng.IScope {\r\n\teirDialog: IDialog<ParameterType>;\r\n}\r\n\r\nexport class ViewEnum {\r\n\tpublic static EDITOR = new ViewEnum(\"editor\");\r\n\tpublic static DASHBOARD = new ViewEnum(\"dashboard\");\r\n\tpublic static REPOSITORY = new ViewEnum(\"repository\");\r\n\tpublic static ADMIN = new ViewEnum(\"admin\");\r\n\r\n\tconstructor(public value: string) {\r\n\t}\r\n}\r\n\r\nexport enum KeyCodeEnum {\r\n\tBACKSPACE = 8,\r\n\tTAB = 9,\r\n\tENTER = 13,\r\n\tSHIFT = 16,\r\n\tCTRL = 17,\r\n\tALT = 18,\r\n\tPAUSE = 19,\r\n\tCAPS_LOCK = 20,\r\n\tESCAPE = 27,\r\n\tSPACE = 32,\r\n\tPAGE_UP = 33,\r\n\tPAGE_DOWN = 34,\r\n\tEND = 35,\r\n\tHOME = 36,\r\n\tLEFT_ARROW = 37,\r\n\tUP_ARROW = 38,\r\n\tRIGHT_ARROW = 39,\r\n\tDOWN_ARROW = 40,\r\n\tINSERT = 45,\r\n\tDELETE = 46,\r\n\tKEY_0 = 48,\r\n\tKEY_1 = 49,\r\n\tKEY_2 = 50,\r\n\tKEY_3 = 51,\r\n\tKEY_4 = 52,\r\n\tKEY_5 = 53,\r\n\tKEY_6 = 54,\r\n\tKEY_7 = 55,\r\n\tKEY_8 = 56,\r\n\tKEY_9 = 57,\r\n\tKEY_A = 65,\r\n\tKEY_B = 66,\r\n\tKEY_C = 67,\r\n\tKEY_D = 68,\r\n\tKEY_E = 69,\r\n\tKEY_F = 70,\r\n\tKEY_G = 71,\r\n\tKEY_H = 72,\r\n\tKEY_I = 73,\r\n\tKEY_J = 74,\r\n\tKEY_K = 75,\r\n\tKEY_L = 76,\r\n\tKEY_M = 77,\r\n\tKEY_N = 78,\r\n\tKEY_O = 79,\r\n\tKEY_P = 80,\r\n\tKEY_Q = 81,\r\n\tKEY_R = 82,\r\n\tKEY_S = 83,\r\n\tKEY_T = 84,\r\n\tKEY_U = 85,\r\n\tKEY_V = 86,\r\n\tKEY_W = 87,\r\n\tKEY_X = 88,\r\n\tKEY_Y = 89,\r\n\tKEY_Z = 90,\r\n\tLEFT_META = 91,\r\n\tRIGHT_META = 92,\r\n\tSELECT = 93,\r\n\tNUMPAD_0 = 96,\r\n\tNUMPAD_1 = 97,\r\n\tNUMPAD_2 = 98,\r\n\tNUMPAD_3 = 99,\r\n\tNUMPAD_4 = 100,\r\n\tNUMPAD_5 = 101,\r\n\tNUMPAD_6 = 102,\r\n\tNUMPAD_7 = 103,\r\n\tNUMPAD_8 = 104,\r\n\tNUMPAD_9 = 105,\r\n\tMULTIPLY = 106,\r\n\tADD = 107,\r\n\tSUBTRACT = 109,\r\n\tDECIMAL = 110,\r\n\tDIVIDE = 111,\r\n\tF1 = 112,\r\n\tF2 = 113,\r\n\tF3 = 114,\r\n\tF4 = 115,\r\n\tF5 = 116,\r\n\tF6 = 117,\r\n\tF7 = 118,\r\n\tF8 = 119,\r\n\tF9 = 120,\r\n\tF10 = 121,\r\n\tF11 = 122,\r\n\tF12 = 123,\r\n\tNUM_LOCK = 144,\r\n\tSCROLL_LOCK = 145,\r\n\tSEMICOLON = 186,\r\n\tEQUALS = 187,\r\n\tCOMMA = 188,\r\n\tDASH = 189,\r\n\tPERIOD = 190,\r\n\tFORWARD_SLASH = 191,\r\n\tGRAVE_ACCENT = 192,\r\n\tOPEN_BRACKET = 219,\r\n\tBACK_SLASH = 220,\r\n\tCLOSE_BRACKET = 221,\r\n\tSINGLE_QUOTE = 222,\r\n\tLESS_THAN = 226\r\n}\r\n\r\nexport interface IComponentStyle extends JQLiteCssProperties {\r\n\twidth: string;\r\n\theight: string;\r\n\tmargin?: string;\r\n\tdisplay?: string;\r\n}\r\n\r\nexport interface ILayoutComponentStyle extends IComponentStyle {\r\n\tpadding?: string;\r\n}\r\n\r\nexport interface ITabStyle extends ILayoutComponentStyle {\r\n\r\n}\r\n\r\nexport interface IFlexboxStyle extends ILayoutComponentStyle {\r\n\tbackgroundColor?: string;\r\n\tflexGrow?: number;\r\n\tflexShrink?: number;\r\n\tflexBasis?: string;\r\n}\r\n\r\nexport interface IComponentElement extends ng.IAugmentedJQuery {\r\n\t// scope: () => IComponentScope;\r\n}\r\n\r\nexport interface IAvailableSourceField extends IMap<string> {\r\n\tvisibleName: string;\r\n\tsourceKey: string;\r\n\tsourceKeyShort: string;\r\n\tcurrentValue?: any;\r\n\ttype?: string;\r\n}\r\n\r\nexport interface IJQueryScrollEventObject extends JQueryEventObject {\r\n\tcurrentTarget: HTMLElement;\r\n}\r\n\r\nexport interface IJQueryDragEventObject extends JQueryEventObject {\r\n\toriginalEvent: DragEvent;\r\n}\r\n\r\nexport interface IJQueryMouseEventObject extends JQueryInputEventObject {\r\n\tbutton: number;\r\n\tclientX: number;\r\n\tclientY: number;\r\n\toffsetX: number;\r\n\toffsetY: number;\r\n\toriginalEvent: MouseEvent;\r\n\tpageX: number;\r\n\tpageY: number;\r\n\tscreenX: number;\r\n\tscreenY: number;\r\n}\r\n","import { InteractionPairOperation } from \"ng2/common/constants/common.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\n\r\nexport class InteractionDefines {\r\n\tpublic static readonly SOURCE_TRIGGERS: IDataPair[] = [InteractionPairOperation.ON_LOAD];\r\n\tpublic static readonly TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.GET];\r\n}\r\n","import isEmpty from \"lodash-es/isEmpty\";\r\nimport isNil from \"lodash-es/isNil\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport {\r\n\tButtonStyle,\r\n\tChartTypeEnum,\r\n\tDEFAULT_BOUNDARY,\r\n\tValueObject,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonButton } from \"ng2/common/model/databearer/components/json-button.model\";\r\nimport type { IJsonChart, IJsonChartDataset } from \"ng2/common/model/databearer/components/json-chart.model\";\r\nimport type { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJSonMaskSettings, IJsonTextBox } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\nimport type { IHttpHeader } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\n\r\nimport { HttpAcceptEnum } from \"ng2/common/enums/http-accept-enum\";\r\n\r\nexport class BackwardCompatible {\r\n\tstatic setDataServiceHeader(headers: IHttpHeader): IHttpHeader {\r\n\t\treturn !isUndefined(headers) && !isEmpty(headers) ? headers : {\r\n\t\t\tAccept: HttpAcceptEnum.APPLICATION_JSON,\r\n\t\t};\r\n\t}\r\n\r\n\tstatic tryUpdateUrlName(manifest: IJsonRuntimeManifest): boolean {\r\n\t\tif (manifest.urlName === \"url\") { // backward compatbility\r\n\t\t\tconst newUrlName = `(SETVARVALUES(InitURL=run/${manifest.id}))`;\r\n\t\t\tmanifest.urlName = newUrlName;\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tstatic tryGetMask(obj: IJsonTextBox): IJSonMaskSettings {\r\n\t\tif (obj.mask) { // backward compatbility\r\n\t\t\treturn obj.mask;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tprocess: \"none\"\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Check if showlabel is legacy format or not.\r\n\t * Parameter is any beacuse it can be any component\r\n\t * @param obj\r\n\t */\r\n\r\n\tstatic getShowLabel(obj: any): boolean {\r\n\t\tconst defaultBoundary = obj.boundarySettings[DEFAULT_BOUNDARY.id];\r\n\t\tif (!isNil(defaultBoundary.showLabel)) {\r\n\t\t\treturn defaultBoundary.showLabel;\r\n\t\t} else {\r\n\t\t\tif (obj.showLabel) {\r\n\t\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].showLabel = obj.showLabel.value;\r\n\t\t\t} else {\r\n\t\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].showLabel = true;\r\n\t\t\t}\r\n\t\t\treturn obj.boundarySettings[DEFAULT_BOUNDARY.id].showLabel;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic tryGetBoxWidth(width: string): string {\r\n\t\tif (width) {\r\n\t\t\treturn width;\r\n\t\t} else {\r\n\t\t\treturn \"input-default\";\r\n\t\t}\r\n\t}\r\n\r\n\tstatic tryUpdateButtonStyle(obj: IJsonButton): string {\r\n\t\tlet style: string;\r\n\r\n\t\tif (!obj.style) {\r\n\t\t\tif (obj.isDefault) {\r\n\t\t\t\tstyle = ButtonStyle.PRIMARY;\r\n\t\t\t} else {\r\n\t\t\t\tstyle = ButtonStyle.SECONDARY;\r\n\t\t\t}\r\n\t\t\tconsole.warn(\"Deprecated property found in Button component\");\r\n\t\t} else {\r\n\t\t\tstyle = obj.style;\r\n\t\t}\r\n\t\treturn style;\r\n\t}\r\n\r\n\tstatic getHref(rowData: any, column: IExtendedDataGridColumn): string {\r\n\t\tlet hrefString = \"\";\r\n\t\tif (column.hyperlinkOptions) {\r\n\t\t\tif (column.field === ValueObject.STATIC_VALUE) {\r\n\t\t\t\threfString = column.hyperlinkOptions.value.replace(\"{$value}\", column.text);\r\n\t\t\t} else {\r\n\t\t\t\threfString = column.hyperlinkOptions.value.replace(\"{$value}\", rowData[column.field]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (column.field === ValueObject.STATIC_VALUE) {\r\n\t\t\t\threfString = column.text;\r\n\t\t\t} else {\r\n\t\t\t\threfString = rowData[column.field];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn hrefString;\r\n\t}\r\n\r\n\tstatic tryConvertLegacyChart(databearer: IJsonChart, obj: IJsonChart): void {\r\n\t\tconst defaultBoundary = obj.boundarySettings[DEFAULT_BOUNDARY.id];\r\n\t\tif (this.isLegacyChart(databearer)) {\r\n\t\t\tif (this.isLegacyChartType(defaultBoundary.chartType) || !defaultBoundary.chartType) {\r\n\t\t\t\tlet newType: ChartTypeEnum;\r\n\t\t\t\tswitch (defaultBoundary.chartType) {\r\n\t\t\t\t\tcase ChartTypeEnum.StackedColumn:\r\n\t\t\t\t\t\tnewType = ChartTypeEnum.ColumnStacked;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase ChartTypeEnum.Profile:\r\n\t\t\t\t\tcase ChartTypeEnum.StackedLine:\r\n\t\t\t\t\t\tnewType = ChartTypeEnum.Line;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: // unknown legacy chartType\r\n\t\t\t\t\t\tnewType = ChartTypeEnum.Bar;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].chartType = newType;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.hasLegacyChartData(databearer)) {\r\n\t\t\t\tthis.convertToNewChartFormat(databearer);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//Add default values if missing\r\n\t\tif (isNil(defaultBoundary.legendDisplay)) {\r\n\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].legendDisplay = true;\r\n\t\t}\r\n\t\tif (isNil(defaultBoundary.startupAnimationEnable)) {\r\n\t\t\tobj.boundarySettings[DEFAULT_BOUNDARY.id].startupAnimationEnable = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static isLegacyChart(databearer: IJsonChart): boolean {\r\n\t\treturn this.hasLegacyChartData(databearer) ||\r\n\t\t\tthis.isLegacyChartType(databearer.boundarySettings[DEFAULT_BOUNDARY.id].chartType) ||\r\n\t\t\t!databearer.boundarySettings[DEFAULT_BOUNDARY.id].chartType;\r\n\t}\r\n\r\n\tprivate static hasLegacyChartData(databearer: IJsonChart): boolean {\r\n\t\treturn databearer.categories && databearer.categories.length > 0;\r\n\t}\r\n\r\n\tprivate static isLegacyChartType(chartType: ChartTypeEnum): boolean {\r\n\t\treturn [ChartTypeEnum.Profile, ChartTypeEnum.StackedColumn, ChartTypeEnum.StackedLine].includes(chartType);\r\n\t}\r\n\r\n\tprivate static convertToNewChartFormat(databearer: IJsonChart): void {\r\n\t\tdatabearer.categories.forEach((category, i) => {\r\n\t\t\tlet newDataset: IJsonChartDataset;\r\n\t\t\tif (databearer.series[i]) {\r\n\t\t\t\tnewDataset = {\r\n\t\t\t\t\tname: category.name,\r\n\t\t\t\t\tcategories: category.field,\r\n\t\t\t\t\tseries: databearer.series[i].field,\r\n\t\t\t\t};\r\n\t\t\t\tdatabearer.datasets.push(newDataset); // push new format\r\n\t\t\t}\r\n\t\t});\r\n\t\tdatabearer.series = null; // remove legacy format\r\n\t\tdatabearer.categories = null; // remove legacy format\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport isArray from \"lodash-es/isArray\";\r\n\r\nimport {\r\n\tABFormScriptMethod,\r\n\tConfig,\r\n\tInjectNames,\r\n\tSubcodes,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { Debugger } from \"common/debugger\";\r\nimport { ErrorResponse, IErrorResponse } from \"common/error-response\";\r\nimport { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nexport interface IMashupRestResponse<DataType> {\r\n\tdata?: DataType;\r\n\tsuccess: boolean;\r\n\terror?: IErrorResponse;\r\n}\r\n\r\nexport class HttpService {\r\n\tprivate overrideUrl: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.HTTP,\r\n\t\tAngularConstants.Q\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate http: ng.IHttpService,\r\n\t\tprivate q: ng.IQService\r\n\t) { }\r\n\r\n\tgetUrl(path?: string): string {\r\n\t\tif (path) {\r\n\t\t\treturn this.getBaseUrl() + Config.REST_ROOT + path;\r\n\t\t}\r\n\t\treturn this.getBaseUrl() + Config.REST_ROOT;\r\n\t}\r\n\r\n\tsetOverrideUrl(url: string): void {\r\n\t\tthis.overrideUrl = url;\r\n\t}\r\n\r\n\t/**\r\n\t * Execute a GET request\r\n\t * @param resource URL resource path\r\n\t * @param params optional parameters to be sent in the request\r\n\t * @param external pass true if GET request not goes to Mongoose internally\r\n\t */\r\n\texecuteGet<T>(resource: string, params?: any, external?: boolean): ng.IPromise<T> {\r\n\t\treturn this.execute<T>(resource, HttpVerbEnum.GET, null, params, external);\r\n\t}\r\n\r\n\texecutePost<T>(resource: string, data?: any, params?: any): ng.IPromise<T> {\r\n\t\treturn this.execute<T>(resource, HttpVerbEnum.POST, data, params);\r\n\t}\r\n\r\n\texecutePut<T>(resource: string, data: any, params?: any): ng.IPromise<T> {\r\n\t\treturn this.execute<T>(resource, HttpVerbEnum.PUT, data, params);\r\n\t}\r\n\r\n\texecuteDelete(resource: string, params?: any): ng.IPromise<void> {\r\n\t\treturn this.execute<void>(resource, HttpVerbEnum.DELETE, null, params);\r\n\t}\r\n\r\n\texecuteRequest<T>(requestConfig: ng.IRequestConfig): ng.IPromise<ng.IHttpPromiseCallbackArg<T>> {\r\n\t\tthis.debug(\"Executing \" + requestConfig.method + \" \" + requestConfig.url);\r\n\t\tconst deferred: ng.IDeferred<ng.IHttpPromiseCallbackArg<T>> = this.q.defer();\r\n\t\t// Special case for the ION API Token\r\n\t\tif (!DEV_SERVER &&\r\n\t\t\t(requestConfig.url.indexOf(Config.REST_ROOT + \"dev/token\") === 0 ||\r\n\t\t\t\trequestConfig.url.indexOf(\"/grid/rest/security/sessions/oauth\") === 0)) {\r\n\t\t\tWSForm.call({\r\n\t\t\t\tname: ABFormScriptMethod.TOKEN,\r\n\t\t\t\tparameters: [JSON.stringify(requestConfig)],\r\n\t\t\t\tonCompleted: (response) => {\r\n\t\t\t\t\t//const response: T = JSON.parse(responseJson);\r\n\t\t\t\t\t//deferred.resolve(response.data);\r\n\t\t\t\t\tconst httpResponse: ng.IHttpPromiseCallbackArg<T> = {\r\n\t\t\t\t\t\tdata: response\r\n\t\t\t\t\t} as any;\r\n\t\t\t\t\tif (!Helper.isUndefinedEmpty(response)) {\r\n\t\t\t\t\t\tdeferred.resolve(httpResponse);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst error = new ErrorResponse(\r\n\t\t\t\t\t\t\t`Could not retrieve ION token. ${Subcodes.CONTACT_SYSTEM_ADMIN}`,\r\n\t\t\t\t\t\t\tSubcodes.GENERIC_ERROR);\r\n\t\t\t\t\t\tdeferred.reject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn deferred.promise;\r\n\t\t}\r\n\r\n\t\treturn this.executeHttp<T>(requestConfig);\r\n\t}\r\n\r\n\tupload<T>(\r\n\t\tresource: string,\r\n\t\tfiles: File[],\r\n\t\tformFields?: IMap<string>): ng.IPromise<ng.IHttpPromiseCallbackArg<IMashupRestResponse<T>>> {\r\n\r\n\t\tconst deferred = this.q.defer<ng.IHttpPromiseCallbackArg<IMashupRestResponse<T>>>();\r\n\t\tconst url = this.getBaseUrl() + Config.REST_ROOT + resource;\r\n\t\tconst formData = new FormData();\r\n\r\n\t\tfor (let i = 0; i < files.length; i++) {\r\n\t\t\tformData.append(\"file\", files[i]);\r\n\t\t}\r\n\r\n\t\tif (formFields) {\r\n\t\t\tfor (const key in formFields) {\r\n\t\t\t\t// Dont send null since it will be interpreted as the string \"null\" by the server\r\n\t\t\t\tif (formFields[key] !== null) {\r\n\t\t\t\t\tformData.append(key, formFields[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst params = {\r\n\t\t\t// Let the browser decide Content-Type\r\n\t\t\theaders: ({ \"Content-Type\": undefined } as any),\r\n\t\t\ttransformRequest: angular.identity\r\n\t\t};\r\n\r\n\t\tthis.http.post<IMashupRestResponse<T>>(encodeURI(url), formData, params).then((httpResponse) => {\r\n\t\t\tthis.debug(\"[HttpService] Completed \", httpResponse);\r\n\t\t\tdeferred.resolve(httpResponse);\r\n\t\t}).catch((httpResponse: ng.IHttpPromiseCallbackArg<IMashupRestResponse<void> | any>) => {\r\n\t\t\tlet errorPayload: IMashupRestResponse<void> = httpResponse.data;\r\n\t\t\tif (!(errorPayload && errorPayload.error)) {\r\n\t\t\t\terrorPayload = {\r\n\t\t\t\t\tsuccess: false,\r\n\t\t\t\t\terror: {\r\n\t\t\t\t\t\tcode: httpResponse.status,\r\n\t\t\t\t\t\tmessage: httpResponse.statusText,\r\n\t\t\t\t\t\tdetail: httpResponse.statusText,\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tdeferred.reject(errorPayload.error);\r\n\t\t});\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\t/**\r\n\t * Sequentially resolves a list of promises.\r\n\t * @param promises\r\n\t */\r\n\treduce(promises: ng.IPromise<any>[]): ng.IPromise<any> {\r\n\t\treturn this.q.all(promises);\r\n\t}\r\n\r\n\tprivate execute<T>(\r\n\t\tresource: string, method: HttpVerbEnum, data?: any, params?: any, outside?: boolean\r\n\t): ng.IPromise<T> {\r\n\t\tconst deferred: ng.IDeferred<T> = this.q.defer();\r\n\t\tconst url = DEV_SERVER ?\r\n\t\t\t`${ Config.REST_ROOT }/${ resource }` :\r\n\t\t\t`${ Config.REST_ROOT }${ resource }`;\r\n\t\tthis.debug(\"Executing \" + method + \" \" + url);\r\n\r\n\t\tconst requestConfig: angular.IRequestConfig = {\r\n\t\t\tmethod,\r\n\t\t\turl,\r\n\t\t\tdata,\r\n\t\t\tparams,\r\n\t\t\tcache: false\r\n\t\t};\r\n\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tthis.executeHttp<T>(requestConfig).then((result) => {\r\n\t\t\t\tif (result.data && isArray(result.data)) {\r\n\t\t\t\t\tdeferred.resolve(result.data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst response = (result.data as any).data;\r\n\t\t\t\t\tdeferred.resolve(response);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (!outside) {\r\n\t\t\t\tWSForm.call({\r\n\t\t\t\t\tname: ABFormScriptMethod.APPBUILDER_REST,\r\n\t\t\t\t\tparameters: [JSON.stringify(requestConfig)],\r\n\t\t\t\t\tonCompleted: (rawJson) => {\r\n\t\t\t\t\t\tif (rawJson !== \"\") {\r\n\t\t\t\t\t\t\tconst response: IMashupRestResponse<T> = JSON.parse(rawJson);\r\n\t\t\t\t\t\t\tif (response.success) {\r\n\t\t\t\t\t\t\t\tdeferred.resolve(response.data);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdeferred.reject(response.error);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdeferred.reject(`Response from '${requestConfig.url}', contains invalid JSON`);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (outside) {\r\n\t\t\t\tthis.executeHttp<T>(requestConfig).then((result) => {\r\n\t\t\t\t\tif (result.data) {\r\n\t\t\t\t\t\tdeferred.resolve(result.data);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tdeferred.reject(\"Failed due to: WSForm not available.\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate executeHttp<T>(requestConfig: ng.IRequestConfig): ng.IPromise<ng.IHttpPromiseCallbackArg<T>> {\r\n\t\tconst deferred: ng.IDeferred<ng.IHttpPromiseCallbackArg<T>> = this.q.defer();\r\n\t\tthis.http<T>(requestConfig).then((httpResponse: ng.IHttpPromiseCallbackArg<any>) => {\r\n\t\t\tdeferred.resolve(httpResponse);\r\n\t\t}).catch((httpResponse: ng.IHttpPromiseCallbackArg<any>) => {\r\n\t\t\tconst modifiedHttpResponse = {\r\n\t\t\t\t...httpResponse\r\n\t\t\t};\r\n\r\n\t\t\t//Sanitize error message for veracode scan\r\n\t\t\t//https://stackoverflow.com/questions/44949254/how-to-fix-veracode-cwe-117-improper-output-neutralization-for-logs\r\n\t\t\tconst logMessage = `\r\n\t\t\t\t[HttpService] Failed to ${requestConfig.method} ${requestConfig.url},\r\n\t\t\t\tResponse: ${angular.toJson(modifiedHttpResponse)}\r\n\t\t\t`;\r\n\t\t\tlogMessage.replace(\"\\n\", \"_\").replace(\"\\r\", \"_\");\r\n\t\t\tconsole.error(logMessage);\r\n\t\t\t/*\r\n\t\t\t* Check if the response status is -1. Found no documentation on this but through emperical research\r\n\t\t\t* we found that most of the times, the reason is:\r\n\t\t\t* - You're Offline\r\n\t\t\t* - The http request timed out\r\n\t\t\t* - CORS options http request failed for some reason\r\n\t\t\t*/\r\n\t\t\tif (modifiedHttpResponse.status === -1) {\r\n\t\t\t\tconst possibleReasons = [\r\n\t\t\t\t\t\"You're Offline\",\r\n\t\t\t\t\t\"The http request timed out\",\r\n\t\t\t\t\t\"CORS options http request failed for some reason\"\r\n\t\t\t\t];\r\n\t\t\t\tconsole.error(`Status -1 was returned from angular httpService, this could mean multiple things:\r\n\t\t\t\t\t${possibleReasons.map(reason => `\\n- ${reason}`).join()}\r\n\t\t\t\t`);\r\n\t\t\t\tconst newStatusText = `\r\n\t\t\t\t\tThis could mean multiple things:\r\n\t\t\t\t\t${possibleReasons.map(reason => `<br>- ${reason}`).join()}\r\n\t\t\t\t`;\r\n\t\t\t\tmodifiedHttpResponse.statusText = modifiedHttpResponse.statusText\r\n\t\t\t\t\t? modifiedHttpResponse.statusText\r\n\t\t\t\t\t: newStatusText;\r\n\t\t\t}\r\n\r\n\t\t\tdeferred.reject(modifiedHttpResponse);\r\n\t\t});\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate getBaseUrl(): string {\r\n\t\treturn (this.overrideUrl ? this.overrideUrl : \"\");\r\n\t}\r\n\r\n\tprivate debug(message: string, data?: any): void {\r\n\t\tif (Config.IS_DEV && Debugger.isEnabled()) {\r\n\t\t\tdata ? console.debug(\"[HttpService] \" + message, data) : console.debug(\"[HttpService] \" + message);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.HTTP_SERVICE, HttpService);\r\n\t}\r\n}\r\n","import { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { HttpAcceptEnum } from \"ng2/common/enums/http-accept-enum\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { ILocalIdoParameterObject, IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport * as sw from \"ng2/common/model/swagger.model\";\r\n\r\nexport interface IDatasourceDataset {\r\n\tname: string;\r\n\tdescription: string;\r\n}\r\n\r\nexport interface IJsonDatasource {\r\n\ttypedef?: DatasourceTypeEnum;\r\n\tversion?: number;\r\n\tid?: string;\r\n\tdisplayName?: string;\r\n\tdescription?: string;\r\n\t// Set on server\r\n\tauthor?: string;\r\n\tauthorDisplayName?: string;\r\n\tcreationDate?: number;\r\n\tchangedBy?: string;\r\n\tchangedByDisplayName?: string;\r\n\tchangedDate?: number;\r\n\theaders?: IHttpHeader;\r\n}\r\n\r\nexport interface IJsonGenericDatasource extends IJsonDatasource {\r\n\t// suite, endpoint and resource will together construct a Url\r\n\tsuite?: string;\r\n\tendpoint?: string;\r\n\tresource?: string;\r\n\r\n\tmethod?: HttpVerbEnum;\r\n\t// bodyParameters are used only when method are not GET\r\n\tbodyParameters?: string;\r\n\r\n\t/* Key Value object where containing \"query variable of {}s\" */\r\n\tinputParameters?: IMap<string>;\r\n\t// TODO: change datatype in future\r\n\toutputParameters?: string;\r\n\r\n\tisOutputFile?: boolean;\r\n}\r\n\r\nexport interface IJsonGenericDatasource2 extends IJsonDatasource {\r\n\t// suite, endpoint and resource will together construct a Url\r\n\tsuite: string;\r\n\tendpoint: string;\r\n\tresource: string;\r\n\r\n\tmethod: HttpVerbEnum;\r\n\r\n\tinputSchema?: sw.ISchemaObject;\r\n\toutputSchema?: sw.ISchemaObject;\r\n\toriginalSchema?: sw.ISchemaObject;\r\n\tinputParameters?: IParameterObject[];\r\n\toutputParameters?: IParameterObject[];\r\n\tbodyTemplate?: string;\r\n\toutputRootElement?: string;\r\n\tinputRootElement?: string;\r\n\toutputJson?: string;\r\n\r\n\tisOutputFile?: boolean;\r\n\tobjectIdPath?: string;\r\n}\r\n\r\nexport interface IJsonLocalIdoDatasource extends IJsonGenericDatasource2 {\r\n\torderBy?: string;\r\n\trecordCap: IRecordCapOption;\r\n\tinputParameters: ILocalIdoParameterObject[];\r\n\toutputParameters: ILocalIdoParameterObject[];\r\n}\r\n\r\nexport interface IJsonInlineListDatasource extends IJsonDatasource {\r\n\tsuite: string;\r\n\toutputParameters: IJsonInlineListParameter[];\r\n\tdataset: IListDataItem[];\r\n}\r\n\r\nexport interface IJsonInlineListParameter {\r\n\tid: string;\r\n\tkey: string;\r\n\tfield: string;\r\n}\r\n\r\nexport interface IRecordCapOption {\r\n\tname: string;\r\n\tid: string;\r\n\tlimit?: number;\r\n}\r\n\r\nexport interface IJsonM3Datasource extends IJsonGenericDatasource {\r\n\toperations: IJsonM3Operation[];\r\n}\r\n\r\nexport interface IJsonM3Operation {\r\n\tdataParameters: IMap<any>;\r\n}\r\n\r\nexport interface IJsonM3CloudData{\r\n\tresults: [\r\n\t\t{\r\n\t\t\ttransaction: string,\r\n\t\t\trecords: any[],\r\n\t\t\terrorMessage: string,\r\n\t\t\terrorType: string\r\n\t\t}\r\n\t],\r\n\twasTerminated: boolean,\r\n\tnrOfSuccessfullTransactions: number,\r\n\tnrOfFailedTransactions: number,\r\n}\r\n\r\nexport interface IJsonLNDatasource extends IJsonDatasource {\r\n\tSoapEnvelope: string;\r\n\tRelativeURL: string;\r\n\tResultPath: string;\r\n\tAttrPrefix: string;\r\n\tAttributes: string[];\r\n\tFilter: IJsonLNComparison[];\r\n\tMaxNoObjects: number;\r\n}\r\n\r\nexport interface IJsonLNComparison {\r\n\tOperator: string;\r\n\tAttribute: string;\r\n\tValue: string;\r\n}\r\n\r\nexport interface IHttpHeader {\r\n\t// Informs the server about the types of data that can be sent back.\r\n\tAccept?: HttpAcceptEnum;\r\n\t// Contains the credentials to authenticate a user-agent with a server.\r\n\tAuthorization?: string;\r\n\t\"X-Infor-MongooseConfig\"?: string;\r\n\t\"Content-Type\"?: ContentType;\r\n}\r\nexport type ContentType = \"application/json\" | \"text/plain\";\r\n","export interface IComponentRendered {\r\n\tid?: string;\r\n\tapi: any;\r\n}\r\nexport enum SelectableEnum {\r\n\tSingle = \"single\",\r\n\tMultiple = \"multiple\",\r\n\tMixed = \"mixed\",\r\n\tSiblings = \"siblings\",\r\n}\r\n\r\n// datagrid formatters\r\nexport enum FormatterEnum {\r\n\tText = \"text\",\r\n\tEllipsis = \"ellipsis\",\r\n\tPassword = \"password\",\r\n\tDate = \"date\",\r\n\tAutocomplete = \"autocomplete\",\r\n\tLookup = \"lookup\",\r\n\tDecimal = \"decimal\",\r\n\tInteger = \"integer\",\r\n\tHyperlink = \"hyperlink\",\r\n\tTemplate = \"template\",\r\n\tDrilldown = \"drilldown\",\r\n\tCheckbox = \"checkbox\",\r\n\tSelectionCheckbox = \"selectionCheckbox\",\r\n\tActions = \"actions\",\r\n\tTextarea = \"textarea\",\r\n\tExpander = \"expander\",\r\n\tClassRange = \"classRanger\",\r\n\tBadge = \"badge\",\r\n\tTag = \"tag\",\r\n\tAlert = \"alert\",\r\n\tImage = \"image\",\r\n\tColor = \"color\",\r\n\tButton = \"button\",\r\n\tDropdown = \"dropdown\",\r\n\tFavorite = \"favorite\",\r\n\tStatus = \"status\",\r\n\tTree = \"tree\",\r\n\r\n\t// Custom\r\n\tDatetime = \"datetime\",\r\n\tTime = \"time\",\r\n\tAbsoluteValue= \"absolutevalue\",\r\n}\r\n\r\nexport enum ColumnOptionEnum {\r\n\tEditable = \"editable\",\r\n\tSortable = \"sortable\",\r\n\tResizable = \"resizable\",\r\n}\r\n\r\nexport enum DateFormatEnum {\r\n\tDatetime = \"datetime\",\r\n\tLong = \"long\",\r\n\tShort = \"short\",\r\n\tTimestamp = \"timestamp\",\r\n\tTimeformat = \"timeFormat\",\r\n}\r\n","export interface IErrorResponse {\r\n\tmessage: string;\r\n\tdetail?: string;\r\n\tcode?: number;\r\n\tsubcode?: number;\r\n\tsuccessfulItems?: string[];\r\n\tfailedItems?: string[];\r\n}\r\n\r\nexport class ErrorResponse implements IErrorResponse {\r\n\tmessage: string;\r\n\tdetail?: string;\r\n\tcode: number;\r\n\r\n\tconstructor(message: string, code: number = -1, stack: string = \"No-stacktrace/details\") {\r\n\t\tthis.message = message;\r\n\t\tthis.detail = stack;\r\n\t\tthis.code = code;\r\n\t}\r\n}\r\n","import { ProjectTypeEnum, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\n\r\nexport interface IJsonManifest {\r\n\tcreatedBy: string;\r\n\tcreatedByDisplayName: string;\r\n\tcreatedTime: number;\r\n\tdescription: string;\r\n\tdisplayName: string;\r\n\tid: string;\r\n\tlastChangedBy: string;\r\n\tlastChangedByDisplayName: string;\r\n\tlastChangedTime: number;\r\n\tmashupBoundaries: IBoundary[];\r\n\turlVariables: IJsonUrlVariable[];\r\n\ttitle: string;\r\n\tversion: string;\r\n\tpreviewImg: string;\r\n\tshowTitleBar: boolean;\r\n\tthemeSwitchEnabled: boolean;\r\n\tdefaultTheme: ThemeEnum;\r\n}\r\n\r\nexport interface IJsonRuntimeManifest extends IJsonManifest {\r\n\turlName: string;\r\n\tstatus: number;\r\n}\r\n\r\nexport interface IJsonDesignerManifest extends IJsonManifest {\r\n\tfileMetaData: IMap<IJsonFileMetaData>;\r\n\ttypeDef: ProjectTypeEnum;\r\n}\r\n\r\nexport interface IJsonFileMetaData {\r\n\tmimeType: string;\r\n\tvisibleName: string;\r\n}\r\n","import isNil from \"lodash-es/isNil\";\r\n\r\nimport {\r\n\tConfig,\r\n\tDEFAULT_BOUNDARY,\r\n\tInjectNames,\r\n\tMGPlatform,\r\n\tSaveFlagsEnum,\r\n\tServerPaths,\r\n\tThemeEnum,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonMashup, IJsonRuntimeMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IEnvironmentSettings } from \"ng2/common/model/environment-settings.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IDesignerMashup } from \"ng2/common/model/project/mashup/designer-mashup.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport type { IAvailableSourceField } from \"common/defines\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { Mashup } from \"ng2/common/project/mashup\";\r\nimport type { IProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nimport { Helper, SmartBlob } from \"common/helper\";\r\n\r\nimport { HttpService } from \"common/services/http-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\nimport { ThemeService } from \"common/services/theme-service\";\r\nimport { DatasourceService } from \"components/services/datasource-service\";\r\n\r\nexport interface IRootScope extends ng.IRootScopeService {\r\n\tcurrentProject: IDesignerMashup;\r\n}\r\n\r\nexport class CommonService {\r\n\tprojectSettingsChangedEvent = new InstanceEvent<DesignerManifest>();\r\n\tcurrentBoundaryChangedEvent = new InstanceEvent<IBoundary>();\r\n\tcurrentCanvasThemeChangedEvent = new InstanceEvent<ThemeEnum>();\r\n\tonDuplicateProjectChangedEvent = new InstanceEvent<void>();\r\n\tprivate urlMetaData: IAvailableSourceField[] = [];\r\n\tprivate currentProject: Mashup;\r\n\tprivate currentRootComponentInstance: ILayoutComponent;\r\n\tprivate currentCanvasTheme: ThemeEnum;\r\n\tprivate currentBoundary: IBoundary = DEFAULT_BOUNDARY;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.DATASOURCE_SERVICE,\r\n\t\tInjectNames.THEME_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tpublic $timeout: ng.ITimeoutService,\r\n\t\tpublic httpService: HttpService,\r\n\t\tprivate datasourceService: DatasourceService,\r\n\t\tprivate themeService: ThemeService,\r\n\t\tprivate languageService: LanguageService\r\n\t) { }\r\n\r\n\tloadProjects(): ng.IPromise<IProjectInfo[]> {\r\n\t\treturn this.httpService.executeGet(`${ServerPaths.PROJECT}`);\r\n\t}\r\n\r\n\tloadActivatedApps(): ng.IPromise<IJsonRuntimeManifest[]> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.RUNTIME + \"active\");\r\n\t}\r\n\r\n\tloadProject(projectId: string, canvasWidth?: number): ng.IPromise<IJsonMashup> {\r\n\t\treturn this.httpService.executeGet<IJsonMashup>(ServerPaths.PROJECT + projectId);\r\n\t}\r\n\r\n\tloadPublishedProject(projectId: string, canvasWidth: number): ng.IPromise<IJsonRuntimeMashup> {\r\n\t\tconst lastLanguageCharIndex = 2;\r\n\t\tconst locale = this.languageService.getLanguage().substring(0, lastLanguageCharIndex);\r\n\t\treturn this.httpService.executeGet<IJsonRuntimeMashup>(\r\n\t\t\tServerPaths.RUNTIME + projectId,\r\n\t\t\t{\r\n\t\t\t\tlocale: locale\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tloadPublishedProjectNoConstraints(\r\n\t\tprojectId: string,\r\n\t\tcanvasWidth: number\r\n\t): ng.IPromise<IJsonRuntimeMashup> {\r\n\t\treturn this.httpService.executeGet<IJsonRuntimeMashup>(\r\n\t\t\tServerPaths.ADMINISTRATION + ServerPaths.PROJECT + projectId);\r\n\t}\r\n\r\n\tsetUrlMetaData(newUrlMetaData: IAvailableSourceField[]): void {\r\n\t\tthis.urlMetaData = newUrlMetaData;\r\n\t}\r\n\r\n\tgetUrlMetaData(): IAvailableSourceField[] {\r\n\t\treturn this.urlMetaData;\r\n\t}\r\n\r\n\tprivate cleanOldDataservices(project: Mashup): void {\r\n\t\tfor (const datasourceId in project.datasources) {\r\n\t\t\tconst datasourceInstance = this.datasourceService.parseDatasourceToTS(project.datasources[datasourceId]);\r\n\t\t\tif (!datasourceInstance) {\r\n\t\t\t\tproject.removeDatasource(datasourceId);\r\n\t\t\t\tconsole.info(\"Removed invalid data service from project\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tloadEnvironmentSettings(): ng.IPromise<IEnvironmentSettings> {\r\n\t\tconst path = DEV_SERVER ?\r\n\t\t\tServerPaths.SETTINGS + \"config/\" :\r\n\t\t\tServerPaths.SETTINGS;\r\n\r\n\t\treturn this.httpService.executeGet(path);\r\n\t}\r\n\r\n\tloadDBVersions(): ng.IPromise<string> {\r\n\t\treturn this.httpService.executeGet<string>(ServerPaths.SETTINGS + \"dbversions\");\r\n\t}\r\n\r\n\tloadLicensesHtml(): ng.IPromise<string> {\r\n\t\treturn this.httpService.executeGet<string>(ServerPaths.RUNTIME + \"about/licenses\");\r\n\t}\r\n\r\n\tloadApplicationVersion(): ng.IPromise<string> {\r\n\t\treturn this.httpService.executeGet<string>(ServerPaths.SETTINGS + \"version\");\r\n\t}\r\n\r\n\tunloadProject(): void {\r\n\t\tthis.currentProject = null;\r\n\t\tthis.currentRootComponentInstance = null;\r\n\t}\r\n\r\n\tgetCurrentProject(): Mashup {\r\n\t\treturn this.currentProject;\r\n\t}\r\n\r\n\tsetCurrentProject(newCurrentProject: Mashup, updateTheme: boolean = true): void {\r\n\t\tthis.currentProject = newCurrentProject;\r\n\t\tif (updateTheme) {\r\n\t\t\tconst defaultTheme = this.currentProject.manifest.defaultTheme;\r\n\t\t\tthis.setCanvasTheme(defaultTheme, this.isDesigner());\r\n\t\t}\r\n\t}\r\n\r\n\tbuildPrerequisites(mashup: Mashup, canvasWidth: number): ng.IPromise<Mashup> {\r\n\t\treturn this.generateUrlMetaData(mashup).then((mashup) => {\r\n\t\t\tthis.setCurrentProject(mashup);\r\n\t\t\tthis.updateCurrentBoundary(canvasWidth);\r\n\t\t\tthis.cleanOldDataservices(mashup);\r\n\t\t\treturn mashup;\r\n\t\t});\r\n\t}\r\n\r\n\tgenerateUrlMetaData(mashup: Mashup): ng.IPromise<Mashup> {\r\n\t\tconst deferred: ng.IDeferred<Mashup> = this.$q.defer();\r\n\t\tthis.urlMetaData = [];\r\n\t\tconst urlAlias = mashup.getUrlVariables();\r\n\t\tif (urlAlias && urlAlias.length > 0) {\r\n\t\t\turlAlias.forEach( (urlVar: IJsonUrlVariable) => {\r\n\t\t\t\tWSForm.getVarValue(urlVar.name, (value: string) => {\r\n\t\t\t\t\tconst sourceField: IAvailableSourceField = {\r\n\t\t\t\t\t\tvisibleName: urlVar.name,\r\n\t\t\t\t\t\tsourceKey: urlVar.name,\r\n\t\t\t\t\t\tsourceKeyShort: urlVar.name,\r\n\t\t\t\t\t\tcurrentValue: value,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.urlMetaData.push(sourceField);\r\n\r\n\t\t\t\t\tif (this.urlMetaData.length === urlAlias.length) {\r\n\t\t\t\t\t\tdeferred.resolve(mashup);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tdeferred.resolve(mashup);\r\n\t\t}\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tgetCurrentBoundary(): IBoundary {\r\n\t\treturn this.currentBoundary;\r\n\t}\r\n\r\n\tsetCurrentBoundary(boundary: IBoundary): void {\r\n\t\tthis.currentBoundary = boundary;\r\n\t\tthis.currentBoundaryChangedEvent.raise(boundary);\r\n\t}\r\n\r\n\tsetCurrentRootComponentInstance(componentInstance: ILayoutComponent): void {\r\n\t\tthis.currentRootComponentInstance = componentInstance;\r\n\t\tcomponentInstance.forEachChild((child) => {\r\n\t\t\tchild.initializeBindings();\r\n\t\t}, true);\r\n\t}\r\n\r\n\tgetCurrentRootComponentInstance(): ILayoutComponent {\r\n\t\treturn this.currentRootComponentInstance;\r\n\t}\r\n\r\n\tgetCurrentTheme(): ThemeEnum {\r\n\t\treturn this.currentCanvasTheme;\r\n\t}\r\n\r\n\tsetCanvasTheme(newTheme: ThemeEnum, isDesigner: boolean): void {\r\n\t\tif (this.currentCanvasTheme !== newTheme) {\r\n\t\t\tthis.currentCanvasTheme = newTheme;\r\n\t\t\tthis.themeService.changeThemeCss(newTheme, isDesigner).finally(() => {\r\n\t\t\t\tthis.currentCanvasThemeChangedEvent.raise(newTheme);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tupdateCurrentBoundary(canvasWidth: number): void {\r\n\t\tconst newBoundary: IBoundary = this.getBoundaryForWidth(canvasWidth);\r\n\t\tif (this.getCurrentBoundary() !== newBoundary) {\r\n\t\t\tthis.setCurrentBoundary(newBoundary);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getBoundaryForWidth(width: number): IBoundary {\r\n\t\tconst projectBoundaries = this.currentProject.manifest.mashupBoundaries;\r\n\r\n\t\tif (projectBoundaries && !isNil(width)) {\r\n\t\t\t// Sort the array, could be method?\r\n\t\t\tprojectBoundaries.sort((a, b) => {\r\n\t\t\t\tif (a.limitX < b.limitX) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else if (b.limitX < a.limitX) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn 0;\r\n\t\t\t});\r\n\r\n\t\t\tfor (const index in projectBoundaries) {\r\n\t\t\t\tconst boundary = projectBoundaries[index];\r\n\t\t\t\tif (boundary.limitX && width <= boundary.limitX) {\r\n\t\t\t\t\treturn boundary;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn DEFAULT_BOUNDARY;\r\n\t}\r\n\r\n\tisDesigner(): boolean {\r\n\t\treturn location.hash.indexOf(\"#!/editor\") === 0;\r\n\t\t//return window.location.pathname.indexOf(\"/appbuilder/editor\") === 0;\r\n\t}\r\n\r\n\texportProjectContent(\r\n\t\tcontentIds: string[],\r\n\t\tfilePath: string,\r\n\t\tsaveFlagEnum: SaveFlagsEnum,\r\n\t\tprojectId: string = undefined,\r\n\t): void {\r\n\t\tconst resourcePathForContentToSave =\r\n\t\t\tthis.getProjectContentResourcePath(projectId, saveFlagEnum);\r\n\r\n\t\tconst resourceName = resourcePathForContentToSave\r\n\t\t\t.concat(Helper.createQueryParameters(contentIds, \"id\"));\r\n\t\tthis.httpService\r\n\t\t\t.executeGet<IJsonGenericDatasource2[]>(resourceName, filePath)\r\n\t\t\t.then(response => {\r\n\t\t\t\tif (Config.MG_PLATFORM === MGPlatform.WEB) {\r\n\t\t\t\t\tconst rawJson = JSON.stringify(response);\r\n\t\t\t\t\tconst smartBlob = new SmartBlob(\r\n\t\t\t\t\t\t[rawJson], { type: \"application/json\" });\r\n\t\t\t\t\tsmartBlob.saveAs(filePath);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * convertImageUrlToBase64\r\n\t */\r\n\tconvertImageUrlToBase64(url: string): ng.IPromise<string> {\r\n\t\treturn this.httpService\r\n\t\t\t.executeGet<{base64: string, contentType: string}>(`${ServerPaths.DESIGNER}base64/?urlname=${url}`)\r\n\t\t\t.then(result => {\r\n\t\t\t\tconst filteredBase64 = result.base64.replace(/url\\(['\"]{0,}|['\"]{0,}\\)$/ig, \"\");\r\n\t\t\t\treturn `data:${result.contentType};base64,${filteredBase64}`;\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate getProjectContentResourcePath(\r\n\t\tprojectId: string,\r\n\t\tsaveFlagEnum: SaveFlagsEnum\r\n\t): string {\r\n\t\tswitch (saveFlagEnum) {\r\n\t\t\tcase SaveFlagsEnum.DATASOURCES:\r\n\t\t\t\treturn projectId ?\r\n\t\t\t\t\t`${ServerPaths.PROJECT}${projectId}/datasources/export/?` :\r\n\t\t\t\t\t`${ServerPaths.REPOSITORY}datasources/export/?`;\r\n\t\t\tcase SaveFlagsEnum.COMPOSITE_COMPONENTS:\r\n\t\t\t\treturn projectId ?\r\n\t\t\t\t\t`${ServerPaths.PROJECT}${projectId}/compositeComponents/export/?` :\r\n\t\t\t\t\t`${ServerPaths.REPOSITORY}compositeComponents/export/?`;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(`SaveFlagsEnum '${saveFlagEnum}' not handled`);\r\n\t\t}\r\n\t}\r\n\r\n\tgetLanguage(): string {\r\n\t\treturn this.languageService.getLanguage();\r\n\t}\r\n\r\n\topenHelp(): void {\r\n\t\twindow.open(`${Config.MG_HELP_BASE_URL}/default.html?helpcontent=mgabahug/cover.html#`, \"_blank\");\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.COMMON_SERVICE, CommonService);\r\n\t}\r\n}\r\n","import { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport { IComponentScope } from \"./interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"./interface/ilayout-component\";\r\nimport { ISizeObject } from \"./ISizeObject\";\r\nimport { ISourceItem } from \"./model/component/hyperlink.model\";\r\n\r\nexport interface IComponent {\r\n\tcssClasses: string;\r\n\tisVisible: boolean;\r\n\tisReadonly: boolean;\r\n\telement: ng.IAugmentedJQuery;\r\n\tparent: ILayoutComponent;\r\n\tisGenerated: boolean;\r\n\t//copy-paste stuff\r\n\tcanCopy: boolean;\r\n\tcanCut: boolean;\r\n\tcanDelete(): boolean;\r\n\tgeneratedId: string;\r\n\terrorTooltip: string;\r\n\tdatasource: IDatasource;\r\n\t// \"is\" component methods/vars\r\n\tisLoading: boolean;\r\n\tisLayoutComponent(): boolean;\r\n\tisTranslatableComponent(): boolean;\r\n\t// Getters for databearer\r\n\tgetDatabearer(): IJsonComponent;\r\n\tgetDatasource(): IDatasource;\r\n\tgetDisplayName(): string;\r\n\tgetId(): string;\r\n\tgetTypedef(): string;\r\n\tis(classs: any): boolean;\r\n\t// Void methods\r\n\tcalcNewHeight(): void;\r\n\tcalcNewWidth(): void;\r\n\tcalcNewSizes(): void;\r\n\tforEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void;\r\n\tforEachBindable(fn: (field: IJsonBindableField, curr: IJsonValueSource) => void): void;\r\n\tforEachFieldSetting(fn: (field: IComponentFieldSetting) => void): void;\r\n\tforEachParent(fn: (parent: ILayoutComponent) => void): void;\r\n\tinitializeBindings(): void;\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]>;\r\n\tclear(): void;\r\n\tnewBoundaryEntered(boundaryId: string): void;\r\n\tupdateClasses(): void;\r\n\tupdateClassesAndStyle(): void;\r\n\tupdateShowError(): void;\r\n\tupdateVisibility(): void;\r\n\tresetLayout(): void;\r\n\tresetContext(): void;\r\n\t// Getters\r\n\tgetBindableValue(bindableReference: string): any;\r\n\tgetBoundarySetting<T>(settingId: string, boundaryId?: string, noTraverse?: boolean): T;\r\n\tgetContext(): IContext;\r\n\tgetGeneratingParent(): ILayoutComponent;\r\n\tgetPredictedSize(): ISizeObject;\r\n\tgetScope(): IComponentScope;\r\n\tgetSohoXiApi?(): any;\r\n\tgetValue(key: string): any;\r\n\t// Setters\r\n\tsetBindableValue(bindableReference: string, value: any): void;\r\n\tsetGenerated(id: string): void;\r\n\tsetErrorTooltip(errorMessage?: string): void;\r\n\t// on value updated\r\n\tonUpdateValue(): void;\r\n\t// build link\r\n\tbuildLink(link: string, sources: ISourceItem[]): string;\r\n}\r\n","import { AngularConstants } from \"../angular-constants\";\r\n\r\nimport { Config, InjectNames, LanguageConsts, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IIonApiRequestOptions } from \"ng2/common/model/ion-api/ion-api.model\";\r\nimport { IMingleLanguage, IMongooseString } from \"ng2/common/model/language.model\";\r\n\r\nimport { IonApiService } from \"../../components/services/ion-api-service\";\r\nimport { Helper } from \"../helper\";\r\nimport { FeatureSwitchCtrl } from \"../shared-components/base/feature-switch-ctrl\";\r\nimport { FeatureSwitchService } from \"./feature-switch-service\";\r\nimport { HashService } from \"./hash-service\";\r\nimport { HttpService } from \"./http-service\";\r\n\r\nexport type UrlSearchParams = any;\r\n\r\ninterface ILocalStorageValue {\r\n\tlocale: string;\r\n\tusername: string;\r\n}\r\n\r\nexport class LanguageService extends FeatureSwitchCtrl {\r\n\tprivate language: string;\r\n\tprivate currentStrings: IMap<IMongooseString> = {};\r\n\tprivate supportedLanguages: IMingleLanguage[] = LanguageConsts.SUPPORTED_LANGUAGES; //This will be overwritten\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.WINDOW,\r\n\t\tInjectNames.ION_API_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.HASH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $window: ng.IWindowService,\r\n\t\tprivate ionApiService: IonApiService,\r\n\t\tfeatureSwitchService: FeatureSwitchService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate hashService: HashService,\r\n\t) {\r\n\t\tsuper(featureSwitchService);\r\n\t\t//What to do with this? Keep, discard?\r\n\t\t//this.fetchSupportedMingleLanguages();\r\n\t}\r\n\r\n\tinitializeLanguageSettings(): ng.IPromise<void> {\r\n\t\treturn this.loadSupportedLanguages().then(() => {\r\n\t\t\tthis.detectLanguage();\r\n\t\t\tthis.loadSohoLocale(this.language);\r\n\t\t}).finally(() => {\r\n\t\t\treturn this.loadGlobalStrings();\r\n\t\t});\r\n\t}\r\n\r\n\tloadGlobalStrings(language?: string): ng.IPromise<void> {\r\n\t\tconst locale = language ? language : \"\";\r\n\t\treturn this.httpService.executeGet(ServerPaths.SETTINGS + \"language/\" + locale)\r\n\t\t\t.then((strings: IMap<IMongooseString>) => {\r\n\t\t\t\tthis.currentStrings = strings;\r\n\t\t\t});\r\n\t}\r\n\r\n\tgetGlobalString(name: string): string | null {\r\n\t\tlet stringValue = null;\r\n\t\tif (this.currentStrings.hasOwnProperty(name)) {\r\n\t\t\tstringValue = this.currentStrings[name].Value;\r\n\t\t}\r\n\r\n\t\treturn stringValue;\r\n\t}\r\n\r\n\taddGlobalString(stringItem: IMongooseString): ng.IPromise<void> {\r\n\t\t//Save with current language\r\n\t\tconst savedValue: IMap<IMongooseString[]> = {};\r\n\t\tsavedValue[this.getLanguage()] = [stringItem];\r\n\t\treturn this.saveGlobalStrings(savedValue);\r\n\t}\r\n\r\n\tgetCurrentStrings(): IMap<IMongooseString> {\r\n\t\treturn this.currentStrings;\r\n\t}\r\n\r\n\tfetchGlobalStrings(locale: string): ng.IPromise<IMap<IMongooseString>> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.SETTINGS + \"language/\" + locale);\r\n\t}\r\n\r\n\tsaveGlobalStrings(modifiedStrings: IMap<IMongooseString[]>): ng.IPromise<void> {\r\n\t\tfor (const languageKey in modifiedStrings) {\r\n\t\t\tmodifiedStrings[languageKey].forEach((globalString) => {\r\n\t\t\t\tthis.currentStrings[globalString.Name] = globalString;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.httpService.executePut(ServerPaths.SETTINGS + \"translation/\", modifiedStrings);\r\n\t}\r\n\r\n\tdeleteGlobalStrings(deletedStrings: IMap<IMongooseString[]>): ng.IPromise<void> {\r\n\t\tfor (const languageKey in deletedStrings) {\r\n\t\t\tdeletedStrings[languageKey].forEach((globalString) => {\r\n\t\t\t\tdelete this.currentStrings[globalString.Name];\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.httpService.executeDelete(ServerPaths.SETTINGS + \"translation/\", deletedStrings);\r\n\t}\r\n\r\n\tchangeCurrentLanguage(locale: string): ng.IPromise<void> {\r\n\t\treturn this.httpService.executePut(ServerPaths.SETTINGS + \"language\", locale).then(() => {\r\n\t\t\tthis.language = locale;\r\n\t\t\tconst localStorageValue: ILocalStorageValue = {\r\n\t\t\t\tlocale: locale,\r\n\t\t\t\tusername: Config.USER.name\r\n\t\t\t};\r\n\t\t\tlocalStorage.setItem(\"language\", JSON.stringify(localStorageValue) );\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Detects the current language.and sets it to the singleton value\r\n\t * Run this function if the singleton language value should change\r\n\t *\r\n\t * @memberof LanguageService\r\n\t */\r\n\tdetectLanguage(): void {\r\n\t\tconst urlSearchParams = this.$window.parent.location.search;\r\n\t\tthis.language = this.getLanguageThroughSearchParams(urlSearchParams);\r\n\t}\r\n\r\n\tgetSupportedLanguages(): IMingleLanguage[] {\r\n\t\treturn this.supportedLanguages;\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the current language through the singleton value.\r\n\t *\tUse this function to get the language stored in this singleton\r\n\t\t*\tHas multiple fallbacks:\r\n\t\t*\r\n\t\t* 1. \"$language\" in url search params\r\n\t\t* 2. \"inforCurrentLanguage\" in url search params\r\n\t\t* 3. Browsers own language through window.navigator.language\r\n\t\t* 4. Default language which is en-US\r\n\t\t*\r\n\t\t* @returns {string}\r\n\t\t* @memberof LanguageService\r\n\t\t*/\r\n\tgetLanguage(): string {\r\n\t\tif (this.isFeatureTranslationEnabled()) {\r\n\t\t\tif (this.language) {\r\n\t\t\t\treturn this.language;\r\n\t\t\t}\r\n\t\t\tthis.detectLanguage();\r\n\t\t}\r\n\t\treturn this.language;\r\n\t}\r\n\r\n\t/**\r\n\t * Get language with any url search params.\r\n\t * Use this function if you want to get a new language without overriding the singleton value\r\n\t * Has multiple fallbacks:\r\n\t *\r\n\t * 1. \"$language\" in url search params\r\n\t * 2. \"inforCurrentLanguage\" in url search params\r\n\t * 3. Browsers own language through window.navigator.language\r\n\t * 4. Default language which is en-US\r\n\t *\r\n\t * @param {UrlSearchParams} urlSearchParams\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tgetLanguageThroughSearchParams(urlSearchParams: UrlSearchParams): string {\r\n\t\tlet language: string;\r\n\r\n\t\tlanguage = this.getUrlLanguage(urlSearchParams);\r\n\r\n\t\tif (this.isValid(language) === false) {\r\n\t\t\tlanguage = this.getMingleLanguage(urlSearchParams);\r\n\t\t}\r\n\r\n\t\tif (this.isValid(language) === false) {\r\n\t\t\tlanguage = this.getLocalStorageLanguage();\r\n\t\t}\r\n\r\n\t\tif (this.isValid(language) === false) {\r\n\t\t\tlanguage = Config.LOCALE; //Mongoose user-preference language\r\n\t\t}\r\n\r\n\t\tif (this.isValid(language) === false) {\r\n\t\t\tlanguage = this.getBrowserLanguage();\r\n\t\t}\r\n\r\n\t\tif (this.isValid(language) === false || this.isSupported(language) === false) {\r\n\t\t\tlanguage = this.getDefaultLanguage();\r\n\t\t}\r\n\r\n\t\treturn language;\r\n\t}\r\n\r\n\t/**\r\n\t * Loads Soho Locale without setting it\r\n\t */\r\n\tloadSohoLocale(locale: string): JQueryDeferred<any> {\r\n\t\tlet currentLanguage = this.supportedLanguages.find(language => {\r\n\t\t\treturn language.key === locale;\r\n\t\t});\r\n\r\n\t\tif (Helper.isUndefinedOrNull(currentLanguage)) {\r\n\t\t\tcurrentLanguage = this.supportedLanguages[0];\r\n\t\t}\r\n\r\n\t\treturn Soho.Locale.getLocale(currentLanguage.key, currentLanguage.filename);\r\n\t}\r\n\r\n\tprivate getLocalStorageLanguage(): string | null {\r\n\t\tlet locale: string = null;\r\n\t\tconst localStorageValue = JSON.parse(localStorage.getItem(\"language\")) as ILocalStorageValue;\r\n\t\tif (localStorageValue && Config.USER.name === localStorageValue.username) {\r\n\t\t\tlocale = localStorageValue.locale;\r\n\t\t}\r\n\r\n\t\treturn locale;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the language based on any $language in the url search params\r\n\t *\r\n\t * @private\r\n\t * @param {string} urlSearchParams\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate getUrlLanguage(urlSearchParams: string): string {\r\n\t\tconst params = Helper.parseQueryString(urlSearchParams);\r\n\t\treturn params.$language;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the language based on any url search params containing \"inforCurrentLanguage\"\r\n\t *\r\n\t * @private\r\n\t * @param {string} urlSearchParams\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate getMingleLanguage(urlSearchParams: string): string {\r\n\t\tconst params = Helper.parseQueryString(urlSearchParams);\r\n\t\treturn params.inforCurrentLanguage;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the language based on the window.navigator.language\r\n\t *\r\n\t * @private\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate getBrowserLanguage(): string {\r\n\t\tconst language = this.$window.navigator && this.$window.navigator.language;\r\n\t\treturn language;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a default languagee\r\n\t *\r\n\t * @public\r\n\t * @param {UrlSearchParams} urlSearchParams\r\n\t * @returns {string}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tgetDefaultLanguage(): string {\r\n\t\treturn LanguageConsts.DEFAULT.key;\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the language is a valid languagee\r\n\t *\r\n\t * @private\r\n\t * @param {string} languagee\r\n\t * @returns {boolean}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate isValid(language: string): boolean {\r\n\t\tif (language && /^[a-z0-9-_]+$/i.test(language)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the language is supported\r\n\t *\r\n\t * @private\r\n\t * @param {string} language\r\n\t * @returns {boolean}\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate isSupported(language: string): boolean {\r\n\t\tconst supported = this.supportedLanguages.some((supportedLanguage) => {\r\n\t\t\treturn this.isEqual(supportedLanguage.key, language);\r\n\t\t});\r\n\t\t/*if (supported) {\r\n\t\t\tif (LanguageConsts.UNSUPPORTED_LANGUAGES.indexOf(language) === -1) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}*/\r\n\t\treturn supported;\r\n\t}\r\n\r\n\t/**\r\n\t * Compare two locales.\r\n\t * if browser gives two letters compare only the two first\r\n\t *\r\n\t * @private\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate isEqual(supportedLanguageKey: string, languageKey: string): boolean {\r\n\t\tconst lengthOfString = 2;\r\n\t\tif (languageKey.length === lengthOfString) {\r\n\t\t\tsupportedLanguageKey = supportedLanguageKey.substring(0, lengthOfString);\r\n\t\t}\r\n\t\treturn supportedLanguageKey === languageKey;\r\n\t}\r\n\r\n\t/**\r\n\t * fetch all supported languages from mongoose, used once.\r\n\t *\r\n\t * @public\r\n\t * @memberof LanguageService\r\n\t */\r\n\tloadSupportedLanguages(): ng.IPromise<any> {\r\n\t\treturn this.httpService\r\n\t\t\t.executeGet<IMingleLanguage[]>(ServerPaths.SETTINGS + \"supportedLanguages/\")\r\n\t\t\t.then(languages => {\r\n\t\t\t\tthis.supportedLanguages = languages;\r\n\t\t\t\tconst hashedFilenames = this.hashService.getHashMap();\r\n\r\n\t\t\t\tthis.supportedLanguages.forEach(language => {\r\n\t\t\t\t\tthis.mapFilenameToSupportedLanguages(language, hashedFilenames);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate mapFilenameToSupportedLanguages(\r\n\t\tlanguage: IMingleLanguage,\r\n\t\tcacheBustedFilenames: IMap<string>\r\n\t): void {\r\n\t\tfor (const item in cacheBustedFilenames) {\r\n\t\t\tif (cacheBustedFilenames[item].indexOf(language.key) !== -1) {\r\n\t\t\t\tconst re = new RegExp(`${language.key}.[0-9a-z]*`);\r\n\t\t\t\tconst isMatch = cacheBustedFilenames[item].match(re);\r\n\t\t\t\tif (isMatch) {\r\n\t\t\t\t\tlanguage.filename = isMatch[0];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * fetch all supported languages from ming.le, used once.\r\n\t * NOT USED, DEPRECATED\r\n\t * @private\r\n\t * @memberof LanguageService\r\n\t */\r\n\tprivate fetchSupportedMingleLanguages(): ng.IPromise<any> {\r\n\t\tconst options: IIonApiRequestOptions = {\r\n\t\t\turl: \"/Mingle/Admin/System/Language\",\r\n\t\t\tmethod: HttpVerbEnum.GET,\r\n\t\t\theaders: {},\r\n\t\t};\r\n\t\treturn this.ionApiService.executeIonApiAsync(options).then((response) => {\r\n\t\t\tthis.supportedLanguages = (response.data as any).LanguageList;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * get all supported languages,\r\n\t * if IonApi is down for some reason it fall backs to static list\r\n\t *\r\n\t * @public\r\n\t * @returns {IMingleLanguage[]}\r\n\t * @memberof LanguageService\r\n\t */\r\n\t/*getSupportedMingleLanguages(): IMingleLanguage[] {\r\n\t\t// Filter to remove the unsupported languages;\r\n\t\tconst supportedLanguages = angular.copy(this.supportedLanguages);\r\n\t\tLanguageConsts.UNSUPPORTED_LANGUAGES.forEach((unsupportedLanguage) => {\r\n\t\t\tfor (let i = 0; i < supportedLanguages.length; i++) {\r\n\t\t\t\tif (unsupportedLanguage === supportedLanguages[i].key) {\r\n\t\t\t\t\tsupportedLanguages.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn supportedLanguages;\r\n\t}*/\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.LANGUAGE_SERVICE, LanguageService);\r\n\t}\r\n}\r\n","/*\r\n\tTurns UserControl.js globals into importable ES modules\r\n*/\r\n\r\n//tslint:disable:no-var-requires\r\nrequire(\"./UserControl\");\r\n\r\n// Don't delete MG from window as it is used somewhere else internally in Mongoose.\r\nexport const MG = window.MG;\r\n\r\nexport const WSForm = window.WSForm;\r\ndelete window.WSForm;\r\n\r\nexport const WSUserControl = window.WSUserControl;\r\ndelete window.WSUserControl;\r\n","export enum DatasourceTypeEnum {\r\n\tIDM = \"IDM\",\r\n\tIDO = \"IDO\",\r\n\tM3 = \"M3\",\r\n\tMINGLE = \"MINGLE\",\r\n\tMONGOOSE = \"MONGOOSE\",\r\n\tgeneric = \"generic\",\r\n\tINLINE_LIST = \"INLINE_LIST\",\r\n}\r\n","export enum HttpVerbEnum {\r\n\tGET = \"GET\",\r\n\tPOST = \"POST\",\r\n\tPUT = \"PUT\",\r\n\tDELETE = \"DELETE\",\r\n\tHEAD = \"HEAD\",\r\n\tPATCH = \"PATCH\"\r\n}\r\n","import { Config, MGPlatform } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nenum DebugState {\r\n\tENABLED = \"1\",\r\n\tDISABLED = \"0\",\r\n}\r\n\r\nexport class Debugger {\r\n\tstatic readonly STORAGE_KEY = \"debug\";\r\n\r\n\tstatic $inject = [\r\n\t\t\"$routeParams\"\r\n\t]\r\n\tconstructor(\r\n\t\tprivate $routeParams: ng.route.IRouteParamsService\r\n\t) {\r\n\t\tconsole.info(\"Hello World\");\r\n\t}\r\n\r\n\tstatic isEnabled(): boolean {\r\n\t\treturn localStorage.getItem(Debugger.STORAGE_KEY) === DebugState.ENABLED;\r\n\t}\r\n\r\n\tstatic enable(): void {\r\n\t\tlocalStorage.setItem(Debugger.STORAGE_KEY, DebugState.ENABLED);\r\n\t}\r\n\r\n\tstatic disable(): void {\r\n\t\tlocalStorage.setItem(Debugger.STORAGE_KEY, DebugState.DISABLED);\r\n\t}\r\n\r\n\tstatic initialize(): void {\r\n\t\tconst url = Config.MG_PLATFORM === MGPlatform.WEB || DEV_SERVER ?\r\n\t\t\twindow.parent.location.search.substring(1) :\r\n\t\t\twindow.location.search.substring(1);\r\n\r\n\t\tconst query = Helper.parseQueryString(url);\r\n\t\tif (query.debug) {\r\n\t\t\tif (query.debug === \"true\") {\r\n\t\t\t\tDebugger.enable();\r\n\t\t\t} else {\r\n\t\t\t\tDebugger.disable();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tDebugger.disable();\r\n\t\t}\r\n\r\n\t\tif (Debugger.isEnabled()) {\r\n\t\t\tconsole.warn(\"AppBuilder is running in debug mode. This may impact performance.\");\r\n\t\t}\r\n\r\n\t\t(window as Window).Debugger = Debugger;\r\n\t}\r\n\r\n\tstatic log(classObject: any, message: any): void {\r\n\t\tconst originStyle = \"color: darkred; font-weight: bold;\";\r\n\t\tconst messageStyle = \"color: black; font-weight: bold;\";\r\n\r\n\t\tif (Debugger.isEnabled() && Config.IS_DEV) {\r\n\t\t\t/* tslint:disable:no-console */\r\n\t\t\tconsole.log(`%c[${classObject.constructor.name}] %c${message}`, originStyle, messageStyle);\r\n\t\t\t/* tslint:enable:no-console */\r\n\t\t}\r\n\t}\r\n}\r\n","import { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport { IComponent } from \"../../IComponent\";\r\n\r\nexport interface IDatasource extends IJsonDatasource {\r\n\tusedBy: IComponent[];\r\n\tgetDatabearer(): IJsonDatasource;\r\n\tgetDetailData(params: IMap<any>): Promise<any>;\r\n\tgetListData(params: IMap<any>): Promise<any[]>;\r\n\tgetMetaData(): Promise<IMetaData>;\r\n\tgetNonParsedData(params: IMap<any>): Promise<any[]>;\r\n}\r\n","export enum OrientationEnum {\r\n\tHORIZONTAL = 1,\r\n\tVERTICAL = 2,\r\n\tPAGE = 3\r\n}\r\n","import { FeatureIdEnum, InjectNames, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { AngularConstants } from \"../angular-constants\";\r\nimport { HttpService } from \"./http-service\";\r\n\r\nexport interface IFeature {\r\n\treadonly id: FeatureIdEnum;\r\n\treadonly description: string;\r\n\treadonly defaultFromDate: number;\r\n\treadonly isInternal: boolean;\r\n\treadonly togglable: boolean;\r\n\treadonly status?: IFeatureStatus;\r\n}\r\n\r\nexport interface IFeatureStatus {\r\n\treadonly id: FeatureIdEnum;\r\n\treadonly enabled: boolean;\r\n\treadonly lastChangedBy: string;\r\n\treadonly lastChangedByDisplayName: string;\r\n\treadonly lastChangedDate: number;\r\n}\r\n\r\n/**\r\n * This service is used to read/update information about feature switches.\r\n * It will synchronize with the backend upon injection, and whenever something is expected\r\n * to change (e.g enabling/disabling a feature).\r\n *\r\n * Use this service to check whether a feature is enabled or not.\r\n *\r\n * Administrators can use it to enable/disable features.\r\n */\r\nexport class FeatureSwitchService {\r\n\tprivate readonly features: IFeature[] = [];\r\n\tstatic $inject = [\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tAngularConstants.Q\r\n\t];\r\n\r\n\tconstructor(private httpService: HttpService, private $q: ng.IQService) {\r\n\t\tthis.fetchFeatures()\r\n\t\t\t.catch(error => {\r\n\t\t\t\t// Could happen, but how should it be displayed?\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate fetchFeatures(): ng.IPromise<void> {\r\n\t\tconst path = ServerPaths.SETTINGS + ServerPaths.SWITCHABLE_FEATURES;\r\n\t\treturn this.httpService.executeGet<IFeature[]>(path)\r\n\t\t\t.then(fetchedFeatures => {\r\n\t\t\t\tthis.features.splice(0, this.features.length);\r\n\t\t\t\tfetchedFeatures.forEach(feature => {\r\n\t\t\t\t\tthis.features.push(feature);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic getFeatures(): IFeature[] {\r\n\t\treturn this.features;\r\n\t}\r\n\r\n\t/**\r\n\t * Get the feature with a given id.\r\n\t *\r\n\t * Returns undefined if feature does not exist, i.e it wasn't one of the features retrieved from the backend.\r\n\t */\r\n\tpublic getFeature(id: FeatureIdEnum): (IFeature | undefined) {\r\n\t\tconst feature = this.features.find(feature => feature.id === id);\r\n\t\treturn feature;\r\n\t}\r\n\r\n\tpublic isFeatureEnabled(id: FeatureIdEnum): boolean {\r\n\t\tconst feature = this.getFeature(id);\r\n\t\treturn feature && feature.status && feature.status.enabled;\r\n\t}\r\n\r\n\tpublic toggleFeatureStatus(id: FeatureIdEnum): ng.IPromise<void> {\r\n\t\tconst feature = this.getFeature(id);\r\n\t\tif (!feature) {\r\n\t\t\treturn this.$q.reject(`Feature with id '${id}' does not exist`);\r\n\t\t}\r\n\t\tconst enable = !this.isFeatureEnabled(id);\r\n\t\tconst path = ServerPaths.SETTINGS + ServerPaths.SWITCHABLE_FEATURES + id + \"/status\";\r\n\t\treturn this.httpService.executePost(path, undefined, { enable }).then(() => {\r\n\t\t\treturn this.fetchFeatures();\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.FEATURE_SWITCH_SERVICE, FeatureSwitchService);\r\n\t}\r\n}\r\n","/**\r\n* Defines an instance event.\r\n*\r\n* An instance event can be used for lightweight events when you can have\r\n* an object reference to the source of the event. In cases when you can't\r\n* use object references refer to IEvent and IEventService instead.\r\n*/\r\nexport interface IInstanceEvent<T> {\r\n\t/**\r\n\t* Registers an event handler function.\r\n\t* @param handler The event handler function to register.\r\n\t* @returns A function that can be used to unsubscribe to the event.\r\n\t* Calling this function will have the same effect as calling the off function.\r\n\t*/\r\n\ton(handler: { (data?: T): void }): Function;\r\n\r\n\t/**\r\n\t* Unregisters an existing event handler function.\r\n\t* @param handler The event handler function to unregister.\r\n\t*/\r\n\toff(handler: { (data?: T): void }): void;\r\n}\r\n\r\n/**\r\n* Instance event implementation.\r\n*\r\n* Use this class to defined your own instance event.\r\n* If you just want to consume instance events refer to IInstanceEvent.\r\n*/\r\nexport class InstanceEvent<T> implements IInstanceEvent<T> {\r\n\r\n\tprivate handlers: { (data?: T): void; }[] = [];\r\n\r\n\t/**\r\n\t* Registers an event handler function.\r\n\t* @param handler The event handler function to register.\r\n\t*/\r\n\tpublic on(handler: { (data?: T): void }): Function {\r\n\t\tthis.handlers.push(handler);\r\n\t\treturn () => {\r\n\t\t\tthis.off(handler);\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t* Unregisters an existing event handler function.\r\n\t* @param handler The event handler function to unregister.\r\n\t*/\r\n\tpublic off(handler: { (data?: T): void }): void {\r\n\t\tthis.handlers = this.handlers.filter(h => h !== handler);\r\n\t}\r\n\r\n\t/**\r\n\t* Raises an event.\r\n\t* @param data The event data.\r\n\t*/\r\n\tpublic raise(data?: T): void {\r\n\t\tif (this.handlers) {\r\n\t\t\ttry {\r\n\t\t\t\tthis.handlers.slice(0).forEach(h => h(data));\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(\"[InstanceEvent] Exception in raise\", e);\r\n\t\t\t\tthrow e;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Clears all event handlers for this event.\r\n\t*/\r\n\tpublic clear(): void {\r\n\t\tthis.handlers = [];\r\n\t}\r\n}\r\n","import angular, { IPromise } from \"angular\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\n\r\nimport { InjectNames, Numbers } from \"ng2/common/constants/common.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\n\r\nimport { HttpService } from \"../../common/services/http-service\";\r\nimport { IonApiService } from \"../../components/services/ion-api-service\";\r\nimport { LocalIdoService } from \"../../components/services/local-ido-service\";\r\n\r\nimport { HttpAcceptEnum } from \"ng2/common/enums/http-accept-enum\";\r\nimport {\r\n\tIHttpHeader, IJsonDatasource, IJsonGenericDatasource2,\r\n\tIJsonInlineListDatasource, IJsonLocalIdoDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IIonApiRequestOptions } from \"ng2/common/model/ion-api/ion-api.model\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { ErrorResponse } from \"../../common/error-response\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { Generic2 } from \"../../common/project/datasource/generic2\";\r\nimport { InlineList } from \"../../common/project/datasource/inline-list\";\r\nimport { LocalIdo } from \"../../common/project/datasource/local-ido\";\r\nimport { Mongoose } from \"../../common/project/datasource/mongoose\";\r\n\r\nexport class DatasourceService {\r\n\tpublic cache: ng.ICacheObject;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.ION_API_SERVICE,\r\n\t\tInjectNames.LOCAL_IDO_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $cacheFactory: ng.ICacheFactoryService,\r\n\t\tpublic $q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate ionApiService: IonApiService,\r\n\t\tprivate localIdoService: LocalIdoService\r\n\t) {\r\n\t\tthis.cache = this.$cacheFactory(\"DatasourceService\");\r\n\t}\r\n\r\n\tpublic getDeferred<T>(): ng.IDeferred<T> {\r\n\t\treturn this.$q.defer<T>();\r\n\t}\r\n\r\n\tpublic localIdoRequest(\r\n\t\tdatasource: IJsonLocalIdoDatasource,\r\n\t\tinputParameterValues?: IMap<any>\r\n\t): ng.IPromise<any> {\r\n\r\n\t\tswitch (datasource.method) {\r\n\r\n\t\t\tcase HttpVerbEnum.PUT:\r\n\t\t\t\treturn this.localIdoService.updateIdoCollectionEntry(datasource, inputParameterValues);\r\n\t\t\tcase HttpVerbEnum.POST:\r\n\t\t\t\treturn this.localIdoService.insertIdoCollectionEntry(datasource, inputParameterValues);\r\n\t\t\tcase HttpVerbEnum.DELETE:\r\n\t\t\t\treturn this.localIdoService.deleteIdoCollectionEntry(datasource, inputParameterValues);\r\n\t\t\tcase HttpVerbEnum.GET:\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.localIdoService.getIdoCollection(datasource, inputParameterValues);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic ionApiRequest(\r\n\t\turlPath: string,\r\n\t\tisBinaryResponse: boolean = false,\r\n\t\tmethod: HttpVerbEnum = HttpVerbEnum.GET,\r\n\t\tdata: string = null,\r\n\t\theaders: IHttpHeader = {}\r\n\t): Promise<any> {\r\n\t\tconst def: ng.IDeferred<any> = this.$q.defer();\r\n\r\n\t\theaders = BackwardCompatible\r\n\t\t\t.setDataServiceHeader(headers);\r\n\r\n\t\tconst options: IIonApiRequestOptions = {\r\n\t\t\turl: urlPath,\r\n\t\t\tmethod,\r\n\t\t\theaders: angular.copy(headers),\r\n\t\t};\r\n\r\n\t\tif (isBinaryResponse) {\r\n\t\t\toptions.responseType = \"blob\";\r\n\t\t} else if (isUndefined(options.headers.Accept)) {\r\n\t\t\toptions.headers.Accept = HttpAcceptEnum.ALL;\r\n\t\t}\r\n\r\n\t\tif (method !== HttpVerbEnum.GET) {\r\n\t\t\toptions.data = data;\r\n\t\t}\r\n\t\tthis.ionApiService.executeIonApiAsync(options).then(response => {\r\n\t\t\tthis.ionApiResponse(def, response.data, isBinaryResponse);\r\n\t\t}).catch((response: ng.IHttpPromiseCallbackArg<any>) => {\r\n\t\t\tlet error: ErrorResponse;\r\n\r\n\t\t\tif (isBinaryResponse) {\r\n\t\t\t\t// Convert binary to text\r\n\t\t\t\tconst fr = new FileReader();\r\n\t\t\t\tfr.readAsText(response.data);\r\n\t\t\t\tfr.onloadend = () => {\r\n\t\t\t\t\tlet data = fr.result as string;\r\n\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tdata = JSON.parse(data);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tresponse.data = data;\r\n\t\t\t\t\terror = this.ionApiResponseError(response);\r\n\t\t\t\t\tdef.reject(error);\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\terror = this.ionApiResponseError(response);\r\n\t\t\t\tdef.reject(error);\r\n\t\t\t}\r\n\t\t}).catch(error => def.reject(error));\r\n\r\n\t\treturn def.promise as Promise<any>;\r\n\t}\r\n\r\n\tprivate ionApiResponseError(response: ng.IHttpPromiseCallbackArg<any>): ErrorResponse {\r\n\t\tlet errorMessage: string = \"\";\r\n\r\n\t\tif (response.data && response.data.error && response.data.error.message) {\r\n\t\t\t// High likely to be error message from ION API\r\n\t\t\tif (response.data.source) {\r\n\t\t\t\terrorMessage += \"Source: \" + response.data.source + \"; \";\r\n\t\t\t}\r\n\r\n\t\t\terrorMessage += response.data.error.message;\r\n\t\t} else if (Numbers.FOUR_HUNDRED <= response.status && response.status < Numbers.SIX_HUNDRED) {\r\n\t\t\terrorMessage = response.status + \" \" + response.statusText;\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[Datasource service] Unknown ionApiRequest error\", response);\r\n\t\t\terrorMessage += \"[Datasource service] Unknown ionApiRequest error\";\r\n\t\t}\r\n\r\n\t\tconst error: ErrorResponse = new ErrorResponse(errorMessage, response.status);\r\n\t\treturn error;\r\n\t}\r\n\r\n\tprivate ionApiResponse(def: ng.IDeferred<any>, data: any, isBinary: boolean = false): void {\r\n\t\tif (isBinary) {\r\n\t\t\t// Reading response as dataURL to prevent tainting of canvas for html2canvas-library\r\n\t\t\tconst fr = new FileReader();\r\n\t\t\tfr.readAsDataURL(data);\r\n\t\t\tfr.onloadend = () => {\r\n\t\t\t\tdef.resolve(fr.result);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tdef.resolve(data);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic parseDatasourceToTS(datasourceDatabearer: IJsonDatasource): IDatasource {\r\n\t\t// Only accept generic version 2\r\n\t\tconst version: number = 2;\r\n\t\tconst isCorrectVersion = datasourceDatabearer.version === version;\r\n\r\n\t\tif (isCorrectVersion) {\r\n\t\t\tconst generic2Databearer =\r\n\t\t\t\tdatasourceDatabearer as IJsonGenericDatasource2;\r\n\r\n\t\t\tswitch (datasourceDatabearer.typedef) {\r\n\t\t\t\tcase DatasourceTypeEnum.generic:\r\n\t\t\t\t\treturn new Generic2(generic2Databearer, this);\r\n\t\t\t\tcase DatasourceTypeEnum.MONGOOSE:\r\n\t\t\t\t\treturn new Mongoose(generic2Databearer, this);\r\n\t\t\t\tcase DatasourceTypeEnum.IDO:\r\n\t\t\t\t\treturn new LocalIdo(\r\n\t\t\t\t\t\tdatasourceDatabearer as IJsonGenericDatasource2, this);\r\n\t\t\t\tcase DatasourceTypeEnum.INLINE_LIST:\r\n\t\t\t\t\treturn new InlineList(\r\n\t\t\t\t\t\tdatasourceDatabearer as IJsonInlineListDatasource, this);\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow Error(`Dataservice of type '${datasourceDatabearer.typedef}' is not supported`);\r\n\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"[Helper] Invalid typedef on \", datasourceDatabearer);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.DATASOURCE_SERVICE, DatasourceService);\r\n\t}\r\n}\r\n","// TODO: This will be replaced when enterprise-ng datagrid is finished\r\n\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IPagerApi, IPagerInfo, IPagerSource } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nexport interface IDataItem {\r\n\r\n\t/**\r\n\t * Soho private property\r\n\t */\r\n\tisFiltered?: boolean;\r\n\r\n\t/**\r\n\t * Soho private property\r\n\t */\r\n\t_isFilteredOut?: boolean;\r\n\r\n\t/**\r\n\t * Soho private property\r\n\t */\r\n\t_selected?: boolean;\r\n}\r\n\r\n/**\r\n * Interface for the Data Grid Directive\r\n */\r\nexport interface IDataGridOptions<DataItem> {\r\n\t/**\r\n\t * If actionableMode is \"true, tab and shift tab behave like left and right arrow key,\r\n\t*/\r\n\tactionableMode?: boolean;\r\n\t/**\r\n\t * If cellNavigation is \"false, will show border around whole row on focus\r\n\t */\r\n\tcellNavigation?: boolean;\r\n\t/**\r\n\t * If rowNavigation is \"false, will NOT show border around the row\r\n\t */\r\n\trowNavigation?: boolean;\r\n\t/**\r\n\t * Sets shading for readonly grids\r\n\t * Default value: false\r\n\t */\r\n\talternateRowShading?: boolean;\r\n\t/**\r\n\t * Column properties\r\n\t */\r\n\tcolumns?: IDataGridColumn[];\r\n\t/**\r\n\t * Data set to populate the grid\r\n\t */\r\n\tdataset: DataItem[];\r\n\t/**\r\n\t * Allow Column reorder\r\n\t */\r\n\tcolumnReorder?: boolean;\r\n\t/**\r\n\t * Save Column Reorder and resize\r\n\t */\r\n\tsaveColumns?: boolean;\r\n\t/**\r\n\t * Enable cell editing\r\n\t * Default value: false\r\n\t */\r\n\teditable?: boolean;\r\n\t/**\r\n\t * Make a readonly \"list\"\r\n\t * Default value: false\r\n\t */\r\n\tisList?: boolean;\r\n\t/**\r\n\t * Id to link a right click context menu element\r\n\t */\r\n\tmenuId?: string;\r\n\t/**\r\n\t * Unique ID to use as local storage reference and internal variable names\r\n\t */\r\n\tuniqueId?: string;\r\n\t/**\r\n\t * Row height, possbile values: \"short\", \"medium\" or \"tall\"\r\n\t * Default value: \"medium\"\r\n\t */\r\n\trowHeight?: string;\r\n\t/**\r\n\t * Selectable rows, possbile values: \"single\" or \"multiple\"\r\n\t * Default value: false\r\n\t */\r\n\tselectable?: SelectableEnum | boolean;\r\n\t/**\r\n\t * Controls fields to use for data grouping Use Data grouping fx.\r\n\t * {fields: ['incidentId'], supressRow: true, aggregator: 'list', aggregatorOptions: ['unitName1']}\r\n\t */\r\n\tgroupable?: Object;\r\n\t/**\r\n\t * Controls if using a selection mode if you can click the rows to select\r\n\t * Default value: true\r\n\t */\r\n\tclickToSelect?: boolean;\r\n\t/**\r\n\t * Show toolbar. False or toolbar object\r\n\t * Default value: false\r\n\t */\r\n\ttoolbar?: IDataGridToolbarOptions;\r\n\t/**\r\n\t * Set to false if you will initialize the toolbar yourself\r\n\t */\r\n\tinitializeToolbar?: boolean;\r\n\t/**\r\n\t * Enable paging mode\r\n\t * Default value: false\r\n\t */\r\n\tpaging?: boolean;\r\n\t/**\r\n\t * Number of rows per page\r\n\t * Default value: 25\r\n\t */\r\n\tpagesize?: number;\r\n\t/**\r\n\t * Array of page sizes to show in the page size dropdown.\r\n\t * Default value: [10, 25, 50, 75]\r\n\t */\r\n\tpagesizes?: number[];\r\n\t/**\r\n\t * Disable the ability to go to a specific page when paging.\r\n\t * Default value: false\r\n\t */\r\n\tindeterminate?: boolean;\r\n\t/**\r\n\t * Callback function for paging\r\n\t */\r\n\tsource?: IPagerSource;\r\n\t/**\r\n\t * If true, hides the pager if there's only one page worth of results.\r\n\t */\r\n\thidePagerOnOnePage?: boolean;\r\n\t/**\r\n\t * Enable Column Filtering, This will require column filterTypes as well.\r\n\t */\r\n\tfilterable?: boolean;\r\n\t/**\r\n\t * Disable Filter Logic client side and let your server do it\r\n\t */\r\n\tdisableClientFilter?: boolean;\r\n\t/**\r\n\t * Disable Sort Logic client side and let your server do it\r\n\t */\r\n\tdisableClientSort?: boolean;\r\n\t/**\r\n\t * Can provide a custom function to adjust results text on the toolbar\r\n\t */\r\n\tresultsText?: string;\r\n\t/**\r\n\t * If set you can reorder rows. Requires rowReorder formatter\r\n\t */\r\n\trowReorder?: boolean;\r\n\t/**\r\n\t * If true the dirty indicator will be shown on the rows\r\n\t */\r\n\tshowDirty?: boolean;\r\n\t/**\r\n\t * Controls if you cna expand more than one expandable row.\r\n\t */\r\n\tallowOneExpandedRow?: boolean;\r\n\t/**\r\n\t * Process tooltip logic at a cost of performance\r\n\t */\r\n\tenableTooltips?: boolean;\r\n\t/**\r\n\t * If a row is activated the user should not be able to deactivate it by clicking on the activated row\r\n\t */\r\n\tdisableRowDeactivation?: boolean;\r\n\t/**\r\n\t * If true make all the columns equal width\r\n\t */\r\n\tsizeColumnsEqually?: boolean;\r\n\t/**\r\n\t * If true we append an expandable row area without the rowTemplate feature being needed.\r\n\t */\r\n\texpandableRow?: boolean;\r\n\t/**\r\n\t * If set to false we skip redraw logic on the resize of the page.\r\n\t */\r\n\tredrawOnResize?: boolean;\r\n\t/**\r\n\t * If true a tree grid is expected so addition calculations will be used to calculate of the row children\r\n\t */\r\n\ttreeGrid?: any;\r\n\t/**\r\n\t * Allows you to provide a row template\r\n\t */\r\n\trowTemplate?: string;\r\n\t/**\r\n\t * When using set the column id for the columns you want to freeze. Id is required for this to work.\r\n\t */\r\n\tfrozenColumns?: any;\r\n\t/**\r\n\t * Enable or disable a summary row at the bottom of the data-grid.\r\n\t */\r\n\tsummaryRow?: boolean;\r\n\t/**\r\n\t * Allows you to provide a function so you can set some rows to disabled base on data or row index.\r\n\t */\r\n\tisRowDisabled?: (idx: number, item: any) => boolean;\r\n\r\n\t/**\r\n\t * A callback function that fires when expanding rows. To be used. when expandableRow is true.\r\n\t * The function gets eventData about the row and grid and a response function callback.\r\n\t * Call the response function with markup to append and delay opening the row.\r\n\t */\r\n\tonExpandRow?: (e: any, response: Function) => void;\r\n\r\n\t/***************************************\r\n\t * Custom property outside of IDS framework.\r\n\t ***************************************/\r\n\r\n\t/**\r\n\t * This property is used to trigger Datagrid.updated in our datagrid directive.\r\n\t * Set property to true to update datagrid\r\n\t */\r\n\tupdateDatagrid?: boolean;\r\n\r\n\t/**\r\n\t * Allow to hide the checkbox header (true to show, false to hide)\r\n\t */\r\n\tshowSelectAllCheckBox?: boolean;\r\n\r\n\t/**\r\n\t * Optional to give datagrid a unique id\r\n\t */\r\n\tid?: string;\r\n}\r\n\r\nexport interface IDataGridToolbarOptions {\r\n\ttitle?: string;\r\n\tresults?: boolean;\r\n\tdateFilter?: boolean;\r\n\tkeywordFilter?: boolean;\r\n\tadvancedFilter?: boolean;\r\n\tactions?: boolean;\r\n\tviews?: boolean;\r\n\trowHeight?: boolean;\r\n\tmaxVisibleButtons?: number;\r\n\tcollapsibleFilter?: boolean;\r\n\texportToExcel?: boolean;\r\n}\r\n\r\nexport interface IDataGridRow<T> {\r\n\tcell: number;\r\n\trow: number;\r\n\titem: T;\r\n\toriginalEvent: JQueryEventObject;\r\n}\r\n\r\nexport interface IDataGridColumn {\r\n\t/**\r\n\t * ID of column\r\n\t */\r\n\tid: string;\r\n\t/**\r\n\t * Name displayed in the column header\r\n\t */\r\n\tname?: string;\r\n\t/**\r\n\t * Property in dataset to show in the column field\r\n\t */\r\n\tfield?: string;\r\n\t/**\r\n\t * Show\\hide\r\n\t */\r\n\thidden?: boolean;\r\n\t/**\r\n\t * Alignment\r\n\t */\r\n\talign?: string;\r\n\t/**\r\n\t * Width of column\r\n\t */\r\n\twidth?: number|string;\r\n\t/**\r\n\t\t * Minimum width of the column\r\n\t\t */\r\n\tminWidth?: number;\r\n\t/**\r\n\t * Maximum width of the column\r\n\t */\r\n\tmaxWidth?: number;\r\n\t/**\r\n\t * Formatter\r\n\t */\r\n\tformatter?: IFormatterFunction;\r\n\t/**\r\n\t * Editor\r\n\t */\r\n\teditor?: IEditorFunction;\r\n\t/**\r\n\t * On click method (hyperlink)\r\n\t */\r\n\tclick?: (event: JQueryEventObject, rowsSelected: IDataGridRow<any>[]|IDataGridRow<any>) => void;\r\n\r\n\t/**\r\n\t * Used with Date formatters and editors.\r\n\t * You can use it to specify the display format for date values.\r\n\t * fx yyyy-MM-dd. See locale for date formatting patterns.\r\n\t */\r\n\tdateFormat?: string;\r\n\r\n\t/**\r\n\t *  Used with Time and 'Date' + Time formatters and editors.\r\n\t *  You can use it to specify the display format for date values.\r\n\t *  fx HH;mm See locale for time formatting patterns.\r\n\t */\r\n\ttimeFormat?: string;\r\n\r\n\t/**\r\n\t * Number format\r\n\t */\r\n\tnumberFormat?: string;\r\n\r\n\teditorOptions?: any;\r\n\t/**\r\n\t * Sortable\r\n\t */\r\n\tsortable?: boolean;\r\n\t/**\r\n\t * Resizeable\r\n\t */\r\n\tresizable?: boolean;\r\n\t/**\r\n\t * Text overflow\r\n\t * Can be set to 'ellipsis'.\r\n\t */\r\n\ttextOverflow?: string;\r\n\t/**\r\n\t* Tooltip\r\n\t* Set a manual tooltip.\r\n\t*/\r\n\ttooltip?: any;\r\n\trequired?: boolean;\r\n\tvalidate?: string;\r\n\tisEditable?: IIsEditableFunction;\r\n\treadonly?: boolean;\r\n\tsummaryRowFormatter?: IFormatterFunction;\r\n\taggregator?: string;\r\n\t/**\r\n\t * Setting text for buttons\r\n\t *\r\n\t */\r\n\ttext?: string;\r\n\thref?: any;\r\n\ttarget?: string;\r\n\toptions?: IColumnOptions[];\r\n\ticon?: string;\r\n\tcssClass?: string;\r\n\tisChecked?: (value: string | number) => boolean;\r\n}\r\n\r\nexport interface IColumnOptions {\r\n\tid: string;\r\n\tvalue: string;\r\n\tlabel: string;\r\n}\r\n\r\nexport interface IDatagridColumnArgs<T> {\r\n\t/**\r\n\t * The cell value.\r\n\t */\r\n\tvalue: string;\r\n\r\n\t/**\r\n\t * The previous cell value.\r\n\t */\r\n\toldValue: string;\r\n\r\n\t/**\r\n\t * An array of selected rows.\r\n\t */\r\n\trow: number;\r\n\r\n\t/**\r\n\t * An array of selected rows.\r\n\t */\r\n\tcell: number;\r\n\r\n\t/**\r\n\t *\r\n\t */\r\n\trowData: T;\r\n\r\n\t/**\r\n\t * The cell html element that was entered.\r\n\t */\r\n\ttarget: JQuery;\r\n\r\n\t/**\r\n\t * The column object\r\n\t */\r\n\tcolumn: IDataGridColumn;\r\n}\r\n\r\nexport interface IDatagridSettings {\r\n\tsortOrder: ISortOrderSetting;\r\n\tactivePage: number;\r\n}\r\n\r\nexport interface ISortOrderSetting {\r\n\tsortField: string;\r\n\tsortAsc: boolean;\r\n\tsortId: string;\r\n}\r\n\r\nexport interface IDatagridApi {\r\n\t/**\r\n\t * Private IDS method\r\n\t */\r\n\tafterPaging(pagingInfo: IPagerInfo): void;\r\n\r\n\t/**\r\n\t *  IDS Pager component API.\r\n\t */\r\n\tpagerAPI: IPagerApi;\r\n\r\n\telement: any;\r\n\r\n\temptyMessage: any;\r\n\r\n\t/**\r\n\t * Get the column index from the col's id\r\n\t * @param id\r\n\t * @returns The corresponding columns current position.\r\n\t */\r\n\tcolumnIdxById(id: number): IDatagridColumnArgs<any>;\r\n\r\n\t/**\r\n\t * Return all of the currently dirty rows by row index.\r\n\t * @returns array: An array of dirty rows.\r\n\t */\r\n\tdirtyRows(): any[];\r\n\r\n\t/**\r\n\t * Clear all dirty cells.\r\n\t */\r\n\tclearDirty(): void;\r\n\r\n\t/**\r\n\t * Toggle selection on a single row\r\n\t * @param idx\r\n\t * @param nosync\r\n\t * @param noTrigger\r\n\t */\r\n\tselectRow(idx: number, nosync?: boolean, noTrigger?: boolean): void;\r\n\r\n\t/**\r\n\t * Get the currently selected rows.\r\n\t * @returns array: An array containing the selected rows\r\n\t */\r\n\tselectedRows(): any[];\r\n\t/**\r\n\t * Set the selected rows by passing the row index or an array of row indexes.\r\n\t * @param idx\r\n\t * @param nosync\r\n\t * @param noTrigger\r\n\t * @param forceSelect\r\n\t */\r\n\tselectRows(idx: number | number[], nosync?: boolean, noTrigger?: boolean, forceSelect?: boolean): void;\r\n\r\n\t/**\r\n\t * Returns an array of row numbers for the rows containing the value for the specified field.\r\n\t * @param fieldName\r\n\t * @param value\r\n\t * @returns array: an array of row numbers.\r\n\t */\r\n\tfindRowsByValue(fieldName: string, value: any): number[];\r\n\r\n\t/**\r\n\t * Unwrap the grid back to a simple div, and destory all events and pointers.\r\n\t * @returns object: The plugin api for chaining.\r\n\t */\r\n\tdestroy(): object;\r\n\r\n\t/**\r\n\t * Deselect all rows that are currently selected.\r\n\t */\r\n\tunSelectAllRows(): void;\r\n\r\n\t/**\r\n\t * Select all rows. If serverside paging, this will be only the current page.\r\n\t * For client side paging, all rows across all pages are selected.\r\n\t */\r\n\tselectAllRows(): void;\r\n\r\n\t/**\r\n\t * Given a new column set update the rows and reload\r\n\t * @param columns\r\n\t * @param columnGroups\r\n\t */\r\n\tupdateColumns(columns: IDataGridColumn[], columnGroups?: any): void;\r\n\r\n\t/**\r\n\t * Update the datagrid and optionally apply new settings.\r\n\t * The datagrid api for chaining.\r\n\t * @param settings\r\n\t */\r\n\tupdated(settings?: IDataGridOptions<any>): IDatagridApi;\r\n\r\n\t/**\r\n\t * Send in a new data set to display in the datagrid in the lookup.\r\n\t * This will work whether or not the lookup is open or closed.\r\n\t * @param {object} dataset The array of data to show in the datagridgrid.\r\n\t * @param {object} pagerInfo The extra pager info object with information like activePage and pagesize.\r\n\t */\r\n\tupdateDataset(dataset: any[], pagerInfo: IPagerInfo): IDatagridApi;\r\n\r\n\t/**\r\n\t * Render or render both the header and row area.\r\n\t * @param isToggleFilter\r\n\t * @param pagerInfo\r\n\t */\r\n\trender(isToggleFilter: string, pagerInfo: IPagerInfo): void;\r\n\r\n\t/**\r\n\t * Remove all selected rows from the grid and dataset.\r\n\t */\r\n\tremoveSelected(): void;\r\n\r\n\t/**\r\n\t * Show the cell errors.\r\n\t * @param row\r\n\t * @param cell\r\n\t * @param message\r\n\t * @param type\r\n\t */\r\n\tshowCellError(row: number, cell: number, message: string, type: string): void;\r\n\r\n\t/**\r\n\t * Get or Set the row height.\r\n\t * @param height\r\n\t */\r\n\trowHeight(height: string): void;\r\n\r\n\t/**\r\n\t * Deselect all rows that are currently selected.\r\n\t */\r\n\tdeSelectAllRows(): void;\r\n\r\n\t/**\r\n\t* Run throught the array and remark the idx's after a row reorder.\r\n\t*/\r\n\tsyncSelectedRowsIdx(): void;\r\n\r\n\t/**\r\n\t * Set the current datagrid sort column\r\n\t * @param id\r\n\t * @param ascending\r\n\t */\r\n\tsetSortColumn(id: string, ascending: boolean): void;\r\n\r\n\t/**\r\n\t * Run validation for the column, for a particular cell.\r\n\t */\r\n\tvalidateCell?: (row: number, cell: number) => void;\r\n\r\n\t/**\r\n\t * Export datagrid to csv\r\n\t * @param name\r\n\t */\r\n\texportToCsv(name: string): void;\r\n\r\n\t/**\r\n\t * Export datagrid to excel\r\n\t * @param name\r\n\t */\r\n\texportToExcel(name: string): void;\r\n}\r\n\r\n/**\r\n * Data Grid Directive\r\n *\r\n * Example:\r\n *\r\n * scope[\"options\"] = {\r\n\t\tdataset: [\r\n\t\t\t{ name: \"Name #1\", age: 12, phone: \"12345\" },\r\n\t\t\t{ name: \"Name #2\", age: 22, phone: \"1234567\" },\r\n\t\t\t{ name: \"Name #3\", age: 32, phone: \"1234589\" }\r\n\t\t]\r\n\t}\r\n\t* <div xi-datagrid=\"ctrl.options\"></div>\r\n\t*/\r\n\r\nexport interface IFormatterFunction {\r\n\t(\r\n\t\trow: number,\r\n\t\tcell: number,\r\n\t\tvalue: string | number,\r\n\t\tcol: IDataGridColumn,\r\n\t\titem: any,\r\n\t\tdatagrid: IDatagridApi\r\n\t): string;\r\n}\r\n\r\nexport interface IEditorFunction {\r\n\t(\r\n\t\trow: number,\r\n\t\tcell: number,\r\n\t\tvalue: string,\r\n\t\tcontainer: any,\r\n\t\tcolumn: IDataGridColumn,\r\n\t\te: any,\r\n\t\tapi: any,\r\n\t\titem: any\r\n\t): string;\r\n}\r\n\r\nexport interface IIsEditableFunction {\r\n\t(\r\n\t\trow: number,\r\n\t\tcell: number,\r\n\t\tvalue: string,\r\n\t\tcol: IDataGridColumn,\r\n\t\titem: any\r\n\t): boolean;\r\n}\r\n","import { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\n\r\nexport interface IComponentSettingCategory {\r\n\ttitle: string;\r\n\ttab: string;\r\n\tcondition?: string;\r\n\tsettings: IComponentFieldSetting[];\r\n}\r\n","/**\r\n * KEEP IN NOTE!\r\n * This helper class will eventually be replaced with the Component Service\r\n * found in the new App Launcher\r\n */\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IComponentFieldSetting } from \"ng2/common/model/components/settings/component-field-setting.model\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { IComponent } from \"../common/IComponent\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\nimport { ApplicationParent } from \"./application-parent\";\r\nimport { Component } from \"./component\";\r\nimport { Defines, IStaticComponent } from \"./defines\";\r\nimport { FrameworkService } from \"./services/framework-service\";\r\n\r\nexport class ComponentsHelper {\r\n\r\n\tpublic static instantiateComponent<T extends IComponent>(\r\n\t\tobj: IJsonComponent,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparentInstance: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t): T {\r\n\t\tlet componentClass: IStaticComponent;\r\n\t\tlet instance: IComponent;\r\n\t\tif (obj) {\r\n\t\t\tif (Defines.allComponents[obj.typedef]) {\r\n\t\t\t\tcomponentClass = Defines.allComponents[obj.typedef].class;\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"Unknown class \" + obj.typedef);\r\n\t\t\t}\r\n\r\n\t\t\tinstance = new componentClass(obj, $element, parentInstance, frameworkService);\r\n\t\t}\r\n\t\treturn instance as T;\r\n\t}\r\n\r\n\t// public static getStaticClass(className: string): IStaticComponent {\r\n\t// \treturn Defines.allComponents[className].class;\r\n\t// }\r\n\r\n\t// public static getClassNameFromInstance(classInst: IComponent): string {\r\n\t// \tconst funcNameRegex = /function (.{1,}?)\\(/;\r\n\t// \tconst results = (funcNameRegex).exec(classInst.constructor.toString());\r\n\t// \treturn (results && results.length > 1) ? results[1] : \"\";\r\n\t// }\r\n\r\n\t// public static getClassNameFromClass(staticClass: IStaticComponent): string {\r\n\t// \tconst funcNameRegex = /function (.{1,}?)\\(/;\r\n\t// \tconst results = (funcNameRegex).exec(staticClass.toString());\r\n\t// \treturn (results && results.length > 1) ? results[1] : \"\";\r\n\t// }\r\n\r\n\tpublic static getComponentDisplayName(className: string): string {\r\n\t\tconst clazz = Defines.allComponents[className];\r\n\t\treturn (clazz.displayName ? clazz.displayName : className);\r\n\t}\r\n\r\n\t// public static isLayoutType(type: string): boolean {\r\n\t// \treturn Defines.allComponents[type].isLayoutComponent;\r\n\t// \t// return type === this.getClassNameFromClass(Flexbox)\r\n\t// \t// \t|| type === this.getClassNameFromClass(TabPanel)\r\n\t// \t// \t|| type === this.getClassNameFromClass(Tabs);\r\n\t// }\r\n\r\n\tpublic static isApplicationParent(component: IComponent | IJsonComponent): boolean {\r\n\t\tconst typedef = component instanceof Component ?\r\n\t\t\t(component as IComponent).getTypedef() :\r\n\t\t\t(component as IJsonComponent).typedef;\r\n\t\treturn typedef === ApplicationParent.name;\r\n\t}\r\n\r\n\t/**\r\n\t * Parse end of string in the list for last number and increase it by one\r\n\t *\r\n\t * @static\r\n\t * @param {string[]} names\r\n\t * @returns {number}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tpublic static nextNumber(names: string[]): number {\r\n\t\tlet highestNumber: number = 0;\r\n\r\n\t\tif (names && names.length) {\r\n\t\t\tnames.forEach((name: string) => {\r\n\t\t\t\t// Extract number at end of the string\r\n\t\t\t\tconst lastNumberMatch: RegExpMatchArray = name.match(/\\d+$/);\r\n\t\t\t\tif (lastNumberMatch) {\r\n\t\t\t\t\tconst suffixNumber: number = parseInt(lastNumberMatch[0]);\r\n\r\n\t\t\t\t\t// Remember highest number of the list\r\n\t\t\t\t\tif (suffixNumber > highestNumber) {\r\n\t\t\t\t\t\thighestNumber = suffixNumber;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\thighestNumber++; // Next number\r\n\t\t}\r\n\t\treturn highestNumber; // Keeping zero if no names given\r\n\t}\r\n\r\n\t/**\r\n\t * Sorts an array of {IComponent} in natural order\r\n\t *\r\n\t * @static\r\n\t * @param {IComponent[]} componentList\r\n\t * @returns {IComponent[]}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tpublic static sortComponentList(componentList: IComponent[]): IComponent[] {\r\n\t\treturn componentList.sort((a: IComponent, b: IComponent): number => {\r\n\t\t\treturn this.naturalCompare(a.getDisplayName(), b.getDisplayName());\r\n\t\t});\r\n\t}\r\n\r\n\t// Natural compare http://stackoverflow.com/a/15479354/445600\r\n\tprivate static naturalCompare(a: any, b: any): number {\r\n\t\tconst ax: any = [], bx: any = [];\r\n\t\ta.replace(/(\\d+)|(\\D+)/g, (_: any, $1: any, $2: any) => {\r\n\t\t\tax.push([$1 || Infinity, $2 || \"\"]);\r\n\t\t});\r\n\t\tb.replace(/(\\d+)|(\\D+)/g, (_: any, $1: any, $2: any) => {\r\n\t\t\tbx.push([$1 || Infinity, $2 || \"\"]);\r\n\t\t});\r\n\r\n\t\twhile (ax.length && bx.length) {\r\n\t\t\tconst an = ax.shift();\r\n\t\t\tconst bn = bx.shift();\r\n\t\t\tconst nn = (an[0] - bn[0]) || an[1].localeCompare(bn[1]);\r\n\t\t\tif (nn) {\r\n\t\t\t\treturn nn;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ax.length - bx.length;\r\n\t}\r\n\r\n\t/**\r\n\t * Verify if input is base64\r\n\t *\r\n\t * @static\r\n\t * @param {string} newValue\r\n\t * @returns {boolean}\r\n\t *\r\n\t * @memberOf Helper\r\n\t */\r\n\tpublic static isBase64(newValue: string): boolean {\r\n\t\tlet base64Str = newValue;\r\n\t\tif (newValue.indexOf(\"data\") !== -1) {\r\n\t\t\tbase64Str = newValue.substr(newValue.indexOf(\",\") + 1, newValue.length);\r\n\t\t}\r\n\t\ttry {\r\n\t\t\twindow.atob(base64Str);\r\n\t\t\treturn true;\r\n\t\t} catch (e) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generates an ID unique among the occupiedStrings\r\n\t *\r\n\t * @param {string} prefix - The prefix of new ID\r\n\t * @param {string[]} occupiedStrings - The list of occupied IDs\r\n\t */\r\n\tpublic static generateId(prefix: string, occupiedStrings: string[], idCounter: number = 0): string {\r\n\t\tconst newId = prefix + idCounter;\r\n\t\tif (occupiedStrings.some((possibleConflict) => { return possibleConflict === newId; })) {\r\n\t\t\treturn this.generateId(prefix, occupiedStrings, idCounter + 1);\r\n\t\t} else {\r\n\t\t\treturn newId;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Will return the index by itemID, if itemID does not exists then return -1\r\n\t * If result is more than one return null to indicate that the choosen object id is not unique\r\n\t * @param listResults\r\n\t * @param itemId\r\n\t */\r\n\tpublic static findItemIndexById(listResults: IListDataItem[], itemId: string): number | null {\r\n\t\tlet index = null;\r\n\t\tif (itemId) {\r\n\t\t\tconst mylist = listResults.filter(item => item.id === itemId);\r\n\t\t\tif (mylist.length === 1) {\r\n\t\t\t\tindex = listResults.findIndex((item) => {\r\n\t\t\t\t\treturn item.id && item.id === itemId;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tindex = -1;\r\n\t\t}\r\n\t\treturn index;\r\n\t}\r\n\r\n\t/**\r\n\t * Add one to index if new item is added\r\n\t *\r\n\t * @param index\r\n\t * @param newItem\r\n\t * @param previousItem\r\n\t * @param outputParameters\r\n\t */\r\n\tpublic static incrementIndex(\r\n\t\tindex: number,\r\n\t\tcontext: IContext,\r\n\t\tpreviousItem: any,\r\n\t\tdatasource: IDatasource\r\n\t): number {\r\n\t\tconst newItem = context.ListResult[index];\r\n\t\tconst outputParameters = (datasource.getDatabearer() as IJsonGenericDatasource2).outputParameters;\r\n\r\n\t\tlet newIndex = index;\r\n\t\tif (newItem !== null) {\r\n\t\t\tconst itemAdded = outputParameters.some((params) => {\r\n\t\t\t\treturn previousItem[params.id] !== newItem[params.id];\r\n\t\t\t});\r\n\t\t\tif (itemAdded) {\r\n\t\t\t\tindex += 1;\r\n\t\t\t\tnewIndex = index;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn newIndex;\r\n\t}\r\n\r\n\t/**\r\n\t * * Get default component setting value on ref for setting category with title\r\n\t * @param settingCategories\r\n\t * @param title\r\n\t * @param ref\r\n\t */\r\n\tpublic static getDefaultComponentSettingValue<T>(\r\n\t\tsettingCategories: IComponentSettingCategory[], ref: string, title: string\r\n\t): T {\r\n\t\tconst componentCategory =\r\n\t\t\tsettingCategories.find(category => category.title === title);\r\n\r\n\t\tlet componentFieldSetting: IComponentFieldSetting;\r\n\t\tif (componentCategory.settings.length > 0) {\r\n\t\t\tcomponentFieldSetting = componentCategory.settings.find(setting => setting.ref === ref);\r\n\t\t}\r\n\t\treturn componentFieldSetting.defaultValue;\r\n\t}\r\n\r\n\t/**\r\n\t *\tTruncate string and add ellipsis if necessary\r\n\t\t*\r\n\t\t* @param str\r\n\t\t* @param maxlength\r\n\t\t*/\r\n\tpublic static truncate(str: string, maxlength: number): string {\r\n\t\treturn (str.length > maxlength) ? str.substr(0, maxlength - 1) + \"...\" : str;\r\n\t}\r\n}\r\n","import isEmpty from \"lodash-es/isEmpty\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { Config, ProjectTypeEnum, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonDesignerManifest, IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\n\r\nimport { FileMetaData } from \"ng2/common/project/manifest/file-metadata\";\r\n\r\nexport class DesignerManifest implements IDesignerManifest {\r\n\tcreatedBy: string;\r\n\tcreatedByDisplayName: string;\r\n\tcreatedTime: number;\r\n\tdescription: string;\r\n\tdisplayName: string;\r\n\tfileMetaData: IMap<FileMetaData> = {};\r\n\tid: string;\r\n\tlastChangedBy: string;\r\n\tlastChangedByDisplayName: string;\r\n\tlastChangedTime: number;\r\n\tmashupBoundaries: IBoundary[];\r\n\turlVariables: IJsonUrlVariable[];\r\n\ttitle: string;\r\n\tversion: string;\r\n\r\n\tpreviewImg: string;\r\n\tshowTitleBar: boolean;\r\n\tthemeSwitchEnabled: boolean;\r\n\tdefaultTheme: ThemeEnum;\r\n\ttypeDef: ProjectTypeEnum;\r\n\r\n\tconstructor(arg1?: string | IJsonDesignerManifest, arg2?: string) {\r\n\t\tif (!arg2 && arg1 && typeof arg1 === \"object\") {\r\n\t\t\tthis.id = arg1.id;\r\n\t\t\tthis.displayName = arg1.displayName;\r\n\t\t\tthis.createdBy = arg1.createdBy;\r\n\t\t\tthis.createdByDisplayName = arg1.createdByDisplayName;\r\n\t\t\tthis.createdTime = arg1.createdTime;\r\n\t\t\tthis.lastChangedBy = arg1.lastChangedBy;\r\n\t\t\tthis.lastChangedByDisplayName = arg1.lastChangedByDisplayName;\r\n\t\t\tthis.lastChangedTime = arg1.lastChangedTime;\r\n\t\t\tthis.mashupBoundaries = arg1.mashupBoundaries;\r\n\t\t\tthis.urlVariables = arg1.urlVariables;\r\n\t\t\tthis.version = arg1.version;\r\n\t\t\tthis.description = arg1.description;\r\n\t\t\tif (arg1.fileMetaData) {\r\n\t\t\t\tthis.fileMetaData = arg1.fileMetaData;\r\n\t\t\t}\r\n\t\t\tthis.previewImg = arg1.previewImg;\r\n\t\t\tthis.showTitleBar = arg1.showTitleBar;\r\n\t\t\tthis.title = arg1.title;\r\n\t\t\tthis.themeSwitchEnabled = arg1.themeSwitchEnabled;\r\n\t\t\tthis.defaultTheme = arg1.defaultTheme;\r\n\t\t\tthis.typeDef = arg1.typeDef;\r\n\t\t} else if (arg1) {\r\n\t\t\tthis.id = \"\";\r\n\t\t\tthis.displayName = (arg1 as string);\r\n\t\t\tthis.description = arg2;\r\n\t\t\tthis.title = (arg1 as string);\r\n\t\t\tthis.showTitleBar = true;\r\n\t\t\tthis.themeSwitchEnabled = false;\r\n\t\t\tthis.defaultTheme = ThemeEnum.LIGHT;\r\n\t\t}\r\n\t}\r\n\r\n\tsetHasFile(fileKey: string, mimeType: string, visibleName: string): void {\r\n\t\tif (!this.fileMetaData[fileKey]) {\r\n\t\t\tthis.fileMetaData[fileKey] = new FileMetaData(visibleName, mimeType);\r\n\t\t}\r\n\t}\r\n\r\n\tupdateLastChangedInformation(newManifest: IJsonManifest): void {\r\n\t\tif (newManifest) {\r\n\t\t\tthis.lastChangedBy = newManifest.lastChangedBy;\r\n\t\t\tthis.lastChangedByDisplayName = newManifest.lastChangedByDisplayName;\r\n\t\t\tthis.lastChangedTime = newManifest.lastChangedTime;\r\n\t\t} else {\r\n\t\t\tthis.lastChangedBy = Config.USER.name;\r\n\t\t\tthis.lastChangedByDisplayName =\r\n\t\t\t\tisUndefined(Config.USER.displayName) || isEmpty(Config.USER.displayName) ?\r\n\t\t\t\t\tConfig.USER.name : Config.USER.displayName;\r\n\t\t\tthis.lastChangedTime = new Date().getTime();\r\n\t\t}\r\n\t}\r\n}\r\n","export enum ParameterTypeEnum {\r\n\tPATH = 1,\r\n\tQUERY,\r\n\tBODY_PART,\r\n\tOUTPUT,\r\n\tMATRIX\r\n}\r\n","import { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nexport interface IParameterObject {\r\n\tid: string;\r\n\tkey: string;\r\n\tvalueType: ValueTypeEnum;\r\n\tparameterType: ParameterTypeEnum;\r\n\trequired: boolean;\r\n\talias: string;\r\n\tdataType?: string;\r\n}\r\n\r\nexport interface ILocalIdoParameterObject extends IParameterObject {\r\n}","import type {\r\n\tIJsonDesignerManifest,\r\n\tIJsonRuntimeManifest,\r\n} from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\n\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { RuntimeManifest } from \"ng2/common/project/manifest/runtime-manifest\";\r\n\r\nexport interface IProjectInfo {\r\n\tmanifest: IJsonRuntimeManifest | IJsonDesignerManifest;\r\n\ttags?: IJsonTag[];\r\n}\r\nexport class ProjectInfo {\r\n\r\n\tmanifest: IJsonDesignerManifest | IJsonRuntimeManifest;\r\n\ttags: IJsonTag[] = [];\r\n\r\n\tconstructor(projectInfo: IProjectInfo) {\r\n\t\tif (projectInfo.manifest instanceof DesignerManifest) {\r\n\t\t\tthis.manifest = new DesignerManifest(projectInfo.manifest);\r\n\t\t} else {\r\n\t\t\tthis.manifest = new RuntimeManifest(projectInfo.manifest as IJsonRuntimeManifest);\r\n\t\t}\r\n\r\n\t\tthis.tags = projectInfo.tags;\r\n\t}\r\n}\r\n","import { InforOwnedEnum } from \"ng2/common/enums/infor-owned.enum\";\r\n\r\nexport interface IJsonTag {\r\n\tid: string;\r\n\tname: string;\r\n\tinforOwned?: InforOwnedEnum;\r\n}\r\n","import { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nexport interface IJsonLayoutComponent extends IJsonComponent {\r\n\tchildren?: IJsonComponent[];\r\n}\r\n","import { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonComponent, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IComponent } from \"common/IComponent\";\r\nimport { IComponentScope } from \"common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"common/interface/ilayout-component\";\r\n\r\nimport { ApplicationParent } from \"components/application-parent\";\r\nimport { Button } from \"components/button/button\";\r\nimport { Chart } from \"components/chart/chart\";\r\nimport { Checkbox } from \"components/checkbox/checkbox\";\r\nimport { Datagrid } from \"components/datagrid/datagrid\";\r\nimport { Datepicker } from \"components/datepicker/datepicker\";\r\nimport { Dropdown } from \"components/dropdown/dropdown\";\r\nimport { Flexbox } from \"components/flexbox/flexbox\";\r\nimport { Hyperlink } from \"components/hyperlink/hyperlink\";\r\nimport { Image } from \"components/image/image\";\r\nimport { Label } from \"components/label/label\";\r\nimport { LayoutComponent } from \"components/layout-component\";\r\nimport { List } from \"components/list/list\";\r\nimport { Lookup } from \"components/lookup/lookup\";\r\nimport { RadioButton } from \"components/radiobutton/radiobutton\";\r\nimport { TabPanel } from \"components/tabs/tab-panel\";\r\nimport { Tabs } from \"components/tabs/tabs\";\r\nimport { TextArea } from \"components/textarea/textarea\";\r\nimport { TextBox } from \"components/textbox/textbox\";\r\nimport { Timepicker } from \"components/timepicker/timepicker\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport interface IStaticComponent {\r\n\tnew(\r\n\t\tobj: IJsonComponent,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparentInstance: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t): IComponent;\r\n\tdirective: any[];\r\n\r\n\tBINDABLE_FIELDS_2: IJsonBindableField[];\r\n\tSETTING_FIELDS: IComponentSettingCategory[];\r\n\tDEFAULT_WIDTH: IJsonSize;\r\n\tDEFAULT_HEIGHT: IJsonSize;\r\n\r\n\tSOURCE_TRIGGERS?: IDataPair[];\r\n\tTARGET_ACTIONS?: IDataPair[];\r\n\r\n\tDEFAULT_TRIGGER?: IDataPair;\r\n\tDEFAULT_ACTION?: IDataPair;\r\n}\r\n\r\nexport interface IComponentListEntry {\r\n\tclass: IStaticComponent;\r\n\tdisplayName?: string;\r\n\tavailable: boolean;\r\n\tisLayoutComponent: boolean;\r\n}\r\n\r\nexport class Defines {\r\n\tstatic get allComponents(): IMap<IComponentListEntry> {\r\n\t\tconst componentList: IMap<IComponentListEntry> = {};\r\n\t\tcomponentList[ApplicationParent.name] = {\r\n\t\t\tclass: ApplicationParent,\r\n\t\t\tavailable: false,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Button.name] = {\r\n\t\t\tclass: Button,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Chart.name] = {\r\n\t\t\tclass: Chart,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Checkbox.name] = {\r\n\t\t\tclass: Checkbox,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Datagrid.name] = {\r\n\t\t\tclass: Datagrid,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Datepicker.name] = {\r\n\t\t\tclass: Datepicker,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Dropdown.name] = {\r\n\t\t\tclass: Dropdown,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Flexbox.name] = {\r\n\t\t\tclass: Flexbox,\r\n\t\t\tavailable: false,\r\n\t\t\tisLayoutComponent: true,\r\n\t\t};\r\n\t\tcomponentList[Hyperlink.name] = {\r\n\t\t\tclass: Hyperlink,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Image.name] = {\r\n\t\t\tclass: Image,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Label.name] = {\r\n\t\t\tclass: Label,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[List.name] = {\r\n\t\t\tclass: List,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Lookup.name] = {\r\n\t\t\tclass: Lookup,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[RadioButton.name] = {\r\n\t\t\tclass: RadioButton,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Tabs.name] = {\r\n\t\t\tclass: Tabs,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: true,\r\n\t\t};\r\n\t\tcomponentList[TabPanel.name] = {\r\n\t\t\tclass: TabPanel,\r\n\t\t\tavailable: false,\r\n\t\t\tisLayoutComponent: true,\r\n\t\t};\r\n\t\tcomponentList[TextBox.name] = {\r\n\t\t\tclass: TextBox,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[TextArea.name] = {\r\n\t\t\tclass: TextArea,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\tcomponentList[Timepicker.name] = {\r\n\t\t\tclass: Timepicker,\r\n\t\t\tavailable: true,\r\n\t\t\tisLayoutComponent: false,\r\n\t\t};\r\n\t\treturn componentList;\r\n\t}\r\n\r\n\tstatic addComponents(m: ng.IModule): void {\r\n\t\tfor (const key in Defines.allComponents) {\r\n\t\t\tif (Defines.allComponents.hasOwnProperty(key)) {\r\n\t\t\t\tconst componentName = key.toLowerCase();\r\n\t\t\t\tconst componentClass: IStaticComponent = Defines.allComponents[key].class;\r\n\t\t\t\tconst method = componentClass.directive[0];\r\n\t\t\t\t// Fix for incorrect directive definition in chart.ts\r\n\t\t\t\tif (typeof method === \"function\") {\r\n\t\t\t\t\tconst directive = componentClass.directive[0]();\r\n\t\t\t\t\t// Only append link functions to real components\r\n\t\t\t\t\tif (directive && (directive.templateUrl || directive.template) && !directive.link) {\r\n\t\t\t\t\t\tthis.appendLinkFunction(directive);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tm.directive(\"d\" + componentName, [() => {\r\n\t\t\t\t\t\treturn directive;\r\n\t\t\t\t\t}]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Appends a link function to a component directive to get more accurate componentReady\r\n\tprivate static appendLinkFunction(directive: any): void {\r\n\t\tdirective.link = ($scope: IComponentScope) => {\r\n\t\t\tif (!($scope.componentInstance instanceof LayoutComponent)) {\r\n\t\t\t\t$scope.componentReady({ componentInstance: $scope.componentInstance });\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tstatic get CustomComponentType(): string { return \"CustomComponent\"; }\r\n}\r\n","import { Numbers, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { IJsonComponent, IJsonMargin, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { ILayoutComponentStyle } from \"../common/defines\";\r\nimport { IComponent } from \"../common/IComponent\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\nimport { Component } from \"./component\";\r\n\r\nexport abstract class LayoutComponent extends Component implements ILayoutComponent {\r\n\r\n\tpublic abstract getPxPerPercentComponent(ori: OrientationEnum, percent: number): number;\r\n\r\n\tpublic abstract hasIndividualChildSizes(ori: OrientationEnum): boolean;\r\n\r\n\tpublic abstract resizableChildren(direction: OrientationEnum): boolean;\r\n\r\n\tpublic children: IComponent[] = [];\r\n\tprotected databearer: IJsonLayoutComponent;\r\n\r\n\tpublic addChild(child: IJsonComponent, index: number): void {\r\n\t\tthis.databearer.children.splice(index, 0, child);\r\n\t}\r\n\r\n\tpublic onChildrenReady(): void {\r\n\t\t// onChildReady\r\n\t}\r\n\r\n\t// Generic addFunction for all LayoutComponent\r\n\tpublic addChildInstance(child: IComponent): void {\r\n\t\tthis.children.push(child);\r\n\t}\r\n\r\n\tpublic generateId(index: number): string {\r\n\t\tif (this.isGenerated) {\r\n\t\t\treturn this.generatedId + \"index\" + index;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getPadding(): IMap<string> {\r\n\t\tconst margin = this.getBoundarySetting<IJsonMargin>(SettingKeys.MARGIN);\r\n\t\tconst padding: IMap<string> = {\r\n\t\t\tpadding: margin.top + \"px \" + margin.right + \"px \" + margin.bottom + \"px \" + margin.left + \"px\"\r\n\t\t};\r\n\t\treturn padding;\r\n\t}\r\n\r\n\tpublic newBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\r\n\t\tthis.children.forEach((child) => {\r\n\t\t\tchild.newBoundaryEntered(boundaryId);\r\n\t\t});\r\n\t}\r\n\r\n\tprotected getClassList(): string[] {\r\n\t\tconst classList = super.getClassList();\r\n\t\tclassList.push(\"layoutComponent\");\r\n\t\tclassList.push(\"col-md4\");\r\n\t\treturn classList;\r\n\t}\r\n\r\n\tprotected getInlineStyle(): ILayoutComponentStyle {\r\n\t\tconst style: ILayoutComponentStyle = super.getInlineStyle();\r\n\t\tstyle.padding = style.margin;\r\n\t\tstyle.margin = null;\r\n\t\treturn style;\r\n\t}\r\n\r\n\tprotected calcNewSize(sizeObject: IJsonSize, orientation: OrientationEnum, margin: number = 0): string {\r\n\t\t// Overloading because of margin calculation\r\n\t\tlet retSize = \"\";\r\n\t\tif (this.parent.hasIndividualChildSizes(orientation)) {\r\n\t\t\tif (sizeObject.sizeType === SizeTypeEnum.PERCENT) {\r\n\t\t\t\tconst pxPerPercentComponent = this.parent.getPxPerPercentComponent(orientation, sizeObject.value);\r\n\t\t\t\tretSize = \"calc(\" + (sizeObject.value || Numbers.HUNDRED) + \"% - \" + (pxPerPercentComponent) + \"px)\";\r\n\t\t\t} else if (sizeObject.sizeType === SizeTypeEnum.PIXELS) {\r\n\t\t\t\tretSize = \"calc(\" + sizeObject.value + \"px)\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn retSize;\r\n\t}\r\n\r\n\t// Overriding calcNewSizes in Component, important for inheritance\r\n\tpublic calcNewSizes(orientation?: OrientationEnum): void {\r\n\t\tsuper.calcNewSizes();\r\n\t}\r\n\r\n\tpublic forEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void {\r\n\t\tsuper.forEachChild(fn, doGenerated);\r\n\t\tthis.children.forEach((ch) => {\r\n\t\t\tch.forEachChild(fn, doGenerated);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic forEachParent(fn: (parent: ILayoutComponent) => void): void {\r\n\t\tsuper.forEachParent(fn);\r\n\t\tfn(this as any);\r\n\t}\r\n\r\n}","// MUPS-2682: Rename file to project-settings.model.ts\r\nimport { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\n\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { IProjectRole } from \"../model/project-role\";\r\n\r\nexport interface IProjectSetting {\r\n\tmanifest: IJsonRuntimeManifest;\r\n\troles: IProjectRole[];\r\n\ttags: IJsonTag[];\r\n\r\n\tisModified?: boolean;\r\n}\r\n\r\nexport interface IAppSetting {\r\n\tdisplayName?: string;\r\n\tdescription?: string;\r\n\tstatus?: number;\r\n\turlName?: string;\r\n}\r\n","import { AngularConstants } from \"../../../appbuilder/common/angular-constants\";\r\n\r\nimport { AppStatus, Config, InjectNames, MGPlatform, ReplaceEnum, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonRuntimeMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport { IProjectInfo, ProjectInfo } from \"ng2/common/project/project-info\";\r\nimport { Helper } from \"../../../appbuilder/common/helper\";\r\nimport { InstanceEvent } from \"../../../appbuilder/common/instance-event\";\r\nimport { IProjectRole, IRole } from \"../../model/project-role\";\r\nimport { IProjectSetting } from \"../../model/project-settings\";\r\n\r\nimport { HttpService } from \"../../../appbuilder/common/services/http-service\";\r\nimport { SaveService } from \"./save-service\";\r\n\r\nexport class AdministrationService {\r\n\tpublic projectSettingsChangedEvent = new InstanceEvent<IProjectInfo>();\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.WINDOW,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.SAVE_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate $window: ng.IWindowService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate saveService: SaveService,\r\n\t) { }\r\n\r\n\t/**\r\n\t * Get IFS group roles. It will only get group roles for a project if optional parameter is supplied\r\n\t *\r\n\t * @param projectId\r\n\t */\r\n\tpublic getIfsRoles(): ng.IPromise<IRole[]> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.ADMINISTRATION + \"ifsroles\");\r\n\t}\r\n\r\n\tpublic getProjectRoles(projectId?: string): ng.IPromise<IProjectRole[]> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.ADMINISTRATION + \"project/\" + projectId + \"/roles\");\r\n\t}\r\n\r\n\tpublic loadRuntimeProjects(): ng.IPromise<IProjectInfo[]> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.ADMINISTRATION + \"project\");\r\n\t}\r\n\r\n\tpublic listProjectVersions(projectId: string): ng.IPromise<string[]> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.ADMINISTRATION + projectId + \"/versions\");\r\n\t}\r\n\r\n\tpublic exportProject(exportProjectId: string, exportFileName: string): void {\r\n\t\tconst resourceName = ServerPaths.ADMINISTRATION + exportProjectId + \"/export/\";\r\n\t\tthis.httpService.executeGet<{ base64: string, filename: string }>(\r\n\t\t\tresourceName, exportFileName)\r\n\t\t\t.then((exportResult: { base64: string, filename: string }) => {\r\n\t\t\t\tif (Config.MG_PLATFORM === MGPlatform.WEB) {\r\n\t\t\t\t\tconst blob = Helper.convertBase64ToSaveableBlob(\r\n\t\t\t\t\t\texportResult.base64, { type: \"application/zip\" });\r\n\r\n\t\t\t\t\tblob.saveAs(exportResult.filename);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic importProject(\r\n\t\tprojectFilePath: string,\r\n\t\treplace: ReplaceEnum,\r\n\t\tappId?: string\r\n\t): ng.IPromise<IJsonRuntimeMashup> {\r\n\t\tconst url = `${ServerPaths.ADMINISTRATION}import/${replace}/${appId ? appId : \"\"}`;\r\n\t\tconst data = { filePath: projectFilePath };\r\n\t\treturn this.httpService.executePost<IJsonRuntimeMashup>(url, data);\r\n\t}\r\n\r\n\tpublic saveProjectSetting(projectSettings: IProjectSetting, parts?: number, status?: number): ng.IPromise<any> {\r\n\t\treturn this.saveService.saveCurrent(projectSettings, parts, status);\r\n\t}\r\n\r\n\t/**\r\n\t * Activates a specific version of a project.\r\n\t * @param projectId\r\n\t * @param status\r\n\t * @param version\r\n\t */\r\n\tpublic activateProjectVersion(\r\n\t\tprojectId: string, status: AppStatus, version: string\r\n\t): ng.IPromise<IProjectSetting> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.ADMINISTRATION + `${projectId}/activate/${status}`, {\r\n\t\t\t\"version\": version,\r\n\t\t});\r\n\t}\r\n\r\n\tpublic deleteRuntimeApp(projectId: string): ng.IPromise<void> {\r\n\t\treturn this.httpService.executeDelete(ServerPaths.ADMINISTRATION + projectId);\r\n\t}\r\n\r\n\tpublic getRepositoryProject(projectId: string, selectedVersion: string): ng.IPromise<ProjectInfo> {\r\n\t\treturn this.httpService.executeGet(ServerPaths.ADMINISTRATION + `${projectId}/${selectedVersion}`, {\r\n\t\t\t\"version\": selectedVersion,\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.service(InjectNames.ADMINISTRATION_SERVICE, AdministrationService);\r\n\t}\r\n}\r\n","import { Config, DeveloperConstants, InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\n\r\nimport type { IJsonM3CloudData } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type {\r\n\tIIonApiContext,\r\n\tIIonApiOptions,\r\n\tIIonApiRequestOptions,\r\n} from \"ng2/common/model/ion-api/ion-api.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { HttpUtil } from \"common/services/http-utils\";\r\n\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport class IonApiContext implements IIonApiContext {\r\n\tconstructor(\r\n\t\tprivate url: string,\r\n\t\tprivate tenantId: string,\r\n\t\tprivate token: string\r\n\t) { }\r\n\r\n\tgetUrl(setTenant = true): string {\r\n\t\tif (setTenant) {\r\n\t\t\treturn this.url + \"/\" + this.tenantId;\r\n\t\t} else {\r\n\t\t\treturn this.url + Config.ION_API_ROOT;\r\n\t\t}\r\n\t}\r\n\r\n\tgetToken(): string {\r\n\t\treturn this.token;\r\n\t}\r\n\r\n\tsetToken(token: string): void {\r\n\t\tthis.token = token;\r\n\t}\r\n\r\n\tsetUrl(url: string): void {\r\n\t\tthis.url = url;\r\n\t}\r\n\r\n\tgetHeaderName(): string {\r\n\t\treturn \"Authorization\";\r\n\t}\r\n\r\n\tgetHeaderValue(): string {\r\n\t\treturn \"Bearer \" + this.token;\r\n\t}\r\n}\r\n\r\nexport class IonApiService {\r\n\r\n\tprivate get isDeveloperModeActive(): boolean {\r\n\t\treturn Config.IS_DEV && localStorage.getItem(DeveloperConstants.ION_PROXY) === \"true\";\r\n\t}\r\n\r\n\tprivate ionApiContext: IonApiContext;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate httpService: HttpService\r\n\t) {\r\n\t}\r\n\r\n\tgetIonApiContextAsync(options?: IIonApiOptions): ng.IPromise<IIonApiContext> {\r\n\t\tconst deferred = this.$q.defer<IIonApiContext>();\r\n\t\tconst refresh = options && options.refresh;\r\n\r\n\t\tif (Config.ION_API_URL) {\r\n\t\t\tconst hasToken = this.ionApiContext && this.ionApiContext.getToken();\r\n\t\t\tconst ionBaseURL = this.getIonBaseUrl();\r\n\r\n\t\t\tif (!hasToken || refresh) {\r\n\t\t\t\tconst tokenURL =\r\n\t\t\t\t\tthis.isDeveloperModeActive ?\r\n\t\t\t\t\t\t`${Config.REST_ROOT}/settings/token` :\r\n\t\t\t\t\t\t\"/grid/rest/security/sessions/oauth?forceRefresh=true\";\r\n\r\n\t\t\t\tthis.httpService.executeRequest<string>({ url: tokenURL, method: HttpVerbEnum.GET, cache: false })\r\n\t\t\t\t\t.then((response) => {\r\n\r\n\t\t\t\t\t\tconst token = DEV_SERVER ?\r\n\t\t\t\t\t\t\t(response.data as any).data :\r\n\t\t\t\t\t\t\tresponse.data;\r\n\r\n\t\t\t\t\t\tconst context = new IonApiContext(ionBaseURL, Config.TENANT_ID, token);\r\n\t\t\t\t\t\tthis.ionApiContext = context;\r\n\t\t\t\t\t\tdeferred.resolve(context);\r\n\t\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\t\tdeferred.reject(error);\r\n\t\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tif (this.ionApiContext.getUrl() !== ionBaseURL) {\r\n\t\t\t\t\tthis.ionApiContext.setUrl(ionBaseURL);\r\n\t\t\t\t}\r\n\t\t\t\tdeferred.resolve(this.ionApiContext);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdeferred.reject();\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate getIonBaseUrl(): string {\r\n\t\tconst proxyURL = `http://localhost:${Config.ION_API_PROXY_PORT}`;\r\n\r\n\t\t// Possible alternative to the proxy running in our own server, see grunt job ion-api-proxy\r\n\t\t//const proxyURL = \"https://localhost:8000\";\r\n\t\treturn this.isDeveloperModeActive ?\r\n\t\t\tproxyURL :\r\n\t\t\tConfig.ION_API_URL;\r\n\r\n\t}\r\n\r\n\texecuteIonApiAsync<T>(options: IIonApiRequestOptions): ng.IPromise<ng.IHttpPromiseCallbackArg<T>> {\r\n\t\tconst deferred = this.$q.defer<ng.IHttpPromiseCallbackArg<T>>();\r\n\t\tthis.getIonApiContextAsync().then((context: IIonApiContext) => {\r\n\t\t\tthis.executeIonApi(context, options, deferred, false);\r\n\t\t}).catch(r => {\r\n\t\t\tdeferred.reject(r);\r\n\t\t});\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\t/**\r\n\t * NOTE: Solution copied from lime (May 2017, HEAD at 2203077d3a3):\r\n\t *\thttp://git.infor.com/projects/ITECH/repos/homepages/browse/\r\n\t\t* Client/Framework/Framework/scripts/lime/app/container.ts#1034\r\n\t\t*/\r\n\tprivate executeIonApi<T>(\r\n\t\tcontext: IIonApiContext,\r\n\t\toptions: IIonApiRequestOptions,\r\n\t\tdeferred: ng.IDeferred<any>,\r\n\t\tisRetry: boolean\r\n\t): void {\r\n\t\tconst url = options.url;\r\n\t\tconst contextUrl = context.getUrl(options.setTenant);\r\n\t\tif (url && url.indexOf(\"https://\") !== 0 && url.indexOf(contextUrl) !== 0) {\r\n\t\t\t// Prepend the ION API base URL to the relative URL\r\n\t\t\toptions.url = HttpUtil.combine(contextUrl, url);\r\n\t\t}\r\n\r\n\t\t// Add the authorization header for ION API including the OAuth token.\r\n\t\tconst headers = options.headers || {};\r\n\t\theaders[context.getHeaderName()] = context.getHeaderValue();\r\n\t\toptions.headers = headers;\r\n\r\n\t\tthis.httpService.executeRequest(options).then((httpResponse: ng.IHttpResponse<any>) => {\r\n\t\t\t//M3 returns failures as 200 in some cases. Currently only covering M3 Cloud data.\r\n\t\t\tconst m3Data = httpResponse.data as unknown as IJsonM3CloudData;\r\n\t\t\tif (m3Data && m3Data.nrOfFailedTransactions && m3Data.nrOfFailedTransactions > 0) {\r\n\t\t\t\tconst modifiedHttpResponse = {\r\n\t\t\t\t\t...httpResponse,\r\n\t\t\t\t};\r\n\t\t\t\tmodifiedHttpResponse.data.error = {\r\n\t\t\t\t\tmessage: m3Data.results[0].errorMessage,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tdeferred.reject(modifiedHttpResponse);\r\n\t\t\t}\r\n\r\n\t\t\t// Resolve successful request.\r\n\t\t\tdeferred.resolve(httpResponse);\r\n\t\t}).catch((error: ng.IHttpResponse<any>) => {\r\n\t\t\tconst unauthorizedError = 401;\r\n\t\t\tconst isUnauthorized = error.status === unauthorizedError;\r\n\t\t\t// Check if the failed request should be retried with a new ION API context\r\n\t\t\tif (!isRetry && isUnauthorized && options.ionApiRetry !== false) {\r\n\t\t\t\tthis.getIonApiContextAsync({ refresh: true }).then((retryContext: IIonApiContext) => {\r\n\t\t\t\t\tthis.executeIonApi(retryContext, options, deferred, true);\r\n\t\t\t\t}).catch(retryError => {\r\n\t\t\t\t\t// Reject when a new context cannot be retrieved\r\n\t\t\t\t\tdeferred.reject(retryError);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t// Reject failed retry attemtps or when retry is disabled\r\n\t\t\t\tdeferred.reject(error);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.ION_API_SERVICE, IonApiService);\r\n\t}\r\n}\r\n","import { FeatureIdEnum } from \"ng2/common/constants/common.constant\";\r\nimport { FeatureSwitchService } from \"../../services/feature-switch-service\";\r\n\r\nexport abstract class FeatureSwitchCtrl {\r\n\r\n\tconstructor(\r\n\t\tprivate featureService: FeatureSwitchService\r\n\t) { }\r\n\r\n\tpublic isFeatureTranslationEnabled(): boolean {\r\n\t\t/*const isEnabled = this.featureService\r\n\t\t\t.isFeatureEnabled(FeatureIdEnum.TranslationService);*/\r\n\t\treturn true; //isEnabled;\r\n\t}\r\n\r\n\tpublic isFeatureCatalogEnabled(): boolean {\r\n\t\tconst isEnabled =\r\n\t\t\tthis.featureService.isFeatureEnabled(FeatureIdEnum.ShowFeatureCatalog);\r\n\t\treturn isEnabled;\r\n\t}\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IListDataItem extends IMap<any> {\r\n\tid?: string;\r\n}\r\n","import { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nexport interface IMetaData {\r\n\tinputFields: IMetaDataField[];\r\n\toutputFields: IMetaDataField[];\r\n}\r\n","export class DateHelper {\r\n\tprivate static MAX_TIMESTAMP = 8640000000000000;\r\n\tprivate static MIN_TIMESTAMP = -8640000000000000;\r\n\r\n\tstatic parse(value: string, date?: string, locale?: string): Date {\r\n\t\tlet datetime: Date;\r\n\r\n\t\tif (/\\d{8}\\s{1}\\d{2}:\\d{2}:\\d{2}.\\d{3}/g.exec(value)) {\r\n\t\t\t// IDO DateTime pattern\r\n\t\t\tconst datetimeParts = value.split(\" \");\r\n\t\t\tconst date = Soho.Locale.parseDate(datetimeParts[0], {\r\n\t\t\t\tpattern: \"yyyyMMdd\",\r\n\t\t\t});\r\n\t\t\tconst time = Soho.Locale.parseDate(datetimeParts[1], {\r\n\t\t\t\tpattern: \"HH:mm:ss.SSS\",\r\n\t\t\t});\r\n\t\t\tdatetime = new Date(\r\n\t\t\t\tdate.getFullYear(),\r\n\t\t\t\tdate.getMonth(),\r\n\t\t\t\tdate.getDate(),\r\n\t\t\t\ttime.getHours(),\r\n\t\t\t\ttime.getMinutes(),\r\n\t\t\t\ttime.getSeconds(),\r\n\t\t\t\ttime.getMilliseconds()\r\n\t\t\t);\r\n\t\t} else if (/\\/Date\\(\\d+\\+?\\d{4}\\)\\//.exec(value)) {\r\n\t\t\t// Mingle DateTime pattern\r\n\t\t\tconst milliseconds = /\\d+/.exec(value)[0];\r\n\t\t\tdatetime = new Date(parseInt(milliseconds));\r\n\t\t} else if (/^[0-9]{8}$/.exec(value)) {\r\n\t\t\t// M3 DateTime pattern\r\n\t\t\tdatetime = Soho.Locale.parseDate(value, { pattern: \"yyyyMMdd\" });\r\n\t\t} else if (/^\\d+$/.exec(value)) {\r\n\t\t\t// possibly milliseconds\r\n\t\t\tdatetime = new Date(parseFloat(value));\r\n\t\t} else {\r\n\t\t\tdatetime = new Date(value);\r\n\t\t}\r\n\r\n\t\treturn datetime;\r\n\t}\r\n\r\n\tstatic isValidMillisecondTimestamp(value: number): boolean {\r\n\t\treturn value < this.MAX_TIMESTAMP && value > this.MIN_TIMESTAMP;\r\n\t}\r\n\r\n\tstatic isValidDate(date: Date): boolean {\r\n\t\treturn !isNaN(date.getTime());\r\n\t}\r\n}\r\n","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\n\r\nimport { InstanceEvent } from \"common/instance-event\";\r\nimport { IProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport class TagService {\r\n\r\n\tprojectInfoChangedEvent = new InstanceEvent<IProjectInfo[]>();\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.HTTP_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprotected httpService: HttpService,\r\n\t) {\r\n\t}\r\n\r\n\t//TODO: extend this class for custom tags as well\r\n\r\n\tgetAvailableTags(): ng.IPromise<IJsonTag[]> {\r\n\t\treturn this.httpService.executeGet(\"tags/\");\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.TAG_SERVICE, TagService);\r\n\t}\r\n}\r\n","import { RegexStrings } from \"ng2/common/constants/common.constant\";\r\nimport { IParentAnnounce } from \"./notifiable-component\";\r\n\r\nimport { Helper } from \"../../helper\";\r\n\r\nexport interface IValidationResult {\r\n\tstatus: boolean;\r\n\terrorMessage?: string;\r\n}\r\n\r\nexport interface IFieldValidationResult {\r\n\tid?: string;\r\n\tstatus?: boolean;\r\n}\r\n\r\nexport interface IFieldValidationChangeObjects {\r\n\tvalidation?: angular.IChangesObject<IValidation>;\r\n\treadonly?: angular.IChangesObject<boolean>;\r\n\tid?: angular.IChangesObject<string>;\r\n\tparentAnnounce?: angular.IChangesObject<any>;\r\n\r\n}\r\nexport type ValidatorType\r\n\t= \"max-length\"\r\n\t| \"not-empty\"\r\n\t| \"min-length\"\r\n\t| \"numeric\"\r\n\t| \"numeric-no-negative\"\r\n\t| \"no-space\"\r\n\t| \"no-numeric\"\r\n\t| \"custom\";\r\n\r\nexport interface IValidator {\r\n\ttype: ValidatorType;\r\n\tvalue?: any;\r\n\tcustom?: {\r\n\t\tvalidator: Function;\r\n\t\terrorMessage: string;\r\n\t};\r\n}\r\n\r\nexport interface IValidatorError {\r\n\tid: string;\r\n\ttype: ValidatorType;\r\n\tmessage: string;\r\n\tfield: string;\r\n}\r\n\r\nexport interface IValidation {\r\n\tvalidators: IValidator[];\r\n\terrorList: IValidatorError[];\r\n}\r\n\r\nexport class FieldValidation implements ng.IController {\r\n\tpublic readonly DEFAULT_INPUT_FIELD_NAME: string = \"inputFieldName\";\r\n\r\n\t// NOTICE: Labelname should always be unique\r\n\t// bindings\r\n\tpublic id: string;\r\n\tpublic isRequired: boolean;\r\n\tpublic labelName: string;\r\n\tpublic fieldValue: string;\r\n\tpublic fieldName: string;\r\n\tpublic validation: IValidation;\r\n\r\n\tpublic parentAnnounce: IParentAnnounce[] = [];\r\n\r\n\tpublic isInvalid: boolean;\r\n\r\n\tpublic fieldSpecificErrors: IValidatorError[];\r\n\r\n\tpublic get displayStatus(): string {\r\n\t\treturn this.isInvalid ? \"block\" : \"none\";\r\n\t}\r\n\r\n\tpublic $onInit(): void {\r\n\t\t// Do something here with init\r\n\t\tif (Helper.isUndefinedEmpty(this.fieldName)) {\r\n\t\t\tthis.fieldName = this.DEFAULT_INPUT_FIELD_NAME;\r\n\t\t}\r\n\r\n\t\tif (this.validation) {\r\n\t\t\t// Set isRequired icon on label\r\n\t\t\tthis.isRequired = this.validation\r\n\t\t\t\t.validators\r\n\t\t\t\t.findIndex(item => item.type === \"not-empty\") !== -1;\r\n\r\n\t\t\tif (!Helper.isUndefinedEmpty(this.fieldValue)) {\r\n\t\t\t\tthis.validate();\r\n\t\t\t} else {\r\n\t\t\t\tthis.fieldValue = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic $onChanges(changeObjects: IFieldValidationChangeObjects): void {\r\n\t\tconst parentAnnounce = changeObjects.parentAnnounce;\r\n\t\tlet isCallback: boolean;\r\n\t\tif (\r\n\t\t\tparentAnnounce &&\r\n\t\t\t!parentAnnounce.isFirstChange() &&\r\n\t\t\tparentAnnounce.currentValue.id !== this.id // don't run it on self\r\n\t\t) {\r\n\t\t\tisCallback = true;\r\n\t\t} else if (\r\n\t\t\tparentAnnounce &&\r\n\t\t\t!parentAnnounce.isFirstChange() &&\r\n\t\t\tparentAnnounce.currentValue.id === this.id\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst currentComponentFieldError = this.fieldSpecificErrors;\r\n\t\tconst sharedError = this.validation?.errorList;\r\n\r\n\t\tif (!changeObjects.id?.isFirstChange() &&\r\n\t\t\tchangeObjects.id?.previousValue !== changeObjects.id?.currentValue) {\r\n\t\t\tthis.validate(isCallback);\r\n\t\t} else\r\n\t\t// if currentComponentFieldError is undefined it means it hasn't been validated yet\r\n\t\tif (changeObjects && changeObjects.validation && changeObjects.validation.isFirstChange() ||\r\n\t\t\t!currentComponentFieldError ||\r\n\t\t\t(currentComponentFieldError && currentComponentFieldError.length === 0)\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t// Uncomment to print debugging log\r\n\t\t// \t\t\t\tDebugger.log(this,\r\n\t\t// `$onChanges called on:\r\n\t\t// \tcurrentField=${this.fieldValue}, id=${this.id},\r\n\t\t// \tfieldError=${JSON.stringify(currentComponentFieldError)},\r\n\t\t// \tsharedError=${JSON.stringify(sharedError)}\r\n\t\t// \t\t\t\t`);\r\n\t\t\tconst customValidator = this.validation.validators\r\n\t\t\t\t.find(validator => validator.type === \"custom\");\r\n\r\n\t\t\t// if sharedList is empty means no error in any component\r\n\t\t\tif (sharedError && sharedError.length === 0) {\r\n\t\t\t\tcurrentComponentFieldError.length = 0;\r\n\t\t\t} else if (this.fieldValue !== \"\" && customValidator) {\r\n\t\t\t\t// only validate field if it's not empty and has custom validator\r\n\t\t\t\t// for now related field validation only for \"custom\" validators\r\n\t\t\t\tthis.validate(isCallback);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onComponentChange: Function;\r\n\r\n\t/**\r\n\t * Returns an error if the value cant go through the validators\r\n\t *\r\n\t * @private\r\n\t * @param {string} value\r\n\t * @param {IValidator} validator\r\n\t * @returns {(IValidatorError | undefined)}\r\n\t * @memberof FieldValidation\r\n\t */\r\n\tprivate getError(\r\n\t\tvalue: string,\r\n\t\tvalidator: IValidator,\r\n\t\tisCallback: boolean = false\r\n\t): IValidatorError | undefined {\r\n\t\tlet validatorError: IValidatorError;\r\n\t\tconst id = this.id;\r\n\r\n\t\tswitch (validator.type) {\r\n\t\t\tcase \"max-length\":\r\n\t\t\t\tif (value.length > validator.value) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Max length is \" + validator.value,\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"min-length\":\r\n\t\t\t\tif (value.length - 1 <= validator.value) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Min length is \" + validator.value,\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"not-empty\":\r\n\t\t\t\tif (value.length === 0) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Field cannot be empty\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"numeric\":\r\n\t\t\t\tif (!Helper.isUndefinedEmpty(value) &&\r\n\t\t\t\t\t!RegexStrings.NUMERIC.test(value)\r\n\t\t\t\t) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Field has to be a number\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"no-numeric\":\r\n\t\t\t\t// RegexStrings.NO_NUMERIC behaves weird here, therefore I add the regex directly\r\n\t\t\t\tif (!Helper.isUndefinedEmpty(value) && (/\\d+/g).test(value)) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Field cannot contain numbers\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"numeric-no-negative\":\r\n\t\t\t\tif (!Helper.isUndefinedEmpty(value) &&\r\n\t\t\t\t\t!RegexStrings.NUMERIC_NO_NEGATIVE.test(value)\r\n\t\t\t\t) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Field has to be a positive number\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"no-space\":\r\n\t\t\t\tif (value.indexOf(\" \") !== -1) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName,\r\n\t\t\t\t\t\tmessage: \"Name cannot contain spaces\",\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"custom\":\r\n\t\t\t\tlet result: boolean | IValidationResult;\r\n\t\t\t\tconst target = validator.custom.validator;\r\n\r\n\t\t\t\tif (typeof target === \"function\") {\r\n\t\t\t\t\tresult = target(value, this.id);\r\n\t\t\t\t} else if (typeof target === \"string\") {\r\n\t\t\t\t\tif (target === \"void\") {\r\n\t\t\t\t\t\tthis.onComponentChange({\r\n\t\t\t\t\t\t\t$data: {\r\n\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresult = this.onComponentChange({\r\n\t\t\t\t\t\t\t$data: {\r\n\t\t\t\t\t\t\t\tvalidator: target,\r\n\t\t\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\t\tcallback: isCallback\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (typeof result === \"boolean\" && result === false) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName ? this.labelName : this.id,\r\n\t\t\t\t\t\tmessage: validator.custom.errorMessage,\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t} else if (this.isValidationResult(result) && result.status === false) {\r\n\t\t\t\t\tvalidatorError = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tfield: this.labelName ? this.labelName : this.id,\r\n\t\t\t\t\t\tmessage: result.errorMessage,\r\n\t\t\t\t\t\ttype: validator.type\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn validatorError;\r\n\t}\r\n\r\n\t/**\r\n\t * Validate if object is IValdationResult\r\n\t * @param object\r\n\t */\r\n\tprivate isValidationResult(object: any): object is IValidationResult {\r\n\t\treturn typeof object === \"object\" &&\r\n\t\t\t\"status\" in object &&\r\n\t\t\t\"errorMessage\" in object;\r\n\t}\r\n\r\n\t/**\r\n\t * Remove all the errors, in the shared errorlist, that are related to this component\r\n\t *\r\n\t * @private\r\n\t * @memberof FieldValidation\r\n\t */\r\n\tprivate removeFieldRelatedErrorsFromErrorList(): void {\r\n\t\tconst sharedErrors = this.validation.errorList;\r\n\t\tif (sharedErrors) {\r\n\t\t\tsharedErrors.forEach((error, index) => {\r\n\t\t\t\tif (error.id === this.id &&\r\n\t\t\t\t\t(error.field === this.labelName || error.field === this.id)\r\n\t\t\t\t) {\r\n\t\t\t\t\tsharedErrors.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Used to validate the field based on the validation object\r\n\t *\r\n\t * @memberof FieldValidation\r\n\t */\r\n\tpublic validate(isCallback: boolean = false): void {\r\n\t\t// Reset all the validator values\r\n\t\tthis.isInvalid = false;\r\n\t\tthis.fieldSpecificErrors = [];\r\n\t\tthis.removeFieldRelatedErrorsFromErrorList();\r\n\r\n\t\tconst sharedErrors = this.validation.errorList;\r\n\t\tconst hasFieldValue = !Helper.isUndefinedOrNull(this.fieldValue);\r\n\r\n\t\tif (hasFieldValue) {\r\n\t\t\tthis.validation.validators.forEach((validator: IValidator) => {\r\n\r\n\t\t\t\tconst validatorError =\r\n\t\t\t\t\tthis.getError(this.fieldValue, validator, isCallback);\r\n\t\t\t\tif (validatorError) {\r\n\t\t\t\t\tthis.fieldSpecificErrors.push(validatorError);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Do we have errors? Then this is invalid\r\n\t\tif (this.fieldSpecificErrors.length !== 0) {\r\n\t\t\tthis.isInvalid = true;\r\n\t\t}\r\n\r\n\t\t// Push all the new errors to the shared errorlist\r\n\t\tif (sharedErrors) {\r\n\t\t\tif (this.fieldSpecificErrors.length !== 0) {\r\n\t\t\t\tthis.fieldSpecificErrors.forEach((error) => {\r\n\t\t\t\t\tsharedErrors.push(error);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import { Helper } from \"../helper\";\r\n\r\nimport { CustomFormatters } from \"./custom-formatters\";\r\nimport { LocaleHelper } from \"./locale-helper\";\r\n\r\nimport { GridAggregators } from \"ng2/common/constants/common.constant\";\r\nimport { DateFormatEnum, FormatterEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport type { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport type { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type {\r\n\tIColumnOptions,\r\n\tIDataGridColumn,\r\n\tIDatagridColumnArgs,\r\n\tIDataItem,\r\n} from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport type { IFilterExpression, IPageRequest } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\n\r\nexport interface IExpandedRowItem<T> {\r\n\titem: T;\r\n}\r\nexport interface IRowItem<T> {\r\n\tdata: T;\r\n\telem: any; // JQuery Element\r\n\tidx: number;\r\n}\r\n\r\nexport class DatagridHelper {\r\n\tstatic getPage<T>(dataset: T[], pageRequest: IPageRequest): T[] {\r\n\t\tpageRequest.total = dataset.length;\r\n\t\tif (dataset.length > pageRequest.pagesize) {\r\n\t\t\treturn dataset.slice(\r\n\t\t\t\t(pageRequest.activePage - 1) * pageRequest.pagesize, pageRequest.activePage * pageRequest.pagesize);\r\n\t\t} else {\r\n\t\t\tpageRequest.total = dataset.length;\r\n\t\t\treturn dataset;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static normalizeValue(value: any): string {\r\n\t\tif (value) {\r\n\t\t\treturn value.toString().toLowerCase();\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tstatic sortDatasetByField<T>(dataset: T[], sortField: string, sortAsc: boolean): T[] {\r\n\t\tdataset = dataset.sort((itemA: T, itemB: T) => {\r\n\t\t\tconst a = this.normalizeValue(Helper.getDeepValue(itemA, sortField));\r\n\t\t\tconst b = this.normalizeValue(Helper.getDeepValue(itemB, sortField));\r\n\t\t\tif (a < b) {\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tif (a > b) {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\treturn sortAsc ? dataset : dataset.reverse();\r\n\t}\r\n\r\n\t/**\r\n\t * Filters dataset on path\r\n\t * @param dataset\r\n\t * @param filterExpression\r\n\t * @param paths\r\n\t */\r\n\tstatic getSearchResultOnPaths<T>(\r\n\t\tdataset: T[],\r\n\t\tfilterExpression: IFilterExpression,\r\n\t\tpaths: string\r\n\t): T[] {\r\n\r\n\t\tdataset.forEach(DatagridHelper.clearSohoProperties);\r\n\r\n\t\treturn dataset.filter((item: T) => {\r\n\t\t\tconst deepValue = Helper.getDeepValue(item, paths);\r\n\t\t\tif (deepValue) {\r\n\t\t\t\treturn deepValue.toLowerCase().indexOf(filterExpression.value) !== -1;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Filters dataset on keyword\r\n\t * @param dataset\r\n\t * @param filterExpression\r\n\t */\r\n\tstatic getSearchResultOnKeyword<T>(\r\n\t\tdataset: T[],\r\n\t\tfilterExpression: IFilterExpression\r\n\t): T[] {\r\n\r\n\t\tconst result = dataset.filter((item: T) => {\r\n\t\t\tfor (const key in item) {\r\n\t\t\t\tconst value = item[key];\r\n\t\t\t\tif (typeof value === \"string\" &&\r\n\t\t\t\t\tvalue.toLowerCase().indexOf(filterExpression.value) !== -1\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Sometime Soho adds properties to row items which should not tag along.\r\n\t * This method will remove those properties.\r\n\t * @param item item\r\n\t */\r\n\tstatic clearSohoProperties(item: IDataItem): void {\r\n\t\tdelete item.isFiltered;\r\n\t\tdelete item._selected;\r\n\t\tdelete item._isFilteredOut;\r\n\t}\r\n\r\n\tstatic setEditableOnColumn(\r\n\t\tcolumn: IExtendedDataGridColumn,\r\n\t\tlocale?: string\r\n\t): void {\r\n\t\tif (column.editable) {\r\n\t\t\tdelete column.editorOptions;\r\n\r\n\t\t\tswitch (column.formatterName) {\r\n\t\t\t\tcase FormatterEnum.Checkbox:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Checkbox;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Date:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Date;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Time:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Time;\r\n\t\t\t\t\tcolumn.editorOptions = {\r\n\t\t\t\t\t\ttimeFormat: Soho.Locale.cultures[locale].calendars[0].dateFormat.timestamp,\r\n\t\t\t\t\t\tminuteInterval: 5,\r\n\t\t\t\t\t\tsecondInterval: 5,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Datetime:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Date;\r\n\t\t\t\t\tcolumn.editorOptions = {\r\n\t\t\t\t\t\ttimeFormat: column.timeFormat,\r\n\t\t\t\t\t\tdateFormat: column.dateFormat,\r\n\t\t\t\t\t\tshowTime: true,\r\n\t\t\t\t\t} as any;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Hyperlink:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Input;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Textarea:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Textarea;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Button:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Button;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Dropdown:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Dropdown;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Autocomplete:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Autocomplete;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Lookup:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Lookup;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tcolumn.editor = Soho.Editors.Input;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcolumn.editor = null;\r\n\t\t}\r\n\t\tcolumn.isEditable = () => {\r\n\t\t\treturn column.editable;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic setColumnSettings(\r\n\t\tcolumn: IExtendedDataGridColumn,\r\n\t\tlocale: string,\r\n\t): void {\r\n\t\t// reset column\r\n\t\tdelete column.dateFormat;\r\n\t\tdelete column.href;\r\n\t\tdelete column.click;\r\n\t\tdelete column.editorOptions;\r\n\t\tdelete column.options;\r\n\t\tcolumn.textOverflow = FormatterEnum.Ellipsis;\r\n\r\n\t\tthis.setFormatterOnColumns(column, locale);\r\n\t\tthis.setEditableOnColumn(column, locale);\r\n\t}\r\n\r\n\tstatic setFormatterOnColumns(\r\n\t\tcolumn: IExtendedDataGridColumn,\r\n\t\tlocale: string): void {\r\n\t\tif (column.formatterName) {\r\n\t\t\tswitch (column.formatterName) {\r\n\t\t\t\tcase FormatterEnum.Checkbox:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Checkbox;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Checkbox;\r\n\t\t\t\t\tcolumn.isChecked = (value: string | number | boolean) => {\r\n\t\t\t\t\t\tif (jQuery.isNumeric(value) && typeof value === \"string\") {\r\n\t\t\t\t\t\t\treturn parseInt(value, 10) === 1;\r\n\t\t\t\t\t\t} else if (typeof value === \"boolean\") {\r\n\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t} else if (typeof value === \"string\") {\r\n\t\t\t\t\t\t\treturn value.toLowerCase() === \"true\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Date:\r\n\t\t\t\t\tcolumn.formatter = CustomFormatters.Date(locale);\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Date;\r\n\t\t\t\t\tcolumn.dateFormat = LocaleHelper.getDateFormat(DateFormatEnum.Short, locale);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Hyperlink:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Hyperlink;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Hyperlink;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Integer:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Integer;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Integer;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Decimal:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Decimal;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Decimal;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Textarea:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Textarea;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Textarea;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Datetime:\r\n\t\t\t\t\tcolumn.formatter = CustomFormatters.Datetime(locale);\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Datetime;\r\n\r\n\t\t\t\t\tcolumn.dateFormat = LocaleHelper.getDateFormat(DateFormatEnum.Short, locale);\r\n\t\t\t\t\tcolumn.timeFormat = LocaleHelper.getDateFormat(DateFormatEnum.Timeformat, locale);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Time:\r\n\t\t\t\t\tcolumn.formatter = CustomFormatters.Time(locale);\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Time;\r\n\t\t\t\t\tcolumn.dateFormat = LocaleHelper.getDateFormat(DateFormatEnum.Timestamp, locale);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Button:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Button;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Button;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Dropdown:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Dropdown;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Dropdown;\r\n\t\t\t\t\tdelete column.textOverflow;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Autocomplete:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Autocomplete;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Autocomplete;\r\n\t\t\t\t\tdelete column.textOverflow;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.Lookup:\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Lookup;\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.Lookup;\r\n\t\t\t\t\tdelete column.textOverflow;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.SelectionCheckbox: //used for multi selection\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.SelectionCheckbox;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase FormatterEnum.AbsoluteValue:\r\n\t\t\t\t\tcolumn.formatter = CustomFormatters.AbsoluteValue();\r\n\t\t\t\t\tcolumn.formatterName = FormatterEnum.AbsoluteValue;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error(\"Error: Formatter does not exist.\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic ToggleSummarizeOnColumn(column: IExtendedDataGridColumn): void {\r\n\t\tif (!column.summarize) {\r\n\t\t\tcolumn.summaryRowFormatter = Soho.Formatters.SummaryRow;\r\n\t\t\tcolumn.aggregator = GridAggregators.SUM;\r\n\t\t} else {\r\n\t\t\tcolumn.summaryRowFormatter = null;\r\n\t\t\tcolumn.aggregator = null;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic convertDatetimeToTicks(selectedRow: IDatagridColumnArgs<any>, locale: string): number {\r\n\t\tconst column = selectedRow.column as IExtendedDataGridColumn;\r\n\t\tconst calendar = Soho.Locale.cultures[locale].calendars[0];\r\n\t\tconst formatterName = column.formatterName;\r\n\r\n\t\tconst oldDate = DateHelper.parse(selectedRow.oldValue, formatterName, locale);\r\n\t\tconst parseOption: IFormateDateOptions = {};\r\n\t\tlet date: Date;\r\n\r\n\t\tswitch (formatterName) {\r\n\t\t\tcase FormatterEnum.Date: {\r\n\t\t\t\tconst short = \"short\";\r\n\t\t\t\tparseOption.pattern = calendar.dateFormat[short];\r\n\t\t\t\tdate = Soho.Locale.parseDate(selectedRow.value, parseOption);\r\n\t\t\t\tdate.setHours(oldDate.getHours());\r\n\t\t\t\tdate.setMinutes(oldDate.getMinutes());\r\n\t\t\t\tdate.setSeconds(oldDate.getSeconds());\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase FormatterEnum.Time: {\r\n\t\t\t\tconst timestamp = \"timestamp\";\r\n\t\t\t\tparseOption.pattern = calendar.dateFormat[timestamp];\r\n\t\t\t\tdate = Soho.Locale.parseDate(selectedRow.value, parseOption);\r\n\t\t\t\tdate.setFullYear(oldDate.getFullYear());\r\n\t\t\t\tdate.setMonth(oldDate.getMonth());\r\n\t\t\t\tdate.setDate(oldDate.getDate());\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tcase FormatterEnum.Datetime:\r\n\t\t\t\tparseOption.pattern = calendar.dateFormat[formatterName];\r\n\t\t\t\tdate = Soho.Locale\r\n\t\t\t\t\t.parseDate(selectedRow.value, parseOption);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t}\r\n\r\n\t\treturn date.getTime();\r\n\t}\r\n\r\n\tstatic addColumnData(column: IExtendedDataGridColumn, listResult: any[], dataservice: IDatasource): string[] {\r\n\t\tconst autocompleteSource: string[] = [];\r\n\t\tswitch (column.formatterName) {\r\n\t\t\tcase FormatterEnum.Dropdown: {\r\n\t\t\t\tconst dropdownOptions: IColumnOptions[] = [];\r\n\t\t\t\tlistResult.forEach((listItem, index) => {\r\n\t\t\t\t\tdropdownOptions.push({\r\n\t\t\t\t\t\tid: \"optionID\" + index,\r\n\t\t\t\t\t\tvalue: listItem[column.listOptions.parameterId],\r\n\t\t\t\t\t\tlabel: listItem[column.listOptions.parameterId]\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tcolumn.options = dropdownOptions;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tcase FormatterEnum.Autocomplete:\r\n\t\t\t\tlistResult.forEach((listItem) => {\r\n\t\t\t\t\tautocompleteSource.push(listItem[column.listOptions.parameterId]);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase FormatterEnum.Lookup: {\r\n\t\t\t\tconst lookupData = listResult;\r\n\t\t\t\tconst lookupColumns: IDataGridColumn[] = [];\r\n\r\n\t\t\t\tconst outputParams = (dataservice.getDatabearer() as IJsonGenericDatasource2).outputParameters;\r\n\t\t\t\toutputParams.forEach((outputParam) => {\r\n\t\t\t\t\tlookupColumns.push({\r\n\t\t\t\t\t\tid: outputParam.id,\r\n\t\t\t\t\t\tname: outputParam.key,\r\n\t\t\t\t\t\tfield: outputParam.id\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tconst lookupOptions = {\r\n\t\t\t\t\tfield: (row: IMap<string>) => {\r\n\t\t\t\t\t\tconst match = row[column.listOptions.parameterId];\r\n\t\t\t\t\t\tif (!match) {\r\n\t\t\t\t\t\t\tconsole.warn(\"Warning: No current match to dataset.\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn match;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmatch: () => {\r\n\t\t\t\t\t\t// fake method\r\n\t\t\t\t\t},\r\n\t\t\t\t\toptions: {\r\n\t\t\t\t\t\tcolumns: lookupColumns,\r\n\t\t\t\t\t\tdataset: lookupData,\r\n\t\t\t\t\t\tselectable: \"single\"\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tcolumn.editorOptions = lookupOptions;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tdefault:\r\n\t\t\t\t// formatter not exists, should not happen\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn autocompleteSource;\r\n\t}\r\n}\r\n","// MUPS-2682: Rename file to project.model.ts\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IRole extends IMap<string> {\r\n\tgroupId: string; // name\r\n\tdisplayName: string; // description\r\n}\r\n\r\nexport interface IProjectRole extends IMap<string> {\r\n\tid?: string;\r\n\tname: string; // name\r\n\ttype?: string;\r\n}\r\n","// FIXME: Find out what InjectNames.BUILD_ENV_CONSTANT and how it is used\r\n// MUPS-2682: remove hash-service?\r\n\r\nimport {\r\n\tAppEnvType,\r\n\tAppEnvTypes,\r\n\tBuildEnvType,\r\n\tBuildEnvTypes,\r\n\tConfig,\r\n\tInjectNames,\r\n} from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport interface IHashResponse {\r\n\tdata?: any;\r\n}\r\n\r\nexport enum HashSources {\r\n\tDESIGNER_HASH_SRC = \"cache-bust-map-designer.json\",\r\n\tRUNTIME_HASH_SRC = \"cache-bust-map-runtime.json\",\r\n}\r\n\r\nexport enum HashSourceTypes {\r\n\tDESIGNER = \"designer\",\r\n\tRUNTIME = \"runtime\",\r\n}\r\n\r\nexport type HashSourceType = HashSourceTypes.DESIGNER | HashSourceTypes.RUNTIME;\r\n\r\nexport class HashService {\r\n\tprivate designerMapOfHashes: IMap<string>;\r\n\tprivate runtimeMapOfHashes: IMap<string>;\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\t// InjectNames.BUILD_ENV_CONSTANT,\r\n\t\t// InjectNames.APP_ENV_CONSTANT,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate buildEnv: BuildEnvType,\r\n\t\tprivate appEnv: AppEnvType\r\n\t) {\r\n\t\t// TODO: MUPS-2682: Fix this\r\n\t\tthis.buildEnv = BuildEnvTypes.DEV;\r\n\t\tthis.appEnv = AppEnvTypes.DESIGNER;\r\n\r\n\t\tif (this.appEnv === AppEnvTypes.DESIGNER) {\r\n\t\t\tthis.getHashDataSrc(HashSourceTypes.DESIGNER).then((response: IHashResponse) => {\r\n\t\t\t\tthis.designerMapOfHashes = response.data;\r\n\t\t\t});\r\n\t\t} else if (this.appEnv === AppEnvTypes.RUNTIME) {\r\n\t\t\tthis.getHashDataSrc(HashSourceTypes.RUNTIME).then((response: IHashResponse) => {\r\n\t\t\t\tthis.runtimeMapOfHashes = response.data;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// switch (this.appEnv) {\r\n\t\t// \tcase AppEnvTypes.DESIGNER:\r\n\t\t// \t\tthis.getHashDataSrc(HashSourceTypes.DESIGNER).then((response: IHashResponse) => {\r\n\t\t// \t\t\tthis.designerMapOfHashes = response.data;\r\n\t\t// \t\t});\r\n\t\t// \t\tbreak;\r\n\t\t// \tcase AppEnvTypes.RUNTIME:\r\n\t\t// \t\tthis.getHashDataSrc(HashSourceTypes.RUNTIME).then((response: IHashResponse) => {\r\n\t\t// \t\t\tthis.runtimeMapOfHashes = response.data;\r\n\t\t// \t\t});\r\n\t\t// \t\tbreak;\r\n\t\t// \tdefault:\r\n\t\t// \t\tbreak;\r\n\t\t// }\r\n\t}\r\n\r\n\t/**\r\n\t * Use to get any hash for a file. Mainly used in production\r\n\t * The srcString needs to be in the format of:\r\n\t *\r\n\t * /WSWebClient/dynamic/metadata/appbuilder/ || WSWebClient/dynamic/metadata/appbuilder/\r\n\t * OR\r\n\t * /WSWebClient/dynamic/metadata/appruntime/ || WSWebClient/dynamic/metadata/appruntime/\r\n\t *\r\n\t *\tExample:\r\n\t\t* \t/WSWebClient/dynamic/metadata/appbuilder/assets/xi/light-theme.css\r\n\t\t* \twill return\r\n\t\t* \t/WSWebClient/dynamic/metadata/appbuilder/assets/xi/light-theme.myHash123adfs.css\r\n\t\t*\r\n\t\t* @param {string} srcString\r\n\t\t* @param {HashSourceType} hashSrc\r\n\t\t* @returns {ng.IPromise<string>}\r\n\t\t* @memberof HashService\r\n\t\t*/\r\n\tgetHashFromMapOfHashes(srcString: string, hashSrc: HashSourceType): ng.IPromise<string> {\r\n\t\tconst formattedSrcString = srcString.replace(/^\\//, \"\"); // rm the \"/\" for proper checkup in json structure\r\n\t\tconst getHash = () => {\r\n\t\t\tswitch (hashSrc) {\r\n\t\t\t\tcase HashSourceTypes.DESIGNER:\r\n\t\t\t\t\treturn this.getHashFromHashDataDesigner(formattedSrcString);\r\n\t\t\t\tcase HashSourceTypes.RUNTIME:\r\n\t\t\t\t\treturn this.getHashFromHashDataRuntime(formattedSrcString);\r\n\t\t\t\tdefault: // Did not find any source that has that hash. Just give back the formatted value\r\n\t\t\t\t\treturn this.q.resolve(formattedSrcString);\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn getHash()\r\n\t\t\t// Re-add the \"/\" that we removed at the beginning\r\n\t\t\t.then((newSrcString) => \"/\" + newSrcString)\r\n\t\t\t// If there are any errors, just send back the original srcString\r\n\t\t\t.catch((err: any) => srcString);\r\n\t}\r\n\r\n\t/**\r\n\t * Use to get all hash for every hashed asset.\r\n\t */\r\n\tgetHashMap(): IMap<string> {\r\n\t\tswitch (this.appEnv) {\r\n\t\t\tcase AppEnvTypes.DESIGNER:\r\n\t\t\t\treturn this.designerMapOfHashes;\r\n\t\t\tcase AppEnvTypes.RUNTIME:\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.runtimeMapOfHashes;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getHashFromHashDataDesigner(srcString: string): ng.IPromise<string> {\r\n\t\tif (this.designerMapOfHashes) {\r\n\t\t\treturn this.q.resolve(\r\n\t\t\t\tthis.getValueFromMapAndParseToMongooseAssetsPath(this.designerMapOfHashes, srcString) || srcString);\r\n\t\t} else {\r\n\t\t\treturn this.getHashDataSrc(HashSourceTypes.DESIGNER).then((response: IHashResponse) => {\r\n\t\t\t\tthis.designerMapOfHashes = response.data;\r\n\t\t\t\treturn this.getValueFromMapAndParseToMongooseAssetsPath(this.designerMapOfHashes, srcString) || srcString;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getValueFromMapAndParseToMongooseAssetsPath(mapWithHashes: IMap<string>, key: string): string {\r\n\t\tlet result = \"\";\r\n\t\tfor (const value in mapWithHashes) {\r\n\t\t\tif (key.indexOf(value) > 0) {\r\n\t\t\t\tresult = key.replace(value, mapWithHashes[value]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate getHashFromHashDataRuntime(srcString: string): ng.IPromise<string> {\r\n\t\tif (this.runtimeMapOfHashes) {\r\n\t\t\treturn this.q.resolve(\r\n\t\t\t\tthis.getValueFromMapAndParseToMongooseAssetsPath(this.runtimeMapOfHashes, srcString) || srcString);\r\n\t\t} else {\r\n\t\t\treturn this.getHashDataSrc(HashSourceTypes.RUNTIME).then((response: IHashResponse) => {\r\n\t\t\t\tthis.runtimeMapOfHashes = response.data;\r\n\t\t\t\treturn this.getValueFromMapAndParseToMongooseAssetsPath(this.runtimeMapOfHashes, srcString) || srcString;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getHashDataSrc(hashSrc: HashSourceType): ng.IPromise<IHashResponse> {\r\n\t\tif (this.buildEnv === BuildEnvTypes.DEV) {\r\n\t\t\treturn this.q.resolve({\r\n\t\t\t\tdata: {}\r\n\t\t\t});\r\n\t\t}\r\n\t\tlet src = \"\";\r\n\t\tswitch (hashSrc) {\r\n\t\t\tcase HashSourceTypes.DESIGNER:\r\n\t\t\t\tsrc = Config.APP_ROOT + HashSources.DESIGNER_HASH_SRC;\r\n\t\t\t\tbreak;\r\n\t\t\tcase HashSourceTypes.RUNTIME:\r\n\t\t\t\tsrc = Config.APP_ROOT + HashSources.RUNTIME_HASH_SRC;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this.httpService.executeRequest<IHashResponse>({ method: \"GET\", url: src });\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.HASH_SERVICE, HashService);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { ErrorResponse, IErrorResponse } from \"../error-response\";\r\nimport { Helper } from \"../helper\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions,\r\n\tIDialogResult, IMessageDialogOptions, StandardDialogButtons\r\n} from \"./dialog-service\";\r\n\r\nexport enum ConflictResolutionEnum { REPLACE = 1, COPY = 2, SKIP = 3 }\r\n\r\nexport interface IConflictObject {\r\n\tobjectName: string;\r\n\tconflictedString: string;\r\n\toccupiedStrings: string[];\r\n\tremainingCount: number;\r\n\tlastAction: ConflictResolutionEnum;\r\n\tmaxItems: number;\r\n}\r\n\r\nexport interface IConflictResult {\r\n\taction: ConflictResolutionEnum;\r\n\tsameForRemaining: boolean;\r\n\tnewName: string;\r\n}\r\n\r\nexport interface IResolutionResult<T> {\r\n\ttoRemove: T[];\r\n\ttoAdd: T[];\r\n}\r\n\r\ninterface IConflictResolution<T> {\r\n\tobject: T;\r\n\tresolution: ConflictResolutionEnum;\r\n\tnewName: string;\r\n}\r\n\r\ninterface ISplitConflict<T> {\r\n\tconflicting: T[];\r\n\tnotConflicting: T[];\r\n}\r\n\r\nexport class ConflictResolutonService {\r\n\tpublic maxItems: number = 0;\r\n\tprivate conflictKey: string;\r\n\tprivate occupiedStrings: string[];\r\n\tprivate objectName: string;\r\n\tprivate conflictingObjects: any[];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\r\n\t}\r\n\r\n\tpublic resolve<T>(\r\n\t\tnewObjects: T[],\r\n\t\tcurrentObjects: T[],\r\n\t\tconflictKey: string,\r\n\t\tobjectName: string,\r\n\t\tmaxItems: number\r\n\t): ng.IPromise<IResolutionResult<T>> {\r\n\t\tthis.objectName = objectName;\r\n\t\tthis.maxItems = maxItems;\r\n\t\tthis.conflictKey = conflictKey;\r\n\t\tthis.occupiedStrings = currentObjects.map((object) => {\r\n\t\t\treturn Helper.getDeepValue(object, conflictKey);\r\n\t\t});\r\n\r\n\t\tconst splitConflicting = this.splitConflicting(newObjects, currentObjects);\r\n\t\tthis.conflictingObjects = splitConflicting.conflicting;\r\n\t\tthis.occupiedStrings = this.occupiedStrings.concat(splitConflicting.notConflicting.map((notConflicting) => {\r\n\t\t\treturn Helper.getDeepValue(notConflicting, conflictKey);\r\n\t\t}));\r\n\r\n\t\tconst deferredResolutions = this.$q.defer<IResolutionResult<T>>();\r\n\t\tif (this.conflictingObjects.length > 0) {\r\n\t\t\tthis.resolveNextConflict<T>().then((resolutions) => {\r\n\t\t\t\tconst resolutionResult = this.applyResolutions(resolutions, currentObjects);\r\n\t\t\t\tresolutionResult.toAdd = resolutionResult.toAdd.concat(splitConflicting.notConflicting);\r\n\t\t\t\tdeferredResolutions.resolve(resolutionResult);\r\n\t\t\t}).catch((e: IErrorResponse) => {\r\n\t\t\t\tdeferredResolutions.reject(e.message);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tdeferredResolutions.resolve({\r\n\t\t\t\ttoRemove: [],\r\n\t\t\t\ttoAdd: newObjects\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn deferredResolutions.promise;\r\n\t}\r\n\r\n\tpublic checkIfInvalidImportedItems <T>(errorText: string, importedItems?: T[]): ng.IPromise<IMessageDialogOptions> {\r\n\t\tconst deferred = this.$q.defer<IMessageDialogOptions>();\r\n\r\n\t\tif (!importedItems) {\r\n\t\t\tdeferred.resolve();\r\n\t\t\treturn deferred.promise;\r\n\t\t}\r\n\r\n\t\tconst failedItems = importedItems.some((item: T) => {\r\n\t\t\treturn item ? false : true;\r\n\t\t});\r\n\r\n\t\tif (failedItems) {\r\n\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\ttitle: \"Import Project\",\r\n\t\t\t\tmessage: `One or more ${errorText} was not imported due to error in them`,\r\n\t\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\t\tisError: true,\r\n\t\t\t};\r\n\t\t\tdeferred.reject(options);\r\n\t\t\treturn deferred.promise;\r\n\t\t} else {\r\n\t\t\tdeferred.resolve();\r\n\t\t\treturn deferred.promise;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate splitConflicting<T>(newObjects: T[], oldObjects: T[]): ISplitConflict<T> {\r\n\t\tconst conflicting: T[] = [];\r\n\t\tconst notConflicting: T[] = [];\r\n\t\tnewObjects.forEach((newObject) => {\r\n\t\t\tconst hasDisplayNameConflict = oldObjects.some((existingObject) => {\r\n\t\t\t\treturn this.getConflictString(existingObject) === this.getConflictString(newObject);\r\n\t\t\t});\r\n\t\t\thasDisplayNameConflict ? conflicting.push(newObject) : notConflicting.push(newObject);\r\n\t\t});\r\n\t\treturn { conflicting: conflicting, notConflicting: notConflicting };\r\n\t}\r\n\r\n\tprivate getConflictString(object: any): string {\r\n\t\treturn Helper.getDeepValue(object, this.conflictKey);\r\n\t}\r\n\r\n\tprivate resolveConflictDialog(\r\n\t\tconflictedString: string,\r\n\t\tindex: number,\r\n\t\tconflictCount: number,\r\n\t\tlastAction: ConflictResolutionEnum\r\n\t): ng.IPromise<IDialogResult<IConflictResult>> {\r\n\t\tconst options: IDialogOptions<IConflictObject> = {\r\n\t\t\ttitle: \"Name Conflict (\" + (index + 1) + \"/\" + conflictCount + \")\",\r\n\t\t\ttemplate: require(\"../dialogs/import-conflict/conflict-decision-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tobjectName: this.objectName,\r\n\t\t\t\tconflictedString: conflictedString,\r\n\t\t\t\toccupiedStrings: this.occupiedStrings,\r\n\t\t\t\tlastAction: lastAction,\r\n\t\t\t\tremainingCount: conflictCount - (index + 1),\r\n\t\t\t\tmaxItems: this.maxItems\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn this.dialogService.show(options);\r\n\t}\r\n\r\n\tprivate resolveNextConflict<T>(\r\n\t\tlastAction: ConflictResolutionEnum = ConflictResolutionEnum.REPLACE,\r\n\t\tindex: number = 0): ng.IPromise<IConflictResolution<T>[]> {\r\n\t\tconst deferredResolutionChoice = this.$q.defer<IConflictResolution<T>[]>();\r\n\t\tconst currentObject = this.conflictingObjects[index];\r\n\r\n\t\tthis.resolveConflictDialog(\r\n\t\t\tthis.getConflictString(currentObject),\r\n\t\t\tindex,\r\n\t\t\tthis.conflictingObjects.length,\r\n\t\t\tlastAction\r\n\t\t).then((result) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Ok) {\r\n\t\t\t\tconst nextIndex = index + 1;\r\n\t\t\t\tconst dialogValue = result.value;\r\n\t\t\t\tconst resolutions: IConflictResolution<T>[] = [];\r\n\t\t\t\tresolutions.push({ object: currentObject, resolution: dialogValue.action, newName: dialogValue.newName });\r\n\t\t\t\tif (dialogValue.action === ConflictResolutionEnum.COPY) {\r\n\t\t\t\t\tthis.occupiedStrings.push(dialogValue.newName);\r\n\t\t\t\t} else if (dialogValue.action !== ConflictResolutionEnum.SKIP) {\r\n\t\t\t\t\tthis.occupiedStrings.push(this.getConflictString(currentObject));\r\n\t\t\t\t}\r\n\t\t\t\tif (dialogValue.sameForRemaining) {\r\n\t\t\t\t\tfor (let i = nextIndex; i < this.conflictingObjects.length; i++) {\r\n\t\t\t\t\t\tif (dialogValue.action === ConflictResolutionEnum.COPY) {\r\n\t\t\t\t\t\t\tdialogValue.newName = Helper.generateNewDisplayName(\r\n\t\t\t\t\t\t\t\tthis.getConflictString(this.conflictingObjects[i]),\r\n\t\t\t\t\t\t\t\tthis.occupiedStrings\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis.occupiedStrings.push(dialogValue.newName);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresolutions.push({\r\n\t\t\t\t\t\t\tobject: this.conflictingObjects[i],\r\n\t\t\t\t\t\t\tresolution: dialogValue.action,\r\n\t\t\t\t\t\t\tnewName: dialogValue.newName\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdeferredResolutionChoice.resolve(resolutions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (nextIndex < this.conflictingObjects.length) {\r\n\t\t\t\t\t\tthis.resolveNextConflict<T>(dialogValue.action, nextIndex).then((resolvedCompositeComponents) => {\r\n\t\t\t\t\t\t\tdeferredResolutionChoice.resolve(resolutions.concat(resolvedCompositeComponents));\r\n\t\t\t\t\t\t}).catch((e: IErrorResponse) => {\r\n\t\t\t\t\t\t\tdeferredResolutionChoice.reject(e);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdeferredResolutionChoice.resolve(resolutions);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdeferredResolutionChoice.reject(new ErrorResponse(\"User cancel\"));\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn deferredResolutionChoice.promise;\r\n\t}\r\n\r\n\tprivate applyResolutions<T>(resolutions: IConflictResolution<T>[], oldObjects: T[]): IResolutionResult<T> {\r\n\t\tconst valuesToRemove: string[] = [];\r\n\t\tconst resolutionResult: IResolutionResult<T> = {\r\n\t\t\ttoRemove: [],\r\n\t\t\ttoAdd: []\r\n\t\t};\r\n\t\tresolutions.forEach((resolution) => {\r\n\t\t\tconst newItem = resolution.object;\r\n\t\t\tswitch (resolution.resolution) {\r\n\t\t\t\tcase ConflictResolutionEnum.REPLACE:\r\n\t\t\t\t\tvaluesToRemove.push(this.getConflictString(newItem));\r\n\t\t\t\t\tresolutionResult.toAdd.push(newItem);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ConflictResolutionEnum.COPY:\r\n\t\t\t\t\tHelper.setDeepValue(newItem, this.conflictKey, resolution.newName);\r\n\t\t\t\t\tresolutionResult.toAdd.push(newItem);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ConflictResolutionEnum.SKIP:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (valuesToRemove.length > 0) {\r\n\t\t\tconst objsToRemove = oldObjects.filter((obj) => {\r\n\t\t\t\treturn valuesToRemove.some((valueToRemove) => {\r\n\t\t\t\t\treturn this.getConflictString(obj) === valueToRemove;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tresolutionResult.toRemove = objsToRemove;\r\n\t\t}\r\n\t\treturn resolutionResult;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.service(InjectNames.CONFLICT_RESOLUTION_SERVICE, ConflictResolutonService);\r\n\t}\r\n}\r\n","import type { ICustomComponentDefinition } from \"ng2/common/model/components/custom-component-definition.model\";\r\nimport type { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport type { IJsonCustomComponentDefinition } from \"ng2/common/model/databearer/components/json-custom-component-def.model\";\r\nimport type { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonBoundary } from \"ng2/common/model/databearer/json-boundary.model\";\r\nimport type { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport type { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\nimport type { IMashup } from \"ng2/common/model/project/mashup/mashup.model\";\r\n\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\n/**\r\n * Possibly refactor so that Mashup corresponds to the actual metadata of the Application\r\n */\r\nexport abstract class Mashup implements IMashup {\r\n\tmanifest: IJsonManifest;\r\n\trootComponent: IJsonLayoutComponent;\r\n\tdatabearer: IJsonMashup;\r\n\r\n\tdatasources: IMap<IJsonDatasource> = {};\r\n\tinteractions: Interaction[] = [];\r\n\tcustomComponentDefinitions: IMap<IJsonCustomComponentDefinition> = {};\r\n\tcompositeComponents: IJsonCompositeComponent[] = [];\r\n\ttranslations: IMap<IJsonLanguageComponent[]> = {};\r\n\ttags: IJsonTag[] = [];\r\n\texpressions?: IJsonExpression[] = [];\r\n\r\n\tgetManifest(): IJsonManifest {\r\n\t\treturn this.manifest;\r\n\t}\r\n\r\n\tgetId(): string {\r\n\t\treturn this.manifest.id;\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonMashup {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tsetRoot(componentObject: IJsonLayoutComponent): void {\r\n\t\tthis.rootComponent = componentObject;\r\n\t}\r\n\r\n\t//#region /* Expressions */\r\n\tgetExpressions(): IJsonExpression[] {\r\n\t\treturn this.expressions;\r\n\t}\r\n\r\n\tgetExpressionsByComponentId(componentId: string): IJsonExpression[] {\r\n\t\treturn this.expressions.filter((expression) => {\r\n\t\t\treturn expression.usedBy === componentId;\r\n\t\t});\r\n\t}\r\n\r\n\taddExpression(expression: IJsonExpression): void {\r\n\t\tthis.expressions.push(expression);\r\n\t}\r\n\r\n\tdeleteExpression(deletedExpression: IJsonExpression): void {\r\n\t\tthis.expressions = this.expressions.filter((expression) => {\r\n\t\t\treturn expression.id !== deletedExpression.id;\r\n\t\t});\r\n\t}\r\n\r\n\tremoveExpression(componentId: string): void {\r\n\t\tthis.expressions = this.expressions.filter((expression) => {\r\n\t\t\treturn expression.source !== componentId && expression.target !== componentId;\r\n\t\t});\r\n\t}\r\n\r\n\tsaveExpression(savedExpression: IJsonExpression): void {\r\n\t\tconst expressionIndex = this.expressions.findIndex((expression) => {\r\n\t\t\treturn expression.id === savedExpression.id;\r\n\t\t});\r\n\t\tthis.expressions[expressionIndex] = savedExpression;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Datasources */\r\n\tgetDatasources(): IMap<IJsonDatasource> {\r\n\t\treturn this.datasources;\r\n\t}\r\n\r\n\tgetDatasource(dsName: string): IJsonDatasource {\r\n\t\treturn this.datasources[dsName];\r\n\t}\r\n\r\n\tgetDatasourceDatabearers(): IJsonDatasource[] {\r\n\t\tconst datasourceDatabearers: IJsonDatasource[] = [];\r\n\t\tfor (const key in this.datasources) {\r\n\t\t\tdatasourceDatabearers.push(this.datasources[key]);\r\n\t\t}\r\n\t\treturn datasourceDatabearers;\r\n\t}\r\n\r\n\taddDatasource(datasource: IJsonDatasource): void {\r\n\t\tthis.datasources[datasource.id] = datasource;\r\n\t}\r\n\r\n\tremoveDatasource(datasourceId: string): IJsonDatasource {\r\n\t\tconst removedDataservice = this.datasources[datasourceId];\r\n\t\tdelete this.datasources[datasourceId];\r\n\t\treturn removedDataservice;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Interactions */\r\n\tgetInteractions(): Interaction[] {\r\n\t\treturn this.interactions;\r\n\t}\r\n\r\n\tgetInteractionDatabearers(): IJsonInteraction[] {\r\n\t\treturn this.interactions.map<IJsonInteraction>((interaction) => {\r\n\t\t\treturn interaction.getDatabearer();\r\n\t\t});\r\n\t}\r\n\r\n\tsetInteractions(interactions: Interaction[]): void {\r\n\t\tthis.interactions = interactions;\r\n\t}\r\n\r\n\taddInteraction(interaction: Interaction): void {\r\n\t\tthis.interactions.push(interaction);\r\n\t}\r\n\r\n\tremoveInteraction(toRemoveInteraction: Interaction): void {\r\n\t\tconst index = this.interactions\r\n\t\t\t.findIndex(interaction => interaction.getId() === toRemoveInteraction.getId());\r\n\t\tthis.interactions.splice(index, 1);\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Custom Components */\r\n\tgetCustomComponentDefinitions(): IMap<ICustomComponentDefinition> {\r\n\t\treturn this.customComponentDefinitions;\r\n\t}\r\n\r\n\taddCustomComponentDefinition(customComponent: ICustomComponentDefinition): void {\r\n\t\tthis.customComponentDefinitions[customComponent.id] = customComponent;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Composite Components */\r\n\tgetCompositeComponents(): IJsonCompositeComponent[] {\r\n\t\treturn this.compositeComponents;\r\n\t}\r\n\r\n\taddCompositeComponent(compositeComponent: IJsonCompositeComponent): void {\r\n\t\tthis.compositeComponents.push(compositeComponent);\r\n\t}\r\n\r\n\tgetCompositeComponent(compositeId: string): IJsonCompositeComponent {\r\n\t\treturn this.compositeComponents.filter((cmp) => {\r\n\t\t\treturn cmp.manifest.id === compositeId;\r\n\t\t})[0];\r\n\t}\r\n\r\n\tremoveCompositeComponent(compositeId: string): IJsonCompositeComponent {\r\n\t\tconst compositeToDelete = this.getCompositeComponent(compositeId);\r\n\t\treturn this.compositeComponents.splice(this.compositeComponents.indexOf(compositeToDelete), 1).pop();\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Tags */\r\n\tgetTags(): IJsonTag[] {\r\n\t\treturn this.tags;\r\n\t}\r\n\r\n\tsetTags(tags: IJsonTag[]): void {\r\n\t\tthis.tags = tags;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* URL Variables */\r\n\tgetUrlVariables(): IJsonUrlVariable[] {\r\n\t\treturn this.manifest.urlVariables;\r\n\t}\r\n\r\n\tsetUrlVariables(variables: IJsonUrlVariable[]): void {\r\n\t\tthis.manifest.urlVariables = variables;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region Boundaries\r\n\tgetBoundaries(): IJsonBoundary[] {\r\n\t\treturn this.manifest.mashupBoundaries;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region /* Translations */\r\n\tsetTranslations(translations: IMap<IJsonLanguageComponent[]>): void {\r\n\t\tthis.translations = translations;\r\n\t}\r\n\r\n\tgetTranslations(): IMap<IJsonLanguageComponent[]> {\r\n\t\treturn this.translations;\r\n\t}\r\n\r\n\tgetTranslationsList(): IJsonLanguageComponent[] {\r\n\t\tlet translationList: IJsonLanguageComponent[] = [];\r\n\t\tfor (const key in this.translations) {\r\n\t\t\ttranslationList = translationList.concat(this.translations[key]);\r\n\t\t}\r\n\t\treturn translationList;\r\n\t}\r\n\r\n\tgetTranslation(componentId: string): IJsonLanguageComponent[] {\r\n\t\treturn this.translations[componentId];\r\n\t}\r\n\r\n\tremoveTranslation(componentId: string): void {\r\n\t\tdelete this.translations[componentId];\r\n\t}\r\n\r\n\t/**\r\n\t* Mapping the translations on componentId.\r\n\t* One componentId can have several translations so need to check if on exists before\r\n\t* adding new, if exists push to same.\r\n\t*\r\n\t* @\t* @param {IJsonLanguageComponent} translation\r\n\t* @returns {void}\r\n\t* @memberof DesignerMashup\r\n\t*/\r\n\taddTranslation(translation: IJsonLanguageComponent): void {\r\n\t\tif (this.getTranslation(translation.componentId)) {\r\n\t\t\tthis.translations[translation.componentId].push(translation);\r\n\t\t} else {\r\n\t\t\tthis.translations[translation.componentId] = [translation];\r\n\t\t}\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\t//#region Other\r\n\tsetPreviewImage(base64Img: string): void {\r\n\t\tthis.manifest.previewImg = base64Img;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\tstatic create<AppType extends Mashup, ManifestType extends IJsonManifest>(\r\n\t\tappType: (new () => AppType),\r\n\t\tmanifestType: (new (obj: any) => ManifestType),\r\n\t\tobj: IJsonMashup,\r\n\t): AppType {\r\n\r\n\t\tconst entry = new appType();\r\n\t\tentry.manifest = new manifestType(obj.manifest);\r\n\r\n\t\tif (obj.datasources) {\r\n\t\t\tobj.datasources.forEach((datasource: IJsonDatasource) => {\r\n\t\t\t\tentry.addDatasource(datasource);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (obj.rootComponent) {\r\n\t\t\tentry.setRoot(obj.rootComponent);\r\n\t\t}\r\n\r\n\t\tif (obj.interactions) {\r\n\t\t\tobj.interactions.forEach((interaction) => {\r\n\t\t\t\tconst newInteraction = new Interaction(interaction);\r\n\t\t\t\tentry.addInteraction(newInteraction);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (obj.translations) {\r\n\t\t\tobj.translations.forEach((translation: IJsonLanguageComponent) => {\r\n\t\t\t\tentry.addTranslation(translation);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (obj.customComponentDefinitions) {\r\n\t\t\tentry.customComponentDefinitions = obj.customComponentDefinitions;\r\n\t\t}\r\n\r\n\t\tif (obj.compositeComponents) {\r\n\t\t\tentry.compositeComponents = obj.compositeComponents;\r\n\t\t}\r\n\r\n\t\tif (obj.tags) {\r\n\t\t\tentry.tags = obj.tags;\r\n\t\t}\r\n\r\n\t\tif (obj.expressions) {\r\n\t\t\tentry.expressions = obj.expressions;\r\n\t\t}\r\n\r\n\t\treturn entry;\r\n\t}\r\n}\r\n","import type { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport { InteractionParameter } from \"ng2/components/interaction/interaction-parameter\";\r\n\r\nexport class Interaction implements IInteraction {\r\n\tdisplayName: string; //not saved in databearer\r\n\ttriggerString: string; //not saved in databearer\r\n\ttargetString: string; //not saved in databearer\r\n\tprivate databearer: IJsonInteraction;\r\n\tprivate parameters: InteractionParameter[] = [];\r\n\r\n\tconstructor(obj: IJsonInteraction) {\r\n\t\tthis.databearer = obj;\r\n\t\tif (obj.parameters) {\r\n\t\t\tobj.parameters.forEach((parameter) => {\r\n\t\t\t\tthis.parameters.push(new InteractionParameter(parameter));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonInteraction {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tgetId(): string {\r\n\t\treturn this.databearer.id;\r\n\t}\r\n\r\n\tget sourceName(): string {\r\n\t\treturn this.databearer.sourceName;\r\n\t}\r\n\tset sourceName(sourceName: string) {\r\n\t\tthis.databearer.sourceName = sourceName;\r\n\t}\r\n\r\n\tget sourceTriggerName(): string {\r\n\t\treturn this.databearer.sourceTriggerName;\r\n\t}\r\n\tset sourceTriggerName(sourceTriggerName: string) {\r\n\t\tthis.databearer.sourceTriggerName = sourceTriggerName;\r\n\t}\r\n\r\n\tget targetName(): string {\r\n\t\treturn this.databearer.targetName;\r\n\t}\r\n\tset targetName(targetName: string) {\r\n\t\tthis.databearer.targetName = targetName;\r\n\t}\r\n\r\n\tget targetActionName(): string {\r\n\t\treturn this.databearer.targetActionName;\r\n\t}\r\n\tset targetActionName(targetActionName: string) {\r\n\t\tthis.databearer.targetActionName = targetActionName;\r\n\t}\r\n\r\n\tgetParameters(): InteractionParameter[] {\r\n\t\treturn this.parameters;\r\n\t}\r\n\r\n\tgetParameter(targetKey: string): InteractionParameter {\r\n\t\treturn this.parameters.filter((param) => {\r\n\t\t\treturn (param.targetKey === targetKey);\r\n\t\t}).pop();\r\n\t}\r\n\r\n\taddParameter(parameter: InteractionParameter): void {\r\n\t\tif (!this.databearer.parameters) {\r\n\t\t\tthis.databearer.parameters = [];\r\n\t\t}\r\n\t\tthis.databearer.parameters.push(parameter.getDatabearer());\r\n\t\tthis.parameters.push(parameter);\r\n\t}\r\n\r\n\tremoveParameter(index: number): void {\r\n\t\tthis.databearer.parameters.splice(index, 1);\r\n\t\tthis.parameters.splice(index, 1);\r\n\t}\r\n\r\n\tremoveAllParameters(): void {\r\n\t\tthis.databearer.parameters = null;\r\n\t\tthis.parameters.length = 0;\r\n\t}\r\n\r\n}\r\n","export enum HttpAcceptEnum {\r\n\tAPPLICATION_JSON = \"application/json\",\r\n\tALL = \"*/*\"\r\n}\r\n","import { IFieldSettingButton } from \"ng2/common/model/components/settings/field-setting-button.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\n\r\nexport interface IComponentFieldSetting {\r\n\tref: string;\r\n\ttitle?: string;\r\n\t//subTitle?: string;\r\n\t//tab: string;\r\n\tinputType?: any;\r\n\t//url?: string;\r\n\tboundarySetting?: boolean;\r\n\tdataset?: IDataPair[];\r\n\tdefaultValue?: any;\r\n\t// Works only for textfield atm\r\n\tbutton?: IFieldSettingButton;\r\n\t// works only for checkbox atm\r\n\ttooltip?: string;\r\n}\r\n","import { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport interface IJsonInteraction {\r\n\tid: string;\r\n\tsourceName: string;\r\n\tsourceTriggerName: string;\r\n\ttargetName: string;\r\n\ttargetActionName: string;\r\n\r\n\tparameters: IJsonInteractionParameter[];\r\n}\r\n\r\nexport interface IJsonInteractionParameter {\r\n\ttargetKey: string;\r\n\tvalueSource: IJsonValueSource;\r\n}\r\n","import { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IComponent } from \"../../IComponent\";\r\n\r\nexport abstract class Datasource implements IDatasource {\r\n\r\n\tpublic usedBy: IComponent[] = [];\r\n\r\n\tprotected databearer: IJsonDatasource;\r\n\r\n\tconstructor(obj: IJsonDatasource) {\r\n\t\tthis.databearer = obj;\r\n\t}\r\n\r\n\tpublic getDatabearer(): IJsonDatasource {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tget id(): string {\r\n\t\treturn this.databearer.id;\r\n\t}\r\n\tset id(id: string) {\r\n\t\tthis.databearer.id = id;\r\n\t}\r\n\r\n\tget typedef(): DatasourceTypeEnum {\r\n\t\treturn this.databearer.typedef;\r\n\t}\r\n\tset typedef(typedef: DatasourceTypeEnum) {\r\n\t\tthis.databearer.typedef = typedef;\r\n\t}\r\n\r\n\tget displayName(): string {\r\n\t\treturn this.databearer.displayName;\r\n\t}\r\n\tset displayName(displayName: string) {\r\n\t\tthis.databearer.displayName = displayName;\r\n\t}\r\n\r\n\tpublic abstract getDetailData(params: IMap<any>): Promise<any>;\r\n\r\n\tpublic abstract getListData(params: IMap<any>): Promise<any>;\r\n\r\n\tpublic abstract getMetaData(): Promise<IMetaData>;\r\n\r\n\tpublic abstract getNonParsedData(params: IMap<any>): Promise<any[]>;\r\n\r\n\t/**\r\n\t * fill in extra parameters for multi parameter calls\r\n\t */\r\n\tpublic fillInParameters(\r\n\t\textraParameters: IMap<any>,\r\n\t\tinputParameters: IParameterObject[],\r\n\t\tparameters: IMap<any>[]\r\n\t): void {\r\n\t\tif (Object.keys(extraParameters).length > 0) {\r\n\t\t\tinputParameters.forEach((ionApiParameter) => {\r\n\t\t\t\tparameters.forEach((parameter) => {\r\n\t\t\t\t\tif (extraParameters[ionApiParameter.id]) {\r\n\t\t\t\t\t\tparameter[ionApiParameter.id] = extraParameters[ionApiParameter.id];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { InjectNames, Numbers } from \"ng2/common/constants/common.constant\";\r\n\r\nexport class MingleService {\r\n\r\n\tpublic static MESSAGETYPE_BUSINESSCONTEXT: string = \"inforBusinessContext\";\r\n\tpublic static MESSAGETYPE_CLEARCONTEXT: string = \"clearAllContext\";\r\n\tpublic static MESSAGETYPE_APPINITCOMPLETE: string = \"appInitComplete\";\r\n\tpublic static MESSAGETYPE_APPLICATIONDRILLBACK: string = \"applicationDrillback\";\r\n\tpublic static MESSAGETYPE_FAVORITECONTEXT: string = \"showFavoriteContext\";\r\n\tpublic static MESSAGETYPE_SHORTCUTCONTEXT: string = \"setShortcutContext\";\r\n\r\n\tpublic static DEFAULT_LID: string = \"lid://infor.app-builder.1\";\r\n\r\n\tprivate logicalId: string;\r\n\r\n\tpublic getLogicalId(): string {\r\n\t\treturn this.logicalId || MingleService.DEFAULT_LID;\r\n\t}\r\n\r\n\tpublic setupMessageHandler(messageType: string, callback: Function): void {\r\n\t\tinfor.companyon.client.registerMessageHandler(messageType, callback);\r\n\t}\r\n\r\n\tsendApplicationInitComplete(): void {\r\n\t\tinfor.companyon.client.sendMessage(MingleService.MESSAGETYPE_APPINITCOMPLETE, window.name);\r\n\t}\r\n\r\n\tpublic sendDrillbackMessage(message: string): void {\r\n\t\tinfor.companyon.client.sendPrepareDrillbackMessage(message);\r\n\t}\r\n\r\n\tpublic sendBusinessContextMessage(messageType: string, appId: string, appName: string): void {\r\n\t\tlet data: Object;\r\n\r\n\t\tswitch (messageType) {\r\n\t\t\tcase MingleService.MESSAGETYPE_BUSINESSCONTEXT:\r\n\t\t\t\tdata = {\r\n\t\t\t\t\t\"type\": messageType,\r\n\t\t\t\t\t\"screenId\": appId,\r\n\t\t\t\t\t\"visible\": true,\r\n\t\t\t\t\t\"readOnly\": false,\r\n\t\t\t\t\t\"originatingTime\": this.getOriginatingTime(),\r\n\t\t\t\t\t\"contextId\": this.generateContextId(),\r\n\t\t\t\t\t\"logicalId\": this.getLogicalId(),\r\n\t\t\t\t\t\"entities\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"entityType\": \"InforApp\",\r\n\t\t\t\t\t\t\t\"id1\": appId,\r\n\t\t\t\t\t\t\t\"drillbackURL\": this.getDrillbackUrl(this.getLogicalId(), appId)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase MingleService.MESSAGETYPE_SHORTCUTCONTEXT:\r\n\t\t\t\tdata = {\r\n\t\t\t\t\t\"name\": appName,\r\n\t\t\t\t\t\"description\": \"An Infor App in AppHub\",\r\n\t\t\t\t\t\"absoluteURL\": false,\r\n\t\t\t\t\t\"shortcutContext\": this.getDrillbackUrl(this.getLogicalId(), appId)\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tdata = {};\r\n\t\t}\r\n\r\n\t\tinfor.companyon.client.sendMessage(messageType, data);\r\n\t}\r\n\r\n\tpublic sendClearContextMessage(): void {\r\n\t\tinfor.companyon.client.sendMessage(MingleService.MESSAGETYPE_BUSINESSCONTEXT, {});\r\n\t\tinfor.companyon.client.sendMessage(MingleService.MESSAGETYPE_SHORTCUTCONTEXT, {});\r\n\t}\r\n\r\n\tprivate getDrillbackUrl(logicalId: string, appId: string): string {\r\n\t\treturn \"?LogicalId=\" + encodeURIComponent(logicalId) + \"&$appId=\" + appId;\r\n\t}\r\n\r\n\tprivate generateContextId(): string {\r\n\t\treturn this.getOriginatingTime().toString() + \"\" + Math.floor((Math.random() * Numbers.HUNDRED) + 1);\r\n\t}\r\n\r\n\tprivate getOriginatingTime(): number {\r\n\t\tconst d: Date = new Date();\r\n\t\treturn d.getTime();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.service(InjectNames.MINGLE_SERVICE, MingleService);\r\n\t}\r\n}\r\n","import type { ISourceItem } from \"common/model/component/hyperlink.model\";\r\nimport { IJsonPersistentComponent } from \"ng2/common/model/databearer/components/base/json-persistent-components.model\";\r\nimport type { IJsonComponent, IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDataGridColumn, ISortOrderSetting } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nexport interface IPreviousAttributes {\r\n\trow: number;\r\n\tactivePage: number;\r\n\tsortOrder: ISortOrderSetting;\r\n}\r\n\r\n//#region saved data\r\nexport interface IJsonDatagrid extends IJsonComponent, IJsonPersistentComponent {\r\n\tisList: boolean;\r\n\tusePaging: boolean;\r\n\tpageSize?: number;\r\n\tcolumns: IExtendedDataGridColumn[];\r\n\tboundarySettings: IMap<IJsonDatagridSettings>;\r\n\tshowLabel: boolean; // Deprecated\r\n\tlabel: IJsonValueSource;\r\n\trowCount: boolean;\r\n\tfilterBar: boolean;\r\n\tenableExport: boolean;\r\n\tmultiSelect: boolean;\r\n}\r\n\r\nexport interface IJsonDatagridSettings extends IJsonComponentSettings {\r\n\trowHeight: string;\r\n\tshowLabel: boolean;\r\n}\r\n\r\nexport interface IExtendedDataGridColumn extends IDataGridColumn {\r\n\teditable?: boolean;\r\n\tformatterName?: string;\r\n\tlistOptions?: IColumnListOptions;\r\n\thyperlinkOptions?: IColumnHyperlinkOptions;\r\n\tsummarize?: boolean;\r\n\tsummaryText?: string;\r\n\tsummaryTextPlacement?: string;\r\n\tsubstitute?: boolean;\r\n\tsubstituteOptions?: IColumnSubstituteOptions;\r\n\talign?: string;\r\n\tvalue?: string; //TODO move value MUPS-3016\r\n}\r\n\r\nexport interface IColumnListOptions {\r\n\tsourceId: string;\r\n\tparameterId: string;\r\n}\r\n\r\nexport interface IColumnSubstituteOptions {\r\n\tsource: string;\r\n\tfrom: string;\r\n\tto: string;\r\n}\r\n\r\nexport interface IColumnHyperlinkOptions {\r\n\tvalue: string;\r\n\tisDrillback: boolean;\r\n\tsources?: ISourceItem[];\r\n}\r\n\r\n//#endregion\r\n","import angular from \"angular\";\r\n\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport {\r\n\tIComponentStyle\r\n} from \"../common/defines\";\r\nimport { IComponent } from \"../common/IComponent\";\r\n\r\nimport { Config, InteractionPairOperation, SettingKeys, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IJsonComponent, IJsonComponentSettings, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\nimport { IComponentScope } from \"../common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\nimport { Component } from \"./component\";\r\nimport { LayoutComponent } from \"./layout-component\";\r\nimport { FrameworkService } from \"./services/framework-service\";\r\n\r\nexport class ApplicationParent extends LayoutComponent {\r\n\tpublic static applicationParentDatabearer: IJsonComponent = {\r\n\t\ttypedef: \"ApplicationParent\",\r\n\t\tid: \"Application\",\r\n\t\tdisplayName: \"Application\",\r\n\t\tisReadonly: false,\r\n\t\tboundarySettings: {} as IMap<IJsonComponentSettings>\r\n\t};\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Locale\",\r\n\t\tref: SettingKeys.LANGUAGE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Language Code\",\r\n\t\tref: SettingKeys.LANGUAGE_SHORT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"User Name\",\r\n\t\tref: SettingKeys.USER_NAME,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"User Description\",\r\n\t\tref: SettingKeys.USER_DESCRIPTION,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Current Timestamp\",\r\n\t\tref: SettingKeys.TIMESTAMP,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_STARTUP;\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.NONE;\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] = [InteractionPairOperation.ON_STARTUP];\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.NONE];\r\n\r\n\tpublic currentTheme: ThemeEnum = 1;\r\n\tpublic language: string;\r\n\tpublic languageShort: string;\r\n\tpublic userName: string;\r\n\tpublic userDescription: string;\r\n\tpublic timestamp: number;\r\n\tprotected databearer: IJsonComponent;\r\n\r\n\tprivate manifest: IDesignerManifest;\r\n\r\n\tconstructor(\r\n\t\tdatabearer: IJsonComponent,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService) {\r\n\t\tsuper(databearer, element, parent, frameworkService);\r\n\r\n\t\tthis.manifest = frameworkService.getCurrentProject().getManifest();\r\n\t\tthis.language = frameworkService.getCurrentLanguage();\r\n\t\tif (this.language) {\r\n\t\t\t// tslint:disable-next-line:no-magic-numbers\r\n\t\t\tthis.languageShort = this.language.substr(0, 2);\r\n\t\t}\r\n\t\tthis.userName = Config.USER.name;\r\n\t\tthis.userDescription = Config.USER.displayName;\r\n\t\tthis.timestamp = Date.now();\r\n\t\tthis.getScope().componentInstance = this;\r\n\t}\r\n\r\n\tpublic static createSpoofedElement(scope: IComponentScope): ng.IAugmentedJQuery {\r\n\t\tconst element = angular.element(\"<div></div>\");\r\n\t\telement.data(\"eir-scope\", scope);\r\n\t\treturn element;\r\n\t}\r\n\r\n\tpublic getId(): string {\r\n\t\treturn this.databearer.id;\r\n\t}\r\n\r\n\tpublic addChildInstance(child: IComponent): void {\r\n\t\tthis.children[0] = child;\r\n\t}\r\n\r\n\tpublic resizableChildren(direction: OrientationEnum): boolean {\r\n\t\t// Rootcomponent is never resizeable\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic hasIndividualChildSizes(ori: OrientationEnum): boolean {\r\n\t\tif (this.manifest.showTitleBar) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic getContext(): IContext {\r\n\t\treturn {};\r\n\t}\r\n\r\n\tpublic forEachChild(fn: (ch: Component) => void, doGenerated: boolean): void {\r\n\t\t// forEachChild\r\n\t}\r\n\r\n\tpublic forEachParent(fn: (ch: ILayoutComponent) => void): void {\r\n\t\t// forEachParent\r\n\t}\r\n\r\n\tpublic calcNewSizes(orientation?: OrientationEnum): void {\r\n\t\tif (this.children && this.children.length > 0) {\r\n\t\t\tthis.children[0].calcNewHeight();\r\n\t\t\tthis.children[0].calcNewWidth();\r\n\t\t}\r\n\t}\r\n\r\n\t// Method needed for interface implementation\r\n\tpublic getPxPerPercentComponent(ori: OrientationEnum): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tpublic updateVisibility(): void {\r\n\t\t// Overloading, ApplicationParent is always invisible\r\n\t}\r\n\r\n\tpublic updateShowError(): void {\r\n\t\t// Overloading, ApplicationParent never shows error\r\n\t}\r\n\r\n\tprotected getInlineStyle(): IComponentStyle {\r\n\t\t// Overload, ApplicationParent has no size\r\n\t\treturn {\r\n\t\t\twidth: \"0\",\r\n\t\t\theight: \"0\"\r\n\t\t};\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn console.debug(\"[ApplicationParent] Rootcomponent has no directive\");\r\n\t}];\r\n}","import { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonRuntimeMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport { RuntimeApp } from \"ng2/common/project/runtime-app\";\r\nimport { IAvailableSourceField } from \"../common/defines\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\nimport { CommonService } from \"../common/services/common-service\";\r\nimport { FrameworkService } from \"../components/services/framework-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\n\r\nexport class RuntimeService {\r\n\tstatic $inject = [\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate languageService: LanguageService\r\n\t) {\r\n\t}\r\n\r\n\tloadRuntimeProject(projectId: string, canvasWidth: number): ng.IPromise<RuntimeApp> {\r\n\t\tconst promise = this.commonService.loadProject(projectId, canvasWidth) as ng.IPromise<IJsonRuntimeMashup>;\r\n\t\treturn this.parseAndSetApp(promise, canvasWidth);\r\n\t}\r\n\r\n\tloadPublishedProject(projectId: string, canvasWidth: number): ng.IPromise<RuntimeApp> {\r\n\t\tconst promise = this.commonService.loadPublishedProject(projectId, canvasWidth);\r\n\t\treturn this.parseAndSetApp(promise, canvasWidth);\r\n\t}\r\n\r\n\tloadPublishedProjectNoConstraint(projectId: string, canvasWidth: number): ng.IPromise<RuntimeApp> {\r\n\t\tconst promise = this.commonService.loadPublishedProjectNoConstraints(projectId, canvasWidth);\r\n\t\treturn this.parseAndSetApp(promise, canvasWidth);\r\n\t}\r\n\r\n\tgetCurrentProject(): RuntimeApp {\r\n\t\treturn this.commonService.getCurrentProject() as RuntimeApp;\r\n\t}\r\n\r\n\tsetCurrentRootComponentInstance(component: ILayoutComponent): void {\r\n\t\tthis.commonService.setCurrentRootComponentInstance(component);\r\n\t}\r\n\r\n\tgetCurrentBoundary(): IBoundary {\r\n\t\treturn this.commonService.getCurrentBoundary();\r\n\t}\r\n\r\n\trunStartupInteractions(): void {\r\n\t\tthis.frameworkService.runStartupInteractions();\r\n\t}\r\n\r\n\tupdateCurrentBoundary(canvasWidth: number): void {\r\n\t\tthis.commonService.updateCurrentBoundary(canvasWidth);\r\n\t}\r\n\r\n\tinstantiateDataservice(id: string): IDatasource {\r\n\t\treturn this.frameworkService.getDatasourceObject(id);\r\n\t}\r\n\r\n\tsetCurrentUrlValues(urlDataset: string[]): void {\r\n\t\tconst newUrlMetaData: IAvailableSourceField[] = [];\r\n\t\turlDataset.forEach((urlData) => {\r\n\t\t\tconst name = urlData.substring(0, urlData.indexOf(\"=\"));\r\n\t\t\tconst value = urlData.substring(urlData.lastIndexOf(\"=\") + 1);\r\n\t\t\tconst sourceField: IAvailableSourceField = {\r\n\t\t\t\tvisibleName: name,\r\n\t\t\t\tsourceKey: name,\r\n\t\t\t\tsourceKeyShort: name,\r\n\t\t\t\tcurrentValue: value,\r\n\t\t\t};\r\n\t\t\tnewUrlMetaData.push(sourceField);\r\n\t\t});\r\n\r\n\t\tthis.commonService.setUrlMetaData(newUrlMetaData);\r\n\t}\r\n\r\n\tprivate parseAndSetApp(\r\n\t\tpromise: ng.IPromise<IJsonRuntimeMashup>,\r\n\t\tcanvasWidth: number): ng.IPromise<RuntimeApp> {\r\n\t\treturn promise.then((jsonMashup: IJsonRuntimeMashup) => {\r\n\t\t\tconst mashup = RuntimeApp.fromObj(jsonMashup);\r\n\t\t\t//on runtime: language must load before project\r\n\t\t\treturn this.languageService.initializeLanguageSettings().then(() => {\r\n\t\t\t\treturn this.commonService.buildPrerequisites(mashup, canvasWidth) as ng.IPromise<RuntimeApp>;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.service(InjectNames.RUNTIME_SERVICE, RuntimeService);\r\n\t}\r\n}\r\n","import { AppTypeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { AngularConstants } from \"../appbuilder/common/angular-constants\";\r\n\r\nexport class AppState {\r\n\r\n\tpublic static HOME: ng.ui.IState = {\r\n\t\turl: \"/\",\r\n\t\tname: \"HOME\",\r\n\t\ttemplate: \"<eir-apphub></eir-apphub>\",\r\n\t\tparams: {\r\n\t\t\tisFromAdmin: false,\r\n\t\t}\r\n\t};\r\n\r\n\tpublic static APP_LAUNCHER: ng.ui.IState = {\r\n\t\turl: \"/run/\" + \":id\",\r\n\t\tname: \"appLauncher\",\r\n\t\tcomponent: \"eirAppLauncher\",\r\n\t\treloadOnSearch: false,\r\n\t\tresolve: {\r\n\t\t\tappType: () => AppTypeEnum.RUNTIME,\r\n\t\t\tprojectId: [AngularConstants.STATE_PARAMS,\r\n\t\t\t\t($stateParams: ng.ui.IStateParamsService): string => $stateParams.id],\r\n\t\t}\r\n\t};\r\n\r\n\tpublic static ADMIN_APP_LAUNCHER: ng.ui.IState = {\r\n\t\turl: \"/admin/run/\" + \":id\",\r\n\t\tname: \"adminAppLauncher\",\r\n\t\tcomponent: \"appLauncher\",\r\n\t\treloadOnSearch: false,\r\n\t\tresolve: {\r\n\t\t\tappType: () => AppTypeEnum.ADMIN_PREVIEW,\r\n\t\t\tprojectId: [AngularConstants.STATE_PARAMS,\r\n\t\t\t\t($stateParams: ng.ui.IStateParamsService): string => $stateParams.id],\r\n\t\t}\r\n\t};\r\n\r\n\tpublic static ADMINISTRATION: ng.ui.IState = {\r\n\t\turl: \"/admin\",\r\n\t\tname: \"administration\",\r\n\t\ttemplate: \"<eir-administration></eir-administration>\"\r\n\t};\r\n\r\n\tpublic static DEVELOPER: ng.ui.IState = {\r\n\t\turl: \"/developer\",\r\n\t\tname: \"developer\",\r\n\t\ttemplate: \"<eir-developer-tool></eir-developer-tool>\",\r\n\t};\r\n\r\n\tpublic static add(module: ng.IModule): void {\r\n\t\tmodule.config([\r\n\t\t\t\"$stateProvider\",\r\n\t\t\t\"$urlRouterProvider\",\r\n\t\t\t(\r\n\t\t\t\t$stateProvider: ng.ui.IStateProvider,\r\n\t\t\t\t$urlRouterProvider: ng.ui.IUrlRouterProvider) => {\r\n\r\n\t\t\t\t$stateProvider\r\n\t\t\t\t\t.state(this.HOME)\r\n\t\t\t\t\t.state(this.APP_LAUNCHER)\r\n\t\t\t\t\t.state(this.ADMIN_APP_LAUNCHER)\r\n\t\t\t\t\t.state(this.ADMINISTRATION)\r\n\t\t\t\t\t.state(this.DEVELOPER);\r\n\r\n\t\t\t\t$urlRouterProvider.otherwise(\"/\");\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 344;","import angular from \"angular\";\r\n\r\nimport { upgradeModule } from \"@uirouter/angular-hybrid\";\r\nimport uiRouter from \"@uirouter/angularjs\";\r\nimport { WSForm, WSUserControl } from \"etc-assets/user-control-es\";\r\n\r\nimport \"./app.less\";\r\n\r\nimport { idsAssetsModule } from \"../../modules/ids-assets/module\";\r\nimport { componentsModule } from \"../appbuilder/components/module\";\r\nimport { runtimeModule } from \"../appbuilder/runtime/module\";\r\n\r\nimport { AngularConstants } from \"../appbuilder/common/angular-constants\";\r\nimport { AppState } from \"./app.state\";\r\n\r\n//#region App Hub Dashboard imports\r\nimport { AppHubDirective } from \"./apphub/apphub\";\r\nimport { HubService } from \"./apphub/services/hub-service\";\r\n\r\n// Runtime App Imports\r\nimport { ComponentValueDirective } from \"./component-value-directive\";\r\n//#endregion\r\n\r\n//#region Administration imports\r\nimport { AdministrationDirective } from \"./administration/administration\";\r\nimport { FeatureCatalog } from \"./administration/feature-catalog/feature-catalog\";\r\nimport { SaveService } from \"./administration/services/save-service\";\r\n\r\n// App Card imports\r\nimport { AdminAppCard } from \"./administration/admin-app-card/admin-app-card\";\r\n\r\n// Side Panel imports\r\nimport { AddRolesDialog } from \"./administration/admin-sidebar/add-roles-dialog/add-roles-dialog\";\r\nimport { AdminSidebar } from \"./administration/admin-sidebar/admin-sidebar\";\r\nimport { UrlValueDialogCtrl } from \"./administration/admin-sidebar/url-value-dialog/url-value-dialog\";\r\nimport { VersionDialogCtrl } from \"./administration/admin-sidebar/version-dialog/version-dialog\";\r\nimport { AdministrationService } from \"./administration/services/administration-service\";\r\n\r\n//#endregion\r\n\r\nimport { Debugger } from \"../appbuilder/common/debugger\";\r\nimport { DeveloperToolComponent } from \"./dev/developer-tool-component\";\r\n\r\nif (JENKINS_JOB) {\r\n\tconsole.debug(process.env.NODE_ENV);\r\n\r\n\t// Specifically so Jenkins' acc-test job can find jQuery\r\n\twindow.$ = jQuery;\r\n}\r\n\r\nexport const runtimeApp = angular.module(\"app-hub\", [\r\n\tuiRouter,\r\n\tupgradeModule.name,\r\n\tidsAssetsModule.name,\r\n\tcomponentsModule.name,\r\n\truntimeModule.name\r\n]);\r\n\r\nruntimeApp.config([\r\n\t\"$qProvider\", \"$compileProvider\",\r\n\t($qProvider: ng.IQProvider, $compileProvider: ng.ICompileProvider) => {\r\n\t\t$qProvider.errorOnUnhandledRejections(false);\r\n\t\t$compileProvider.debugInfoEnabled(Debugger.isEnabled());\r\n\t\t$compileProvider.commentDirectivesEnabled(false);\r\n\t\t$compileProvider.cssClassDirectivesEnabled(false);\r\n\t}\r\n]);\r\n\r\nruntimeApp.run([\r\n\tAngularConstants.STATE_SERVICE,\r\n\t(\r\n\t\t$state: ng.ui.IStateService\r\n\t) => {\r\n\t\tWSUserControl.onReady(() => {\r\n\t\t\tparent.MG.App.doUnloadPrompt = false;\r\n\t\t\tWSForm.getVarValue(\"InitURL\", (initUrl: string) => {\r\n\t\t\t\tconst prefix = \"run/\";\r\n\t\t\t\tif (initUrl !== \"\" && initUrl.indexOf(prefix) === 0) {\r\n\t\t\t\t\tconst id = initUrl.slice(prefix.length);\r\n\t\t\t\t\t$state.go(AppState.APP_LAUNCHER, {\r\n\t\t\t\t\t\tid\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}]);\r\n\r\nAppState.add(runtimeApp);\r\n\r\n//#region App Hub Dashboard\r\nAppHubDirective.add(runtimeApp);\r\nHubService.add(runtimeApp);\r\n\r\n// Runtime Apps\r\nComponentValueDirective.add(runtimeApp);\r\n//#endregion\r\n\r\n//#region Administration\r\nAdministrationDirective.add(runtimeApp);\r\nFeatureCatalog.add(runtimeApp);\r\nSaveService.add(runtimeApp);\r\n\r\n// App Card\r\nAdminAppCard.add(runtimeApp);\r\n\r\n// Side Panel\r\nAdministrationService.add(runtimeApp);\r\nAdminSidebar.add(runtimeApp);\r\nAddRolesDialog.add(runtimeApp);\r\nVersionDialogCtrl.add(runtimeApp);\r\nUrlValueDialogCtrl.add(runtimeApp);\r\n\r\n//#endregion\r\n\r\n// Services\r\n// MingleService.add(runtimeApp);\r\n// LanguageService.add(runtimeApp);\r\n\r\nDeveloperToolComponent.add(runtimeApp);\r\n","import angular from \"angular\";\r\n\r\nimport { commonModule } from \"../common/module\";\r\n\r\nimport { DatasourceService } from \"./services/datasource-service\";\r\nimport { FrameworkService } from \"./services/framework-service\";\r\nimport { IonApiService } from \"./services/ion-api-service\";\r\nimport { IonMetadataService } from \"./services/ion-metadata-service\";\r\nimport { LocalIdoService } from \"./services/local-ido-service\";\r\nimport { TranslationManagementService } from \"./services/translation-management-service\";\r\n\r\nimport { Defines } from \"./defines\";\r\n\r\nimport { ChildrenDirective } from \"./children-directive\";\r\nimport { ComponentCommonDirective } from \"./component-common\";\r\nimport { ComponentDirective } from \"./component-directive\";\r\nimport { TitlebarDirective } from \"./titlebar/titlebar\";\r\n\r\nexport const componentsModule = angular.module(\"componentsModule\", [\r\n\tcommonModule.name\r\n]);\r\n\r\ncomponentsModule.config([\"$qProvider\", ($qProvider: ng.IQProvider) => {\r\n\t$qProvider.errorOnUnhandledRejections(false);\r\n}]);\r\n\r\n// Add services\r\nDatasourceService.add(componentsModule);\r\nFrameworkService.add(componentsModule);\r\nIonApiService.add(componentsModule);\r\nIonMetadataService.add(componentsModule);\r\nLocalIdoService.add(componentsModule);\r\nTranslationManagementService.add(componentsModule);\r\n\r\n// Add components\r\nDefines.addComponents(componentsModule);\r\n\r\n// Add directives\r\nChildrenDirective.add(componentsModule);\r\nComponentCommonDirective.add(componentsModule);\r\nComponentDirective.add(componentsModule);\r\nTitlebarDirective.add(componentsModule);\r\n","import { IRequestConfig } from \"./request-config.model\";\r\n\r\nexport interface IIonApiRequestOptions extends IRequestConfig {\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if a request should be retried\r\n\t * if the ION API returns a 401 HTTP response code.\r\n\t *\r\n\t * A 401 response code usually means that the OAuth token has expired and must be renewed.\r\n\t * A 401 response code could also mean that the user cannot be authorized at all.\r\n\t *\r\n\t * The default value is true.\r\n\t */\r\n\tionApiRetry?: boolean;\r\n\r\n\t/**\r\n\t * Indicates whether tenant should be prepended to the request URL.\r\n\t */\r\n\tsetTenant?: boolean;\r\n}\r\n\r\nexport interface IIonApiOptions {\r\n\t/**\r\n\t * Gets or sets an optional value that indicates if the ION API token should be refreshed or not.\r\n\t *\r\n\t * The default value is false. This property should only be set to true if the current token is invalid.\r\n\t * An ION API call will return HTTP 401 when the token is invalid.\r\n\t */\r\n\trefresh?: boolean;\r\n}\r\n\r\nexport interface IIonApiContext {\r\n\t/**\r\n\t * Gets the ION API base URL.\r\n\t * @return a URL\r\n\t */\r\n\tgetUrl(setTenant?: boolean): string;\r\n\r\n\t/**\r\n\t * Gets an OAUth token.\r\n\t *\r\n\t * The OAuth token must be provided in an Authorization header for each ION API call.\r\n\t * @return an OAuth token\r\n\t */\r\n\tgetToken(): string;\r\n\r\n\t/**\r\n\t * Gets the name of the HTTP Authorization header (Authorization).\r\n\t * @return the authorization header name\r\n\t */\r\n\tgetHeaderName(): string;\r\n\r\n\t/**\r\n\t * Gets the value for the HTTP authorization header including the OAuth token.\r\n\t *\r\n\t * The returned value is an Authorization Request Header Field for an OAuth 2.0 Bearar Token\r\n\t * according to https://tools.ietf.org/html/rfc6750#section-2.1\r\n\t *\r\n\t * Example return value: \"Bearer yg06wrbaBoutluM8Rdb9v4YH0ztx\"\r\n\t *\r\n\t * @return the authorization header value\r\n\t */\r\n\tgetHeaderValue(): string;\r\n}\r\n\r\nexport interface IIonApiCall {\r\n\trelativeUrl: string;\r\n\trequestBody: string;\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport type { IDialogBaseScope } from \"../../defines\";\r\nimport { Helper } from \"../../helper\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\n\r\nimport { FileExtensions, RegexStrings } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IValidation } from \"common/shared-components/base/field-validation\";\r\n\r\nexport interface IExportDialogParams {\r\n\ttype: \"project\" | \"composite component\" | \"dataservice\";\r\n\tfilename: string;\r\n}\r\n\r\nconst getFormattedFilename = (params: IExportDialogParams): string => {\r\n\tconst { type, filename } = params;\r\n\tlet formattedFilename = filename\r\n\t\t.split(\" \")\r\n\t\t.join(\"_\");\r\n\tformattedFilename = formattedFilename.replace(RegexStrings.NO_SPECIAL, \"\");\r\n\tswitch (params.type) {\r\n\t\tcase \"project\":\r\n\t\t\treturn `${formattedFilename}_${Helper.getFormattedDate(\"yyyy-mm-dd\")}`;\r\n\t\tdefault:\r\n\t\t\treturn `${Helper.getFormattedDate(\"yyyy-mm-dd\")}`;\r\n\t}\r\n};\r\n\r\nconst getFileExtension = (params: IExportDialogParams): string => {\r\n\tconst { type } = params;\r\n\tswitch (type) {\r\n\t\tcase \"project\":\r\n\t\t\treturn FileExtensions.PROJECT;\r\n\t\tcase \"composite component\":\r\n\t\t\treturn FileExtensions.COMPOSITE_COMPONENT;\r\n\t\tcase \"dataservice\":\r\n\t\t\treturn FileExtensions.DATA_SERVICE;\r\n\t\tdefault:\r\n\t\t\treturn \".somethingIsWrong\";\r\n\t}\r\n};\r\n\r\nexport class ExportProjectCtrl {\r\n\texportFileName: string;\r\n\tfileExtension: string;\r\n\tdefaultFilename: string;\r\n\terrorList: IValidation[] = [];\r\n\tget isInvalid(): boolean {\r\n\t\treturn this.errorList.length !== 0;\r\n\t}\r\n\r\n\tprivate dialog: IDialog<IExportDialogParams>;\r\n\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<IExportDialogParams>\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.exportFileName = getFormattedFilename(dialog.parameter);\r\n\t\tthis.fileExtension = getFileExtension(dialog.parameter);\r\n\t\tthis.defaultFilename = getFormattedFilename(dialog.parameter);\r\n\t}\r\n\r\n\tvalidate(value: string): boolean {\r\n\t\treturn !RegexStrings.NO_SPECIAL.test(value);\r\n\t}\r\n\r\n\tclose(): void {\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tbutton: DialogButtonType.Cancel\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\texport(): void {\r\n\t\tconst filename: string = Helper.isUndefinedEmpty(this.exportFileName) ?\r\n\t\t\tthis.defaultFilename : this.exportFileName;\r\n\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tvalue: `${filename}.${this.fileExtension}`,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirExportProjectCtrl\", ExportProjectCtrl);\r\n\t}\r\n\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { Config, InjectNames, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { HttpVerbEnum } from \"ng2/common/enums/http-verb.enum\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { HashService, HashSourceTypes } from \"common/services/hash-service\";\r\nimport { HttpService } from \"common/services/http-service\";\r\n\r\nexport class ThemeService {\r\n\tprivate mainTheme = ThemeEnum.LIGHT;\r\n\tprivate canvasTheme: ThemeEnum;\r\n\r\n\tprivate changeStylesheetPromises: IMap<ng.IPromise<void>> = {};\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t\tInjectNames.HASH_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t\tprivate hashService: HashService\r\n\t) {\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Change the href value of the <link> element.\r\n\t *\r\n\t * @param newTheme The theme to be set\r\n\t * @param updateCanvasCss Update the css of the canvas or the designer, always true for runtime\r\n\t */\r\n\tchangeThemeCss(newTheme: ThemeEnum, updateCanvasCss: boolean): ng.IPromise<void> {\r\n\r\n\t\tconst deferred = this.$q.defer<void>();\r\n\r\n\t\t// Make sure that the canvas stylesheet exist, otherwise update main theme\r\n\t\t// #sohoxi-stylesheet-canvas is 0 on runtime\r\n\t\tupdateCanvasCss = updateCanvasCss && angular.element(\"#sohoxi-stylesheet-canvas\").length > 0;\r\n\t\tif (updateCanvasCss) {\r\n\t\t\tif (this.canvasTheme === newTheme) {\r\n\t\t\t\tdeferred.reject();\r\n\r\n\t\t\t\treturn deferred.promise;\r\n\t\t\t}\r\n\t\t\tthis.canvasTheme = newTheme;\r\n\t\t} else {\r\n\t\t\tif (this.mainTheme === newTheme) {\r\n\t\t\t\tdeferred.reject();\r\n\r\n\t\t\t\treturn deferred.promise;\r\n\t\t\t}\r\n\t\t\tthis.mainTheme = newTheme;\r\n\t\t}\r\n\r\n\t\tconst isDesigner = APP_BUILDER;\r\n\t\tconst appRoot = isDesigner ? Config.APP_ROOT : Config.APP_RUNTIME_ROOT;\r\n\t\tlet cssUrl = appRoot + \"assets/xi/\";\r\n\r\n\t\tlet linkId = \"sohoxi-stylesheet\";\r\n\t\tif (updateCanvasCss) {\r\n\t\t\tcssUrl += \"canvas-\";\r\n\t\t\tlinkId += \"-canvas\";\r\n\t\t}\r\n\t\tcssUrl += this.getCssTheme(newTheme, updateCanvasCss);\r\n\t\tconst srcHashData = angular.element(\"#sohoxi-stylesheet-canvas\").length > 0\r\n\t\t\t? HashSourceTypes.DESIGNER\r\n\t\t\t: HashSourceTypes.RUNTIME;\r\n\t\tthis.hashService.getHashFromMapOfHashes(cssUrl, srcHashData).then((hashedString: string) => {\r\n\t\t\t// Solution for transparent themes\r\n\t\t\tconst bodyElement = $(\"body\");\r\n\t\t\tconst transparentClass = \"transparent\";\r\n\t\t\tif (newTheme === ThemeEnum.LIGHT_TRANSPARENT || newTheme === ThemeEnum.DARK_TRANSPARENT) {\r\n\t\t\t\tbodyElement.addClass(transparentClass);\r\n\t\t\t} else {\r\n\t\t\t\tbodyElement.removeClass(transparentClass);\r\n\t\t\t}\r\n\r\n\t\t\tconst linkElement = angular.element(\"#\" + linkId);\r\n\t\t\tthis.changeStylesheet(linkElement, hashedString).then(() => {\r\n\t\t\t\tdeferred.resolve();\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tdeferred.reject();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate getCssTheme(newTheme: ThemeEnum, updateCanvasCss: Boolean): String {\r\n\t\tswitch (newTheme) {\r\n\t\t\tcase ThemeEnum.DEFAULT:\r\n\t\t\tcase ThemeEnum.LIGHT:\r\n\t\t\tcase ThemeEnum.LIGHT_TRANSPARENT:\r\n\t\t\t\treturn \"light-theme.css\";\r\n\t\t\tcase ThemeEnum.DARK:\r\n\t\t\tcase ThemeEnum.DARK_TRANSPARENT:\r\n\t\t\t\treturn \"dark-theme.css\";\r\n\t\t\tcase ThemeEnum.HIGH_CONTRAST:\r\n\t\t\t\treturn \"high-contrast-theme.css\";\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[MashupService] Invalid theme: \" + newTheme);\r\n\t\t\t\treturn \"\";\r\n\t\t}\r\n\t}\r\n\r\n\tprivate changeStylesheet(linkElement: ng.IAugmentedJQuery, url: string): ng.IPromise<void> {\r\n\t\tif (!this.changeStylesheetPromises[url]) {\r\n\t\t\tconst deferred: ng.IDeferred<void> = this.$q.defer<void>();\r\n\r\n\t\t\t// We make a request to avoid FOUC\r\n\t\t\tthis.httpService.executeRequest({ method: HttpVerbEnum.GET, url: url }).then(() => {\r\n\t\t\t\tdeferred.resolve();\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tdeferred.reject();\r\n\t\t\t});\r\n\r\n\t\t\t// Cache\r\n\t\t\tthis.changeStylesheetPromises[url] = deferred.promise;\r\n\t\t}\r\n\t\treturn this.changeStylesheetPromises[url].then(() => {\r\n\t\t\tlinkElement.attr(\"href\", url);\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.THEME_SERVICE, ThemeService);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { IdoProperties, InjectNames, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport {\r\n\tIJsonGenericDatasource2,\r\n\tIJsonLocalIdoDatasource,\r\n} from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport {\r\n\tILocalIdoParameterObject,\r\n\tIParameterObject\r\n} from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\nimport { Helper } from \"../../common/helper\";\r\nimport { HttpService } from \"../../common/services/http-service\";\r\n\r\nexport interface ILocalIDOTestDataService extends IJsonLocalIdoDatasource {\r\n\tisTestIDO: boolean;\r\n}\r\n\r\n// tslint:disable-next-line:interface-name\r\nexport interface IdoProject {\r\n\tserverName: string;\r\n\tserverDesc: string;\r\n\taccessAs: string;\r\n}\r\n\r\n// tslint:disable-next-line:interface-name\r\nexport interface IdoCollection {\r\n\tcollectionName: string;\r\n\tcollectionDesc: string;\r\n\tserverName: string;\r\n\tcreatedBy: string;\r\n\tcreateDate: string;\r\n}\r\n\r\n// tslint:disable-next-line:interface-name\r\nexport interface IdoProperty {\r\n\tpropertyName: string;\r\n\tpropertyType: string;\r\n\r\n\tcolumnName: string;\r\n\r\n\tisReadOnly: boolean;\r\n\tisRequired: boolean;\r\n\r\n\tdataLength?: number;\r\n\tdataType: string;\r\n\r\n\tkeySequence: number;\r\n}\r\n\r\nexport class LocalIdoService {\r\n\tstatic $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t) { }\r\n\r\n\t/**\r\n\t * Returns a list of IDO projects\r\n\t */\r\n\tpublic getIdoProjectList(): ng.IPromise<IdoProject[]> {\r\n\t\tconst path = ServerPaths.LOCAL_IDO + \"projects\";\r\n\r\n\t\treturn this.httpService.executeGet<IdoProject[]>(path);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns list of IDO collections\r\n\t * @param projectName\r\n\t * @param query\r\n\t * @param pageNo\r\n\t */\r\n\tpublic getIdoCollectionList(\r\n\t\tprojectName?: string,\r\n\t\tquery?: string,\r\n\t\tpageNo?: number\r\n\t): ng.IPromise<IdoCollection[]> {\r\n\t\tconst path = ServerPaths.LOCAL_IDO;\r\n\t\tconst parameters = {\r\n\t\t\tprojectName,\r\n\t\t\tquery,\r\n\t\t\tpageNo\r\n\t\t};\r\n\r\n\t\treturn this.httpService.executeGet<IdoCollection[]>(path, parameters);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns list of properties of an IDO\r\n\t * @param collectionName\r\n\t */\r\n\tpublic getIdoProperties(collectionName: string): ng.IPromise<IdoProperty[]> {\r\n\t\tconst path = ServerPaths.LOCAL_IDO + \"properties/?collectionName=\" +  collectionName;\r\n\r\n\t\treturn this.httpService.executeGet(path);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns data from an IDO collection\r\n\t * @param dataservice\r\n\t */\r\n\tpublic getIdoCollection(\r\n\t\tdataservice: IJsonLocalIdoDatasource,\r\n\t\tinputParameterValues?: IMap<string>\r\n\t): ng.IPromise<any[]> {\r\n\t\tconst collectionName = dataservice.resource;\r\n\t\tconst recordCap = dataservice.recordCap.limit;\r\n\t\tconst orderBy = dataservice.orderBy === \"Default Order\" ? \"\" : dataservice.orderBy;\r\n\t\tconst filterQuery = [];\r\n\t\tconst parsedParameters = this.parseParameters(inputParameterValues, dataservice.inputParameters);\r\n\t\tlet parameters = angular.copy(dataservice.outputParameters);\r\n\r\n\t\tif (!(dataservice as ILocalIDOTestDataService).isTestIDO) {\r\n\t\t\tparameters = this.initParameters(parameters);\r\n\t\t}\r\n\r\n\t\tfor (const key in parsedParameters) {\r\n\t\t\tfilterQuery.push(`${key} = '${parsedParameters[key]}'`);\r\n\t\t}\r\n\r\n\t\tlet path = `${ServerPaths.LOCAL_IDO}collection/?\r\n\t\t\tcollectionName=${collectionName}\r\n\t\t\t${filterQuery.length === 0 ? \"\" : `&filter=${encodeURIComponent(filterQuery.join(\" AND \"))}`}\r\n\t\t\t${Helper.isUndefinedOrNull(recordCap) ? \"\" : `&recordCap=${recordCap}`}\r\n\t\t\t${Helper.isUndefinedOrNull(orderBy) ? \"\" : `&orderBy=${orderBy}`}`;\r\n\r\n\t\tpath = Helper.cleanTemplateLiteral(path);\r\n\t\treturn this.httpService.executeGet(path, parameters);\r\n\t}\r\n\r\n\t/**\r\n\t * Updates an IDO Collection entry\r\n\t * @param dataservice\r\n\t * @param inputParameterValues\r\n\t */\r\n\tpublic updateIdoCollectionEntry(\r\n\t\tdataservice: IJsonGenericDatasource2,\r\n\t\tinputParameterValues?: IMap<string>\r\n\t): ng.IPromise<any[]> {\r\n\t\tconst parsedParameters =\r\n\t\t\tthis.parseParameters(inputParameterValues, dataservice.inputParameters);\r\n\r\n\t\treturn this.isValidUpsertRequest(parsedParameters)\r\n\t\t\t.then(() => {\r\n\t\t\t\tconst collectionName = dataservice.resource;\r\n\r\n\t\t\t\tlet path = `${ServerPaths.LOCAL_IDO}collection/?\r\n\t\t\t\t\tcollectionName=${collectionName}`;\r\n\t\t\t\tpath = Helper.cleanTemplateLiteral(path);\r\n\r\n\t\t\t\treturn this.httpService.executePut(path, JSON.stringify(parsedParameters));\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Inserts an IDO Collection entry\r\n\t * @param dataservice Inserts an entry to an IDO Collection\r\n\t * @param inputParameterValues\r\n\t */\r\n\tpublic insertIdoCollectionEntry(\r\n\t\tdataservice: IJsonGenericDatasource2,\r\n\t\tinputParameterValues?: IMap<string>\r\n\t): ng.IPromise<any[]> {\r\n\t\tconst parsedParameters =\r\n\t\t\tthis.parseParameters(inputParameterValues, dataservice.inputParameters);\r\n\t\tconst collectionName = dataservice.resource;\r\n\r\n\t\tlet path =\r\n\t\t\t`${ServerPaths.LOCAL_IDO}collection/?collectionName=${collectionName}`;\r\n\t\tpath = Helper.cleanTemplateLiteral(path);\r\n\r\n\t\treturn this.httpService.executePost(path, JSON.stringify(parsedParameters));\r\n\t}\r\n\r\n\tpublic deleteIdoCollectionEntry(\r\n\t\tdataservice: IJsonGenericDatasource2,\r\n\t\tinputParameterValues?: IMap<string>\r\n\t): ng.IPromise<void> {\r\n\t\tconst parsedParameters =\r\n\t\t\tthis.parseParameters(inputParameterValues, dataservice.inputParameters);\r\n\t\tconst collectionName = dataservice.resource;\r\n\r\n\t\treturn this.isValidUpsertRequest(parsedParameters)\r\n\t\t\t.then(() => {\r\n\t\t\t\tlet path =\r\n\t\t\t\t\t`${ServerPaths.LOCAL_IDO}collection/?collectionName=${collectionName}`;\r\n\t\t\t\tpath = Helper.cleanTemplateLiteral(path);\r\n\r\n\t\t\t\treturn this.httpService.executeDelete(path, JSON.stringify(parsedParameters));\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Re-maps property names to readable\r\n\t * @param parameterValues\r\n\t * @param parameterNames\r\n\t */\r\n\tprivate parseParameters(\r\n\t\tparameterValues: IMap<string>,\r\n\t\tparameterNames: IParameterObject[]\r\n\t): IMap<string> {\r\n\t\tconst result = {} as IMap<string>;\r\n\t\tfor (const key in parameterValues) {\r\n\t\t\tconst targetInput = parameterNames\r\n\t\t\t\t.find(inputParameter => inputParameter.id === key);\r\n\r\n\t\t\tif (targetInput &&\r\n\t\t\t\t!Helper.isUndefinedOrNull(parameterValues[key])\r\n\t\t\t) {\r\n\t\t\t\tresult[targetInput.key] = parameterValues[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Add rowpointer temporary if not added as output-parameter\r\n\t * used as a data id for keep selection\r\n\t * @param parameters\r\n\t */\r\n\tprivate initParameters(parameters: ILocalIdoParameterObject[]): ILocalIdoParameterObject[] {\r\n\t\tif (!parameters.some(item => item.key === IdoProperties.ROW_POINTER)) {\r\n\t\t\tconst rowPointer = {\r\n\t\t\t\tid: \"id\",\r\n\t\t\t\tkey: IdoProperties.ROW_POINTER,\r\n\t\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\t\tparameterType: ParameterTypeEnum.QUERY,\r\n\t\t\t\trequired: false,\r\n\t\t\t\talias: \"\"\r\n\t\t\t};\r\n\t\t\tparameters.push(rowPointer);\r\n\t\t}\r\n\t\treturn parameters;\r\n\t}\r\n\r\n\tprivate isValidUpsertRequest(parsedParameters: IMap<string>): ng.IPromise<void> {\r\n\t\tconst deferred = this.$q.defer<void>();\r\n\t\tconst isUndefinedEmpty = Helper.isUndefinedEmpty;\r\n\r\n\t\tif (isUndefinedEmpty(parsedParameters[IdoProperties.ITEM_ID]) &&\r\n\t\t\t(isUndefinedEmpty(parsedParameters[IdoProperties.RECORD_DATE]) &&\r\n\t\t\t\tisUndefinedEmpty(parsedParameters[IdoProperties.ROW_POINTER]))) {\r\n\t\t\tdeferred.reject(new Error(`\r\n\t\t\tUpdate request must include the ItemId property, or the RecordDate and RowPointer properties.`));\r\n\t\t} else {\r\n\t\t\tdeferred.resolve();\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tstatic add(module: ng.IModule): void {\r\n\t\tmodule.service(InjectNames.LOCAL_IDO_SERVICE, LocalIdoService);\r\n\t}\r\n}","import { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\n\r\nexport interface IInteraction {\r\n\tgetId: () => string;\r\n\tsourceName: string;\r\n\tsourceTriggerName: string;\r\n\ttargetName: string;\r\n\ttargetActionName: string;\r\n\tgetDatabearer: () => IJsonInteraction;\r\n\tgetParameters: () => IInteractionParameter[];\r\n\tgetParameter: (targetKey: string) => IInteractionParameter;\r\n}\r\n\r\nexport interface IInteractionResponse {\r\n\r\n}","import { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IJsonInteractionParameter } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IAvailableTargetField } from \"ng2/common/model/interaction/available-target-field.model\";\r\nexport interface IInteractionParameter {\r\n\ttargetKey: string;\r\n\tvalueSource: IJsonValueSource;\r\n\tgetDatabearer: () => IJsonInteractionParameter;\r\n\ttargetField?: IAvailableTargetField;\r\n}\r\n","import jsonpath from \"jsonpath\";\r\nimport isArray from \"lodash-es/isArray\";\r\n\r\nimport { Subcodes } from \"ng2/common/constants/common.constant\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { ErrorResponse, IErrorResponse } from \"../../error-response\";\r\nimport { Datasource } from \"./datasource\";\r\n\r\nimport { DataServiceHelper } from \"ng2/common/helpers/data-service.helper\";\r\nimport { JsonHelper } from \"ng2/common/helpers/json.helper\";\r\nimport { DatasourceService } from \"../../../components/services/datasource-service\";\r\nimport { Helper } from \"../../helper\";\r\nimport { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\n\r\ninterface IIonApiCall {\r\n\trelativeUrl: string;\r\n\trequestBody: string;\r\n}\r\n\r\nexport class Generic2 extends Datasource {\r\n\tprotected databearer: IJsonGenericDatasource2;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonGenericDatasource2,\r\n\t\tprotected datasourceService: DatasourceService\r\n\t) {\r\n\t\tsuper(obj);\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonGenericDatasource2 {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tgetDetailData(params: IMap<any>): Promise<any> {\r\n\t\tconst databearer = this.databearer;\r\n\t\tconst formatResponse = (result: any) => {\r\n\t\t\tconst detailObject: any = {};\r\n\r\n\t\t\tconst resultToFormat = this.getVerifiedResult(result);\r\n\r\n\t\t\tif (databearer.isOutputFile) {\r\n\t\t\t\tdetailObject[databearer.outputParameters[0].id] = resultToFormat;\r\n\t\t\t} else {\r\n\t\t\t\t// Json response\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdatabearer.outputParameters.forEach((param) => {\r\n\t\t\t\t\t\tdetailObject[param.id] = jsonpath.value(\r\n\t\t\t\t\t\t\tresultToFormat,\r\n\t\t\t\t\t\t\tdatabearer.outputRootElement + param.key\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t});\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"Unable to parse data. The response is not in JSON format.\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn detailObject;\r\n\t\t};\r\n\t\treturn this.loadData(params).then(formatResponse);\r\n\t}\r\n\r\n\tprivate getVerifiedResult(obj: any): any {\r\n\t\treturn isArray(obj) ? obj[0] : obj;\r\n\t}\r\n\r\n\tgetListData(params: IMap<any>): Promise<IListDataItem[]> {\r\n\t\tconst databearer = this.databearer;\r\n\t\treturn this.loadData(params).then((result) => {\r\n\t\t\tconst list: IListDataItem[] = [];\r\n\t\t\tconst listResult = this.getVerifiedResult(result);\r\n\r\n\t\t\tconst rows = jsonpath.query(listResult, databearer.outputRootElement);\r\n\t\t\trows.forEach((row, index) => {\r\n\t\t\t\tconst listObject: IListDataItem = {};\r\n\t\t\t\tdatabearer.outputParameters.forEach((param) => {\r\n\t\t\t\t\tlistObject[param.id] = jsonpath.value(row, \"$.\" + param.key);\r\n\t\t\t\t});\r\n\t\t\t\tif (databearer.objectIdPath) {\r\n\t\t\t\t\tlistObject.id = jsonpath.value(row, \"$.\" + databearer.objectIdPath); //setting the id on the item\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlistObject.id = index.toString();\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(listObject);\r\n\t\t\t});\r\n\t\t\treturn list;\r\n\t\t});\r\n\t}\r\n\r\n\tgetNonParsedData(params: IMap<any>): Promise<any[]> {\r\n\t\treturn this.loadData(params).then((result) => {\r\n\t\t\treturn this.getVerifiedResult(result);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setSubstitutionTags(\r\n\t\turl: string,\r\n\t\tbodyParameter: string,\r\n\t\tparameters: IMap<any>\r\n\t): IIonApiCall {\r\n\t\tlet value: any;\r\n\t\tlet substitutionTag: string;\r\n\t\tlet requestBody;\r\n\r\n\t\tthis.databearer.inputParameters.forEach((datasourceParameter) => {\r\n\t\t\tvalue = parameters[datasourceParameter.id];\r\n\t\t\tswitch (datasourceParameter.parameterType) {\r\n\t\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\t\tsubstitutionTag = DataServiceHelper.getURLVariable(\r\n\t\t\t\t\t\tdatasourceParameter.key\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (url.indexOf(substitutionTag) !== -1) {\r\n\t\t\t\t\t\tif (value !== null && value !== undefined && value !== \"\") {\r\n\t\t\t\t\t\t\t// Exclude all false cases except 0\r\n\t\t\t\t\t\t\turl = url.replace(substitutionTag, encodeURIComponent(value));\r\n\t\t\t\t\t\t} else if (datasourceParameter.required) {\r\n\t\t\t\t\t\t\t// If required throw error\r\n\t\t\t\t\t\t\tthrow new Error(\"Parameter is required\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Null, undefined or \"\", remove substitution tags\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tdatasourceParameter.parameterType === ParameterTypeEnum.MATRIX\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t// Matrix\r\n\t\t\t\t\t\t\t\tconst strToReplace =\r\n\t\t\t\t\t\t\t\t\t\";\" +\r\n\t\t\t\t\t\t\t\t\tDataServiceHelper.getURLVariable(\r\n\t\t\t\t\t\t\t\t\t\tdatasourceParameter.key,\r\n\t\t\t\t\t\t\t\t\t\tParameterTypeEnum.MATRIX\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\turl = url.replace(strToReplace, \"\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// Query\r\n\t\t\t\t\t\t\t\tconst fullSubstitutionTag = DataServiceHelper.getURLVariable(\r\n\t\t\t\t\t\t\t\t\tdatasourceParameter.key,\r\n\t\t\t\t\t\t\t\t\tParameterTypeEnum.QUERY\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\turl = url.replace(fullSubstitutionTag, \"\");\r\n\t\t\t\t\t\t\t\turl = url.replace(\"?&\", \"?\");\r\n\t\t\t\t\t\t\t\turl = url.replace(\"&&\", \"&\");\r\n\r\n\t\t\t\t\t\t\t\t// Rm if there is a & at the end.\r\n\t\t\t\t\t\t\t\t// E.g: LstItmByItmGr?ITGR=004&\r\n\t\t\t\t\t\t\t\tif (url.charAt(url.length - 1) === \"&\") {\r\n\t\t\t\t\t\t\t\t\turl = url.substr(0, url.length - 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(\"Substitution tag does not exist!\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ParameterTypeEnum.BODY_PART: {\r\n\t\t\t\t\trequestBody = this.getRequestBody(\r\n\t\t\t\t\t\tbodyParameter,\r\n\t\t\t\t\t\tdatasourceParameter,\r\n\t\t\t\t\t\tvalue\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t// Invalid inparameter type\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn {\r\n\t\t\trelativeUrl: url,\r\n\t\t\trequestBody,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getRequestBody(\r\n\t\tbodyParameter: string,\r\n\t\tdatasourceParameter: IParameterObject,\r\n\t\tvalue: any\r\n\t): any {\r\n\t\tconst contentType = this.databearer.headers?.[\"Content-Type\"];\r\n\t\tswitch (contentType) {\r\n\t\t\tcase \"text/plain\":\r\n\t\t\t\treturn value;\r\n\t\t\tcase \"application/json\":\r\n\t\t\tdefault: {\r\n\t\t\t\tconst bodyParameters = JSON.parse(bodyParameter);\r\n\t\t\t\tconst schema = JsonHelper.generateSchema(bodyParameters);\r\n\t\t\t\tconst propertyType = JsonHelper.getPropertyType(\r\n\t\t\t\t\tschema,\r\n\t\t\t\t\tdatasourceParameter.key\r\n\t\t\t\t);\r\n\t\t\t\tswitch (propertyType) {\r\n\t\t\t\t\tcase \"number\":\r\n\t\t\t\t\t\tvalue = parseFloat(value);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"string\":\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tjsonpath.value(bodyParameters, datasourceParameter.key, value);\r\n\r\n\t\t\t\treturn bodyParameters;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tloadData(inputParameterValues: IMap<any>): Promise<any> {\r\n\t\tconst defer: ng.IDeferred<any> = this.datasourceService.getDeferred();\r\n\t\tconst databearer = this.databearer;\r\n\t\tconst relativeUrlPath =\r\n\t\t\tdatabearer.suite + databearer.endpoint + databearer.resource;\r\n\t\tconst requestBody = databearer.bodyTemplate;\r\n\t\tconst parameters: IMap<any>[] = [{}];\r\n\t\tconst ionApiCalls: IIonApiCall[] = [];\r\n\t\tconst extraParameters: IMap<any> = {};\r\n\r\n\t\ttry {\r\n\t\t\tthis.databearer.inputParameters.forEach((ionapiParameter) => {\r\n\t\t\t\tconst inputparameter = inputParameterValues[ionapiParameter.id];\r\n\t\t\t\tif (inputparameter && isArray(inputparameter)) {\r\n\t\t\t\t\t// if multiple parameters\r\n\t\t\t\t\tinputparameter.forEach((parameter, index) => {\r\n\t\t\t\t\t\tif (!parameters[index]) {\r\n\t\t\t\t\t\t\tparameters.push({});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparameters[index][ionapiParameter.id] = parameter;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (inputparameter) {\r\n\t\t\t\t\textraParameters[ionapiParameter.id] = inputparameter;\r\n\t\t\t\t\tif (parameters.length === 1) {\r\n\t\t\t\t\t\tparameters[0] = inputParameterValues;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.fillInParameters(\r\n\t\t\t\textraParameters,\r\n\t\t\t\tthis.databearer.inputParameters,\r\n\t\t\t\tparameters\r\n\t\t\t);\r\n\t\t\tparameters.forEach((parameter, index) => {\r\n\t\t\t\tionApiCalls.push(\r\n\t\t\t\t\tthis.setSubstitutionTags(relativeUrlPath, requestBody, parameter)\r\n\t\t\t\t);\r\n\t\t\t\tconst matches = ionApiCalls[index].relativeUrl.match(/{.+}/g);\r\n\t\t\t\tif (matches) {\r\n\t\t\t\t\tthrow new Error(\"Not all string replace positions were replaced\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (e) {\r\n\t\t\tconst error: ErrorResponse = new ErrorResponse(\r\n\t\t\t\te.message,\r\n\t\t\t\tSubcodes.DATA_SERVICE_ERROR,\r\n\t\t\t\te.stack\r\n\t\t\t);\r\n\r\n\t\t\tdefer.reject(error);\r\n\t\t\tconsole.error(e);\r\n\t\t\treturn defer.promise as Promise<any>;\r\n\t\t}\r\n\r\n\t\tconst promises: Promise<any>[] = [];\r\n\r\n\t\tionApiCalls.forEach((ionApiCall) => {\r\n\t\t\tpromises.push(\r\n\t\t\t\tthis.datasourceService\r\n\t\t\t\t\t.ionApiRequest(\r\n\t\t\t\t\t\tionApiCall.relativeUrl,\r\n\t\t\t\t\t\tdatabearer.isOutputFile,\r\n\t\t\t\t\t\tdatabearer.method,\r\n\t\t\t\t\t\tionApiCall.requestBody,\r\n\t\t\t\t\t\tdatabearer.headers\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.then((response: any) => {\r\n\t\t\t\t\t\tif (ionApiCall.relativeUrl.indexOf(\"righttrim=true\") > 0) {\r\n\t\t\t\t\t\t\tresponse = Helper.deepObjectTrim(response);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn response;\r\n\t\t\t\t\t})\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\treturn this.datasourceService.$q.all(promises) as Promise<any>;\r\n\t}\r\n\r\n\tgetMetaData(): Promise<IMetaData> {\r\n\t\tconst deferredMetaData: ng.IDeferred<any> =\r\n\t\t\tthis.datasourceService.getDeferred();\r\n\t\tconst inputFields: IMetaDataField[] = [];\r\n\t\tconst outputFields: IMetaDataField[] = [];\r\n\r\n\t\tthis.databearer.inputParameters.forEach((param) => {\r\n\t\t\tinputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.alias ? param.alias : param.key,\r\n\t\t\t\tMAND: param.required ? \"1\" : \"0\",\r\n\t\t\t\ttype: param.dataType,\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.databearer.outputParameters.forEach((param) => {\r\n\t\t\toutputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.alias ? param.alias : param.key,\r\n\t\t\t\tMAND: \"0\",\r\n\t\t\t\ttype: param.dataType,\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tdeferredMetaData.resolve({\r\n\t\t\tinputFields: inputFields,\r\n\t\t\toutputFields: outputFields,\r\n\t\t});\r\n\r\n\t\treturn deferredMetaData.promise as Promise<any>;\r\n\t}\r\n}\r\n","import jsonpath from \"jsonpath\";\r\nimport isEmpty from \"lodash-es/isEmpty\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type * as sw from \"ng2/common/model/swagger.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\n\r\nexport class JsonHelper {\r\n\t/**\r\n\t * Generate a sample object from a Swagger (JSON-) Schema.\r\n\t * Useful for displaying minimal information about a schema.\r\n\t *\r\n\t * Returns null if the schema type is invalid.\r\n\t * @param schema\r\n\t */\r\n\tstatic generateSample(schema: sw.ISchemaObject, swaggerDoc?: sw.IDocument, ref?: string): any {\r\n\t\tif (schema && !isEmpty(schema)) {\r\n\t\t\tlet tempSchema = schema;\r\n\t\t\tlet currentRef = ref;\r\n\t\t\tlet path: string;\r\n\r\n\t\t\tif (schema.$ref) {\r\n\t\t\t\tswitch (schema.$ref[0]) {\r\n\t\t\t\t\tcase \"#\": //local reference\r\n\t\t\t\t\t\tpath = schema.$ref.split(\"/\")[2]; //assume $ref is \"#/definitions/someName\"\r\n\t\t\t\t\t\tif (!path) {\r\n\t\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\t\"Schema reference error. <br/><br/> Reference not found.\"\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttempSchema = swaggerDoc.definitions[path];\r\n\t\t\t\t\t\tcurrentRef = schema.$ref;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: //TODO: add support for remote and URL references.\r\n\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t\"Schema reference error. <br/><br/> Remote and URL references are not supported in App Builder.\"\r\n\t\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\tif (!tempSchema) {\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"Schema reference error. <br/><br/> Reference not found.\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.getSchemaType(tempSchema)) {\r\n\t\t\t\tcase \"integer\":\r\n\t\t\t\t\treturn tempSchema.default || 1;\r\n\t\t\t\tcase \"number\":\r\n\t\t\t\t\treturn tempSchema.default || 1.0;\r\n\t\t\t\tcase \"string\":\r\n\t\t\t\t\tswitch (tempSchema.format) {\r\n\t\t\t\t\t\tcase \"byte\":\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"SGVsbG8gV29ybGQ=\";\r\n\t\t\t\t\t\tcase \"date\":\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"1985-04-12\";\r\n\t\t\t\t\t\tcase \"date-time\":\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"1985-04-12T23:20:50.52Z\";\r\n\t\t\t\t\t\tcase \"binary\":\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"10101010\";\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\treturn tempSchema.default || \"text\";\r\n\t\t\t\t\t}\r\n\t\t\t\tcase \"boolean\":\r\n\t\t\t\t\treturn tempSchema.default || true;\r\n\t\t\t\tcase \"array\":\r\n\t\t\t\t\tif (Array.isArray(tempSchema.items)) {\r\n\t\t\t\t\t\treturn tempSchema.items.map((item) => JsonHelper.generateSample(item, swaggerDoc, currentRef));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (currentRef && currentRef === ref) {\r\n\t\t\t\t\t\t\treturn [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn [JsonHelper.generateSample(tempSchema.items, swaggerDoc, currentRef)];\r\n\t\t\t\t\t}\r\n\t\t\t\tcase \"object\":\r\n\t\t\t\t\tconst sample: any = {};\r\n\t\t\t\t\tfor (const key in tempSchema.properties) {\r\n\t\t\t\t\t\tif (tempSchema.properties[key].$ref && currentRef\r\n\t\t\t\t\t\t\t&& tempSchema.properties[key].$ref === currentRef) {\r\n\t\t\t\t\t\t\tsample[key] = {};\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsample[key] = JsonHelper.generateSample(tempSchema.properties[key], swaggerDoc, currentRef);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn sample;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"Unknown schema type. <br/><br/> Review your swagger documentation & try again.\"\r\n\t\t\t\t\t);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Schema is missing. <br/><br/> Be sure that your ION API Method has a swagger document.\"\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate static getSchemaType(schema: sw.ISchemaObject): string | string[] {\r\n\t\tif(schema.type) {\r\n\t\t\treturn schema.type;\r\n\t\t}\r\n\r\n\t\t//Try to auto-correct missing schema type\r\n\t\tif (schema.properties) {\r\n\t\t\treturn \"object\";\r\n\t\t} else if (schema.items) {\r\n\t\t\treturn \"array\";\r\n\t\t} else if (schema.format) {\r\n\t\t\tswitch (schema.format) {\r\n\t\t\t\tcase \"float\":\r\n\t\t\t\tcase \"double\":\r\n\t\t\t\t\treturn \"number\";\r\n\t\t\t\tcase \"int32\":\r\n\t\t\t\tcase \"int64\":\r\n\t\t\t\t\treturn \"integer\";\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn \"string\";\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t//default to string to ensure a type\r\n\t\t\treturn \"string\";\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Generate a very simple Swagger schema for a given object.\r\n\t * Throws a TypeError if the given object cannot be mapped to a valid JSONSchema type.\r\n\t *\r\n\t * If given an array, it will only interpret the type of the first element.\r\n\t * @param {number | boolean} sample asd\r\n\t */\r\n\r\n\tstatic generateSchema(\r\n\t\tsample: number | boolean | string | IMap<any> | Array<any>\r\n\t): sw.ISchemaObject {\r\n\t\tconst schema: sw.ISchemaObject = {};\r\n\t\tif (typeof sample === \"number\") {\r\n\t\t\tschema.type = \"number\";\r\n\t\t\tschema.default = sample;\r\n\t\t} else if (typeof sample === \"string\") {\r\n\t\t\tschema.type = \"string\";\r\n\t\t\tschema.default = sample;\r\n\t\t\tconst format = this.getPropertyFormat(sample);\r\n\t\t\tif (format !== undefined) {\r\n\t\t\t\tschema.format = format;\r\n\t\t\t}\r\n\t\t} else if (typeof sample === \"boolean\") {\r\n\t\t\tschema.type = \"boolean\";\r\n\t\t\tschema.default = sample;\r\n\t\t} else if (Array.isArray(sample)) {\r\n\t\t\tschema.type = \"array\";\r\n\t\t\tif (sample.length > 1) {\r\n\t\t\t\tschema.items = sample.map((item) => JsonHelper.generateSchema(item));\r\n\t\t\t} else {\r\n\t\t\t\tschema.items = JsonHelper.generateSchema(sample[0]);\r\n\t\t\t}\r\n\t\t} else if (typeof sample === \"object\" && sample !== null) {\r\n\t\t\tschema.type = \"object\";\r\n\t\t\tschema.properties = {};\r\n\t\t\tfor (const key in sample) {\r\n\t\t\t\tschema.properties[key] = JsonHelper.generateSchema(sample[key]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthrow new TypeError(\"Cannot map \" + sample + \" to a valid type\");\r\n\t\t}\r\n\t\treturn schema;\r\n\t}\r\n\r\n\tprivate static getPropertyFormat(value: string): string {\r\n\t\tconst date = DateHelper.parse(value);\r\n\t\tif (date.toString() !== \"Invalid Date\") {\r\n\t\t\tif (date.getHours() !== 0) {\r\n\t\t\t\treturn \"date-time\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tstatic getPropertyType(\r\n\t\tschema: sw.ISchemaObject,\r\n\t\tpropertyName: string\r\n\t): string {\r\n\t\t// remove special characters\r\n\t\tconst propertyNameMatch = propertyName.match(/[a-zA-Z0-9]+/);\r\n\r\n\t\tconst jsonQuery =\r\n\t\t\tpropertyNameMatch !== null ? `$..${propertyNameMatch}` : \"\";\r\n\r\n\t\tif (isUndefined(jsonQuery) || isEmpty(jsonQuery)) {\r\n\t\t\tthrow new TypeError(\"\");\r\n\t\t}\r\n\r\n\t\tconst propertyType = jsonpath.query(schema, jsonQuery);\r\n\r\n\t\treturn propertyType[0].type;\r\n\t}\r\n\r\n\t/**\r\n\t * Detects if JSON object is cyclic\r\n\t * https://stackoverflow.com/a/14962496\r\n\t * @param obj JSON object\r\n\t */\r\n\r\n\tstatic isCyclic(obj: object): boolean {\r\n\t\tconst seenObjects: object[] = [];\r\n\r\n\t\tconst detect = (item: IMap<any>): boolean => {\r\n\t\t\tif (item && typeof item === \"object\") {\r\n\t\t\t\tif (seenObjects.indexOf(item) !== -1) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tseenObjects.push(item);\r\n\t\t\t\tfor (const key in item) {\r\n\t\t\t\t\tif (item.hasOwnProperty(key) && detect(item[key])) {\r\n\t\t\t\t\t\t// Debugger.log(item, \"cycle at \" + key);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\treturn detect(obj);\r\n\t}\r\n\r\n\t/**\r\n\t * Fixes cyclic references if any\r\n\t * https://stackoverflow.com/a/11616993\r\n\t * @param obj JSON object\r\n\t */\r\n\r\n\tstatic fixCyclic(obj: object): object {\r\n\t\tlet cache: object[] = [];\r\n\t\tconst result = JSON.stringify(obj, (key, value) => {\r\n\t\t\tif (typeof value === \"object\" && value !== null) {\r\n\t\t\t\tif (cache.indexOf(value) !== -1) {\r\n\t\t\t\t\t// Duplicate reference found\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// If this value does not reference a parent it can be deduped\r\n\t\t\t\t\t\treturn JSON.parse(JSON.stringify(value));\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t// discard key if value cannot be deduped\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Store value in our collection\r\n\t\t\t\tcache.push(value);\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t});\r\n\t\tcache = null; // Enable garbage collection\r\n\r\n\t\treturn result ? JSON.parse(result) : null;\r\n\t}\r\n\r\n\t/**\r\n\t * Prettify JSON string\r\n\t * @param jsonString\r\n\t * @param spaces\r\n\t */\r\n\r\n\tstatic prettify(jsonString: object, spaces: number = 2): string {\r\n\t\treturn JSON.stringify(jsonString, null, spaces);\r\n\t}\r\n\r\n\t/**\r\n\t * Tests if a path is invalid json\r\n\t * @param root String representing the json path\r\n\t * @returns Return true if the path is invalid otherwise false\r\n\t */\r\n\tstatic isInvalidJsonPath(root: string): boolean {\r\n\t\tlet result = false;\r\n\t\ttry {\r\n\t\t\tjsonpath.parse(root);\r\n\t\t} catch (e) {\r\n\t\t\tresult = true;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}\r\n","import { ConditionType, InjectNames, Operators, SettingKeys } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport { Helper } from \"../helper\";\r\nimport { IComponent } from \"../IComponent\";\r\nimport { CommonService } from \"./common-service\";\r\n\r\ninterface IUsedExpression {\r\n\tcomponentId: string;\r\n\tconditionType: string;\r\n}\r\n\r\nexport class ExpressionService {\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.COMMON_SERVICE\r\n\t];\r\n\r\n\tprivate currentProjectComponents: IComponent[];\r\n\tprivate triggeredConditions: IUsedExpression[] = [];\r\n\r\n\tconstructor(\r\n\t\tprivate commonService: CommonService\r\n\t) {}\r\n\r\n\tpublic trigger(components: IComponent[]): void {\r\n\t\tthis.triggeredConditions = [];\r\n\t\tthis.currentProjectComponents = components;\r\n\t\tconst currentProject = this.commonService.getCurrentProject();\r\n\t\tconst expressions = currentProject.getExpressions();\r\n\t\texpressions.forEach((expression) => {\r\n\t\t\tconst alreadyTriggered = this.isUsed(expression.usedBy, expression.conditionType);\r\n\r\n\t\t\tif (!alreadyTriggered) {\r\n\t\t\t\tlet sourceValue = expression.sourceProperty;\r\n\t\t\t\tif (expression.source !== \"<static>\") {\r\n\t\t\t\t\tsourceValue = this.getExpressionValue(expression.source, expression.sourceProperty);\r\n\t\t\t\t}\r\n\t\t\t\tlet targetValue = expression.targetProperty;\r\n\t\t\t\tif (expression.target !== \"<static>\") {\r\n\t\t\t\t\ttargetValue = this.getExpressionValue(expression.target, expression.targetProperty);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.runExpression(sourceValue, targetValue, expression);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate isUsed(componentId: string, type: string): boolean {\r\n\t\treturn this.triggeredConditions.some((triggeredCondition) => {\r\n\t\t\treturn triggeredCondition.componentId === componentId &&\r\n\t\t\t\ttriggeredCondition.conditionType === type;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate runExpression(\r\n\t\tsourceValue: string,\r\n\t\ttargetValue: string,\r\n\t\texpression: IJsonExpression\r\n\t): void {\r\n\t\tlet result = false;\r\n\t\t//get the component that uses this expression\r\n\t\tconst component = this.findComponent(expression.usedBy);\r\n\r\n\t\t//if source is from checkbox\r\n\t\tif (typeof sourceValue === \"boolean\") {\r\n\t\t\tsourceValue = sourceValue ? \"1\" : \"0\";\r\n\t\t}\r\n\t\tif (typeof targetValue === \"boolean\") {\r\n\t\t\ttargetValue = targetValue ? \"1\" : \"0\";\r\n\t\t}\r\n\r\n\t\t//used in lower, greater etc\r\n\t\tlet sourceNumber;\r\n\t\tlet targetNumber;\r\n\r\n\t\tif (component) {\r\n\t\t\tswitch (expression.clauseOperator) {\r\n\t\t\t\tcase Operators.EQUALS:\r\n\t\t\t\t\tresult = sourceValue === targetValue;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.NOT_EQUALS:\r\n\t\t\t\t\tresult = sourceValue !== targetValue;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.GREATER:\r\n\t\t\t\t\tsourceNumber = parseInt(sourceValue);\r\n\t\t\t\t\ttargetNumber = parseInt(targetValue);\r\n\t\t\t\t\tresult = sourceNumber > targetNumber;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.LOWER:\r\n\t\t\t\t\tsourceNumber = parseInt(sourceValue);\r\n\t\t\t\t\ttargetNumber = parseInt(targetValue);\r\n\t\t\t\t\tresult = sourceNumber < targetNumber;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.SAME_GREATER:\r\n\t\t\t\t\tsourceNumber = parseInt(sourceValue);\r\n\t\t\t\t\ttargetNumber = parseInt(targetValue);\r\n\t\t\t\t\tresult = sourceNumber >= targetNumber;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.SAME_LOWER:\r\n\t\t\t\t\tsourceNumber = parseInt(sourceValue);\r\n\t\t\t\t\ttargetNumber = parseInt(targetValue);\r\n\t\t\t\t\tresult = sourceNumber <= targetNumber;\r\n\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase Operators.INCLUDES:\r\n\t\t\t\t\tconst targetString = targetValue.trim().toLowerCase();\r\n\t\t\t\t\tconst sourceString = sourceValue.trim().toLowerCase();\r\n\t\t\t\t\tif (sourceString && targetString) {\r\n\t\t\t\t\t\tresult = targetString.includes(sourceString);\r\n\t\t\t\t\t\tthis.triggerCondition(expression, component, result);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate triggerCondition(expression: IJsonExpression, component: IComponent, value: boolean): void {\r\n\t\tif (value) {\r\n\t\t\tthis.triggeredConditions.push({\r\n\t\t\t\tcomponentId: component.getId(),\r\n\t\t\t\tconditionType: expression.conditionType\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tswitch (expression.conditionType) {\r\n\t\t\tcase ConditionType.DISABLE:\r\n\t\t\t\tcomponent.isReadonly = value;\r\n\t\t\t\tbreak;\r\n\t\t\tcase ConditionType.HIDE:\r\n\t\t\t\tcomponent.isVisible = !value;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// type not exists\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getExpressionComponentValue(component: IComponent, property: string): string {\r\n\t\tlet value;\r\n\t\tconst componentDataservice = component.getDatasource();\r\n\t\tconst componentValue = component.getValue(property);\r\n\t\tconst componentBindableValue = component.getBindableValue(property);\r\n\r\n\t\tif (componentDataservice && !Helper.isUndefinedOrNull(componentValue)) {\r\n\t\t\tvalue = componentValue;\r\n\t\t} else if (!Helper.isUndefinedOrNull(componentBindableValue)) {\r\n\t\t\tvalue = componentBindableValue;\r\n\t\t} else if (property.includes(SettingKeys.SELECTED_ITEM)) {\r\n\t\t\tvalue = \"\";\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\t}\r\n\r\n\tprivate getExpressionValue(componentName: string, property: string): string {\r\n\t\tconst component = this.findComponent(componentName);\r\n\t\tif (component) {\r\n\t\t\tproperty = this.getExpressionComponentValue(component, property);\r\n\t\t}\r\n\t\treturn property;\r\n\t}\r\n\r\n\tprivate findComponent(usedByComponent: string): IComponent {\r\n\t\treturn this.currentProjectComponents.find((component) => {\r\n\t\t\treturn component.getId() === usedByComponent;\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.EXPRESSION_SERVICE, ExpressionService);\r\n\t}\r\n}\r\n","import { ThemeEnum } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport type { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport type { IBoundary } from \"ng2/common/model/project/boundary.model\";\r\nimport type { IRuntimeManifest } from \"ng2/common/model/project/mashup/runtime-manifest.model\";\r\n\r\nexport class RuntimeManifest implements IRuntimeManifest {\r\n\tid: string;\r\n\tcreatedBy: string;\r\n\tcreatedByDisplayName: string;\r\n\tcreatedTime: number;\r\n\tdescription: string;\r\n\tdisplayName: string;\r\n\tlastChangedBy: string;\r\n\tlastChangedByDisplayName: string;\r\n\tlastChangedTime: number;\r\n\turlName: string;\r\n\tversion: string;\r\n\tpreviewImg: string;\r\n\ttitle: string;\r\n\tstatus: number;\r\n\turlVariables: IJsonUrlVariable[];\r\n\tmashupBoundaries: IBoundary[];\r\n\tdefaultTheme: ThemeEnum;\r\n\tthemeSwitchEnabled: boolean;\r\n\tshowTitleBar: boolean;\r\n\r\n\tconstructor(arg1?: string | IJsonRuntimeManifest, arg2?: string) {\r\n\t\tif (!arg2 && arg1 && typeof arg1 === \"object\") {\r\n\t\t\tthis.id = arg1.id;\r\n\t\t\tthis.displayName = arg1.displayName;\r\n\t\t\tthis.createdBy = arg1.createdBy;\r\n\t\t\tthis.createdByDisplayName = arg1.createdByDisplayName;\r\n\t\t\tthis.createdTime = arg1.createdTime;\r\n\t\t\tthis.lastChangedBy = arg1.lastChangedBy;\r\n\t\t\tthis.lastChangedByDisplayName = arg1.lastChangedByDisplayName;\r\n\t\t\tthis.lastChangedTime = arg1.lastChangedTime;\r\n\t\t\tthis.version = arg1.version;\r\n\t\t\tthis.description = arg1.description;\r\n\t\t\tthis.previewImg = arg1.previewImg;\r\n\t\t\tthis.title = arg1.title;\r\n\t\t\tthis.urlName = arg1.urlName;\r\n\t\t\tthis.status = arg1.status;\r\n\t\t\tthis.urlVariables = arg1.urlVariables;\r\n\t\t\tthis.showTitleBar = arg1.showTitleBar;\r\n\t\t\tthis.themeSwitchEnabled = arg1.themeSwitchEnabled;\r\n\t\t\tthis.defaultTheme = arg1.defaultTheme;\r\n\t\t\tthis.mashupBoundaries = arg1.mashupBoundaries;\r\n\r\n\t\t} else if (arg1) {\r\n\t\t\tthis.id = (arg1 as string);\r\n\t\t\tthis.displayName = (arg1 as string);\r\n\t\t\tthis.description = arg2;\r\n\t\t\tthis.title = (arg1 as string);\r\n\t\t}\r\n\t}\r\n}\r\n","export enum InforOwnedEnum {\r\n\tFALSE,\r\n\tTRUE\r\n}\r\n","import { IJsonDesignerManifest, IJsonManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\n\r\nexport interface IDesignerManifest extends IJsonDesignerManifest {\r\n\tsetHasFile(fileKey: string, mimeType: string, visibleName: string): void;\r\n\tupdateLastChangedInformation(newManifest: IJsonManifest): void;\r\n}\r\n","import { IJsonComponent, IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IExtendedDataGridColumn } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonLookup extends IJsonComponent {\r\n\tlabel: IJsonValueSource;\r\n\tshowLabel: IJsonValueSource;\r\n\ttext: IJsonValueSource;\r\n\tcolumns: IExtendedDataGridColumn[];\r\n\tboundarySettings: IMap<IJsonLookupSettings>;\r\n\tlookupOutputId: string;\r\n}\r\n\r\nexport interface IJsonLookupSettings extends IJsonComponentSettings {\r\n\trowHeight: string;\r\n\tboxWidth: string;\r\n}\r\n","import { IJsonBoundary } from \"ng2/common/model/databearer/json-boundary.model\";\r\nexport interface IBoundary extends IJsonBoundary {\r\n\tselected?: boolean; // TODO: Should not be saved to server\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport {\r\n\tAlignmentEnum,\r\n\tComponentSizeTypes,\r\n\tDEFAULT_BOUNDARY,\r\n\tFlexOverflowEnum,\r\n\tFlexSizeTypeEnum,\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBorder, IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport type { IFlexboxStyle } from \"common/defines\";\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { IFlexboxComponent } from \"common/interface/iflexbox-component\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\n\r\nimport { Component } from \"components/component\";\r\nimport { LayoutComponent } from \"components/layout-component\";\r\n\r\nimport { ComponentsHelper } from \"components/helper\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport class Flexbox extends LayoutComponent implements IFlexboxComponent {\r\n\tstatic availableOrientations = [\r\n\t\t{ name: \"Vertical\", value: OrientationEnum.VERTICAL },\r\n\t\t{ name: \"Horizontal\", value: OrientationEnum.HORIZONTAL }\r\n\t];\r\n\tstatic availableHorizontalAlignments: IDataPair[] = [\r\n\t\t{ name: \"Left\", value: AlignmentEnum.FLEX_START },\r\n\t\t{ name: \"Center\", value: AlignmentEnum.CENTER },\r\n\t\t{ name: \"Right\", value: AlignmentEnum.FLEX_END }\r\n\t];\r\n\tstatic availableVerticalAlignments: IDataPair[] = [\r\n\t\t{ name: \"Top\", value: AlignmentEnum.FLEX_START },\r\n\t\t{ name: \"Middle\", value: AlignmentEnum.CENTER },\r\n\t\t{ name: \"Bottom\", value: AlignmentEnum.FLEX_END }\r\n\t];\r\n\tstatic availableFlexSizeTypes: IDataPair[] = [\r\n\t\t{ name: \"Relative\", value: FlexSizeTypeEnum.FLEX },\r\n\t\t{ name: \"Pixel\", value: FlexSizeTypeEnum.PIXELS }\r\n\t];\r\n\tstatic availableOverflows: IDataPair[] = [\r\n\t\t{ name: \"Hidden\", value: FlexOverflowEnum.HIDDEN },\r\n\t\t{ name: \"Wrap\", value: FlexOverflowEnum.WRAP },\r\n\t\t{ name: \"Scroll\", value: FlexOverflowEnum.SCROLL }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [];\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([\r\n\t\t{\r\n\t\t\ttitle: \"Orientation\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.ORIENTATION,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Flexbox.availableOrientations,\r\n\t\t\t\tdefaultValue: OrientationEnum.VERTICAL\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Width\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tcondition: \"parent.orientation === \" + OrientationEnum.HORIZONTAL,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.SIZE_TYPE,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Flexbox.availableFlexSizeTypes,\r\n\t\t\t\tdefaultValue: FlexSizeTypeEnum.FLEX\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Value\",\r\n\t\t\t\tref: SettingKeys.SIZE,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.TEXT,\r\n\t\t\t\tdefaultValue: 1\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Height\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tcondition: \"parent.orientation === \" + OrientationEnum.VERTICAL,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.SIZE_TYPE,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Flexbox.availableFlexSizeTypes,\r\n\t\t\t\tdefaultValue: FlexSizeTypeEnum.FLEX\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Value\",\r\n\t\t\t\tref: SettingKeys.SIZE,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.TEXT,\r\n\t\t\t\tdefaultValue: 1\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Overflow\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.OVERFLOW,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Flexbox.availableOverflows,\r\n\t\t\t\tdefaultValue: FlexOverflowEnum.HIDDEN\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Background Color\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.BACKGROUND_COLOR,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.COLOR_PICKER,\r\n\t\t\t\tdefaultValue: undefined\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Alignment\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Horizontal\",\r\n\t\t\t\t\tref: SettingKeys.ALIGNMENT_HORIZONTAL,\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tdataset: Flexbox.availableHorizontalAlignments,\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: AlignmentEnum.FLEX_START\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Vertical\",\r\n\t\t\t\t\tref: SettingKeys.ALIGNMENT_VERTICAL,\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tdataset: Flexbox.availableVerticalAlignments,\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: AlignmentEnum.FLEX_START\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}, {\r\n\t\t\ttitle: \"Border\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\tref: SettingKeys.BORDER,\r\n\t\t\t\t\tinputType: SettingInputKeys.BORDER,\r\n\t\t\t\t\tdefaultValue: { left: 0, top: 0, right: 0, bottom: 0 }\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Color\",\r\n\t\t\t\t\tref: SettingKeys.BORDER_COLOR,\r\n\t\t\t\t\tinputType: SettingInputKeys.COLOR_PICKER,\r\n\t\t\t\t\tdefaultValue: undefined\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}, {\r\n\t\t\ttitle: \"Padding\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Padding\",\r\n\t\t\t\tref: SettingKeys.MARGIN,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.MARGIN,\r\n\t\t\t\tdefaultValue: { left: 10, top: 10, right: 10, bottom: 10 }\r\n\t\t\t}]\r\n\t\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS.filter((settingCategory) => {\r\n\t\t// Removing settings \"margin\" from Component settings\r\n\t\t// It is replaced by the \"padding\" setting on flexbox\r\n\t\tif (settingCategory.settings.some((setting) => {\r\n\t\t\treturn setting.ref === SettingKeys.MARGIN;\r\n\t\t})) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}));\r\n\r\n\tprivate sizeType: FlexSizeTypeEnum;\r\n\tprivate size: number;\r\n\tprotected backgroundColor: string;\r\n\tborder: IJsonBorder;\r\n\tborderColor: string;\r\n\torientation: OrientationEnum;\r\n\tstyleOptions: IMap<string>;\r\n\tisFlexParent = false;\r\n\tchildrenClasses: string;\r\n\r\n\tprotected databearer: IJsonFlexbox;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonFlexbox,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tif (obj) {\r\n\t\t\tthis.border = obj.border ? obj.border : { left: 0, top: 0, right: 0, bottom: 0 };\r\n\t\t\tthis.borderColor = obj.borderColor;\r\n\t\t}\r\n\t\tthis.updateIsFlexParent();\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonFlexbox {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tupdateIsFlexParent(): void {\r\n\t\tthis.isFlexParent = this.databearer.children.some((child) => {\r\n\t\t\treturn child.typedef === Flexbox.name;\r\n\t\t});\r\n\t}\r\n\r\n\tisParent(): boolean {\r\n\t\treturn this.isFlexParent;\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.children.forEach((component) => {\r\n\t\t\tcomponent.clear();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getAlignment(): IMap<string> {\r\n\t\tconst horizAlignment = this.getBoundarySetting<AlignmentEnum>(SettingKeys.ALIGNMENT_HORIZONTAL);\r\n\t\tconst verticAlignment = this.getBoundarySetting<AlignmentEnum>(SettingKeys.ALIGNMENT_VERTICAL);\r\n\r\n\t\treturn {\r\n\t\t\t\"justify-content\": this.getAlignmentProperty(\r\n\t\t\t\tthis.orientation === OrientationEnum.HORIZONTAL ? horizAlignment : verticAlignment),\r\n\t\t\t\"align-items\": this.getAlignmentProperty(\r\n\t\t\t\tthis.orientation === OrientationEnum.HORIZONTAL ? verticAlignment : horizAlignment)\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getAlignmentProperty(alignment: AlignmentEnum): string {\r\n\t\tlet alignmentProperty: string;\r\n\t\tswitch (alignment) {\r\n\t\t\tcase AlignmentEnum.FLEX_START:\r\n\t\t\t\talignmentProperty = \"flex-start\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase AlignmentEnum.CENTER:\r\n\t\t\t\talignmentProperty = \"center\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase AlignmentEnum.FLEX_END:\r\n\t\t\t\talignmentProperty = \"flex-end\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[Flexbox] Invalid alignment:\" + alignment);\r\n\t\t}\r\n\t\treturn alignmentProperty;\r\n\t}\r\n\r\n\tprotected getInlineStyle(): IFlexboxStyle {\r\n\t\tconst generalComponentStyle = super.getInlineStyle();\r\n\t\t// Try to get backgroundcolor from the new boundary settings. If it doesnt exist,\r\n\t\t// try getting it from the databearer\r\n\t\tconst backgroundColor =\r\n\t\t\tthis.getBoundarySetting<string>(SettingKeys.BACKGROUND_COLOR)\r\n\t\t\t|| this.getDatabearer().backgroundColor;\r\n\r\n\t\tconst style: IFlexboxStyle = {\r\n\t\t\t...generalComponentStyle,\r\n\t\t\tbackgroundColor: backgroundColor === undefined ? \"\" : backgroundColor,\r\n\t\t\tpadding: null,\r\n\t\t\t// Width and height have default values in flexbox.less\r\n\t\t\twidth: \"\",\r\n\t\t\theight: \"\",\r\n\t\t};\r\n\r\n\t\tif (this.sizeType === FlexSizeTypeEnum.PIXELS) {\r\n\t\t\tconst value = this.size + \"px\";\r\n\t\t\tstyle.flexGrow = 0;\r\n\t\t\tstyle.flexShrink = 0;\r\n\t\t\tstyle.flexBasis = value;\r\n\t\t} else {\r\n\t\t\tstyle.flexShrink = 1;\r\n\t\t\tstyle.flexBasis = \"auto\";\r\n\t\t\tstyle.flexGrow = this.size;\r\n\t\t}\r\n\r\n\t\treturn style;\r\n\t}\r\n\r\n\tprotected getClassList(): string[] {\r\n\t\tconst wrapClass = \"overflowWrap\";\r\n\t\tconst scrollClass = \"overflowScroll\";\r\n\t\tconst classes = super.getClassList();\r\n\t\tconst overflow = this.getBoundarySetting<FlexOverflowEnum>(SettingKeys.OVERFLOW);\r\n\r\n\t\tswitch (overflow) {\r\n\t\t\tcase FlexOverflowEnum.WRAP:\r\n\t\t\t\tclasses.push(wrapClass);\r\n\t\t\t\tbreak;\r\n\t\t\tcase FlexOverflowEnum.SCROLL:\r\n\t\t\t\tclasses.push(scrollClass);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t// No class needed\r\n\t\t}\r\n\t\treturn classes;\r\n\t}\r\n\r\n\tupdateChildrenClasses(): string {\r\n\t\tconst childrenHasPercentSizes = this.databearer.children.some((child) => {\r\n\t\t\treturn child.boundarySettings[DEFAULT_BOUNDARY.id].width.sizeType === SizeTypeEnum.PERCENT;\r\n\t\t});\r\n\t\tthis.childrenClasses = childrenHasPercentSizes ? ComponentSizeTypes.LARGE : ComponentSizeTypes.SMALL;\r\n\t\treturn this.childrenClasses;\r\n\t}\r\n\r\n\tresizableChildren(_ori: OrientationEnum): boolean { return false; }\r\n\r\n\tgetPxPerPercentComponent(ori: OrientationEnum, _percent: number): number {\r\n\t\tlet pixels = 0;\r\n\t\t// Only calculate for vertical (height) since flexbox doesn't allow content to be placed horizontally yet.\r\n\t\tif (ori === OrientationEnum.VERTICAL) {\r\n\t\t\tthis.children.forEach((child: IComponent) => {\r\n\t\t\t\tif (child.getBoundarySetting<boolean>(SettingKeys.VISIBILITY) &&\r\n\t\t\t\t\tchild.getBoundarySetting<IJsonSize>(SettingKeys.HEIGHT).sizeType === SizeTypeEnum.AUTO) {\r\n\t\t\t\t\tpixels += child.element.outerHeight(true);\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n\t\t}\r\n\t\treturn pixels;\r\n\t}\r\n\r\n\thasIndividualChildSizes(_ori: OrientationEnum): boolean { return true; }\r\n\r\n\tupdateClassesAndStyle(): void {\r\n\t\tconst boundaryId = this.frameworkService.getCurrentBoundary().id;\r\n\t\tthis.orientation = this.getOrientationSetting(boundaryId);\r\n\r\n\t\tthis.sizeType = this.getBoundarySetting<FlexSizeTypeEnum>(SettingKeys.SIZE_TYPE, boundaryId);\r\n\t\tthis.size = this.getBoundarySetting<number>(SettingKeys.SIZE, boundaryId);\r\n\r\n\t\tthis.styleOptions = angular.extend({}, this.getAlignment(), this.getPadding(), this.getBorder());\r\n\t\tthis.updateChildrenClasses();\r\n\r\n\t\tsuper.updateClassesAndStyle();\r\n\t}\r\n\r\n\tprivate getBorder(): IMap<string> {\r\n\t\tconst borderColor = this.borderColor ? this.borderColor : \"transparent\";\r\n\t\tconst border: IMap<string> = {\r\n\t\t\t\"border-top\": this.border?.top + \"px solid \" + borderColor,\r\n\t\t\t\"border-bottom\": this.border?.bottom + \"px solid \" + borderColor,\r\n\t\t\t\"border-right\": this.border?.right + \"px solid \" + borderColor,\r\n\t\t\t\"border-left\": this.border?.left + \"px solid \" + borderColor\r\n\t\t};\r\n\t\treturn border;\r\n\t}\r\n\r\n\tprivate getOrientationSetting(boundaryId: string): OrientationEnum {\r\n\t\tlet orientation = this.getBoundarySetting<OrientationEnum>(SettingKeys.ORIENTATION, boundaryId);\r\n\t\tif (!orientation) {\r\n\t\t\torientation = ComponentsHelper.getDefaultComponentSettingValue<OrientationEnum>(\r\n\t\t\t\tFlexbox.SETTING_FIELDS, SettingKeys.ORIENTATION, \"Orientation\");\r\n\t\t}\r\n\t\treturn orientation;\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./flexbox.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import {\r\n\tInteractionPairOperation,\r\n\tNumbers,\r\n\tSidebarTabTypes,\r\n\tSettingKeys,\r\n\tSettingInputKeys\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport type { IJsonTabComponent, IJsonTabPanel, IJsonTabs } from \"common/model/component/tabs.model\";\r\nimport type { ITab } from \"common/model/sohoxi/sohoxi-tabs.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport type { ITabStyle } from \"common/defines\";\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type { ITabsComponent } from \"common/interface/itabs-component\";\r\n\r\nimport { Component } from \"components/component\";\r\nimport { LayoutComponent } from \"components/layout-component\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport class Tabs extends LayoutComponent implements ITabsComponent {\r\n\tstatic availableOrientations = [\r\n\t\t{ name: \"Horizontal\", value: OrientationEnum.HORIZONTAL },\r\n\t\t{ name: \"Vertical\", value: OrientationEnum.VERTICAL }\r\n\t];\r\n\tstatic DEFAULT_ORIENTAION = OrientationEnum.HORIZONTAL;\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [];\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t(<IComponentSettingCategory[]>[\r\n\t\t{\r\n\t\t\ttitle: \"Orientation\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.ORIENTATION,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Tabs.availableOrientations,\r\n\t\t\t\tdefaultValue: Tabs.DEFAULT_ORIENTAION\r\n\t\t\t}]\r\n\t\t},\r\n\t]).concat(Component.SETTING_FIELDS);\r\n\r\n\tcomponentTabs: IJsonTabComponent[];\r\n\tcurrentTab: IJsonTabComponent;\r\n\tchildrenDatabearers: IJsonTabPanel[];\r\n\torientation: OrientationEnum;\r\n\r\n\tprotected databearer: IJsonTabs;\r\n\r\n\tprivate readyChildrenCount = 0;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTabs,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tthis.childrenDatabearers = this.databearer.children;\r\n\t\tthis.componentTabs = this.databearer.componentTabs;\r\n\t\tthis.currentTab = this.componentTabs[0];\r\n\t\tthis.orientation = obj.orientation || Tabs.DEFAULT_ORIENTAION;\r\n\t}\r\n\r\n\t// Wait for the tab element to exist before rendering\r\n\tprivate updateWhenExist(): void {\r\n\t\tconst checkInterval = 100; // check every 100ms\r\n\t\tconst checkExist = setInterval(() => {\r\n\t\t\tif (this.element.length > 0) {\r\n\t\t\t\tclearInterval(checkExist);\r\n\t\t\t\tthis.element.children().children(\".tab-container\").tabs({\r\n\t\t\t\t\tchangeTabOnHashChange: true,\r\n\t\t\t\t\thashChangeCallback: this.onChangeTab.bind(this),\r\n\t\t\t\t} as any);\r\n\t\t\t\tthis.initializeBindings();\r\n\t\t\t\tthis.updatePanels();\r\n\r\n\t\t\t\tthis.forEachChild((child => {\r\n\t\t\t\t\tchild.initializeBindings();\r\n\t\t\t\t}), true);\r\n\t\t\t}\r\n\t\t}, checkInterval);\r\n\t}\r\n\r\n\tprivate initializeTabs(): void {\r\n\t\tthis.getScope().$applyAsync(() => {\r\n\t\t\tthis.updateWhenExist();\r\n\t\t});\r\n\t}\r\n\r\n\tonComponentReady(component: IComponent): void {\r\n\t\tthis.addChildInstance(component);\r\n\t\tthis.readyChildrenCount++;\r\n\t\tif (this.readyChildrenCount === this.componentTabs.length) {\r\n\t\t\tthis.getScope().onChildrenReady();\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tonChildrenReady(): void {\r\n\t\tthis.initializeTabs();\r\n\t}\r\n\r\n\tisLayoutComponent(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\tresizableChildren(direction: OrientationEnum): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\tgetPxPerPercentComponent(ori: OrientationEnum, percent: number): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\thasIndividualChildSizes(ori: OrientationEnum): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tonChangeTab(selectedId: string): void {\r\n\t\tconst selectedTab = this.componentTabs.find((tab) => {\r\n\t\t\treturn \"#\"+tab.id === selectedId;\r\n\t\t});\r\n\t\tthis.currentTab = selectedTab || this.componentTabs[0];\r\n\t\tthis.updatePanels();\r\n\t}\r\n\r\n\tonOrientationChanged(): void {\r\n\t\tconst tabAPI: ITab = this.element.find(\".tab-container\").data(\"tabs\");\r\n\t\tif (tabAPI) {\r\n\t\t\ttabAPI.destroy();\r\n\t\t\tthis.currentTab = this.componentTabs[0];\r\n\t\t\tthis.updateWhenExist();\r\n\t\t}\r\n\t}\r\n\r\n\tupdatePanels(): void {\r\n\t\tthis.children.forEach((tabPanel: IComponent) => {\r\n\t\t\ttabPanel.updateVisibility();\r\n\r\n\t\t\tif (tabPanel.isVisible) {\r\n\t\t\t\ttabPanel.forEachChild((innerChild) => {\r\n\t\t\t\t\tinnerChild.updateVisibility();\r\n\t\t\t\t}, false);\r\n\r\n\t\t\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected getInlineStyle(): ITabStyle {\r\n\t\tconst style: ITabStyle = super.getInlineStyle();\r\n\t\t// Shifting back padding to margin\r\n\t\tstyle.margin = style.padding;\r\n\t\tstyle.padding = null;\r\n\t\treturn style;\r\n\t}\r\n\r\n\tprotected calcNewSize(sizeObject: IJsonSize, orientation: OrientationEnum, margin = 0): string {\r\n\t\t// Overloading because of margin calculation\r\n\t\tlet retSize = \"\";\r\n\t\tif (this.parent.hasIndividualChildSizes(orientation)) {\r\n\t\t\tif (sizeObject.sizeType === SizeTypeEnum.PERCENT) {\r\n\t\t\t\tconst pxPerPercentComponent = this.parent.getPxPerPercentComponent(orientation, sizeObject.value);\r\n\t\t\t\tretSize = \"calc(\" + (sizeObject.value || Numbers.HUNDRED) + \"% - \" + (pxPerPercentComponent + margin) + \"px)\";\r\n\t\t\t} else if (sizeObject.sizeType === SizeTypeEnum.PIXELS) {\r\n\t\t\t\tretSize = \"calc(\" + sizeObject.value + \"px)\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn retSize;\r\n\t}\r\n\r\n\tupdateValuesWithTranslations(): void {\r\n\t\tthis.componentTabs.forEach((tab: IJsonTabComponent) => {\r\n\t\t\tconst translatedTitle =\r\n\t\t\t\tthis.frameworkService.getTranslatableStringByProperty(this.getId(), tab.id);\r\n\t\t\tif (translatedTitle) {\r\n\t\t\t\tconst globalString = this.frameworkService.getGlobalValue(translatedTitle, this);\r\n\r\n\t\t\t\tif (globalString) {\r\n\t\t\t\t\ttab.value = globalString;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttab.name = translatedTitle;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./tabs.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport {\r\n\tIChanged,\r\n\tInjectNames,\r\n\tLanguageConsts,\r\n\tSettingKeys,\r\n\tComponentNames,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport {\r\n\tIJsonLanguageComponent, ILanguage, IMingleLanguage, IMongooseString\r\n} from \"ng2/common/model/language.model\";\r\nimport { IComponent } from \"common/IComponent\";\r\nimport { InstanceEvent } from \"common/instance-event\";\r\n\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonDatagrid } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport { IJsonRadioButtons } from \"common/model/component/radiobutton.model\";\r\nimport { IJsonTabs } from \"common/model/component/tabs.model\";\r\n\r\nimport { Helper } from \"common/helper\";\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport {\r\n\tDialogService, IDialogOptions, IDialogResult\r\n} from \"common/services/dialog-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\n\r\nimport { IAutoCompleteOptions } from \"common/model/sohoxi/sohoxi-autocomplete.model\";\r\nimport { ILookupOptions } from \"common/model/sohoxi/sohoxi-lookup.model\";\r\n\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IDataGridColumn } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport { IPageRequest } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\nimport { DatagridHelper } from \"common/sohoxi/datagrid-helper\";\r\nimport { Defines } from \"components/defines\";\r\n\r\nexport interface IComponentProperty {\r\n\tcomponent: IComponent;\r\n\tproperty: string;\r\n}\r\n\r\nexport class TranslationManagementService {\r\n\tprivate lookupOptions: ILookupOptions;\r\n\tpublic onTranslationsChangedEvent = new InstanceEvent<IMap<IJsonLanguageComponent[]>>();\r\n\tpublic static $inject = [\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tthis.initLookupOptions();\r\n\t}\r\n\r\n\t/**\r\n\t* Open the translation dialog with component as parameter\r\n\t* This returns a promise with a value that contain a status change and a new value if the\r\n\t* selected component was changed.\r\n\t*\r\n\t* @public\r\n\t* @param {EditorComponent} component\r\n\t* @returns {ng.IPromise<IDialogResult<IChanged>>}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic openTranslations(component?: IComponent, property?: string): ng.IPromise<IDialogResult<IChanged>> {\r\n\t\tconst dialogOptions: IDialogOptions<IComponentProperty> = {\r\n\t\t\ttemplate: require(\"../../designer/editor/component-settings/valuesource-settings/translation-dialog.html\"),\r\n\t\t\ttitle: \"Translations\",\r\n\t\t\tcssClass: \"language-dialog\",\r\n\t\t\tstyle: \"min-width: 1050px; max-width: 1050px;\",\r\n\t\t\tparameter: {\r\n\t\t\t\tcomponent: component,\r\n\t\t\t\tproperty: property\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn this.dialogService.show(dialogOptions);\r\n\t}\r\n\r\n\tpublic openNewStringDialog(value?: string): ng.IPromise<IDialogResult<IMongooseString>> {\r\n\t\tconst options: IDialogOptions<string> = {\r\n\t\t\ttitle: \"Add New String\",\r\n\t\t\ttemplate: require(\"../../common/dialogs/add-string/add-string.html\"),\r\n\t\t\tparameter: value\r\n\t\t};\r\n\t\treturn this.dialogService.show(options);\r\n\t}\r\n\r\n\tpublic addGlobalString(globalString: IMongooseString): ng.IPromise<void> {\r\n\t\treturn this.languageService.addGlobalString(globalString);\r\n\t}\r\n\r\n\tpublic getGlobalString(name: string): string {\r\n\t\treturn this.languageService.getGlobalString(name);\r\n\t}\r\n\r\n\tpublic fetchGlobalStrings(locale?: string): ng.IPromise<IMap<IMongooseString>> {\r\n\t\treturn this.languageService.fetchGlobalStrings(locale);\r\n\t}\r\n\r\n\tpublic getCurrentStringsList(): IMongooseString[] {\r\n\t\tconst currentStringList = [];\r\n\t\tconst currentStringDictionary = this.languageService.getCurrentStrings();\r\n\t\tfor (const key in currentStringDictionary) {\r\n\t\t\tif (currentStringDictionary.hasOwnProperty(key) && typeof currentStringDictionary[key] !== \"string\") {\r\n\t\t\t\tcurrentStringList.push(currentStringDictionary[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn currentStringList;\r\n\t}\r\n\r\n\tpublic saveGlobalTranslations(globalStrings: IMap<IMongooseString[]>): ng.IPromise<void> {\r\n\t\treturn this.languageService.saveGlobalStrings(globalStrings).then(() => {\r\n\t\t\tthis.languageService.loadGlobalStrings();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic deleteGlobalTranslations(globalStrings: IMap<IMongooseString[]>): ng.IPromise<void> {\r\n\t\treturn this.languageService.deleteGlobalStrings(globalStrings).then(() => {\r\n\t\t\tthis.languageService.loadGlobalStrings();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getSelectedLocale(): string {\r\n\t\tconst existNewDefault = this.getProjectLanguages().some((language) => {\r\n\t\t\treturn this.localeEquals(language.key, this.getCurrentLanguage());\r\n\t\t});\r\n\t\treturn existNewDefault ? this.getCurrentLanguage() : this.getDefaultLanguage();\r\n\t}\r\n\r\n\tpublic getCurrentLanguage(): string {\r\n\t\treturn this.languageService.getLanguage();\r\n\t}\r\n\r\n\t/**\r\n\t * Removes translation from current project\r\n\t * Either all translations for a component (to be used when removing a component)\r\n\t * Or remove a specific property's translations\r\n\t *\r\n\t * @public\r\n\t * @param {string} componentId\r\n\t * @param {string} propertyId\r\n\t *\r\n\t */\r\n\tpublic removeTranslation(\r\n\t\tcomponentId: string,\r\n\t\tpropertyId?: string,\r\n\t\ttriggerEvent: boolean = true,\r\n\t): void {\r\n\t\tconst currentProject = this.commonService.getCurrentProject();\r\n\t\tif (!propertyId) {\r\n\t\t\tcurrentProject.removeTranslation(componentId);\r\n\t\t} else {\r\n\t\t\tconst translations = currentProject.getTranslation(componentId);\r\n\t\t\tconst index = translations.findIndex((translation) => {\r\n\t\t\t\treturn translation.property === propertyId;\r\n\t\t\t});\r\n\t\t\ttranslations.splice(index, 1);\r\n\t\t}\r\n\r\n\t\tif (triggerEvent) {\r\n\t\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Get supported languages\r\n\t*\r\n\t* @public\r\n\t* @returns {IMingleLanguage[]}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getSupportedLanguages(): IMingleLanguage[] {\r\n\t\treturn this.languageService.getSupportedLanguages();\r\n\t}\r\n\r\n\t/**\r\n\t* Add new language to all languageComponents.\r\n\t* This method can also take a value as argument instead of the default value\r\n\t*\r\n\t* @public\r\n\t* @param {IMingleLanguage} newLanguage\r\n\t* @param {string} translatedValue\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic addLanguage(newLanguage: IMingleLanguage, translatedValue?: string): void {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\tconst newComponentLanguage = {\r\n\t\t\t\tlocale: newLanguage.key,\r\n\t\t\t\tvalue: translatedValue ? translatedValue : componentLanguage.translations[0].value\r\n\t\t\t};\r\n\t\t\tcomponentLanguage.translations.push(angular.copy(newComponentLanguage));\r\n\t\t});\r\n\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t}\r\n\r\n\t/**\r\n\t* Delete a language on all languageComponents\r\n\t*\r\n\t* @public\r\n\t* @param {IMingleLanguage} deletedlanguage\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic deleteLanguage(deletedlanguage: IMingleLanguage): void {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\tcomponentLanguage.translations.forEach((language, index) => {\r\n\t\t\t\tif (this.localeEquals(language.locale, deletedlanguage.key)) {\r\n\t\t\t\t\tcomponentLanguage.translations.splice(index, 1);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t}\r\n\r\n\t/**\r\n\t* Checks whether the locale keys is equal\r\n\t*\r\n\t* @public\r\n\t* @param {string} locale1\r\n\t* @param {string} locale2\r\n\t* @returns {boolean}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic localeEquals(locale1: string, locale2: string): boolean {\r\n\t\t// Some keys is only the two first characters\r\n\t\tconst stringLength = 3;\r\n\t\tif (locale1.length < stringLength || locale2.length < stringLength) {\r\n\t\t\tconst endIndex = 2;\r\n\t\t\treturn locale1.substring(0, endIndex) === locale2.substring(0, endIndex);\r\n\t\t} else {\r\n\t\t\treturn locale1 === locale2;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Checks whether the component has a corresponding languageComponent\r\n\t*\r\n\t* @public\r\n\t* @param {string} componentId\r\n\t* @returns {boolean}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic hasLanguageComponent(componentId: string, reference: string): boolean {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslations()[componentId];\r\n\t\tlet hasTranslations: boolean = false;\r\n\t\tif (currentTranslations && reference) {\r\n\t\t\thasTranslations = currentTranslations.some((translation) => {\r\n\t\t\t\treturn translation.property === reference;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn hasTranslations;\r\n\t}\r\n\r\n\t/**\r\n\t* Set a new value to the languageComponent with the right component & property\r\n\t*\r\n\t* @public\r\n\t* @param {string} componentId\r\n\t* @param {string} property\r\n\t* @param {ILanguage} updatedTranslation\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic setTranslatableStringByProperty(\r\n\t\tcomponentId: string,\r\n\t\tproperty: string,\r\n\t\tupdatedTranslation: ILanguage,\r\n\t\ttriggerEvent: boolean = true,\r\n\t): void {\r\n\t\tconst componentTranslations = this.commonService.getCurrentProject().getTranslations()[componentId];\r\n\t\tcomponentTranslations.forEach((componentLanguage) => {\r\n\t\t\tif (componentLanguage.property === property) {\r\n\t\t\t\tcomponentLanguage.translations.forEach((language) => {\r\n\t\t\t\t\tif (this.localeEquals(language.locale, updatedTranslation.locale)) {\r\n\t\t\t\t\t\tlanguage.value = updatedTranslation.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif (triggerEvent) {\r\n\t\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setTranslatableStringByTranslationIndex(\r\n\t\tcomponentIndex: number,\r\n\t\ttranslationIndex: number,\r\n\t\tnewValue: string\r\n\t): void {\r\n\t\tconst projectLanguageComponents = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tconst oldValue =  projectLanguageComponents[componentIndex].translations[translationIndex].value;\r\n\t\tif (oldValue !== newValue) { //if not changed, do nothing.\r\n\t\t\tprojectLanguageComponents[componentIndex].translations[translationIndex].value = newValue;\r\n\t\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* returns the default language\r\n\t*\r\n\t* @public\r\n\t* @returns {string}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getDefaultLanguage(): string {\r\n\t\treturn this.languageService.getDefaultLanguage();\r\n\t}\r\n\r\n\t/**\r\n\t* returns the translated value from component & property.\r\n\t* The method can also take in a locale-argument if you want to prioritize on a specific language\r\n\t*\r\n\t* @public\r\n\t* @param {string} componentId\r\n\t* @param {string} property\r\n\t* @param {string} locale\r\n\t* @returns {string}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getTranslatableStringByProperty(componentId: string, property: string, locale?: string): string {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslation(componentId);\r\n\t\tlet currentLanguageKey = this.languageService.getLanguage();\r\n\t\tlet languageValue;\r\n\t\tif (!currentTranslations) {\r\n\t\t\treturn languageValue;\r\n\t\t}\r\n\t\t// first priority is the locale added\r\n\t\t// if not included check if current language is used.\r\n\t\tif (locale) {\r\n\t\t\tcurrentLanguageKey = locale;\r\n\t\t} else if (!this.projectHasLanguage(currentLanguageKey)) {\r\n\t\t\tcurrentLanguageKey = this.getDefaultLanguage();\r\n\t\t}\r\n\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\tif (componentLanguage.property === property) {\r\n\t\t\t\tlanguageValue = this.setTranslationFromComponentLanguage(\r\n\t\t\t\t\tcomponentLanguage.translations,\r\n\t\t\t\t\tcurrentLanguageKey,\r\n\t\t\t\t\tcomponentId,\r\n\t\t\t\t\tproperty\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn languageValue;\r\n\t}\r\n\r\n\t/**\r\n\t* returns the translated value on the header.\r\n\t* TODO: remove when header is a component\r\n\t* The method can also take in a locale-argument if you want to prioritize on a specific language\r\n\t*\r\n\t* @public\r\n\t* @param {string} locale\r\n\t* @returns {string}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getTranslatableHeaderString(locale?: string): string {\r\n\t\tconst project = this.commonService.getCurrentProject();\r\n\t\tlet languageValue;\r\n\t\tconst currentTranslations = project.getTranslations()[project.rootComponent.id];\r\n\t\tif (currentTranslations) {\r\n\t\t\tlet currentLanguageKey = this.languageService.getLanguage();\r\n\t\t\t// first priority is the locale added\r\n\t\t\t// if not included check if current language is used.\r\n\t\t\tif (locale) {\r\n\t\t\t\tcurrentLanguageKey = locale;\r\n\t\t\t} else if (!this.projectHasLanguage(currentLanguageKey)) {\r\n\t\t\t\tcurrentLanguageKey = this.getDefaultLanguage();\r\n\t\t\t}\r\n\t\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\t\tif (componentLanguage.property === SettingKeys.APPLICATION_HEADER) {\r\n\t\t\t\t\tfor (let i = 0; i < componentLanguage.translations.length; i++) {\r\n\t\t\t\t\t\tconst languageComponent = componentLanguage.translations[i];\r\n\t\t\t\t\t\tif (this.localeEquals(languageComponent.locale, currentLanguageKey)) {\r\n\t\t\t\t\t\t\tif (languageComponent.value === \"\" && languageComponent.locale !== LanguageConsts.DEFAULT.key) {\r\n\t\t\t\t\t\t\t\t//if value is empty and not default language, run this again with default language\r\n\t\t\t\t\t\t\t\tlanguageValue = this.getTranslatableHeaderString(LanguageConsts.DEFAULT.key);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tlanguageValue = languageComponent.value;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn languageValue;\r\n\t}\r\n\r\n\t/**\r\n\t* set the translated value to the languageComponent by id\r\n\t*\r\n\t* @public\r\n\t* @param {string} Id\r\n\t* @param {ILanguage} updatedTranslation\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic setTranslatableStringById(id: string, updatedTranslation: ILanguage): void {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tcurrentTranslations.forEach((componentLanguage) => {\r\n\t\t\tif (componentLanguage.id === id) {\r\n\t\t\t\tcomponentLanguage.translations.forEach((language) => {\r\n\t\t\t\t\tif (this.localeEquals(language.locale, updatedTranslation.locale)) {\r\n\t\t\t\t\t\tlanguage.value = updatedTranslation.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t}\r\n\r\n\t/**\r\n\t* checks whether the language is used or not\r\n\t*\r\n\t* @public\r\n\t* @param {string} locale\r\n\t* @returns {boolean}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic projectHasLanguage(locale: string): boolean {\r\n\t\tconst currentTranslations = this.commonService.getCurrentProject().getTranslationsList();\r\n\t\tif (currentTranslations.length === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t// Need only to look at first\r\n\t\treturn currentTranslations[0].translations.some((translation) => {\r\n\t\t\treturn this.localeEquals(translation.locale, locale);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t* returns all the used languages\r\n\t*\r\n\t* @public\r\n\t* @returns {IMingleLanguage[]}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getProjectLanguages(): IMingleLanguage[] {\r\n\t\tconst projectLanguages: IMingleLanguage[] = [LanguageConsts.DEFAULT];\r\n\t\tconst firstTranslation: IJsonLanguageComponent = this.commonService.getCurrentProject().getTranslationsList()[0];\r\n\t\tif (firstTranslation) {\r\n\t\t\tfirstTranslation.translations.forEach((language) => {\r\n\t\t\t\tif (!this.localeEquals(language.locale, LanguageConsts.DEFAULT.key)) {\r\n\t\t\t\t\tprojectLanguages.push({\r\n\t\t\t\t\t\tkey: language.locale,\r\n\t\t\t\t\t\tvalue: this.getLocaleDisplayName(language.locale)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn projectLanguages;\r\n\t}\r\n\r\n\t/**\r\n\t* returns the corresponding displayname from locale if any\r\n\t* or else return default.\r\n\t*\r\n\t* @public\r\n\t* @param {string} locale\r\n\t* @returns {string}\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tpublic getLocaleDisplayName(locale: string): string {\r\n\t\tconst localeDisplayName = this.getSupportedLanguages().find((language) => {\r\n\t\t\treturn this.localeEquals(language.key, locale);\r\n\t\t});\r\n\t\treturn localeDisplayName ? localeDisplayName.value : LanguageConsts.DEFAULT.value;\r\n\t}\r\n\r\n\tpublic createGeneralLanguageComponent(\r\n\t\tcomponentId: string,\r\n\t\treference: string,\r\n\t\tvalue: string,\r\n\t\ttriggerEvent: boolean = true,\r\n\t): void {\r\n\t\tconst newId = Helper.generateUniqueId();\r\n\t\tconst languageComponent: IJsonLanguageComponent = {\r\n\t\t\tid: newId,\r\n\t\t\tcomponentId: componentId,\r\n\t\t\tproperty: reference,\r\n\t\t\ttranslations: []\r\n\t\t};\r\n\t\tif (this.hasLanguageComponent(componentId, reference)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.getProjectLanguages().forEach((language) => {\r\n\t\t\tconst newComponentLanguage: ILanguage = {\r\n\t\t\t\tlocale: language.key,\r\n\t\t\t\tvalue: value\r\n\t\t\t};\r\n\t\t\tlanguageComponent.translations.push(newComponentLanguage);\r\n\t\t});\r\n\t\tthis.commonService.getCurrentProject().addTranslation(languageComponent);\r\n\r\n\t\tif (triggerEvent) {\r\n\t\t\tthis.onTranslationsChangedEvent.raise(this.commonService.getCurrentProject().getTranslations());\r\n\t\t}\r\n\t}\r\n\r\n\tpublic createDefaultLanguageComponents(component: IJsonComponent): void {\r\n\t\tthis.createLanguageComponentFromBindableField(component);\r\n\t\tswitch (component.typedef) {\r\n\t\t\tcase ComponentNames.Tabs:\r\n\t\t\t\t(component as IJsonTabs).componentTabs.forEach((tab) => {\r\n\t\t\t\t\tthis.createGeneralLanguageComponent(component.id, tab.id, tab.name);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase ComponentNames.RadioButton:\r\n\t\t\t\t(component as IJsonRadioButtons).componentRadioButtons.forEach((radioButton) => {\r\n\t\t\t\t\tthis.createGeneralLanguageComponent(component.id, radioButton.id, radioButton.name);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase ComponentNames.Lookup:\r\n\t\t\tcase ComponentNames.Datagrid:\r\n\t\t\t\t(component as IJsonDatagrid|IJsonLookup).columns.forEach((column) => {\r\n\t\t\t\t\tthis.createGeneralLanguageComponent(component.id, column.id, column.name);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t// Add new cases\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getLookupOptions(): ILookupOptions {\r\n\t\treturn this.lookupOptions;\r\n\t}\r\n\r\n\tpublic getAutoOptions(): IAutoCompleteOptions {\r\n\t\tconst autoOptions: IAutoCompleteOptions = {\r\n\t\t\tsource: (searchInput: string, done: Function) => {\r\n\t\t\t\tif (searchInput.charAt(0) === \"{\" && searchInput.length > 1) {\r\n\t\t\t\t\tconst autoCompleteGlobalStrings: string[] = [];\r\n\t\t\t\t\tconst maxItemsToShow = 11;\r\n\t\t\t\t\tconst trimmedInput = searchInput.replace(\"{\", \"\");\r\n\r\n\t\t\t\t\tconst filteredList = this.getCurrentStringsList().filter((item) => {\r\n\t\t\t\t\t\treturn item.Name.substring(0, trimmedInput.length) === trimmedInput;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tconst maxItems = filteredList.length < maxItemsToShow ? filteredList.length : maxItemsToShow;\r\n\t\t\t\t\tfor (let i = 0; i < maxItems; i++) {\r\n\t\t\t\t\t\tautoCompleteGlobalStrings.push(filteredList[i].Name);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdone(trimmedInput, autoCompleteGlobalStrings);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn autoOptions;\r\n\t}\r\n\r\n\tprivate initLookupOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Name\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"Name\",\r\n\t\t\twidth: 250,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"Value\",\r\n\t\t\tname: \"Value\",\r\n\t\t\tfield: \"Value\",\r\n\t\t\twidth: 250,\r\n\t\t\tresizable: false,\r\n\t\t\tsortable: true,\r\n\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t});\r\n\r\n\t\tthis.lookupOptions = {\r\n\t\t\ttitle: \"Select Item\",\r\n\t\t\tfield: (selectedRow: IMap<string>) => {\r\n\t\t\t\tconst propertyName = \"Name\";\r\n\t\t\t\treturn \"{\" + selectedRow[propertyName] + \"}\";\r\n\t\t\t},\r\n\t\t\tmatch: () => {\r\n\t\t\t\t// fake function to bypass an issue on soho-code.\r\n\t\t\t},\r\n\t\t\toptions: {\r\n\t\t\t\tpaging: true,\r\n\t\t\t\tpagesize: 10,\r\n\t\t\t\tcolumns: columns,\r\n\t\t\t\tdataset: [],\r\n\t\t\t\tsource: (request: IPageRequest, done: Function) => {\r\n\t\t\t\t\tconst stringList = this.getCurrentStringsList();\r\n\t\t\t\t\trequest.total = stringList.length;\r\n\t\t\t\t\tlet datasetCopy = angular.copy(stringList);\r\n\t\t\t\t\tif (request.filterExpr && request.filterExpr[0]) {\r\n\t\t\t\t\t\tdatasetCopy = DatagridHelper.getSearchResultOnPaths(datasetCopy, request.filterExpr[0], \"Name\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (request.sortId) {\r\n\t\t\t\t\t\tdatasetCopy = DatagridHelper.sortDatasetByField(datasetCopy, request.sortField, request.sortAsc);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst page = DatagridHelper.getPage(datasetCopy, request);\r\n\t\t\t\t\tdone(page, request);\r\n\t\t\t\t},\r\n\t\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\t\ttoolbar: {\r\n\t\t\t\t\tkeywordFilter: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tprivate setTranslationFromComponentLanguage(\r\n\t\ttranslations: ILanguage[],\r\n\t\tlocale: string,\r\n\t\tcomponentId: string,\r\n\t\treference: string\r\n\t): string {\r\n\t\tlet languageValue: string;\r\n\t\tfor (let i = 0; i < translations.length; i++) {\r\n\t\t\tconst languageComponent = translations[i];\r\n\t\t\tconst localeEquals = this.localeEquals(languageComponent.locale, locale);\r\n\t\t\tif (localeEquals) {\r\n\t\t\t\tconst localeNotDefault = languageComponent.locale !== LanguageConsts.DEFAULT.key;\r\n\t\t\t\tif (languageComponent.value === \"\" && localeNotDefault) {\r\n\t\t\t\t\t//if value is empty and not default language, run this again with default language\r\n\t\t\t\t\tlanguageValue = this.getTranslatableStringByProperty(componentId, reference, LanguageConsts.DEFAULT.key);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlanguageValue = languageComponent.value;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn languageValue;\r\n\t}\r\n\r\n\t/**\r\n\t* create a new language component either by existing values or default values.\r\n\t*\r\n\t* @public\r\n\t* @param {cp.IStaticComponent} componentClass\r\n\t* @param {IJsonComponent} component\r\n\t* @param {string[]} values\r\n\t* @memberof translationManagementService\r\n\t*/\r\n\tprivate createLanguageComponentFromBindableField(component: IJsonComponent): void {\r\n\t\tconst componentClass = Defines.allComponents[component.typedef].class;\r\n\t\tcomponentClass.BINDABLE_FIELDS_2.forEach((bindable, index) => {\r\n\t\t\tif (bindable.valueType === ValueTypeEnum.LOCALIZED_STRING) {\r\n\t\t\t\tconst value: string = ((component as any)[bindable.ref] as IJsonValueSource).value;\r\n\t\t\t\tthis.createGeneralLanguageComponent(\r\n\t\t\t\t\tcomponent.id,\r\n\t\t\t\t\tbindable.ref,\r\n\t\t\t\t\tvalue ? value : bindable.defaultValue.value\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.TRANSLATION_MANAGEMENT_SERVICE, TranslationManagementService);\r\n\t}\r\n}\r\n","\r\nimport type { IJsonRuntimeMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IRuntimeManifest } from \"ng2/common/model/project/mashup/runtime-manifest.model\";\r\n\r\nimport { RuntimeManifest } from \"ng2/common/project/manifest/runtime-manifest\";\r\nimport { Mashup } from \"ng2/common/project/mashup\";\r\n\r\nexport class RuntimeApp extends Mashup {\r\n\tmanifest: IRuntimeManifest;\r\n\r\n\tgetManifest(): IRuntimeManifest {\r\n\t\treturn this.manifest;\r\n\t}\r\n\r\n\tstatic fromObj(obj: IJsonRuntimeMashup): RuntimeApp {\r\n\t\tconst runtimeApp = Mashup.create(RuntimeApp, RuntimeManifest, obj);\r\n\r\n\t\treturn runtimeApp;\r\n\t}\r\n}\r\n","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nexport class HubService {\r\n\tprivate openTabIds: string[] = [];\r\n\tprivate selectedTabId: string;\r\n\r\n\tpublic setOpenedTabIds(tabIds: string[]): void {\r\n\t\tthis.openTabIds = tabIds;\r\n\t}\r\n\r\n\tpublic getOpenedTabIds(): string[] {\r\n\t\treturn this.openTabIds;\r\n\t}\r\n\r\n\tpublic setSelectedTabById(tabId: string): void {\r\n\t\tthis.selectedTabId = tabId;\r\n\t}\r\n\r\n\tpublic getSelectedTabId(): string {\r\n\t\treturn this.selectedTabId;\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.service(InjectNames.HUB_SERVICE, HubService);\r\n\t}\r\n}\r\n","import { InjectNames, SaveProjectSettingEnum, ServerPaths } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { AngularConstants } from \"../../../appbuilder/common/angular-constants\";\r\nimport { Helper } from \"../../../appbuilder/common/helper\";\r\nimport { InstanceEvent } from \"../../../appbuilder/common/instance-event\";\r\nimport { HttpService } from \"../../../appbuilder/common/services/http-service\";\r\nimport { IAppSetting, IProjectSetting } from \"../../model/project-settings\";\r\n\r\n/* tslint:disable:no-bitwise */\r\nexport class SaveService {\r\n\r\n\tpublic saveStates = {\r\n\t\tinProgress: \"Saving...\",\r\n\t\tsaved: \"Last saved at \",\r\n\t\tfailed: \"Failed to save\"\r\n\t};\r\n\tpublic saveStateEvent = new InstanceEvent<string>();\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.HTTP_SERVICE,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate httpService: HttpService,\r\n\t) {\r\n\t}\r\n\r\n\tprivate raiseSaveStateEvent(value: string): void {\r\n\t\tthis.saveStateEvent.raise(value);\r\n\t}\r\n\r\n\tpublic saveCurrent(projectSettings: IProjectSetting, parts: number, status?: number): ng.IPromise<any> {\r\n\t\treturn this.save(projectSettings, parts, status);\r\n\t}\r\n\r\n\tpublic save(projectSettings: IProjectSetting, flags: number, status?: number): ng.IPromise<any> {\r\n\t\tif (flags === SaveProjectSettingEnum.INFO) {\r\n\t\t\treturn this.saveInfo(projectSettings, status);\r\n\t\t} else if (flags === SaveProjectSettingEnum.ROLES) {\r\n\t\t\treturn this.saveRoles(projectSettings);\r\n\t\t} else { //ALL\r\n\t\t\treturn this.saveInfo(projectSettings, status).then(() => {\r\n\t\t\t\treturn this.saveTags(projectSettings).then(() => {\r\n\t\t\t\t\treturn this.saveRoles(projectSettings);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate saveInfo(projectSettings: IProjectSetting, status?: number): ng.IPromise<any> {\r\n\t\tconst appSettings: IAppSetting = {\r\n\t\t\tdisplayName: projectSettings.manifest.displayName,\r\n\t\t\tdescription: projectSettings.manifest.description,\r\n\t\t\tstatus: status !== undefined ? status : projectSettings.manifest.status,\r\n\t\t\turlName: projectSettings.manifest.urlName\r\n\t\t};\r\n\t\treturn this.httpService.executePut(\r\n\t\t\tServerPaths.ADMINISTRATION + \"project/\" + projectSettings.manifest.id + \"/info\", appSettings);\r\n\t}\r\n\r\n\tprivate saveRoles(projectSettings: IProjectSetting): ng.IPromise<any> {\r\n\t\treturn this.httpService.executePut(\r\n\t\t\tServerPaths.ADMINISTRATION + \"project/\" + projectSettings.manifest.id + \"/roles\", projectSettings.roles);\r\n\t}\r\n\r\n\tprivate saveTags(projectSettings: IProjectSetting): ng.IPromise<IJsonRuntimeManifest> {\r\n\t\tconst tags = Helper.getListNames(projectSettings.tags);\r\n\t\tconst url = \"tags/\" + ServerPaths.PROJECT + projectSettings.manifest.id + \"?tagName=\" + tags;\r\n\t\treturn this.httpService.executePost<IJsonRuntimeManifest>(url);\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.SAVE_SERVICE, SaveService);\r\n\t}\r\n}\r\n","import { Component } from \"@angular/core\";\r\n\r\n@Component({\r\n\tselector: \"ng2-component\",\r\n\ttemplate: `\r\n\t\t<h1>ng2 component</h1>\r\n\t\t<a uiSref=\"app\">Back to app</a>\r\n\t\t<ui-view></ui-view>\r\n\t`,\r\n})\r\nexport class Ng2Component {\r\n\tconstructor() {\r\n\t\tconsole.info(\"From ng2 component\");\r\n\t}\r\n\r\n\tpublic ngOnInit(): void {\r\n\t\tconsole.info(\"Ng2Component.ngOnInit()\");\r\n\t}\r\n}\r\n","import \"core-js/es7/reflect\";\r\nimport \"zone.js/dist/zone\";\r\n","/*\r\n\tAssets are included during Webpack's bundling process\r\n\r\n\tTODO: Bundle infor-companyon in the same way\r\n*/\r\nimport \"./user-control-es\";\r\n\r\n// Mingle\r\n// MUPS-2682: Convert to Typescript\r\n// tslint:disable-next-line:no-var-requires\r\nrequire(\"./infor-companyon-client\");","// UserControl.js - Web Client version\r\n\r\nMG = (function() {\r\n   var origin, \r\n       parentDomain,\r\n       postMessage,\r\n       isInitialized = false,\r\n       userControlListener,\r\n       userControlListenerScope,\r\n       handleParentMessage,\r\n       getQueryParameter,\r\n       requestId = 1,\r\n       requestCallbacks = {},\r\n       readyHandlers,\r\n       parameters = {};\r\n\r\n   origin = window.location.href.substring(0,window.location.href.indexOf(\"dynamic/metadata\") + \"dynamic/\".length - 1);\r\n\r\n   // parse query parameters\r\n   (function() {\r\n      var query = window.location.search.substring(1),\r\n          parms = query.split('&'),\r\n          val = \"\",\r\n          i, pos, key;\r\n\r\n      for (i = 0; i < parms.length; i++) {\r\n         pos = parms[i].indexOf('=');\r\n         if (pos > 0) {\r\n            key = parms[i].substring(0, pos);\r\n            parameters[key] = parms[i].substring(pos + 1);\r\n         }\r\n      }\r\n   })();\r\n\r\n   /*\r\n    * private handleParentMessage function: receives messages from host form\r\n    */\r\n   handleParentMessage = function (e) {\r\n      if (e && (e.data !== undefined && e.data !== \"\")) {\r\n         if (e.data === \"}}$etParent~\") {  // initial handshake\r\n            var ix, rh;\r\n            parentDomain = e.origin;      // save parent domain\r\n            isInitialized = true;\r\n            if (readyHandlers) {\r\n               for (ix=0; ix < readyHandlers.length; ix++) {\r\n                  rh = readyHandlers[ix];\r\n                  rh.fn.apply(rh.scope);\r\n               }\r\n               readyHandlers = undefined;\r\n            }\r\n         } else {\r\n            var payload = JSON.parse(e.data);\r\n\r\n            if ( payload.requestId ) {\r\n               if ( typeof(requestCallbacks[payload.requestId]) === \"function\" ) {\r\n                  if (payload.success)\r\n                     requestCallbacks[payload.requestId].apply(window, [payload.value]);\r\n                  delete requestCallbacks[payload.requestId];\r\n               }\r\n            } else if ( payload.fireEvent )\r\n               WSForm.fireEvent(payload.fireEvent);\r\n            else if (userControlListener)\r\n               userControlListener.apply(userControlListenerScope || window, [payload]);\r\n         }\r\n      }\r\n   };\r\n\r\n   // configure communication with parent\r\n   if (window.postMessage) {\r\n      if (window.addEventListener)     // ff, safari, opera\r\n         window.addEventListener(\"message\", handleParentMessage, false);\r\n      else if (window.attachEvent)   // ie\r\n         window.attachEvent(\"onmessage\", handleParentMessage);\r\n\r\n      /*\r\n       * private handleParenMessage function (modern browsers)\r\n       * \r\n       * see below for legacy support\r\n       */\r\n      postMessage = function(msg) {\r\n         if (msg && MG.getIsConnected())\r\n            parent.postMessage(msg, parentDomain);\r\n      };\r\n   } else {\r\n      try {\r\n         if (parent.MG) {\r\n            postMessage = function (msg) {\r\n               parent.MG.UserControl.postMessageDirect(msg, window);\r\n            };\r\n         }\r\n      } catch (err) {\r\n         postMessage = function () { alert(\"A user control is not supported by your browser: \" + err.message); };\r\n      }\r\n\r\n      if (!postMessage)\r\n         postMessage = function () { alert(\"A user control is not supported by your browser\"); };\r\n   }\r\n\r\n   return {\r\n\r\n      /*\r\n       * MG.generateServerEvent function - user control events\r\n       */\r\n      generateServerEvent: function(args) {\r\n         var request = { \r\n            cmd: \"gse\", \r\n            args: args \r\n         };\r\n\r\n         MG.sendWebUserControlRequest(request);\r\n      },\r\n\r\n      /*\r\n       * MG.sendWebUserControlRequest function - web user control requests\r\n       */\r\n      sendWebUserControlRequest: function(payload, callback) {\r\n         \r\n         if (typeof(callback) === \"function\") {\r\n            payload.requestId = requestId++;\r\n            requestCallbacks[payload.requestId.toString()] = callback;\r\n         }\r\n\r\n         postMessage(\r\n            JSON.stringify({\r\n               type: 'webuserctrl', \r\n               payload: payload\r\n            })\r\n         );\r\n      },\r\n\r\n      /*\r\n       * MG.getQueryParameter function - parse query parameters\r\n       */\r\n      getQueryParameter: function(name) {\r\n         name = name.replace(/[\\[]/, \"\\\\\\[\").replace(/[\\]]/, \"\\\\\\]\");\r\n         var regex = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\"),\r\n            results = regex.exec(location.search);\r\n         return results == null ? \"\" : decodeURIComponent(results[1].replace(/\\+/g, \" \"));\r\n      },\r\n   \r\n      /*\r\n       * MG.onReady function - queue functions to fire when form is ready\r\n       */\r\n      onReady: function(fn, scope) {\r\n         if (typeof(fn) === \"function\") {\r\n            if (isInitialized)\r\n               fn.apply(scope || window);\r\n            else {\r\n               readyHandlers = readyHandlers || [];\r\n               readyHandlers.push({\r\n                  fn: fn,\r\n                  scope: scope || window\r\n               });\r\n            }\r\n         }\r\n      },\r\n\r\n      /*\r\n       * MG.getIsConnected function - true if form communication is initialized\r\n       */\r\n      getIsConnected:   function()  { return isInitialized; },\r\n\r\n      getOrigin: function () { return origin; },\r\n\r\n      getPlatform: function() { return parameters[\"platform\"]; },\r\n\r\n      getTheme: function() { return parameters[\"theme\"]; },\r\n\r\n      getWebClientUrl: function() { return decodeURIComponent( parameters[\"weburl\"] ); },   // really just for smart client\r\n\r\n      getSession: function() { return parameters[\"session\"]; },\r\n\r\n      getConfigName: function() { return parameters[\"config\"]; },\r\n\r\n      Ajax: {\r\n         /*\r\n          * MG.Ajax.get function - execute ajax get request\r\n          */\r\n         get: function(path, cb, onError) {\r\n            var req = new XMLHttpRequest(),\r\n                url;\r\n\r\n            if (path.indexOf(\"?\") === -1)\r\n               url = origin + path + \"?zid=\" + new Date().getTime();\r\n            else\r\n               url = origin + path + \"&zid=\" + new Date().getTime();\r\n\r\n            req.onreadystatechange = function() {\r\n               if (req.readyState === 4) {    // complete\r\n                  req.onreadystatechange = null;\r\n                  if (req.status === 200) {   // success\r\n                     if (typeof(cb) === \"function\")\r\n                        cb(JSON.parse(req.responseText));\r\n                  } else {\r\n                     if (typeof(onError) === \"function\")\r\n                        onError();\r\n                  }\r\n               }\r\n            };\r\n\r\n            req.open(\"GET\", url, true);\r\n            req.send();\r\n         },\r\n\r\n         /*\r\n          * MG.Ajax.post function - execute ajax post request\r\n          */\r\n         post: function(path, payload, cb, onError) {\r\n            var req = new XMLHttpRequest(),\r\n                url = origin + path;\r\n\r\n            req.onreadystatechange = function () {\r\n               if (req.readyState === 4) { // complete\r\n                  req.onreadystatechange = null;\r\n                  if (req.status === 200) { // success\r\n                     if (typeof(cb) === \"function\")\r\n                        cb(JSON.parse(req.responseText));\r\n                  } else {\r\n                     if (typeof(onError) === \"function\")\r\n                        onError();\r\n                  }\r\n               }\r\n            };\r\n\r\n            req.open(\"POST\", url, true);\r\n            req.send(JSON.stringify(payload));\r\n         }\r\n      },\r\n\r\n      UserControl: {\r\n         /*\r\n          * MG.UserControl.registerListener function - register listener for server \r\n          * side assembly messages\r\n          */\r\n         registerListener: function(callback, scope) {\r\n            userControlListener = callback;\r\n            userControlListenerScope = scope;\r\n         },\r\n      }\r\n   }\r\n})();\r\n\r\nWSForm = (function() {\r\n   var subscriptions = {};\r\n\r\n   return {\r\n      UserControl: {\r\n         /*\r\n          * WSForm.UserControl.registerListener function - register listener for server \r\n          * side assembly messages\r\n          */\r\n         registerListener: function(callback, scope) { MG.UserControl.registerListener(callback, scope); },\r\n         \r\n         /*\r\n          * WSForm.UserControl.invoke: call the Invoke method on server-side user control class\r\n          */\r\n         invoke: function(args) { MG.generateServerEvent(args); },\r\n\r\n         /*\r\n          * WSForm.UserControl.getName function - component name for this control\r\n          */\r\n         getName: function() { return MG.getQueryParameter('name'); }\r\n      },\r\n\r\n      /*\r\n       * WSForm.fireEvent function - called by framework to fire subscribed events\r\n       */\r\n      fireEvent: function(eventName) {\r\n         if (typeof(subscriptions[eventName]) === \"function\") {\r\n            subscriptions[eventName](eventName);\r\n         }\r\n      },\r\n\r\n      /*\r\n       * WSForm.getFormId function - get unique form id\r\n       */\r\n      getFormId: function() { return MG.getQueryParameter('formId'); },\r\n\r\n      /*\r\n       * WSForm.getCompValue function - get the value of a form component\r\n       */\r\n      getCompValue: function(name, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"getcomp\", name: name }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.setCompValue function - set the value of a form component\r\n       */\r\n      setCompValue: function(name, value, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"setcomp\", name: name, value: value }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.getVarValue function - get the value of a variable\r\n       */\r\n      getVarValue: function(name, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"getvar\", name: name }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.setVarValue function - set the value of a variable\r\n       */\r\n      setVarValue: function(name, value, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"setvar\", name: name, value: value }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.setPropValue function - get the value of a variable\r\n       */\r\n      getPropValue: function(name, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"getprop\", name: name }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.setPropValue function - set the value of a property\r\n       */\r\n      setPropValue: function(name, value, cb) {\r\n         MG.sendWebUserControlRequest({ cmd: \"setprop\", name: name, value: value }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.invoke function - invoke a form script method returning success code\r\n       */\r\n      invoke: function(method) {\r\n         var args = [],\r\n             cb;\r\n\r\n         for (var i = 1; i < arguments.length; i++) {\r\n            if (typeof(arguments[i]) === \"function\")\r\n               cb = arguments[i];\r\n            else\r\n               args.push(arguments[i]);\r\n         }\r\n\r\n         MG.sendWebUserControlRequest({ cmd: \"invoke\", name: method, args: args }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.call function - call a form script method with return value\r\n       */\r\n      call: function(method) {\r\n         MG.sendWebUserControlRequest({\r\n            cmd: \"call\",\r\n            name: method.name,\r\n            args: method.parameters\r\n         }, method.onCompleted);\r\n      },\r\n\r\n      /*\r\n       * WSForm.generate function - generate a form event\r\n       */\r\n      generate: function(eventName, cb, async) {\r\n         MG.sendWebUserControlRequest({ cmd: \"generate\", name: eventName, args: (async == true) }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.subscribe function - subscribe to a form event\r\n       */\r\n      subscribe: function(eventName, handler, cb) {\r\n         subscriptions[eventName] = handler;\r\n         MG.sendWebUserControlRequest({ cmd: \"subscribe\", name: eventName }, cb );\r\n      },\r\n\r\n      /*\r\n       * WSForm.getImageSrc function - get a binary property as an image\r\n       */\r\n      getImageSrc: function(propertyName, row, cb) {\r\n         var src = MG.getOrigin() + \"/form/\" + WSForm.getFormId() + \"/getimage/\" + propertyName;\r\n\r\n         if ( row !== undefined )\r\n            src += \"/\" + row.toString();\r\n\r\n         if (typeof(cb) === \"function\")\r\n            cb(src + \"?zid=\" + new Date().getTime());\r\n      }\r\n   };\r\n})();\r\n\r\nWSUserControl = {       // backward compatibility\r\n   generateServerEvent: MG.generateServerEvent,\r\n   registerCallback:    MG.UserControl.registerListener,\r\n   onReady:             MG.onReady\r\n};  \r\n\r\n","// MUPS-2682: Convert to Typescript\r\n\r\nif (typeof infor == \"undefined\") {\r\n\tinfor = {};\r\n}\r\n\r\nif (typeof infor.companyon == \"undefined\") {\r\n\tinfor.companyon = {};\r\n}\r\n\r\ninfor.companyon.client = {};\r\ninfor.companyon.client.listeningMessageTypes = {};\r\ninfor.companyon.client.drillbackSelector = \"a.companyon-drillbacklink\";\r\ninfor.companyon.client.favoritesSelector = \"a.companyon-favoritelink\";\r\nvar MsgType = {\r\n\tContextDimensionChanged: \"contextDimensionChanged\",\r\n};\r\n\r\n/**\r\n * Message Handler for post messages\r\n **/\r\ninfor.companyon.client.messageReceiver = function (e) {\r\n\tinfor.companyon.client.executeMessage(e.data);\r\n};\r\n\r\ninfor.companyon.client.executeMessage = function (msg) {\r\n\tif (msg == null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\ttry {\r\n\t\tmsg = $.parseJSON(msg);\r\n\t} catch (e) {\r\n\t\t// ignore any errors during the parsing of the JSON message and return from the message handler\r\n\t\t// TODO: Once the client side logging is made available to core products, we can use the client side\r\n\t\t// logging to log this message.\r\n\t\treturn;\r\n\t}\r\n\tvar type = msg.type;\r\n\tvar data = msg.data;\r\n\r\n\tif (type == null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar registeredHandlers = infor.companyon.client.listeningMessageTypes[type] || [];\r\n\tvar wildCardHandlers = infor.companyon.client.listeningMessageTypes[\"*\"] || [];\r\n\tvar allHandlers = {};\r\n\t$.extend(allHandlers, registeredHandlers, wildCardHandlers);\r\n\t$.each(allHandlers, function (index, elem) {\r\n\t\tvar registeredHandler = elem.handler;\r\n\t\ttry {\r\n\t\t\tregisteredHandler(data, type);\r\n\t\t} catch (e) {\r\n\t\t\t//ignore any errors during the execution of the handler and continue to the next handler\r\n\t\t}\r\n\t});\r\n\tallHandlers = {};\r\n};\r\n\r\ninfor.companyon.client.sendRelayMessage = function (type, data) {\r\n\t// Send a proxy message to the top window and the message shall inturn be routed back to the\r\n\t// application sharepoint site iframe from the top window\r\n\r\n\tvar proxyMessage = {\r\n\t\ttype: type,\r\n\t\tdata: data,\r\n\t};\r\n\tinfor.companyon.client.sendMessage(\"prepareRelayProxyMessage\", proxyMessage);\r\n};\r\n\r\n/**\r\n *  send a message to the  parent window.\r\n *\r\n */\r\ninfor.companyon.client.sendMessageToParent = function (type, data) {\r\n\tvar message = {\r\n\t\ttype: type,\r\n\t\tdata: data,\r\n\t};\r\n\tvar encodedMessage = JSON.stringify(message);\r\n\r\n\tvar targetWindow = null;\r\n\r\n\tif (window.postMessage != null) {\r\n\t\t// Send a proxy message to the top window and the message shall inturn be routed back to the\r\n\t\t// application sharepoint site iframe from the top window\r\n\t\tvar proxyMessage = {\r\n\t\t\ttype: \"workspaceProxyMessage\",\r\n\t\t\tdata: message,\r\n\t\t};\r\n\t\tvar encodedProxyMessage = JSON.stringify(proxyMessage);\r\n\t\tif (window.parent != window) {\r\n\t\t\twindow.parent.postMessage(encodedProxyMessage, \"*\");\r\n\t\t}\r\n\t\t//window.parent.postMessage(encodedMessage, \"*\");\r\n\t}\r\n};\r\n\r\n/**\r\n *  send a message to the infor app container.\r\n *\r\n */\r\ninfor.companyon.client.sendMessage = function (type, data, target) {\r\n\tvar message = {\r\n\t\ttype: type,\r\n\t\tdata: data,\r\n\t};\r\n\tvar encodedMessage = JSON.stringify(message);\r\n\r\n\tvar targetWindow = null;\r\n\r\n\tif (infor.companyon.containerWindow === true) {\r\n\t\t//client is part of the main window, so use the current window to send the message\r\n\t\t//if ie7, use the companyon function to send the message\r\n\r\n\t\tif (window.postMessage != null) {\r\n\t\t\twindow.postMessage(encodedMessage, \"*\");\r\n\t\t} else {\r\n\t\t\t//workaround for ie7, might be able to call the messagereceiver directly in all cases!\r\n\t\t\tif (typeof infor.companyon.messageReceiver == \"function\") {\r\n\t\t\t\tinfor.companyon.messageReceiver({ data: encodedMessage });\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\t// The below logic was being used for drillbacks in dashboards where we allowed drillbacks from pop-up windows\r\n\t\tif (window.opener != null) {\r\n\t\t\t//cannot call postMessage on opener directly, call a JS function\r\n\t\t\t//http://blogs.msdn.com/b/ieinternals/archive/2009/09/16/bugs-in-ie8-support-for-html5-postmessage-sessionstorage-and-localstorage.aspx\r\n\r\n\t\t\ttry {\r\n\t\t\t\twindow.opener.infor.companyon.client.sendMessageProxy(encodedMessage);\r\n\t\t\t\twindow.opener.focus();\r\n\t\t\t\twindow.opener.document.focus();\r\n\t\t\t} catch (e) {\r\n\t\t\t\t//ignore errors;\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (arguments.length == 3) {\r\n\t\t\tvar encodedProxyMessage = JSON.stringify(message);\r\n\t\t\targuments[2].postMessage(encodedProxyMessage, \"*\");\r\n\t\t} else if (window.postMessage != null) {\r\n\t\t\t// Send a proxy message to the top window and the message shall inturn be routed back to the\r\n\t\t\t// application sharepoint site iframe from the top window\r\n\t\t\tvar proxyMessage = {\r\n\t\t\t\ttype: \"workspaceProxyMessage\",\r\n\t\t\t\tdata: message,\r\n\t\t\t};\r\n\t\t\tvar encodedProxyMessage = JSON.stringify(proxyMessage);\r\n\t\t\tif (window.top != window) {\r\n\t\t\t\twindow.top.postMessage(encodedProxyMessage, \"*\");\r\n\t\t\t}\r\n\t\t\t//window.parent.postMessage(encodedMessage, \"*\");\r\n\t\t} else {\r\n\t\t\t// for IE7\r\n\t\t\t// workaround - if the frame is not there, wait until it is created in the parentpage (usually happens during initValues message)\r\n\r\n\t\t\tfunction testFrameAndSend() {\r\n\t\t\t\tvar frame = window.parent.frames[\"inforCommFrame\"];\r\n\t\t\t\tif (frame != null) {\r\n\t\t\t\t\tframe.sendMessage(encodedMessage, infor.companyon.client.sharePointUrl);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetTimeout(testFrameAndSend, 100);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttestFrameAndSend();\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * to be called from popup windows, opened from the same domain\r\n */\r\ninfor.companyon.client.sendMessageProxy = function (encodedMessage) {\r\n\tvar messageObject = $.evalJSON(encodedMessage);\r\n\tinfor.companyon.client.sendMessage(messageObject.type, messageObject.data);\r\n};\r\n\r\n/**\r\n * Send \"prepareApplicationDrillback\" message to handle the drillback execution\r\n **/\r\ninfor.companyon.client.sendPrepareDrillbackMessage = function (href) {\r\n\tvar data = {\r\n\t\tlink: href,\r\n\t};\r\n\tinfor.companyon.client.sendMessage(\"prepareApplicationDrillback\", data);\r\n\tinfor.companyon.client.sendMessage(\"syndication.complete\", {});\r\n};\r\n\r\n/**\r\n * Send Height Adjustment message . This is specifically provided in infor-companyon-client to\r\n * deal with different versions.\r\n */\r\n\r\ninfor.companyon.client.adjustHeight = function (height) {\r\n\tinfor.companyon.client.sendMessage(window.name, { height: height + \"px\" });\r\n\tinfor.companyon.client.sendMessage(MsgType.ContextDimensionChanged, {\r\n\t\theight: height,\r\n\t\tiframeName: window.name,\r\n\t});\r\n};\r\n\r\n/**\r\n * Send prepareFavoriteContext to handle the shortcut execution\r\n **/\r\ninfor.companyon.client.sendPrepareFavoritesMessage = function (href) {\r\n\tvar data = {\r\n\t\tlink: href,\r\n\t};\r\n\tinfor.companyon.client.sendMessage(\"prepareFavoriteContext\", data);\r\n};\r\n\r\n//to be called from Silverlight because you cannot call a javascript methods with dots from Silverlight\r\nfunction inforCompanyOnPrepareFavorites(href) {\r\n\tinfor.companyon.client.sendPrepareFavoritesMessage(href);\r\n}\r\n\r\n/**\r\n * Function to retrieve the query string parameter value for a given key from the URL in the current window\r\n **/\r\ninfor.companyon.client.getValueQuerystring = function (key) {\r\n\tvar key = key.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\r\n\tvar regex = new RegExp(\"[\\\\?&]\" + key + \"=([^&#]*)\");\r\n\tvar qs = regex.exec(window.location.href);\r\n\r\n\tvar value = null;\r\n\tif (qs != null) {\r\n\t\tvalue = qs[1];\r\n\t}\r\n\treturn value;\r\n};\r\n\r\n/**\r\n * Function to register a handler for a given message type in a given namespace. The array of\r\n * registered messagetypes is updated and a message (of type workspaceClientSubscribe) is sent to the Workspace.\r\n **/\r\ninfor.companyon.client.registerMessageHandler = function (messageType, handler, namespace) {\r\n\tif (messageType == null || handler == null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar handlers = infor.companyon.client.listeningMessageTypes[messageType] || [];\r\n\r\n\thandlers.push({\r\n\t\thandler: handler,\r\n\t\tnamespace: namespace,\r\n\t});\r\n\r\n\tinfor.companyon.client.listeningMessageTypes[messageType] = handlers;\r\n\r\n\tif (arguments.length == 4) {\r\n\t\tinfor.companyon.client.sendMessageToParent(\"workspaceClientSubscribe\", {\r\n\t\t\tmessageType: messageType,\r\n\t\t\tiframeName: window.name,\r\n\t\t});\r\n\t} else {\r\n\t\t//inform the parent about this message type\r\n\t\tinfor.companyon.client.sendMessage(\"workspaceClientSubscribe\", {\r\n\t\t\tmessageType: messageType,\r\n\t\t\tiframeName: window.name,\r\n\t\t});\r\n\t}\r\n};\r\n\r\n/**\r\n * Function to unregister a handler for a given message type in a given namespace. Currently, we do not\r\n * send a message to Workspace to cleanup the subscription.\r\n **/\r\ninfor.companyon.client.unRegisterMessageHandler = function (messageType, namespace) {\r\n\tif (messageType == null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar handlers = infor.companyon.client.listeningMessageTypes[messageType] || [];\r\n\tvar newHandlers = [];\r\n\t$.each(handlers, function (index, elem) {\r\n\t\tif (elem.namespace != namespace) {\r\n\t\t\tnewHandlers.push(elem);\r\n\t\t}\r\n\t});\r\n\r\n\tinfor.companyon.client.listeningMessageTypes[messageType] = newHandlers;\r\n};\r\n\r\n// bind and unbind were the function names for message handler registration. Hence they are still being\r\n// maintained for backward compatibility.\r\ninfor.companyon.client.bind = infor.companyon.client.registerMessageHandler;\r\ninfor.companyon.client.unbind = infor.companyon.client.unRegisterMessageHandler;\r\n\r\n//// New Function which needs to be called for Environment Information\r\ninfor.companyon.client.getEnvironmentInformation = function (callback) {\r\n\tvar randomNumber = infor.companyon.client.getRandomNumber();\r\n\tvar data = {};\r\n\tdata.MessageId = randomNumber;\r\n\t//// Step 1: Un-register\r\n\tinfor.companyon.client.unRegisterMessageHandler(\"processEnvironmentInformation_\" + randomNumber);\r\n\r\n\t//// Step 2: Register Handler\r\n\tinfor.companyon.client.registerMessageHandler(\r\n\t\t\"processEnvironmentInformation_\" + randomNumber,\r\n\t\tfunction (data) {\r\n\t\t\tcallback(data);\r\n\t\t}\r\n\t);\r\n\r\n\t//// Step 3: sendMessage\r\n\tinfor.companyon.client.sendMessage(\"getEnvironmentInformation\", data);\r\n};\r\n\r\n//// New Function which needs to be called for Entity Information Information\r\ninfor.companyon.client.getEntityInformation = function (data, callback) {\r\n\tvar randomNumber = infor.companyon.client.getRandomNumber();\r\n\tdata.MessageId = randomNumber;\r\n\t//// Step 1: Un-register\r\n\tinfor.companyon.client.unRegisterMessageHandler(\"processEntityInformation_\" + randomNumber);\r\n\r\n\t//// Step 2: Register Handler\r\n\tinfor.companyon.client.registerMessageHandler(\r\n\t\t\"processEntityInformation_\" + randomNumber,\r\n\t\tfunction (data) {\r\n\t\t\tcallback(data);\r\n\t\t}\r\n\t);\r\n\r\n\t//// Step 3: sendMessage\r\n\tinfor.companyon.client.sendMessage(\"getEntityInformation\", data);\r\n};\r\n\r\ninfor.companyon.client.getRandomNumber = function () {\r\n\tvar randomId = \"\" + new Date().getTime() + Math.floor(Math.random() * 10000);\r\n\treturn randomId;\r\n};\r\n\r\ninfor.companyon.client.getInforMingleHomeUrl = function (callback) {\r\n\tvar randomNumber = infor.companyon.client.getRandomNumber();\r\n\tvar data = {};\r\n\tdata.MessageId = randomNumber;\r\n\t//// Step 1: Un-register\r\n\tinfor.companyon.client.unRegisterMessageHandler(\"processInforMingleHomeUrl_\" + randomNumber);\r\n\r\n\t//// Step 2: Register Handler\r\n\tinfor.companyon.client.registerMessageHandler(\r\n\t\t\"processInforMingleHomeUrl_\" + randomNumber,\r\n\t\tfunction (data) {\r\n\t\t\tcallback(data);\r\n\t\t}\r\n\t);\r\n\r\n\t//// Step 3: sendMessage\r\n\tinfor.companyon.client.sendMessage(\"getInforMingleHomeUrl\", data);\r\n};\r\n\r\ninfor.companyon.client.relayMessage = function (data) {\r\n\tinfor.companyon.client.executeMessage(JSON.stringify(data));\r\n\tvar frames = $(\"iframe\");\r\n\r\n\tfor (var ct = 0; ct < frames.length; ct++) {\r\n\t\t//var target = frames[ct].get(0).contentWindow;\r\n\t\tvar fr = $('iframe[name=\"' + $(frames[ct]).attr(\"name\") + '\"]');\r\n\t\tinfor.companyon.client.sendMessage(\"relayFrameMessage\", data, fr.get(0).contentWindow);\r\n\t}\r\n};\r\n\r\n$(function () {\r\n\t//Don't do anything if an app iframe is already present. This is only needed for SharePoint based applications\r\n\tif (infor.companyon.iframeId != null) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tif (window.postMessage != null) {\r\n\t\tif (window.attachEvent) {\r\n\t\t\twindow.attachEvent(\"onmessage\", infor.companyon.client.messageReceiver);\r\n\t\t} else if (window.addEventListener) {\r\n\t\t\twindow.addEventListener(\"message\", infor.companyon.client.messageReceiver, false);\r\n\t\t}\r\n\t}\r\n\r\n\t// drillback click handler\r\n\r\n\tif (\"undefined\" === typeof $(\"body\").live) {\r\n\t\t$(\"body\").on(\r\n\t\t\t{\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tvar href = $(this).attr(\"href\");\r\n\t\t\t\t\t// infor.companyon.client.sendPrepareDrillbackMessage(href);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tinfor.companyon.client.drillbackSelector\r\n\t\t);\r\n\r\n\t\t$(\"body\").on(\r\n\t\t\t{\r\n\t\t\t\tclick: function () {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tvar href = $(this).attr(\"href\");\r\n\t\t\t\t\t//infor.companyon.client.sendPrepareFavoritesMessage(href);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tinfor.companyon.client.favoritesSelector\r\n\t\t);\r\n\t} else if (\"function\" === typeof $(infor.companyon.client.drillbackSelector).live) {\r\n\t\t$(infor.companyon.client.drillbackSelector).live(\"click\", function (event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tvar href = $(this).attr(\"href\");\r\n\t\t\tinfor.companyon.client.sendPrepareDrillbackMessage(href);\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\t$(infor.companyon.client.favoritesSelector).live(\"click\", function (event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tvar href = $(this).attr(\"href\");\r\n\t\t\tinfor.companyon.client.sendPrepareFavoritesMessage(href);\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\r\n\t// shortcut/favorite click handler\r\n\r\n\t//no need to send initclient when in a popup\r\n\tif (window.opener == null) {\r\n\t\t// Once this message is received by Workspace, it is assumed that the application is ready for receiving messages\r\n\t\tinfor.companyon.client.sendMessage(\"initClient\", window.name);\r\n\t}\r\n\tinfor.companyon.client.registerMessageHandler(\r\n\t\t\"relayFrameMessage\",\r\n\t\tinfor.companyon.client.relayMessage\r\n\t);\r\n});\r\n","import { NgModuleRef, NgZone } from \"@angular/core\";\r\nimport { platformBrowserDynamic } from \"@angular/platform-browser-dynamic\";\r\nimport { UrlService } from \"@uirouter/core\";\r\n\r\nlet ng1Import;\r\nlet ng2Import;\r\n\r\nif (APP_BUILDER) {\r\n\tng1Import = import(\"./appbuilder/app\")\r\n\t\t.then(module => module.appBuilder);\r\n\r\n\tng2Import = import(\"./app-builder/app.module\")\r\n\t\t.then(module => module.RootModule);\r\n\r\n} else if (APP_HUB) {\r\n\tng1Import = import(\"./appruntime/app\")\r\n\t\t.then(module => module.runtimeApp);\r\n\r\n\tng2Import = import(\"./app-hub/app.module\")\r\n\t\t.then(module => module.RootModule);\r\n\r\n}\r\n\r\nng1Import.then(ng1RootModule => {\r\n\t// Using AngularJS config block, call `deferIntercept()`.\r\n\t// This tells UI-Router to delay the initial URL sync (until all bootstrapping is complete)\r\n\tng1RootModule.config([\r\n\t\t\"$urlServiceProvider\",\r\n\t\t($urlService: UrlService) => $urlService.deferIntercept(),\r\n\t]);\r\n});\r\n\r\nng2Import.then(ng2RootModule => {\r\n\tplatformBrowserDynamic()\r\n\t\t.bootstrapModule(ng2RootModule)\r\n\t\t.then((platformRef: NgModuleRef<any>) => {\r\n\t\t\t// Intialize the Angular Module\r\n\t\t\t// get() the UIRouter instance from DI to initialize the router\r\n\t\t\tconst urlService: UrlService = platformRef.injector.get(UrlService);\r\n\r\n\t\t\t// Instruct UIRouter to listen to URL changes\r\n\t\t\tconst startUIRouter = () => {\r\n\t\t\t\turlService.listen();\r\n\t\t\t\turlService.sync();\r\n\t\t\t};\r\n\r\n\t\t\tconst ngZone = platformRef.injector.get<NgZone>(NgZone);\r\n\t\t\tngZone.run(startUIRouter);\r\n\t\t});\r\n});\r\n","import { Editors, Formatters, Locale, theme } from \"ab-ids-enterprise\";\r\nimport angular from \"angular\";\r\n\r\nimport { IdsSvgComponent } from \"./svg/ids-svg.component\";\r\n\r\nexport const idsAssetsModule = angular\r\n\t.module(\"idsAssetsModule\", [])\r\n\t.config(() => {\r\n\t\t// IDS Configuration\r\n\t\tif (!window.Soho) {\r\n\t\t\twindow.Soho = {\r\n\t\t\t\tEditors,\r\n\t\t\t\tFormatters,\r\n\t\t\t\tLocale,\r\n\t\t\t\ttheme,\r\n\t\t\t};\r\n\t\t}\r\n\t\tLocale.set(\"en-US\");\r\n\t});\r\n\r\n// IdsStyleConfig.add(idsAssetsModule);\r\nIdsSvgComponent.add(idsAssetsModule);\r\n","export class IdsSvgComponent {\r\n\tpublic static add(module: ng.IModule): void {\r\n\t\tmodule\r\n\t\t\t.component(\"eirSvg\", {\r\n\t\t\t\ttemplate: require(\"./eir-svg.html\"),\r\n\t\t\t})\r\n\t\t\t.component(\"idsSvg\", {\r\n\t\t\t\ttemplate: require(\"../../../../../../node_modules/ab-ids-enterprise/dist/svg/svg.html\"),\r\n\t\t\t})\r\n\t\t\t.component(\"idsAssetsModule\", {\r\n\t\t\t\ttemplate: `\r\n\t\t\t\t\t<eir-svg></eir-svg>\r\n\t\t\t\t\t<ids-svg></ids-svg>\r\n\t\t\t\t`,\r\n\t\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=svg-icons> <svg xmlns=http://www.w3.org/2000/svg version=1.1 class=svg-icons style=display:none> <symbol id=icon-hidden xmlns=http://www.w3.org/2000/svg viewBox=\\\"0 0 18 18\\\"> <path class=cls-1 fill=none d=M7.38,12.51l-.44.82c.2.06.39.1.59.14a4.29,4.29,0,0,1-.6-.13h0a2.72,2.72,0,0,1-.38-.11c-.25-.07-.5-.16-.74-.25a2.6,2.6,0,0,1-.36-.13,8.1,8.1,0,0,1-3.22-2.42c-.1-.13-.18-.25-.26-.37s-.15-.27-.21-.4A1.73,1.73,0,0,1,1.6,9a1.49,1.49,0,0,1,0-.21.67.67,0,0,1,0-.19A7,7,0,0,1,5.44,5.27L5.6,5.2a4.23,4.23,0,0,0-.71.94c-.06.12-.11.24-.17.37a3.14,3.14,0,0,0-.23.81,2.13,2.13,0,0,0-.07.44c0,.14,0,.29,0,.44a4.67,4.67,0,0,0,.41,1.91,3,3,0,0,0,.16.31,3.85,3.85,0,0,0,.23.38l.27.35a2.68,2.68,0,0,0,.28.3l.17.17.13.1a4.63,4.63,0,0,0,1.33.77h0 /> <path class=cls-1 fill=none d=M16.4,9a3.94,3.94,0,0,1-1.75,2.54c-.16.14-.34.27-.52.4l-.52.34a10.69,10.69,0,0,1-1.12.58,9.62,9.62,0,0,1-1.57.51l-.48.1A8.47,8.47,0,0,1,9,13.6l-.78,0-.69-.1.69.09.41-.77h0a2.17,2.17,0,0,0,.36,0l.48,0a5.57,5.57,0,0,0,.85-.16A4.57,4.57,0,0,0,13.7,8.2a4.4,4.4,0,0,0-1.06-2.82l0,0,0,0C14.89,6.2,16.4,7.93,16.4,9Z /> <path class=cls-1 fill=none d=M7.5,7.1A6.23,6.23,0,0,1,9.8,5.7a3.29,3.29,0,0,0-3,.7c-.9.7-.6,2.7-.6,2.7A4.63,4.63,0,0,1,7.5,7.1Z /> <path d=M12.6,5.45l-4,7.33a2.17,2.17,0,0,0,.36,0l.48,0a5.57,5.57,0,0,0,.85-.16A4.52,4.52,0,0,0,13.6,8.2,4.09,4.09,0,0,0,12.6,5.45Zm.7-1.28-.61,1.11,0,0C14.83,6.34,16.3,8,16.3,9a3.73,3.73,0,0,1-1.65,2.54c-.16.14-.34.27-.52.4l-.52.34a10.69,10.69,0,0,1-1.12.58,9.62,9.62,0,0,1-1.57.51l-.48.1A8.47,8.47,0,0,1,9,13.6l-.78,0L7.6,14.71A10.74,10.74,0,0,0,9,14.8c5,0,9-3.8,9-5.8C18,7.69,16.11,5.44,13.3,4.17Zm-5.77,9.3.69.1h0Zm-.59-.14h0a4.29,4.29,0,0,0,.6.13C7.33,13.43,7.14,13.39,6.94,13.33ZM6.8,6.4,7,6.23l.06-.05a2.87,2.87,0,0,1,.68-.38l.34-.11h0l.31,0a3.57,3.57,0,0,1,.86,0h.07l.19,0a1.75,1.75,0,0,1,.27,0,2.69,2.69,0,0,0-.61.21A5.67,5.67,0,0,0,7.5,7.1l-.2.2A3.51,3.51,0,0,0,6.21,9.06v0S5.9,7.1,6.8,6.4Zm.59,6.09,4.74-8.78h0a11.17,11.17,0,0,0-1.54-.38A10.21,10.21,0,0,0,9,3.2C4,3.2,0,7.1,0,9c0,1.47,2,3.72,4.85,4.94a11.57,11.57,0,0,0,1.47.51,0,0,0,0,1,0,0l.6-1.12h0l-.38-.1c-.25-.07-.5-.16-.74-.25l-.35-.15a8.52,8.52,0,0,1-3.23-2.4c-.1-.13-.18-.25-.26-.37s-.15-.27-.21-.4A1.73,1.73,0,0,1,1.6,9a1.49,1.49,0,0,1,0-.21.67.67,0,0,1,0-.19C2,7.5,3.46,6,5.5,5.2l-.06.07a4.62,4.62,0,0,0-.55.87c-.06.12-.11.24-.17.37a4.42,4.42,0,0,0-.23.81c0,.14,0,.29-.07.44s0,.29,0,.44a4.67,4.67,0,0,0,.41,1.91,3,3,0,0,0,.16.31,3.85,3.85,0,0,0,.23.38l.27.35a2.68,2.68,0,0,0,.28.3l.17.17.12.11a4.44,4.44,0,0,0,1.33.78h0Z /> <rect x=7.75 y=1.87 width=1.53 height=13.8 transform=\\\"translate(5.19 -2.99) rotate(28.38)\\\"/> <path class=cls-2 fill=currentColor d=M6.94,13.33c.2.06.39.1.59.14a4.29,4.29,0,0,1-.6-.13Z /> <path class=cls-2 fill=currentColor d=M8.22,13.56h0l-.69-.1Z /> <line class=cls-1 fill=none x1=7.39 y1=12.49 x2=7.38 y2=12.51 /> </symbol> <symbol id=icon-screen viewBox=\\\"0 0 18 18\\\"> <g id=additional-icons stroke=none stroke-width=1 fill=none fill-rule=evenodd> <g id=screen-1 fill=currentColor> <path d=\\\"M15.5,1 L2.5,1 C1.119,1 0,2.12 0,3.5 L0,10.599 C0,11.945 1.098,13 2.5,13 L15.5,13 C16.881,13 18,11.881 18,10.5 L18,3.5 C18,2.12 16.881,1 15.5,1 L15.5,1 Z M16,10 L16,10.5 C16,10.775 15.776,11 15.5,11 L2.5,11 C2.449,11 2,10.988 2,10.599 L2,3.5 C2,3.224 2.224,3 2.5,3 L15.5,3 C15.775,3 16,3.224 16,3.5 L16,10 Z M12,17 L6,17 C5.45,17 5,16.55 5,16 C5,15.45 5.45,15 6,15 L12,15 C12.55,15 13,15.45 13,16 C13,16.55 12.55,17 12,17 L12,17 Z\\\" id=Page-1></path> </g> </g> </symbol> <symbol id=icon-stop viewBox=\\\"0 0 22 22\\\"> <rect width=22 height=22 rx=4 ry=4 /> </symbol> <symbol id=icon-play viewBox=\\\"3 3 12 12\\\"> <path d=\\\"M5 3.731c0-.604.886-.947 1.361-.58l6.329 5.269c.377.292.427.868.049 1.16l-6.403 5.269c-.475.367-1.336.024-1.336-.58v-10.538\\\"></path> </symbol> <symbol id=icon-more-small class=soho-icon-color viewBox=\\\"0 0 18 18\\\"> <path d=\\\"M2 7a2 2 0 1 0 .001 4.001A2 2 0 0 0 2 7zm7 0a2 2 0 1 0 .001 4.001A2 2 0 0 0 9 7zm7 0a2 2 0 1 0 .001 4.001A2 2 0 0 0 16 7z\\\" fill=currentColor fill-rule=nonzero stroke=none class=soho-icon-color-path-white></path> </symbol> <symbol id=icon-preview viewBox=\\\"0 0 17 11\\\"> <g> <path fill=none d=\\\"M11.8,1.9c0.7,0.8,1.1,1.7,1.1,2.8c0,2.4-1.9,4.3-4.3,4.3C6.1,9,4.2,7.1,4.2,4.7c0-1.1,0.4-2.1,1.1-2.8\\r\\n\\t\\tC3,2.8,1.5,4.5,1.5,5.5c0,1.5,3.1,4.3,7,4.3c3.8,0,7-2.8,7-4.3C15.5,4.5,14,2.8,11.8,1.9z\\\"/> <path fill=none d=M7.1,3.7c1.1-1,2.2-1.3,2.2-1.3S7.5,1.9,6.4,3C5.6,3.7,5.9,5.6,5.9,5.6S6,4.7,7.1,3.7z /> <path fill=currentColor d=\\\"M8.5,0C3.8,0,0,3.7,0,5.5c0,2,3.8,5.5,8.5,5.5c4.7,0,8.5-3.6,8.5-5.5C17,3.7,13.2,0,8.5,0z M6.4,3\\r\\n\\t\\tc1.2-1.1,2.9-0.6,2.9-0.6S8.2,2.6,7.1,3.7C6,4.7,5.9,5.6,5.9,5.6S5.6,3.7,6.4,3z M8.5,9.8c-3.8,0-7-2.8-7-4.3c0-1,1.5-2.7,3.7-3.6\\r\\n\\t\\tC4.6,2.6,4.2,3.6,4.2,4.7C4.2,7.1,6.1,9,8.5,9c2.4,0,4.3-1.9,4.3-4.3c0-1.1-0.4-2-1.1-2.8c2.2,1,3.7,2.7,3.7,3.6\\r\\n\\t\\tC15.5,7,12.3,9.8,8.5,9.8z\\\"/> </g> </symbol> <svg id=icon-custom-hamburger x=0px y=0px viewBox=\\\"0 0 160 120\\\"> <rect x=0 y=0 width=160 height=20 /> <rect x=0 y=50 width=160 height=20 /> <rect x=0 y=100 width=160 height=20 /> </svg> <symbol id=eir-icon-dashboard class=soho-icon-color viewBox=\\\"0 0 18 18\\\"> <path d=M7,8H1C0.4,8,0,7.6,0,7V1c0-0.5,0.4-1,1-1h6c0.5,0,1,0.5,1,1v6C8,7.6,7.5,8,7,8z fill=currentColor /> <path d=M17,8h-6c-0.6,0-1-0.4-1-1V1c0-0.5,0.4-1,1-1h6c0.5,0,1,0.5,1,1v6C18,7.6,17.5,8,17,8z fill=currentColor /> <path d=M7,18H1c-0.6,0-1-0.5-1-1v-6c0-0.6,0.4-1,1-1h6c0.5,0,1,0.4,1,1v6C8,17.6,7.5,18,7,18z fill=currentColor /> <path d=M17,18h-6c-0.6,0-1-0.5-1-1v-6c0-0.6,0.4-1,1-1h6c0.5,0,1,0.4,1,1v6C18,17.6,17.5,18,17,18z fill=currentColor /> </symbol> <symbol id=icon-launch-project class=soho-icon-color viewBox=\\\"0 0 16 19\\\"> <path d=\\\"M15.2,14.8c-0.6-1.2-1.6-2.2-2.9-2.9c-0.1-0.1-0.2-0.1-0.1-0.2c0.3-1.8,0.3-3.6-0.1-5.4c-0.3-1.4-0.8-2.7-1.8-4\\r\\n\\t\\t\\t\\t\\t\\tC9.7,1.6,9,1,8.1,0.5c-0.1-0.1-0.3-0.1-0.4,0C7.4,0.7,7,0.9,6.7,1.1C5.6,2,4.9,3,4.4,4.1C3.8,5.3,3.6,6.4,3.4,7.6\\r\\n\\t\\t\\t\\t\\t\\tc-0.1,1.3-0.1,2.7,0.1,4c0,0.2,0,0.3-0.2,0.3c-1,0.6-1.8,1.3-2.4,2.1c-0.9,1.3-1.2,2.6-0.9,4c0.1,0.3,0.1,0.6,0.2,0.9c0,0,0,0,0.1,0\\r\\n\\t\\t\\t\\t\\t\\tc0.1-0.1,0.1-0.2,0.2-0.3c0.8-1,1.8-1.9,3.1-2.4c0.2-0.1,0.5-0.1,0.6-0.3c0.1-0.2,0-0.4-0.1-0.6C4.1,15,4.1,14.7,4,14.3\\r\\n\\t\\t\\t\\t\\t\\tc0.1,0,0.1,0.1,0.1,0.2c0.3,0.5,0.5,1,0.8,1.5c0.2,0.4,0.5,0.9,1,1.2c0.8,0.5,1.6,0.6,2.6,0.5c1-0.1,1.8-0.5,2.2-1.3\\r\\n\\t\\t\\t\\t\\t\\tc0.3-0.6,0.6-1.2,0.9-1.8c0,0,0-0.1,0.1-0.1c0,0,0,0.1,0,0.1c-0.1,0.5-0.1,1-0.2,1.5c0,0.1,0,0.1,0.1,0.2c1.7,0.6,2.8,1.5,3.7,2.8\\r\\n\\t\\t\\t\\t\\t\\tc0,0,0.1,0.1,0.1,0.2c0-0.1,0-0.1,0-0.1C15.9,17.5,15.8,16.2,15.2,14.8z M7.9,7.6C7.2,7.6,6.6,7,6.5,6.2c0-0.8,0.6-1.4,1.4-1.4\\r\\n\\t\\t\\t\\t\\t\\tc0.8,0,1.4,0.6,1.4,1.4C9.3,6.9,8.7,7.6,7.9,7.6z\\\" fill=currentColor /> </symbol> <symbol id=icon-action-wizard viewBox=\\\"0 0 16.2 15.5\\\"> <polygon fill=none stroke=#FFFFFF stroke-miterlimit=10 points=\\\"10,7.3 12.3,4 8.3,4.2 5.9,1.1 4.9,4.9 1.1,6.3 4.5,8.4 4.6,12.4 7.7,9.9 7.2,7.1 \\\"/> <path fill=#FFFFFF d=M8.9,9.8l1.4-1.5l5.7,4.8c0,0,0.9,2.2-1.8,2.1C12.8,13.9,8.9,9.8,8.9,9.8z /> </symbol> <symbol id=icon-add-comp class=soho-icon-color viewBox=\\\"0 0 18 18\\\"> <path d=\\\"M9,0C4,0,0,4,0,9c0,5,4,9,9,9c5,0,9-4,9-9C18,4,14,0,9,0z M14.4,9.7H10v4.7H8V9.7H3.6v-2H8V3.6h2v4.1h4.4V9.7z\\\" fill=currentColor /> </symbol> <symbol id=icon-action-interaction viewBox=\\\"0 0 12.5 18.2\\\"> <path fill=#FFFFFF d=\\\"M4,18.2c-0.3-0.1-0.5-0.3-0.7-0.6c-1-1.3-2-2.6-3-3.9C0.2,13.5,0,13.3,0,13.1C0,12.6,0.2,12.2,0.5,12\\r\\n\\t\\t\\tc0.4-0.2,0.8-0.2,1.2,0.1c0.4,0.3,0.8,0.7,1.2,1c0.1,0.1,0.3,0.2,0.4,0.2c0.3,0,0.5-0.2,0.5-0.5c0-1.4,0-2.8,0-4.2\\r\\n\\t\\t\\tc0-0.9,0-1.9,0-2.8c0-0.6,0.4-1,0.9-1.1c0.6-0.1,1.2,0.4,1.2,1c0,0.7,0,1.5,0,2.2c0,0.5,0,1,0,1.4c0,0,0,0.1,0.1,0.2\\r\\n\\t\\t\\tc0,0,0.1-0.1,0.1-0.1c0.2-0.4,0.7-0.6,1.2-0.5c0.5,0.1,0.8,0.5,0.8,1c0,0.2,0,0.4,0,0.7c0,0,0,0,0,0c0,0,0.1-0.1,0.1-0.1\\r\\n\\t\\t\\tc0.2-0.4,0.7-0.7,1.2-0.5c0.5,0.1,0.8,0.5,0.8,1c0,0.2,0,0.4,0,0.7c0,0,0.1-0.1,0.1-0.1c0.2-0.4,0.7-0.6,1.2-0.5\\r\\n\\t\\t\\tc0.5,0.1,0.8,0.5,0.8,1c0,0.9,0,1.7,0,2.6c0,0.7-0.2,1.5-0.4,2.2c-0.1,0.3-0.2,0.6-0.3,0.9c-0.1,0.3-0.3,0.6-0.6,0.7\\r\\n\\t\\t\\tC8.7,18.2,6.3,18.2,4,18.2z\\\"/> <path style=fill:none;stroke:#fff;stroke-width:2;stroke-miterlimit:10 d=M2.1,6.7C1.6,6.1,1.3,5.4,1.3,4.5c0-2,1.6-3.5,3.5-3.5s3.5,1.6,3.5,3.5c0,0.8-0.2,1.5-0.7,2 /> </symbol> <symbol id=icon-action-dataservice viewBox=\\\"0 0 13.1 12.8\\\"> <ellipse fill=#FFFFFF cx=6.6 cy=1.4 rx=6.6 ry=1.4 /> <path fill=#FFFFFF d=M0,2.6c0,0,3.1,1.1,6.4,1.1c3.4,0,6.7-1,6.7-1v3.9c0,0-3.5,1.3-6.7,1.3C2.6,7.9,0,6.6,0,6.6V2.6z /> <path fill=#FFFFFF d=M0,7.6c0,0,3.1,1.1,6.4,1.1c3.4,0,6.7-1,6.7-1v3.9c0,0-3.5,1.3-6.7,1.3c-3.7,0-6.4-1.3-6.4-1.3V7.6z /> </symbol> <symbol id=icon-action-edit viewBox=\\\"0 0 16.9 14.1\\\"> <path fill=#FFFFFF d=\\\"M6.4,7.8c0,0,4.1-6.8,6.8-7.3C14.5,0.2,15.6,0,16.1,0c0.3,0,0.7,0.4,0.7,0.7l-0.1,1.7c0,0.2-0.1,0.6-0.2,0.7\\r\\n\\t\\t\\tC16,4.4,13.2,9.1,8.9,10C8.2,9.5,6.4,7.8,6.4,7.8z\\\"/> <path style=fill:none;stroke:#fff;stroke-width:1.5;stroke-miterlimit:10 d=\\\"M7.1,8.3H4.9c0,0-0.8,0-1.3,1c-0.4,0.8-1.4,3.4-2,4h3.9c0.2,0,0.3-0.1,0.4-0.2c0.6-0.7,2.7-3,2.6-3.7\\r\\n\\t\\t\\tC7.2,8.4,7.1,8.3,7.1,8.3z\\\"/> </symbol> <symbol id=icon-action-orientation-2 viewBox=\\\"0 0 18 18\\\"> <path fill=#FFFFFF d=\\\"M9.715 15.77l.062-.063h.001l4.999-5c.391-.391.391-1.023 0-1.414-.39-.391-1.054-.391-1.445 0l-3.324 3.293v-9.586c0-.553-.448-1-1-1s-1 .447-1 1v9.711l-3.324-3.355c-.391-.391-1.008-.391-1.399 0-.195.195-.285.451-.285.706 0 .256.102.512.297.707l5.002 5.001c.391.39 1.025.39 1.416 0\\\"/> </symbol> <symbol id=icon-action-orientation-1 viewBox=\\\"0 0 18 18\\\"> <path fill=#FFFFFF d=\\\"M1 10h13.564l-5.33 5.32c-.392.388-.396 1.037-.008 1.43.389.393 1.021.404 1.415.016l7.062-6.996c.393-.388.397-1.019.009-1.412l-7-7.061c-.196-.198-.454-.297-.712-.297-.254 0-.508.096-.703.289-.393.388-.397.989-.009 1.382l5.318 5.329h-13.606c-.553 0-1 .448-1 1s.447 1 1 1\\\"/> </symbol> <symbol id=icon-small-close viewBox=\\\"0 0 12 12\\\"> <circle fill=#ffffff cx=6 cy=6 r=6 /> <g> <line fill=none stroke-width=1.5 stroke=#313236 x1=3.5 y1=3.5 x2=8.5 y2=8.5 /> <line fill=none stroke-width=1.5 stroke=#313236 x1=3.5 y1=8.5 x2=8.5 y2=3.5 /> </g> </symbol> <symbol id=boundary-marker-pin viewBox=\\\"0 0 5 11.3\\\"> <polygon class=st0 points=\\\"0,0.1 5,0.1 5,8.4 2.5,11.3 0,8.4 \\\"/> </symbol> <symbol id=icon-add-from-repository viewBox=\\\"0 0 18 18\\\"> <polygon fill=currentColor points=\\\"15 14.83 9 18 3 14.83 3 11.48 3 8.13 9 11.3 15 8.13 15 11.48 15 14.83\\\"/> <path fill=currentColor class=cls-1 d=M11.88,13.07,9,11.27,15.12,8,18,9.65Z /> <path fill=currentColor class=cls-1 d=M0,9.65,2.88,8,9,11.27l-2.88,1.8Z /> <path fill=currentColor class=cls-1 d=M0,6.24,2.88,8,5,6.85V3.59Z /> <path fill=currentColor class=cls-1 d=M13,3.59V6.85L15.12,8,18,6.24Z /> <path fill=currentColor class=cls-2 d=M11.27,4H10V1A1,1,0,0,0,8,1V4H6.73a.88.88,0,0,0-.58,1.36L8.42,8.69a.73.73,0,0,0,1.16.05l2.27-3.4A.86.86,0,0,0,11.27,4Z /> </symbol></svg>  </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport ngAnimate from \"angular-animate\";\r\n\r\nimport { Config } from \"ng2/common/constants/common.constant\";\r\nimport { Filters } from \"./filters\";\r\n\r\n// Add Controller Imports\r\nimport { AddStringCtrl } from \"./dialogs/add-string/add-string\";\r\nimport { ExportProjectCtrl } from \"./dialogs/export/export-dialog\";\r\nimport { ImportConflictCtrl } from \"./dialogs/import-conflict/conflict-decision-dialog\";\r\nimport { ImportErrorCtrl } from \"./dialogs/import-error/import-error-dialog\";\r\nimport { ImportProjectCtrl } from \"./dialogs/import/import-dialog\";\r\nimport { LicensesButton } from \"./dialogs/licenses/licenses-button\";\r\nimport { LicensesDialogCtrl } from \"./dialogs/licenses/licenses-dialog\";\r\nimport { TestDataserviceDialogCtrl } from \"./dialogs/test-dataservice/test-dataservice-dialog\";\r\nimport { DatagridExportDialogCtrl } from \"../components/datagrid/datagrid-export-dialog-ctrl\";\r\n\r\nimport { CommonService } from \"./services/common-service\";\r\nimport { ConflictResolutonService } from \"./services/conflict-resolution-service\";\r\nimport { DialogService } from \"./services/dialog-service\";\r\nimport { ExpressionService } from \"./services/expression-service\";\r\nimport { FeatureSwitchService } from \"./services/feature-switch-service\";\r\nimport { HashService } from \"./services/hash-service\";\r\nimport { HttpService } from \"./services/http-service\";\r\nimport { LanguageService } from \"./services/language-service\";\r\nimport { MingleService } from \"./services/mingle-service\";\r\nimport { TagService } from \"./services/tag-service\";\r\nimport { ThemeService } from \"./services/theme-service\";\r\n\r\n// Add Directive Imports\r\nimport { RepeatDoneDirective } from \"./after-repeat-directive\";\r\nimport { DragDirective } from \"./drag-directive\";\r\nimport { InfiniteScrollDirective } from \"./helpers/infinite-scroll\";\r\nimport { InitializeDirective } from \"./initialize-directive\";\r\n\r\n// Shared Component Imports\r\nimport { DropdownFieldComponent } from \"./shared-components/dropdown-field/dropdown-field-component\";\r\nimport { FilterPopupmenuComponent } from \"./shared-components/filter-popupmenu/filter-popupmenu-component\";\r\nimport { FilterTagComponent } from \"./shared-components/filter-tag-dropdown/filter-tag-component\";\r\nimport { FilterToolbarComponent } from \"./shared-components/filter-toolbar/filter-toolbar\";\r\nimport { InputFieldComponent } from \"./shared-components/input-field/input-field-component\";\r\nimport { PaginatorComponent } from \"./shared-components/paginator/paginator-component\";\r\nimport { ProjectTagsComponent } from \"./shared-components/project-tags/project-tags-component\";\r\nimport { SortPopupmenuComponent } from \"./shared-components/sort-popupmenu/sort-popupmenu-component\";\r\nimport { TagDropdownComponent } from \"./shared-components/tag-dropdown/tag-dropdown-component\";\r\nimport { TextareaFieldComponent } from \"./shared-components/textarea-field/textarea-field-component\";\r\n\r\n// IDS directives\r\nimport { AboutDirective } from \"./sohoxi/component/about-directive\";\r\nimport { ApplicationMenuDirective } from \"./sohoxi/component/application-menu-directive\";\r\nimport { ArrangeDirective }from \"./sohoxi/component/arrange-directive\";\r\nimport { AutocompleteDirective } from \"./sohoxi/component/autocomplete-directive\";\r\nimport { BusyDirective } from \"./sohoxi/component/busy-directive\";\r\nimport { ButtonDirective } from \"./sohoxi/component/button-directive\";\r\nimport { ColorPickerDirective } from \"./sohoxi/component/colorpicker-directive\";\r\nimport { ControlDirective } from \"./sohoxi/component/control-directive\";\r\nimport { DatagridDirective } from \"./sohoxi/component/datagrid-directive\";\r\nimport { DatepickerDirective } from \"./sohoxi/component/datepicker-directive\";\r\nimport { DropDownDirective } from \"./sohoxi/component/dropdown-directive\";\r\nimport { EditorDirective } from \"./sohoxi/component/editor-directive\";\r\nimport { FileuploadDirective } from \"./sohoxi/component/fileupload-directive\";\r\nimport { ListviewDirective } from \"./sohoxi/component/listview-directive\";\r\nimport { LookupDirective } from \"./sohoxi/component/lookup-directive\";\r\nimport { MaskDirective } from \"./sohoxi/component/mask-directive\";\r\nimport { MultiSelectDirective } from \"./sohoxi/component/multiselect-directive\";\r\nimport { PopoverDirective } from \"./sohoxi/component/popover-directive\";\r\nimport { PopupmenuDirective } from \"./sohoxi/component/popupmenu-directive\";\r\nimport { SearchFieldDirective } from \"./sohoxi/component/search-field-directive\";\r\nimport { SliderDirective } from \"./sohoxi/component/slider-directive\";\r\nimport { SpinboxDirective } from \"./sohoxi/component/spinbox-directive\";\r\nimport { TabsDirective } from \"./sohoxi/component/tabs-directive\";\r\nimport { TextareaDirective } from \"./sohoxi/component/textarea-directive\";\r\nimport { TimepickerDirective } from \"./sohoxi/component/timepicker-directive\";\r\nimport { ToolbarDirective } from \"./sohoxi/component/toolbar-directive\";\r\nimport { TooltipDirective } from \"./sohoxi/component/tooltip-directive\";\r\nimport { TrackDirtyDirective } from \"./sohoxi/component/trackdirty-directive\";\r\nimport { ValidateDirective } from \"./sohoxi/component/validate-directive\";\r\n\r\n// TODO: MUPS-2682 Needs to be fixed later\r\n// (window as any).setContextRoots();\r\n\r\nexport const commonModule = angular.module(\"commonModule\", [\r\n\tngAnimate\r\n]);\r\n\r\ncommonModule.run(() => {\r\n\tconst setContextRoots = () => {\r\n\r\n\t\tlet pathname: string;\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tpathname = \"api\";\r\n\t\t} else {\r\n\t\t\tpathname = location.pathname;\r\n\t\t}\r\n\r\n\t\t// Setting context roots, used by angular for rest calls and templates\r\n\t\tconst pathnameNoIndex = pathname.substr(0, pathname.indexOf(\"index.html\"));\r\n\r\n\t\tConfig.APP_ROOT = pathnameNoIndex; // MUPS-2682: Remove as this property is probably obsolete now\r\n\r\n\t\tif (pathname.indexOf(\"appbuilder\") !== -1) {\r\n\t\t\tConfig.REST_ROOT = Config.APP_BUILDER_REST_ROOT;\r\n\t\t} else if (pathname.indexOf(\"apphub\") !== -1) {\r\n\t\t\tConfig.REST_ROOT = Config.APP_RUNTIME_REST_ROOT;\r\n\t\t} else {\r\n\t\t\tConfig.REST_ROOT = `http://localhost:3000/${pathname}`;\r\n\t\t}\r\n\t};\r\n\r\n\tsetContextRoots();\r\n});\r\n\r\n// Add angularAnimate to any component we want ngAnimate on\r\ncommonModule\r\n\t.config([\"$animateProvider\", (\r\n\t\t$animateProvider: ng.animate.IAnimateProvider\r\n\t) => {\r\n\t\t$animateProvider.classNameFilter(/angularAnimate/);\r\n\t}]);\r\n\r\n//tslint:disable:no-magic-numbers\r\n// Adds custom slide and fade animation using ngAnimate\r\ncommonModule\r\n\t.animation(\".angularAnimate-slide\", [() => {\r\n\t\treturn {\r\n\t\t\tenter: (element: JQuery, doneFn: any) => {\r\n\t\t\t\t$(element).slideDown(1000, doneFn);\r\n\t\t\t},\r\n\t\t\tleave: (element: JQuery, doneFn: any) => {\r\n\t\t\t\t$(element).slideUp(1000, doneFn);\r\n\t\t\t},\r\n\t\t} as ng.animate.IAnimateCallbackObject;\r\n\t}])\r\n\t.animation(\".angularAnimate-fade\", [() => {\r\n\t\treturn {\r\n\t\t\tenter: (element: JQuery, doneFn: any) => {\r\n\t\t\t\t$(element).fadeIn(1500, doneFn);\r\n\t\t\t},\r\n\t\t\tleave: (element: JQuery, doneFn: any) => {\r\n\t\t\t\t$(element).fadeOut(500, doneFn);\r\n\t\t\t},\r\n\t\t} as ng.animate.IAnimateCallbackObject;\r\n\t}]);\r\n//tslint:enable\r\n\r\ncommonModule.config([\"$qProvider\", ($qProvider: ng.IQProvider) => {\r\n\t$qProvider.errorOnUnhandledRejections(false);\r\n}]);\r\n\r\n// NoCacheInterceptor.add(commonModule);\r\n\r\n// Add Controllers\r\nAddStringCtrl.add(commonModule);\r\nExportProjectCtrl.add(commonModule);\r\nImportConflictCtrl.add(commonModule);\r\nImportErrorCtrl.add(commonModule);\r\nImportProjectCtrl.add(commonModule);\r\nLicensesButton.add(commonModule);\r\nLicensesDialogCtrl.add(commonModule);\r\nTestDataserviceDialogCtrl.add(commonModule);\r\nDatagridExportDialogCtrl.add(commonModule);\r\n\r\n// Add Services\r\nCommonService.add(commonModule);\r\nConflictResolutonService.add(commonModule);\r\nDialogService.add(commonModule);\r\nExpressionService.add(commonModule);\r\nFeatureSwitchService.add(commonModule);\r\nHashService.add(commonModule);\r\nHttpService.add(commonModule);\r\nLanguageService.add(commonModule);\r\nMingleService.add(commonModule);\r\nTagService.add(commonModule);\r\nThemeService.add(commonModule);\r\n\r\n// Add Directives\r\nDragDirective.add(commonModule);\r\nInitializeDirective.add(commonModule);\r\nInfiniteScrollDirective.add(commonModule);\r\nRepeatDoneDirective.add(commonModule);\r\n\r\n// // Add Filters\r\nFilters.add(commonModule);\r\n\r\n// Shared Components\r\nDropdownFieldComponent.add(commonModule);\r\nFilterPopupmenuComponent.add(commonModule);\r\nFilterTagComponent.add(commonModule);\r\nFilterToolbarComponent.add(commonModule);\r\nInputFieldComponent.add(commonModule);\r\nPaginatorComponent.add(commonModule);\r\nProjectTagsComponent.add(commonModule);\r\nTagDropdownComponent.add(commonModule);\r\nTextareaFieldComponent.add(commonModule);\r\nSortPopupmenuComponent.add(commonModule);\r\n\r\n// SohoXi directives\r\nAboutDirective.add(commonModule);\r\nArrangeDirective.add(commonModule);\r\nAutocompleteDirective.add(commonModule);\r\nBusyDirective.add(commonModule);\r\nButtonDirective.add(commonModule);\r\nColorPickerDirective.add(commonModule);\r\nControlDirective.add(commonModule);\r\nDatagridDirective.add(commonModule);\r\nDatepickerDirective.add(commonModule);\r\nDropDownDirective.add(commonModule);\r\nEditorDirective.add(commonModule);\r\nFileuploadDirective.add(commonModule);\r\nListviewDirective.add(commonModule);\r\nLookupDirective.add(commonModule);\r\nMaskDirective.add(commonModule);\r\nMultiSelectDirective.add(commonModule);\r\nPopupmenuDirective.add(commonModule);\r\nPopoverDirective.add(commonModule);\r\nSearchFieldDirective.add(commonModule);\r\nSliderDirective.add(commonModule);\r\nSpinboxDirective.add(commonModule);\r\nTabsDirective.add(commonModule);\r\nTextareaDirective.add(commonModule);\r\nTimepickerDirective.add(commonModule);\r\nToolbarDirective.add(commonModule);\r\nTooltipDirective.add(commonModule);\r\nTrackDirtyDirective.add(commonModule);\r\nValidateDirective.add(commonModule);\r\nApplicationMenuDirective.add(commonModule);\r\n","import { Helper } from \"./helper\";\r\n\r\nclass ExcludeFromFilter {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.filter(\"eirExcludeFrom\", () => {\r\n\t\t\treturn (inputArray: any[], criteria: any, itemProperty: string, selectedItem: any): any[] => {\r\n\r\n\t\t\t\tif (criteria instanceof Array) {\r\n\t\t\t\t\treturn inputArray ? inputArray.filter((item: any) => {\r\n\t\t\t\t\t\tlet keepItem = true;\r\n\t\t\t\t\t\tconst compareValue1: any = (itemProperty ? item[itemProperty] : item);\r\n\t\t\t\t\t\tcriteria.forEach((item2: any) => {\r\n\t\t\t\t\t\t\tconst compareValue2: any = (itemProperty ? item2[itemProperty] : item2);\r\n\t\t\t\t\t\t\tif (compareValue1 === compareValue2) {\r\n\t\t\t\t\t\t\t\tkeepItem = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (selectedItem && selectedItem[itemProperty] === compareValue1) {\r\n\t\t\t\t\t\t\tkeepItem = true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn keepItem;\r\n\t\t\t\t\t}) : inputArray;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn inputArray ? inputArray.filter((item: any) => {\r\n\t\t\t\t\t\tconst compareValue1: any = (itemProperty ? item[itemProperty] : item);\r\n\t\t\t\t\t\tif (criteria === compareValue1) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}) : inputArray;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n\r\nclass OnlyIncludeFilter {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.filter(\"eirOnlyInclude\", () => {\r\n\t\t\treturn (inputArray: any[], criteria: any, itemProperty1: string, itemProperty2: string) => {\r\n\t\t\t\treturn inputArray ? inputArray.filter((item: any) => {\r\n\t\t\t\t\tconst compareValue1: any = (itemProperty1 ? item[itemProperty1] : item);\r\n\t\t\t\t\tconst compareValue2: any = (itemProperty2 ? item[itemProperty2] : item);\r\n\t\t\t\t\tif (criteria === compareValue1) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (criteria === compareValue2) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}) : inputArray;\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n\r\ninterface IFilterHtmlEncode {\r\n\t(html: string): string;\r\n}\r\nclass HtmlEncode {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.filter(\"eirHtmlEncode\", () => {\r\n\t\t\treturn (input: string) =>\r\n\t\t\t\tHelper.htmlEncode(input);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class Filters {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tExcludeFromFilter.add(m);\r\n\t\tOnlyIncludeFilter.add(m);\r\n\t\tHtmlEncode.add(m);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IMongooseString } from \"ng2/common/model/language.model\";\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { DialogButtonType, DialogService, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\nimport { LanguageService } from \"../../services/language-service\";\r\n\r\nexport class AddStringCtrl {\r\n\tpublic stringName: string;\r\n\tpublic stringValue: string;\r\n\tprivate dialog: IDialog<string>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<string>,\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.stringName = this.dialog.parameter;\r\n\t\tthis.stringValue = null;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic add(): void {\r\n\t\tif (this.stringValue) {\r\n\t\t\tif (!this.languageService.getGlobalString(this.stringName)) {\r\n\t\t\t\tconst result: IDialogResult<IMongooseString> = {\r\n\t\t\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\t\t\tvalue: {\r\n\t\t\t\t\t\tName: this.stringName,\r\n\t\t\t\t\t\tValue: this.stringValue\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.dialog.close(result);\r\n\t\t\t} else {\r\n\t\t\t\tthis.dialogService.showError(\"Add String\", \"String Key already exists\");\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.dialogService.showError(\"Add String\", \"Must have a string Value\");\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirAddStringCtrl\", AddStringCtrl);\r\n\t}\r\n}\r\n","\r\n/**\r\n* HTTP utility functions.\r\n*/\r\nexport class HttpUtil {\r\n\r\n\tpublic static combine(url1: string, url2: string): string {\r\n\t\tif (!url1) {\r\n\t\t\treturn url2;\r\n\t\t}\r\n\t\tif (!url2) {\r\n\t\t\treturn url1;\r\n\t\t}\r\n\t\tconst end = url1.length - 1;\r\n\t\tif (url1.charAt(end) === \"/\") {\r\n\t\t\turl1 = url1.substring(0, end);\r\n\t\t}\r\n\t\tif (url2.charAt(0) === \"/\") {\r\n\t\t\turl2 = url2.substring(1);\r\n\t\t}\r\n\t\treturn url1 + \"/\" + url2;\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { ConflictResolutionEnum, IConflictObject, IConflictResult } from \"../../services/conflict-resolution-service\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\n\r\nimport { Helper } from \"../../helper\";\r\n\r\nexport class ImportConflictCtrl {\r\n\tpublic objectName: string;\r\n\tpublic remainingCount: number;\r\n\tpublic newName: string;\r\n\tpublic resolutionOption: string;\r\n\tpublic sameForAll: boolean = false;\r\n\tpublic currentActionName: string;\r\n\tpublic maxItems: number;\r\n\tpublic occupiedStrings: string[];\r\n\r\n\tpublic get ConflictResolutionEnum(): any {\r\n\t\treturn ConflictResolutionEnum;\r\n\t}\r\n\r\n\tprivate dialog: IDialog<IConflictObject>;\r\n\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<IConflictObject>) {\r\n\t\tconst dialog: IDialog<IConflictObject> = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tconst parameter = dialog.parameter;\r\n\r\n\t\tthis.objectName = parameter.objectName;\r\n\t\tthis.remainingCount = parameter.remainingCount;\r\n\t\tthis.maxItems = parameter.maxItems;\r\n\t\tthis.occupiedStrings = parameter.occupiedStrings;\r\n\t\tif (this.maxItems > this.occupiedStrings.length) {\r\n\t\t\tthis.resolutionOption = parameter.lastAction\r\n\t\t\t\t? parameter.lastAction.toString()\r\n\t\t\t\t: ConflictResolutionEnum.REPLACE.toString();\r\n\t\t} else {\r\n\t\t\tthis.resolutionOption = ConflictResolutionEnum.REPLACE.toString();\r\n\t\t}\r\n\t\tthis.onChangeOption();\r\n\t\tthis.newName = Helper.generateNewDisplayName(parameter.conflictedString, parameter.occupiedStrings);\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic resolve(): void {\r\n\t\tconst result: IDialogResult<IConflictResult> = {\r\n\t\t\tvalue: {\r\n\t\t\t\taction: parseInt(this.resolutionOption),\r\n\t\t\t\tsameForRemaining: this.sameForAll,\r\n\t\t\t\tnewName: this.newName\r\n\t\t\t},\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tpublic onChangeOption(): void {\r\n\t\tswitch (parseInt(this.resolutionOption)) {\r\n\t\t\tcase ConflictResolutionEnum.REPLACE:\r\n\t\t\t\tthis.currentActionName = \"Replace\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase ConflictResolutionEnum.COPY:\r\n\t\t\t\tthis.currentActionName = \"Copy\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase ConflictResolutionEnum.SKIP:\r\n\t\t\t\tthis.currentActionName = \"Skip\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.warn(\"[ImportConflictCtrl] Invalid option\");\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirImportConflictCtrl\", ImportConflictCtrl);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div id=conflict-dialog ng-controller=\\\"eirImportConflictCtrl as ctrl\\\"> <fieldset class=radio-group> <legend>You already have a {{ctrl.objectName}} with the name \\\"<b>{{ctrl.dialog.parameter.conflictedString}}</b>\\\"</legend> <input type=radio checked=checked class=radio name=import id=importReplace value={{ctrl.ConflictResolutionEnum.REPLACE}} ng-model=ctrl.resolutionOption ng-change=ctrl.onChangeOption() /> <label for=importReplace class=radio-label>Replace</label> <br/> <label class=extra-label>Replace the existing {{ctrl.objectName}} with the {{ctrl.objectName}} you are importing</label> <br/> <input type=radio class=radio name=import id=importCopy value={{ctrl.ConflictResolutionEnum.COPY}} ng-model=ctrl.resolutionOption ng-change=ctrl.onChangeOption() ng-disabled=\\\"ctrl.maxItems <= ctrl.occupiedStrings.length\\\"/> <label for=importCopy class=radio-label>Copy</label> <br/> <label class=\\\"extra-label label-warning\\\" ng-if=\\\"ctrl.maxItems <= ctrl.occupiedStrings.length\\\">No more space for new data services!</label> <label class=extra-label ng-if=\\\"ctrl.maxItems > ctrl.occupiedStrings.length\\\" ng-model=ctrl.newName>Import a copy with new name <b>{{ctrl.newName}}</b></label> <br/> <input type=radio class=radio name=import id=importSkip value={{ctrl.ConflictResolutionEnum.SKIP}} ng-model=ctrl.resolutionOption ng-change=ctrl.onChangeOption() /> <label for=importSkip class=radio-label>Skip</label> <br/> <label class=extra-label ng-model=ctrl.newName>Do not import this {{ctrl.objectName}}</label> <br/> <div class=\\\"field center\\\" ng-if=\\\"ctrl.remainingCount > 0\\\"> <input type=checkbox class=checkbox id=same-for-all ng-model=ctrl.sameForAll ng-disabled=\\\"ctrl.currentActionName === 'Copy' && ctrl.maxItems <= (ctrl.occupiedStrings.length + ctrl.remainingCount)\\\"/> <label for=same-for-all class=checkbox-label>Same action for remaining {{ctrl.remainingCount}} {{ctrl.objectName}}(s)</label> <label class=label-warning ng-if=\\\"ctrl.currentActionName === 'Copy' && ctrl.maxItems <= (ctrl.occupiedStrings.length + ctrl.remainingCount)\\\">Only space for {{ctrl.maxItems - ctrl.occupiedStrings.length}} new item(s)</label> </div> </fieldset> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel (All)</button> <button type=button class=btn-modal-primary ng-click=ctrl.resolve()>{{ctrl.currentActionName}}</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { Subcodes } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { IErrorResponse } from \"../../error-response\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\n\r\nexport interface IConflictDialogState {\r\n\tconfirmButton: {\r\n\t\ttext: string,\r\n\t\ttype: DialogButtonType,\r\n\t};\r\n\textraInfo: string;\r\n}\r\n\r\nexport class ImportErrorCtrl {\r\n\tpublic information: string;\r\n\tpublic extraInfo: string;\r\n\tpublic confirmButtonDisplayName: string;\r\n\tprivate dialog: IDialog<IErrorResponse>;\r\n\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<IErrorResponse>) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tconst state = this.stateBasedOnSubcode(dialog.parameter.subcode);\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.information = dialog.parameter.message;\r\n\t\tthis.extraInfo = state.extraInfo;\r\n\t\tthis.confirmButtonDisplayName = state.confirmButton.text;\r\n\t}\r\n\r\n\t/**\r\n\t * Depending on the given subcode, this import dialog will have different state\r\n\t *\r\n\t * @private\r\n\t * @param {number} subcode\r\n\t * @returns {IConflictDialogState}\r\n\t *\r\n\t * @memberof ImportConflictCtrl\r\n\t */\r\n\tprivate stateBasedOnSubcode(subcode: number): IConflictDialogState {\r\n\t\tswitch (subcode) {\r\n\t\t\tcase Subcodes.PROJECT_ID_CONFLICT:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tconfirmButton: {\r\n\t\t\t\t\t\ttext: \"Replace\",\r\n\t\t\t\t\t\ttype: DialogButtonType.Yes\r\n\t\t\t\t\t},\r\n\t\t\t\t\textraInfo: \"Would you like to replace that version?\",\r\n\t\t\t\t};\r\n\t\t\tcase Subcodes.PROJECT_DISPLAYNAME_CONFLICT:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tconfirmButton: {\r\n\t\t\t\t\t\ttext: \"Replace\",\r\n\t\t\t\t\t\ttype: DialogButtonType.Yes\r\n\t\t\t\t\t},\r\n\t\t\t\t\textraInfo: \"Would you like to replace the existing App?\",\r\n\t\t\t\t};\r\n\t\t\tdefault:\r\n\t\t\t\treturn {\r\n\t\t\t\t\tconfirmButton: {\r\n\t\t\t\t\t\ttext: \"Confirm\",\r\n\t\t\t\t\t\ttype: DialogButtonType.None\r\n\t\t\t\t\t},\r\n\t\t\t\t\textraInfo: \"\",\r\n\t\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic confirm(): void {\r\n\t\tconst state = this.stateBasedOnSubcode(this.dialog.parameter.subcode);\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tbutton: state.confirmButton.type\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirImportErrorCtrl\", ImportErrorCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { DialogButtonType, IDialog, IDialogResult } from \"../../services/dialog-service\";\r\n\r\nexport class ImportProjectCtrl {\r\n\tpublic chosenFile: FileList;\r\n\r\n\tprivate dialog: IDialog<FileList>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t];\r\n\r\n\tconstructor(private scope: IDialogBaseScope<FileList>) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.chosenFile = dialog.parameter;\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic import(): void {\r\n\t\tconst result: IDialogResult<FileList> = {\r\n\t\t\tvalue: this.chosenFile,\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\t\tthis.dialog.close(result);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirImportProjectCtrl\", ImportProjectCtrl);\r\n\t}\r\n}\r\n","import type { IComponentController, IOnInit } from \"angular\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IAboutOptions } from \"common/model/sohoxi/sohoxi-about.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\n\r\nimport { CommonService } from \"common/services/common-service\";\r\n\r\nexport class LicensesButton implements IComponentController, IOnInit{\r\n\tstatic $inject: string[] = [\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.COMMON_SERVICE\r\n\t];\r\n\r\n\tappName: string;\r\n\taboutOptions: IAboutOptions;\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate commonService: CommonService\r\n\t) { }\r\n\r\n\t$onInit(): void {\r\n\t\tconst promises: ng.IPromise<string>[] = [\r\n\t\t\tthis.commonService.loadApplicationVersion(),\r\n\t\t\tthis.commonService.loadDBVersions(),\r\n\t\t];\r\n\r\n\t\tthis.$q\r\n\t\t\t.all(promises)\r\n\t\t\t.then(response => {\r\n\t\t\t\tconst version = response[0];\r\n\t\t\t\tconst dbVersion = response[1];\r\n\t\t\t\tconst productName = this.appName.replace(\"Infor \", \"\");\r\n\t\t\t\tconst content = `<p>Form definitions database version ${dbVersion}</p>`;\r\n\r\n\t\t\t\tthis.aboutOptions = {\r\n\t\t\t\t\tappName: this.appName,\r\n\t\t\t\t\tproductName,\r\n\t\t\t\t\tversion,\r\n\t\t\t\t\tuseDefaultCopyright: true,\r\n\t\t\t\t\tcontent\r\n\t\t\t\t};\r\n\t\t\t});\r\n\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirLicensesButton\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tappName: \"@\"\r\n\t\t\t},\r\n\t\t\tcontroller: LicensesButton,\r\n\t\t\tcontrollerAs: \"eirLicenseButtonCtrl\",\r\n\t\t\ttemplate: `\r\n\t\t\t<button class=\"btn about\" id=\"about-dialog\"\r\n\t\t\t\txi-about=\"eirLicenseButtonCtrl.aboutOptions\"\r\n\t\t\t>\r\n\t\t\t\tAbout App Builder\r\n\t\t\t</button>\r\n\t\t\t`\r\n\t\t});\r\n\t}\r\n}\r\n","import { IJsonFileMetaData } from \"ng2/common/model/databearer/json-manifest.model\";\r\n\r\nexport class FileMetaData implements IJsonFileMetaData {\r\n\tmimeType: string;\r\n\tvisibleName: string;\r\n\r\n\tconstructor(visibleName: string, mimeType: string) {\r\n\t\tthis.mimeType = mimeType;\r\n\t\tthis.visibleName = visibleName;\r\n\t}\r\n}\r\n","import type { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IJsonInteractionParameter } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport type { IAvailableTargetField } from \"ng2/common/model/interaction/available-target-field.model\";\r\nimport type { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\n\r\nexport class InteractionParameter implements IInteractionParameter {\r\n\r\n\tprivate databearer: IJsonInteractionParameter;\r\n\r\n\ttargetField: IAvailableTargetField;\r\n\r\n\tconstructor(obj: IJsonInteractionParameter) {\r\n\t\tthis.databearer = obj;\r\n\t}\r\n\r\n\tgetDatabearer(): IJsonInteractionParameter {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tget targetKey(): string {\r\n\t\treturn this.databearer.targetKey;\r\n\t}\r\n\tset targetKey(targetKey: string) {\r\n\t\tthis.databearer.targetKey = targetKey;\r\n\t}\r\n\r\n\tget valueSource(): IJsonValueSource {\r\n\t\treturn this.databearer.valueSource;\r\n\t}\r\n\tset valueSource(valueSource: IJsonValueSource) {\r\n\t\tthis.databearer.valueSource = valueSource;\r\n\t}\r\n\r\n}\r\n","import { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nexport interface IAvailableTargetField {\r\n\tvisibleName: string;\r\n\ttargetKey: string;\r\n\tisMandatory?: boolean;\r\n\tMeta?: IJsonBindableField;\r\n}\r\n","import { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\n\r\nimport type { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\n\r\nexport class DataServiceHelper {\r\n\tstatic readonly urlComponentRegex = \"[^{}/=?&;]+\";\r\n\tstatic readonly urlComponentRegexBracket = \"{\" + DataServiceHelper.urlComponentRegex + \"}\";\r\n\r\n\tprivate static id: number;\r\n\r\n\tprivate static getNextId(): string {\r\n\t\tconst id = DataServiceHelper.id++;\r\n\t\treturn id.toString();\r\n\t}\r\n\r\n\tstatic parse(resourceUrl: string): IParameterObject[] {\r\n\t\tDataServiceHelper.id = 0;\r\n\t\tconst [path, matrix, query] = DataServiceHelper.deconstructPath(resourceUrl);\r\n\r\n\t\tconst pathParameters = DataServiceHelper.getPathParameters(path);\r\n\t\tconst matrixParameters = DataServiceHelper.getSpecificParameters(matrix, ParameterTypeEnum.MATRIX);\r\n\t\tconst queryParameters = DataServiceHelper.getSpecificParameters(query, ParameterTypeEnum.QUERY);\r\n\t\treturn pathParameters.concat(matrixParameters, queryParameters);\r\n\t}\r\n\r\n\tstatic deconstructPath(resourceUrl: string): string[] {\r\n\t\tconst pathMatch = resourceUrl.match(/^\\/?[^;?]+/);\r\n\t\tconst matrixMatch = resourceUrl.match(/;[^?]+/);\r\n\t\tconst queryMatch = resourceUrl.match(/\\?[^#]+/);\r\n\t\tconst hashMatch = resourceUrl.match(/#.+/);\r\n\r\n\t\tconst restPath = pathMatch ? pathMatch[0] : \"\";\r\n\t\tconst matrixPath = matrixMatch ? matrixMatch[0] : \"\";\r\n\t\tconst queryPath = queryMatch ? queryMatch[0] : \"\";\r\n\t\tconst hashTag = hashMatch ? hashMatch[0] : \"\";\r\n\r\n\t\treturn [restPath, matrixPath, queryPath, hashTag];\r\n\t}\r\n\r\n\t/**\r\n\t *\tMethod to get substitution tag for use in urls\r\n\t\t*\r\n\t\t* @param key used as name for MATRIX and QUERY, and just the tag for PATH. It will be URL encoded.\r\n\t\t* @param paramType (optional)\r\n\t\t*/\r\n\tstatic getURLVariable(key: string, paramType?: ParameterTypeEnum): string {\r\n\t\tlet value: string;\r\n\t\tswitch (paramType) {\r\n\t\t\tcase undefined:\r\n\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\tvalue = \"{\" + encodeURIComponent(key) + \"}\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\tvalue = encodeURIComponent(key) + \"={\" + encodeURIComponent(key) + \"}\";\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tvalue = key;\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tprivate static getPathParameters(resourceUrl: string): IParameterObject[] {\r\n\t\tconst regexp = new RegExp(\"/\" + this.urlComponentRegexBracket, \"g\");\r\n\t\tconst result = resourceUrl.match(regexp);\r\n\t\tif (!result) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst output = result.map<IParameterObject>((item) => {\r\n\t\t\treturn {\r\n\t\t\t\tid: DataServiceHelper.getNextId(),\r\n\t\t\t\tkey: decodeURIComponent(item.match(new RegExp(this.urlComponentRegex))[0]),\r\n\t\t\t\tvalueType: null,\r\n\t\t\t\tparameterType: ParameterTypeEnum.PATH,\r\n\t\t\t\trequired: true,\r\n\t\t\t\talias: \"\"\r\n\t\t\t} as any;\r\n\t\t});\r\n\t\treturn output;\r\n\t}\r\n\r\n\tprivate static getSpecificParameters(queryPath: string, type: ParameterTypeEnum): IParameterObject[] {\r\n\t\tconst regexp = new RegExp(this.urlComponentRegex + \"=\" + this.urlComponentRegexBracket, \"g\");\r\n\t\tconst result = queryPath.match(regexp);\r\n\t\tlet output: IParameterObject[] = [];\r\n\t\tif (result) {\r\n\t\t\toutput = result.map<IParameterObject>((item) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: DataServiceHelper.getNextId(),\r\n\t\t\t\t\tkey: decodeURIComponent(item.match(new RegExp(this.urlComponentRegex))[0]),\r\n\t\t\t\t\tvalueType: null,\r\n\t\t\t\t\tparameterType: type,\r\n\t\t\t\t\trequired: false,\r\n\t\t\t\t\talias: \"\"\r\n\t\t\t\t} as any;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn output;\r\n\t}\r\n\r\n\t/**\r\n\t * Validate if resource URL conforms to correct syntax\r\n\t * @param resourceUrl\r\n\t */\r\n\tstatic validate(resourceUrl: string): boolean {\r\n\t\tlet result = true;\r\n\t\tconst [path, matrix, query, hashTag] = DataServiceHelper.deconstructPath(resourceUrl);\r\n\r\n\t\tif (path.length > 0) {\r\n\t\t\tresult = DataServiceHelper.validatePath(path);\r\n\t\t}\r\n\t\tif (matrix.length > 0) {\r\n\t\t\tresult = result && DataServiceHelper.validateUrlPart(matrix, ParameterTypeEnum.MATRIX);\r\n\t\t}\r\n\t\tif (query.length > 0) {\r\n\t\t\tresult = result && DataServiceHelper.validateUrlPart(query, ParameterTypeEnum.QUERY);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate static validatePath(path: string): boolean {\r\n\t\tconst pathElements = path.split(\"/\").filter(DataServiceHelper.emptyItem);\r\n\t\tconst errorsFound = pathElements.filter(item => {\r\n\t\t\tconst pathRegex = new RegExp(\"^\" + this.urlComponentRegexBracket + \"$|^\" + this.urlComponentRegex + \"$\");\r\n\t\t\treturn item.match(pathRegex) === null;\r\n\t\t});\r\n\r\n\t\treturn errorsFound.length === 0;\r\n\t}\r\n\r\n\tprivate static validateUrlPart(query: string, type: ParameterTypeEnum): boolean {\r\n\t\tconst twoElements = 2;\r\n\t\tconst deliminator: any =\r\n\t\t\ttype === ParameterTypeEnum.MATRIX ? \";\" : new RegExp(/[?&]/);\r\n\t\tconst queryElements = query.split(deliminator).filter(DataServiceHelper.emptyItem);\r\n\t\tconst result = queryElements.filter(item => {\r\n\t\t\tif (item.indexOf(\"=\") === -1) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst elem = item.split(\"=\").filter(DataServiceHelper.emptyItem);\r\n\r\n\t\t\t// verify it is two elements\r\n\t\t\tif (elem.length !== twoElements) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\t// verify Name\r\n\t\t\tlet nameMatch = elem[0].match(\"^\" + this.urlComponentRegex + \"$\");\r\n\t\t\tif (!nameMatch) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\t// Verify Value\r\n\t\t\tnameMatch = elem[1].match(\"^\" + this.urlComponentRegexBracket + \"$\");\r\n\t\t\tif (!nameMatch) { // Static value\r\n\t\t\t\tif (elem[1].match(\"^\" + this.urlComponentRegex + \"$\") === null) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t} else { // Variable value\r\n\t\t\t\tconst pairMatch = item.match(new RegExp(\"^(\" + this.urlComponentRegex + \")={\\\\1}$\"));\r\n\t\t\t\tif (!pairMatch) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t});\r\n\t\treturn result.length === 0; // equals zero means no errors found\r\n\t}\r\n\r\n\tstatic emptyItem(item: string): boolean {\r\n\t\treturn item.length > 0;\r\n\t}\r\n}\r\n","import { IJsonInlineListDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport { DatasourceService } from \"../../../components/services/datasource-service\";\r\nimport { Datasource } from \"./datasource\";\r\n\r\nexport class InlineList extends Datasource {\r\n\tprotected databearer: IJsonInlineListDatasource;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonInlineListDatasource,\r\n\t\tprivate datasourceService: DatasourceService\r\n\t) {\r\n\t\tsuper(obj);\r\n\t}\r\n\r\n\tpublic getDetailData(): Promise<any> {\r\n\t\treturn this.loadData().then(result => result[0]);\r\n\t}\r\n\r\n\tpublic getNonParsedData(): Promise<any[]> {\r\n\t\tconst defer = this.datasourceService.$q.defer<any>();\r\n\t\tconst output = this.databearer.dataset.map(entry => {\r\n\t\t\tconst newEntry: IListDataItem = {};\r\n\t\t\tthis.databearer.outputParameters.forEach(parameter => {\r\n\t\t\t\tnewEntry[parameter.key] = entry[parameter.field];\r\n\t\t\t});\r\n\t\t\treturn newEntry;\r\n\t\t});\r\n\t\tdefer.resolve(output);\r\n\t\treturn defer.promise as Promise<any>;\r\n\t}\r\n\r\n\tpublic getListData(): Promise<any> {\r\n\t\treturn this.loadData()\r\n\t\t\t.then((result) => {\r\n\t\t\t\treturn result;\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate loadData(): Promise<any> {\r\n\t\tconst defer = this.datasourceService.$q.defer<any>();\r\n\t\tdefer.resolve(this.databearer.dataset);\r\n\t\treturn defer.promise as Promise<any>;\r\n\t}\r\n\r\n\tpublic getMetaData(): Promise<IMetaData> {\r\n\t\tconst deferredMetaData: ng.IDeferred<any> = this.datasourceService.getDeferred();\r\n\t\tconst outputFields: IMetaDataField[] = [];\r\n\t\tthis.databearer.outputParameters.forEach((param) => {\r\n\t\t\toutputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.key,\r\n\t\t\t\tMAND: \"0\",\r\n\t\t\t\ttype: \"string\"\r\n\t\t\t});\r\n\t\t});\r\n\t\tdeferredMetaData.resolve({\r\n\t\t\tinputFields: [],\r\n\t\t\toutputFields: outputFields\r\n\t\t});\r\n\t\treturn deferredMetaData.promise as Promise<any>;\r\n\t}\r\n}\r\n","import type { IPromise } from \"angular\";\r\nimport isArray from \"lodash-es/isArray\";\r\n\r\nimport { IdoProperties } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IJsonGenericDatasource2, IJsonLocalIdoDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport type { IMetaDataField } from \"ng2/common/model/dataservice/meta-data-field.model\";\r\nimport type { IMetaData } from \"ng2/common/model/dataservice/meta-data.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { ErrorResponse } from \"common/error-response\";\r\nimport { Datasource } from \"common/project/datasource/datasource\";\r\nimport { DatasourceService } from \"components/services/datasource-service\";\r\n\r\nexport class LocalIdo extends Datasource {\r\n\r\n\tprotected databearer: IJsonLocalIdoDatasource;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonGenericDatasource2,\r\n\t\tprivate datasourceService: DatasourceService\r\n\t) {\r\n\t\tsuper(obj);\r\n\t}\r\n\r\n\tpublic getDetailData(inputParameterValues: IMap<any>): Promise<any> {\r\n\t\treturn this.loadData(inputParameterValues)\r\n\t\t\t.then(result => Array.isArray(result[0]) ? result[0] : [result[0]])\r\n\t\t\t.then(result => this.parseListData(result)[0]);\r\n\t}\r\n\r\n\tpublic getListData(inputParameterValues: IMap<any>): Promise<any> {\r\n\t\treturn this.loadData(inputParameterValues)\r\n\t\t\t.then(result => {\r\n\t\t\t\treturn this.parseListData(result[0]);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate loadData(inputParameterValues?: IMap<any>): Promise<any> {\r\n\t\tconst defer = this.datasourceService.$q.defer<any>();\r\n\t\tconst parameters: IMap<any>[] = [{}];\r\n\t\tconst extraParameters: IMap<any> = {};\r\n\t\ttry {\r\n\t\t\tthis.databearer.inputParameters.forEach((idoParameter) => {\r\n\t\t\t\tconst inputparameter = inputParameterValues[idoParameter.id];\r\n\t\t\t\tif (idoParameter.required && !inputparameter) {\r\n\t\t\t\t\tthrow new Error((\"Parameter is required\"));\r\n\t\t\t\t} else if (inputparameter && isArray(inputparameter)) { // if multiple parameters\r\n\t\t\t\t\tinputparameter.forEach((parameter, index) => {\r\n\t\t\t\t\t\tif (!parameters[index]) {\r\n\t\t\t\t\t\t\tparameters.push({});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparameters[index][idoParameter.id] = parameter;\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (inputparameter) {\r\n\t\t\t\t\textraParameters[idoParameter.id] = inputparameter;\r\n\t\t\t\t\tif (parameters.length === 1) {\r\n\t\t\t\t\t\tparameters[0] = inputParameterValues;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} catch (e) {\r\n\t\t\tconst error: ErrorResponse = new ErrorResponse(e, e);\r\n\t\t\tdefer.reject(error);\r\n\t\t\tconsole.error(e);\r\n\t\t\treturn defer.promise as Promise<any>;\r\n\t\t}\r\n\r\n\t\tthis.fillInParameters(extraParameters, this.databearer.inputParameters, parameters);\r\n\t\tconst promises: IPromise<any>[] = [];\r\n\t\tparameters.forEach((parameter) => {\r\n\t\t\tpromises.push(this.datasourceService.localIdoRequest(this.databearer, parameter));\r\n\t\t});\r\n\t\treturn this.datasourceService.$q.all(promises) as Promise<any>;\r\n\t}\r\n\r\n\tpublic getNonParsedData(inputParameterValues: IMap<any>): Promise<any[]> {\r\n\t\treturn this.datasourceService\r\n\t\t\t.localIdoRequest(this.databearer, inputParameterValues) as Promise<any>;\r\n\t}\r\n\r\n\tprivate parseListData(result: IListDataItem[]): IListDataItem[] {\r\n\t\tconst output = result.map(idoEntry => {\r\n\t\t\tconst newEntry: IListDataItem = {};\r\n\t\t\tthis.databearer.outputParameters.forEach(parameter => {\r\n\t\t\t\tnewEntry[parameter.id] = idoEntry[parameter.key];\r\n\t\t\t});\r\n\t\t\tnewEntry.id = idoEntry[IdoProperties.ROW_POINTER]; // setting the ID on the item\r\n\t\t\treturn newEntry;\r\n\t\t});\r\n\r\n\t\treturn output;\r\n\t}\r\n\r\n\tpublic getMetaData(): Promise<IMetaData> {\r\n\t\tconst deferredMetaData: ng.IDeferred<any> = this.datasourceService.getDeferred();\r\n\t\tconst inputFields: IMetaDataField[] = [];\r\n\t\tconst outputFields: IMetaDataField[] = [];\r\n\r\n\t\tthis.databearer.inputParameters.forEach((param) => {\r\n\t\t\tinputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.alias ? param.alias : param.key,\r\n\t\t\t\tMAND: param.required ? \"1\" : \"0\",\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.databearer.outputParameters.forEach((param) => {\r\n\t\t\toutputFields.push({\r\n\t\t\t\tFLNM: param.id,\r\n\t\t\t\tFLDS: param.alias ? param.alias : param.key,\r\n\t\t\t\tMAND: \"0\",\r\n\t\t\t\ttype: param.dataType\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tdeferredMetaData.resolve({\r\n\t\t\tinputFields: inputFields,\r\n\t\t\toutputFields: outputFields\r\n\t\t});\r\n\r\n\t\treturn deferredMetaData.promise as Promise<any>;\r\n\t}\r\n}\r\n","import type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nimport { Generic2 } from \"common/project/datasource/generic2\";\r\n\r\nexport interface IMongooseCollectionItem {\r\n\tName: string;\r\n\tValue: string;\r\n}\r\nexport interface IMongooseIonApiResponse {\r\n\tItems?: IMongooseCollectionItem[][]|string[][];\r\n}\r\n\r\nexport interface IMongooseIonApiParsedResponse {\r\n\tItems?: {}[];\r\n}\r\n\r\nexport class Mongoose extends Generic2 {\r\n\tpublic loadData(\r\n\t\tparameters: IMap<any>\r\n\t): Promise<IMongooseIonApiResponse | IMongooseIonApiParsedResponse> {\r\n\t\treturn super.loadData(parameters)\r\n\t\t\t.then((response: IMongooseIonApiResponse[]) => {\r\n\t\t\t\tconst items = response[0].Items;\r\n\t\t\t\tif (items?.length > 0 && typeof items[0][0] === \"object\") {\r\n\t\t\t\t\tconst parsedResponse =\r\n\t\t\t\t\t\tthis.remapItemProperties(response[0]);\r\n\t\t\t\t\treturn parsedResponse;\r\n\t\t\t\t}\r\n\t\t\t\treturn response[0];\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t\treturn error;\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Remaps Mongoose ION response { Items: []:{ Name: string, Value: string} }\r\n\t * into { Items: []:{ Name: Value } } which is compliance with how data mapping is in App Builder\r\n\t *\r\n\t * @param IMongooseIonApiResponse\r\n\t */\r\n\tprivate remapItemProperties(response: IMongooseIonApiResponse): IMongooseIonApiParsedResponse {\r\n\t\tconst parsedResponse = response as IMongooseIonApiParsedResponse;\r\n\t\tconst items = response.Items as IMongooseCollectionItem[][];\r\n\r\n\t\tconst parsedItems = items.map(items => {\r\n\t\t\tconst obj: IMap<string> = {};\r\n\t\t\titems.forEach(item => {\r\n\t\t\t\tobj[item.Name] = item.Value !== null ? item.Value : \"\";\r\n\t\t\t});\r\n\t\t\treturn obj;\r\n\t\t});\r\n\t\tparsedResponse.Items = parsedItems;\r\n\t\treturn parsedResponse;\r\n\t}\r\n}\r\n","// TODO: MUPS-2682: Old thing?\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"../../defines\";\r\nimport { CommonService } from \"../../services/common-service\";\r\nimport { IDialog } from \"../../services/dialog-service\";\r\n\r\nexport class LicensesDialogCtrl {\r\n\tprivate dialog: IDialog<void>;\r\n\tpublic licensesHtml: String;\r\n\tpublic applicationVersion: String;\r\n\tpublic dbVersions: String;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<void>,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate $sce: any\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\t\tthis.licensesHtml = \"Loading...\";\r\n\t\t/*commonService.loadLicensesHtml().then((licensesHtml: any) => {\r\n\t\t\tthis.licensesHtml = licensesHtml;\r\n\t\t});*/\r\n\r\n\t\tcommonService.loadApplicationVersion().then((applicationVersion: string) => {\r\n\t\t\tthis.applicationVersion = applicationVersion;\r\n\t\t});\r\n\r\n\t\tcommonService.loadDBVersions().then((dbVersions: string) => {\r\n\t\t\tthis.dbVersions = dbVersions;\r\n\t\t});\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm\r\n\t\t\t.controller(\"eirLicensesDialogCtrl\", LicensesDialogCtrl)\r\n\t\t\t.filter(\"sanitize\", [\"$sce\", ($sce: any) => {\r\n\t\t\t\treturn (htmlCode: any) => {\r\n\t\t\t\t\treturn $sce.trustAsHtml(htmlCode);\r\n\t\t\t\t};\r\n\t\t\t}]);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IdoProperties, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport {\r\n\tIJsonDatasource,\r\n\tIJsonGenericDatasource2,\r\n} from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope, KeyCodeEnum } from \"../../defines\";\r\nimport { IErrorResponse } from \"../../error-response\";\r\n\r\nimport { JsonHelper } from \"ng2/common/helpers/json.helper\";\r\nimport { DatasourceService } from \"../../../components/services/datasource-service\";\r\nimport { Helper } from \"../../helper\";\r\nimport { DialogService, IDialog } from \"../../services/dialog-service\";\r\n\r\nexport enum TestDataserviceDialogType {\r\n\tUNFORMATTED = \"UNFORMATTED\",\r\n\tFORMATTED = \"FORMATTED\",\r\n}\r\nexport type TTestDataserviceDialogType\r\n\t= typeof TestDataserviceDialogType.FORMATTED\r\n\t| typeof TestDataserviceDialogType.UNFORMATTED;\r\n\r\nexport interface ITestParameter {\r\n\tid: string;\r\n\tkey: string;\r\n\tvalue: string;\r\n\tmandatory: boolean;\r\n}\r\n\r\nexport interface ITestDataserviceParameters {\r\n\ttype: TTestDataserviceDialogType;\r\n\tdataservice: IJsonDatasource;\r\n}\r\n\r\nexport class TestDataserviceDialogCtrl {\r\n\tpublic dataservice: IJsonDatasource;\r\n\tpublic datagridOptions: IDataGridOptions<any>;\r\n\tpublic parameters: ITestParameter[]; // The inputparams in the dialog\r\n\tpublic responseData: string = \"\";\r\n\tpublic type: TTestDataserviceDialogType;\r\n\tpublic fetching: boolean = false;\r\n\r\n\tprivate dialog: IDialog<IErrorResponse>;\r\n\tprivate testDialogTypes = TestDataserviceDialogType;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.DATASOURCE_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<any>,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate datasourceService: DatasourceService,\r\n\t\tprivate dialogService: DialogService,\r\n\t) {\r\n\t\tconst dialog = scope.eirDialog;\r\n\t\tthis.dialog = dialog;\r\n\r\n\t\tif (!dialog.parameter.dataservice) {\r\n\t\t\t// This is to make sure that the errordialog shows up AFTER the normal dialog.\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\tthis.handleError(new Error(\"Could not find the data service\")).finally(() => this.close());\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.dataservice = angular.copy(dialog.parameter.dataservice);\r\n\t\tthis.type = dialog.parameter.type;\r\n\t\tthis.datagridOptions = this.initDatagridOptions();\r\n\t\tthis.initGenericState(this.dataservice as IJsonGenericDatasource2);\r\n\t}\r\n\r\n\tpublic runApi(): void {\r\n\t\tif (!this.fetching) {\r\n\t\t\tthis.fetching = true;\r\n\t\t\tconst request: ng.IPromise<any> = this.runGenericApi(this.dataservice as IJsonGenericDatasource2);\r\n\r\n\t\t\trequest\r\n\t\t\t\t// Need to bind this as the unit tests doesnt like the scope otherwise\r\n\t\t\t\t.catch(this.handleError.bind(this))\r\n\t\t\t\t.finally(() => this.fetching = false);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic copyToClipboard(): void {\r\n\t\tangular.element(\"#testDataserviceTextareaField\").select();\r\n\t\ttry {\r\n\t\t\tconst successful = document.execCommand(\"copy\");\r\n\t\t\tif (!successful) {\r\n\t\t\t\tthrow new Error(\"Was not able to copy\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tthis.handleError(error);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic onKeyPress($event: JQueryEventObject): void {\r\n\t\tif ($event.which === KeyCodeEnum.ENTER) {\r\n\t\t\tthis.runApi();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initGenericState(dataservice: IJsonGenericDatasource2): void {\r\n\t\tif (dataservice.inputParameters) {\r\n\t\t\tthis.parameters = dataservice.inputParameters.map((param) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: param.id,\r\n\t\t\t\t\tkey: param.key,\r\n\t\t\t\t\tvalue: \"\",\r\n\t\t\t\t\tmandatory: param.required,\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate runGenericApi(dataservice: IJsonGenericDatasource2): ng.IPromise<any> {\r\n\t\tlet paramForInput = [];\r\n\t\tif (this.parameters) {\r\n\t\t\tparamForInput = this.parameters.reduce((acc: any, param) => {\r\n\t\t\t\tacc[param.id] = param.value;\r\n\t\t\t\treturn acc;\r\n\t\t\t}, {});\r\n\t\t}\r\n\r\n\t\tswitch (this.type) {\r\n\t\t\tcase TestDataserviceDialogType.UNFORMATTED:\r\n\t\t\t\treturn this.getUnFormattedData(dataservice, paramForInput);\r\n\t\t\tcase TestDataserviceDialogType.FORMATTED:\r\n\t\t\t\treturn this.getFormattedData(dataservice, paramForInput);\r\n\t\t\tdefault:\r\n\t\t\t\treturn this.$q.reject(new Error(\"Request format is not supported\"));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getFormattedData(dataservice: IJsonGenericDatasource2, parameters: any): ng.IPromise<any> {\r\n\r\n\t\tconst formatResults = (result: any) => {\r\n\t\t\t// As we are using getDetailData, this always returns result as a object?\r\n\t\t\tif (dataservice.outputParameters.length === 0) {\r\n\t\t\t\tthrow Error(\"No output parameter(s) specified.\");\r\n\t\t\t}\r\n\r\n\t\t\tconst formattedResult = Object.keys(result).map((key) => {\r\n\t\t\t\tconst maybeNewKey = dataservice.outputParameters.find((outputParam) => outputParam.id === key);\r\n\t\t\t\tlet newKey = key;\r\n\t\t\t\tif (maybeNewKey) {\r\n\t\t\t\t\tnewKey = !!maybeNewKey.alias ? maybeNewKey.alias : maybeNewKey.key;\r\n\t\t\t\t}\r\n\t\t\t\treturn { name: newKey, value: result[key] };\r\n\t\t\t});\r\n\t\t\treturn formattedResult;\r\n\t\t};\r\n\r\n\t\tconst setResults = (result: any) => {\r\n\t\t\tthis.fillResponseData(result);\r\n\t\t\tthis.datagridOptions.dataset = result;\r\n\t\t\treturn result;\r\n\t\t};\r\n\r\n\t\treturn this.datasourceService\r\n\t\t\t.parseDatasourceToTS(dataservice)\r\n\t\t\t.getDetailData(parameters)\r\n\t\t\t.then(result => formatResults(result))\r\n\t\t\t.then(setResults);\r\n\t}\r\n\r\n\tprivate getUnFormattedData(dataservice: IJsonGenericDatasource2, parameters: any): ng.IPromise<any> {\r\n\t\tconst setResults = (result: any) => {\r\n\t\t\tif (dataservice.typedef === DatasourceTypeEnum.IDO) {\r\n\t\t\t\tconst hasRowPointer = dataservice.outputParameters.find((item => item.key === IdoProperties.ROW_POINTER));\r\n\t\t\t\tif (!hasRowPointer) {\r\n\t\t\t\t\tfor (let i = 0; i < result.length; i++) {\r\n\t\t\t\t\t\tdelete result[i][IdoProperties.ROW_POINTER];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.fillResponseData(result);\r\n\t\t};\r\n\r\n\t\treturn this.datasourceService\r\n\t\t\t.parseDatasourceToTS(dataservice)\r\n\t\t\t.getNonParsedData(parameters)\r\n\t\t\t.then(setResults);\r\n\t}\r\n\r\n\tprivate fillResponseData(result: any): void {\r\n\t\tthis.$timeout(() => {\r\n\t\t\tthis.responseData = JsonHelper.prettify(result);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handleError(error: Error): ng.IPromise<any> {\r\n\t\tthis.responseData = Helper.cleanTemplateLiteral(error.message);\r\n\t\tconsole.error(error.message);\r\n\t\treturn this.dialogService.showError(\"Error\", error.message);\r\n\t}\r\n\r\n\tprivate initDatagridOptions(): IDataGridOptions<any> {\r\n\t\tconst columns = [\r\n\t\t\t{\r\n\t\t\t\tid: \"name\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"name\",\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"description\",\r\n\t\t\t\tname: \"Description\",\r\n\t\t\t\tfield: \"value\",\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis\r\n\t\t\t},\r\n\t\t];\r\n\t\treturn {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: [{}],\r\n\t\t};\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirTestDataserviceCtrl\", TestDataserviceDialogCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../common/angular-constants\";\r\n\r\nimport { DatagridExportTypes } from \"ng2/common/constants/common.constant\";\r\nimport { IDialogBaseScope } from \"../../common/defines\";\r\nimport { DialogButtonType, IDialogResult } from \"../../common/services/dialog-service\";\r\n\r\nexport interface IDatagridExportResult {\r\n\texportName: string;\r\n\texportType: string;\r\n}\r\n\r\nexport class DatagridExportDialogCtrl {\r\n\tpublic exportType: string;\r\n\tpublic exportName: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<void>,\r\n\t) {\r\n\t\tthis.exportName = \"\";\r\n\t\tthis.exportType = DatagridExportTypes.EXCEL;\r\n\t}\r\n\r\n\tpublic export(): void {\r\n\t\tconst result: IDialogResult<IDatagridExportResult> = {\r\n\t\t\tvalue: {\r\n\t\t\t\texportName: this.exportName,\r\n\t\t\t\texportType: this.exportType,\r\n\t\t\t},\r\n\t\t\tbutton: DialogButtonType.Ok\r\n\t\t};\r\n\r\n\t\tthis.$scope.eirDialog.close(result);\r\n\t}\r\n\r\n\tpublic close(): void {\r\n\t\tthis.$scope.eirDialog.close();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirDatagridExportDialogCtrl\", DatagridExportDialogCtrl);\r\n\t}\r\n}","export class RepeatDoneDirective {\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"repeatDone\", () => {\r\n\t\t\treturn (\r\n\t\t\t\tscope: ng.IRepeatScope,\r\n\t\t\t\telement: ng.IAugmentedJQuery,\r\n\t\t\t\tattrs: any\r\n\t\t\t) => {\r\n\t\t\t\tif (scope.$last) {\r\n\t\t\t\t\tscope.$eval(attrs.repeatDone);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"./angular-constants\";\r\n\r\nexport class DragDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\t// http://stackoverflow.com/a/38753647/304894\r\n\t\tconst ngDragEventDirectives: any = {};\r\n\t\tangular.forEach(\r\n\t\t\t\"drag dragend dragenter dragexit dragleave dragover dragstart drop\".split(\r\n\t\t\t\t\" \"\r\n\t\t\t),\r\n\t\t\t(eventName) => {\r\n\t\t\t\tconst directiveName: string =\r\n\t\t\t\t\t\"ng\" + eventName.charAt(0).toUpperCase() + eventName.slice(1);\r\n\r\n\t\t\t\tngDragEventDirectives[directiveName] = [\r\n\t\t\t\t\t\"$parse\",\r\n\t\t\t\t\tAngularConstants.ROOT_SCOPE,\r\n\t\t\t\t\t($parse: ng.IParseService, $rootScope: ng.IRootScopeService) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\trestrict: \"A\",\r\n\t\t\t\t\t\t\tcompile: (\r\n\t\t\t\t\t\t\t\t$element: ng.IRootElementService,\r\n\t\t\t\t\t\t\t\tattr: ng.IAttributes\r\n\t\t\t\t\t\t\t) => {\r\n\t\t\t\t\t\t\t\tconst fn = $parse(attr[directiveName]);\r\n\r\n\t\t\t\t\t\t\t\treturn function ngDragEventHandler(\r\n\t\t\t\t\t\t\t\t\tscope: ng.IScope,\r\n\t\t\t\t\t\t\t\t\telement: ng.IAugmentedJQuery\r\n\t\t\t\t\t\t\t\t): void {\r\n\t\t\t\t\t\t\t\t\telement.on(eventName, (event: JQueryEventObject) => {\r\n\t\t\t\t\t\t\t\t\t\tfn(scope, { $event: event });\r\n\t\t\t\t\t\t\t\t\t\tscope.$digest(); // do digest directly on scope since apply does digest on rootScope\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t},\r\n\t\t\t\t];\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tm.directive(ngDragEventDirectives);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../angular-constants\";\r\nimport { IJQueryScrollEventObject } from \"../defines\";\r\n\r\nexport interface IInfScrollScope extends ng.IScope {\r\n\teirInfiniteScroll: Function;\r\n}\r\n\r\nclass InfiniteScrollCtrl {\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.INTERVAL\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $scope: IInfScrollScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $interval: ng.IIntervalService\r\n\t) {\r\n\t\tthis.initialize();\r\n\t}\r\n\r\n\t// Varibles that potentially will be input variables\r\n\tprivate THROTTLE_MILLISECONDS = 50;\r\n\tprivate loadMore: Function;\r\n\tprivate scrollDistanceThreshold: number = 0.25;\r\n\tprivate bounceDistance: number = 10;\r\n\tprivate EDGE_BOUNCE_INTERVAL_MILLIESECONDS = 50;\r\n\r\n\t// State variables\r\n\tprivate lastScrollTop: number = 0;\r\n\tprivate edgeBounceInterval: {\r\n\t\tup: ng.IPromise<void> | null;\r\n\t\tdown: ng.IPromise<void> | null;\r\n\t} = { up: null, down: null };\r\n\r\n\tprivate initialize(): void {\r\n\t\tconst scope = this.$scope;\r\n\t\tconst element = this.$element;\r\n\t\tthis.loadMore = scope.eirInfiniteScroll;\r\n\t\tscope.$watch(\"eirInfiniteScrollEnabled\", (scrollEnabled) => {\r\n\t\t\tif (scrollEnabled) {\r\n\t\t\t\telement.on(\"scroll\", this.throttle(this.handler, this.THROTTLE_MILLISECONDS));\r\n\t\t\t} else {\r\n\t\t\t\telement.off(\"scroll\");\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tscope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\telement.off(\"scroll\");\r\n\t\t});\r\n\t}\r\n\r\n\tprivate handler(evt: IJQueryScrollEventObject): void {\r\n\t\tconst target = evt.currentTarget;\r\n\t\tconst scrollingDown: boolean = (this.lastScrollTop < target.scrollTop);\r\n\t\tconst scrollingUp: boolean = (this.lastScrollTop > target.scrollTop);\r\n\t\tthis.lastScrollTop = target.scrollTop;\r\n\r\n\t\tif (scrollingDown) {\r\n\t\t\tconst distanceFromBottom = target.scrollHeight - (target.offsetHeight + target.scrollTop);\r\n\t\t\tconst closeEnoughToBottom = distanceFromBottom < (target.offsetHeight * this.scrollDistanceThreshold);\r\n\t\t\tif (closeEnoughToBottom) {\r\n\t\t\t\tthis.loadMore({ scrollingDown });\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t}\r\n\t\t\tif (distanceFromBottom <= 0) {\r\n\t\t\t\ttarget.scrollTop -= this.bounceDistance;\r\n\t\t\t}\r\n\t\t} else if (scrollingUp) {\r\n\t\t\tconst distanceFromTop = target.scrollTop;\r\n\t\t\tconst closeEnoughToTop = distanceFromTop < (target.offsetHeight * this.scrollDistanceThreshold);\r\n\t\t\tif (closeEnoughToTop) {\r\n\t\t\t\tthis.loadMore({ scrollingDown });\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t}\r\n\t\t\tif (distanceFromTop <= 0) {\r\n\t\t\t\ttarget.scrollTop += this.bounceDistance;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.bounceEdges(evt);\r\n\t}\r\n\r\n\t// Make sure that it always bounds when reaching edges.\r\n\t// This can happen in the rare case of user manually scrolling in scrollbar\r\n\tprivate bounceEdges(evt: IJQueryScrollEventObject): void {\r\n\t\tconst target = evt.currentTarget;\r\n\t\tconst distanceFromBottom = target.scrollHeight - (target.offsetHeight + target.scrollTop);\r\n\t\tconst distanceFromTop = target.scrollTop;\r\n\r\n\t\tif (this.edgeBounceInterval.up) {\r\n\t\t\tthis.$interval.cancel(this.edgeBounceInterval.up);\r\n\t\t\tthis.edgeBounceInterval.up = null;\r\n\t\t}\r\n\t\tif (this.edgeBounceInterval.down) {\r\n\t\t\tthis.$interval.cancel(this.edgeBounceInterval.down);\r\n\t\t\tthis.edgeBounceInterval.down = null;\r\n\t\t}\r\n\r\n\t\tif (distanceFromBottom <= 0) {\r\n\t\t\tthis.edgeBounceInterval.up = this.$interval(() => {\r\n\t\t\t\tif (distanceFromBottom <= 0) {\r\n\t\t\t\t\ttarget.scrollTop -= this.bounceDistance;\r\n\t\t\t\t}\r\n\t\t\t}, this.EDGE_BOUNCE_INTERVAL_MILLIESECONDS);\r\n\t\t}\r\n\t\tif (distanceFromTop <= 0) {\r\n\t\t\tthis.edgeBounceInterval.down = this.$interval(() => {\r\n\t\t\t\tif (distanceFromTop <= 0) {\r\n\t\t\t\t\ttarget.scrollTop += this.bounceDistance;\r\n\t\t\t\t}\r\n\t\t\t}, this.EDGE_BOUNCE_INTERVAL_MILLIESECONDS);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate throttle(\r\n\t\tfunc: (e: IJQueryScrollEventObject) => void,\r\n\t\twait: number\r\n\t): (e: IJQueryScrollEventObject) => void {\r\n\t\tlet timeout: ng.IPromise<void> = null;\r\n\t\tlet previous = 0;\r\n\r\n\t\tconst later = (event: IJQueryScrollEventObject) => {\r\n\t\t\tprevious = new Date().getTime();\r\n\t\t\tthis.$timeout.cancel(timeout);\r\n\t\t\ttimeout = null;\r\n\t\t\treturn func.call(this, event);\r\n\t\t};\r\n\r\n\t\tconst throttled = (event: IJQueryScrollEventObject) => {\r\n\t\t\tconst now = new Date().getTime();\r\n\t\t\tconst remaining = wait - (now - previous);\r\n\t\t\tif (remaining <= 0) {\r\n\t\t\t\tthis.$timeout.cancel(timeout);\r\n\t\t\t\ttimeout = null;\r\n\t\t\t\tprevious = now;\r\n\t\t\t\tfunc.call(this, event);\r\n\t\t\t} else {\r\n\t\t\t\tthis.$timeout.cancel(timeout);\r\n\t\t\t\ttimeout = this.$timeout(later, remaining, false, event);\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn throttled;\r\n\t}\r\n}\r\n\r\nexport class InfiniteScrollDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = {\r\n\t\teirInfiniteScroll: \"&\",\r\n\t\teirInfiniteScrollEnabled: \"=\"\r\n\t};\r\n\r\n\tpublic controller = InfiniteScrollCtrl;\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = () => {\r\n\t\t\treturn new InfiniteScrollDirective();\r\n\t\t};\r\n\t\tm.directive(\"eirInfiniteScroll\", directive);\r\n\t}\r\n}\r\n","import { Helper } from \"./helper\";\r\n\r\nimport { Config, InjectNames, MGPlatform, Numbers } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { IEnvironmentSettings } from \"ng2/common/model/environment-settings.model\";\r\n\r\nimport { AngularConstants } from \"common/angular-constants\";\r\nimport { Debugger } from \"common/debugger\";\r\nimport { WSUserControl } from \"etc-assets/user-control-es\";\r\n\r\nimport { CommonService } from \"common/services/common-service\";\r\nimport { LanguageService } from \"common/services/language-service\";\r\n\r\ninterface IInitializeScope extends ng.IScope {\r\n\tdone: boolean;\r\n\tisLoading: boolean;\r\n}\r\n\r\nclass InitializeCtrl {\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.INTERVAL,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IInitializeScope,\r\n\t\tprivate $interval: ng.IIntervalService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate languageService: LanguageService\r\n\t) {\r\n\t\tif (DEV_SERVER) {\r\n\t\t\tthis.loadEnvironmentSettings();\r\n\t\t}\r\n\t\tWSUserControl.onReady(() => {\r\n\t\t\tthis.loadEnvironmentSettings();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate loadEnvironmentSettings(): void {\r\n\t\tthis.commonService.loadEnvironmentSettings()\r\n\t\t\t.then((settings: IEnvironmentSettings) => {\r\n\t\t\t\tConfig.IS_DEV = settings.isDevelopment;\r\n\t\t\t\tConfig.ION_API_URL = settings.url;\r\n\t\t\t\tConfig.MAX_PROJECTS = settings.maxProjects;\r\n\t\t\t\tConfig.MAX_APPS = settings.maxApps;\r\n\t\t\t\tConfig.MAX_COMPOSITES = settings.maxComposites;\r\n\t\t\t\tConfig.MAX_DATASOURCES = settings.maxDatasources;\r\n\t\t\t\tConfig.LOCALE = settings.locale;\r\n\t\t\t\tConfig.TENANT_ID = settings.tenantId;\r\n\t\t\t\tConfig.USER = settings.user;\r\n\t\t\t\tConfig.MG_FORM_NAME = settings.mgFormName;\r\n\t\t\t\tConfig.MG_FORM_ONLY = settings.mgFormOnly;\r\n\t\t\t\tConfig.MG_PLATFORM = settings.mgPlatform;\r\n\t\t\t\tConfig.MG_CONFIG_NAME = settings.mgConfigName;\r\n\t\t\t\tConfig.MG_HELP_BASE_URL = settings.mgHelpBaseUrl;\r\n\t\t\t\tDebugger.initialize();\r\n\t\t\t\tthis.$scope.done = Config.IS_CONFIG_LOADED = true;\r\n\t\t\t})\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.languageService.initializeLanguageSettings();\r\n\t\t\t\tthis.setBaseBuilder();\r\n\t\t\t})\r\n\t\t\t.then(() => {\r\n\t\t\t\tconst stop = this.$interval(() => {\r\n\t\t\t\t\tif (!Config.IS_FIRST_LOAD) {\r\n\t\t\t\t\t\tthis.$scope.isLoading = Config.IS_FIRST_LOAD;\r\n\t\t\t\t\t\tthis.$interval.cancel(stop);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, Numbers.HUNDRED);\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate setBaseBuilder(): void {\r\n\t\tconst url = Config.MG_PLATFORM === MGPlatform.WEB || DEV_SERVER ?\r\n\t\t\twindow.parent.location.search.substring(1) :\r\n\t\t\twindow.location.search.substring(1);\r\n\r\n\t\tconst query = Helper.parseQueryString(url);\r\n\t\tif (query.basebuilder) {\r\n\t\t\tConfig.IS_BASE_BUILDER = true;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class InitializeDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirInitialize\", () => {\r\n\t\t\treturn {\r\n\t\t\t\trestrict: \"A\",\r\n\t\t\t\tscope: {\r\n\t\t\t\t\tdone: \"=eirInitialize\",\r\n\t\t\t\t\tisLoading: \"=\"\r\n\t\t\t\t},\r\n\t\t\t\tcontroller: InitializeCtrl,\r\n\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { Helper } from \"../../helper\";\r\nimport { FieldValidation } from \"../base/field-validation\";\r\n\r\nexport class DropdownFieldCtrl extends FieldValidation {\r\n\r\n\tpublic $static = [\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.SCOPE,\r\n\t];\r\n\r\n\t// Bindings\r\n\tpublic listValues: string[];\r\n\tpublic onChange: Function;\r\n\r\n\tconstructor(\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\t$scope: ng.IScope,\r\n\t) {\r\n\t\tsuper();\r\n\r\n\t\t$element\r\n\t\t\t.on(\"listclosed\", () => {\r\n\t\t\t\tif (!Helper.isUndefined(this.validation)) {\r\n\t\t\t\t\tthis.validate();\r\n\r\n\t\t\t\t\t// needs to trigger Angular digest cycle\r\n\t\t\t\t\t$scope.$applyAsync();\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.on(\"change\", () => {\r\n\t\t\t\tif (this.onChange) {\r\n\t\t\t\t\tthis.onChange();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n}\r\n\r\nexport class DropdownFieldComponent implements ng.IComponentOptions {\r\n\tpublic controller = DropdownFieldCtrl;\r\n\tpublic template = require(\"./dropdown-template.html\");\r\n\tpublic bindings: IMap<string> = {\r\n\t\tid: \"@?\",\r\n\t\tlabelName: \"@?\",\r\n\t\tfieldValue: \"=\",\r\n\t\tvalidation: \"<?\",\r\n\t\treadonly: \"<?\",\r\n\t\tlistValues: \"<\",\r\n\t\tonChange: \"&?\"\r\n\t};\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\r\n\t\t\t\"eirDropdownFieldComponent\",\r\n\t\t\tnew DropdownFieldComponent());\r\n\t}\r\n}\r\n","import { Debugger } from \"../../debugger\";\r\nimport { FeatureSwitchService } from \"../../services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"./feature-switch-ctrl\";\r\nimport { IValidationResult } from \"./field-validation\";\r\n\r\n/**\r\n * Extend this class if parent has components which needs to notify each other on changes\r\n */\r\nexport abstract class NotifiableComponent extends FeatureSwitchCtrl {\r\n\tpublic parentAnnounce: IParentAnnounce;\r\n\r\n\tpublic constructor(featureSwitchService?: FeatureSwitchService) {\r\n\t\tsuper(featureSwitchService);\r\n\t}\r\n\r\n\tprotected notify($data: IOnComponentChangeNotification): boolean | IValidationResult {\r\n\t\tconst result: boolean | IValidationResult = this.getValidation($data);\r\n\r\n\t\tif (!$data.callback) {\r\n\t\t\tDebugger.log(this, `$data.id=\"${$data.id}\" - Notify Children To Update`);\r\n\r\n\t\t\t// tell children it is from this sibling which announced.\r\n\t\t\t// so that sibling knows it doesn't have to tell its parent about it.\r\n\t\t\tthis.parentAnnounce = {\r\n\t\t\t\tid: $data.id\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprotected getValidation(\r\n\t\t$data: IOnComponentChangeNotification\r\n\t): boolean | IValidationResult {\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nexport interface IOnComponentChangeNotification {\r\n\tvalidator: string;\r\n\tid: string;\r\n\tvalue: string;\r\n\tcallback: boolean;\r\n}\r\n\r\nexport interface IParentAnnounce {\r\n\tid: string;\r\n}\r\n","// Module\nvar code = \"<div ng-if=\\\"$ctrl.validation !== undefined\\\" class=dropdown-field> <label for=dropdown-field-component ng-class=\\\"{ required : $ctrl.isRequired }\\\" ng-if=\\\"$ctrl.labelName !== undefined\\\"> {{ $ctrl.labelName }} </label> <select id=ido-project-select class=\\\"dropdown-field-component dropdown-lg\\\" ng-model=$ctrl.fieldValue ng-options=\\\"item for item in $ctrl.listValues\\\" xi-drop-down></select> <div ng-repeat=\\\"validatorError in $ctrl.fieldSpecificErrors\\\" ng-style=\\\"{ 'display': $ctrl.displayStatus }\\\" class=error-message> <svg class=\\\"icon-error icon\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-error></use> </svg> <pre class=audible>Error</pre> <p class=message-text>{{ validatorError.message }}</p> </div> </div> <div ng-if=\\\"$ctrl.validation === undefined\\\"> <label for=dropdown-field-component>{{ $ctrl.labelName }}</label> <select id=ido-project-select class=\\\"dropdown-field-component dropdown-lg\\\" ng-model=$ctrl.fieldValue ng-options=\\\"item for item in $ctrl.listValues\\\" xi-drop-down></select> </div> \";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { FilterPopupmenuCtrl } from \"./filter-popupmenu-ctrl\";\r\n\r\nexport class FilterPopupmenuComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tfilterOptions: \"<\",\r\n\t\t\tfilterValues: \"=\",\r\n\t\t\tlocalPrefix: \"<\"\r\n\t\t};\r\n\r\n\t\tthis.controller = [\r\n\t\t\tAngularConstants.FILTER,\r\n\t\t\tFilterPopupmenuCtrl\r\n\t\t];\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./filter-popupmenu-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirFilterPopupmenuComponent\", new FilterPopupmenuComponent());\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nexport class FilterPopupmenuCtrl<T> {\r\n\r\n\t// component bindings\r\n\tpublic filterOptions: IDataPair[];\r\n\tpublic localPrefix: string;\r\n\tpublic filterValues: T[];\r\n\r\n\tprivate originalValues: T[];\r\n\tprivate previousFilterValues: T[];\r\n\tprivate currentSelectedFilter: IDataPair;\r\n\tprivate readonly filterOn = \"filter-on\";\r\n\r\n\tprivate orderBy: ng.IFilterOrderBy = this.$filter(\"orderBy\");\r\n\tprivate filter: ng.IFilterFilter = this.$filter(\"filter\");\r\n\r\n\t$inject = [\r\n\t\tAngularConstants.FILTER\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $filter: ng.IFilterService\r\n\t) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\tconst storageName = this.localPrefix + this.filterOn;\r\n\t\tconst storedFilter: IDataPair = JSON.parse(localStorage.getItem(storageName));\r\n\t\tthis.originalValues = angular.copy(this.filterValues);\r\n\r\n\t\tif (!storedFilter) {\r\n\t\t\tconst filterOption = this.filterOptions[0];\r\n\t\t\tlocalStorage.setItem(storageName, JSON.stringify(filterOption));\r\n\t\t\tthis.currentSelectedFilter = filterOption;\r\n\t\t} else {\r\n\t\t\tthis.currentSelectedFilter =\r\n\t\t\t\tthis.filterOptions.find(x => x.name === storedFilter.name);\r\n\t\t}\r\n\r\n\t\tthis.doFilter();\r\n\t}\r\n\r\n\tpublic $doCheck(): void {\r\n\t\tconst previousValues = this.previousFilterValues;\r\n\t\tconst currentValues = this.filterValues;\r\n\r\n\t\tif (previousValues.length !== currentValues.length ||\r\n\t\t\tthis.equalLengthsNotSameContent(previousValues, currentValues)\r\n\t\t) {\r\n\t\t\tthis.originalValues = angular.copy(currentValues);\r\n\t\t\tthis.doFilter();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onFilter(filterOption: IDataPair): void {\r\n\t\tconst storageName = this.localPrefix + this.filterOn;\r\n\r\n\t\tthis.currentSelectedFilter = angular.copy(filterOption);\r\n\t\tlocalStorage.setItem(storageName, JSON.stringify({ name: filterOption.name }));\r\n\r\n\t\tthis.doFilter();\r\n\t}\r\n\r\n\tprivate doFilter(): void {\r\n\t\tconst currentSelectedFilter = this.currentSelectedFilter.value;\r\n\r\n\t\tif (currentSelectedFilter) {\r\n\t\t\tthis.filterValues = this.filter(this.originalValues, currentSelectedFilter);\r\n\t\t} else {\r\n\t\t\tthis.filterValues = this.originalValues;\r\n\t\t}\r\n\t\tthis.previousFilterValues = this.filterValues;\r\n\t}\r\n\r\n\tprivate equalLengthsNotSameContent(listA: T[], listB: T[]): boolean {\r\n\t\treturn (listA.length === listB.length &&\r\n\t\t\t!angular.equals(\r\n\t\t\t\tthis.orderBy(listA, \"manifest.createdTime\"),\r\n\t\t\t\tthis.orderBy(listB, \"manifest.createdTime\")));\r\n\t}\r\n\r\n}\r\n","// Module\nvar code = \"<button type=button id=buttonFilterBy class=btn-menu xi-popupmenu> <span>{{ ctrl.currentSelectedFilter.name }}</span> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-dropdown></use> </svg> </button> <ul class=popupmenu> <li ng-repeat=\\\"filterOption in ctrl.filterOptions track by filterOption.name\\\" ng-click=ctrl.onFilter(filterOption)> <a>{{filterOption.name}}</a> </li> </ul>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { FilterTagCtrl } from \"./filter-tag-ctrl\";\r\n\r\nexport class FilterTagComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tfilterValues: \"=\",\r\n\t\t\tlocalPrefix: \"<\"\r\n\t\t};\r\n\r\n\t\tthis.controller = [\r\n\t\t\tAngularConstants.FILTER,\r\n\t\t\tInjectNames.TAG_SERVICE,\r\n\t\t\tFilterTagCtrl\r\n\t\t];\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./filter-tag-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirFilterTagComponent\", new FilterTagComponent());\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { IProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nimport { TagService } from \"../../services/tag-service\";\r\n\r\nexport class FilterTagCtrl<T> {\r\n\r\n\tpublic selectedTags: IJsonTag[] = [];\r\n\tpublic currentTag: IJsonTag = {\r\n\t\tid: \"select\",\r\n\t\tname: \"All\"\r\n\t};\r\n\tpublic filterValues: IProjectInfo[];\r\n\tpublic filterOptions: IJsonTag[] = [];\r\n\r\n\tprivate originalValues: IProjectInfo[];\r\n\tprivate previousFilterValues: IProjectInfo[];\r\n\tprivate unsubscribers: Function[] = [];\r\n\r\n\tprivate filter: ng.IFilterFilter = this.$filter(\"filter\");\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.FILTER,\r\n\t\tInjectNames.TAG_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $filter: ng.IFilterService,\r\n\t\tprivate tagService: TagService\r\n\t) {\r\n\t\tthis.unsubscribers.push(tagService.projectInfoChangedEvent.on((projects) => {\r\n\t\t\tthis.updateValues(projects);\r\n\t\t\tthis.doFilter();\r\n\t\t}));\r\n\t\tthis.getAvailableTags();\r\n\t}\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.originalValues = angular.copy(this.filterValues);\r\n\t\tthis.doFilter();\r\n\t}\r\n\r\n\tprivate doFilter(): void {\r\n\t\tif (this.selectedTags.length > 0) {\r\n\t\t\tthis.filterValues = this.filter(this.originalValues,\r\n\t\t\t\t(projectItem: IProjectInfo) => {\r\n\t\t\t\t\treturn this.filterProject(projectItem);\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.filterValues = angular.copy(this.originalValues);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addTag(): void {\r\n\t\tconst alreadyExists = this.selectedTags.some((tag) => {\r\n\t\t\treturn tag.id === this.currentTag.id;\r\n\t\t});\r\n\t\tif (!alreadyExists && this.currentTag.id !== \"select\") {\r\n\t\t\tthis.selectedTags.push(this.currentTag);\r\n\t\t\tthis.doFilter();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic deleteTag(tag: IJsonTag): void {\r\n\t\tconst selectedTags = angular.copy(this.selectedTags);\r\n\t\tthis.selectedTags = selectedTags.filter((selectedTag) => {\r\n\t\t\treturn tag.id !== selectedTag.id;\r\n\t\t});\r\n\t\tthis.doFilter();\r\n\t}\r\n\r\n\tprivate filterProject(project: IProjectInfo): boolean {\r\n\t\treturn this.selectedTags.some((selectedTag) => {\r\n\t\t\treturn project.tags.some((projectTag) => {\r\n\t\t\t\treturn projectTag.name === selectedTag.name;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateValues(projects: IProjectInfo[]): void {\r\n\t\t// Update original values with new setting data\r\n\t\t// TODO: refactor to more isolated method\r\n\t\tconst originalValues = angular.copy(this.originalValues);\r\n\t\toriginalValues.forEach((originalProject, index) => {\r\n\t\t\tprojects.forEach((currentProject) => {\r\n\t\t\t\tif (originalProject.manifest.id === currentProject.manifest.id) {\r\n\t\t\t\t\tthis.originalValues[index] = currentProject;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\tthis.getAvailableTags();\r\n\t}\r\n\r\n\tprivate getAvailableTags(): void {\r\n\t\tthis.filterOptions = [this.currentTag];\r\n\t\tthis.tagService.getAvailableTags().then((tags) => {\r\n\t\t\tthis.filterOptions.push(...tags);\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=\\\"with-button filter-tag\\\"> <div class=tag-container> <a class=\\\"tag is-dismissable\\\" ng-repeat=\\\"tag in ctrl.selectedTags track by tag.id\\\">{{tag.name}} <span class=dismissable-btn ng-click=ctrl.deleteTag(tag)> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-close></use> </svg> <span class=audible>Close</span> </span> </a> </div> <select id=tagSetting class=dropdown ng-model=ctrl.currentTag ng-options=\\\"tag.name for tag in ctrl.filterOptions track by tag.id\\\" xi-drop-down=ctrl.filterOptions> </select> <button class=btn-icon xi-tooltip=\\\"'Add tag'\\\" ng-click=ctrl.addTag()> <svg class=icon focusable=false> <use xlink:href=#icon-add></use> </svg> <span class=audible>Add</span> </button> </div>\";\n// Exports\nmodule.exports = code;","import { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IDesignerManifest } from \"ng2/common/model/project/mashup/designer-manifest.model\";\r\n\r\nexport class FilterToolbarComponent {\r\n\r\n\t// component bindings\r\n\tpublic filterTarget: IDesignerManifest[];\r\n\tpublic filterTypeOptions: IDataPair[];\r\n\tpublic sortPropertiesOptions: IDataPair[];\r\n\tpublic localPrefix: string;\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirFilterToolbarComponent\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tfilterTypeOptions: \"<\",\r\n\t\t\t\tsortPropertiesOptions: \"<\",\r\n\t\t\t\tfilterTarget: \"=\",\r\n\t\t\t\tlocalPrefix: \"@\"\r\n\t\t\t},\r\n\t\t\tcontroller: FilterToolbarComponent,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t\ttemplate: require(\"./filter-toolbar.html\"),\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=sort-container> <eir-filter-popupmenu-component filter-options=ctrl.filterTypeOptions filter-values=ctrl.filterTarget local-prefix=::ctrl.localPrefix> </eir-filter-popupmenu-component> <eir-sort-popupmenu-component sort-options=ctrl.sortPropertiesOptions sort-values=ctrl.filterTarget local-prefix=::ctrl.localPrefix> </eir-sort-popupmenu-component> <eir-filter-tag-component filter-values=ctrl.filterTarget> </eir-filter-tag-component> </div>\";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { FieldValidation } from \"../base/field-validation\";\r\nimport { ISharedStyling } from \"../base/shared-styling\";\r\n\r\nexport class InputFieldCtrl\r\n\textends FieldValidation\r\n\timplements ISharedStyling {\r\n\tpublic readonly: boolean = false;\r\n}\r\n\r\nexport class InputFieldComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tid: \"@?\",\r\n\t\t\tlabelName: \"@?\",\r\n\t\t\tfieldValue: \"=\",\r\n\t\t\tfieldName: \"@?\",\r\n\t\t\tvalidation: \"<?\",\r\n\t\t\trequired: \"@?\",\t// mark field as required\r\n\t\t\treadonly: \"<?\",\t// readonly field\r\n\r\n\t\t\tonComponentChange: \"&?\",\r\n\t\t\tparentAnnounce: \"<?\"\r\n\t\t};\r\n\r\n\t\tthis.controller = InputFieldCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./input-field-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirInputFieldComponent\", new InputFieldComponent());\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=component-base> <div ng-if=\\\"ctrl.validation !== undefined\\\"> <label for=input-field-component ng-class=\\\"{ required : ctrl.isRequired }\\\" ng-if=\\\"ctrl.labelName !== undefined\\\"> {{ ctrl.labelName }} </label> <input class=input-field-component type=text name={{ctrl.fieldName}} ng-model=ctrl.fieldValue ng-model-options=\\\"{ debounce: 100 }\\\" ng-change=ctrl.validate() ng-readonly=ctrl.readonly ng-blur=ctrl.validate() /> <div class=error-message> <div class=error-text ng-repeat=\\\"validatorError in ctrl.fieldSpecificErrors\\\" ng-show=\\\"ctrl.displayStatus === 'none' ? false : true\\\"> <svg class=\\\"icon-error icon\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-error></use> </svg> <pre class=audible>Error</pre> <p class=message-text>{{ validatorError.message }}</p> </div> </div> </div> <div ng-if=\\\"ctrl.validation === undefined\\\"> <label for=input-field-component>{{ ctrl.labelName }}</label> <input class=input-field-component type=text aria-required=true class=input-lg ng-model=ctrl.fieldValue ng-readonly=ctrl.readonly /> </div> </div> \";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { PaginatorCtrl } from \"./paginator-ctrl\";\r\n\r\nexport class PaginatorComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tpagingValues: \"<\",\r\n\t\t\tcurrentPage: \"=\",\r\n\t\t};\r\n\r\n\t\tthis.controller = PaginatorCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./paginator-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirPaginator\", new PaginatorComponent());\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { IPagerApi, IPageRequest, IPagerInfo } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nexport interface IPaginatorChangesObject<T> {\r\n\tpagingValues: ng.IChangesObject<T>;\r\n}\r\n\r\nexport class PaginatorCtrl<T> {\r\n\tpublic pagingValues: T[];\r\n\tprivate currentPage: T[];\r\n\tprivate pages: T[][];\r\n\tprivate pagerOptions: IPagerInfo;\r\n\tprivate pageNumber: number;\r\n\tprivate static pagesize = 16;\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery\r\n\t) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\t// tslint:disable-next-line:no-magic-numbers\r\n\t\tconst pagesizes = [16, 28, 48, 76];\r\n\t\tthis.createPages(PaginatorCtrl.pagesize);\r\n\r\n\t\tthis.pagerOptions = {\r\n\t\t\ttype: \"standalone\",\r\n\t\t\tpagesize: PaginatorCtrl.pagesize,\r\n\t\t\tpageSizeSelectorText: \"{0} Projects per page\",\r\n\t\t\tpagesizes: pagesizes,\r\n\t\t\tshowPageSizeSelector: true,\r\n\t\t\tshowFirstButton: true,\r\n\t\t\tenableFirstButton: false,\r\n\t\t\tshowPreviousButton: true,\r\n\t\t\tenablePreviousButton: false,\r\n\t\t\tshowNextButton: true,\r\n\t\t\tenableNextButton: true,\r\n\t\t\tshowLastButton: true,\r\n\t\t\tenableLastButton: true,\r\n\t\t\tonFirstPage: (_elem: any, _args: IPageRequest) => {\r\n\t\t\t\tthis.resetCurrentPage();\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t\tonPreviousPage: (_elem: any, _args: IPageRequest) => {\r\n\t\t\t\t--this.pageNumber;\r\n\t\t\t\tthis.previousPage(this.pageNumber);\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t\tonNextPage: (_elem: any, _args: IPageRequest) => {\r\n\t\t\t\t++this.pageNumber;\r\n\t\t\t\tthis.nextPage(this.pageNumber);\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t\tonLastPage: (_elem: any, _args: IPageRequest) => {\r\n\t\t\t\tthis.pageNumber = this.pages.length - 1;\r\n\t\t\t\tthis.currentPage = this.pages[this.pageNumber];\r\n\t\t\t\tthis.updateButtons(false, false, true, true);\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t\tonPageSizeChange: (_elem: any, args: IPageRequest) => {\r\n\t\t\t\tthis.createPages(args.pagesize);\r\n\t\t\t\tthis.resetCurrentPage();\r\n\t\t\t\tthis.$scope.$apply();\r\n\t\t\t},\r\n\t\t};\r\n\t\tthis.getPagerElement().pager(this.pagerOptions).data(\"pager\");\r\n\t\tthis.resetCurrentPage();\r\n\t}\r\n\r\n\tpublic $onChanges(value: IPaginatorChangesObject<T[]>): void {\r\n\t\tconst currentList = value.pagingValues.currentValue;\r\n\t\tconst previousList = value.pagingValues.previousValue;\r\n\t\tif (previousList.length && (currentList !== previousList)) {\r\n\t\t\tthis.pagingValues = value.pagingValues.currentValue;\r\n\t\t\tthis.createPages(PaginatorCtrl.pagesize);\r\n\t\t\tthis.resetCurrentPage();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic nextPage(page: number): void {\r\n\t\tthis.currentPage = this.pages[page];\r\n\t\tif (page === (this.pages.length - 1)) {\r\n\t\t\tthis.updateButtons(false, false, true, true);\r\n\t\t} else {\r\n\t\t\tthis.updateButtons(true, true, true, true);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic previousPage(page: number): void {\r\n\t\tthis.currentPage = this.pages[page];\r\n\t\tif (page === 0) {\r\n\t\t\tthis.updateButtons(true, true, false, false);\r\n\t\t} else {\r\n\t\t\tthis.updateButtons(true, true, true, true);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate createPages(pagesize: number): void {\r\n\t\tthis.pages = [];\r\n\t\tconst pagingTarget = angular.copy(this.pagingValues);\r\n\r\n\t\tfor (let pageIndex = 0; pagingTarget.length !== 0; pageIndex++) {\r\n\t\t\tconst page = pagingTarget.splice(0, pagesize);\r\n\t\t\tthis.pages.push(page);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getPagerElement(): any {\r\n\t\treturn this.$element.find(\".pager-container\");\r\n\t}\r\n\r\n\tprivate getPagerApi(): IPagerApi {\r\n\t\treturn this.getPagerElement().data(\"pager\");\r\n\t}\r\n\r\n\tprivate resetCurrentPage(): void {\r\n\t\tthis.pageNumber = 0;\r\n\t\tthis.currentPage = this.pages[this.pageNumber];\r\n\t\tif (this.pages.length > 1) {\r\n\t\t\tthis.updateButtons(true, true, false, false);\r\n\t\t} else {\r\n\t\t\tthis.updateButtons(false, false, false, false);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateButtons(last: boolean, next: boolean, first: boolean, previous: boolean): void {\r\n\t\tthis.getPagerApi().updated({\r\n\t\t\tenableLastButton: last,\r\n\t\t\tenableNextButton: next,\r\n\t\t\tenableFirstButton: first,\r\n\t\t\tenablePreviousButton: previous\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=pager-container></div>\";\n// Exports\nmodule.exports = code;","import { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\nimport * as xi from \"../../model/sohoxi/sohoxi-tooltip.model\";\r\n\r\nexport class ProjectTagsComponent {\r\n\tpublic tags: IJsonTag[];\r\n\tpublic tagsOverflowed = false;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.ELEMENT,\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $element: ng.IAugmentedJQuery\r\n\t) { }\r\n\r\n\tpublic checkOverflow(): void {\r\n\t\t//Timeout needed for getting the correct tag names instead of variable names.\r\n\t\tthis.$timeout(() => {\r\n\t\t\tconst tagContainerElement = this.$element.find(\".tag-container\")[0];\r\n\t\t\tconst overflowed = tagContainerElement.offsetHeight < tagContainerElement.scrollHeight;\r\n\t\t\tif (overflowed) {\r\n\t\t\t\tthis.tagsOverflowed = true;\r\n\t\t\t}\r\n\t\t}, 1);\r\n\t}\r\n\r\n\tpublic moreTagInit(): void {\r\n\t\tconst popoverOptions: xi.ITooltipOptions = {\r\n\t\t\tpopover: true,\r\n\t\t\tcontent: this.$element.find(\"#popover-contents\"),\r\n\t\t\tplacement: \"bottom\",\r\n\t\t\ttitle: \"Tags\",\r\n\t\t\textraClass: \"alternate\"\r\n\t\t};\r\n\r\n\t\tthis.$element.find(\"#popover-trigger\").popover(popoverOptions);\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirProjectTags\", {\r\n\t\t\tbindings: {\r\n\t\t\t\ttags: \"<\"\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./project-tags-component.html\"),\r\n\t\t\tcontroller: ProjectTagsComponent,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=tag-field> <div class=\\\"tag-container tag-list\\\"> <span class=tag ng-repeat=\\\"tag in ctrl.tags\\\" repeat-done=ctrl.checkOverflow()> {{tag.name}} </span> </div> <span class=\\\"more-tag tag is-clickable\\\" id=popover-trigger ng-init=ctrl.moreTagInit() ng-if=ctrl.tagsOverflowed>...</span> </div> <div id=popover-contents class=hidden> <div class=\\\"tag-list popover-tags\\\"> <span class=\\\"pop-tag hide-focus\\\" ng-repeat=\\\"tag in ctrl.tags\\\"> {{tag.name}} </span> </div> </div>\";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\nimport { SortPopupmenuCtrl } from \"./sort-popupmenu-ctrl\";\r\n\r\nexport class SortPopupmenuComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tsortOptions: \"<\",\r\n\t\t\tsortValues: \"=\",\r\n\t\t\tlocalPrefix: \"<\"\r\n\t\t};\r\n\r\n\t\tthis.controller = [\r\n\t\t\tAngularConstants.FILTER,\r\n\t\t\tSortPopupmenuCtrl\r\n\t\t];\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./sort-popupmenu-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirSortPopupmenuComponent\", new SortPopupmenuComponent());\r\n\t}\r\n}\r\n","import { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nenum OrderEnum {\r\n\tASCENDING = \"\",\r\n\tDESCENDING = \"-\"\r\n}\r\n\r\nexport class SortPopupmenuCtrl {\r\n\r\n\t// component bindings\r\n\tpublic sortOptions: IDataPair[];\r\n\tpublic bindingSortValues: any[];\r\n\tpublic localPrefix: string;\r\n\r\n\tpublic get sortValues(): any[] {\r\n\t\treturn this.bindingSortValues;\r\n\t}\r\n\tpublic set sortValues(value: any[]) {\r\n\t\tthis.bindingSortValues = value;\r\n\t\tif (value && this.currentSelected && this.currentSelectedSortOrder) {\r\n\t\t\tthis.doSort();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic sortOrderTypes: IDataPair[] = [\r\n\t\t{ name: \"Ascending\", value: 0 },\r\n\t\t{ name: \"Descending\", value: 1 }\r\n\t];\r\n\r\n\tpublic currentSelected: IDataPair;\r\n\tpublic currentSelectedSortOrder: IDataPair;\r\n\r\n\tprivate readonly sortOn = \"sort-on\";\r\n\tprivate readonly sortOrder = \"sort-order\";\r\n\r\n\t$inject = [\r\n\t\tAngularConstants.FILTER\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $filter: ng.IFilterService\r\n\t) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\tconst sortOn = JSON.parse(localStorage.getItem(this.localPrefix + this.sortOn));\r\n\t\tconst sortOrder = JSON.parse(localStorage.getItem(this.localPrefix + this.sortOrder));\r\n\r\n\t\tif (!sortOn || !sortOrder) {\r\n\t\t\tconst sortOption = this.sortOptions[0];\r\n\t\t\tconst sortOrder = this.sortOrderTypes[1];\r\n\r\n\t\t\tlocalStorage.setItem(this.localPrefix + this.sortOn, JSON.stringify(sortOption));\r\n\t\t\tlocalStorage.setItem(this.localPrefix + this.sortOrder, JSON.stringify(sortOrder));\r\n\t\t\tthis.currentSelected = sortOption;\r\n\t\t\tthis.currentSelectedSortOrder = sortOrder;\r\n\t\t} else {\r\n\t\t\tthis.currentSelected = sortOn;\r\n\t\t\tthis.currentSelectedSortOrder = sortOrder;\r\n\t\t}\r\n\t\tthis.doSort();\r\n\t}\r\n\r\n\tpublic onSort(sortOption: IDataPair): void {\r\n\t\tthis.currentSelected = sortOption;\r\n\t\tlocalStorage.setItem(this.localPrefix + this.sortOn, JSON.stringify(sortOption));\r\n\r\n\t\tthis.doSort();\r\n\t}\r\n\r\n\tpublic onSortOrder(sortOrder: IDataPair): void {\r\n\t\tthis.currentSelectedSortOrder = sortOrder;\r\n\t\tlocalStorage.setItem(this.localPrefix + this.sortOrder, JSON.stringify(sortOrder));\r\n\r\n\t\tthis.doSort();\r\n\t}\r\n\r\n\tprivate doSort(): void {\r\n\t\tconst orderBy = this.currentSelectedSortOrder.value ?\r\n\t\t\tOrderEnum.DESCENDING : OrderEnum.ASCENDING;\r\n\r\n\t\tthis.bindingSortValues = this.$filter(\"orderBy\")(\r\n\t\t\tthis.bindingSortValues, `${orderBy}(${this.currentSelected.value})`);\r\n\t}\r\n\r\n}\r\n","// Module\nvar code = \"<button type=button id=buttonSort class=btn-menu xi-popupmenu> <span>By {{ ctrl.currentSelected.name }}</span> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-dropdown></use> </svg> </button> <ul class=popupmenu> <li ng-repeat=\\\"sortOption in ctrl.sortOptions track by sortOption.name\\\" ng-click=ctrl.onSort(sortOption)> <a>{{sortOption.name}}</a> </li> </ul> <button type=button id=buttonSortOrder class=btn-menu xi-popupmenu> <span>In {{ctrl.currentSelectedSortOrder.name }} Order</span> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-dropdown></use> </svg> </button> <ul class=popupmenu> <li ng-repeat=\\\"sortOrder in ctrl.sortOrderTypes track by sortOrder.name\\\" ng-click=ctrl.onSortOrder(sortOrder)> <a>{{ sortOrder.name }}</a> </li> </ul> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../angular-constants\";\r\n\r\nimport { INewProject, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { InforOwnedEnum } from \"ng2/common/enums/infor-owned.enum\";\r\nimport { IJsonManifest, IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { KeyCodeEnum } from \"../../defines\";\r\nimport { Helper } from \"../../helper\";\r\nimport { ISearchFieldOptions } from \"../../model/sohoxi/sohoxi-searchfield.model\";\r\nimport { TagService } from \"../../services/tag-service\";\r\n\r\nexport interface IProjectChangeObject {\r\n\tproject: angular.IChangesObject<IJsonManifest | IJsonRuntimeManifest>;\r\n}\r\n\r\nexport class TagDropdownComponent {\r\n\r\n\tpublic availableTags: IJsonTag[] = [];\r\n\tpublic availableTagNames: string[] = [];\r\n\tpublic currentTag: string;\r\n\tpublic errorMessage: string;\r\n\tpublic onSaveTags: Function;\r\n\tpublic project: IJsonManifest | IJsonRuntimeManifest | INewProject;\r\n\tpublic selectedTags: IJsonTag[] = [];\r\n\r\n\tpublic KeyCodeEnum = KeyCodeEnum;\r\n\tpublic searchFieldOptions: ISearchFieldOptions;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.TAG_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate tagService: TagService\r\n\t) {\r\n\t\tthis.initAvailableTags();\r\n\t\tthis.initSearchFieldEvent();\r\n\t}\r\n\r\n\tpublic $onChanges(changeObject: IProjectChangeObject): void {\r\n\t\tconst project = changeObject.project;\r\n\t\tif (project && !project.isFirstChange() &&\r\n\t\t\tproject.currentValue.id !== project.previousValue.id) {\r\n\t\t\tthis.currentTag = undefined;\r\n\t\t\tthis.errorMessage = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic addTag(): void {\r\n\t\tconst currentTag = this.currentTag;\r\n\t\tif (!Helper.isUndefinedEmpty(currentTag) &&\r\n\t\t\tthis.isValid() && currentTag\r\n\t\t) {\r\n\t\t\tlet tag: IJsonTag = this.getAvailableTag(currentTag);\r\n\t\t\tif (!tag) {\r\n\t\t\t\ttag = this.getNewTag();\r\n\t\t\t}\r\n\t\t\tthis.selectedTags.push(tag);\r\n\t\t\tthis.save();\r\n\r\n\t\t\tthis.currentTag = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic deleteTag(tag: IJsonTag): void {\r\n\t\tconst selectedTags = angular.copy(this.selectedTags);\r\n\t\tthis.selectedTags = selectedTags.filter((selectedTag) => {\r\n\t\t\treturn tag.name !== selectedTag.name;\r\n\t\t});\r\n\t\tthis.save();\r\n\t}\r\n\r\n\tpublic isValid(): boolean {\r\n\t\tconst isValid = true;\r\n\t\tconst currentTag = this.currentTag;\r\n\r\n\t\t/* For some reason when adding tags in create project view it will trigger addTag() twice\r\n\t\t\twhen pressing enter, one time from keypress enter and one time from button click.\r\n\t\t\tThis extra check on if tag is valid is to prevent the second call on addTag is evaluated. */\r\n\t\tif (Helper.isUndefinedEmpty(currentTag)) {\r\n\t\t\tthis.errorMessage = undefined;\r\n\t\t\treturn isValid;\r\n\t\t}\r\n\r\n\t\tconst alreadyExists = this.selectedTags.some((tag) => {\r\n\t\t\treturn tag.name === currentTag;\r\n\t\t});\r\n\r\n\t\tif (alreadyExists) {\r\n\t\t\tthis.errorMessage = \"Tag already added\";\r\n\t\t\treturn !isValid;\r\n\t\t}\r\n\r\n\t\tconst isValidTag = /^[a-zA-Z0-9\\s]{1,256}$/.test(currentTag);\r\n\t\tif (!isValidTag) {\r\n\t\t\tthis.errorMessage = \"Tag is not valid\";\r\n\t\t\treturn !isValid;\r\n\t\t}\r\n\r\n\t\tthis.errorMessage = undefined;\r\n\t\treturn isValid;\r\n\t}\r\n\r\n\tpublic onKeyPressed($event: JQueryKeyEventObject): void {\r\n\t\tif ($event.which === KeyCodeEnum.ENTER) {\r\n\t\t\tthis.addTag();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getNewTag(): IJsonTag {\r\n\t\treturn {\r\n\t\t\tid: Helper.generateUniqueId(),\r\n\t\t\tname: this.currentTag,\r\n\t\t\tinforOwned: InforOwnedEnum.FALSE\r\n\t\t};\r\n\t}\r\n\r\n\tprivate getAvailableTag(tagName: string): IJsonTag {\r\n\t\treturn this.availableTags.find((availableTag) => {\r\n\t\t\treturn availableTag.name === tagName;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate save(): void {\r\n\t\tif ((this.project as INewProject).tags) {//new project\r\n\t\t\t(this.project as INewProject).tags = this.selectedTags;\r\n\t\t} else {\r\n\t\t\tthis.onSaveTags({ $tags: this.selectedTags });\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initAvailableTags(): void {\r\n\t\tthis.tagService.getAvailableTags().then((tags) => {\r\n\t\t\tthis.availableTags = tags;\r\n\t\t\tthis.availableTagNames = Helper.getListNames(tags);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initSearchFieldEvent(): void {\r\n\t\tthis.$element.on(\r\n\t\t\t\"selected\",\r\n\t\t\t(event: JQueryEventObject, selectedItem: ng.IAugmentedJQuery\r\n\t\t\t) => {\r\n\t\t\t\tthis.currentTag = selectedItem.text().trim();\r\n\t\t\t\tthis.isValid();\r\n\t\t\t\tthis.$scope.$applyAsync();\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.component(\"eirTagDropdown\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tonSaveTags: \"&\",\r\n\t\t\t\tproject: \"<\",\r\n\t\t\t\tselectedTags: \"=\"\r\n\t\t\t},\r\n\t\t\ttemplate: require(\"./tag-dropdown-component.html\"),\r\n\t\t\tcontroller: TagDropdownComponent as any,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=with-button> <label for=tagSetting>Tags</label> <div class=tag-container> <a class=\\\"tag is-dismissable\\\" ng-repeat=\\\"tag in ctrl.selectedTags track by tag.id\\\">{{tag.name}} <span class=dismissable-btn ng-click=ctrl.deleteTag(tag)> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-close></use> </svg> <span class=audible>Close</span> </span> </a> </div> <input class=searchfield xi-searchfield=\\\"{'source': ctrl.availableTagNames}\\\" ng-model=ctrl.currentTag ng-model-options=\\\"{ debounce: 500 }\\\" ng-change=ctrl.isValid() ng-keypress=ctrl.onKeyPressed($event) id=tag-searchfield name=searchfield placeholder=\\\"Add tag\\\" maxlength=25 /> <button class=btn-icon xi-tooltip=\\\"'Add tag'\\\" ng-click=ctrl.addTag()> <svg class=icon focusable=false> <use xlink:href=#icon-add></use> </svg> <span class=audible>Add</span> </button> </div> <div ng-show=\\\"ctrl.errorMessage !== undefined\\\" class=\\\"error-icon error-message\\\"> <svg class=\\\"icon icon-error\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-error></use> </svg> <pre class=audible>Error</pre> <p class=message-text>{{ ctrl.errorMessage }}</p> </div> \";\n// Exports\nmodule.exports = code;","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { TextareaFieldCtrl } from \"./textarea-field-ctrl\";\r\n\r\nexport class TextareaFieldComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {\r\n\t\t\tlabelName: \"@?\",\r\n\t\t\tfieldValue: \"=\",\r\n\t\t\tvalidation: \"<?\",\r\n\t\t\treadonly: \"<?\",\t// readonly field\r\n\t\t};\r\n\r\n\t\tthis.controller = TextareaFieldCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./textarea-field-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirTextareaFieldComponent\", new TextareaFieldComponent());\r\n\t}\r\n}\r\n","import { FieldValidation } from \"../base/field-validation\";\r\nimport { ISharedStyling } from \"../base/shared-styling\";\r\n\r\nimport * as xi from \"../../model/sohoxi/sohoxi-textarea.model\";\r\n\r\nexport class TextareaFieldCtrl\r\n\textends FieldValidation\r\n\timplements ISharedStyling {\r\n\tpublic readonly: boolean = false;\r\n\r\n\tpublic textareaOptions: xi.ITextAreaOptions;\r\n\r\n\tpublic $onInit(): void {\r\n\t\tsuper.$onInit();\r\n\r\n\t\tthis.textareaOptions = {\r\n\t\t\tautoGrow: true,\r\n\t\t\tautoGrowAnimate: true\r\n\t\t};\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=component-base> <div ng-if=\\\"ctrl.validation !== undefined\\\"> <label for=textareaField ng-if=\\\"ctrl.labelName !== undefined\\\"> {{ ctrl.labelName }} </label> <textarea class=\\\"textarea resizable\\\" id=textareaField name=textareaField xi-textarea=ctrl.textareaOptions ng-model=ctrl.fieldValue ng-model-options=\\\"{ debounce: 100 }\\\" ng-blur=ctrl.validate() ng-change=ctrl.validate() ng-readonly=ctrl.readonly></textarea> <div ng-repeat=\\\"validatorError in ctrl.fieldSpecificErrors\\\" ng-style=\\\"{ 'display': ctrl.displayStatus }\\\" class=error-message> <svg class=\\\"icon-error icon\\\" focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-error></use> </svg> <pre class=audible>Error</pre> <p class=message-text>{{ validatorError.message }}</p> </div> </div> <div ng-if=\\\"ctrl.validation === undefined\\\"> <label for=textareaField ng-if=\\\"ctrl.labelName !== undefined\\\"> {{ ctrl.labelName }} </label> <textarea class=resizable id=textareaField name=textareaField xi-textareaname=textareaField ng-model=ctrl.fieldValue ng-readonly=ctrl.readonly></textarea> </div> </div>\";\n// Exports\nmodule.exports = code;","import { IAboutOptions } from \"../../model/sohoxi/sohoxi-about.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * About Directive.\r\n *\r\n * Shows a modal dialog which contains information typical for about dialogs\r\n *\r\n * Example:\r\n * scope[\"options\"]: IXiAboutOptions = {\r\n * \tappName: \"SoHo Xi Test\",\r\n * \tproductName: \"Test page for directives\", version: \"0.0.7\",\r\n * \tuseDefaultCopyright: true,\r\n * \tcontent: \"<div><p>Additional content goes here</p></div>\"\r\n * }\r\n *\r\n * <button class=\"btn about\" id=\"about-dialog\" xi-about=\"options\">Open about modal</button>\r\n */\r\nexport class AboutDirective implements ng.IDirective {\r\n\trestrict = \"A\";\r\n\tscope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiAbout\";\r\n\r\n\tlink(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[AboutDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IAboutOptions) => {\r\n\t\t\t\tconst aboutComponent = Utils.getData(element, \"about\");\r\n\t\t\t\tif (aboutComponent) {\r\n\t\t\t\t\taboutComponent.destroy();\r\n\t\t\t\t\taboutComponent.modal.remove();\r\n\t\t\t\t}\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.about(newOptions);\r\n\t\t\t\t\t// Replace the option specified additional content with a compiled angular version\r\n\t\t\t\t\t// if (newOptions.content) {\r\n\t\t\t\t\t// \tconst content: any = this.$compile(newOptions.content)(scope);\r\n\t\t\t\t\t// \tUtils.getData(element, \"about\").modal.one(\"open\", () => {\r\n\t\t\t\t\t// \t\t$(\"body\")\r\n\t\t\t\t\t// \t\t\t.find(\"#about-modal\" + id)\r\n\t\t\t\t\t// \t\t\t.find(\".additional-content\")\r\n\t\t\t\t\t// \t\t\t.html(content);\r\n\t\t\t\t\t// \t\t$(\"body\")\r\n\t\t\t\t\t// \t\t\t.find(\"#about-modal\" + id)\r\n\t\t\t\t\t// \t\t\t.find(\".modal-body\")\r\n\t\t\t\t\t// \t\t\t.css({\r\n\t\t\t\t\t// \t\t\t\t\"max-height\": \"350px\",\r\n\t\t\t\t\t// \t\t\t\t\"overflow-y\": \"auto\",\r\n\t\t\t\t\t// \t\t\t});\r\n\t\t\t\t\t// \t});\r\n\t\t\t\t\t// }\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.about();\r\n\t\t\t\t}\r\n\t\t\t\t// Support more than one about modal on the same page\r\n\t\t\t\t// Utils.getData(element, \"about\").modal.attr(\"id\", \"about-modal\" + id);\r\n\t\t\t\t// element.attr(\"data-modal\", \"about-modal\" + id);\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst modalData = Utils.getData(element, \"about\");\r\n\t\t\tif (modalData) {\r\n\t\t\t\tmodalData.destroy();\r\n\r\n\t\t\t\tconst aboutSelector = \"#about-modal\";\r\n\t\t\t\tdo {\r\n\t\t\t\t\t$(aboutSelector).remove();\r\n\t\t\t\t} while ($(aboutSelector).length > 0);\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(AboutDirective.DIRECTIVE_NAME, () => new AboutDirective());\r\n\t}\r\n}\r\n","/**\r\n * Application Menu Directive.\r\n *\r\n * Example:\r\n * <nav xi-app-menu class=\"application-menu\"</nav>\r\n */\r\nexport class ApplicationMenuDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(scope: ng.IScope, element: ng.IAugmentedJQuery): void {\r\n\t\telement.applicationMenu();\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"xiAppMenu\", () => {\r\n\t\t\treturn new ApplicationMenuDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IArrangeEvent } from \"common/model/sohoxi/sohoxi.model\";\r\n\r\nexport class ArrangeDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiArrange\";\r\n\trestrict = \"A\";\r\n\tscope = false;\r\n\r\n\tlink(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes,\r\n\t): void {\r\n\r\n\t\tif (element.length > 0) {\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\t//DOM has finished rendering\r\n\t\t\t\tconst arrangeElement = element as any;\r\n\t\t\t\tarrangeElement.arrange().off(\"arrangeupdate\");\r\n\t\t\t\tarrangeElement.arrange().on(\"arrangeupdate\", (e: any, event: IArrangeEvent) => {\r\n\t\t\t\t\tconst controllScope = scope as any;\r\n\t\t\t\t\tcontrollScope[attributes.xiArrange].onArrange(event);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\t\t\tfunction () { return element[0].childNodes.length; },\r\n\t\t\t\t\tfunction (newValue, oldValue) {\r\n\t\t\t\t\t\tif (newValue !== oldValue) {\r\n\t\t\t\t\t\t\t// DOM changes\r\n\t\t\t\t\t\t\tarrangeElement.arrange();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\t// Tear down\r\n\t\t\t\tarrangeElement.on(\"$destroy\", () => {\r\n\t\t\t\t\tunbindWatcher();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tconstructor(private $timeout: ng.ITimeoutService) {\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(ArrangeDirective.DIRECTIVE_NAME, ($timeout: ng.ITimeoutService) => {\r\n\t\t\treturn new ArrangeDirective($timeout);\r\n\t\t});\r\n\t}\r\n}\r\n","import { IAutoCompleteOptions } from \"../../model/sohoxi/sohoxi-autocomplete.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * Autocomplete Directive.\r\n *\r\n * Suggests values in given data (source) that matches the input.\r\n * Instead of providing av options object, the following attributes can be used as an alternative:\r\n * data-autocomplete (string url value only, instead of options.source)\r\n * data-tmpl (instead of options.template)\r\n *\r\n * Example:\r\n * scope[\"options\"]: IXiAutoCompleteOptions = {\r\n * \tsource: [\"Alpha\", \"Bravo\"],\r\n * \ttemplate: \"#template\", filterMode: \"contains\"\r\n * }\r\n * <input xi-autocomplete=\"options\" />\r\n */\r\nexport class AutocompleteDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiAutocomplete\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[AutocompleteDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watchCollection(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IAutoCompleteOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t// Set the data-autocomplete attribute to source (external in options object)\r\n\t\t\t\t\telement.attr(\"data-autocomplete\", \"source\");\r\n\t\t\t\t\telement.autocomplete(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.autocomplete();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst autoCompleteData = Utils.getData(element, \"autocomplete\");\r\n\t\t\tif (autoCompleteData) {\r\n\t\t\t\tautoCompleteData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(AutocompleteDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new AutocompleteDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IBusyOptions } from \"../../model/sohoxi/sohoxi-busy.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * Busy Directive.\r\n *\r\n * Shows a busy indicator, covering the area spanned by the element\r\n *\r\n * Example:\r\n * scope[\"isAppBusy\"]: boolean = true\r\n * <div xi-busy=\"isAppBusy\">\r\n * \tThis area is busy until variable isAppBusy is set to false. Indicator shown after 3000 ms when triggered\r\n * </div>\r\n *\r\n * Default delay until the loading indicator shows up, after triggered, is 3000 ms.\r\n * To set another delay, use the attribute busy-delay\r\n *\r\n * Example:\r\n * scope[\"isAnotherAppBusy\"]: boolean = true\r\n * <div xi-busy=\"isAnotherAppBusy\" busy-delay=\"0\">\r\n * \tThis area is busy until variable isAnotherAppBusy is set to false. Indicator shown immediately when triggered\r\n * </div>\r\n *\r\n */\r\nexport class BusyDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiBusy\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\telement.addClass(\"busy\");\r\n\t\tconst options: IBusyOptions = {};\r\n\t\tconst delay = attributes.busyDelay;\r\n\t\tconst transparentOverlay = attributes.transparentOverlay;\r\n\r\n\t\tif ($.isNumeric(delay)) {\r\n\t\t\toptions.displayDelay = parseInt(delay);\r\n\t\t}\r\n\t\tif (transparentOverlay === \"true\") { // default is false\r\n\t\t\toptions.transparentOverlay = true;\r\n\t\t}\r\n\r\n\t\telement.busyindicator(options);\r\n\r\n\t\tconst expression = attributes[BusyDirective.DIRECTIVE_NAME];\r\n\t\tlet isRunning = false;\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\texpression,\r\n\t\t\t(newValue: boolean, _) => {\r\n\t\t\t\tif (newValue && !isRunning) {\r\n\t\t\t\t\tisRunning = true;\r\n\t\t\t\t\telement.trigger(\"start.busyindicator\");\r\n\t\t\t\t} else if (!newValue && isRunning) {\r\n\t\t\t\t\tisRunning = false;\r\n\t\t\t\t\telement.trigger(\"complete.busyindicator\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst busyData = Utils.getData(element, \"busyindicator\");\r\n\t\t\tif (busyData) {\r\n\t\t\t\tbusyData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(BusyDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new BusyDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Button Directive.\r\n *\r\n * Example:\r\n * <button xi-button class=\"btn-primary\" type=\"button\">Action</button>\r\n */\r\nexport class ButtonDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(scope: ng.IScope, element: ng.IAugmentedJQuery): void {\r\n\t\telement.button();\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\"xiButton\", () => {\r\n\t\t\treturn new ButtonDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IColorPickerApi, IColorPickerOptions } from \"../../model/sohoxi/sohoxi-colorpicker.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Colorpicker Directive.\r\n *\r\n * Provides a color picker consisting of colors specified by the IColorpickerOptions option,\r\n * or default colors if not specified. Use the value attribute to set a default color.\r\n *\r\n * Example:\r\n * scope[\"options\"] = {\r\n * \tcolors: [\r\n * \t\t{label: \"white\", value: \"ffffff\" },\r\n * \t\t{label: \"black\", value: \"000000\"}\r\n * \t]\r\n * }\r\n * <input value=\"#ffffff\" xi-colorpicker=\"colors\" />\r\n */\r\nexport class ColorPickerDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic require = \"?ngModel\";\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiColorPicker\";\r\n\r\n\tconstructor(private $parse: ng.IParseService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes,\r\n\t\tngModel: ng.INgModelController\r\n\t): void {\r\n\t\t// Save selected/default color then trigger change so control updates\r\n\t\tlet selectedColor = element.val() as string;\r\n\t\tconst options = attributes[ColorPickerDirective.DIRECTIVE_NAME];\r\n\t\tlet api: IColorPickerApi;\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IColorPickerOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.colorpicker(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.colorpicker();\r\n\t\t\t\t}\r\n\t\t\t\tapi = Utils.getData(element, \"colorpicker\");\r\n\t\t\t\tif (ngModel) {\r\n\t\t\t\t\t// Watch ng-model and update element value on change\r\n\t\t\t\t\tscope.$watch(attributes.ngModel, (color: string) => {\r\n\t\t\t\t\t\tif (color && color.length > 0 && color !== selectedColor) {\r\n\t\t\t\t\t\t\telement.val(color);\r\n\t\t\t\t\t\t\tif (api) {\r\n\t\t\t\t\t\t\t\tapi.setColor(color);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tselectedColor = color;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\telement.on(\"selected.colorpicker\", (e, item) => {\r\n\t\t\t\t\t\tscope.$apply(() => {\r\n\t\t\t\t\t\t\tthis.$parse(attributes.ngModel).assign(\r\n\t\t\t\t\t\t\t\tscope,\r\n\t\t\t\t\t\t\t\t\"#\" + item.data(\"value\")\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tif (api) {\r\n\t\t\t\telement.off(\"change\");\r\n\t\t\t\telement.off(\"selected.colorpicker\");\r\n\t\t\t\tapi.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ColorPickerDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$parse\",\r\n\t\t\tparse => {\r\n\t\t\t\treturn new ColorPickerDirective(parse);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","/**\r\n * Standard Control Directive.\r\n *\r\n * Used to call a standard initialize method for the specified SohoXi Control.\r\n * Does not support initialization with control options\r\n */\r\n\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class ControlDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiControl\";\r\n\r\n\tstatic $inject = [\"$log\"];\r\n\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tconstructor(\r\n\t\tprivate log: ng.ILogService,\r\n\t\tprivate timeout: ng.ITimeoutService\r\n\t) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst functionName = attributes[ControlDirective.DIRECTIVE_NAME];\r\n\t\tif (!functionName) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\tthis.timeout(() => {\r\n\t\t\t\tconst data = Utils.getData(element, functionName);\r\n\t\t\t\tif (!data) {\r\n\t\t\t\t\tswitch (functionName) {\r\n\t\t\t\t\t\tcase \"expandablearea\":\r\n\t\t\t\t\t\t\telement.expandablearea();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"toolbar\":\r\n\t\t\t\t\t\t\telement.toolbar();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"accordion\":\r\n\t\t\t\t\t\t\telement.accordion();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"wizard\":\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\telement.wizard();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, 1);\r\n\t\t} catch (ex) {\r\n\t\t\tthis.log.error(name + \" Failed to call \" + functionName, ex);\r\n\t\t}\r\n\t\tscope.$on(\"$destroy\", () => {\r\n\t\t\tconst data = Utils.getData(element, functionName);\r\n\t\t\tif (data) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata.destroy();\r\n\t\t\t\t} catch (exc) {\r\n\t\t\t\t\tthis.log.error(name + \" Failed to destroy \" + functionName, exc);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ControlDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$log\",\r\n\t\t\t\"$timeout\",\r\n\t\t\t(log, timeout) => {\r\n\t\t\t\treturn new ControlDirective(log, timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import cloneDeep from \"lodash-es/cloneDeep\";\r\nimport isEqual from \"lodash-es/isEqual\";\r\n\r\nimport { IComponentRendered } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IDataGridOptions } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { DatagridHelper } from \"../../sohoxi/datagrid-helper\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport const DATAGRID_RENDERED = \"finishedDatagridCreation\";\r\n/**\r\n * Data Grid Directive\r\n *\r\n * Example:\r\n *\r\n * scope[\"options\"] = {\r\n * \tdataset: [\r\n * \t\t{ name: \"Name #1\", age: 12, phone: \"12345\" },\r\n * \t\t{ name: \"Name #2\", age: 22, phone: \"1234567\" },\r\n * \t\t{ name: \"Name #3\", age: 32, phone: \"1234589\" }\r\n * \t]\r\n * }\r\n *\r\n * <div xi-datagrid=\"ctrl.options\"></div>\r\n */\r\nexport class DatagridDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiDatagrid\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options: IDataGridOptions<any> =\r\n\t\t\tscope.$eval(attributes[DatagridDirective.DIRECTIVE_NAME]);\r\n\r\n\t\tif (options.dataset) {\r\n\t\t\tif (!options.columns) {\r\n\t\t\t\t// Generate \"simple\" default columns based on dataset properties, if no columns provided\r\n\t\t\t\tconst columns = [];\r\n\t\t\t\t// ReSharper disable once MissingHasOwnPropertyInForeach\r\n\t\t\t\tfor (const propertyName in options.dataset[0]) {\r\n\t\t\t\t\tconst columnName =\r\n\t\t\t\t\t\tpropertyName[0].toUpperCase() + propertyName.substring(1);\r\n\t\t\t\t\tconst column = {\r\n\t\t\t\t\t\tid: propertyName,\r\n\t\t\t\t\t\tname: columnName,\r\n\t\t\t\t\t\tfield: propertyName,\r\n\t\t\t\t\t\twidth: 150\r\n\t\t\t\t\t};\r\n\t\t\t\t\tcolumns.push(column);\r\n\t\t\t\t}\r\n\t\t\t\toptions.columns = columns;\r\n\t\t\t}\r\n\r\n\t\t\telement.datagrid(options);\r\n\r\n\t\t\tconst api = Utils.getData(element, \"datagrid\");\r\n\r\n\t\t\tif (options.id !== undefined) {\r\n\t\t\t\tconst finishedResult: IComponentRendered = {\r\n\t\t\t\t\tid: options.id,\r\n\t\t\t\t\tapi\r\n\t\t\t\t};\r\n\t\t\t\telement.trigger(DATAGRID_RENDERED, finishedResult);\r\n\t\t\t}\r\n\r\n\t\t\tconst isDatasetEqual = (a: any, b: any): boolean => {\r\n\t\t\t\t// temp fix on equality check\r\n\t\t\t\tconst newDataset = cloneDeep(a);\r\n\t\t\t\tconst oldDataset = cloneDeep(b);\r\n\t\t\t\tnewDataset.forEach(DatagridHelper.clearSohoProperties);\r\n\t\t\t\toldDataset.forEach(DatagridHelper.clearSohoProperties);\r\n\r\n\t\t\t\treturn isEqual(newDataset, oldDataset);\r\n\t\t\t};\r\n\r\n\t\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\t\tattributes[DatagridDirective.DIRECTIVE_NAME],\r\n\t\t\t\t(\r\n\t\t\t\t\tnewOptions: IDataGridOptions<any>,\r\n\t\t\t\t\toldOptions: IDataGridOptions<any>\r\n\t\t\t\t) => {\r\n\t\t\t\t\tif (!isDatasetEqual(newOptions.dataset, oldOptions.dataset)) {\r\n\t\t\t\t\t\tapi.loadData(newOptions.dataset, {\r\n\t\t\t\t\t\t\tpreserveSelected: true // kept so selected is not fired\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (newOptions.updateDatagrid) {\r\n\t\t\t\t\t\tdelete newOptions.updateDatagrid;\r\n\t\t\t\t\t\tapi.updated(newOptions);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\ttrue\r\n\t\t\t);\r\n\r\n\t\t\t// Tear down\r\n\t\t\telement.on(\"$destroy\", () => {\r\n\t\t\t\tunbindWatcher();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(DatagridDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new DatagridDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { DateFormatEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { DatasourceTypeEnum } from \"ng2/common/enums/datasource-type.enum\";\r\nimport { ParameterTypeEnum } from \"ng2/common/enums/parameter-type.enum\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonDatasource, IJsonM3Datasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IParameterObject } from \"ng2/common/model/dataservice/parameter-object.model\";\r\nimport { IDataGridColumn, IFormatterFunction } from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\nimport { Helper } from \"../helper\";\r\n\r\nexport class CustomFormatters {\r\n\tstatic DataSourceDescription(): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: IJsonDatasource, datagrid: any) => {\r\n\t\t\tif (item.typedef === DatasourceTypeEnum.M3) {\r\n\t\t\t\tconst m3Datasource = item as IJsonM3Datasource;\r\n\t\t\t\tif (m3Datasource.operations[0]) {\r\n\t\t\t\t\tconst descriptionValue = m3Datasource.operations[0].dataParameters;\r\n\t\t\t\t\tvalue = (descriptionValue[\"MI.Program\"] + \".\" + descriptionValue[\"MI.Transaction\"]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue = \"\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic DataSourceParameterType(): IFormatterFunction {\r\n\t\treturn (\r\n\t\t\trow: number,\r\n\t\t\tcell: number,\r\n\t\t\tvalue: string,\r\n\t\t\tcol: IDataGridColumn,\r\n\t\t\titem: IParameterObject,\r\n\t\t\tdatagrid: any\r\n\t\t): string => {\r\n\t\t\tswitch (item.parameterType) {\r\n\t\t\t\tcase ParameterTypeEnum.BODY_PART:\r\n\t\t\t\t\treturn \"Body(jsonpath)\";\r\n\t\t\t\tcase ParameterTypeEnum.MATRIX:\r\n\t\t\t\t\treturn \"Matrix\";\r\n\t\t\t\tcase ParameterTypeEnum.PATH:\r\n\t\t\t\t\treturn \"Path\";\r\n\t\t\t\tcase ParameterTypeEnum.QUERY:\r\n\t\t\t\t\treturn \"Query\";\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn \"Output\";\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tstatic Multi(...formatters: IFormatterFunction[]): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any) => {\r\n\t\t\tconst result = formatters.reduce((value, formatter) => {\r\n\t\t\t\treturn formatter(row, cell, value, col, item, datagrid);\r\n\t\t\t}, value);\r\n\t\t\treturn result;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic DataPairPresenter(dataPairList: IDataPair[]): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any) => {\r\n\t\t\tconst foundItem = dataPairList.find((datapair: IDataPair) => {\r\n\t\t\t\treturn value === datapair.value;\r\n\t\t\t});\r\n\t\t\treturn foundItem ? foundItem.name : \"\";\r\n\t\t};\r\n\t}\r\n\r\n\tstatic DatasourceSuiteFormatter(): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: IJsonDatasource, datagrid: any) => {\r\n\t\t\treturn value.replace(\"/\", \"\");\r\n\t\t};\r\n\t}\r\n\r\n\tstatic RequiredFormatter(propertyName: string, checkValue: boolean = false): IFormatterFunction {\r\n\t\treturn (row, cell, value, col, item) => {\r\n\t\t\tconst empty = \"\";\r\n\t\t\tconst checked = `\r\n\t\t\t\t<svg class=\"icon\">\r\n\t\t\t\t\t<use xlink:href=\"#icon-check\"></use>\r\n\t\t\t\t</svg>\r\n\t\t\t`;\r\n\t\t\tif ((checkValue && value >= 1) || !checkValue) {\r\n\t\t\t\treturn item.hasOwnProperty(propertyName) && item[propertyName] ? checked : empty;\r\n\t\t\t}\r\n\t\t\treturn empty;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic Date(locale: string): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any): string => {\r\n\t\t\treturn CustomFormatters.Datetime(locale, DateFormatEnum.Short)(row, cell, value, col, item, datagrid);\r\n\t\t};\r\n\t}\r\n\r\n\tstatic Time(locale: string): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any): string => {\r\n\t\t\treturn CustomFormatters.Datetime(locale, DateFormatEnum.Timestamp)(row, cell, value, col, item, datagrid);\r\n\t\t};\r\n\t}\r\n\r\n\tstatic Datetime(locale: string, date: string = DateFormatEnum.Datetime): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any): string => {\r\n\t\t\tif (Helper.isUndefinedEmpty(value)) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t\tconst options: IFormateDateOptions = {\r\n\t\t\t\tdate,\r\n\t\t\t\tlocale\r\n\t\t\t};\r\n\t\t\tconst trimedValue = value.trim();\r\n\t\t\tconst datetime = DateHelper.parse(trimedValue, date, locale);\r\n\t\t\tconst result = Soho.Locale.formatDate(\r\n\t\t\t\tdatetime.toString() !== \"Invalid Date\" ? datetime : trimedValue,\r\n\t\t\t\toptions);\r\n\r\n\t\t\treturn result.indexOf(\"NaN\") === -1 ? result : trimedValue;\r\n\t\t};\r\n\t}\r\n\r\n\tstatic AbsoluteValue(): IFormatterFunction {\r\n\t\treturn (row: number, cell: number, value: string, col: IDataGridColumn, item: any, datagrid: any) => {\r\n\t\t\tlet parsedValue = parseInt(value, 10);\r\n\r\n\t\t\tif (Helper.isUndefinedEmpty(value) || Number.isNaN(parsedValue)) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\r\n\t\t\tif (+value%1 !== 0) {\r\n\t\t\t\tparsedValue = parseFloat(value);\r\n\t\t\t}\r\n\r\n\t\t\treturn Math.abs(parsedValue).toString();\r\n\t\t\t\r\n\t\t};\r\n\t}\r\n}\r\n","import { DateFormatEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { Helper } from \"common/helper\";\r\n\r\nexport class LocaleHelper {\r\n\tstatic getDateFormat(\r\n\t\tformat: string,\r\n\t\tlocale?: string\r\n\t): string {\r\n\t\tif (Helper.isUndefined(locale)) {\r\n\t\t\tlocale = Soho.Locale.currentLocale.name;\r\n\t\t}\r\n\t\tconst localeName = Soho.Locale.cultures[locale];\r\n\t\tconst calendar = localeName.calendars[0];\r\n\r\n\t\tif (format === DateFormatEnum.Timeformat) {\r\n\t\t\treturn calendar.timeFormat;\r\n\t\t}\r\n\t\treturn calendar.dateFormat[format];\r\n\t}\r\n}\r\n","import { IDatePickerOptions } from \"../../model/sohoxi/sohoxi-datepicker.model\";\r\n\r\n/**\r\n * Datepicker directive.\r\n *\r\n * Example:\r\n * scope[\"options\"] = {\tdateFormat: \"YYYY/M/D\" }\r\n *\r\n * <input xi-datepicker=\"options\" id=\"date-field\" class=\"datepicker\" type=\"text\"/>\r\n */\r\nexport class DatepickerDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiDatepicker\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[DatepickerDirective.DIRECTIVE_NAME];\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(\r\n\t\t\t\tnewOptions: IDatePickerOptions,\r\n\t\t\t\toldOptions: IDatePickerOptions\r\n\t\t\t) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.datepicker(newOptions);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(DatepickerDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new DatepickerDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Dropdown Directive.\r\n *\r\n * Example:\r\n * scope[\"datas\"] = [{ value: 1, label: \"first\" }, { value: 2, label: \"second\" }]\r\n *\t<select id=\"dropdown-1\" class=\"dropdown\"\r\n\t\tng-model=\"modelVal\"\r\n\t\tng-options=\"data.label as data.value for data in datas\"\r\n\t\txi-drop-down\r\n\t></select>\r\n\t*/\r\n\r\nimport * as xi from \"../../model/sohoxi/sohoxi-dropdown.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class DropDownDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiDropDown\";\r\n\r\n\tconstructor(private $timeout: ng.ITimeoutService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[DropDownDirective.DIRECTIVE_NAME];\r\n\t\tlet api: any;\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: xi.IDropDownOptions) => {\r\n\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t\telement.dropdown(newOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.dropdown();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tapi = Utils.getData(element, \"dropdown\");\r\n\t\t\t\t\tapi.setDisplayedValues();\r\n\t\t\t\t}, 100); // tslint:disable-line:no-magic-numbers\r\n\t\t\t},\r\n\t\t\ttrue\r\n\t\t);\r\n\r\n\t\tlet modelWatcher: any;\r\n\t\tconst modelAttr = attributes.ngModel;\r\n\r\n\t\tif (modelAttr) {\r\n\t\t\tmodelWatcher = scope.$watch(modelAttr, () => {\r\n\t\t\t\tif (api) {\r\n\t\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\t\tapi.setDisplayedValues();\r\n\t\t\t\t\t}, 100); // tslint:disable-line:no-magic-numbers\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tlet disabledWatcher: any;\r\n\t\tconst disabledAttr = attributes.ngDisabled;\r\n\r\n\t\tif (disabledAttr) {\r\n\t\t\tdisabledWatcher = scope.$watch(disabledAttr, newValue => {\r\n\t\t\t\tif (api) {\r\n\t\t\t\t\tif (newValue === false) {\r\n\t\t\t\t\t\tapi.enable();\r\n\t\t\t\t\t} else if (newValue === true) {\r\n\t\t\t\t\t\tapi.disable();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tif (api) {\r\n\t\t\t\tapi.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t\tif (modelWatcher) {\r\n\t\t\t\tmodelWatcher();\r\n\t\t\t}\r\n\t\t\tif (disabledWatcher) {\r\n\t\t\t\tdisabledWatcher();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(DropDownDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\ttimeout => {\r\n\t\t\t\treturn new DropDownDirective(timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { IEditorOptions } from \"../../model/sohoxi/sohoxi-editor.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Editor Directive.\r\n *\r\n * Example:\r\n * scope[\"options\"]: IEditorOptions = {\r\n * \tanchor: {\r\n * \t\turl: \"https://www.example.com,\r\n * \t\tclass: \"hyperlink\",\r\n * \t\ttarget: \"_blank\"\r\n * \t}\r\n * };\r\n * <div class=\"editor\" id=\"my-editor\" role=\"textbox\" aria-multiline=\"true\" aria-label=\"notes\" xi-editor></div>\r\n */\r\nexport class EditorDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiEditor\";\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[EditorDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IEditorOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.editor(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.editor();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst editorData = Utils.getData(element, \"editor\");\r\n\t\t\tif (editorData) {\r\n\t\t\t\teditorData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(EditorDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new EditorDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { Utils } from \"../utils\";\r\n\r\n/**\r\n * File Upload Directive.\r\n *\r\n * Used for binding a scope variable to selected file(s)\r\n * The name of the scope variable is specified as xi-fileupload=\"scopeVariableName\"\r\n *\r\n * Example:\r\n * scope[\"files\"]\r\n *\r\n * <label class=\"fileupload\">\r\n * \t<span class=\"audible\">Choose File</span>\r\n * \t<input type=\"file\" name=\"file-input\" xi-fileupload=\"chosenFile\" />\r\n * </label>\r\n */\r\nexport class FileuploadDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiFileupload\";\r\n\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tconstructor(\r\n\t\tprivate timeout: ng.ITimeoutService,\r\n\t\tprivate parse: ng.IParseService\r\n\t) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst expression = attributes[FileuploadDirective.DIRECTIVE_NAME];\r\n\t\tconst parent = element.parent(\".fileupload\");\r\n\t\tif (!expression || parent.length === 0) {\r\n\t\t\t// Incorrect setup\r\n\t\t\treturn;\r\n\t\t}\r\n\t\telement.bind(\"change.fileupload\", () => {\r\n\t\t\tconst files = (element[0] as any)[\"files\"];\r\n\r\n\t\t\tthis.parse(expression).assign(scope, files); // tslint:disable-line:no-string-literal\r\n\t\t\tscope.$apply();\r\n\t\t});\r\n\t\t// Timeout to let the label render\r\n\t\tthis.timeout(() => {\r\n\t\t\tparent.fileupload();\r\n\t\t}, 1);\r\n\t\tparent.on(\"$destroy\", () => {\r\n\t\t\tconst fileUploadData = Utils.getData(parent, \"fileupload\");\r\n\t\t\tif (fileUploadData) {\r\n\t\t\t\tfileUploadData.destroy();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(FileuploadDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\t\"$parse\",\r\n\t\t\t(timeout, parse) => {\r\n\t\t\t\treturn new FileuploadDirective(timeout, parse);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { IComponentRendered } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { IListViewApi, IListViewOptions } from \"../../model/sohoxi/sohoxi-listview.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * Listview Directive.\r\n *\r\n * Example:\r\n * scope[\"options\"] = { dataset: items, selectable: \"multiple\" };\r\n * scope[\"items\"] = [\"first\", \"second\", \"third\"];\r\n *\r\n * <div class=\"card\">\r\n * \t<div class=\"card-header\"></div>\r\n * \t<div class=\"card-content\">\r\n * \t\t<div class=\"listview-toolbar toolbar is-hidden\">\r\n * \t\t\t<div class=\"buttonset\">\r\n * \t\t\t\t<button class=\"btn-tertiary\" title=\"remove\" type=\"button\"\r\n * \t\t\t\t\tng-click=\"ctrl.removeSelected()\"\r\n * \t\t\t\t>\r\n * \t\t\t\t\tRemove\r\n * \t\t\t\t</button>\r\n * \t\t\t</div>\r\n * \t\t</div>\r\n * \t\t<div class=\"listview is-muliselect\" id=\"multiselect-listview\"\r\n * \t\t\txi-listview=\"options\"\r\n *\t\t\t>\r\n\t* \t\t\t<ul>\r\n\t* \t\t\t\t<li ng-repeat=\"item in items track by $id($index)\">\r\n\t* \t\t\t\t\t<p>{{item}}</p>\r\n\t* \t\t\t\t</li>\r\n\t* \t\t\t</ul>\r\n\t* \t\t</div>\r\n\t* \t</div>\r\n\t* </div>\r\n\t*/\r\nexport const LISTVIEW_RENDERED = \"finishedListviewCreation\";\r\nexport class ListviewDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiListview\";\r\n\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[ListviewDirective.DIRECTIVE_NAME];\r\n\t\tconst toolbar = element\r\n\t\t\t.closest(\".widget, .card\")\r\n\t\t\t.find(\".listview-toolbar\");\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IListViewOptions) => {\r\n\t\t\t\tlet api: IListViewApi;\r\n\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\tapi =  Utils.getData(element, \"listview\");\r\n\r\n\t\t\t\t\tif (api) {\r\n\t\t\t\t\t\tapi.updated(newOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.listview(newOptions);\r\n\t\t\t\t\t\tapi =  Utils.getData(element, \"listview\");\r\n\r\n\t\t\t\t\t\tconst toolbarElement: any = toolbar\r\n\t\t\t\t\t\t\t.removeClass(\"is-visible\")\r\n\t\t\t\t\t\t\t.one(\"animateClosedComplete\",\r\n\t\t\t\t\t\t\t\tevent => {\r\n\t\t\t\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\t\t\t\ttoolbar.css(\"display\", \"none\");\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\ttoolbarElement[\"animateClosed\"](); // tslint:disable-line:no-string-literal\r\n\r\n\t\t\t\t\t\tangular.forEach(\r\n\t\t\t\t\t\t\tapi.selectedItems,\r\n\t\t\t\t\t\t\tselected => selected.removeClass());\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tapi = element.listview();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (newOptions?.id !== undefined) {\r\n\t\t\t\t\tconst finishedResult: IComponentRendered = {\r\n\t\t\t\t\t\tid: newOptions.id,\r\n\t\t\t\t\t\tapi,\r\n\t\t\t\t\t};\r\n\t\t\t\t\telement.trigger(LISTVIEW_RENDERED, finishedResult);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttrue\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst listViewData = Utils.getData(element, \"listview\");\r\n\t\t\tif (listViewData) {\r\n\t\t\t\tlistViewData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ListviewDirective.DIRECTIVE_NAME, [\r\n\t\t\t() => {\r\n\t\t\t\treturn new ListviewDirective();\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { ILookupOptions } from \"../../model/sohoxi/sohoxi-lookup.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n//tslint:disable\r\n/**\r\n * Lookup Directive.\r\n *\r\n * Example:\r\n * scope[\"options\"]: ILookupOptions = {\r\n * \tfield: \"productId\",\r\n * \toptions: {\r\n * \t\tcolumns: [\r\n * \t\t\t{ id: 'productId', name: 'Product Id', field: 'productId', width: 140 },\r\n * \t\t\t{ id: 'productName', name: 'Product Name', sortable: false, field: 'productName', width: 250, formatter: (<any>window).Formatters.Hyperlink },\r\n * \t\t\t{ id: 'activity', hidden: true, name: 'Activity', field: 'activity', width: 125 }\r\n * \t\t],\r\n * \t\tdataset: [\r\n * \t\t\t{ id: 1, productId: 2142201, productName: 'Compressor', activity: 'Assemble Paint' },\r\n * \t\t\t{ id: 2, productId: 2241202, productName: 'Different Compressor', activity: 'Inspect and Repair' },\r\n * \t\t\t{ id: 3, productId: 2342203, productName: 'Third Compressor', activity: 'Inspect and Repair' }\r\n * \t\t],\r\n * \t\tselectable: 'single'\r\n * \t}\r\n * }\r\n * <input id=\"lookup-example\" data-init=\"false\" class=\"lookup\" type=\"text\" xi-lookup=\"options\"/>\r\n */\r\n\r\n//tslint:enable\r\nexport class LookupDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiLookup\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[LookupDirective.DIRECTIVE_NAME];\r\n\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ILookupOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.lookup(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.lookup();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttrue\r\n\t\t);\r\n\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst lookupData = Utils.getData(element, \"lookup\");\r\n\t\t\tif (lookupData) {\r\n\t\t\t\tlookupData.destroy();\r\n\t\t\t}\r\n\t\t\t$(\"body\").off(\"open\");\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(LookupDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new LookupDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IMaskOptions } from \"../../model/sohoxi/sohoxi-mask.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\n/**\r\n * Mask Directive.\r\n *\r\n * Sets masking properties on an input.\r\n * Instead of providing av options object, the following attributes can be used:\r\n * data-mask-mode\r\n * data-mask (corresponds to 'pattern' in IMaskOptions)\r\n * data-thousands\r\n * data-must-complete\r\n * data-show-currency\r\n *\r\n * Example:\r\n * scope[\"options\"]: IXiMaskOptions = {\"pattern\": \"##:##\", }\r\n * <input xi-mask=\"options\" />\r\n *\r\n * <input xi-mask data-mask-mode=\"number\" data-mask=\"####\" data-thousands=\"true\" />\r\n */\r\nexport class MaskDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiMask\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[MaskDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IMaskOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t// Set attributes and initialize control with options object\r\n\t\t\t\t\tif (newOptions.mode) {\r\n\t\t\t\t\t\telement.attr(\"data-mask-mode\", newOptions.mode);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newOptions.thousands) {\r\n\t\t\t\t\t\telement.attr(\"data-thousands\", String(newOptions.thousands));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newOptions.mustComplete) {\r\n\t\t\t\t\t\telement.attr(\r\n\t\t\t\t\t\t\t\"data-must-complete\",\r\n\t\t\t\t\t\t\tString(newOptions.mustComplete)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newOptions.showCurrency) {\r\n\t\t\t\t\t\telement.attr(\r\n\t\t\t\t\t\t\t\"data-show-currency\",\r\n\t\t\t\t\t\t\tString(newOptions.showCurrency)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telement.mask(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Initiate control without options object\r\n\t\t\t\t\telement.mask();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst maskData = Utils.getData(element, \"mask\");\r\n\t\t\tif (maskData) {\r\n\t\t\t\tmaskData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(MaskDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new MaskDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IMultiSelectOptions } from \"../../model/sohoxi/sohoxi-multiselect.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Multiselect Directive\r\n *\r\n * Provides multiselection.\r\n * Note that the element must have an ID.\r\n */\r\nexport class MultiSelectDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiMultiselect\";\r\n\r\n\tconstructor(private $timeout: ng.ITimeoutService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\t// ID is required\r\n\t\tif (!attributes.id) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst options = attributes[MultiSelectDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IMultiSelectOptions) => {\r\n\t\t\t\t// Set selected after binding\r\n\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t\telement.multiselect(newOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.multiselect();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 100); // tslint:disable-line:no-magic-numbers\r\n\t\t\t}\r\n\t\t);\r\n\t\t// let modelWatcher;\r\n\t\t// const modelAttr = attributes[\"ngModel\"];\r\n\t\t// if (modelAttr) {\r\n\t\t// \tmodelWatcher = scope.$watch(modelAttr, () => {\r\n\t\t// \t\tif (api) {\r\n\t\t// \t\t\tthis.$timeout(() => {\r\n\t\t// \t\t\t\tapi.setValue();\r\n\t\t// \t\t\t}, 100);\r\n\t\t// \t\t}\r\n\t\t// \t});\r\n\t\t// }\r\n\r\n\t\t// let disabledWatcher;\r\n\t\t// const disabledAttr = attributes[\"ngDisabled\"];\r\n\t\t// if (disabledAttr) {\r\n\t\t// \tdisabledWatcher = scope.$watch(disabledAttr, newValue => {\r\n\t\t// \t\tif (api) {\r\n\t\t// \t\t\tif (newValue === false) {\r\n\t\t// \t\t\t\tapi.enable();\r\n\t\t// \t\t\t} else if (newValue === true) {\r\n\t\t// \t\t\t\tapi.disable();\r\n\t\t// \t\t\t}\r\n\t\t// \t\t}\r\n\t\t// \t});\r\n\t\t// }\r\n\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst multiSelectApi = Utils.getData(element, \"multiselect\");\r\n\t\t\tif (multiSelectApi) {\r\n\t\t\t\tmultiSelectApi.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t\t// if (modelWatcher) {\r\n\t\t\t// \tmodelWatcher();\r\n\t\t\t// }\r\n\t\t\t// if (disabledWatcher) {\r\n\t\t\t// \tdisabledWatcher();\r\n\t\t\t// }\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(MultiSelectDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\ttimeout => {\r\n\t\t\t\treturn new MultiSelectDirective(timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { IPopoverOptions } from \"../../model/sohoxi/sohoxi-popover.model\";\r\nimport { Utils } from \"../utils\";\r\n/**\r\n * Popover Directive\r\n *\r\n * Same control as tooltip.\r\n *\r\n * Example:\r\n * scope[\"options\"]: IXiTooltipOptions = {\r\n * \tcontent: $(\"#popover-contents\"),\r\n * \ttrigger: \"click\",\r\n * \tplacement: \"left\"\r\n * }\r\n * <button class=\"btn-primary\" type=\"button\" xi-popover=\"options\">Click Activated</button>\r\n * <div id=\"popover-contents\">\r\n * \t<p>This is the popover content</p>\r\n * </div>\r\n */\r\nexport class PopoverDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiPopover\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\tattributes[PopoverDirective.DIRECTIVE_NAME],\r\n\t\t\t(newValue: IPopoverOptions) => {\r\n\t\t\t\tif (newValue) {\r\n\t\t\t\t\tif (!newValue.placement) {\r\n\t\t\t\t\t\tnewValue.placement = \"right\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\telement.popover(newValue);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst tooltipData = Utils.getData(element, \"tooltip\");\r\n\t\t\tif (tooltipData) {\r\n\t\t\t\ttooltipData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(PopoverDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new PopoverDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Popup Menu Directive.\r\n */\r\n\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class PopupmenuDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiPopupmenu\";\r\n\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tconstructor(private timeout: ng.ITimeoutService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\tattributes[PopupmenuDirective.DIRECTIVE_NAME],\r\n\t\t\tnewOptions => {\r\n\t\t\t\t// Init popup menu plugin. The timeout allows angular bindings to be evaluated\r\n\t\t\t\tthis.timeout(() => {\r\n\t\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t\telement.popupmenu(newOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.popupmenu();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1);\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst popupMenuData = Utils.getData(element, \"popupmenu\");\r\n\t\t\tif (popupMenuData) {\r\n\t\t\t\tpopupMenuData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(PopupmenuDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\ttimeout => {\r\n\t\t\t\treturn new PopupmenuDirective(timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { ISearchFieldOptions } from \"../../model/sohoxi/sohoxi-searchfield.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Searchfield Directive.\r\n *\r\n * Suggests values in given data (source) that matches the input.\r\n *\r\n * Example:\r\n * scope[\"options\"]: ISearchfieldOptions = { \"source\": [\"Alpha\", \"Bravo\"], \"template\": \"#template\" }\r\n * <input xi-searchfield=\"options\" />\r\n */\r\nexport class SearchFieldDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiSearchfield\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[SearchFieldDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ISearchFieldOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t// Set the data-autocomplete attribute to source (external in options object)\r\n\t\t\t\t\telement.searchfield(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.searchfield();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst searchFieldData = Utils.getData(element, \"searchfield\");\r\n\t\t\tif (searchFieldData) {\r\n\t\t\t\tsearchFieldData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(SearchFieldDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new SearchFieldDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { ISliderOptions } from \"../../model/sohoxi/sohoxi-slider.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Slider directive.\r\n *\r\n * Example:\r\n * scope[\"options\"] = {\r\n * \tvalue: [1],\r\n * \tmin: 0,\r\n * \tmax: 2,\r\n * \trange: false,\r\n * \tstep: 1,\r\n * \tticks: [\r\n * \t\t{ value: 0, description: \"Hidden\", color: \"#ed1c24\" },\r\n * \t\t{ value: 1, description: \"Read only\", color: \"#faa719\" },\r\n * \t\t{ value: 2, description: \"Enabled\", color: \"#157a13\" }\r\n * \t]\r\n * }\r\n * <input id=\"slider-example\" xi-slider=\"options\"/>\r\n */\r\nexport class SliderDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiSlider\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[SliderDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ISliderOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.slider(newOptions as any);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.slider();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst sliderData = Utils.getData(element, \"slider\");\r\n\t\t\tif (sliderData) {\r\n\t\t\t\tsliderData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(SliderDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new SliderDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { Utils } from \"../utils\";\r\n\r\n/**\r\n * Spinbox Directive.\r\n *\r\n * Example:\r\n * <input xi-spinbox class=\"spinbox\" min=\"-99\" max=\"99\" value=\"0\" step=\"3\" />\r\n *\r\n * Attributes: min, max, value (default), step\r\n * Supports xi-track-dirty\r\n */\r\nexport class SpinboxDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiSpinbox\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\telement.spinbox();\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst spinBoxData = Utils.getData(element, \"spinbox\");\r\n\t\t\tif (spinBoxData) {\r\n\t\t\t\tspinBoxData.destroy();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(SpinboxDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new SpinboxDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import * as xi from \"../../model/sohoxi/sohoxi-tabs.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class TabsDirective implements ng.IDirective {\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTabs\";\r\n\r\n\tconstructor(private $timeout: ng.ITimeoutService) {}\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[TabsDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: xi.ITabsOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\tif (newOptions.modalId) {\r\n\t\t\t\t\t\tlet tabToFocus;\r\n\t\t\t\t\t\tconst modalElement = $(\"#\" + newOptions.modalId);\r\n\r\n\t\t\t\t\t\t// Force recalculation of modal size\r\n\t\t\t\t\t\tmodalElement.addClass(\"hidden\");\r\n\r\n\t\t\t\t\t\tmodalElement.one(\"open\", () => {\r\n\t\t\t\t\t\t\tmodalElement.removeClass(\"hidden\");\r\n\t\t\t\t\t\t\telement.tabs(newOptions as any);\r\n\t\t\t\t\t\t\tUtils.getData(modalElement, \"modal\").resize();\r\n\r\n\t\t\t\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\t\t\t\ttabToFocus = modalElement.find(\r\n\t\t\t\t\t\t\t\t\t\":focusable:not(.searchfield):first\"\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tif (tabToFocus.length) {\r\n\t\t\t\t\t\t\t\t\ttabToFocus.focus();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (newOptions.tabToSelect) {\r\n\t\t\t\t\t\t\t\t\tconst tab = modalElement.find(\r\n\t\t\t\t\t\t\t\t\t\t\"li\" + newOptions.tabToSelect\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tif (tab.length) {\r\n\t\t\t\t\t\t\t\t\t\ttab.click();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, 10); // tslint:disable-line:no-magic-numbers\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\telement.tabs(newOptions as any);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.tabs();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst tabData = Utils.getData(element, \"tabs\");\r\n\t\t\tif (tabData) {\r\n\t\t\t\ttabData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(TabsDirective.DIRECTIVE_NAME, [\r\n\t\t\t\"$timeout\",\r\n\t\t\ttimeout => {\r\n\t\t\t\treturn new TabsDirective(timeout);\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { ITextAreaOptions } from \"../../model/sohoxi/sohoxi-textarea.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Textarea directive.\r\n *\r\n * Example:\r\n * <textarea xi-textarea type=\"text\" maxlength=\"100\"></textarea>\r\n */\r\nexport class TextareaDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTextarea\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[TextareaDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ITextAreaOptions) => {\r\n\t\t\t\tconst textareaApi = Utils.getData(element, \"textarea\");\r\n\t\t\t\tif (newOptions && textareaApi === undefined) {\r\n\t\t\t\t\telement.textarea(newOptions);\r\n\t\t\t\t} else if (textareaApi) {\r\n\t\t\t\t\ttextareaApi.updated(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.textarea();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst textAreaData = Utils.getData(element, \"textarea\");\r\n\t\t\tif (textAreaData) {\r\n\t\t\t\ttextAreaData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(TextareaDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new TextareaDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import type { ITimePickerOptions } from \"../../model/sohoxi/sohoxi-timepicker.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Timepicker Directive.\r\n *\r\n * Example:\r\n * <input xi-timepicker=\"options\" class=\"timepicker\">\r\n*/\r\nexport class TimepickerDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTimepicker\";\r\n\trestrict = \"A\";\r\n\tscope = false;\r\n\r\n\tlink(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[TimepickerDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: ITimePickerOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\t// Destory old settings\r\n\t\t\t\t\telement.data(\"timepicker\").destroy();\r\n\t\t\t\t\telement.timepicker(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.timepicker();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst timePickerData = Utils.getData(element, \"timepicker\");\r\n\t\t\tif (timePickerData) {\r\n\t\t\t\ttimePickerData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(TimepickerDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new TimepickerDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IToolbarOptions } from \"../../model/sohoxi/sohoxi-toolbar.model\";\r\nimport { Utils } from \"../utils\";\r\n\r\n/**\r\n * Toolbar directive.\r\n *\r\n * Example:\r\n * scope[\"options\"] = {rightAligned: false, maxVisibleButtons: 5}\r\n * <div class=\"toolbar\" xi-toolbar=\"options\"> ... </div>\r\n */\r\nexport class ToolbarDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiToolbar\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\tpublic replace = true;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[ToolbarDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IToolbarOptions) => {\r\n\t\t\t\tif (newOptions) {\r\n\t\t\t\t\telement.toolbar(newOptions);\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.toolbar();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst toolbarData = Utils.getData(element, \"toolbar\");\r\n\t\t\tif (toolbarData) {\r\n\t\t\t\ttoolbarData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ToolbarDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new ToolbarDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Tooltip Directive\r\n */\r\n\r\nimport has from \"lodash-es/has\";\r\n\r\nimport * as xi from \"../../model/sohoxi/sohoxi-tooltip.model\";\r\nimport { Utils } from \"../../sohoxi/utils\";\r\n\r\nexport class TooltipDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTooltip\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tlet isInstantiated = false;\r\n\t\tif (has(attributes, \"ngDisabled\")) {\r\n\t\t\tconst content = attributes.xiTooltip.replace(/^\\'+|\\'+$/g, \"\");\r\n\t\t\telement.append(\r\n\t\t\t\t`<div class=\"disabled-tooltip\" title=\"${content}\"></div>`\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst options = attributes[TooltipDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\tnewValue => {\r\n\t\t\t\tif (typeof newValue === \"string\") {\r\n\t\t\t\t\tif (newValue.length === 0) {\r\n\t\t\t\t\t\t// Empty tooltips should not be shown so destroy the plugin\r\n\t\t\t\t\t\tif (isInstantiated) {\r\n\t\t\t\t\t\t\tUtils.getData(element, \"tooltip\").destroy();\r\n\t\t\t\t\t\t\tisInstantiated = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (!isInstantiated) {\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t\tTimeout is required because when xi-tooltip is used together with xi-toolbar\r\n\t\t\t\t\t\t\t\tand if tooltip is initialized before toolbar then toolbar overrides tooltip.\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\telement.tooltip({\r\n\t\t\t\t\t\t\t\t\tcontent: newValue\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t//tslint:disable-next-line\r\n\t\t\t\t\t\t\t}, 100);\r\n\r\n\t\t\t\t\t\t\tconst disabledTooltip = element.find(\"div[title]\");\r\n\t\t\t\t\t\t\tif (disabledTooltip.length !== 0) {\r\n\t\t\t\t\t\t\t\tdisabledTooltip.tooltip();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisInstantiated = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconst newOptions = {\r\n\t\t\t\t\t\t\t\tcontent: newValue\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tconst api = Utils.getData(element, \"tooltip\");\r\n\t\t\t\t\t\t\tapi.updated(newOptions);\r\n\r\n\t\t\t\t\t\t\tconst disabledTooltip =\r\n\t\t\t\t\t\t\t\telement.find(\"div.disabled-tooltip\");\r\n\t\t\t\t\t\t\tif (disabledTooltip.length === 1) {\r\n\t\t\t\t\t\t\t\tdisabledTooltip\r\n\t\t\t\t\t\t\t\t\t.data(\"tooltip\")\r\n\t\t\t\t\t\t\t\t\t.updated(newOptions);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (typeof newValue === \"undefined\" || newValue === null) {\r\n\t\t\t\t\t// Empty tooltips should not be shown so destroy the plugin\r\n\t\t\t\t\tif (isInstantiated) {\r\n\t\t\t\t\t\tUtils.getData(element, \"tooltip\").destroy();\r\n\t\t\t\t\t\tisInstantiated = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Instantiate plugin with tooltip value\r\n\t\t\t\t\telement.tooltip(newValue);\r\n\t\t\t\t\tisInstantiated = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tconst tooltipData = Utils.getData(element, \"tooltip\") as xi.ITooltipApi;\r\n\t\t\tif (isInstantiated && tooltipData) {\r\n\t\t\t\ttooltipData.destroy();\r\n\t\t\t}\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(\r\n\t\t\tTooltipDirective.DIRECTIVE_NAME,\r\n\t\t\t() => {\r\n\t\t\t\treturn new TooltipDirective();\r\n\t\t\t});\r\n\t}\r\n}\r\n","/**\r\n * Track Dirty Directive.\r\n *\r\n * Indicates if an element is dirty.\r\n */\r\nexport class TrackDirtyDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiTrackDirty\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\tpublic replace = true;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\telement.attr(\"data-trackdirty\", \"true\");\r\n\t\telement.trackdirty();\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(TrackDirtyDirective.DIRECTIVE_NAME, () => {\r\n\t\t\treturn new TrackDirtyDirective();\r\n\t\t});\r\n\t}\r\n}\r\n","import { IValidateOptions } from \"../../model/sohoxi/sohoxi-validate.model\";\r\n\r\n/**\r\n * Validation Directive.\r\n *\r\n * Validates input based on the options. Possible validations are \"required\", \"date\" and \"time\".\r\n * If validation is \"time\", the \"timeFormat\" option can be set.\r\n * Instead of providing av options object, the following attributes can be used:\r\n * data-validate\r\n * data-time-format\r\n *\r\n * Examples:\r\n * <input xi-validate=\"time\" xi-time-format=\"HH\"/>\r\n */\r\nexport class ValidateDirective implements ng.IDirective {\r\n\tprivate static readonly DIRECTIVE_NAME = \"xiValidate\";\r\n\r\n\tpublic require = \"?ngModel\";\r\n\tpublic restrict = \"A\";\r\n\tpublic scope = false;\r\n\r\n\tpublic link(\r\n\t\tscope: ng.IScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattributes: ng.IAttributes\r\n\t): void {\r\n\t\tconst options = attributes[ValidateDirective.DIRECTIVE_NAME];\r\n\t\tconst unbindWatcher = scope.$watch(\r\n\t\t\toptions,\r\n\t\t\t(newOptions: IValidateOptions) => {\r\n\t\t\t\t// Use options object or attributes\r\n\t\t\t\tif (!newOptions) {\r\n\t\t\t\t\t// Use attributes\r\n\t\t\t\t\telement.validate();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (newOptions.validation) {\r\n\t\t\t\t\t\telement.attr(\"data-validate\", newOptions.validation);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (newOptions.timeFormat) {\r\n\t\t\t\t\t\telement.attr(\"data-time-format\", newOptions.timeFormat);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telement.validate();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t\t// Tear down\r\n\t\telement.on(\"$destroy\", () => {\r\n\t\t\tunbindWatcher();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.directive(ValidateDirective.DIRECTIVE_NAME, [\r\n\t\t\t() => {\r\n\t\t\t\treturn new ValidateDirective();\r\n\t\t\t}\r\n\t\t]);\r\n\t}\r\n}\r\n","import { IJsonCustomComponentDefinition } from \"ng2/common/model/databearer/components/json-custom-component-def.model\";\r\n\r\nexport interface ICustomComponentDefinition extends IJsonCustomComponentDefinition { }\r\n","import { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport interface IJsonCustomComponentDefinition {\r\n\tid: string;\r\n\tdisplayName: string;\r\n\r\n\tinit?: string;\r\n\tloadInteraction?: string;\r\n\thtmlTemplate?: string;\r\n\tbindableFields?: IJsonBindableField[];\r\n\ttargetActions?: string[];\r\n\tsourceTriggers?: string[];\r\n}\r\n","import { QuestionDefinitionsEnum } from \"../model/questions/questions.enum\";\r\nimport type { IJsonQuestion } from \"../model/questions/questions.model\";\r\n\r\nimport { MimeTypes, ProjectFileKeys } from \"ng2/common/constants/common.constant\";\r\n\r\nimport type { ICustomComponentDefinition } from \"ng2/common/model/components/custom-component-definition.model\";\r\nimport type { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport type { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IJsonDesignerMashup } from \"ng2/common/model/databearer/json-mashup.model\";\r\nimport type { IDesignerMashup } from \"ng2/common/model/project/mashup/designer-mashup.model\";\r\n\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { Mashup } from \"ng2/common/project/mashup\";\r\nimport { Interaction } from \"ng2/components/interaction/interaction\";\r\n\r\nexport class DesignerMashup extends Mashup implements IDesignerMashup {\r\n\tmanifest: DesignerManifest;\r\n\tquestions?: IJsonQuestion[] = [];\r\n\r\n\tgetManifest(): DesignerManifest {\r\n\t\treturn this.manifest;\r\n\t}\r\n\r\n\t//#region /* Questions */\r\n\r\n\tdeleteQuestion(questionId: string, settingId: string): void {\r\n\t\tconst question = this.questions.find(question => question.id === questionId);\r\n\t\tif (settingId || question.settings?.length > 1) {\r\n\t\t\tquestion.settings = question.settings.filter((setting => setting.id !== settingId));\r\n\t\t} else {\r\n\t\t\tthis.questions = this.questions.filter((question => question.id !== questionId));\r\n\t\t}\r\n\t}\r\n\taddQuestion(newQuestion: IJsonQuestion): void {\r\n\t\tif (newQuestion.type === QuestionDefinitionsEnum.COMPONENT_SETTINGS) {\r\n\t\t\tconst sameQuestion = this.getQuestion(newQuestion, QuestionDefinitionsEnum.COMPONENT_SETTINGS);\r\n\t\t\tif (sameQuestion) {\r\n\t\t\t\tconst settingExist = sameQuestion.settings.some(setting => setting.key === newQuestion.settings[0].key);\r\n\t\t\t\tif (!settingExist) {\r\n\t\t\t\t\tsameQuestion.settings.push(newQuestion.settings[0]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.questions.push(newQuestion);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst foundSameQuestion = this.getQuestion(newQuestion, QuestionDefinitionsEnum.SEEKS_BINDING);\r\n\t\t\tif (!foundSameQuestion) {\r\n\t\t\t\tthis.questions.push(newQuestion);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getQuestion(newQuestion: IJsonQuestion, type: QuestionDefinitionsEnum): IJsonQuestion {\r\n\t\treturn this.questions.find((question) => {\r\n\t\t\treturn question.componentId === newQuestion.componentId && question.type === type;\r\n\t\t});\r\n\t}\r\n\tgetQuestions(): IJsonQuestion[] {\r\n\t\treturn this.questions;\r\n\t}\r\n\r\n\tsetQuestions(questions: IJsonQuestion[]): void {\r\n\t\tthis.questions = questions;\r\n\t}\r\n\r\n\tgetQuestionById(id: string): IJsonQuestion {\r\n\t\treturn this.questions.find(question => question.id === id);\r\n\t}\r\n\r\n\t////#endregion\r\n\r\n\tsetRoot(componentObject: IJsonLayoutComponent): void {\r\n\t\tsuper.setRoot(componentObject);\r\n\t\tthis.manifest.setHasFile(ProjectFileKeys.ROOT_COMPONENT, MimeTypes.COMPONENT, componentObject.id);\r\n\t}\r\n\r\n\t/* Datasources */\r\n\r\n\taddDatasource(datasource: IJsonDatasource): void {\r\n\t\tsuper.addDatasource(datasource);\r\n\t\tthis.manifest.setHasFile(ProjectFileKeys.DATASOURCE, MimeTypes.DATASOURCE, ProjectFileKeys.DATASOURCE);\r\n\t}\r\n\r\n\t/* Interactions */\r\n\r\n\taddInteraction(interaction: Interaction): void {\r\n\t\tsuper.addInteraction(interaction);\r\n\t\tthis.manifest.setHasFile(ProjectFileKeys.INTERACTION, MimeTypes.INTERACTION, ProjectFileKeys.INTERACTION);\r\n\t}\r\n\r\n\t/* Custom Components */\r\n\r\n\taddCustomComponentDefinition(customComponent: ICustomComponentDefinition): void {\r\n\t\tsuper.addCustomComponentDefinition(customComponent);\r\n\t\tthis.manifest.setHasFile(\r\n\t\t\tProjectFileKeys.CUSTOM_COMPONENT,\r\n\t\t\tMimeTypes.CUSTOM_COMPONENT,\r\n\t\t\tProjectFileKeys.CUSTOM_COMPONENT\r\n\t\t);\r\n\t}\r\n\r\n\t/* Composite Components */\r\n\r\n\taddCompositeComponent(compositeComponent: IJsonCompositeComponent): void {\r\n\t\tsuper.addCompositeComponent(compositeComponent);\r\n\t\tthis.manifest.setHasFile(\r\n\t\t\tProjectFileKeys.COMPOSITE_COMPONENTS,\r\n\t\t\tMimeTypes.COMPOSITE_COMPONENTS,\r\n\t\t\tProjectFileKeys.COMPOSITE_COMPONENTS\r\n\t\t);\r\n\t}\r\n\r\n\tstatic fromObj(obj: IJsonDesignerMashup): DesignerMashup {\r\n\t\tconst entry = Mashup.create(DesignerMashup, DesignerManifest, obj);\r\n\t\t// designer only\r\n\t\tif (obj.questions) {\r\n\t\t\tentry.questions = obj.questions;\r\n\t\t}\r\n\t\treturn entry;\r\n\t}\r\n}\r\n","export enum QuestionDefinitionsEnum {\r\n\tSEEKS_BINDING,\r\n\tCOMPONENT_SETTINGS\r\n}\r\n","import type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tButtonStyle,\r\n\tInteractionPairOperation,\r\n\tInteractionTriggerEnum,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonButton } from \"ng2/common/model/databearer/components/json-button.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport class Button extends Component {\r\n\tstatic availableButtonStyles: IDataPair[] = [\r\n\t\t{ name: \"Primary\", value: ButtonStyle.PRIMARY },\r\n\t\t{ name: \"Secondary\", value: ButtonStyle.SECONDARY },\r\n\t\t{ name: \"Transparent\", value: ButtonStyle.TERTIARY },\r\n\t\t{ name: \"Fill\", value: ButtonStyle.FILL }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CLICK]);\r\n\tstatic TARGET_ACTIONS = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_CLICK;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Content\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"Action\" }\r\n\t}];\r\n\tstatic SETTING_FIELDS =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\tref: SettingKeys.STYLE,\r\n\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\tdataset: Button.availableButtonStyles,\r\n\t\t\tdefaultValue: ButtonStyle.PRIMARY\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Disabled\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false,\r\n\t\t\tbutton: {\r\n\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\tdialog: true\r\n\t\t\t},\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tcontent: string;\r\n\tstyle: string;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonButton,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.style = BackwardCompatible.tryUpdateButtonStyle(obj);\r\n\t}\r\n\r\n\tclick(): void {\r\n\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./button.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div> <button type=button class=btn-{{componentInstance.style}} ng-click=componentInstance.click() ng-disabled=componentInstance.isReadonly> {{componentInstance.content}} </button> </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport {\r\n\tChartTypeEnum, InteractionActionEnum, InteractionPairOperation, SettingKeys,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonChart, IJsonChartDataset } from \"ng2/common/model/databearer/components/json-chart.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nimport { IChartDataItem, IChartDataset } from \"../../common/model/sohoxi/sohoxi-chart.model\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport { IDatasource } from \"common/model/datasource/datasource.model\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\n\r\nexport class Chart extends Component {\r\n\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.LIST];\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Header\",\r\n\t\tref: SettingKeys.CHART_TITLE,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Category axis title\",\r\n\t\tref: SettingKeys.CHART_AXIS_CATEGORY_TITLE,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Value axis title\",\r\n\t\tref: SettingKeys.CHART_AXIS_VALUES_TITLE,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tprotected databearer: IJsonChart;\r\n\t// Bindable2\r\n\tpublic title: string;\r\n\tpublic showLabel: boolean;\r\n\tpublic axisCategoryTitle: string;\r\n\tpublic axisValuesTitle: string;\r\n\tpublic textType: any;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonChart,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService,\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tif (!this.databearer.datasets) {\r\n\t\t\tthis.databearer.datasets = [];\r\n\t\t}\r\n\r\n\t\tBackwardCompatible.tryConvertLegacyChart(this.databearer, obj);\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\r\n\t\tthis.updateWhenExist();\r\n\t}\r\n\r\n\t// Wait for the chart element to exist before rendering\r\n\tprivate updateWhenExist(): void {\r\n\t\tconst checkInterval = 100; // check every 100ms\r\n\t\tconst checkExist = setInterval(() => {\r\n\t\t\tif ($(`#chart-${this.getId()}`).length > 0) {\r\n\t\t\t\tthis.updateChart();\r\n\t\t\t\tclearInterval(checkExist);\r\n\t\t\t}\r\n\t\t}, checkInterval);\r\n\t}\r\n\r\n\tpublic newBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\tthis.updateChart();\r\n\t}\r\n\r\n\tpublic updateVisibility(): void {\r\n\t\tsuper.updateVisibility();\r\n\t\tthis.updateWhenExist();\r\n\t}\r\n\r\n\tpublic loadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.LIST) {\r\n\t\t\tinteractionPromise.then(() => {\r\n\t\t\t\tthis.updateChart();\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tpublic datasourceChanged(newDatasource: IDatasource): void {\r\n\t\tif (!newDatasource) {\r\n\t\t\tthis.datasource = undefined;\r\n\t\t\tthis.getDatabearer().datasets = [];\r\n\t\t}\r\n\t}\r\n\r\n\tpublic setBindableValue(bindableReference: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\tthis.updateChart();\r\n\t}\r\n\r\n\tpublic getDatabearer(): IJsonChart {\r\n\t\treturn this.databearer;\r\n\t}\r\n\r\n\tprivate getSohoChartType(chartEnum: ChartTypeEnum): string {\r\n\t\tconst sohoString = chartEnum.toString().split(/(?=[A-Z])/)\r\n\t\t\t.map((s) => s.charAt(0).toLowerCase() + s.substring(1))\r\n\t\t\t.join(\"-\");\r\n\t\treturn sohoString;\r\n\t}\r\n\r\n\tprivate getExampleData(): IChartDataset[] {\r\n\t\tconst exampleDatasets: IChartDataset[] = [\r\n\t\t\t{\r\n\t\t\t\tname: \"Component A\",\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"Jan\",\r\n\t\t\t\t\t\tvalue: 12,\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Feb\",\r\n\t\t\t\t\t\tvalue: 11\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Mar\",\r\n\t\t\t\t\t\tvalue: 14\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Apr\",\r\n\t\t\t\t\t\tvalue: 10\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"May\",\r\n\t\t\t\t\t\tvalue: 14\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Jun\",\r\n\t\t\t\t\t\tvalue: 8\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: \"Component B\",\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"Jan\",\r\n\t\t\t\t\t\tvalue: 22,\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Feb\",\r\n\t\t\t\t\t\tvalue: 21\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Mar\",\r\n\t\t\t\t\t\tvalue: 24\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Apr\",\r\n\t\t\t\t\t\tvalue: 20\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"May\",\r\n\t\t\t\t\t\tvalue: 24\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Jun\",\r\n\t\t\t\t\t\tvalue: 28\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: \"Component C\",\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"Jan\",\r\n\t\t\t\t\t\tvalue: 32,\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Feb\",\r\n\t\t\t\t\t\tvalue: 31\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Mar\",\r\n\t\t\t\t\t\tvalue: 34\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Apr\",\r\n\t\t\t\t\t\tvalue: 30\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"May\",\r\n\t\t\t\t\t\tvalue: 34\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tname: \"Jun\",\r\n\t\t\t\t\t\tvalue: 38\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t}\r\n\t\t];\r\n\t\treturn exampleDatasets;\r\n\t}\r\n\r\n\tprivate getDataset(list: any[]): IChartDataset[] {\r\n\t\tconst datasets: IChartDataset[] = [];\r\n\t\tif (list) {\r\n\t\t\tconst datasetsMetadata: IJsonChartDataset[] = this.getDatabearer().datasets;\r\n\t\t\tconst sohoDatasetMaxSize = 20;\r\n\t\t\tlist.splice(sohoDatasetMaxSize, list.length); // soho dataset size limit\r\n\r\n\t\t\tdatasetsMetadata.forEach(datasetMetadata => {\r\n\t\t\t\tconst dataset: IChartDataset = {\r\n\t\t\t\t\tname: datasetMetadata.name,\r\n\t\t\t\t\tdata: [],\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlist.forEach(row => {\r\n\t\t\t\t\tconst keys = Object.keys(row);\r\n\t\t\t\t\tconst dataItem: IChartDataItem = { name: \"\", value: 0 };\r\n\t\t\t\t\tkeys.forEach(key => {\r\n\t\t\t\t\t\tif (key === datasetMetadata.categories) {\r\n\t\t\t\t\t\t\tdataItem.name = row[key];\r\n\t\t\t\t\t\t} else if (key === datasetMetadata.series) {\r\n\t\t\t\t\t\t\tlet value = row[key];\r\n\t\t\t\t\t\t\tif (typeof value !== \"number\") {\r\n\t\t\t\t\t\t\t\tvalue = parseInt(value, 10);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tdataItem.value = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!isNaN(dataItem.value) && dataItem.name) {\r\n\t\t\t\t\t\tdataset.data.push(dataItem);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tdatasets.push(dataset);\r\n\t\t\t});\r\n\r\n\t\t\tswitch (this.getBoundarySetting(SettingKeys.CHART_TYPE)) {\r\n\t\t\t\tcase ChartTypeEnum.Bar:\r\n\t\t\t\tcase ChartTypeEnum.Column:\r\n\t\t\t\tcase ChartTypeEnum.Donut:\r\n\t\t\t\tcase ChartTypeEnum.Pie:\r\n\t\t\t\t\tdatasets.splice(1, datasets.length); // splice down to one dataset\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ChartTypeEnum.BarGrouped:\r\n\t\t\t\tcase ChartTypeEnum.BarStacked:\r\n\t\t\t\tcase ChartTypeEnum.ColumnGrouped:\r\n\t\t\t\tcase ChartTypeEnum.ColumnStacked:\r\n\t\t\t\t\tif (datasets.length === 1) { // soho needs at least 2 datasets\r\n\t\t\t\t\t\tdatasets.push({ name: \"\", data: [] } as IChartDataset); // dummy dataset\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (datasets.length > 0) {\r\n\t\t\treturn datasets;\r\n\t\t} else if (this.getDatabearer().datasets.length > 0) {\r\n\t\t\treturn [];\r\n\t\t} else {\r\n\t\t\treturn this.getExampleData();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic updateChart(): void {\r\n\t\tconst chartElement = $(`#chart-${this.getId()}`);\r\n\t\tif (chartElement.length > 0 && chartElement.parent().height() > 0) {\r\n\t\t\tlet dataset: IChartDataset[] = [];\r\n\t\t\tconst listResult = angular.copy(this.getContext().ListResult);\r\n\t\t\tdataset = this.getDataset(listResult);\r\n\t\t\tchartElement.removeClass();\r\n\t\t\tchartElement.addClass(\"chart-container\");\r\n\t\t\tconst hasLabel = this.getBoundarySetting<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\t\tconst chartWrapper = $(\"div.chart > div.widget-content\");\r\n\t\t\t$(\"header.application-header\").length > 0 ?\r\n\t\t\t\tchartWrapper.addClass(\"has-header\") :\r\n\t\t\t\tchartWrapper.removeClass(\"has-header\");\r\n\t\t\thasLabel ? chartWrapper.addClass(\"has-title\") : chartWrapper.removeClass(\"has-title\");\r\n\t\t\tconst chartType = this.getBoundarySetting(SettingKeys.CHART_TYPE) as ChartTypeEnum;\r\n\t\t\tchartElement.chart({\r\n\t\t\t\ttype: this.getSohoChartType(chartType),\r\n\t\t\t\tdataset,\r\n\t\t\t\taxisLabels: {\r\n\t\t\t\t\tleft: this.axisValuesTitle,\r\n\t\t\t\t\tbottom: this.axisCategoryTitle,\r\n\t\t\t\t},\r\n\t\t\t\tshowLegend: this.getBoundarySetting(SettingKeys.CHART_LEGEND_DISPLAY),\r\n\t\t\t\tanimate: this.getBoundarySetting(SettingKeys.CHART_STARTUP_ANIMATION_ENABLE),\r\n\t\t\t\tisArea: chartType === ChartTypeEnum.Area,\r\n\t\t\t\tisDonut: chartType === ChartTypeEnum.Donut,\r\n\t\t\t\t// TODO: Fix this MUPS-2682\r\n\t\t\t\tisGrouped: (chartType as any).includes(\"grouped\"),\r\n\t\t\t\tisStacked: (chartType as any).includes(\"stacked\"),\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./chart.html\"),\r\n\t\t\treplace: true,\r\n\t\t};\r\n\t}];\r\n}\r\n","import { ChartTypeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonComponent, IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonChart extends IJsonComponent {\r\n\ttitle: IJsonValueSource;\r\n\tshowLabel: boolean; // Deprecated\r\n\taxisCategoryTitle: IJsonValueSource;\r\n\taxisValuesTitle: IJsonValueSource;\r\n\tdatasets: IJsonChartDataset[];\r\n\tcontent: IJsonValueSource;\r\n\tboundarySettings: IMap<IJsonChartBoundarySettings>;\r\n\tcategories: IJsonChartCategories[];  // backwards compatibility, legacy format\r\n\tseries: IJsonChartSerie[];  // backwards compatibility, legacy format\r\n}\r\n\r\nexport interface IJsonChartDataset {\r\n\tname: string;\r\n\tcategories: string;\r\n\tseries: string;\r\n}\r\n\r\nexport interface IJsonChartBoundarySettings extends IJsonComponentSettings {\r\n\tchartType: ChartTypeEnum;\r\n\tlegendDisplay: boolean;\r\n\tstartupAnimationEnable: boolean;\r\n\tshowLabel: boolean;\r\n}\r\n\r\n//#region backwards compatibility, legacy formats\r\nexport interface IJsonChartContent {\r\n\tname: string;\r\n\tfield: string;\r\n}\r\n\r\nexport interface IJsonChartCategories extends IJsonChartContent {\r\n}\r\n\r\nexport interface IJsonChartSerie extends IJsonChartContent {\r\n\tchartType: ChartTypeEnum;\r\n}\r\n//#endregion\r\n","// Module\nvar code = \"<div class=chart> <div class=widget-header ng-if=componentInstance.showLabel> <h2 eir-component-value content=componentInstance.title class=widget-title></h2> </div> <div class=widget-content> <div id=chart-{{::component.id}} class=chart-container></div> </div> </div>\";\n// Exports\nmodule.exports = code;","import {\r\n\tInteractionPairOperation, InteractionTriggerEnum,\r\n\tSettingInputKeys, SettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { IJsonCheckbox } from \"../../common/model/component/checkbox.model\";\r\nimport { Component } from \"../component\";\r\n\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class Checkbox extends Component {\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] =\r\n\t\tInteractionDefines.SOURCE_TRIGGERS.concat([\r\n\t\t\tInteractionPairOperation.IS_CHECKED,\r\n\t\t\tInteractionPairOperation.IS_UNCHECKED\r\n\t\t]);\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.IS_CHECKED;\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tpublic static SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Disabled\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false,\r\n\t\t\tbutton: {\r\n\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\tdialog: true\r\n\t\t\t}\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Content\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"Checkbox\" }\r\n\t},\r\n\t{\r\n\t\tname: \"State\",\r\n\t\tref: SettingKeys.CHECK_STATE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: false }\r\n\t}\r\n\t];\r\n\tpublic checkboxState: boolean = false;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonCheckbox,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t}\r\n\r\n\tpublic checked(): void {\r\n\t\t// Timeout needed or else it will be wrong state\r\n\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\tif (this.checkboxState) {\r\n\t\t\t\tthis.trigger(InteractionTriggerEnum.CHECKED);\r\n\t\t\t} else {\r\n\t\t\t\tthis.trigger(InteractionTriggerEnum.UNCHECKED);\r\n\t\t\t}\r\n\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setBindableValue(bindableReference: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\tif (bindableReference === SettingKeys.CHECK_STATE) {\r\n\t\t\tthis.checkboxState = this.isChecked(value);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clear(): void {\r\n\t\tthis.checkboxState = false;\r\n\t}\r\n\r\n\tprivate isChecked(value: string | boolean | number): boolean {\r\n\t\treturn (value === \"1\" || value === true || value === 1 || value === \"true\");\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./checkbox.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=field> <input id=checkbox-{{::component.id}} type=checkbox class=checkbox ng-model=componentInstance.checkboxState ng-disabled=componentInstance.isReadonly ng-click=componentInstance.checked()> <label for=checkbox-{{::component.id}} class=checkbox-label>{{componentInstance.content}}</label> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport isNumber from \"lodash-es/isNumber\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\nimport type { IErrorResponse } from \"../../common/error-response\";\r\nimport { Helper } from \"../../common/helper\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { DialogButtonType, IDialogOptions, IDialogResult } from \"../../common/services/dialog-service\";\r\nimport { DatagridHelper } from \"../../common/sohoxi/datagrid-helper\";\r\nimport { Component } from \"../component\";\r\nimport { ComponentsHelper } from \"../helper\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport type { IDatagridExportResult } from \"./datagrid-export-dialog-ctrl\";\r\n\r\nimport {\r\n\tDatagridExportTypes, DatagridPageSizesEnum, GridAggregators,\r\n\tInteractionActionEnum, InteractionPairOperation, InteractionTriggerEnum, Numbers,\r\n\tRegexStrings,\r\n\tRowHeight, SettingInputKeys, SettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\nimport { FormatterEnum, SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IExtendedDataGridColumn, IJsonDatagrid, IPreviousAttributes } from \"ng2/common/model/databearer/components/json-datagrid.model\";\r\nimport type { IJsonGenericDatasource2 } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\nimport type {\r\n\tIColumnOptions,\r\n\tIDatagridApi,\r\n\tIDataGridColumn,\r\n\tIDatagridColumnArgs,\r\n\tIDataGridOptions,\r\n\tIDataGridRow,\r\n\tIDatagridSettings,\r\n} from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\nimport type { IPagerApi } from \"ng2/common/model/sohoxi/sohoxi-pager.model\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport class Datagrid extends Component {\r\n\r\n\tstatic availableRowHeights: IDataPair[] = [\r\n\t\t{ name: \"Small\", value: RowHeight.SHORT },\r\n\t\t{ name: \"Medium\", value: RowHeight.MEDIUM },\r\n\t\t{ name: \"Large\", value: RowHeight.TALL }\r\n\t];\r\n\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic AVAILABE_PAGE_SIZES = [\r\n\t\t{ name: DatagridPageSizesEnum.OPTION1, value: DatagridPageSizesEnum.OPTION1},\r\n\t\t{ name: DatagridPageSizesEnum.OPTION2, value: DatagridPageSizesEnum.OPTION2},\r\n\t\t{ name: DatagridPageSizesEnum.OPTION3, value: DatagridPageSizesEnum.OPTION3},\r\n\t\t{ name: DatagridPageSizesEnum.OPTION4, value: DatagridPageSizesEnum.OPTION4}\r\n\t];\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = [];\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.LIST,\r\n\t\tInteractionPairOperation.CLEAR,\r\n\t];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Show Header\",\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true,\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"List\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Display as List\",\r\n\t\t\tref: SettingKeys.IS_LIST,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Row Height\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Row Height\",\r\n\t\t\tref: SettingKeys.ROW_HEIGHT,\r\n\t\t\tboundarySetting: true,\r\n\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\tdataset: Datagrid.availableRowHeights\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Options\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Keep Selection\",\r\n\t\t\ttooltip: \"Keep previous selected row on reload. (With ION APIs, an object ID is preferred if using this)\",\r\n\t\t\tref: SettingKeys.KEEP_SELECTED,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true\r\n\t\t}, {\r\n\t\t\ttitle: \"Selectable\",\r\n\t\t\ttooltip: \"Enable selection\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true\r\n\t\t}, {\r\n\t\t\ttitle: \"Multi Select\",\r\n\t\t\ttooltip: \"Enable Multi selection\",\r\n\t\t\tref: SettingKeys.MULTI_SELECT,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Toolbar\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Enable Row Count\",\r\n\t\t\tref: SettingKeys.ROW_COUNT,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}, {\r\n\t\t\ttitle: \"Enable Filter Bar\",\r\n\t\t\tref: SettingKeys.FILTER_BAR,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}, {\r\n\t\t\ttitle: \"Enable Export\",\r\n\t\t\tref: SettingKeys.ENABLE_EXPORT,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Paging\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Use Paging\",\r\n\t\t\t\tref: SettingKeys.USE_PAGING,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Items per page\",\r\n\t\t\t\tref: SettingKeys.PAGE_SIZE,\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\tdataset: Datagrid.AVAILABE_PAGE_SIZES,\r\n\t\t\t\tdefaultValue: 25\r\n\t\t\t}\r\n\t\t]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Header\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Selected Item(s)\",\r\n\t\tref: SettingKeys.SELECTED_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Edited Item(s)\",\r\n\t\tref: SettingKeys.DIRTY_ITEMS,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Row Count\",\r\n\t\tref: SettingKeys.ROW_COUNT_OUTPUT,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Summary\",\r\n\t\tref: SettingKeys.SUMMARY_OUTPUT,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\r\n\tprotected databearer: IJsonDatagrid;\r\n\tset isReadonly(value: boolean) {\r\n\t\tthis.databearer.isReadonly = value;\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tset usePaging(value: boolean) {\r\n\t\tthis.databearer.usePaging = value;\r\n\t\tthis.togglePager();\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tset pageSize(value: number) {\r\n\t\tthis.databearer.pageSize = value;\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tset isList(value: boolean) {\r\n\t\tthis.databearer.isList = value;\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tset rowCount(value: boolean) {\r\n\t\tthis.databearer.rowCount = value;\r\n\t\tthis.setRowCountOutput();\r\n\t}\r\n\tget rowCount(): boolean {\r\n\t\treturn this.databearer.rowCount;\r\n\t}\r\n\tset multiSelect(value: boolean) {\r\n\t\tthis.databearer.multiSelect = value;\r\n\t\tthis.toggleMultiSelection();\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\tget multiSelect(): boolean {\r\n\t\treturn this.databearer.multiSelect;\r\n\t}\r\n\r\n\tdatagridOptions: IDataGridOptions<any>;\r\n\tshowDatagrid = true;\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\trowCountOutput: IMap<any>;\r\n\tfilterBar: boolean;\r\n\tenableExport: boolean;\r\n\tpreviousAttributes: IPreviousAttributes;\r\n\tsummaryOutput: IMap<any>;\r\n\r\n\tprivate selectedItem: IMap<any>;\r\n\tprivate dirtyItems: IMap<any>;\r\n\tprivate autocompleteSource: string[];\r\n\tprivate keepSelected: boolean;\r\n\tprivate previousLength: number;\r\n\tprivate selectHandler = (e: JQueryEventObject, args: any) => {\r\n\t\tif (e.target.id === `datagrid-${this.getId()}`) {\r\n\t\t\tthis.onItemSelected(args);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate changeHandler = (e: JQueryEventObject, args: IDatagridColumnArgs<any>) => {\r\n\t\tthis.onItemChanged(args);\r\n\t}\r\n\r\n\tprivate settingsChangedHandler = (e: JQueryEventObject, args: IDatagridSettings) => {\r\n\t\tthis.onSettingsChanged(args);\r\n\t}\r\n\r\n\t/**\r\n\t * MUPS-Refactor-002:\r\n\t * This is most likely our usage of Datagrid which causes issue.\r\n\t * Lots of no needed and duplicate code which does things repeatedly.\r\n\t * Remove this part when datagrid is refactored in future\r\n\t */\r\n\tprivate rerenderTbody = (e: JQueryEventObject, args: IDatagridSettings) => {\r\n\t\tconst datagridApi = this.getSohoXiApi();\r\n\t\tconst pagerInfo = datagridApi.pagerAPI.state;\r\n\r\n\t\tdatagridApi.render(null, pagerInfo);\r\n\t\tdatagridApi.afterPaging(pagerInfo);\r\n\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonDatagrid,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tif (obj) {\r\n\t\t\tthis.keepSelected = obj.keepSelected;\r\n\t\t\tthis.rowCount = obj.rowCount || false;\r\n\t\t\tthis.filterBar = obj.filterBar;\r\n\t\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\t\tthis.enableExport = obj.enableExport || false;\r\n\t\t}\r\n\r\n\t\tthis.initiateDatagridOptions(obj);\r\n\t\tthis.getScope().$on(AngularConstants.DESTROY, () => {\r\n\t\t\tthis.detachEvents();\r\n\t\t});\r\n\t\tthis.initClasses();\r\n\t}\r\n\r\n\tsetBoundarySettingIfChanged<T>(settingId: string): void {\r\n\t\tsuper.setBoundarySettingIfChanged<T>(settingId);\r\n\r\n\t\tif (settingId === SettingKeys.SHOW_LABEL) {\r\n\t\t\tthis.toggleToolbar();\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tonChildrenReady(): void {\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tupdateValuesWithTranslations(): void {\r\n\t\tthis.databearer.columns.forEach((column) => {\r\n\t\t\tconst translatedTitle = this.frameworkService.getTranslatableStringByProperty(this.getId(), column.id);\r\n\r\n\t\t\tif (translatedTitle) {\r\n\t\t\t\tconst globalString = this.frameworkService.getGlobalValue(translatedTitle, this);\r\n\r\n\t\t\t\tif (globalString) {\r\n\t\t\t\t\tcolumn.value = translatedTitle;\r\n\t\t\t\t\tcolumn.name = Helper.htmlEncode(globalString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcolumn.name = Helper.htmlEncode(translatedTitle);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (column.text) {\r\n\t\t\t\tconst translatedCellText =\r\n\t\t\t\t\tthis.frameworkService.getTranslatableStringByProperty(this.getId(), column.id + \"CellText\");\r\n\t\t\t\tif (translatedCellText) {\r\n\t\t\t\t\tcolumn.text = translatedCellText;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.refreshSubstitutions(column);\r\n\t\t});\r\n\r\n\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\tthis.refreshDatagridTriggers();\r\n\t}\r\n\r\n\trefreshDatagrid(): void {\r\n\t\tthis.detachEvents();\r\n\t\tthis.getSohoXiApi().emptyMessage = null; // needs to be removed so it is created and append to DOM again\r\n\t\tthis.showDatagrid = false;\r\n\t\tconst databearer = this.databearer;\r\n\t\tthis.setDatagridOptions(databearer);\r\n\t\tthis.showDatagrid = true;\r\n\t\tthis.updateGrid();\r\n\t\tthis.getSohoXiApi().rowHeight(this.getBoundarySetting<string>(SettingKeys.ROW_HEIGHT));\r\n\t\tthis.attachEvents();\r\n\t\tthis.updateClassesAndStyle();\r\n\t\tthis.setSummaryRowOutput();\r\n\t\tthis.setRowCountOutput();\r\n\t}\r\n\r\n\t/**\r\n\t\t * Set the datagrid options based on IJsonDatagrid\r\n\t\t *\r\n\t\t * @public\r\n\t\t * @param {IJsonDatagrid} datagridBearer\r\n\t\t * @param {boolean} [initial=false]\r\n\t */\r\n\tsetDatagridOptions(datagridBearer: IJsonDatagrid, initial = false): void {\r\n\t\tthis.setColumnSettings();\r\n\t\tconst columnDefinitions: IDataGridColumn[] = angular.copy(datagridBearer.columns);\r\n\t\tconst hasSummaryRow = this.shouldHaveSummaryRow(datagridBearer);\r\n\t\tconst selectType = this.getSelectType(datagridBearer);\r\n\r\n\t\tconst options: IDataGridOptions<any> = {\r\n\t\t\tdataset: initial ? [] : this.datagridOptions.dataset,\r\n\t\t\tcolumns: columnDefinitions,\r\n\t\t\tsaveColumns: initial ? false : this.datagridOptions.saveColumns,\r\n\t\t\trowHeight: this.getBoundarySetting<string>(SettingKeys.ROW_HEIGHT),\r\n\t\t\tisList: datagridBearer.isList,\r\n\t\t\tpaging: datagridBearer.usePaging,\r\n\t\t\t// Give a default of 25 so it won't break\r\n\t\t\tpagesize: datagridBearer.pageSize || Numbers.TWENTYFIVE,\r\n\t\t\tselectable: selectType,\r\n\t\t\teditable: true,\r\n\t\t\tshowDirty: true,\r\n\t\t\tshowSelectAllCheckBox: false,\r\n\t\t\tenableTooltips: true,\r\n\t\t\tsummaryRow: hasSummaryRow, //needs to be true for summary to work on any column, also adds a summaryRow\r\n\t\t\ttoolbar: {\r\n\t\t\t\tresults: datagridBearer.rowCount,\r\n\t\t\t\tkeywordFilter: true\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.datagridOptions = options;\r\n\t\tthis.previousAttributes = {\r\n\t\t\trow: null,\r\n\t\t\tactivePage: null,\r\n\t\t\tsortOrder: null\r\n\t\t};\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.LIST) {\r\n\t\t\tinteractionPromise.then((listResult) => {\r\n\t\t\t\t//Wait on grid element to show\r\n\t\t\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\t\t\tthis.detachEvents();\r\n\t\t\t\t\tthis.datagridOptions.dataset = listResult;\r\n\t\t\t\t\tthis.setSummaryRowOutput();\r\n\t\t\t\t\tthis.setRowCountOutput();\r\n\t\t\t\t\tthis.updateGrid();\r\n\t\t\t\t\tthis.attachEvents();\r\n\r\n\t\t\t\t\tif (listResult.length > 0) {\r\n\t\t\t\t\t\tangular.extend(this.getContext(), listResult[0]);\r\n\t\t\t\t\t\tthis.setSelection();\r\n\t\t\t\t\t\tthis.substituteValues();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, Numbers.TEN);\r\n\t\t\t}).catch(() => {\r\n\t\t\t\tthis.datagridOptions.dataset = [];\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\texport(): void {\r\n\t\tconst options: IDialogOptions<any> = {\r\n\t\t\ttitle: \"Export to file\",\r\n\t\t\ttemplate: require(\"./datagrid-export-dialog.html\"),\r\n\t\t};\r\n\r\n\t\tthis.frameworkService.openComponentDialog(options)\r\n\t\t\t.then((result: IDialogResult<IDatagridExportResult>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tconst api = this.getSohoXiApi();\r\n\t\t\t\t\tswitch (result.value.exportType) {\r\n\t\t\t\t\t\tcase DatagridExportTypes.EXCEL:\r\n\t\t\t\t\t\t\tapi.exportToExcel(result.value.exportName);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase DatagridExportTypes.CSV:\r\n\t\t\t\t\t\t\tapi.exportToCsv(result.value.exportName);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate setSummaryRowOutput(): void {\r\n\t\tthis.summaryOutput = {};\r\n\t\tconst output: any[] = [];\r\n\t\tthis.datagridOptions.columns.forEach((column: IExtendedDataGridColumn) => {\r\n\t\t\tif (column.summarize) {\r\n\t\t\t\toutput.push({\r\n\t\t\t\t\tname: column.name,\r\n\t\t\t\t\tfield: column.field,\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.datagridOptions.dataset.forEach(row => {\r\n\t\t\toutput.forEach(summary => {\r\n\t\t\t\tconst value = row[summary.field];\r\n\t\t\t\tconst parsedValue = value % 1 === 0 ? Number.parseInt(value, 10) : Number.parseFloat(value);\r\n\t\t\t\tif (!isNaN(parsedValue)) {\r\n\t\t\t\t\tsummary.value += parsedValue;\r\n\t\t\t\t\tthis.summaryOutput[summary.name] = summary.value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setRowCountOutput(): void {\r\n\t\tthis.rowCountOutput = {};\r\n\t\tif (this.rowCount && this.datagridOptions) {\r\n\t\t\tthis.rowCountOutput[\"count\"] = this.datagridOptions.dataset.length;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getSelectType(databearer: IJsonDatagrid): SelectableEnum | boolean {\r\n\t\tif (!databearer.isReadonly) {\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\treturn this.databearer.multiSelect ? SelectableEnum.Multiple : SelectableEnum.Single;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate substituteValues(): void {\r\n\t\tfor (let i = 0; i < this.databearer.columns.length; i++) {\r\n\t\t\tconst column = this.databearer.columns[i];\r\n\t\t\tthis.refreshSubstitutions(column);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate refreshSubstitutions(column: IExtendedDataGridColumn): void {\r\n\t\tif (column.substitute) {\r\n\t\t\tconst dataservice = this.frameworkService.getDatasourceObject(column.substituteOptions.source);\r\n\t\t\tif (dataservice) {\r\n\t\t\t\tthis.isLoading = true;\r\n\t\t\t\tdataservice.getListData({}).then((listResult) => {\r\n\t\t\t\t\tconst dropdownOptions: IColumnOptions[] = [];\r\n\t\t\t\t\tlistResult.forEach((listItem, index) => {\r\n\t\t\t\t\t\tdropdownOptions.push({\r\n\t\t\t\t\t\t\tid: \"substituteID\" + index,\r\n\t\t\t\t\t\t\tvalue: listItem[column.substituteOptions.from],\r\n\t\t\t\t\t\t\tlabel: listItem[column.substituteOptions.to]\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tcolumn.options = dropdownOptions;\r\n\t\t\t\t\tcolumn.formatter = Soho.Formatters.Dropdown;\r\n\t\t\t\t\tif (column.substitute && column.formatterName !== FormatterEnum.Dropdown) {\r\n\t\t\t\t\t\tcolumn.cssClass = \"remove-icon\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcolumn.cssClass = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tthis.setErrorTooltip(errorResponse.message);\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateColumns(): void {\r\n\t\tconst columns = this.databearer.columns;\r\n\r\n\t\tif (this.datasource) {\r\n\t\t\tconst outputParameters =\r\n\t\t\t\t(this.datasource.getDatabearer() as IJsonGenericDatasource2).outputParameters;\r\n\r\n\t\t\toutputParameters.forEach(outParam => {\r\n\t\t\t\tconst alias = Helper.isUndefinedEmpty(outParam.alias) ?\r\n\t\t\t\t\toutParam.key : outParam.alias;\r\n\r\n\t\t\t\tconst column = columns.find(column => column.field === outParam.id);\r\n\t\t\t\tif (column) {\r\n\t\t\t\t\tcolumn.name = alias;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.refreshColumns(columns);\r\n\t\tthis.refreshDatagridTriggers();\r\n\t}\r\n\r\n\tprivate moveIndex(): void {\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tconst index = ComponentsHelper.findItemIndexById(listResult, this.selectedItem.id);\r\n\t\tif (isUndefined(index)) {\r\n\t\t\tthis.setErrorTooltip(\"Selection failed, Item ID is not unique.\");\r\n\t\t} else {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t}\r\n\t\tif (isNumber(index) && index !== -1) {\r\n\t\t\tthis.previousAttributes.row = index;\r\n\t\t\tthis.toggleSelected();\r\n\t\t} else if (index) { //if item id does not exists, try to find correct index\r\n\t\t\tconst currentDataLength = listResult.length;\r\n\t\t\tif (this.previousLength < currentDataLength) {\r\n\t\t\t\t//Item added.\r\n\t\t\t\tthis.previousAttributes.row = ComponentsHelper.incrementIndex(\r\n\t\t\t\t\tthis.previousAttributes.row,\r\n\t\t\t\t\tthis.getContext(),\r\n\t\t\t\t\tthis.selectedItem,\r\n\t\t\t\t\tthis.getDatasource()\r\n\t\t\t\t);\r\n\t\t\t\tthis.toggleSelected();\r\n\t\t\t} else if (this.previousLength > currentDataLength) {\r\n\t\t\t\t//item deleted.\r\n\t\t\t\tthis.syncAndDeselectAll();\r\n\t\t\t} else {\r\n\t\t\t\tthis.toggleSelected();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.syncAndDeselectAll();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate toggleSelected(): void {\r\n\t\tconst previousRow = angular.copy(this.previousAttributes.row);\r\n\t\tconst previousPage = angular.copy(this.previousAttributes.activePage);\r\n\t\tconst previousSortOrder = angular.copy(this.previousAttributes.sortOrder);\r\n\r\n\t\tthis.getSohoXiApi().deSelectAllRows();\r\n\t\tif (previousPage && this.databearer.usePaging) {\r\n\t\t\tthis.getPagerApi().setActivePage(previousPage);\r\n\t\t}\r\n\t\tif (previousSortOrder && previousSortOrder.sortId) {\r\n\t\t\tthis.getSohoXiApi().setSortColumn(previousSortOrder.sortId, previousSortOrder.sortAsc);\r\n\t\t}\r\n\t\tthis.getSohoXiApi().selectRow(previousRow, false, false);\r\n\t}\r\n\r\n\tprivate syncAndDeselectAll(clearDirty = true): void {\r\n\t\tthis.selectedItem = null;\r\n\t\tthis.getSohoXiApi().deSelectAllRows();\r\n\t\tthis.getSohoXiApi().syncSelectedRowsIdx();\r\n\r\n\t\tif (clearDirty) {\r\n\t\t\tthis.dirtyItems = null;\r\n\t\t\tthis.getSohoXiApi().clearDirty();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setSelection(): void {\r\n\t\tif (!this.keepSelected || !this.selectedItem || this.multiSelect) {\r\n\t\t\tthis.syncAndDeselectAll();\r\n\t\t} else if (this.selectedItem) {\r\n\t\t\tthis.moveIndex();\r\n\t\t}\r\n\r\n\t\t//MUPS-2736: remove when fixed in IDS\r\n\t\tthis.clearSummaryRow();\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\r\n\t\tif (this.datagridOptions.rowHeight !== this.getBoundarySetting<string>(SettingKeys.ROW_HEIGHT)) {\r\n\t\t\tthis.refreshDatagrid();\r\n\t\t}\r\n\t}\r\n\r\n\tupdateClassesAndStyle(): void {\r\n\t\tsuper.updateClassesAndStyle();\r\n\t}\r\n\r\n\tsetBindableValue(key: string, value: any): void {\r\n\t\tsuper.setBindableValue(key, value);\r\n\t\tif (key === SettingKeys.SHOW_LABEL) {\r\n\t\t\tthis.toggleToolbar();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate toggleToolbar(): void {\r\n\t\tif (this.showLabel) {\r\n\t\t\tthis.getGridElement().addClass(\"has-toolbar\");\r\n\t\t} else {\r\n\t\t\tthis.getGridElement().removeClass(\"has-toolbar\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate togglePager(): void {\r\n\t\tif (!this.databearer.usePaging) {\r\n\t\t\tthis.getGridElement().removeClass(\"paginated\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateGrid(): void {\r\n\t\tif (this.getSohoXiApi()) {\r\n\t\t\tthis.getSohoXiApi().updated(this.datagridOptions);\r\n\t\t}\r\n\t}\r\n\r\n\tgetSohoXiApi(): IDatagridApi {\r\n\t\treturn this.getGridElement().data(\"datagrid\");\r\n\t}\r\n\r\n\tprivate getGridElement(): ng.IAugmentedJQuery {\r\n\t\treturn this.element.find(\"#datagrid-\" + this.getId());\r\n\t}\r\n\r\n\tprivate getPagerApi(): IPagerApi {\r\n\t\treturn this.getSohoXiApi().pagerAPI;\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.datagridOptions.dataset = [];\r\n\t\tthis.refreshDatagrid();\r\n\t}\r\n\r\n\t/**\r\n\t * Initiate the datagrid\r\n\t *\r\n\t * @private\r\n\t * @param {IJsonDatagrid} obj\r\n\t *\r\n\t * @memberof Datagrid\r\n\t */\r\n\tprivate initiateDatagridOptions(obj: IJsonDatagrid): void {\r\n\t\tthis.setDatagridOptions(obj, true);\r\n\t}\r\n\r\n\tprivate refreshColumns(columns: IExtendedDataGridColumn[]): void {\r\n\t\tconst datagridApi = this.getSohoXiApi();\r\n\t\tif (datagridApi) {\r\n\t\t\tdatagridApi.updateColumns(columns);\r\n\t\t\tcolumns = (columns as IExtendedDataGridColumn[]);\r\n\r\n\t\t\t/*\r\n\t\t\tWhen updateColumns is called with an empty columns [] sohoxi.js adds an empty item called blank\r\n\t\t\t\tPossibly a bug in IDS, and should perhaps be reported. Meanwhile this is a temporary fix\r\n\t\t\t*/\r\n\t\t\tconst blankId = columns.findIndex(column => column.id === \"blank\");\r\n\t\t\tif (blankId !== -1) {\r\n\t\t\t\tHelper.removeItemFromListByIndex(columns, blankId);\r\n\t\t\t}\r\n\r\n\t\t\t// Summary Row changes needs to be reflected on datagridOptions\r\n\t\t\tconst summaryRow: boolean = this.shouldHaveSummaryRow(this.databearer);\r\n\t\t\tif (summaryRow !== this.datagridOptions.summaryRow) {\r\n\t\t\t\tthis.datagridOptions.summaryRow = summaryRow;\r\n\t\t\t\tthis.updateGrid();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.datagridOptions.columns = columns;\r\n\r\n\t\t//MUPS-2736: remove when fixed in IDS\r\n\t\tthis.clearSummaryRow();\r\n\t}\r\n\r\n\tprivate setColumnSettings(): void {\r\n\t\tconst locale = this.frameworkService.getCurrentLanguage();\r\n\r\n\t\tfor (let i = 0; i < this.databearer.columns.length; i++) {\r\n\t\t\tconst column = this.databearer.columns[i] as IExtendedDataGridColumn;\r\n\t\t\tDatagridHelper.setEditableOnColumn(column, locale);\r\n\r\n\t\t\tif (column.summarize) {\r\n\t\t\t\tcolumn.summaryRowFormatter = Soho.Formatters.SummaryRow;\r\n\t\t\t\tcolumn.aggregator = GridAggregators.SUM;\r\n\t\t\t}\r\n\r\n\t\t\tif (!Helper.isUndefinedOrNull(column.formatterName)) {\r\n\t\t\t\tDatagridHelper.setColumnSettings(column, locale);\r\n\r\n\t\t\t\tif (column.formatterName === FormatterEnum.Button) {\r\n\t\t\t\t\tthis.addClickEvent(column);\r\n\t\t\t\t} else if (column.formatterName === FormatterEnum.Hyperlink) {\r\n\t\t\t\t\tthis.addHyperlinkEvent(column);\r\n\t\t\t\t} else if (column.formatterName === FormatterEnum.Dropdown ||\r\n\t\t\t\t\tcolumn.formatterName === FormatterEnum.Autocomplete ||\r\n\t\t\t\t\tcolumn.formatterName === FormatterEnum.Lookup) {\r\n\t\t\t\t\tthis.loadOptions(column);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate toggleMultiSelection(): void {\r\n\t\tconst checkboxExists = this.databearer.columns.find(item => item.id === \"selectionCheckbox\");\r\n\t\tif (!checkboxExists && this.databearer.multiSelect) {\r\n\t\t\tconst checkbox = {\r\n\t\t\t\tid: \"selectionCheckbox\",\r\n\t\t\t\tname: \"\",\r\n\t\t\t\tsortable: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\twidth: 50,\r\n\t\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\t\tformatterName: FormatterEnum.SelectionCheckbox,\r\n\t\t\t\talign: \"center\"\r\n\t\t\t};\r\n\t\t\tthis.databearer.columns.unshift(checkbox);\r\n\t\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\t} else if (checkboxExists && !this.databearer.multiSelect) {\r\n\t\t\tthis.databearer.columns.shift();\r\n\t\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addClickEvent(column: IExtendedDataGridColumn): void {\r\n\t\tcolumn.click = (_, rowsSelected: IDataGridRow<any>[]) => {\r\n\t\t\tthis.getSohoXiApi().selectRow(rowsSelected[0].row);\r\n\t\t\tthis.selectedItem = rowsSelected[0].item;\r\n\t\t\tthis.trigger(InteractionTriggerEnum.CLICK + column.id);\r\n\t\t};\r\n\t}\r\n\r\n\tprivate addHyperlinkEvent(column: IExtendedDataGridColumn): void {\r\n\t\tcolumn.click = (_, rowsSelected: IDataGridRow<any>[]) => {\r\n\t\t\tangular.extend(this.getContext(), rowsSelected[0].item);\r\n\t\t\tif (column.hyperlinkOptions && column.hyperlinkOptions.isDrillback) {\r\n\t\t\t\tconst drillbacklink = BackwardCompatible.getHref(rowsSelected[0].item, column);\r\n\t\t\t\tthis.frameworkService.sendDrillbackMessage(drillbacklink);\r\n\t\t\t} else if (column.hyperlinkOptions) {\r\n\t\t\t\tlet hrefString = this.buildLink(column.hyperlinkOptions.value, column.hyperlinkOptions.sources);\r\n\t\t\t\tlet target = \"\";\r\n\t\t\t\tconst isEmail = RegexStrings.EMAIL.test(hrefString);\r\n\r\n\t\t\t\tif (isEmail) {\r\n\t\t\t\t\threfString = \"mailto:\" + hrefString;\r\n\t\t\t\t\ttarget = \"_self\";\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget = \"_blank\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\twindow.open(hrefString, target);\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\t// catch incorrect urls and stop them from throwing an error.\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tprivate attachEvents(): void {\r\n\t\tconst datagridElement = this.getGridElement();\r\n\t\tdatagridElement.on(\"selected\", this.selectHandler);\r\n\t\tdatagridElement.on(\"cellchange\", this.changeHandler);\r\n\t\tdatagridElement.on(\"settingschanged\", this.settingsChangedHandler);\r\n\r\n\t\t/**\r\n\t\t * MUPS-Refactor-002:\r\n\t\t * This is most likely our usage of Datagrid which causes issue.\r\n\t\t * Lots of no needed and duplicate code which does things repeatedly.\r\n\t\t * Remove this part when datagrid is refactored in future\r\n\t\t */\r\n\t\tdatagridElement.on(\"firstpage\", this.rerenderTbody);\r\n\t\tdatagridElement.on(\"nextpage\", this.rerenderTbody);\r\n\t\tdatagridElement.on(\"previouspage\", this.rerenderTbody);\r\n\t\tdatagridElement.on(\"lastpage\", this.rerenderTbody);\r\n\t\tdatagridElement.on(\"pagesizechange\", this.rerenderTbody);\r\n\t}\r\n\r\n\t// Wait for the grid element to render and then remove uneccessery classes\r\n\tprivate initClasses(): void {\r\n\t\tconst checkInterval = 100; // check every 100ms\r\n\t\tconst checkExist = setInterval(() => {\r\n\t\t\tif (this.getGridElement().length > 0) {\r\n\t\t\t\tthis.togglePager();\r\n\t\t\t\tthis.toggleToolbar();\r\n\t\t\t\tclearInterval(checkExist);\r\n\t\t\t}\r\n\t\t}, checkInterval);\r\n\t}\r\n\r\n\tprivate detachEvents(): void {\r\n\t\tconst datagridElement = this.getGridElement();\r\n\t\tdatagridElement.off(\"selected\", this.selectHandler);\r\n\t\tdatagridElement.off(\"cellchange\", this.changeHandler);\r\n\t\tdatagridElement.off(\"settingschanged\", this.settingsChangedHandler);\r\n\r\n\t\t/**\r\n\t\t * MUPS-Refactor-002:\r\n\t\t * This is most likely our usage of Datagrid which causes issue.\r\n\t\t * Lots of no needed and duplicate code which does things repeatedly.\r\n\t\t * Remove this part when datagrid is refactored in future\r\n\t\t */\r\n\t\tdatagridElement.off(\"firstpage\", this.rerenderTbody);\r\n\t\tdatagridElement.off(\"nextpage\", this.rerenderTbody);\r\n\t\tdatagridElement.off(\"previouspage\", this.rerenderTbody);\r\n\t\tdatagridElement.off(\"lastpage\", this.rerenderTbody);\r\n\t\tdatagridElement.off(\"pagesizechange\", this.rerenderTbody);\r\n\t}\r\n\r\n\tprivate onItemSelected(args: any): void {\r\n\t\tif (args && args.length > 0) {\r\n\t\t\tconst newItem = this.updateBindableItem(args);\r\n\r\n\t\t\tif (this.selectedItem !== newItem) {\r\n\t\t\t\tthis.getScope().$evalAsync(() => {\r\n\t\t\t\t\tthis.selectedItem = newItem;\r\n\t\t\t\t\tangular.extend(this.getContext(), newItem);\r\n\t\t\t\t\tthis.previousLength = angular.copy(this.getContext().ListResult.length);\r\n\t\t\t\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\t\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.syncAndDeselectAll(false);\r\n\t\t\tthis.previousAttributes.row = null;\r\n\t\t\tthis.getSohoXiApi().updated();\r\n\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateBindableItem(args: any): IMap<any>|null {\r\n\t\tconst newItem: IMap<any> = {};\r\n\t\tlet listData: any[] = [];\r\n\t\tlet keys: string[] = [];\r\n\t\tif (args && args.length > 0) {\r\n\t\t\tif (args[0].data) {\r\n\t\t\t\tkeys = Object.keys(args[0].data);\r\n\t\t\t\targs.forEach((arg: any) => {\r\n\t\t\t\t\tlistData.push(arg.data);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tkeys = Object.keys(args[0]);\r\n\t\t\t\tlistData = args;\r\n\t\t\t}\r\n\t\t\tlistData.forEach((argData: IMap<any>) => {\r\n\t\t\t\tkeys.forEach((key) => {\r\n\t\t\t\t\tconst data = argData[key];\r\n\t\t\t\t\tconst newData = newItem[key];\r\n\t\t\t\t\tif (key !== \"_selected\") {\r\n\t\t\t\t\t\tif (newData) {\r\n\t\t\t\t\t\t\tnewItem[key] = newData + \"%%\" + data;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tnewItem[key] = data;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewItem[key] = data;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\treturn newItem;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate onItemChanged(args: IDatagridColumnArgs<any>): void {\r\n\t\tconst hasNewValue = args.value !== args.oldValue;\r\n\t\tif (hasNewValue && args.oldValue !== undefined) {\r\n\t\t\tif (this.multiSelect) {\r\n\t\t\t\tconst selectedRows = this.getSohoXiApi().selectedRows();\r\n\t\t\t\tthis.selectedItem = this.updateBindableItem(selectedRows);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setSelectedItem(args);\r\n\t\t\t}\r\n\t\t\tconst dirtyRows = this.getSohoXiApi().dirtyRows();\r\n\t\t\tthis.dirtyItems = this.updateBindableItem(dirtyRows);\r\n\t\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_UPDATED);\r\n\t\t\tthis.trigger(InteractionTriggerEnum.ON_COLUMN_UPDATED + args.column.id);\r\n\t\t}\r\n\t\tthis.datagridOptions.dataset[args.row][args.column.field] = args.value;\r\n\r\n\t\tthis.setSummaryRowOutput();\r\n\t}\r\n\r\n\tprivate onSettingsChanged(args: IDatagridSettings): void {\r\n\t\tthis.previousAttributes.activePage = args.activePage;\r\n\t\tthis.previousAttributes.sortOrder = args.sortOrder;\r\n\t}\r\n\r\n\tprivate setSelectedItem(selectedRow: IDatagridColumnArgs<any>): void {\r\n\t\tthis.selectedItem = angular.copy(selectedRow.rowData);\r\n\r\n\t\tconst column = (selectedRow.column as IExtendedDataGridColumn);\r\n\t\tconst formatterName = column.formatterName;\r\n\r\n\t\tif (!Helper.isUndefinedEmpty(selectedRow.value) &&\r\n\t\t\t(formatterName === FormatterEnum.Date ||\r\n\t\t\tformatterName === FormatterEnum.Time ||\r\n\t\t\tformatterName === FormatterEnum.Datetime)\r\n\t\t) {\r\n\t\t\tconst locale = this.frameworkService.getCurrentLanguage();\r\n\r\n\t\t\tthis.selectedItem[column.field] =\r\n\t\t\t\tDatagridHelper.convertDatetimeToTicks(selectedRow, locale);\r\n\t\t}\r\n\r\n\t\t//MUPS-2736: remove when fixed in IDS\r\n\t\tthis.clearSummaryRow();\r\n\t}\r\n\r\n\tprivate refreshDatagridTriggers(): void {\r\n\t\tDatagrid.SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t\t[\r\n\t\t\t\tInteractionPairOperation.ON_ITEM_CHANGED,\r\n\t\t\t\tInteractionPairOperation.ON_ITEM_UPDATED\r\n\t\t\t]\r\n\t\t);\r\n\t\tif (this.databearer.columns.length > 0) {\r\n\t\t\tthis.databearer.columns.forEach((column) => {\r\n\t\t\t\tif (column.editable) {\r\n\t\t\t\t\tDatagrid.SOURCE_TRIGGERS.push({\r\n\t\t\t\t\t\tname: `On Column Updated (${column.name})`,\r\n\t\t\t\t\t\tvalue: InteractionTriggerEnum.ON_COLUMN_UPDATED + column.id\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (column.formatterName === FormatterEnum.Button) {\r\n\t\t\t\t\t\tDatagrid.SOURCE_TRIGGERS.push({\r\n\t\t\t\t\t\t\tname: `On Button Clicked (${column.name})`,\r\n\t\t\t\t\t\t\tvalue: InteractionTriggerEnum.CLICK + column.id\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadOptions(column: IExtendedDataGridColumn): void {\r\n\t\tconst dataservice = this.frameworkService.getDatasourceObject(column.listOptions.sourceId);\r\n\t\tif (dataservice) {\r\n\t\t\tthis.isLoading = true;\r\n\t\t\tdataservice.getListData({}).then((listResult) => {\r\n\t\t\t\tconst autoData = DatagridHelper.addColumnData(column, listResult, dataservice);\r\n\t\t\t\t// If autocomplete then add source-setting\r\n\t\t\t\tif (column.formatterName === FormatterEnum.Autocomplete) {\r\n\t\t\t\t\tcolumn.editorOptions = { \"source\": this.SOURCE_SETTING };\r\n\t\t\t\t\tthis.autocompleteSource = autoData;\r\n\t\t\t\t}\r\n\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\tthis.setErrorTooltip(errorResponse.message);\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.isLoading = false;\r\n\t\t\t\tthis.refreshColumns(this.databearer.columns);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate SOURCE_SETTING = (request: string, response: Function) => {\r\n\t\tconst matches: string[] = [];\r\n\t\tthis.autocompleteSource.forEach((dataItem) => {\r\n\t\t\tif (dataItem.toLowerCase().indexOf(request.toLowerCase()) !== -1) {\r\n\t\t\t\tmatches.push(dataItem);\r\n\t\t\t}\r\n\t\t});\r\n\t\tresponse(request, matches);\r\n\t}\r\n\r\n\tprivate shouldHaveSummaryRow(databearer: IJsonDatagrid): boolean {\r\n\t\treturn databearer.columns.find((column) => column.summarize) !== undefined;\r\n\t}\r\n\r\n\tprivate clearSummaryRow(): void {\r\n\t\tconst summaryRowCells = this.getGridElement().find(\".datagrid-summary-row > td\");\r\n\t\tif (summaryRowCells && summaryRowCells.length > 0) {\r\n\t\t\tthis.databearer.columns.forEach((column, index) => {\r\n\t\t\t\tif (!column.summarize) {\r\n\t\t\t\t\tconst cell = $(\".datagrid-cell-wrapper\", summaryRowCells[index]);\r\n\t\t\t\t\tif (cell.length > 0) {\r\n\t\t\t\t\t\tcell.remove();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./datagrid.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=datagrid-export-content ng-controller=\\\"eirDatagridExportDialogCtrl as ctrl\\\"> <div class=field> <label class=required for=export-name>Name</label> <input type=text id=export-name name=export-name ng-model=ctrl.exportName> </div> <fieldset class=radio-group> <legend>Type</legend> <input type=radio class=radio name=options id=exportExcel value=excel ng-model=ctrl.exportType /> <label for=exportExcel class=radio-label>Excel</label> <br> <input type=radio class=radio name=options id=exportCsv value=csv ng-model=ctrl.exportType /> <label for=exportCsv class=radio-label>Csv</label> </fieldset> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-click=ctrl.export() ng-disabled=\\\"!ctrl.exportName.length > 0\\\">Export</button> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=ab-datagrid-wrapper> <div class=toolbar role=toolbar ng-hide=!componentInstance.showLabel xi-control=toolbar> <div class=title> <h2 eir-component-value content=componentInstance.label></h2> <span class=datagrid-result-count ng-hide=!componentInstance.rowCount>(N Results)</span> </div> <div class=buttonset> <div class=\\\"searchfield-wrapper toolbar-searchfield-wrapper\\\" ng-hide=!componentInstance.filterBar> <label class=audible for=searchfield-datagrid-{{::component.id}}>Keyword Search</label> <input id=searchfield-datagrid-{{::component.id}} name=searchfield-datagrid-{{::component.id}} class=searchfield data-options=\\\"{ collapsible: true }\\\"/> </div> </div> <button type=button class=btn id=export ng-click=componentInstance.export() ng-if=componentInstance.enableExport> <svg class=icon focusable=false aria-hidden=true role=presentation> <use href=#icon-export-spreadsheet></use> </svg> <span>Export</span> </button> </div> <div id=datagrid-{{::component.id}} ng-if=componentInstance.showDatagrid xi-datagrid=componentInstance.datagridOptions /> </div>\";\n// Exports\nmodule.exports = code;","import { Component } from \"../component\";\r\n\r\nimport {\r\n\tDateFormat,\r\n\tInteractionPairOperation,\r\n\tInteractionTriggerEnum,\r\n\tNumbers,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport { IComponentScope } from \"../../common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { IJsonDatepicker } from \"../../common/model/component/datepicker.model\";\r\nimport { IDatepickerApi, IDatePickerOptions } from \"../../common/model/sohoxi/sohoxi-datepicker.model\";\r\n\r\nimport { DateHelper } from \"ng2/common/helpers/date.helper\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class Datepicker extends Component {\r\n\tstatic availableDateFormats: IDataPair[] = [\r\n\t\t{ name: `${DateFormat.FORMAT_1}`, value: DateFormat.FORMAT_1 },\r\n\t\t{ name: `${DateFormat.FORMAT_2}`, value: DateFormat.FORMAT_2 },\r\n\t\t{ name: `${DateFormat.FORMAT_3}`, value: DateFormat.FORMAT_3 },\r\n\t\t{ name: `ISO8601: ${DateFormat.ISO8601}`, value: DateFormat.ISO8601 },\r\n\t\t{ name: `M3: ${DateFormat.M3}`, value: DateFormat.M3 }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS =\r\n\t\tInteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CHANGED]);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER = InteractionPairOperation.ON_CHANGED;\r\n\tstatic DEFAULT_ACTION = InteractionPairOperation.GET;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t[\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Date Formats\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"To display\",\r\n\t\t\t\t\tref: SettingKeys.DATE_FORMAT_SHOW,\r\n\t\t\t\t\tdataset: Datepicker.availableDateFormats,\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: DateFormat.FORMAT_1\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"For bindings (outbound)\",\r\n\t\t\t\t\tref: SettingKeys.DATE_FORMAT_BINDING,\r\n\t\t\t\t\tdataset: Datepicker.availableDateFormats.concat([\r\n\t\t\t\t\t\t{ name: \"Raw timestamp\", value: DateFormat.RAW }\r\n\t\t\t\t\t]),\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: DateFormat.FORMAT_1\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"For bindings (inbound)\",\r\n\t\t\t\t\tref: SettingKeys.DATE_FORMAT_INPUT,\r\n\t\t\t\t\tdataset: [{ name: \"Automatic\", value: DateFormat.AUTOMATIC }].concat(\r\n\t\t\t\t\t\tDatepicker.availableDateFormats\r\n\t\t\t\t\t),\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\tdefaultValue: DateFormat.AUTOMATIC\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Default Date\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Today's date\",\r\n\t\t\t\t\tref: SettingKeys.DATE_TODAY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t...Component.SETTING_FIELDS\r\n\t\t];\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Date\",\r\n\t\tref: SettingKeys.DATE_VALUE,\r\n\t\tvalueType: ValueTypeEnum.STRING, // Ideally this would be type DATE\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Formatted date\",\r\n\t\tref: SettingKeys.DATE_FORMATTED,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\r\n\tstatic MAX_TIMESTAMP = 8640000000000000;\r\n\tstatic MIN_TIMESTAMP = -8640000000000000;\r\n\r\n\t// Variables set from binding framework\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tdateValue: Date | null;\r\n\tdateFormatted: string = \"\";\r\n\r\n\t// Variables set from settings framework\r\n\tdateFormatShow: string;\r\n\tdateFormatBinding: string;\r\n\tdateFormatInput: string;\r\n\tisDefaultTodayDate: boolean;\r\n\r\n\t// Variables used in template\r\n\tdatepickerOptions: IDatePickerOptions;\r\n\r\n\tdatePickerApi: IDatepickerApi;\r\n\tisStaticSet: boolean;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonDatepicker,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tthis.dateFormatShow = obj.dateFormatShow;\r\n\t\tthis.dateFormatBinding = obj.dateFormatBinding;\r\n\t\tthis.dateFormatInput = obj.dateFormatInput;\r\n\t\tthis.isDefaultTodayDate = obj.isDefaultTodayDate;\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\r\n\t\tthis.setDatepickerOptions();\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t}\r\n\r\n\tsetDatepickerOptions(): void {\r\n\t\tthis.datepickerOptions = {\r\n\t\t\tdateFormat: this.dateFormatShow,\r\n\t\t\tplaceholder: true\r\n\t\t};\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.getSohoXiApi().setValue(undefined, true);\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, value: any): void {\r\n\t\tif (bindableReference === SettingKeys.DATE_VALUE) {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t\tif (value === \"\") {\r\n\t\t\t\tthis.isStaticSet = false;\r\n\t\t\t\tthis.updateDatepickerValue();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst newDate = this.parseDate(value);\r\n\t\t\tif (DateHelper.isValidDate(newDate)) {\r\n\t\t\t\tthis.isStaticSet = true;\r\n\t\t\t\tthis.updateDatepickerValue(newDate);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setErrorTooltip(`Invalid date: '${value}'`);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Set dateValue to newDate, or clear dateValue if newDate is falsy\r\n\t * @param newDate The new date to set, should already be valid.\r\n\t */\r\n\tsetDateValue(newDate?: Date): void {\r\n\t\tif (newDate) {\r\n\t\t\tthis.dateValue = newDate;\r\n\t\t\tif (this.dateFormatBinding === DateFormat.RAW) {\r\n\t\t\t\t// Keeping string format, change when we specially handle different value types in binding framework\r\n\t\t\t\tthis.dateFormatted = this.dateValue.getTime().toString();\r\n\t\t\t} else {\r\n\t\t\t\tthis.dateFormatted = Soho.Locale.formatDate(this.dateValue, { pattern: this.dateFormatBinding });\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.dateValue = undefined;\r\n\t\t\tthis.dateFormatted = \"\";\r\n\t\t}\r\n\t\tthis.onUpdateValue();\r\n\t}\r\n\r\n\tupdateDatepickerValue(newDate?: Date): void {\r\n\t\tconst datepickerApi = this.getSohoXiApi();\r\n\t\tdatepickerApi.settings.dateFormat = this.datepickerOptions.dateFormat;\r\n\t\tdatepickerApi.pattern = this.datepickerOptions.dateFormat;\r\n\t\tif (this.isStaticSet) {\r\n\t\t\tconst value = newDate ? newDate : this.dateValue;\r\n\t\t\tdatepickerApi.setValue(value, true);\r\n\t\t} else if (this.isDefaultTodayDate) {\r\n\t\t\tdatepickerApi.setToday();\r\n\t\t} else {\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeDatepicker(): void {\r\n\t\tconst datepickerApi = this.getSohoXiApi();\r\n\t\tthis.updateDatepickerReadonlyValue();\r\n\t\tdatepickerApi.element.on(\"change\", () => {\r\n\t\t\t// Parsing date because soho is not updating the currentDate when editing the field\r\n\t\t\tconst newDate = Soho.Locale.parseDate(datepickerApi.element.val().toString(), this.dateFormatShow);\r\n\t\t\tif (newDate) { // If not valid date soho will show invalid date error\r\n\t\t\t\tthis.setDateValue(newDate);\r\n\t\t\t\tthis.frameworkService.trigger(this, InteractionTriggerEnum.CHANGED);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setDateValue();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdatepickerApi.element.on(\"listopened\", () => {\r\n\t\t\tthis.addPreventDefault();\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Really nasty fix for interupting href in anchor tags.\r\n\t * Remove this when IDS has an update on\r\n\t * Solved in IDS 4.21\r\n\t */\r\n\tprivate addPreventDefault(): void {\r\n\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\tconst ulPath = \".picklist-section.is-year ul \";\r\n\t\t\t$(ulPath + \"li a\").click((e: any) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t});\r\n\t\t\t$(ulPath + \".up,\" + ulPath + \".down\").click((e: any) => {\r\n\t\t\t\tthis.addPreventDefault();\r\n\t\t\t});\r\n\t\t}, Numbers.THREE_HUNDRED);\r\n\t}\r\n\r\n\tupdateDatepickerReadonlyValue(): void {\r\n\t\tconst datepickerApi = this.getSohoXiApi();\r\n\t\tif (this.isReadonly) {\r\n\t\t\tdatepickerApi.readonly();\r\n\t\t} else {\r\n\t\t\tdatepickerApi.enable();\r\n\t\t}\r\n\t}\r\n\r\n\tgetSohoXiApi(): IDatepickerApi {\r\n\t\tif (!this.datePickerApi) {\r\n\t\t\tthis.datePickerApi = this.element.find(\"> div > input\").data(\"datepicker\");\r\n\t\t}\r\n\t\treturn this.datePickerApi;\r\n\t}\r\n\r\n\tprivate parseDate(value: any): Date | null {\r\n\t\tlet newDate: Date = null;\r\n\t\tif (typeof value === \"string\" && this.dateFormatInput !== DateFormat.AUTOMATIC) {\r\n\t\t\tnewDate = Soho.Locale.parseDate(value, this.dateFormatInput);\r\n\t\t} else { // DateFormat.AUTOMATIC\r\n\t\t\tnewDate = this.parseDateFormatAutomatic(value);\r\n\t\t}\r\n\t\treturn newDate;\r\n\t}\r\n\r\n\tprivate parseDateFormatAutomatic(value: any): Date {\r\n\t\tconst timestamp = new Date(value);\r\n\r\n\t\tif (!DateHelper.isValidDate(timestamp)) {\r\n\t\t\tconst milliseconds = DateHelper\r\n\t\t\t\t.parse(value)\r\n\t\t\t\t.getTime();\r\n\r\n\t\t\tif (!isNaN(milliseconds) &&\r\n\t\t\t\tDateHelper.isValidMillisecondTimestamp(milliseconds)\r\n\t\t\t) {\r\n\t\t\t\treturn new Date(milliseconds);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn timestamp;\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./datepicker.html\"),\r\n\t\t\treplace: true,\r\n\t\t\tlink: ($scope: IComponentScope, $element: ng.IAugmentedJQuery, $attrs: ng.IAttributes) => {\r\n\t\t\t\tconst componentInstance = $scope.componentInstance as Datepicker;\r\n\r\n\t\t\t\t$($element[0]).initialize(\"en-US\");\r\n\t\t\t\tcomponentInstance.initializeDatepicker();\r\n\r\n\t\t\t\t$scope.componentReady({ componentInstance: $scope.componentInstance });\r\n\t\t\t}\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=field> <label for=date-field-{{component.id}} class=label ng-show=componentInstance.showLabel eir-component-value content=componentInstance.label> </label> <input id=date-field-{{component.id}} class=datepicker type=text data-disable-validation=true xi-datepicker=componentInstance.datepickerOptions /> </div> \";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport cloneDeep from \"lodash-es/cloneDeep\";\r\nimport isNumber from \"lodash-es/isNumber\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport { Helper } from \"../../common/helper\";\r\nimport type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { ISohoDropdown } from \"../../common/model/sohoxi/sohoxi-dropdown.model\";\r\nimport { Component } from \"../component\";\r\nimport { ComponentsHelper } from \"../helper\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tInteractionActionEnum, InteractionPairOperation,\r\n\tInteractionTriggerEnum, SettingInputKeys,\r\n\tSettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonDropdown, IStaticValueDropdown } from \"ng2/common/model/databearer/components/json-dropdown.model\";\r\nimport type { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteractionParameter } from \"ng2/common/model/interaction/interaction-parameter.model\";\r\nimport type{ IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport interface ICurrentItem extends IMap<any> { }\r\n\r\nexport class Dropdown extends Component {\r\n\tstatic AVAILABLE_WIDTHS: IDataPair[] = [\r\n\t\t{ name: \"Small\", value: \"input-sm\" },\r\n\t\t{ name: \"Medium\", value: \"input-mm\" },\r\n\t\t{ name: \"Large\", value: \"input-default\" }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.LIST,\r\n\t\tInteractionPairOperation.SET_CURRENT_ITEM,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic SETTING_FIELDS =\r\n\t\t([\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Options\",\r\n\t\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Keep Selection\",\r\n\t\t\t\t\ttooltip: \"Keep previous selected item on reload. (With ION APIs, an object ID is preferred if using this)\",\r\n\t\t\t\t\tref: SettingKeys.KEEP_SELECTED,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Disabled\",\r\n\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Width\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.BOX_WIDTH,\r\n\t\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\t\tdataset: Dropdown.AVAILABLE_WIDTHS,\r\n\t\t\t\t\tdefaultValue: \"input-default\",\r\n\t\t\t\t}]\r\n\t\t\t}\r\n\t\t] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Selected Item\",\r\n\t\tref: SettingKeys.CURRENT_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Display Value\",\r\n\t\tref: SettingKeys.DISPLAY_VALUE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}\r\n\t];\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tcurrentItem: ICurrentItem;\r\n\tdisplayValue: IJsonValueSource;\r\n\tcurrentItemIndex: number;\r\n\temptyValue: IStaticValueDropdown[];\r\n\tboxWidth: string;\r\n\tprotected databearer: IJsonDropdown;\r\n\tprivate keepSelected: boolean;\r\n\tprivate previousLength: number;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonDropdown,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tif (obj) {\r\n\t\t\tthis.keepSelected = obj.keepSelected;\r\n\t\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\t}\r\n\t\tthis.currentItemIndex = 0;\r\n\t\t//Static default value\r\n\t\tthis.emptyValue = [{\r\n\t\t\tvalue: 0,\r\n\t\t\tlabel: \"\"\r\n\t\t}];\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\tthis.setBoundarySettingIfChanged<string>(SettingKeys.BOX_WIDTH);\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.currentItemIndex = 0;\r\n\t\tthis.currentItem = null;\r\n\t\tthis.setSelection();\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param currentItem\r\n\t * Update current Item and trigger on item changed event.\r\n\t * This also triggers when the dropdown is bound to a list of data and a new selection is made.\r\n\t * This will not trigger on same data due to angular ng-change.\r\n\t */\r\n\tsetCurrentItem(currentItem: ICurrentItem): void {\r\n\t\tthis.updateCurrentItem(currentItem);\r\n\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\t}\r\n\r\n\tprivate updateCurrentItem(newCurrentItem: ICurrentItem): void {\r\n\t\tthis.currentItem = newCurrentItem;\r\n\t\tangular.extend(this.getContext(), newCurrentItem);\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tif (listResult.length > 0) {\r\n\t\t\tthis.currentItemIndex = listResult.findIndex((item) => {\r\n\t\t\t\treturn item === newCurrentItem;\r\n\t\t\t});\r\n\t\t\tthis.previousLength = angular.copy(listResult.length);\r\n\t\t}\r\n\t\tthis.setPseudoElemDisplayText();\r\n\t}\r\n\r\n\tprivate onListUpdated(): void {\r\n\t\tconst firstItem = this.getContext().ListResult[0];\r\n\t\tif (firstItem) {\r\n\t\t\tthis.setCurrentItem(firstItem);\r\n\t\t} else {\r\n\t\t\tthis.setPseudoElemDisplayText(\"\");\r\n\t\t}\r\n\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\tif (bindableReference === SettingKeys.DISPLAY_VALUE &&\r\n\t\t\tthis.currentItem && this.databearer.displayValue.sourceKey\r\n\t\t) {\r\n\t\t\tthis.setPseudoElemDisplayText();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setPseudoElemDisplayText(\r\n\t\ttext: string = this.currentItem[this.databearer.displayValue.sourceKey]\r\n\t): void {\r\n\t\tconst dropdown = this.getSoHoDropdown();\r\n\t\tif (dropdown) {\r\n\t\t\tdropdown.pseudoElem.find(\"span\").text(text);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getSoHoDropdown(): ISohoDropdown {\r\n\t\treturn this.element.find(\"#\" + this.getId() + \"select\").data(\"dropdown\") as ISohoDropdown;\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tlet interactionPromise: ng.IPromise<any | any[]>;\r\n\t\tswitch (interaction.targetActionName) {\r\n\t\t\tcase InteractionActionEnum.LIST:\r\n\t\t\t\tinteractionPromise = super.loadInteraction(interaction);\r\n\t\t\t\tinteractionPromise.then((listResult) => {\r\n\t\t\t\t\tthis.getContext().ListResult = cloneDeep(listResult);\r\n\t\t\t\t\tthis.trigger(InteractionTriggerEnum.ON_LOAD);\r\n\t\t\t\t\tthis.setSelection();\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase InteractionActionEnum.SET_CURRENT_ITEM:\r\n\t\t\t\tinteractionPromise = this.executeSetSelectedItemAction(interaction.getParameters());\r\n\t\t\t\tinteractionPromise.then((newValue) => {\r\n\t\t\t\t\tif (newValue) {\r\n\t\t\t\t\t\tthis.setCurrentItem(newValue);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.onListUpdated();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tinteractionPromise = super.loadInteraction(interaction);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tprivate setSelection(): void {\r\n\t\tif (!this.currentItem || !this.keepSelected) {\r\n\t\t\tthis.onListUpdated();\r\n\t\t} else {\r\n\t\t\tthis.moveIndex();\r\n\t\t}\r\n\t}\r\n\r\n\t// needed to maintain right index when adding or deleting items in the dropdown\r\n\tprivate moveIndex(): void {\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tconst index = ComponentsHelper.findItemIndexById(listResult, this.currentItem.id);\r\n\t\tif (isUndefined(index)) {\r\n\t\t\tthis.setErrorTooltip(\"Selection failed, Item ID is not unique.\");\r\n\t\t} else {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t}\r\n\r\n\t\tif (isNumber(index) && index !== -1) {\r\n\t\t\tthis.currentItemIndex = index;\r\n\t\t\tthis.currentItem = listResult[this.currentItemIndex];\r\n\t\t} else if (index) { //if item id does not exists, try to find correct index\r\n\t\t\tif (this.previousLength < listResult.length) {\r\n\t\t\t\t//Item added.\r\n\t\t\t\tthis.currentItemIndex = ComponentsHelper.incrementIndex(\r\n\t\t\t\t\tthis.currentItemIndex,\r\n\t\t\t\t\tthis.getContext(),\r\n\t\t\t\t\tthis.currentItem,\r\n\t\t\t\t\tthis.getDatasource()\r\n\t\t\t\t);\r\n\t\t\t\tthis.currentItem = listResult[this.currentItemIndex];\r\n\t\t\t} else if (this.previousLength > listResult.length) {\r\n\t\t\t\t//item deleted.\r\n\t\t\t\tthis.onListUpdated();\r\n\t\t\t} else {\r\n\t\t\t\t//Toggle selected\r\n\t\t\t\tthis.currentItem = listResult[this.currentItemIndex];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.onListUpdated();\r\n\t\t}\r\n\t\tthis.setPseudoElemDisplayText();\r\n\t}\r\n\r\n\tprivate executeSetSelectedItemAction(parameters: IInteractionParameter[]): ng.IPromise<any> {\r\n\t\tthis.setErrorTooltip();\r\n\t\tconst interactionDeferred = this.frameworkService.getNewDeferred<any | any[]>();\r\n\t\tconst context = this.getContext();\r\n\t\tif (context.ListResult) {\r\n\t\t\tlet possibleItems = context.ListResult;\r\n\t\t\tparameters.forEach((parameter) => {\r\n\t\t\t\tconst valueToFind = this.frameworkService.readValueSource(parameter.valueSource, context);\r\n\t\t\t\tpossibleItems = possibleItems.filter((listItem) => {\r\n\t\t\t\t\tconst actualValue = listItem[parameter.targetKey];\r\n\t\t\t\t\treturn Helper.trimIfPossible(actualValue) === Helper.trimIfPossible(valueToFind); // Trim to fix MI problem\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tif (possibleItems.length === 1) {\r\n\t\t\t\tinteractionDeferred.resolve(possibleItems[0]);\r\n\t\t\t\tthis.removeEmptyValue();\r\n\t\t\t} else if (possibleItems.length > 1) {\r\n\t\t\t\tthis.setErrorTooltip(\"Unable to select: Multiple items match\");\r\n\t\t\t\tthis.setEmptyValue();\r\n\t\t\t} else {\r\n\t\t\t\tthis.setErrorTooltip(\"Unable to select: No items match\");\r\n\t\t\t\tthis.setEmptyValue();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.setErrorTooltip(\"Unable to select: No items to select\");\r\n\t\t}\r\n\t\tinteractionDeferred.resolve();\r\n\t\treturn interactionDeferred.promise;\r\n\t}\r\n\r\n\tprivate setEmptyValue(): void {\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tif (listResult[0] !== this.emptyValue) {\r\n\t\t\tlistResult.unshift(this.emptyValue);\r\n\t\t}\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\tprivate removeEmptyValue(): void {\r\n\t\tconst listResult = this.getContext().ListResult;\r\n\t\tif (listResult[0] === this.emptyValue) {\r\n\t\t\tlistResult.shift();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./dropdown.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=\\\"dropdown-container {{componentInstance.boxWidth}}\\\"> <label ng-attr-for=\\\"{{::component.id + 'select'}}\\\" ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label></label> <select ng-attr-id=\\\"{{::component.id + 'select'}}\\\" class=dropdown ng-model=componentInstance.currentItemIndex ng-disabled=componentInstance.isReadonly ng-options=\\\"context.ListResult.indexOf(value) as value[component.displayValue.sourceKey] for value in context.ListResult\\\" ng-change=componentInstance.setCurrentItem(context.ListResult[componentInstance.currentItemIndex]) xi-drop-down></select> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=childCage ng-class=\\\"{ 'vertical': componentInstance.orientation === 2, 'flex-parent': componentInstance.isFlexParent}\\\" ng-style=componentInstance.styleOptions> <eir-children class={{componentInstance.childrenClasses}} parent=componentInstance children-ready=onChildrenReady()> </eir-children> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { Helper } from \"../../common/helper\";\r\nimport type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { IJsonHyperlink, ISourceItem } from \"../../common/model/component/hyperlink.model\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tBindingTypes, DirectionType, InteractionPairOperation, InteractionTriggerEnum,\r\n\tSettingInputKeys, SettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField, IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport class Hyperlink extends Component {\r\n\tstatic availableDirectionTypes: IDataPair[] = [\r\n\t\t{ name: \"None\", value: DirectionType.NONE },\r\n\t\t{ name: \"Back\", value: DirectionType.BACK },\r\n\t\t{ name: \"Forward\", value: DirectionType.DIRECTIONAL }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] =\r\n\t\tInteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CLICK]);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_CLICK;\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Link Name\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t},\r\n\t{\r\n\t\tname: \"Link Value\",\r\n\t\tref: \"renderedLink\",\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}];\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t([{\r\n\t\t\ttitle: \"Style\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Disabled\",\r\n\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t}\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Caret\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.DIRECTION,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Hyperlink.availableDirectionTypes,\r\n\t\t\t\tdefaultValue: DirectionType.NONE\r\n\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Link Value\",\r\n\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\tsettings:\r\n\t\t\t[\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Address\",\r\n\t\t\t\t\tref: SettingKeys.LINK_VALUE,\r\n\t\t\t\t\tinputType: SettingInputKeys.TEXT,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-compose\",\r\n\t\t\t\t\t\ttooltip: \"Build link\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdefaultValue: \"https://\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Use as Drillback\",\r\n\t\t\t\t\tref: SettingKeys.IS_DRILLBACK,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tcontent: string;\r\n\trenderedLink: string;\r\n\tdirection: string;\r\n\tsources: ISourceItem[] = [];\r\n\tlink: string;\r\n\tisDrillback: boolean;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonHyperlink,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, element, parent, frameworkService);\r\n\r\n\t\tthis.direction = obj.direction;\r\n\t\tthis.link = obj.link;\r\n\t\tthis.isDrillback = obj.isDrillback;\r\n\t\tif (obj.sources) {\r\n\t\t\tthis.sources = obj.sources;\r\n\t\t}\r\n\t}\r\n\r\n\tsetBindableValue(bindableRef: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableRef, value);\r\n\t\tif (this.sources) {\r\n\t\t\tconst mySource = this.sources.find((source) => {\r\n\t\t\t\treturn source.alias === bindableRef;\r\n\t\t\t});\r\n\t\t\tif (mySource) {\r\n\t\t\t\tthis.renderURL();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tif (this.sources) {\r\n\t\t\tthis.sources.forEach((source) => {\r\n\t\t\t\tconst valueSourceObject: IJsonValueSource = {\r\n\t\t\t\t\tType: BindingTypeEnum.BINDING,\r\n\t\t\t\t\tsourceKey: source.value,\r\n\t\t\t\t\tsourceName: source.type\r\n\t\t\t\t};\r\n\t\t\t\tthis.frameworkService.registerBinding(this, source.alias, valueSourceObject, null);\r\n\t\t\t});\r\n\t\t\tthis.renderURL();\r\n\t\t}\r\n\t}\r\n\r\n\tonLinkClick(): void {\r\n\t\tif (this.isDrillback) {\r\n\t\t\tthis.frameworkService.sendDrillbackMessage(this.renderedLink);\r\n\t\t} else {\r\n\t\t\tthis.frameworkService.openWindow(this.renderedLink);\r\n\t\t}\r\n\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\t}\r\n\r\n\trenderURL(): void {\r\n\t\tthis.renderedLink = this.buildLink(this.link, this.sources);\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./hyperlink.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div> <a class=\\\"hyperlink {{componentInstance.direction}} hide-focus\\\" ng-click=componentInstance.onLinkClick() ng-disabled=componentInstance.isReadonly> <svg role=presentation aria-hidden=true focusable=false class=icon ng-if=\\\"componentInstance.direction == 'back'\\\"> <use xlink:href=#icon-caret-left /> </svg> <span class=hyperlink-content eir-component-value content=componentInstance.content></span> <svg role=presentation aria-hidden=true focusable=false class=icon ng-if=\\\"componentInstance.direction == 'directional'\\\"> <use xlink:href=#icon-caret-right /> </svg> </a> </div>\";\n// Exports\nmodule.exports = code;","import { Helper } from \"../../common/helper\";\r\nimport type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { IJsonImage } from \"../../common/model/component/image.model\";\r\nimport { Component } from \"../component\";\r\nimport { ComponentsHelper } from \"../helper\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tImageBase64, ImagePositions,\r\n\tInteractionPairOperation, InteractionTriggerEnum, SettingInputKeys, SettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nexport class Image extends Component {\r\n\tstatic availablePositionTypes: IDataPair[] = [\r\n\t\t{ name: \"Fill\", value: ImagePositions.FILL },\r\n\t\t{ name: \"Fit\", value: ImagePositions.FIT },\r\n\t\t{ name: \"Center\", value: ImagePositions.CENTER }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CLICK]);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([\r\n\t\t{\r\n\t\t\ttitle: \"Position\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.POSITION,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: Image.availablePositionTypes,\r\n\t\t\t\tdefaultValue: ImagePositions.CENTER\r\n\t\t\t}]\r\n\t\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Source\",\r\n\t\tref: SettingKeys.SOURCE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tposition: string;\r\n\tsource: any;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonImage,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tif (obj) {\r\n\t\t\tthis.position = obj.position;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setImageSource(newValue: Blob | string): void {\r\n\t\tif (newValue instanceof Blob) {\r\n\t\t\tthis.source = (window.URL || window.webkitURL).createObjectURL(newValue);\r\n\t\t} else if (typeof newValue === \"string\" && this.getContext().DetailResult) {\r\n\t\t\t// e.g. \tnewValue http://{replaceValue}/\r\n\t\t\t// \t\tDetailResult: {replaceValue: Value}\r\n\t\t\tthis.source = Helper.stringReplace(newValue, this.getContext().DetailResult);\r\n\t\t} else if (typeof newValue === \"string\" && newValue.length > 0) {\r\n\t\t\tif (newValue.indexOf(\"http\") === 0) {\r\n\t\t\t\tthis.setImageFromUrlToSource(newValue);\r\n\t\t\t} else if (ComponentsHelper.isBase64(newValue)) {\r\n\t\t\t\tthis.source = Helper.parseBase64(newValue);\r\n\t\t\t} else {\r\n\t\t\t\tthis.source = newValue;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.source = ImageBase64.DEFAULT;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setImageFromUrlToSource(url: string): void {\r\n\t\tconst result: string = this.cache.get(url);\r\n\r\n\t\tif (Helper.isUndefined(result)) {\r\n\t\t\tthis.frameworkService.convertImageUrlToBase64(url)\r\n\t\t\t\t.then(base64result => this.source = base64result)\r\n\t\t\t\t.then(() => this.cache.put(url, this.source))\r\n\t\t\t\t.then(() => this.setErrorTooltip())\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tthis.setErrorTooltip(error.message);\r\n\t\t\t\t\tthis.source = ImageBase64.DEFAULT;\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.source = result;\r\n\t\t}\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tinteractionPromise.catch(() => {\r\n\t\t\tthis.source = ImageBase64.DEFAULT;\r\n\t\t});\r\n\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, newValue: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, newValue);\r\n\t\tif (bindableReference === SettingKeys.SOURCE) {\r\n\t\t\tthis.setImageSource(newValue);\r\n\t\t}\r\n\t}\r\n\r\n\tclick(): void {\r\n\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./image.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=\\\"image img-{{component.position}}\\\" ng-if=componentInstance.source ng-style=\\\"{'background-image':'url('+componentInstance.source+')'}\\\" ng-click=componentInstance.click()> </div> \";\n// Exports\nmodule.exports = code;","import type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\n\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport { colors } from \"ng2/common/constants/colors.constant\";\r\nimport {\r\n\tInteractionPairOperation,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonLabel } from \"ng2/common/model/databearer/components/json-label.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nexport class Label extends Component {\r\n\tstatic availableStyles = [\r\n\t\t{ name: \"Default\", value: \"default\" },\r\n\t\t{ name: \"Paragraph\", value: \"paragraph\" },\r\n\t\t{ name: \"Small Heading\", value: \"small-heading\" },\r\n\t\t{ name: \"Medium Heading\", value: \"medium-heading\" },\r\n\t\t{ name: \"Large Heading\", value: \"large-heading\" },\r\n\t\t{ name: \"Size 10 - Uppercase\", value: \"font-size-px-10\" },\r\n\t\t{ name: \"Size 12 - Uppercase\", value: \"font-size-px-12\" },\r\n\t\t{ name: \"Size 14\", value: \"font-size-px-14\" },\r\n\t\t{ name: \"Size 16\", value: \"font-size-px-16\" },\r\n\t\t{ name: \"Size 20\", value: \"font-size-px-20\" },\r\n\t\t{ name: \"Size 24\", value: \"font-size-px-24\" },\r\n\t\t{ name: \"Size 28\", value: \"font-size-px-28\" },\r\n\t\t{ name: \"Size 32\", value: \"font-size-px-32\" },\r\n\t\t{ name: \"Size 40\", value: \"font-size-px-40\" },\r\n\t\t{ name: \"Size 48\", value: \"font-size-px-48\" },\r\n\t\t{ name: \"Size 60\", value: \"font-size-px-60\" },\r\n\t\t{ name: \"Size 72\", value: \"font-size-px-72\" },\r\n\t];\r\n\r\n\tstatic availableCharacteristics = [\r\n\t\t{ name: \"Default\", value: \"\" },\r\n\t\t{ name: \"Descriptive\", value: \"text-descriptive\" },\r\n\t\t{ name: \"Link\", value: \"text-link\" },\r\n\t\t{ name: \"Muted\", value: \"text-muted\" },\r\n\t\t{ name: \"Alert\", value: \"text-alert\"},\r\n\t\t{ name: \"Emphasis\", value: \"text-emphasis\" },\r\n\t\t{ name: \"Strong\", value: \"text-strong\"}\r\n\t];\r\n\r\n\tstatic availableColors = [\r\n\t\t{ name: \"Default\", value: \"default\" },\r\n\t\t{ name: \"Light White\", value: \"rgba(255,255,255,0.5)\" },\r\n\t\t{ name: \"Medium White\", value: \"rgba(255,255,255,0.75)\" },\r\n\t\t{ name: \"Strong White\", value: \"#fff\" },\r\n\t\t{ name: \"Light Gray\", value: \"rgba(26,26,26,0.5)\" },\r\n\t\t{ name: \"Medium Gray\", value: \"rgba(26,26,26,0.75)\" },\r\n\t\t{ name: \"Strong Gray\", value: colors.graphite10 }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([\r\n\t\t{\r\n\t\t\ttitle: \"Typography\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.FONT_STYLE,\r\n\t\t\t\ttitle: \"Font Style\",\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\tdataset: Label.availableStyles,\r\n\t\t\t\tdefaultValue: Label.availableStyles[0].value,\r\n\t\t\t}, {\r\n\t\t\t\tref: SettingKeys.FONT_CHAR,\r\n\t\t\t\ttitle: \"Font Characteristic\",\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\tdataset: Label.availableCharacteristics,\r\n\t\t\t\tdefaultValue: Label.availableCharacteristics[0].value,\r\n\t\t\t\ttooltip: \"Note that you can only change the text color if the text has the following characteristics: Default, Strong or Emphasis.\"\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Color\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tref: SettingKeys.COLOR,\r\n\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\tdataset: Label.availableColors,\r\n\t\t\t\tdefaultValue: Label.availableColors[0].value,\r\n\t\t\t}]\r\n\t\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] =\r\n\t[{\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.CONTENT,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Tooltip\",\r\n\t\tref: SettingKeys.TOOLTIP,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tcontent: string;\r\n\ttoolTip: string;\r\n\tfontStyle: string;\r\n\tfontChar: string;\r\n\tcolor: string;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonLabel,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tif (obj) {\r\n\t\t\tthis.fontStyle = obj.fontStyle;\r\n\t\t\tthis.fontChar = obj.fontChar ? obj.fontChar : \"\";\r\n\t\t\tthis.color = obj.color;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./label.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","export const colors = {\r\n\t// --------------------------------------------------------\r\n\t// Variables\r\n\t// --------------------------------------------------------\r\n\t// 1. Colors\r\n\tcomponentNameBackgroundColor: \"#1d5f8a\",\r\n\t// --------------------------------------------------------\r\n\t// 1. Colors\r\n\t// From SohoXi Color Scheme\r\n\r\n\tazure01: \"#c8e9f4\",\r\n\tazure02: \"#addbeb\",\r\n\tazure03: \"#8dc9e6\",\r\n\tazure04: \"#69b5dd\",\r\n\tazure05: \"#54a1d3\",\r\n\tazure06: \"#368ac0\",\r\n\tazure07: \"#2578a9\",\r\n\tazure08: \"#1d5f8a\",\r\n\tazure09: \"#134d71\",\r\n\tazure10: \"#133c59\",\r\n\r\n\tamber01: \"#fbe9bf\",\r\n\tamber02: \"#f8e09c\",\r\n\tamber03: \"#f7d475\",\r\n\tamber04: \"#f4c951\",\r\n\tamber05: \"#f2bc41\",\r\n\tamber06: \"#efa836\",\r\n\tamber07: \"#ee9a36\",\r\n\tamber08: \"#e4882b\",\r\n\tamber09: \"#db7726\",\r\n\tamber10: \"#d66221\",\r\n\r\n\tamethyst01: \"#ede3fc\",\r\n\tamethyst02: \"#daccec\",\r\n\tamethyst03: \"#c7b4db\",\r\n\tamethyst04: \"#b59eca\",\r\n\tamethyst05: \"#a38db7\",\r\n\tamethyst06: \"#9279a6\",\r\n\tamethyst07: \"#806594\",\r\n\tamethyst08: \"#6e5282\",\r\n\tamethyst09: \"#5d3e70\",\r\n\tamethyst10: \"#4b2a5e\",\r\n\r\n\tturquoise01: \"#c0ede3\",\r\n\tturquoise02: \"#a9e1d6\",\r\n\tturquoise03: \"#8ed1c6\",\r\n\tturquoise04: \"#7cc0b5\",\r\n\tturquoise05: \"#69ada3\",\r\n\tturquoise06: \"#579e95\",\r\n\tturquoise07: \"#448d83\",\r\n\tturquoise08: \"#317c73\",\r\n\tturquoise09: \"#206b62\",\r\n\tturquoise10: \"#0e5b52\",\r\n\r\n\truby01: \"#f4bcbc\",\r\n\truby02: \"#eb9d9d\",\r\n\truby03: \"#de8181\",\r\n\truby04: \"#d26d6d\",\r\n\truby05: \"#c65f5f\",\r\n\truby06: \"#b94e4a\",\r\n\truby07: \"#ad4242\",\r\n\truby08: \"#a13030\",\r\n\truby09: \"#941e1e\",\r\n\truby10: \"#880e0e\",\r\n\r\n\temerald01: \"#d5f6c0\",\r\n\temerald02: \"#c3e8ac\",\r\n\temerald03: \"#afdc91\",\r\n\temerald04: \"#9cce7c\",\r\n\temerald05: \"#89bf65\",\r\n\temerald06: \"#76b051\",\r\n\temerald07: \"#66a140\",\r\n\temerald08: \"#56932e\",\r\n\temerald09: \"#488421\",\r\n\temerald10: \"#397514\",\r\n\r\n\tgraphite01: \"#f0f0f0\",\r\n\tgraphite02: \"#d8d8d8\",\r\n\tgraphite03: \"#bdbdbd\",\r\n\tgraphite04: \"#999999\",\r\n\tgraphite05: \"#737373\",\r\n\tgraphite06: \"#5c5c5c\",\r\n\tgraphite07: \"#454545\",\r\n\tgraphite08: \"#383838\",\r\n\tgraphite09: \"#292929\",\r\n\tgraphite10: \"#1a1a1a\",\r\n\r\n\tslate01: \"#dee1e8\",\r\n\tslate02: \"#c8cbd4\",\r\n\tslate03: \"#abaeb7\",\r\n\tslate04: \"#888b94\",\r\n\tslate05: \"#656871\",\r\n\tslate06: \"#50535a\",\r\n\tslate07: \"#414247\",\r\n\tslate08: \"#313236\",\r\n\tslate09: \"#212224\",\r\n\tslate10: \"#1c1819\",\r\n};\r\n","// Module\nvar code = \"<div class=label-container> <span class=\\\"label {{componentInstance.fontChar}}\\\" xi-tooltip=componentInstance.toolTip ng-class=componentInstance.fontStyle ng-style=\\\"{ color: componentInstance.color }\\\" eir-component-value content=componentInstance.content> </span> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\nimport isNil from \"lodash-es/isNil\";\r\nimport isNumber from \"lodash-es/isNumber\";\r\nimport isUndefined from \"lodash-es/isUndefined\";\r\n\r\nimport {\r\n\tInteractionActionEnum,\r\n\tInteractionPairOperation,\r\n\tInteractionTriggerEnum,\r\n\tSettingInputKeys,\r\n\tSettingKeys,\r\n\tSidebarTabTypes,\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonComponent, IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport type { IJsonLabel } from \"ng2/common/model/databearer/components/json-label.model\";\r\nimport type { IJsonList } from \"ng2/common/model/databearer/components/json-list.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IListDataItem } from \"ng2/common/model/dataservice/list-data-item.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport type { IComponent } from \"common/IComponent\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\nimport type { IListComponent } from \"common/interface/ilist-component\";\r\nimport { Component } from \"components/component\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nimport { ComponentsHelper } from \"components/helper\";\r\n\r\nimport { FrameworkService } from \"components/services/framework-service\";\r\n\r\nexport class List extends Component implements IListComponent {\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.PERCENT };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [InteractionPairOperation.LIST];\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic SETTING_FIELDS =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Show Header\",\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true,\r\n\t\t}]\r\n\t}, {\r\n\t\ttitle: \"Options\",\r\n\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Keep Selection\",\r\n\t\t\ttooltip: \"Keep previous selected row on reload. (With ION APIs, an object ID is preferred if using this)\",\r\n\t\t\tref: SettingKeys.KEEP_SELECTED,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Search Field\",\r\n\t\t\tref: SettingKeys.SEARCH,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Selected Item\",\r\n\t\tref: SettingKeys.CURRENT_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true\r\n\t}, {\r\n\t\tname: \"Header\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\tstatic readonly SCROLLABLE_PAGE_FACTOR = 2;\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tcurrentItem: IListDataItem; // Used in binding framework\r\n\tselectedGeneratedId: string; // Used in template\r\n\tchildren: IMap<ILayoutComponent> = {};\r\n\tchildrenDatabearers: IJsonComponent[] = [];\r\n\tcurrentTemplate: IJsonLayoutComponent;\r\n\tinfiniteScrollEnabled: boolean;\r\n\tfilterValue: string;\r\n\tprotected databearer: IJsonList;\r\n\tprivate currentTemplateHeight: number;\r\n\tprivate childrenReadyDeferred: ng.IDeferred<void>;\r\n\tprivate keepSelected: boolean;\r\n\tprivate search: boolean;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonList,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tif (obj) {\r\n\t\t\tthis.keepSelected = obj.keepSelected;\r\n\t\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\t\tthis.search = obj.search || false;\r\n\t\t}\r\n\t\tthis.filterValue = \"\";\r\n\t}\r\n\r\n\tclearSearch(): void {\r\n\t\tthis.filterValue = \"\";\r\n\t\tthis.refresh();\r\n\t}\r\n\r\n\tgetFilteredList(): IJsonComponent[] {\r\n\t\tif (this.getScope()) {\r\n\t\t\treturn this.filterList(angular.copy(this.scope.context.ListResult));\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.currentTemplate = this.getBoundarySetting<IJsonLayoutComponent>(SettingKeys.ITEM_TEMPLATE);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\tthis.refresh();\r\n\t}\r\n\r\n\trefresh(): void {\r\n\t\t// Some settings affect the height of the templates\r\n\t\tthis.updateCurrentTemplateHeight();\r\n\t\tthis.renderChildren();\r\n\t}\r\n\r\n\tsetCurrentItem(generatedId: string): void {\r\n\t\tconst realIndex = this.getRealIndexFromGeneratedId(generatedId);\r\n\t\tconst listResults = this.getFilteredList();\r\n\t\tconst currItem = listResults ? listResults[realIndex] : null;\r\n\t\tif (currItem !== null && currItem !== this.currentItem) {\r\n\t\t\tthis.selectedGeneratedId = currItem? generatedId: null;\r\n\t\t\tthis.currentItem = currItem;\r\n\t\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\t\tthis.frameworkService.triggerExpressions();\r\n\t\t}\r\n\t}\r\n\r\n\tforEachItemTemplate(fn: (view: IJsonComponent) => void): void {\r\n\t\tfor (const boundaryId in this.databearer.boundarySettings) {\r\n\t\t\tif (this.databearer.boundarySettings[boundaryId].itemTemplate) {\r\n\t\t\t\tfn(this.databearer.boundarySettings[boundaryId].itemTemplate);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.LIST) {\r\n\t\t\tinteractionPromise.then((data: any[]) => {\r\n\t\t\t\tif (data.length <= 0) {\r\n\t\t\t\t\tthis.selectedGeneratedId = null;\r\n\t\t\t\t\tthis.onLoad();\r\n\t\t\t\t}\r\n\t\t\t}).finally(() => {\r\n\t\t\t\tthis.renderChildren().then(() => {\r\n\t\t\t\t\tthis.onLoad();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tonComponentReady(childInstance: ILayoutComponent, generatedId: string): void {\r\n\t\tthis.children[generatedId] = childInstance;\r\n\t\tchildInstance.forEachChild((subChild) => {\r\n\t\t\tsubChild.initializeBindings();\r\n\t\t}, true);\r\n\t\tif (Object.keys(this.children).length === this.childrenDatabearers.length) {\r\n\t\t\tthis.updateCurrentTemplateHeight();\r\n\t\t\tthis.loadFillOptimal();\r\n\t\t\tthis.childrenReadyDeferred.resolve();\r\n\t\t}\r\n\t}\r\n\r\n\tgetChildContext(generatedId: string): IContext {\r\n\t\tif (this.getFilteredList()) {\r\n\t\t\tconst realIndex = this.getRealIndexFromGeneratedId(generatedId);\r\n\t\t\treturn $.extend({}, this.getContext(), this.getFilteredList()[realIndex]);\r\n\t\t} else {\r\n\t\t\t// Dummy context\r\n\t\t\treturn this.getContext();\r\n\t\t}\r\n\t}\r\n\r\n\tcalcNewHeight(): void {\r\n\t\tthis.calcNewSizes();\r\n\t}\r\n\r\n\tcalcNewWidth(): void {\r\n\t\tthis.calcNewSizes();\r\n\t}\r\n\r\n\tresizableChildren(direction: OrientationEnum): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tgetPxPerPercentComponent(ori: OrientationEnum, percent: number): number {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\thasIndividualChildSizes(ori: OrientationEnum): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tcalcNewSizes(orientation?: OrientationEnum): void {\r\n\t\tsuper.calcNewWidth();\r\n\t\tsuper.calcNewHeight();\r\n\t\t// children are null on startup\r\n\t\tif (this.children) {\r\n\t\t\tObject.keys(this.children).forEach((childKey) => {\r\n\t\t\t\tconst child = this.children[childKey];\r\n\t\t\t\tchild.calcNewWidth();\r\n\t\t\t\tchild.calcNewHeight();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tforEachParent(fn: (parent: ILayoutComponent) => void): void {\r\n\t\tsuper.forEachParent(fn);\r\n\t\tfn(this as any);\r\n\t}\r\n\r\n\tforEachChild(fn: (child: IComponent) => void, doGenerated: boolean): void {\r\n\t\tsuper.forEachChild(fn, doGenerated);\r\n\t\tif (doGenerated) {\r\n\t\t\tfor (const key in this.children) {\r\n\t\t\t\tthis.children[key].forEachChild(fn, doGenerated);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsetBindableValue(key: string, value: any): void {\r\n\t\tsuper.setBindableValue(key, value);\r\n\t\tif (key === SettingKeys.SHOW_LABEL) {\r\n\t\t\tthis.updateClasses();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t *\tMethod to tell the list to load more rows, either in the bottom or the top, depending on the \"down\" parameter.\r\n\t\t*\r\n\t\t* @param down True if scrolling down\r\n\t\t*/\r\n\tloadMore(down: boolean): void {\r\n\t\tif (!this.infiniteScrollEnabled || !this.childrenDatabearers.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst pageFactor = 0.5;\r\n\t\tconst listData = this.getFilteredList();\r\n\t\tlet newRowCount = Math.floor(this.getRowsPerPage() * pageFactor);\r\n\t\t// make sure that newRowCount is atleast 1 for lists that have low height.\r\n\t\tnewRowCount = newRowCount === 0 ? 1 : newRowCount;\r\n\t\tif (down) { // Scrolling down\r\n\t\t\tconst realIndexMax = this.getRealIndexFromGeneratedId(\r\n\t\t\t\tthis.childrenDatabearers[this.childrenDatabearers.length - 1].generatedId\r\n\t\t\t);\r\n\t\t\tconst remainingSlots = listData.length - (realIndexMax + 1);\r\n\t\t\tif (remainingSlots < newRowCount) {\r\n\t\t\t\tnewRowCount = remainingSlots;\r\n\t\t\t}\r\n\t\t\tthis.childrenDatabearers.splice(0, newRowCount).forEach((deletedChild) => {\r\n\t\t\t\tdelete this.children[deletedChild.generatedId];\r\n\t\t\t});\r\n\t\t\tfor (let i = 0; i < newRowCount; i++) {\r\n\t\t\t\tthis.childrenDatabearers.push(this.getNewGeneratedComponent(realIndexMax + 1 + i));\r\n\t\t\t}\r\n\t\t} else { // Scrolling up\r\n\t\t\tconst realIndexMin = this.getRealIndexFromGeneratedId(\r\n\t\t\t\tthis.childrenDatabearers[0].generatedId\r\n\t\t\t);\r\n\t\t\tconst remainingSlots = realIndexMin;\r\n\t\t\tif (remainingSlots < newRowCount) {\r\n\t\t\t\tnewRowCount = remainingSlots;\r\n\t\t\t}\r\n\t\t\tthis.childrenDatabearers.splice(-newRowCount, newRowCount).forEach((deletedChild) => {\r\n\t\t\t\tdelete this.children[deletedChild.generatedId];\r\n\t\t\t});\r\n\t\t\tfor (let i = 0; i < newRowCount; i++) {\r\n\t\t\t\tthis.childrenDatabearers.unshift(this.getNewGeneratedComponent(realIndexMin - 1 - i));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected getClassList(): string[] {\r\n\t\tconst classList = super.getClassList();\r\n\t\tif (!this.getBoundarySetting<boolean>(SettingKeys.SHOW_LABEL)) {\r\n\t\t\tclassList.push(\"hide-header\");\r\n\t\t}\r\n\t\treturn classList;\r\n\t}\r\n\r\n\tprivate filterList(list: any[]): any[] {\r\n\t\tif(list) {\r\n\t\t\tconst activeFields = this.getActiveFieldsFromTemplate();\r\n\t\t\treturn list.filter((values) => {\r\n\t\t\t\treturn this.checkObjectforFilterMatch(values, activeFields);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn list;\r\n\t}\r\n\r\n\tprivate getActiveFieldsFromTemplate(): string[] {\r\n\t\tconst activeIDs: string[] = [];\r\n\t\tconst breakdown = (child: IJsonComponent): void => {\r\n\t\t\tlet component;\r\n\t\t\tswitch (child.typedef) {\r\n\t\t\t\tcase \"Flexbox\":\r\n\t\t\t\t\tcomponent = child as IJsonFlexbox;\r\n\t\t\t\t\tcomponent.children.forEach((child: IJsonComponent) => {\r\n\t\t\t\t\t\tbreakdown(child);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"Label\":\r\n\t\t\t\t\tcomponent = child as IJsonLabel;\r\n\t\t\t\t\tif (component.content.Type === BindingTypeEnum.CONTEXT_BINDING) {\r\n\t\t\t\t\t\tif (activeIDs.indexOf(component.content.sourceKey) === -1) {\r\n\t\t\t\t\t\t\tactiveIDs.push(component.content.sourceKey);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (component.toolTip.Type === BindingTypeEnum.CONTEXT_BINDING) {\r\n\t\t\t\t\t\tif (activeIDs.indexOf(component.toolTip.sourceKey) === -1) {\r\n\t\t\t\t\t\t\tactiveIDs.push(component.toolTip.sourceKey);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t//Possible components to search\r\n\t\t\t\tcase \"Image\":\r\n\t\t\t\tcase \"Hyperlink\":\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.currentTemplate.children.forEach(child => {\r\n\t\t\tbreakdown(child);\r\n\t\t});\r\n\r\n\t\treturn activeIDs;\r\n\t}\r\n\r\n\tprivate checkObjectforFilterMatch(objectValues: any, activeFields: string[]): boolean {\r\n\t\tif (isNil(this.filterValue)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tlet match = false;\r\n\r\n\t\tObject.entries(objectValues).some(([key, value]) => {\r\n\t\t\tif (activeFields.indexOf(key) !== -1) {\r\n\t\t\t\tif ((value as string).toLowerCase().indexOf(this.filterValue.toLowerCase()) !== -1) {\r\n\t\t\t\t\tmatch = true;\r\n\t\t\t\t\treturn match;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn match;\r\n\t}\r\n\r\n\tprivate updateCurrentTemplateHeight(): void {\r\n\t\tconst firstLiElement = this.element.find(\"li\").first();\r\n\t\tif (firstLiElement.length) {\r\n\t\t\tthis.currentTemplateHeight = firstLiElement.children().first().height();\r\n\t\t} else {\r\n\t\t\tthis.currentTemplateHeight = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onLoad(): void {\r\n\t\tthis.trigger(InteractionTriggerEnum.ON_LOAD);\r\n\t\tthis.setSelection();\r\n\t}\r\n\r\n\tprivate setSelection(): void {\r\n\t\tif (this.selectedGeneratedId && this.keepSelected) {\r\n\t\t\tthis.moveIndex();\r\n\t\t\tthis.goToPage();\r\n\t\t\tthis.moveScroll();\r\n\t\t\tthis.setCurrentItem(this.selectedGeneratedId);\r\n\t\t} else {\r\n\t\t\tthis.setCurrentItem(Object.keys(this.children)[0]);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate moveIndex(): void {\r\n\t\tconst listresult = this.getFilteredList();\r\n\t\tconst index = ComponentsHelper.findItemIndexById(listresult, this.currentItem.id);\r\n\t\tif (isUndefined(index)) {\r\n\t\t\tthis.setErrorTooltip(\"Selection failed, Item ID is not unique.\");\r\n\t\t} else {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t}\r\n\r\n\t\tif (isNumber(index) && index !== -1) {\r\n\t\t\tthis.selectedGeneratedId = this.getGeneratedPrefix() + index;\r\n\t\t} else if (index) { //if item id does not exists, try to find correct index\r\n\t\t\tconst index = this.getRealIndexFromGeneratedId(this.selectedGeneratedId);\r\n\t\t\tthis.selectedGeneratedId = this.getGeneratedPrefix() +\r\n\t\t\t\tComponentsHelper.incrementIndex(\r\n\t\t\t\t\tindex,\r\n\t\t\t\t\tthis.getContext(),\r\n\t\t\t\t\tthis.currentItem,\r\n\t\t\t\t\tthis.getDatasource()\r\n\t\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.setCurrentItem(Object.keys(this.children)[0]);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate goToPage(): void {\r\n\t\tif (this.selectedGeneratedId) {\r\n\t\t\tconst listData = this.getFilteredList();\r\n\t\t\tconst offset = 5;\r\n\t\t\tlet generatedIndex = this.getRealIndexFromGeneratedId(this.selectedGeneratedId) - offset;\r\n\t\t\tif (generatedIndex < 0) {\r\n\t\t\t\tgeneratedIndex = 0;\r\n\t\t\t}\r\n\t\t\tthis.childrenDatabearers = [];\r\n\t\t\tlet optimalRowCount = Math.floor(this.getRowsPerPage() * List.SCROLLABLE_PAGE_FACTOR);\r\n\t\t\tif (optimalRowCount > listData.length) {\r\n\t\t\t\toptimalRowCount = listData.length;\r\n\t\t\t}\r\n\t\t\tconst remainingSlots = listData.length - (generatedIndex + 1);\r\n\t\t\tif (remainingSlots < optimalRowCount) {\r\n\t\t\t\tgeneratedIndex = listData.length - optimalRowCount;\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < optimalRowCount; i++) {\r\n\t\t\t\tthis.childrenDatabearers.push(this.getNewGeneratedComponent(generatedIndex + i));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate moveScroll(): void {\r\n\t\tconst rowCount = Math.floor(this.getRowsPerPage()) + 1;\r\n\t\tconst realIndex = this.getFilteredList().length - this.getRealIndexFromGeneratedId(this.selectedGeneratedId);\r\n\t\tif (realIndex < rowCount) {\r\n\t\t\tconst listElement = this.element.find(\".listview\")[0];\r\n\t\t\tlistElement.scrollTop = listElement.scrollHeight;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadFillOptimal(): void {\r\n\t\tconst optimalRowCount = Math.floor(this.getRowsPerPage() * List.SCROLLABLE_PAGE_FACTOR);\r\n\t\tconst dataLength = this.getFilteredList() ? this.getFilteredList().length : 0;\r\n\t\tconst remainingTilOptimaleCount = optimalRowCount - this.childrenDatabearers.length;\r\n\t\tconst remainingDataLength = dataLength - this.childrenDatabearers.length;\r\n\t\tif (remainingTilOptimaleCount > 0) {\r\n\t\t\tconst newRowCount = Math.min(\r\n\t\t\t\tremainingTilOptimaleCount, // Remaining til optimal count\r\n\t\t\t\tremainingDataLength\r\n\t\t\t);\r\n\t\t\tif (this.childrenDatabearers.length > 0) {\r\n\t\t\t\tconst realIndexMax = this.getRealIndexFromGeneratedId((\r\n\t\t\t\t\tthis.childrenDatabearers[this.childrenDatabearers.length - 1]).generatedId);\r\n\t\t\t\tfor (let i = 0; i < newRowCount; i++) {\r\n\t\t\t\t\tthis.childrenDatabearers.push(this.getNewGeneratedComponent(realIndexMax + 1 + i));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Disable infinite scroll when not able to fill optimal space\r\n\t\t} else if (remainingTilOptimaleCount < 0) {\r\n\t\t\t// TODO: remove elements for optimization\r\n\t\t}\r\n\t\tif (optimalRowCount > this.childrenDatabearers.length) {\r\n\t\t\tthis.infiniteScrollEnabled = false;\r\n\t\t} else {\r\n\t\t\tthis.infiniteScrollEnabled = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getGeneratedPrefix(): string {\r\n\t\treturn this.getId() + \"_row\";\r\n\t}\r\n\r\n\tprivate updateView(): void {\r\n\t\tthis.currentTemplate = this.getBoundarySetting<IJsonLayoutComponent>(SettingKeys.ITEM_TEMPLATE);\r\n\t\tthis.currentTemplateHeight = null;\r\n\t}\r\n\r\n\tprivate getRealIndexFromGeneratedId(generatedId: string): number {\r\n\t\tlet returnNumber = -1;\r\n\t\tconst reg = new RegExp(this.getGeneratedPrefix() + \"(\\\\d+)\");\r\n\t\tconst match = reg.exec(generatedId);\r\n\t\tif (match) {\r\n\t\t\treturnNumber = parseInt(match[1]);\r\n\t\t}\r\n\t\treturn returnNumber;\r\n\t}\r\n\r\n\tprivate getRowsPerPage(): number {\r\n\t\tconst paddingTopAndBottom = 33;\r\n\t\tconst eachHeight = this.currentTemplateHeight + paddingTopAndBottom;\r\n\t\tconst availableSpace = this.element.find(\".listview\").height();\r\n\t\treturn availableSpace / eachHeight;\r\n\t}\r\n\r\n\tprivate getNewGeneratedComponent(realIndex: number): IJsonComponent {\r\n\t\tconst currentTemplate = this.currentTemplate;\r\n\t\tconst generatedId = this.getGeneratedPrefix() + realIndex;\r\n\t\treturn {\r\n\t\t\t...currentTemplate,\r\n\t\t\tgeneratedId\r\n\t\t};\r\n\t}\r\n\r\n\tprivate renderChildren(): ng.IPromise<void> {\r\n\t\t// Arbitrary timeout to wait for rendering of list\r\n\t\tconst RENDER_TIMEOUT = 10;\r\n\t\tthis.childrenReadyDeferred = this.frameworkService.getNewDeferred<void>();\r\n\t\tthis.getScope().$evalAsync(() => {\r\n\t\t\tthis.childrenDatabearers = [];\r\n\t\t\tthis.children = {};\r\n\t\t});\r\n\r\n\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\tconst listResults = this.getFilteredList();\r\n\t\t\tconst hasListResults = !!listResults;\r\n\t\t\tconst hasData = hasListResults && listResults.length !== 0;\r\n\t\t\tconst noData = hasListResults && listResults.length === 0;\r\n\r\n\t\t\t// init all children with a child. Leave the loadFillOptimal to fill the list\r\n\t\t\tthis.childrenDatabearers = [this.getNewGeneratedComponent(0)];\r\n\r\n\t\t\t// Empty dataset when there is no data in listresults\r\n\t\t\t// An uninitialized list will have hasListResults as undefined\r\n\t\t\tif (this.frameworkService.isDesigner() && noData && !hasListResults) {\r\n\t\t\t\tthis.childrenDatabearers = [];\r\n\t\t\t}\r\n\t\t\t// Empty dataset when there is no data in listresults and listresults eq undefined\r\n\t\t\tif (this.frameworkService.isRuntimeMode() && !hasData) {\r\n\t\t\t\tthis.childrenDatabearers = [];\r\n\t\t\t}\r\n\t\t\t// Needed if interaction exists within a list child\r\n\t\t\tthis.loadFillOptimal();\r\n\r\n\t\t}, RENDER_TIMEOUT);\r\n\r\n\t\treturn this.childrenReadyDeferred.promise;\r\n\t}\r\n\r\n\t// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./list.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=card> <div class=card-header> <h2 class=card-title eir-component-value content=componentInstance.label> </h2> </div> <div class=card-content> <div class=listview-search ng-if=componentInstance.search> <span class=searchfield-wrapper> <input class=searchfield placeholder=Search name=list-search id=list-search autocomplete=off ng-model=componentInstance.filterValue ng-change=componentInstance.refresh()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use href=#icon-search></use> </svg> </span> </div> <div class=listview id=list-{{::component.id}} eir-infinite-scroll=componentInstance.loadMore(scrollingDown) eir-infinite-scroll-enabled=componentInstance.infiniteScrollEnabled> <ul> <li ng-repeat=\\\"child in componentInstance.childrenDatabearers\\\" ng-init=\\\"childContext=componentInstance.getChildContext(child.generatedId);\\\" ng-click=componentInstance.setCurrentItem(child.generatedId);$event.stopPropagation() ng-class=\\\"{ 'is-selected': componentInstance.selectedGeneratedId === child.generatedId }\\\"> <eir-component-directive component=child parent=componentInstance context=childContext typedef=Flexbox component-ready=\\\"componentInstance.parent.onComponentReady(componentInstance, child.generatedId)\\\"> </eir-component-directive> </li> </ul> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { Helper } from \"../../common/helper\";\r\nimport type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { ILookupApi, ILookupOptions } from \"../../common/model/sohoxi/sohoxi-lookup.model\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tInteractionActionEnum, InteractionPairOperation, InteractionTriggerEnum, SettingInputKeys,\r\n\tSettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonLookup } from \"ng2/common/model/databearer/components/json-lookup.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\nimport type { IInteraction } from \"ng2/common/model/interaction/interaction.model\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport class Lookup extends Component {\r\n\tstatic AVAILABLE_WIDTHS: IDataPair[] = [\r\n\t\t{ name: \"Small\", value: \"input-sm\" },\r\n\t\t{ name: \"Medium\", value: \"input-mm\" },\r\n\t\t{ name: \"Large\", value: \"input-default\" }\r\n\t];\r\n\tstatic OUTPUT_SETTING_TITLE = \"Dialog Output Value\";\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = [\r\n\t\tInteractionPairOperation.ON_CLICK\r\n\t];\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.LIST;\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_CLICK;\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] =\r\n\t[{\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Text\",\r\n\t\tref: SettingKeys.TEXT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Selected Item\",\r\n\t\tref: SettingKeys.SELECTED_ITEM,\r\n\t\tvalueType: ValueTypeEnum.OBJECT,\r\n\t\twrite: false,\r\n\t\tread: true,\r\n\t}];\r\n\r\n\tstatic SETTING_FIELDS =\r\n\t\t([\r\n\t\t\t{\r\n\t\t\t\ttitle: Lookup.OUTPUT_SETTING_TITLE,\r\n\t\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\tdataset: [],\r\n\t\t\t\t\ttitle: \"\",\r\n\t\t\t\t\tref: SettingKeys.LOOKUP_OUTPUT_ID,\r\n\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t}, {\r\n\t\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Width\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [{\r\n\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\tref: SettingKeys.BOX_WIDTH,\r\n\t\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\t\tdataset: Lookup.AVAILABLE_WIDTHS,\r\n\t\t\t\t\tdefaultValue: \"input-default\",\r\n\t\t\t\t}]\r\n\t\t\t}\r\n\t\t] as IComponentSettingCategory[])\r\n\t\t\t.concat(Component.SETTING_FIELDS);\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\ttext: string;\r\n\tlookupOptions: ILookupOptions;\r\n\tboxWidth: string;\r\n\tprotected databearer: IJsonLookup;\r\n\tprivate lookupCallback: Function;\r\n\tprivate selectedItem: IMap<any>;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonLookup,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\tthis.initLookupOptions();\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t\tthis.setBoundarySettingIfChanged<string>(SettingKeys.BOX_WIDTH);\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.text = \"\";\r\n\t\tthis.selectedItem = null;\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tonChildrenReady(): void {\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tprivate initLookupOptions(): void {\r\n\t\tthis.lookupOptions = {\r\n\t\t\ttitle: \"Select Item\",\r\n\t\t\tfield: (selectedRow: IMap<string>) => {\r\n\t\t\t\tthis.selectedItem = selectedRow;\r\n\t\t\t\tconst selectedOutput = selectedRow[this.databearer.lookupOutputId];\r\n\t\t\t\treturn selectedOutput;\r\n\t\t\t},\r\n\t\t\tbeforeShow: (lookup: any, callback: Function) => {\r\n\t\t\t\tif (Helper.isUndefinedOrNull(this.datasource)) {\r\n\t\t\t\t\tthis.setErrorTooltip(`No data service available on component: ${this.getDisplayName()}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.lookupCallback = callback;\r\n\t\t\t\t\tthis.trigger(InteractionTriggerEnum.CLICK);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmatch: () => {\r\n\t\t\t\t// fake function to bypass an issue on soho-code.\r\n\t\t\t},\r\n\t\t\toptions: {\r\n\t\t\t\tpaging: true,\r\n\t\t\t\tpagesize: 10,\r\n\t\t\t\tcolumns: this.databearer.columns,\r\n\t\t\t\tdataset: [],\r\n\t\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\t\ttoolbar: {\r\n\t\t\t\t\tkeywordFilter: true,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tupdateValuesWithTranslations(): void {\r\n\t\tthis.databearer.columns.forEach((column) => {\r\n\t\t\tconst translatedTitle = this.frameworkService.getTranslatableStringByProperty(\r\n\t\t\t\tthis.getId(),\r\n\t\t\t\tcolumn.id\r\n\t\t\t);\r\n\r\n\t\t\tif (translatedTitle) {\r\n\t\t\t\tconst globalString = this.frameworkService.getGlobalValue(translatedTitle, this);\r\n\r\n\t\t\t\tif (globalString) {\r\n\t\t\t\t\tcolumn.value = translatedTitle;\r\n\t\t\t\t\tcolumn.name = Helper.htmlEncode(globalString);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcolumn.name = Helper.htmlEncode(translatedTitle);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tloadInteraction(interaction: IInteraction): ng.IPromise<any | any[]> {\r\n\t\tconst interactionPromise = super.loadInteraction(interaction);\r\n\t\tconst listData = this.getContext().ListResult;\r\n\r\n\t\tif (interaction.targetActionName === InteractionActionEnum.CLEAR) {\r\n\t\t\treturn interactionPromise;\r\n\t\t}\r\n\r\n\t\tif (!listData) {\r\n\t\t\tinteractionPromise.then(dataset => this.openLookupDialog(dataset, interaction));\r\n\t\t} else {\r\n\t\t\tthis.openLookupDialog(listData, interaction);\r\n\t\t}\r\n\r\n\t\treturn interactionPromise;\r\n\t}\r\n\r\n\tgetSohoXiApi(): ILookupApi {\r\n\t\treturn this.element.find(`#${this.getDatabearer().id}`).data(\"lookup\");\r\n\t}\r\n\r\n\tprivate openLookupDialog(dataset: any, interaction: IInteraction): void {\r\n\t\tif (interaction.sourceTriggerName === InteractionTriggerEnum.CLICK) {\r\n\t\t\tthis.lookupOptions.options.dataset = angular.copy(dataset);\r\n\t\t\tthis.getSohoXiApi().updated(this.lookupOptions);\r\n\t\t\tthis.getScope().$applyAsync(() => {\r\n\t\t\t\tthis.lookupCallback();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./lookup.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=\\\"field {{componentInstance.boxWidth}}\\\"> <label for={{::component.id}} ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label> </label> <input class=lookup id={{::component.id}} name={{::component.id}} ng-model=componentInstance.text ng-readonly=componentInstance.isReadonly ng-change=componentInstance.onUpdateValue() xi-lookup=componentInstance.lookupOptions /> </div>\";\n// Exports\nmodule.exports = code;","import type { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport type { IJsonRadioButtons, IRadioButton } from \"../../common/model/component/radiobutton.model\";\r\nimport { Component } from \"../component\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport {\r\n\tInteractionPairOperation, InteractionTriggerEnum, SettingInputKeys,\r\n\tSettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport type { IRadioButtonComponent } from \"common/interface/iradiobutton-component\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\n\r\nexport class RadioButton extends Component implements IRadioButtonComponent {\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS.concat(\r\n\t\t[InteractionPairOperation.ON_ITEM_CHANGED]\r\n\t);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = InteractionDefines.TARGET_ACTIONS.concat([\r\n\t\tInteractionPairOperation.LIST,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t]);\r\n\tstatic DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_ITEM_CHANGED;\r\n\tstatic DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([{\r\n\t\ttitle: \"Style\",\r\n\t\ttab: SidebarTabTypes.STYLE,\r\n\t\tsettings: [{\r\n\t\t\ttitle: \"Show Label\",\r\n\t\t\tboundarySetting: true,\r\n\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: true,\r\n\t\t}, {\r\n\t\t\ttitle: \"Disabled\",\r\n\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\tdefaultValue: false,\r\n\t\t\tbutton: {\r\n\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\tdialog: true\r\n\t\t\t}\r\n\t\t}]\r\n\t}] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Selected Item Value\",\r\n\t\tref: SettingKeys.CURRENT_ITEM_VALUE,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true,\r\n\t}, {\r\n\t\tname: \"Selected Item Name\",\r\n\t\tref: SettingKeys.CURRENT_ITEM_NAME,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: false,\r\n\t\tread: true,\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tradioButtons: IRadioButton[];\r\n\tselectedRadioButtonId: string;\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\tcurrentItemValue: string;\r\n\tcurrentItemName: string;\r\n\tprotected databearer: IJsonRadioButtons;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonRadioButtons,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.radioButtons = this.databearer.componentRadioButtons;\r\n\t\tif (this.radioButtons.length ) {\r\n\t\t\tthis.selectedRadioButtonId = this.radioButtons[0].id;\r\n\t\t\tthis.currentItemName = this.radioButtons[0].name;\r\n\t\t\tthis.currentItemValue = this.radioButtons[0].field;\r\n\t\t}\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.selectedRadioButtonId = this.radioButtons[0].id;\r\n\t\tthis.currentItemName = this.radioButtons[0].name;\r\n\t\tthis.currentItemValue = this.radioButtons[0].field;\r\n\t}\r\n\r\n\tinitializeBindings(): void {\r\n\t\tsuper.initializeBindings();\r\n\t\tthis.updateValuesWithTranslations();\r\n\t}\r\n\r\n\tsetCurrentItem(selected: IRadioButton): void {\r\n\t\tthis.currentItemValue = selected.field;\r\n\t\tthis.currentItemName = selected.name;\r\n\t\tthis.trigger(InteractionTriggerEnum.CURRENT_ITEM_CHANGED);\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\t}\r\n\r\n\tupdateValuesWithTranslations(): void {\r\n\t\tthis.radioButtons.forEach((radioButton) => {\r\n\t\t\tconst translatedTitle = this.frameworkService.getTranslatableStringByProperty(this.getId(), radioButton.id);\r\n\r\n\t\t\tif (translatedTitle) {\r\n\t\t\t\tconst globalString = this.frameworkService.getGlobalValue(radioButton.name, this);\r\n\t\t\t\tradioButton.name = translatedTitle;\r\n\r\n\t\t\t\tif (globalString) {\r\n\t\t\t\t\tradioButton.value = globalString;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.selectedRadioButtonId === radioButton.id) {\r\n\t\t\t\t\tthis.currentItemName = translatedTitle;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./radiobutton.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div> <fieldset class=radio-group> <label ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label></label> <div ng-repeat=\\\"radio in componentInstance.radioButtons track by radio.id\\\" class=radio-button-group> <input type=radio class=radio ng-model=componentInstance.selectedRadioButtonId ng-disabled=componentInstance.isReadonly id={{radio.id}} ng-change=componentInstance.setCurrentItem(radio) value={{radio.id}} /> <label for={{radio.id}} class=radio-label>{{radio.value ? radio.value : radio.name}}</label> </div> </fieldset> </div>\";\n// Exports\nmodule.exports = code;","import { Flexbox } from \"../flexbox/flexbox\";\r\nimport { Tabs } from \"./tabs\";\r\n\r\nimport { DEFAULT_BOUNDARY, SettingInputKeys, SettingKeys, SidebarTabTypes } from \"ng2/common/constants/common.constant\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IJsonFlexbox } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport type { IJsonTabPanel } from \"../../common/model/component/tabs.model\";\r\n\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class TabPanel extends Flexbox {\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] = Flexbox.SETTING_FIELDS\r\n\t\t.filter((settingCategory) => {\r\n\t\t\tconst toBeRemoved = settingCategory.settings.some((setting) => {\r\n\t\t\t\tswitch (setting.ref) {\r\n\t\t\t\t\tcase SettingKeys.SIZE:\r\n\t\t\t\t\tcase SettingKeys.VISIBILITY:\r\n\t\t\t\t\tcase SettingKeys.MARGIN:\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst removeSetting = false;\r\n\t\t\tconst keepSetting = true;\r\n\t\t\treturn toBeRemoved ? removeSetting : keepSetting;\r\n\t\t}).concat({\r\n\t\t\ttitle: \"Padding\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Padding\",\r\n\t\t\t\tref: SettingKeys.MARGIN,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tinputType: SettingInputKeys.MARGIN,\r\n\t\t\t\tdefaultValue: { left: 0, top: 10, right: 0, bottom: 0 }\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Visibility\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tcondition: \"hide\",\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Component\",\r\n\t\t\t\tref: SettingKeys.VISIBILITY,\r\n\t\t\t\tinputType: SettingInputKeys.SWITCH,\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tdefaultValue: true\r\n\t\t\t}] //Hide setting but getting the default value\r\n\t\t});\r\n\r\n\tparent: Tabs;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTabPanel,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: Tabs,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj as IJsonFlexbox, $element, parent, frameworkService);\r\n\t\tthis.newBoundaryEntered(frameworkService.getCurrentBoundary().id);\r\n\t\tthis.parent = parent;\r\n\r\n\t\tthis.canCut = !this.tabsParent();\r\n\r\n\t\tif (obj) {\r\n\t\t\tthis.backgroundColor = obj.backgroundColor;\r\n\t\t}\r\n\t}\r\n\r\n\tcanDelete(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate tabsParent(): boolean {\r\n\t\treturn this.parent.getTypedef() === Tabs.name;\r\n\t}\r\n\r\n\tupdateVisibility(): void {\r\n\t\tsuper.updateVisibility();\r\n\r\n\t\tif (this.tabsParent()) {\r\n\t\t\tconst isVisible: boolean = this.getId() === this.parent.currentTab.id;\r\n\t\t\tthis.isVisible = isVisible;\r\n\t\t\tthis.databearer.boundarySettings[DEFAULT_BOUNDARY.id].visibility = isVisible;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./tab-panel.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=tab-wrapper ng-class=\\\"{'horizontal': componentInstance.orientation === 1, 'page-container no-scroll': componentInstance.orientation === 2}\\\"> <div id=tabs class=tab-container ng-class=\\\"{'horizontal': componentInstance.orientation === 1, 'vertical no-scroll': componentInstance.orientation === 2}\\\"> <ul class=tab-list> <li class=tab ng-repeat=\\\"tabObject in ::componentInstance.componentTabs track by tabObject.id\\\"> <a href=\\\"{{'#' + tabObject.id}}\\\" id=\\\"{{'atag-' + tabObject.id}}\\\"> {{tabObject.value ? tabObject.value : tabObject.name}} </a> </li> </ul> <div id=vertical-tab class=\\\"tab-panel-container scrollable-y\\\" ng-if=\\\"componentInstance.orientation === 2\\\"> <div id={{tabChild.id}} class=tab-panel ng-repeat=\\\"tabChild in ::componentInstance.childrenDatabearers track by tabChild.id\\\"> <eir-component-directive component=tabChild context=context parent=componentInstance typedef=TabPanel component-ready=componentInstance.parent.onComponentReady(componentInstance)> </eir-component-directive> </div> </div> </div> <div id=horizontal-tab class=tab-panel-container ng-if=\\\"componentInstance.orientation === 1\\\"> <div id={{tabChild.id}} class=tab-panel ng-repeat=\\\"tabChild in ::componentInstance.childrenDatabearers track by tabChild.id\\\"> <eir-component-directive component=tabChild context=context parent=componentInstance typedef=TabPanel component-ready=componentInstance.parent.onComponentReady(componentInstance)> </eir-component-directive> </div> </div> </div> \";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"childCage tabPanelChildCage\\\" ng-class=\\\"{ 'vertical': componentInstance.orientation === 2, 'flex-parent': componentInstance.isFlexParent}\\\" ng-style=componentInstance.styleOptions> <eir-children class={{componentInstance.childrenClasses}} parent=componentInstance children-ready=onChildrenReady()> </eir-children> </div> \";\n// Exports\nmodule.exports = code;","import {\r\n\tInteractionPairOperation, SettingInputKeys, SettingKeys,\r\n\tSidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\nimport { IJsonTextArea } from \"../../common/model/component/textarea.model\";\r\nimport { ITextAreaOptions } from \"../../common/model/sohoxi/sohoxi-textarea.model\";\r\nimport { Component } from \"../component\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class TextArea extends Component {\r\n\tpublic static readonly DEFAULT_MAX_LENGTH: number = 2000;\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tpublic static SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t([\r\n\t\t{\r\n\t\t\ttitle: \"Character Limit\",\r\n\t\t\ttab: SidebarTabTypes.CONTENT,\r\n\t\t\tsettings: [\r\n\t\t\t\t{\r\n\t\t\t\t\ttitle: \"Value\",\r\n\t\t\t\t\tref: SettingKeys.MAX_LENGTH,\r\n\t\t\t\t\tinputType: SettingInputKeys.NUMBER,\r\n\t\t\t\t}]\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Style\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Resizable\",\r\n\t\t\t\tref: SettingKeys.IS_RESIZABLE,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false\r\n\t\t\t}]\r\n\t\t}\r\n\t] as IComponentSettingCategory[]).concat(Component.SETTING_FIELDS);\r\n\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Text\",\r\n\t\tref: SettingKeys.TEXT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Placeholder\",\r\n\t\tref: SettingKeys.PLACEHOLDER,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}];\r\n\r\n\tpublic text: string;\r\n\tpublic label: string;\r\n\tpublic placeholder: string;\r\n\tpublic showLabel: boolean;\r\n\tpublic resizable: boolean;\r\n\tpublic maxLength: number;\r\n\tpublic textareaOptions: ITextAreaOptions;\r\n\tprotected databearer: IJsonTextArea;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTextArea,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\tthis.resizable = obj.resizable;\r\n\t\tthis.maxLength = obj.maxLength;\r\n\t\tthis.updateMaxLength();\r\n\t}\r\n\r\n\tpublic newBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t}\r\n\r\n\tpublic clear(): void {\r\n\t\tthis.text = \"\";\r\n\t}\r\n\r\n\tpublic updateMaxLength(): void {\r\n\t\tthis.textareaOptions = {\r\n\t\t\tcharacterCounter: this.maxLength ? true : false,\r\n\t\t\tmaxLength: this.maxLength ? this.maxLength : TextArea.DEFAULT_MAX_LENGTH,\r\n\t\t\tcharRemainingText: \"Characters left: {0}\"\r\n\t\t};\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./textarea.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=field> <label for={{::component.id}} ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label> </label> <textarea class=textarea ng-class=\\\"{'resizable': componentInstance.resizable}\\\" ng-readonly=componentInstance.isReadonly ng-model=componentInstance.text ng-change=componentInstance.onUpdateValue() ng-attr-maxlength={{componentInstance.maxLength}} ng-attr-placeholder={{componentInstance.placeholder}} xi-textarea=componentInstance.textareaOptions>\\r\\n\\t</textarea> </div>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport {\r\n\tInteractionPairOperation, MaskProcess, SettingInputKeys,\r\n\tSettingKeys, SidebarTabTypes\r\n} from \"ng2/common/constants/common.constant\";\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\nimport { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJSonMaskSettings, IJsonTextBox } from \"ng2/common/model/databearer/components/json-textbox.model\";\r\nimport { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { ILayoutComponent } from \"../../common/interface/ilayout-component\";\r\n\r\nimport { IMaskOptions } from \"../../common/model/sohoxi/sohoxi-mask.model\";\r\nimport { Component } from \"../component\";\r\n\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport class TextBox extends Component {\r\n\tpublic static AVAILABLE_WIDTHS: IDataPair[] = [\r\n\t\t{ name: \"Tiny\", value: \"input-xs\" },\r\n\t\t{ name: \"Small\", value: \"input-sm\" },\r\n\t\t{ name: \"Medium\", value: \"input-mm\" },\r\n\t\t{ name: \"Large\", value: \"input-default\" }\r\n\t];\r\n\tpublic static DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tpublic static SOURCE_TRIGGERS: IDataPair[] = InteractionDefines.SOURCE_TRIGGERS;\r\n\tpublic static TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tpublic static DEFAULT_ACTION: IDataPair = InteractionPairOperation.GET;\r\n\tpublic static DEFAULT_TRIGGER: IDataPair = InteractionPairOperation.ON_LOAD;\r\n\tpublic static SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t(<IComponentSettingCategory[]>[{\r\n\t\t\ttitle: \"Style\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: true,\r\n\t\t\t}, {\r\n\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\tdefaultValue: false,\r\n\t\t\t\tbutton: {\r\n\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\tdialog: true\r\n\t\t\t\t}\r\n\t\t\t}]\r\n\t\t}, {\r\n\t\t\ttitle: \"Width\",\r\n\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\tsettings: [{\r\n\t\t\t\tboundarySetting: true,\r\n\t\t\t\tref: SettingKeys.BOX_WIDTH,\r\n\t\t\t\tinputType: SettingInputKeys.RADIO,\r\n\t\t\t\tdataset: TextBox.AVAILABLE_WIDTHS,\r\n\t\t\t\tdefaultValue: \"input-default\",\r\n\t\t\t}]\r\n\t\t}]).concat(Component.SETTING_FIELDS);\r\n\r\n\tpublic static BINDABLE_FIELDS_2: IJsonBindableField[] = [{\r\n\t\tname: \"Text\",\r\n\t\tref: SettingKeys.TEXT,\r\n\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\twrite: true,\r\n\t\tread: true,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Label\",\r\n\t\tref: SettingKeys.LABEL,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}, {\r\n\t\tname: \"Placeholder\",\r\n\t\tref: SettingKeys.PLACEHOLDER,\r\n\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\twrite: true,\r\n\t\tread: false,\r\n\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t}\r\n\t];\r\n\r\n\tpublic text: string;\r\n\tpublic label: string;\r\n\tpublic showLabel: boolean;\r\n\tpublic placeholder: string;\r\n\tpublic boxWidth: string;\r\n\tpublic editType: string;\r\n\tpublic lengthWarning: boolean;\r\n\tpublic maxLength = 2000;\r\n\tprotected databearer: IJsonTextBox;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTextBox,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\t\tthis.showLabel = BackwardCompatible.getShowLabel(obj);\r\n\t\tthis.databearer.mask = BackwardCompatible.tryGetMask(obj);\r\n\t\tthis.lengthWarning = false;\r\n\r\n\t\tangular.element(() => {\r\n\t\t\tthis.updateMaskOptions();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic setBindableValue(bindableReference: string, value: any): void {\r\n\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\tif (this.getMask().process !== MaskProcess.NONE) {\r\n\t\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\t\tthis.updateMaskOptions();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic updateMaskOptions(maskOptions?: IJSonMaskSettings): void {\r\n\t\tthis.editType = \"text\";\r\n\t\tif (maskOptions) {\r\n\t\t\tthis.databearer.mask = maskOptions;\r\n\t\t}\r\n\t\tconst mask = this.databearer.mask;\r\n\t\tconst element = this.element.find(\"#\" + this.getId());\r\n\t\tif (mask && element) { //old textboxes < 2020.05 do not have mask\r\n\t\t\tconst maskApi = element.data(\"mask\");\r\n\t\t\tif (maskApi) {\r\n\t\t\t\tmaskApi.destroy(); //remove all the previous mask settings\r\n\t\t\t\telement.removeClass(\"is-number-mask\"); //Remove this class so typing is on the left side\r\n\t\t\t}\r\n\r\n\t\t\tlet maskOptions: IMaskOptions;\r\n\t\t\tswitch (mask.process) {\r\n\t\t\t\tcase MaskProcess.NUMBER:\r\n\t\t\t\t\tmaskOptions = {\r\n\t\t\t\t\t\tprocess: mask.process,\r\n\t\t\t\t\t\tpatternOptions: {\r\n\t\t\t\t\t\t\tallowDecimal: mask.decimalLimit > 0 ? true : false,\r\n\t\t\t\t\t\t\tallowNegative: mask.allowNegative,\r\n\t\t\t\t\t\t\tdecimalLimit: mask.decimalLimit,\r\n\t\t\t\t\t\t\tintegerLimit: mask.integerLimit,\r\n\t\t\t\t\t\t\tallowThousandsSeparator: mask.allowThousandsSeparator,\r\n\t\t\t\t\t\t\tprefix: mask.prefix\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MaskProcess.DATE_TIME:\r\n\t\t\t\t\tmaskOptions = {\r\n\t\t\t\t\t\tprocess: mask.process,\r\n\t\t\t\t\t\tpatternOptions: {\r\n\t\t\t\t\t\t\tformat: mask.format\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MaskProcess.STRING:\r\n\t\t\t\t\tmaskOptions = {\r\n\t\t\t\t\t\tpattern: mask.format\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MaskProcess.PASSWORD:\r\n\t\t\t\t\tthis.editType = mask.process;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase MaskProcess.NONE:\r\n\t\t\t\t\t// This is a fix for masking acc-tests.\r\n\t\t\t\t\t// For some reason < input > does not get a value in its type when masking option is set to 'none'\r\n\t\t\t\t\telement.attr(\"type\", \"text\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// Mask not supported\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (maskOptions) {\r\n\t\t\t\telement.mask(maskOptions);\r\n\t\t\t} else {\r\n\t\t\t\telement.mask();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpublic newBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\r\n\t\tlet newBoxWidth = this.getBoundarySetting<string>(SettingKeys.BOX_WIDTH);\r\n\t\tnewBoxWidth = BackwardCompatible.tryGetBoxWidth(newBoxWidth);\r\n\t\tif (this.boxWidth !== newBoxWidth) {\r\n\t\t\tthis.boxWidth = newBoxWidth;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clear(): void {\r\n\t\tthis.text = \"\";\r\n\t}\r\n\r\n\tpublic getMask(): IJSonMaskSettings {\r\n\t\treturn this.databearer.mask;\r\n\t}\r\n\r\n\tpublic onUpdateValue(): void {\r\n\t\tsuper.onUpdateValue();\r\n\t\tthis.lengthWarning = this.text.length === this.maxLength;\r\n\t}\r\n\r\n\tpublic static directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./textbox.html\"),\r\n\t\t\treplace: true\r\n\t\t};\r\n\t}];\r\n}\r\n","import {\r\n\tIJsonComponent,\r\n\tIJsonComponentSettings\r\n} from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonTextBox extends IJsonComponent {\r\n\ttext: IJsonValueSource;\r\n\tlabel: IJsonValueSource;\r\n\tplaceholder: IJsonValueSource;\r\n\tshowLabel: IJsonValueSource; // Deprecated\r\n\tmask: IJSonMaskSettings;\r\n\tboundarySettings: IMap<IJsonTextBoxSettings>;\r\n}\r\n\r\nexport interface IJsonTextBoxSettings extends IJsonComponentSettings {\r\n\tboxWidth: string;\r\n\tshowLabel: boolean;\r\n}\r\n\r\nexport interface IJSonMaskSettings {\r\n\tprocess: string;\r\n\tallowNegative?: boolean;\r\n\tintegerLimit?: number;\r\n\tdecimalLimit?: number;\r\n\tallowThousandsSeparator?: boolean;\r\n\tprefix?: string;\r\n\tformat?: string; //for date & string\r\n}\r\n","// Module\nvar code = \"<div class=field> <label for={{::component.id}} ng-if=componentInstance.showLabel eir-component-value content=componentInstance.label></label> <input type={{componentInstance.editType}} id={{::component.id}} name={{::component.id}} class={{componentInstance.boxWidth}} eir-component-value content=componentInstance.text ng-model=componentInstance.text ng-change=componentInstance.onUpdateValue() ng-readonly=componentInstance.isReadonly placeholder={{componentInstance.placeholder}} ng-model-options=\\\"{ updateOn: 'default', debounce: {'default': 500, 'blur': 0}}\\\" maxlength={{componentInstance.maxLength}} /> <div ng-if=componentInstance.lengthWarning> <svg class=icon focusable=false aria-hidden=true role=presentation> <use href=#icon-alert></use> </svg> <span class=audible>Warning</span> <span class=warning-text>Maximum of 2000 characters reached.</span> </div> </div>\";\n// Exports\nmodule.exports = code;","import { Component } from \"../component\";\r\n\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nimport { DEFAULT_BOUNDARY, HourMode, InteractionPairOperation, InteractionTriggerEnum, RegexStrings, SettingInputKeys, SettingKeys, SidebarTabTypes } from \"ng2/common/constants/common.constant\";\r\n\r\nimport { InteractionDefines } from \"ng2/common/constants/interaction-defines.constant\";\r\n\r\nimport { BindingTypeEnum } from \"ng2/common/enums/binding-type.enum\";\r\nimport { SizeTypeEnum } from \"ng2/common/enums/size-type.enum\";\r\n\r\nimport { ValueTypeEnum } from \"ng2/common/enums/value-type.enum\";\r\n\r\nimport type { IJsonTimepicker } from \"common/model/component/timepicker.model\";\r\n\r\nimport type { ITimepickerApi, ITimePickerOptions } from \"common/model/sohoxi/sohoxi-timepicker.model\";\r\nimport type { IComponentSettingCategory } from \"ng2/common/model/components/settings/component-setting-category.model\";\r\nimport type { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport type { IJsonSize } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport type { IJsonBindableField } from \"ng2/common/model/databearer/json-binding.model\";\r\n\r\nimport type { IComponentScope } from \"common/interface/icomponent-scope\";\r\nimport type { ILayoutComponent } from \"common/interface/ilayout-component\";\r\n\r\nexport class Timepicker extends Component {\r\n\tstatic minuteInterval = 1;\r\n\tstatic secondInterval = 1;\r\n\tstatic availableHourMode: IDataPair[] = [\r\n\t\t{ name: \"12-hour\", value: HourMode.TWELVE },\r\n\t\t{ name: \"24-hour\", value: HourMode.TWENTYFOUR }\r\n\t];\r\n\tstatic DEFAULT_WIDTH: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic DEFAULT_HEIGHT: IJsonSize = { sizeType: SizeTypeEnum.AUTO };\r\n\tstatic SOURCE_TRIGGERS = InteractionDefines.SOURCE_TRIGGERS.concat([InteractionPairOperation.ON_CHANGED]);\r\n\tstatic TARGET_ACTIONS: IDataPair[] = [\r\n\t\tInteractionPairOperation.GET,\r\n\t\tInteractionPairOperation.CLEAR\r\n\t];\r\n\tstatic DEFAULT_TRIGGER = InteractionPairOperation.ON_CHANGED;\r\n\tstatic DEFAULT_ACTION = InteractionPairOperation.GET;\r\n\tstatic SETTING_FIELDS: IComponentSettingCategory[] =\r\n\t\t[\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Style\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Show Label\",\r\n\t\t\t\t\t\tboundarySetting: true,\r\n\t\t\t\t\t\tref: SettingKeys.SHOW_LABEL,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\t\tdefaultValue: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Read Only\",\r\n\t\t\t\t\t\tref: SettingKeys.IS_READONLY,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\t\tbutton: {\r\n\t\t\t\t\t\t\ticon: \"#icon-unlocked\",\r\n\t\t\t\t\t\t\ttooltip: \"Disable Component When...\",\r\n\t\t\t\t\t\t\tdialog: true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttitle: \"Format\",\r\n\t\t\t\ttab: SidebarTabTypes.STYLE,\r\n\t\t\t\tsettings: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Time Format\",\r\n\t\t\t\t\t\tref: SettingKeys.TIME_FORMAT,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.DROPDOWN,\r\n\t\t\t\t\t\tdataset: Timepicker.availableHourMode,\r\n\t\t\t\t\t\tdefaultValue: HourMode.TWENTYFOUR,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttitle: \"Enable Seconds\",\r\n\t\t\t\t\t\tref: SettingKeys.ENABLE_SECONDS,\r\n\t\t\t\t\t\tinputType: SettingInputKeys.CHECKBOX,\r\n\t\t\t\t\t\tdefaultValue: false,\r\n\t\t\t\t\t},\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\t...Component.SETTING_FIELDS\r\n\t\t];\r\n\r\n\tstatic BINDABLE_FIELDS_2: IJsonBindableField[] = [\r\n\t\t{\r\n\t\t\tname: \"Label\",\r\n\t\t\tref: SettingKeys.LABEL,\r\n\t\t\tvalueType: ValueTypeEnum.LOCALIZED_STRING,\r\n\t\t\twrite: true,\r\n\t\t\tread: false,\r\n\t\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"Time\",\r\n\t\t\tref: SettingKeys.TIME_VALUE,\r\n\t\t\tvalueType: ValueTypeEnum.STRING,\r\n\t\t\twrite: true,\r\n\t\t\tread: true,\r\n\t\t\tdefaultValue: { Type: BindingTypeEnum.STATIC_VALUE, value: \"\" }\r\n\t\t}\r\n\t];\r\n\r\n\tlabel: string;\r\n\tshowLabel: boolean;\r\n\ttimeFormat: string;\r\n\tenableSeconds: boolean;\r\n\tisReadonly: boolean;\r\n\r\n\ttimeValue: string;\r\n\r\n\tformatString: string;\r\n\ttimepickerOptions: ITimePickerOptions;\r\n\ttimepickerApi: ITimepickerApi;\r\n\r\n\tconstructor(\r\n\t\tobj: IJsonTimepicker,\r\n\t\t$element: ng.IAugmentedJQuery,\r\n\t\tparent: ILayoutComponent,\r\n\t\tframeworkService: FrameworkService\r\n\t) {\r\n\t\tsuper(obj, $element, parent, frameworkService);\r\n\r\n\t\tthis.enableSeconds = obj.enableSeconds;\r\n\t\tthis.isReadonly = obj.isReadonly;\r\n\t\tthis.timeFormat = obj.timeFormat;\r\n\t\tthis.formatString = this.timeFormat;\r\n\t\tthis.showLabel = obj.boundarySettings[DEFAULT_BOUNDARY.id].showLabel;\r\n\t}\r\n\r\n\tinit(): void {\r\n\t\tthis.frameworkService.getTimeout()(() => {\r\n\t\t\tthis.updateReadonly();\r\n\t\t\tthis.setSeconds();\r\n\t\t\tconst timepickerApi = this.getSohoXiApi();\r\n\t\t\ttimepickerApi.element.on(\"change\", () => {\r\n\t\t\t\tthis.timeValue = timepickerApi.value(false);\r\n\t\t\t\tthis.frameworkService.trigger(this, InteractionTriggerEnum.CHANGED);\r\n\t\t\t});\r\n\t\t\tthis.setTimepickerOptions();\r\n\t\t});\r\n\t}\r\n\r\n\tsetBindableValue(bindableReference: string, value: any): void {\r\n\t\tif (bindableReference === SettingKeys.TIME_VALUE) {\r\n\t\t\tthis.setErrorTooltip();\r\n\t\t\tif (!value) {\r\n\t\t\t\tthis.clear();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst upperCaseTime = (value as string).toUpperCase();\r\n\t\t\tif (this.isValidTime(upperCaseTime)) {\r\n\t\t\t\tthis.setTime(upperCaseTime);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setErrorTooltip(`Invalid time: '${value}'`);\r\n\t\t\t\tthis.clear();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tsuper.setBindableValue(bindableReference, value);\r\n\t\t}\r\n\t}\r\n\r\n\tnewBoundaryEntered(boundaryId: string): void {\r\n\t\tsuper.newBoundaryEntered(boundaryId);\r\n\t\tthis.setBoundarySettingIfChanged<boolean>(SettingKeys.SHOW_LABEL);\r\n\t}\r\n\r\n\tgetSohoXiApi(): ITimepickerApi {\r\n\t\tif (!this.timepickerApi) {\r\n\t\t\tthis.timepickerApi = this.element.find(`#time-field-${this.getId()}`).data(\"timepicker\");\r\n\t\t}\r\n\t\treturn this.timepickerApi;\r\n\t}\r\n\r\n\trefreshTimepicker(): void {\r\n\t\tthis.updateReadonly();\r\n\t\tthis.setSeconds();\r\n\t\tthis.setTimepickerOptions();\r\n\t\tthis.setTime($(`#time-field-${this.getId()}`).val() as string);\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tthis.setTime(\"\");\r\n\t}\r\n\r\n\tprivate setTimepickerOptions(): void {\r\n\t\tthis.timepickerOptions = {\r\n\t\t\ttimeFormat: this.formatString,\r\n\t\t\tminuteInterval: Timepicker.minuteInterval,\r\n\t\t\tsecondInterval: Timepicker.secondInterval,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate setTime(time: string): void {\r\n\t\tconst field = $(`#time-field-${this.getId()}`);\r\n\t\tlet finalTime: string;\r\n\r\n\t\tif (time) {\r\n\t\t\t// Extract time stamp from dummy date\r\n\t\t\tfinalTime = Soho.Locale.formatDate(new Date(`2021-01-01 ${time}`), { pattern: this.formatString });\r\n\t\t} else {\r\n\t\t\tfinalTime = \"\";\r\n\t\t}\r\n\r\n\t\tfield.val(finalTime);\r\n\t\tthis.timeValue = finalTime;\r\n\t}\r\n\r\n\tprivate setSeconds(): void {\r\n\t\tif (this.enableSeconds) {\r\n\t\t\tthis.formatString = this.timeFormat.replace(\":mm\", \":mm:ss\");\r\n\t\t} else {\r\n\t\t\tthis.formatString = this.timeFormat;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate updateReadonly(): void {\r\n\t\tconst timepickerApi = this.getSohoXiApi();\r\n\t\tif (this.isReadonly) {\r\n\t\t\ttimepickerApi.readonly();\r\n\t\t} else {\r\n\t\t\ttimepickerApi.enable();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isValidTime(time: string): boolean {\r\n\t\treturn RegexStrings.TIME.test(time);\r\n\t}\r\n\r\n\tstatic directive = [() => {\r\n\t\treturn {\r\n\t\t\ttemplate: require(\"./timepicker.html\"),\r\n\t\t\treplace: true,\r\n\t\t\tlink: ($scope: IComponentScope) => {\r\n\t\t\t\tconst componentInstance = $scope.componentInstance as Timepicker;\r\n\t\t\t\tcomponentInstance.init();\r\n\t\t\t\t$scope.componentReady({ componentInstance: $scope.componentInstance });\r\n\t\t\t}\r\n\t\t};\r\n\t}];\r\n}\r\n","// Module\nvar code = \"<div class=field> <label for=time-field-{{component.id}} class=label ng-show=componentInstance.showLabel eir-component-value content=componentInstance.label> </label> <input id=time-field-{{component.id}} class=timepicker type=text data-validate=time xi-timepicker=componentInstance.timepickerOptions> </div>\";\n// Exports\nmodule.exports = code;","import type { IJsonTabComponent } from \"common/model/component/tabs.model\";\r\nimport { IComponent } from \"common/IComponent\";\r\n\r\nexport interface ITabsComponent extends IComponent {\r\n\tcomponentTabs: IJsonTabComponent[];\r\n}","import {\r\n\tIJsonComponent,\r\n\tIJsonComponentSettings,\r\n} from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonValueSource } from \"ng2/common/model/databearer/json-binding.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonRadioButtons extends IJsonComponent {\r\n\tlabel: IJsonValueSource;\r\n\tshowLabel: IJsonValueSource; // Deprecated\r\n\tcomponentRadioButtons: IRadioButton[];\r\n\tboundarySettings: IMap<IJsonRadioButtonSettings>;\r\n}\r\n\r\nexport interface IJsonRadioButtonSettings extends IJsonComponentSettings {\r\n\tshowLabel: boolean;\r\n}\r\n\r\nexport interface IRadioButton {\r\n\tid: string;\r\n\tname: string;\r\n\tfield?: string;\r\n\tvalue?: string; //TODO move value MUPS-3016\r\n}\r\n","import type { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\n\r\nimport { IJsonFlexbox, IJsonFlexboxSettings } from \"ng2/common/model/databearer/components/json-flexbox.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport type { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonTabs extends IJsonLayoutComponent {\r\n\torientation: OrientationEnum;\r\n\tchildren: IJsonTabPanel[];\r\n\tcomponentTabs: IJsonTabComponent[];\r\n\tboundarySettings: IMap<IJsonFlexboxSettings>;\r\n}\r\n\r\nexport interface IJsonTabPanel extends IJsonFlexbox {\r\n}\r\n\r\nexport interface IJsonTabComponent {\r\n\tid: string;\r\n\tname: string;\r\n\tfield?: string;\r\n\tvalue?: string; //TODO move value MUPS-3016\r\n}\r\n","// import { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\n// import { IMap } from \"ng2/common/model/imap.model\";\r\n// import { IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\n// import { FlexSizeTypeEnum, FlexOverflowEnum, AlignmentEnum } from \"ng2/common/constants/common.constant\";\r\n// import { OrientationEnum } from \"\"ng2/common/enums/orientation.enum\"\";\r\n\r\nimport { AlignmentEnum, FlexOverflowEnum, FlexSizeTypeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { OrientationEnum } from \"ng2/common/enums/orientation.enum\";\r\nimport { IJsonComponentSettings } from \"ng2/common/model/databearer/components/json-component.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\n\r\nexport interface IJsonFlexbox extends IJsonLayoutComponent {\r\n\tbackgroundColor?: string;\r\n\tborder?: IJsonBorder;\r\n\tborderColor?: string;\r\n\tboundarySettings: IMap<IJsonFlexboxSettings>;\r\n}\r\n\r\nexport interface IJsonFlexboxSettings extends IJsonComponentSettings {\r\n\torientation: OrientationEnum;\r\n\tsize: number;\r\n\tsizeType: FlexSizeTypeEnum;\r\n\toverflow: FlexOverflowEnum;\r\n\thorizontalAlignment: AlignmentEnum;\r\n\tverticalAlignment: AlignmentEnum;\r\n}\r\n\r\nexport interface IJsonFlexboxAlignments {\r\n\thorizontalAlignment: AlignmentEnum;\r\n\tverticalAlignment: AlignmentEnum;\r\n}\r\n\r\nexport interface IAvailableFlexSize {\r\n\tdisplayName: string;\r\n\tvalue: FlexSizeTypeEnum;\r\n}\r\n\r\nexport interface IAvailableAlignments {\r\n\tname: string;\r\n\tvalue: AlignmentEnum;\r\n}\r\n\r\nexport interface IJsonBorder extends IMap<number> {\r\n\ttop: number;\r\n\tright: number;\r\n\tbottom: number;\r\n\tleft: number;\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirTranslationDialogCtrl as $ctrl\\\"> <div id=translation-tabs class=tab-container xi-tabs> <ul class=tab-list role=tablist aria-multiselectable=false> <li class=\\\"tab is-selected\\\"> <a href=#component-tab class=hyperlink ng-click=$ctrl.onChangeTab($ctrl.tabEnum.COMPONENT)>Component Strings</a> </li> <li class=tab> <a href=#global-tab class=hyperlink ng-click=$ctrl.onChangeTab($ctrl.tabEnum.GLOBAL)>Global Strings</a> </li> </ul> </div> <div class=\\\"maincontent scrollable\\\"> <div id=component-tab class=scrollable> <p class=error-text>{$value} needs to be present.</p> <div class=toolbar role=toolbar data-options=\\\"{maxVisibleButtons: 10}\\\"> <h3 class=language-text xi-tooltip=\\\"'Current Language'\\\">{{$ctrl.currentLanguageDisplayName}}</h3> <div class=buttonset> <label class=audible for=searchfield-component-language>Keyword Search</label> <input ng-show=!$ctrl.selectedComponent id=searchfield-component-language name=searchfield-language class=searchfield /> <button class=\\\"btn btn-menu\\\" type=button xi-popupmenu> <span>Filter</span> </button> <ul class=\\\"popupmenu is-padded is-selectable\\\"> <li class=is-checked ng-click=\\\"$ctrl.filterLanguage('All')\\\"><a>All</a></li> <li ng-repeat=\\\"usedLanguage in $ctrl.usedLanguages track by usedLanguage.key\\\" ng-click=$ctrl.filterLanguage(usedLanguage.key)> <a>{{usedLanguage.value}}</a> </li> </ul> <button class=\\\"btn btn-menu\\\" type=button xi-popupmenu> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete Language</span> </button> <ul class=popupmenu> <li ng-repeat=\\\"usedLanguage in $ctrl.usedLanguages track by usedLanguage.key\\\" ng-click=$ctrl.deleteLanguage(usedLanguage)> <a>{{usedLanguage.value}}</a> </li> </ul> <button class=\\\"btn btn-menu\\\" type=button xi-popupmenu> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>Add Language</span> </button> <ul class=\\\"popupmenu is-padded\\\"> <li ng-repeat=\\\"supportedLanguage in $ctrl.supportedLanguages\\\" ng-click=$ctrl.addLanguage(supportedLanguage)> <a>{{supportedLanguage.value}}</a> </li> </ul> <button class=btn-actions type=button xi-tooltip=\\\"'More Actions'\\\" ng-show=$ctrl.originalComponent> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=\\\"popupmenu is-padded\\\"> <li><a ng-click=$ctrl.toggleAllTranslations()>{{ $ctrl.selectedComponent ? \\\"All Translations\\\" : \\\"Component Translations\\\" }}</a></li> </ul> </div> </div> <div xi-datagrid=$ctrl.componentDatagridOptions id=component-language-grid></div> </div> <div id=global-tab class=scrollable> <div class=toolbar role=toolbar> <h3 class=language-text xi-tooltip=\\\"'Current Language'\\\">{{$ctrl.currentLanguageDisplayName}}</h3> <div class=buttonset> <label class=audible for=searchfield-global-language>Keyword Search</label> <input id=searchfield-global-language name=searchfield-language class=searchfield /> <button class=btn-tertiary type=button ng-click=$ctrl.addNewString() xi-tooltip=\\\"'Add String'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-add></use> </svg> <span>Add</span> </button> <button class=btn-tertiary type=button ng-disabled=!$ctrl.selectedGlobalString ng-click=$ctrl.deleteGlobalString() xi-tooltip=\\\"'Delete'\\\"> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> <button class=\\\"btn btn-menu\\\" type=button xi-popupmenu> <span>Open Language</span> </button> <ul class=\\\"popupmenu is-padded is-selectable\\\"> <li ng-repeat=\\\"supportedLanguage in $ctrl.supportedLanguages\\\" ng-click=$ctrl.openLanguage(supportedLanguage) class=\\\"{{$ctrl.selectedGlobalLocale === supportedLanguage.key ? 'is-checked' : ''}}\\\"> <a>{{supportedLanguage.value}}</a> </li> </ul> </div> </div> <div xi-datagrid=$ctrl.globalDatagridOptions id=global-language-grid></div> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=$ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary translation-save\\\" ng-click=$ctrl.save()>Save</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div ng-controller=\\\"eirAddStringCtrl as ctrl\\\"> <div class=field> <label for=stringName class=required>String Name</label> <input id=stringName type=text class=required aria-required=true ng-model=ctrl.stringName /> </div> <div class=field> <label for=stringValue class=required>String Value</label> <input id=stringValue type=text ng-model=ctrl.stringValue /> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-disabled=!ctrl.stringName ng-click=ctrl.add()>Add</button> </div> </div>\";\n// Exports\nmodule.exports = code;","import { Config, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDocument } from \"ng2/common/model/swagger.model\";\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\nimport { ErrorResponse } from \"../../common/error-response\";\r\nimport { IApiSuite, IOperation, IOperationQuery, ISuiteQuery } from \"../../common/model/ion-metadata.model\";\r\nimport { ComponentHelper } from \"../component-helper\";\r\nimport { IonApiService } from \"./ion-api-service\";\r\n\r\nexport class IonMetadataService {\r\n\tpublic cache: ng.ICacheObject;\r\n\r\n\t/** Page size when searching for operations */\r\n\tpublic static OPERATIONS_PAGE_SIZE = 20;\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.CACHE_FACTORY,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.ION_API_SERVICE\r\n\t];\r\n\r\n\tpublic constructor(\r\n\t\tprivate $cacheFactory: ng.ICacheFactoryService,\r\n\t\tpublic $q: ng.IQService,\r\n\t\tprivate ionApiService: IonApiService\r\n\t) {\r\n\t\tthis.initCache();\r\n\t}\r\n\r\n\tprivate initCache(): void {\r\n\t\tthis.cache = this.$cacheFactory.get(\"IonMetadataService\");\r\n\t\tif (!this.cache) {\r\n\t\t\tthis.cache = this.$cacheFactory(\"IonMetadataService\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getApiSuites(): ng.IPromise<IApiSuite[]> {\r\n\t\tconst options: ISuiteQuery = {\r\n\t\t\tpageSize: 50\r\n\t\t};\r\n\t\treturn this.makeIonRequest(\"metadata/v1/\" + Config.TENANT_ID + \"/apisuites\", false, options);\r\n\t}\r\n\r\n\tpublic searchOperations(\r\n\t\tsuiteContext: string = \"\",\r\n\t\tquery: string = \"\",\r\n\t\tpageNo: number = 0): ng.IPromise<IOperation[]> {\r\n\t\tconst encodedSuiteContext = encodeURI(suiteContext);\r\n\t\tconst options: IOperationQuery = {\r\n\t\t\tsuiteContext: encodedSuiteContext,\r\n\t\t\tsearchCriteria: query,\r\n\t\t\tpageSize: IonMetadataService.OPERATIONS_PAGE_SIZE,\r\n\t\t\tpageNo,\r\n\t\t};\r\n\r\n\t\treturn this.makeIonRequest(\"metadata/v1/\" + Config.TENANT_ID + \"/operations\", false, options);\r\n\t}\r\n\r\n\tpublic getSwaggerDoc(fullPath: string): ng.IPromise<IDocument> {\r\n\t\tconst deferred = this.$q.defer<IDocument>();\r\n\t\tconst regex = new RegExp(\".*\\/\" + Config.TENANT_ID + \"\\/(.*)\", \"i\");\r\n\t\tconst pathMatch = fullPath.match(regex);\r\n\t\tif (pathMatch && pathMatch[1]) {\r\n\t\t\tconst swaggerPath = pathMatch[1];\r\n\t\t\tthis.makeIonRequest<IDocument>(swaggerPath, true).then(resp => {\r\n\t\t\t\tconst dereferenced = ComponentHelper.dereferenceSwagger(resp);\r\n\t\t\t\tdeferred.resolve(dereferenced);\r\n\t\t\t}).catch((errorResponse: ng.IHttpResponse<any>) => {\r\n\t\t\t\tconst error = new ErrorResponse(errorResponse.statusText, errorResponse.status);\r\n\t\t\t\tdeferred.reject(error);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconst error = new ErrorResponse(`Unable to handle path \"${fullPath}\"`);\r\n\t\t\tdeferred.reject(error);\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n\tprivate makeIonRequest<T>(\r\n\t\trelativePath: string,\r\n\t\tsetTenant: boolean,\r\n\t\tparams: IMap<any> = {},\r\n\t\tmethod: string = \"GET\"\r\n\t): ng.IPromise<T> {\r\n\t\treturn this.ionApiService.executeIonApiAsync<T>({\r\n\t\t\turl: relativePath,\r\n\t\t\tmethod,\r\n\t\t\tsetTenant,\r\n\t\t\tparams,\r\n\t\t\tcache: this.cache,\r\n\t\t}).then(response => response.data);\r\n\t}\r\n\r\n\tpublic static add(ngModule: ng.IModule): void {\r\n\t\tngModule.service(InjectNames.ION_METADATA_SERVICE, IonMetadataService);\r\n\t}\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IDocument } from \"ng2/common/model/swagger.model\";\r\n\r\n/**\r\n * Various utility functions, exposed as static methods.\r\n */\r\nexport class ComponentHelper {\r\n\r\n\t/**\r\n\t * Transform a Swagger document such that every $ref is replaced by the object it is referencing.\r\n\t *\tTODO: Should use a proper parser/validator for JSON-schema.\r\n\t\t*/\r\n\tpublic static dereferenceSwagger(doc: IDocument): IDocument {\r\n\t\t// Clone the document to avoid side-effects. (SLOW! Wait for Object.assign support?)\r\n\t\tconst copy: IDocument = JSON.parse(JSON.stringify(doc));\r\n\r\n\t\tComponentHelper.mapObject(copy, (key, value) => {\r\n\t\t\tif (key === \"$ref\") {\r\n\t\t\t\tconst {prop, propName} = ComponentHelper.lookupRef(value, copy);\r\n\t\t\t\tif (prop) {\r\n\t\t\t\t\treturn { key: propName, value: prop };\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn(`Could not dereference ${value}`);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn copy;\r\n\t}\r\n\r\n\t/**\r\n\t * Transform an object by calling the mapFunc on every property.\r\n\t *\r\n\t *\tNOTE: Will modify the given object.\r\n\t\t* @param obj\r\n\t\t* @param mapFunc\r\n\t\t*/\r\n\tpublic static mapObject(obj: IMap<any>, mapFunc: (k: string, value: any) => any): void {\r\n\t\tfor (const propName in obj) {\r\n\t\t\tif (obj.hasOwnProperty(propName)) {\r\n\t\t\t\tif (typeof obj[propName] === \"object\") {\r\n\t\t\t\t\tComponentHelper.mapObject(obj[propName], mapFunc);\r\n\t\t\t\t}\r\n\t\t\t\tconst newProp = mapFunc(propName, obj[propName]);\r\n\t\t\t\tif (newProp !== null) {\r\n\t\t\t\t\t// TODO: Temporary workaround for swagger schema. REMOVEME\r\n\t\t\t\t\tfor (const k in newProp.value) {\r\n\t\t\t\t\t\tobj[k] = newProp.value[k];\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// obj[newProp.key] = newProp.value\r\n\t\t\t\t\tdelete (obj[propName]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Look up a JSON-schema reference ('$ref') and return the object it is referencing.\r\n\t * @param path A JSON-schema reference, e.g '#/objectroot/deep/property'\r\n\t * @param obj The object to search for the reference.\r\n\t * @param upperPropName Name of the returned parent object.\r\n\t */\r\n\tpublic static lookupRef(path: string, obj: IMap<any>, upperPropName?: string): { prop: any, propName: string } {\r\n\t\tpath = path.replace(/^#/, \"\");\t// Remove #/\r\n\t\tconst regex = /\\/?[^\\/]+\\/?/;\t\t// Match e.g [/herp/]derp\r\n\t\tconst matches = path.match(regex);\r\n\t\tif (matches) {\r\n\t\t\tconst firstMatch = matches[0];\t// /herp/\r\n\t\t\tconst restOfPath = path.slice(firstMatch.length);\t// 'derp'\r\n\t\t\tconst propName = firstMatch.replace(/\\//g, \"\");\t// 'herp'\r\n\r\n\t\t\treturn ComponentHelper.lookupRef(restOfPath, obj[propName], propName);\r\n\t\t} else {\r\n\t\t\treturn { prop: obj, propName: upperPropName };\r\n\t\t}\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../common/angular-constants\";\r\nimport { IChildScope } from \"../common/interface/ichild-scope\";\r\nimport { IChildrenScope } from \"../common/interface/ichildren-scope\";\r\n\r\nimport { IComponent } from \"../common/IComponent\";\r\n\r\nexport class ChildrenDirective implements ng.IDirective {\r\n\tpublic restrict = \"E\";\r\n\tpublic scope = {\r\n\t\tparent: \"=\",\r\n\t\tchildrenReady: \"&\",\r\n\t};\r\n\r\n\tconstructor(\r\n\t\tprivate $compileService: ng.ICompileService\r\n\t) { }\r\n\r\n\tpublic link($scope: IChildrenScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattrs: ng.IAttributes\r\n\t): void {\r\n\t\tlet nrChildrenReady = 0;\r\n\t\tconst parentInstance = $scope.parent;\r\n\t\t$scope.context = parentInstance.getContext();\r\n\t\t$scope.onChildReady = (childInstance: IComponent, index: number) => {\r\n\t\t\tparentInstance.children[index] = childInstance;\r\n\t\t\tnrChildrenReady++;\r\n\t\t\tif (\r\n\t\t\t\tnrChildrenReady === parentInstance.getDatabearer().children.length\r\n\t\t\t) {\r\n\t\t\t\t$scope.childrenReady();\r\n\t\t\t}\r\n\t\t};\r\n\t\t$scope.$applyAsync(() => {\r\n\t\t\tif (parentInstance.getDatabearer().children.length === 0) {\r\n\t\t\t\t$scope.childrenReady();\r\n\t\t\t} else {\r\n\t\t\t\tparentInstance.getDatabearer().children.forEach((child, index) => {\r\n\t\t\t\t\tconst childScope = $scope.$new() as IChildScope;\r\n\t\t\t\t\tchildScope.component = child;\r\n\t\t\t\t\tchildScope.parent = parentInstance;\r\n\t\t\t\t\tchildScope.context = $scope.context;\r\n\t\t\t\t\tchildScope.index = index;\r\n\t\t\t\t\tthis.$compileService(ChildrenDirective.createTemplate(child.typedef))(\r\n\t\t\t\t\t\tchildScope,\r\n\t\t\t\t\t\t(clone) => {\r\n\t\t\t\t\t\t\telement.append(clone);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic static createTemplate(typedef: string): JQuery {\r\n\t\tconst componentTemplate = $(\r\n\t\t\t\"<eir-component-directive></eir-component-directive>\"\r\n\t\t);\r\n\t\tcomponentTemplate.attr(\"component\", \"component\");\r\n\t\tcomponentTemplate.attr(\"context\", \"context\");\r\n\t\tcomponentTemplate.attr(\"parent\", \"parent\");\r\n\t\tcomponentTemplate.attr(\r\n\t\t\t\"component-ready\",\r\n\t\t\t\"onChildReady(componentInstance, index);\"\r\n\t\t);\r\n\t\tcomponentTemplate.attr(\"generated-id\", \"parent.generateId(index)\");\r\n\t\tcomponentTemplate.attr(\"typedef\", typedef);\r\n\t\treturn componentTemplate;\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = (\r\n\t\t\t$compileService: ng.ICompileService\r\n\t\t) => new ChildrenDirective($compileService);\r\n\t\tdirective.$inject = [AngularConstants.COMPILE];\r\n\t\tm.directive(\"eirChildren\", directive);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { Component } from \"./component\";\r\n\r\ninterface IComponentCommonScope extends ng.IScope {\r\n\tcomponent: Component;\r\n}\r\n\r\nclass ComponentCommonCtrl {\r\n\tstatic $inject = [AngularConstants.SCOPE];\r\n}\r\n\r\nexport class ComponentCommonDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirComponentCommon\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tcontroller: ComponentCommonCtrl,\r\n\t\t\t\ttemplate: require(\"./component-common.html\"),\r\n\t\t\t\treplace: true,\r\n\t\t\t\tscope: true\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=componentCommon> <span class=errorMessage xi-tooltip=componentInstance.errorTooltip ng-if=\\\"componentInstance.errorTooltip != null && componentInstance.isShowError\\\"> <svg class=\\\"icon icon-error\\\" focusable=false aria-hidden=true> <use xlink:href=#icon-error></use> </svg> <span class=audible>Error</span> </span> <div class=\\\"component-tooltip row\\\"> <div class=\\\"component-name id-{{::component.id}}\\\"> <span class=focus-type-target>Target Component</span> <span class=focus-type-source>Source Component</span> <span class=\\\"normal-name small-thin-text\\\">{{component.displayName}}</span> <svg ng-if=!componentInstance.isGenerated class=icon-selectionbox focusable=false> <use xlink:href=#icon-more></use> </svg> </div> <div class=arrow-down-outer> <div class=arrow-down-inner></div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { ComponentClassNames, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IComponentScope } from \"../common/interface/icomponent-scope\";\r\nimport { LayoutComponent } from \"./layout-component\";\r\n\r\nimport { ComponentsHelper } from \"./helper\";\r\nimport { FrameworkService } from \"./services/framework-service\";\r\n\r\nexport class ComponentDirective implements ng.IDirective {\r\n\t// Found guide to make directive in typescript\r\n\t//http://blog.aaronholmes.net/writing-angularjs-directives-as-typescript-classes/\r\n\tpublic restrict = \"E\";\r\n\tpublic scope = {\r\n\t\tcomponent: \"=\",\r\n\t\tparent: \"=\",\r\n\t\tcontext: \"=\",\r\n\t\tgeneratedId: \"=\",\r\n\t\tcomponentReady: \"&\",\r\n\t\tcomponentDestroyed: \"&\"\r\n\t};\r\n\tpublic replace = true;\r\n\tpublic link: (scope: ng.IScope, element: ng.IAugmentedJQuery, attrs: ng.IAttributes) => void;\r\n\tpublic template: (element: ng.IAugmentedJQuery, attrs: ng.IAttributes) => string;\r\n\tpublic controllerExists: (controllerName: string) => boolean;\r\n\r\n\tconstructor(\r\n\t\tprivate $compile: ng.ICompileService,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate $controller: ng.IControllerService\r\n\t) {\r\n\t\tComponentDirective.prototype.controllerExists = (controllerName: string) => {\r\n\t\t\ttry {\r\n\t\t\t\tthis.$controller(controllerName, null, true);\r\n\t\t\t\treturn true;\r\n\t\t\t} catch (e) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tComponentDirective.prototype.template = (element: ng.IAugmentedJQuery, attrs: ng.IAttributes) => {\r\n\t\t\t// Keeping the eir-component node name because of css-reasons\r\n\t\t\tconst template = $(\"<eir-component></eir-component>\");\r\n\t\t\ttemplate.attr(\"id\", \"{{component.id}}\");\r\n\t\t\ttemplate.attr(\"xi-busy\", \"componentInstance.isLoading\");\r\n\t\t\ttemplate.attr(\"ng-show\", \"componentInstance.isVisible\");\r\n\r\n\t\t\tif (frameworkService.isDesigner()) {\r\n\t\t\t\tconst editorControllerName = ComponentClassNames.EDITOR_COMPONENT_PREFIX + element.attr(\"typedef\");\r\n\t\t\t\tif (!this.controllerExists(editorControllerName)) {\r\n\t\t\t\t\t// TODO: Decide on fallback or error\r\n\t\t\t\t\t//editorControllerName = ComponentClassNames.EDITOR_COMPONENT_PREFIX + ComponentClassNames.COMPONENT;\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"[Component directive] Not implemented controller for component of type: \" + element.attr(\"typedef\"));\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttemplate.attr(\"eir-editor-component\", editorControllerName);\r\n\t\t\t\ttemplate.attr(\"ng-click\", \"componentInstance.onClick($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-attr-draggable\", \"{{eirEditorComponent.isDraggable}}\");\r\n\t\t\t\ttemplate.attr(\"ng-dragenter\", \"componentInstance.onDragenter($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-dragleave\", \"componentInstance.onDragleave($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-dragover\", \"componentInstance.onDragover($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-dragstart\", \"componentInstance.onDragstart($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-drop\", \"componentInstance.onDrop($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-mouseleave\", \"componentInstance.onMouseLeave($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-mousemove\", \"componentInstance.onMouseMove($event);\");\r\n\t\t\t\ttemplate.attr(\"ng-mouseover\", \"componentInstance.onMouseOver($event);\");\r\n\t\t\t\tconst classes: string[] = [];\r\n\t\t\t\tclasses.push(\"{ isHovered: eirEditorComponent.isHovered }\");\r\n\t\t\t\tclasses.push(\"{ isSelected: eirEditorComponent.isSelected }\");\r\n\t\t\t\tclasses.push(\"{ isWizardFocus: eirEditorComponent.wizardFocusType===1 }\");\r\n\t\t\t\tclasses.push(\"{ isWizardRest: eirEditorComponent.wizardFocusType===2 }\");\r\n\t\t\t\tclasses.push(\"{ isFinder: eirEditorComponent.isFinder }\");\r\n\t\t\t\tclasses.push(\"{ isInsertParent: eirEditorComponent.isInsertParent }\");\r\n\t\t\t\tclasses.push(\"{ isInsertChild: eirEditorComponent.isInsertChild }\");\r\n\r\n\t\t\t\ttemplate.attr(\"ng-class\", \"[\" + classes.join(\", \") + \"]\");\r\n\t\t\t}\r\n\t\t\treturn template[0].outerHTML;\r\n\t\t};\r\n\r\n\t\tComponentDirective.prototype.link = (\r\n\t\t\t$scope: IComponentScope,\r\n\t\t\t$element: ng.IAugmentedJQuery,\r\n\t\t\t$attrs: ng.IAttributes\r\n\t\t) => {\r\n\r\n\t\t\tif (!$scope.component) { throw new Error(\"[ComponentDirective] Component not set\"); }\r\n\t\t\tif (!$scope.context) { throw new Error(\"[ComponentDirective] Context not provided\"); }\r\n\t\t\tif (!$scope.parent) { throw new Error(\"[ComponentDirective] Parent not provided\"); }\r\n\r\n\t\t\tconst component = $scope.component;\r\n\t\t\tconst parentInstance = $scope.parent;\r\n\t\t\t$scope.context = Object.create($scope.context);\r\n\t\t\t// Passing scope via the $element\r\n\t\t\t$element.data(\"eir-scope\", $scope);\r\n\r\n\t\t\tconst componentInstance = ComponentsHelper.instantiateComponent(\r\n\t\t\t\tcomponent, $element, parentInstance, this.frameworkService);\r\n\t\t\t$scope.componentInstance = componentInstance;\r\n\r\n\t\t\tconst template = document.createElement(\"d\" + componentInstance.getTypedef().toLowerCase());\r\n\r\n\t\t\tthis.$compile(template)($scope, (clone, scope) => {\r\n\t\t\t\t$element.empty();\r\n\t\t\t\tconst commonPart = this.$compile(\"<eir-component-common></eir-component-common>\")($scope);\r\n\t\t\t\t$element.append(commonPart);\r\n\t\t\t\t$element.append(clone);\r\n\r\n\t\t\t\t// Components that are not Layout resolve via linking function added from defines\r\n\t\t\t\tif (componentInstance instanceof LayoutComponent) {\r\n\t\t\t\t\t$scope.onChildrenReady = () => {\r\n\t\t\t\t\t\tcomponentInstance.onChildrenReady();\r\n\t\t\t\t\t\t$scope.componentReady({ componentInstance: componentInstance });\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.$on(AngularConstants.DESTROY, (ev: ng.IAngularEvent) => {\r\n\t\t\t\t\t$scope.componentDestroyed({ componentInstance: componentInstance });\r\n\t\t\t\t\tcomponentInstance.element.empty();\r\n\t\t\t\t\tcomponentInstance.element.remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t};\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = (\r\n\t\t\t$compile: ng.ICompileService,\r\n\t\t\tframeworkService: FrameworkService,\r\n\t\t\t$controller) => {\r\n\t\t\treturn new ComponentDirective($compile, frameworkService, $controller);\r\n\t\t};\r\n\t\tdirective.$inject = [\r\n\t\t\tAngularConstants.COMPILE,\r\n\t\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\t\tAngularConstants.CONTROLLER\r\n\t\t];\r\n\t\tm.directive(\"eirComponentDirective\", directive);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\n\r\nimport { InjectNames, ThemeEnum } from \"ng2/common/constants/common.constant\";\r\nimport { DesignerManifest } from \"ng2/common/project/manifest/designer-manifest\";\r\nimport { AngularConstants } from \"../../common/angular-constants\";\r\nimport { FeatureSwitchService } from \"../../common/services/feature-switch-service\";\r\nimport { FeatureSwitchCtrl } from \"../../common/shared-components/base/feature-switch-ctrl\";\r\nimport { FrameworkService } from \"../services/framework-service\";\r\n\r\nexport interface IThemes {\r\n\tdata: string;\r\n\tdisplayName: string;\r\n}\r\n\r\nexport class TitlebarCtrl extends FeatureSwitchCtrl {\r\n\r\n\tpublic showTitlebar: boolean;\r\n\tpublic showThemeSwitch: boolean;\r\n\tpublic title: string;\r\n\tpublic currentTheme: ThemeEnum;\r\n\r\n\tpublic themes: IThemes[] =\r\n\t\t[\r\n\t\t\t{\r\n\t\t\t\tdata: \"light-theme\",\r\n\t\t\t\tdisplayName: \"Light\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tdata: \"dark-theme\",\r\n\t\t\t\tdisplayName: \"Dark\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tdata: \"high-contrast-theme\",\r\n\t\t\t\tdisplayName: \"High Contrast\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tdata: \"light-transparent-theme\",\r\n\t\t\t\tdisplayName: \"Light Transparent\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tdata: \"dark-transparent-theme\",\r\n\t\t\t\tdisplayName: \"Dark Transparent\"\r\n\t\t\t}\r\n\t\t];\r\n\r\n\tprivate unsubscribers: Array<Function> = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\t$scope: ng.IScope,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tfeatureSwitchService: FeatureSwitchService,\r\n\t) {\r\n\t\tsuper(featureSwitchService);\r\n\r\n\t\tthis.updateSettings(frameworkService.getCurrentProject().manifest);\r\n\r\n\t\t// Event used in editor when editing project settings\r\n\t\tthis.unsubscribers.push(frameworkService.projectSettingsChangedEvent.on((manifest) => {\r\n\t\t\tthis.updateSettings(manifest);\r\n\t\t}));\r\n\r\n\t\tthis.unsubscribers.push(frameworkService.currentCanvasThemeChangedEvent.on((theme: ThemeEnum) => {\r\n\t\t\tthis.currentTheme = theme;\r\n\t\t}));\r\n\r\n\t\t$scope.$on(AngularConstants.DESTROY, () => {\r\n\t\t\tangular.forEach(this.unsubscribers, (unsubscribe) => {\r\n\t\t\t\tunsubscribe();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic updateSettings(manifest: DesignerManifest): void {\r\n\t\tthis.currentTheme = manifest.defaultTheme;\r\n\t\tthis.showTitlebar = manifest.showTitleBar;\r\n\t\tthis.showThemeSwitch = manifest.themeSwitchEnabled;\r\n\t\tthis.title = this.isFeatureTranslationEnabled() ?\r\n\t\t\tthis.frameworkService.getTranslatableHeaderString() :\r\n\t\t\tmanifest.title;\r\n\t}\r\n\r\n\tpublic changeCanvasTheme(theme: ThemeEnum): void {\r\n\t\tthis.frameworkService.setCanvasTheme(theme);\r\n\t}\r\n}\r\n\r\nexport class TitlebarDirective implements ng.IDirective {\r\n\tcontroller = TitlebarCtrl;\r\n\tcontrollerAs = \"eirTitlebarCtrl\";\r\n\ttemplate = require(\"./titlebar.html\");\r\n\treplace = true; // Important for css-rule\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive = () => new TitlebarDirective();\r\n\t\tm.directive(\"eirTitlebar\", directive);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<header class=\\\"header is-personalizable application-header\\\" ng-if=eirTitlebarCtrl.showTitlebar ng-class=\\\"{'with-themeswitcher' : eirTitlebarCtrl.showThemeSwitch}\\\"> <div class=\\\"toolbar has-title\\\" ng-class=\\\"{'has-more-button' : eirTitlebarCtrl.showThemeSwitch}\\\"> <div class=title> <h1>{{eirTitlebarCtrl.title}}</h1> </div> <div ng-if=eirTitlebarCtrl.showThemeSwitch> <button class=btn-menu xi-popupmenu> <svg class=icon aria-hidden=true focusable=false> <use xlink:href=#icon-more></use> </svg> <span class=audible>More Actions</span> </button> <ul class=\\\"popupmenu is-selectable\\\"> <li class=heading>Theme</li> <li ng-repeat=\\\"theme in eirTitlebarCtrl.themes\\\" ng-class=\\\"{'is-checked':eirTitlebarCtrl.currentTheme === $index + 1}\\\"> <a ng-click=\\\"eirTitlebarCtrl.changeCanvasTheme($index + 1)\\\" data-theme=theme.data> {{theme.displayName}} </a> </li> </ul> </div> </div> </header>\";\n// Exports\nmodule.exports = code;","import angular from \"angular\";\r\n\r\nimport { componentsModule } from \"../components/module\";\r\n\r\nimport { AppLauncher } from \"./app-launcher.component\";\r\nimport { RuntimeCanvasDirective } from \"./runtime-canvas-directive\";\r\nimport { RuntimeService } from \"./runtime-service\";\r\n\r\nexport const runtimeModule = angular.module(\"runtimeModule\", [\r\n\tcomponentsModule.name\r\n]);\r\n\r\nruntimeModule.config([\"$qProvider\", ($qProvider: any) => {\r\n\t$qProvider.errorOnUnhandledRejections(false);\r\n}]);\r\n\r\nAppLauncher.add(runtimeModule);\r\nRuntimeCanvasDirective.add(runtimeModule);\r\nRuntimeService.add(runtimeModule);\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { AppTypeEnum, InjectNames, Numbers } from \"ng2/common/constants/common.constant\";\r\nimport { ErrorResponse } from \"../common/error-response\";\r\n\r\nimport { RuntimeApp } from \"ng2/common/project/runtime-app\";\r\n\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { Helper } from \"../common/helper\";\r\nimport { DialogService } from \"../common/services/dialog-service\";\r\nimport { RuntimeService } from \"./runtime-service\";\r\n\r\nexport interface IAppLauncherStateParameter extends ng.ui.IStateParamsService {\r\n\tprojectId: string;\r\n\tappType: string;\r\n}\r\n\r\nexport class AppLauncher {\r\n\tshowMashup: boolean = false;\r\n\r\n\tprojectId: string;\r\n\tappType: AppTypeEnum;\r\n\r\n\tprivate windowResizeTimerPromise: ng.IPromise<void>;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.RUNTIME_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate runtimeService: RuntimeService,\r\n\t\tprivate dialogService: DialogService\r\n\t) { }\r\n\r\n\t$onInit(): void {\r\n\t\tangular.element(window).bind(\"resize\", this.windowResizeHandler.bind(this));\r\n\r\n\t\tthis.loadProject(this.projectId).then((project: RuntimeApp) => {\r\n\t\t\tthis.showMashup = true;\r\n\t\t\tthis.initProjectUrlVariables(project);\r\n\t\t}).catch((error: ErrorResponse) => {\r\n\t\t\tconsole.error(\"[RuntimeDirective] Failed to load project with id: \" + this.projectId);\r\n\t\t\tthis.dialogService.showError(\"Load Project Error\", error.message);\r\n\t\t});\r\n\t}\r\n\r\n\t$onDestroy(): void {\r\n\t\tangular.element(window).unbind(\"resize\");\r\n\t}\r\n\r\n\tprivate initProjectUrlVariables(project: RuntimeApp): void {\r\n\t\tif (this.appType === AppTypeEnum.APPHUB) {\r\n\t\t\tconst runtimeManifest = project.getManifest();\r\n\t\t\tBackwardCompatible.tryUpdateUrlName(runtimeManifest);\r\n\t\t\tconst myList = Helper.getListByRegex(\"\\(SETVARVALUES((.*))\\)\", runtimeManifest.urlName);\r\n\t\t\tthis.runtimeService.setCurrentUrlValues(myList);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate loadProject(id: string): ng.IPromise<RuntimeApp> {\r\n\t\tlet promise: ng.IPromise<RuntimeApp>;\r\n\t\tswitch (this.appType) {\r\n\t\t\tcase AppTypeEnum.ADMIN_PREVIEW:\r\n\t\t\t\tpromise = this.runtimeService.loadPublishedProjectNoConstraint(id, this.getCanvasWidth());\r\n\t\t\t\tbreak;\r\n\t\t\tcase AppTypeEnum.RUNTIME:\r\n\t\t\tcase AppTypeEnum.APPHUB:\r\n\t\t\t\tpromise = this.runtimeService.loadPublishedProject(id, this.getCanvasWidth());\r\n\t\t\t\tbreak;\r\n\t\t\tcase AppTypeEnum.DESIGNER_PREVIEW:\r\n\t\t\t\tpromise = this.runtimeService.loadRuntimeProject(id, this.getCanvasWidth());\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconst deferredError = this.$q.defer<any>();\r\n\t\t\t\tdeferredError.reject({\r\n\t\t\t\t\tmessage: \"Error\",\r\n\t\t\t\t\tdetail: \"Invalid appType: \" + this.appType\r\n\t\t\t\t});\r\n\t\t\t\tpromise = deferredError.promise;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn promise;\r\n\t}\r\n\r\n\tprivate windowResizeHandler(): void {\r\n\t\tif (this.windowResizeTimerPromise) {\r\n\t\t\tthis.$timeout.cancel(this.windowResizeTimerPromise);\r\n\t\t}\r\n\t\tthis.windowResizeTimerPromise = this.$timeout(() => {\r\n\t\t\tthis.updateCurrentBoundary();\r\n\t\t}, Numbers.FIFTY);\r\n\t}\r\n\r\n\tprivate updateCurrentBoundary(): void {\r\n\t\tthis.runtimeService.updateCurrentBoundary(this.getCanvasWidth());\r\n\t}\r\n\r\n\tprivate getCanvasWidth(): number {\r\n\t\treturn window.innerWidth;\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirAppLauncher\", {\r\n\t\t\ttemplate: \"<eir-runtime-canvas ng-if='eirRuntimeCtrl.showMashup'></eir-runtime-canvas>\",\r\n\t\t\tbindings: {\r\n\t\t\t\tappType: \"@\",\r\n\t\t\t\tprojectId: \"@\"\r\n\t\t\t},\r\n\t\t\tcontroller: AppLauncher,\r\n\t\t\tcontrollerAs: \"eirRuntimeCtrl\"\r\n\t\t});\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IContext } from \"ng2/common/model/components/base/context.model\";\r\nimport { IJsonComponent } from \"ng2/common/model/databearer/components/json-component.model\";\r\n\r\nimport { IComponentScope } from \"../common/interface/icomponent-scope\";\r\nimport { ILayoutComponent } from \"../common/interface/ilayout-component\";\r\n\r\nimport { Debugger } from \"../common/debugger\";\r\nimport { Helper } from \"../common/helper\";\r\nimport { ApplicationParent } from \"../components/application-parent\";\r\nimport { FrameworkService } from \"../components/services/framework-service\";\r\nimport { RuntimeService } from \"./runtime-service\";\r\n\r\nclass RuntimeCanvasCtrl {\r\n\r\n\tpublic rootComponent: IJsonComponent;\r\n\tpublic parent: ApplicationParent;\r\n\tpublic context: IContext;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.ROOT_SCOPE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.FRAMEWORK_SERVICE,\r\n\t\tInjectNames.RUNTIME_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $rootScope: ng.IRootScopeService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate frameworkService: FrameworkService,\r\n\t\tprivate runtimeService: RuntimeService\r\n\t) {\r\n\t\tconst project = runtimeService.getCurrentProject();\r\n\t\tthis.loadApplication(project.rootComponent);\r\n\t}\r\n\r\n\tpublic onComponentReady(componentInstance: ILayoutComponent): void {\r\n\t\tDebugger.log(this, \"[RuntimeDirective] Root component ready\");\r\n\r\n\t\tthis.parent.addChildInstance(componentInstance);\r\n\t\tthis.runtimeService.setCurrentRootComponentInstance(componentInstance);\r\n\r\n\t\tthis.runtimeService.runStartupInteractions();\r\n\t\tcomponentInstance.newBoundaryEntered(this.runtimeService.getCurrentBoundary().id);\r\n\t\tthis.frameworkService.triggerExpressions();\r\n\r\n\t\tHelper.appIsReadyForSelenium();\r\n\t}\r\n\r\n\tprivate loadApplication(rootComponent: IJsonComponent): void {\r\n\t\tthis.parent = new ApplicationParent(\r\n\t\t\tApplicationParent.applicationParentDatabearer,\r\n\t\t\tApplicationParent.createSpoofedElement(this.$rootScope.$new() as IComponentScope),\r\n\t\t\tnull,\r\n\t\t\tthis.frameworkService);\r\n\t\tthis.context = {};\r\n\t\t// angular will compile when rootComponent is set\r\n\t\tthis.rootComponent = rootComponent;\r\n\t}\r\n}\r\n\r\nexport class RuntimeCanvasDirective implements ng.IDirective {\r\n\r\n\tpublic template = require(\"./runtime-canvas.html\");\r\n\tpublic controller = RuntimeCanvasCtrl;\r\n\tpublic controllerAs = \"eirRuntimeCanvasCtrl\";\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = () => new RuntimeCanvasDirective();\r\n\t\tm.directive(\"eirRuntimeCanvas\", directive);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<eir-titlebar></eir-titlebar> <section class=\\\"page-container mashupRootContainer runtimeMode\\\"> <eir-component-directive ng-if=eirRuntimeCanvasCtrl.rootComponent component=eirRuntimeCanvasCtrl.rootComponent context=eirRuntimeCanvasCtrl.context parent=eirRuntimeCanvasCtrl.parent component-ready=eirRuntimeCanvasCtrl.onComponentReady(componentInstance)></eir-component-directive> </section>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../appbuilder/common/angular-constants\";\r\n\r\nimport { AppTypeEnum, Config, InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IErrorResponse } from \"../../appbuilder/common/error-response\";\r\nimport { Helper } from \"../../appbuilder/common/helper\";\r\nimport { IMingleMessageData } from \"../../appbuilder/common/model/mingle.model\";\r\nimport { IApplicationMenuApi } from \"../../appbuilder/common/model/sohoxi/sohoxi-application-menu.model\";\r\nimport { ITab, ITabContent } from \"../../appbuilder/common/model/sohoxi/sohoxi-tabs.model\";\r\n\r\nimport { CommonService } from \"../../appbuilder/common/services/common-service\";\r\nimport { LanguageService } from \"../../appbuilder/common/services/language-service\";\r\nimport { MingleService } from \"../../appbuilder/common/services/mingle-service\";\r\nimport { HubService } from \"./services/hub-service\";\r\n\r\nexport class ApphubCtrl {\r\n\r\n\tpublic get isAdmin(): boolean {\r\n\t\tconst user = Config.USER;\r\n\t\treturn user && user.roles.administrator;\r\n\t}\r\n\r\n\tpublic manifests: IJsonRuntimeManifest[];\r\n\tpublic tabsAPI: ITab;\r\n\r\n\tpublic tabList: string[] = [];\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.COMPILE,\r\n\t\tAngularConstants.STATE_PARAMS,\r\n\t\tInjectNames.COMMON_SERVICE,\r\n\t\tInjectNames.MINGLE_SERVICE,\r\n\t\tInjectNames.LANGUAGE_SERVICE,\r\n\t\tInjectNames.HUB_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: ng.IScope,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $compile: ng.ICompileService,\r\n\t\tprivate $stateParams: ng.ui.IStateParamsService,\r\n\t\tprivate commonService: CommonService,\r\n\t\tprivate mingleService: MingleService,\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate hubService: HubService\r\n\t) {\r\n\r\n\t\tthis.$timeout(() => {\r\n\t\t\t$(\"body\").initialize(\"en-US\");\r\n\t\t\tthis.tabsAPI = $(\"#apphub-tabs\").data(\"tabs\");\r\n\t\t\tthis.setTabActivatedBehavior();\r\n\t\t\tthis.setTabCloseBehavior();\r\n\t\t\tthis.setOpenTabBehaviour();\r\n\t\t\tthis.languageService.detectLanguage();\r\n\r\n\t\t\t//console.info(this.languageService.getLanguage());\r\n\t\t\t//MUPS-2239\r\n\t\t\t//this.setupMingleDrillbacks();\r\n\t\t\t//this.setupMingleFavoritesContext();\r\n\t\t\t//this.mingleService.sendApplicationInitComplete();\r\n\t\t});\r\n\r\n\t\tthis.commonService.loadActivatedApps().then((response: IJsonRuntimeManifest[]) => {\r\n\t\t\tthis.manifests = response;\r\n\t\t\tthis.openTabs();\r\n\t\t}, (errorMessage: IErrorResponse) => {\r\n\t\t\tconsole.error(errorMessage + \": Unable to load projects\");\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setTabActivatedBehavior(): void {\r\n\t\t$(\"#apphub-tabs\").on(\"activated.tabs\", (event: JQueryEventObject, object: JQuery) => {\r\n\t\t\tconst activatedTab = object[0];\r\n\t\t\t//const name = activatedTab.innerHTML;\r\n\t\t\tconst id = activatedTab.getAttribute(\"href\").replace(\"#\", \"\");\r\n\t\t\tthis.hubService.setSelectedTabById(id);\r\n\t\t\t//this.mingleService.sendBusinessContextMessage(MingleService.MESSAGETYPE_BUSINESSCONTEXT, id, name); MUPS-2239\r\n\t\t\t//this.mingleService.sendBusinessContextMessage(MingleService.MESSAGETYPE_SHORTCUTCONTEXT, id, name); MUPS-2239\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setTabCloseBehavior(): void {\r\n\t\t$(\"#apphub-tabs\").on(\"close\", (event: JQueryEventObject, object: JQuery) => {\r\n\t\t\tconst removedTabId: string = object.find(\"a\").attr(\"href\");\r\n\t\t\tconst index = this.tabList.indexOf(removedTabId.substr(1, removedTabId.length));\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tthis.tabList.splice(index, 1);\r\n\t\t\t\tthis.setOpenedTabs();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.tabList.length === 0 && removedTabId !== \"#start\") {\r\n\t\t\t\tthis.createStartTab();\r\n\t\t\t\tthis.hubService.setSelectedTabById(null);\r\n\t\t\t\t//this.mingleService.sendClearContextMessage(); MUPS-2239\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate setOpenTabBehaviour(): void {\r\n\t\tthis.$element.on(\"applicationmenuopen\", () => {\r\n\t\t\tthis.createTabs();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic openHelp(): void {\r\n\t\tthis.commonService.openHelp();\r\n\t}\r\n\r\n\tpublic setupMingleDrillbacks(): void {\r\n\t\tthis.mingleService.setupMessageHandler(\r\n\t\t\tMingleService.MESSAGETYPE_APPLICATIONDRILLBACK, (data: IMingleMessageData) => {\r\n\t\t\t\tconst params = Helper.parseQueryString(data.applicationDrillback);\r\n\t\t\t\tconst appId = params.$appId;\r\n\r\n\t\t\t\tif (appId) {\r\n\t\t\t\t\tconst manifest = this.getManifest(appId);\r\n\t\t\t\t\tif (manifest) {\r\n\t\t\t\t\t\tthis.addTab(manifest.displayName, manifest.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic setupMingleFavoritesContext(): void {\r\n\t\tthis.mingleService.setupMessageHandler(\r\n\t\t\tMingleService.MESSAGETYPE_FAVORITECONTEXT, (data: IMingleMessageData) => {\r\n\t\t\t\tconst params = Helper.parseQueryString(data.favoriteContext);\r\n\t\t\t\tconst appId = params.$appId;\r\n\r\n\t\t\t\tif (appId) {\r\n\t\t\t\t\tconst manifest = this.getManifest(appId);\r\n\t\t\t\t\tif (manifest) {\r\n\t\t\t\t\t\tthis.addTab(manifest.displayName, manifest.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate createTabs(): void {\r\n\t\tconst extraTimeout = 100;\r\n\t\tthis.$timeout(() => {\r\n\t\t\tconst tabIds = this.hubService.getOpenedTabIds();\r\n\t\t\tif (tabIds.length > 0) {\r\n\t\t\t\tconst focusedId = this.hubService.getSelectedTabId();\r\n\t\t\t\ttabIds.forEach((id: string, index: number) => {\r\n\t\t\t\t\tconst manifest = this.getManifest(id);\r\n\t\t\t\t\tif (manifest) {\r\n\t\t\t\t\t\tthis.tabList.push(manifest.id);\r\n\t\t\t\t\t\tconst tabContent = this.createTabContent(manifest.id, manifest.displayName);\r\n\t\t\t\t\t\tthis.tabsAPI.add(manifest.id, tabContent);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (tabIds.length === index + 1) {\r\n\t\t\t\t\t\tthis.setTabFocused(focusedId);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis.createStartTab();\r\n\t\t\t}\r\n\t\t}, extraTimeout);\r\n\t}\r\n\r\n\tprivate getManifest(appId: string): IJsonRuntimeManifest {\r\n\t\treturn this.manifests.find(manifest => manifest.id === appId);\r\n\t}\r\n\r\n\tprivate openTabs(): void {\r\n\t\tif (this.$stateParams.isFromAdmin) {\r\n\t\t\tconst noFocus = false;\r\n\t\t\tthis.getSoHoXiAPI().openMenu(noFocus);\r\n\t\t} else {\r\n\t\t\tthis.createTabs();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getSoHoXiAPI(): IApplicationMenuApi {\r\n\t\treturn this.$element.find(\"#application-menu\").data(\"applicationmenu\");\r\n\t}\r\n\r\n\tprivate createStartTab(): void {\r\n\t\tconst tabContent: ITabContent = {\r\n\t\t\tname: \" \",\r\n\t\t\tcontent: `<div class='start-page'>\r\n\t\t\t\t\t\t<div class='apphubSplash'>\r\n\t\t\t\t\t\t\t<p class='apphubTitle'>Infor App Hub</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<eir-licenses-button\r\n\t\t\t\t\t\tapp-name=\"Infor App Hub\"\r\n\t\t\t\t\t></eir-licenses-button>\r\n\t\t\t\t\t`\r\n\t\t};\r\n\t\tthis.tabsAPI.add(\"start\", tabContent, 0);\r\n\t\tthis.$compile(\"#module-tabs-container\")(this.$scope);\r\n\t\t$(\"li:has(a[href$='start'])\").addClass(\"inactiveTab\");\r\n\t}\r\n\r\n\tpublic addTab(displayName: string, id: string): void {\r\n\t\tif (!this.isDuplicateTab(id)) {\r\n\t\t\tthis.tabList.push(id);\r\n\t\t\tthis.tabsAPI.add(id, this.createTabContent(id, displayName));\r\n\t\t\tthis.setOpenedTabs();\r\n\t\t}\r\n\r\n\t\tthis.setTabFocused(id);\r\n\t\tif (Helper.isMobile()) {\r\n\t\t\t// closes the sidebar\r\n\t\t\tthis.tabsAPI.tablist.trigger(\"close-applicationmenu\");\r\n\t\t}\r\n\r\n\t\tthis.removeStartTab();\r\n\t}\r\n\r\n\tprivate removeStartTab(): void {\r\n\t\tthis.tabsAPI.remove(\"start\");\r\n\t}\r\n\r\n\tprivate setOpenedTabs(): void {\r\n\t\tthis.hubService.setOpenedTabIds(this.tabList);\r\n\t}\r\n\r\n\tprivate setTabFocused(id: string): void {\r\n\t\tconst tabToFocus = this.tabsAPI.tablist.find(\":has(a[href$='\" + id + \"'])\");\r\n\t\ttabToFocus.trigger(\"mousedown\");\r\n\t}\r\n\r\n\tprivate isDuplicateTab(tabContent: string): boolean {\r\n\t\treturn this.tabList.indexOf(tabContent) >= 0;\r\n\t}\r\n\r\n\tprivate createTabContent(projectId: string, name: string): ITabContent {\r\n\t\tconst tabHtmlContent = `\r\n\t\t\t<div class='project-frame'>\r\n\t\t\t\t<eir-app-launcher app-type=\"${AppTypeEnum.APPHUB}\" project-id=\"${projectId}\" />\r\n\t\t\t</div>`;\r\n\r\n\t\tconst result = this.$compile(tabHtmlContent)(this.$scope);\r\n\r\n\t\tconst tabContent: ITabContent = {\r\n\t\t\tname: name,\r\n\t\t\tcontent: result,\r\n\t\t\tisDismissible: true\r\n\t\t};\r\n\t\treturn tabContent;\r\n\r\n\t}\r\n}\r\n\r\nexport class AppHubDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirApphub\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tcontroller: ApphubCtrl,\r\n\t\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t\t\ttemplate: require(\"./apphub.html\"),\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=apphub> <nav id=application-menu class=application-menu xi-appmenu> <div class=\\\"accordion panel inverse\\\" data-options=\\\"{'allowOnePane': true}\\\"> <div class=accordion-header ng-repeat=\\\"manifest in ctrl.manifests\\\"> <a ng-click=\\\"ctrl.addTab(manifest.displayName, manifest.id, manifest.urlName)\\\"> <span>{{manifest.displayName}}</span> </a> </div> </div> <div class=footer> <button class=btn-tertiary-reverse ui-sref=administration ng-if=::ctrl.isAdmin> Administration <svg class=icon focusable=false> <use xlink:href=#icon-settings></use> </svg> </button> <a ng-click=ctrl.openHelp() href=#> Help </a> </div> </nav> <div id=frame-holder class=page-container> <section id=apphub-tabs class=\\\"tab-container module-tabs\\\" data-options=\\\"{containerElement: '#module-tabs-container'}\\\"> <div class=tab-list-container> <ul class=tab-list> <li class=\\\"tab application-menu-trigger\\\" role=presentation> <a href=# role=tab aria-expanded=false aria-selected=false tabindex=-1> <span class=\\\"icon app-header\\\"> <span class=one></span> <span class=two></span> <span class=three></span> </span> <span>Menu</span> </a> </li> </ul> </div> </section> <div id=module-tabs-container class=\\\"page-container tab-panel-container\\\"></div> </div> </div> \";\n// Exports\nmodule.exports = code;","// MUPS-2682: Look into if this directive can be unified with the one used in App Builder\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { FrameworkService } from \"../appbuilder/components/services/framework-service\";\r\n\r\nexport interface IComponentValueScope extends ng.IScope {\r\n\tcontent: any;\r\n}\r\n\r\nexport class ComponentValueDirective implements ng.IDirective {\r\n\r\n\tprivate DEFAULT_VALUE: string  = \"<Empty>\";\r\n\r\n\tconstructor(private frameworkService: FrameworkService) { }\r\n\r\n\tscope = {\r\n\t\tcontent: \"=content\"\r\n\t};\r\n\r\n\ttemplate = \"{{content}}\";\r\n\r\n\tlink = (\r\n\t\tscope: IComponentValueScope,\r\n\t\telement: ng.IAugmentedJQuery,\r\n\t\tattribute: ng.IAttributes\r\n\t) => {\r\n\t\tscope.$watch(\r\n\t\t\t() => {\r\n\t\t\t\treturn this.frameworkService.isRuntimeMode();\r\n\t\t\t},\r\n\t\t\t(isRuntimeMode: boolean) => {\r\n\t\t\t\tif (!scope.content) {\r\n\t\t\t\t\tif (isRuntimeMode) {\r\n\t\t\t\t\t\tscope.content = \"\";\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tscope.content = this.DEFAULT_VALUE;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tscope.content = scope.content;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tconst directive: ng.IDirectiveFactory = (frameworkService: FrameworkService) =>\r\n\t\t\tnew ComponentValueDirective(frameworkService);\r\n\t\tdirective.$inject = [InjectNames.FRAMEWORK_SERVICE];\r\n\r\n\t\tm.directive(\"eirComponentValue\", directive);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport { AngularConstants } from \"../../appbuilder/common/angular-constants\";\r\nimport { AppState } from \"../app.state\";\r\n\r\nimport { ABFormScriptMethod, AppStatus, Config, InjectNames, Numbers, ReplaceEnum, SortEnum, Subcodes } from \"ng2/common/constants/common.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonCompositeComponent } from \"ng2/common/model/databearer/components/json-composite-component.model\";\r\nimport { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IDesignerMashup } from \"ng2/common/model/project/mashup/designer-mashup.model\";\r\nimport { IProjectInfo } from \"ng2/common/project/project-info\";\r\nimport { Debugger } from \"../../appbuilder/common/debugger\";\r\nimport { IErrorResponse } from \"../../appbuilder/common/error-response\";\r\nimport { ISearchFieldOptions } from \"../../appbuilder/common/model/sohoxi/sohoxi-searchfield.model\";\r\nimport { ConflictResolutonService } from \"../../appbuilder/common/services/conflict-resolution-service\";\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult, IMessageDialogOptions,\r\n\tIToastOptions, StandardDialogButtons\r\n} from \"../../appbuilder/common/services/dialog-service\";\r\nimport { FeatureSwitchService } from \"../../appbuilder/common/services/feature-switch-service\";\r\nimport { TagService } from \"../../appbuilder/common/services/tag-service\";\r\nimport { FeatureSwitchCtrl } from \"../../appbuilder/common/shared-components/base/feature-switch-ctrl\";\r\nimport { IProjectRole } from \"../model/project-role\";\r\nimport { IProjectSetting } from \"../model/project-settings\";\r\nimport { AdministrationService } from \"./services/administration-service\";\r\n\r\nexport interface IJsonAppManifest extends IJsonRuntimeManifest {\r\n\timported: boolean;\r\n}\r\n\r\nexport class AdministrationCtrl extends FeatureSwitchCtrl {\r\n\tpublic filterEnum = SortEnum;\r\n\tprivate unsubscribers: Function[] = [];\r\n\tpublic apps: IProjectInfo[];\r\n\tpublic searchString: string;\r\n\tpublic selectedProjectSetting: IProjectSetting;\r\n\r\n\tpublic filterTypes: IDataPair[] = [\r\n\t\t{ name: \"All Apps\", value: undefined },\r\n\t\t{ name: \"Active Apps\", value: { manifest: { status: 1 } } },\r\n\t\t{ name: \"Deactivated Apps\", value: { manifest: { status: 0 } } },\r\n\t\t{ name: \"Apps Imported by me\", value: { manifest: { createdBy: Config.USER.name } } }\r\n\t];\r\n\r\n\tpublic sortPropertiesTypes: IDataPair[] = [\r\n\t\t{ name: \"Import Date\", value: \"manifest.createdTime\" },\r\n\t\t{ name: \"Name\", value: \"manifest.displayName\" }\r\n\t];\r\n\r\n\tpublic searchfieldOptions: ISearchFieldOptions = {\r\n\t\tcollapsible: true,\r\n\t\tclearable: true,\r\n\t};\r\n\r\n\tpublic get isDeveloper(): boolean {\r\n\t\treturn Debugger.isEnabled() && Config.IS_DEV;\r\n\t}\r\n\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.STATE_SERVICE,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.ADMINISTRATION_SERVICE,\r\n\t\tInjectNames.CONFLICT_RESOLUTION_SERVICE,\r\n\t\tInjectNames.TAG_SERVICE,\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $state: ng.ui.IStateService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate administrationService: AdministrationService,\r\n\t\tprivate conflictResolutionService: ConflictResolutonService,\r\n\t\tprivate tagService: TagService,\r\n\t\tfeatureService: FeatureSwitchService,\r\n\t) {\r\n\t\tsuper(featureService);\r\n\r\n\t\tthis.loadRuntimeProjects();\r\n\t\tthis.unsubscribers.push(administrationService.projectSettingsChangedEvent.on((project: IDesignerMashup) => {\r\n\t\t\tthis.apps.forEach((app, index) => {\r\n\t\t\t\tif (project.manifest.id === app.manifest.id) {\r\n\t\t\t\t\tconst newApps = angular.copy(this.apps);\r\n\t\t\t\t\tconst newProjectInfo: IProjectInfo = {\r\n\t\t\t\t\t\tmanifest: project.manifest,\r\n\t\t\t\t\t\ttags: project.tags ? project.tags : []\r\n\t\t\t\t\t};\r\n\t\t\t\t\tnewApps[index] = newProjectInfo;\r\n\t\t\t\t\tthis.apps = newApps; //Replace apps with new apps to trigger scope-change\r\n\t\t\t\t\tthis.tagService.projectInfoChangedEvent.raise(this.apps);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}));\r\n\t}\r\n\r\n\tpublic showSettingPanel(project: IProjectInfo): void {\r\n\t\tthis.isSelectedProjectModified(() => {\r\n\t\t\tthis.administrationService.getProjectRoles(project.manifest.id)\r\n\t\t\t\t.then((roles: IProjectRole[]) => {\r\n\t\t\t\t\tthis.selectedProjectSetting = {\r\n\t\t\t\t\t\tmanifest: (project.manifest as IJsonRuntimeManifest),\r\n\t\t\t\t\t\troles: roles,\r\n\t\t\t\t\t\ttags: angular.copy(project.tags)\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic hideSettingPanel(): void {\r\n\t\tthis.isSelectedProjectModified(() => {\r\n\t\t\tthis.selectedProjectSetting = null;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate isSelectedProjectModified(callback: Function): void {\r\n\t\tif (this.selectedProjectSetting && this.selectedProjectSetting.isModified) {\r\n\t\t\tthis.dialogService\r\n\t\t\t\t.showYesNo(\r\n\t\t\t\t\t\"Warning\",\r\n\t\t\t\t\t\"You have modified data. Do you want to discard it?\",\r\n\t\t\t\t\t\"warning-text\")\r\n\t\t\t\t.then(result => {\r\n\t\t\t\t\tif (result.button === DialogButtonType.Yes) {\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tcallback();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic importProject(): void {\r\n\t\tWSForm.call({\r\n\t\t\tname: ABFormScriptMethod.SHOW_OPEN_FILE_DIALOG,\r\n\t\t\tparameters: [\r\n\t\t\t\t\"ABProject.iap\", // Filename\r\n\t\t\t\t\"Import App\",  // Caption\r\n\t\t\t\t\"AppBuilder App (*.iap)|*.iap\" // Filter\r\n\t\t\t],\r\n\t\t\tonCompleted: (response) => response !== \"-1\" ?\r\n\t\t\t\tthis.importProjectFile(response) : response\r\n\t\t});\r\n\t}\r\n\r\n\tprivate importProjectFile(filePath: string): void {\r\n\t\tthis.administrationService.importProject(filePath, ReplaceEnum.DONOTHING)\r\n\t\t\t.then((importedProject) => {\r\n\t\t\t\tthis.loadRuntimeProjects().then(() => {\r\n\t\t\t\t\tconst toastOptions: IToastOptions = {\r\n\t\t\t\t\t\ttitle: \"App Imported\",\r\n\t\t\t\t\t\tmessage: \"The App was successfully saved.\",\r\n\t\t\t\t\t\tposition: \"top right\",\r\n\t\t\t\t\t\tprogressBar: true\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.dialogService.showToast(toastOptions);\r\n\t\t\t\t\tthis.validateData(importedProject);\r\n\t\t\t\t});\r\n\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\tthis.handleImportAppError(filePath, errorResponse);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate validateData(data: any): void {\r\n\t\tthis.conflictResolutionService.checkIfInvalidImportedItems<IJsonDatasource>(\r\n\t\t\t\"data service(s)\",\r\n\t\t\tdata.datasources,\r\n\t\t).catch((errorDialogOptions) => this.dialogService.showMessage(errorDialogOptions));\r\n\t\tthis.conflictResolutionService.checkIfInvalidImportedItems<IJsonCompositeComponent>(\r\n\t\t\t\"composite(s)\",\r\n\t\t\tdata.compositeComponents,\r\n\t\t).catch((errorDialogOptions) => this.dialogService.showMessage(errorDialogOptions));\r\n\t}\r\n\r\n\tprivate handleImportAppError(filePath: string, errorResponse: IErrorResponse): void {\r\n\t\tconst dialogTitle = \"Import failed\";\r\n\r\n\t\tif (errorResponse.subcode === Subcodes.PROJECT_IMPORT_ERROR) {\r\n\t\t\tthis.dialogService.showError(\r\n\t\t\t\tdialogTitle,\r\n\t\t\t\terrorResponse.message);\r\n\t\t\tDebugger.log(this, errorResponse.detail);\r\n\t\t} else {\r\n\t\t\t/* TODO: import-error-dialog.html\r\n\t\t\t\tRename template and controller to import-conflict-dialog.\r\n\t\t\t\tSince this dialog handle import conflict rather than import error occured */\r\n\t\t\tconst options: IDialogOptions<IErrorResponse> = {\r\n\t\t\t\ttitle: dialogTitle,\r\n\t\t\t\ttemplate: require(\"../../appbuilder/common/dialogs/import-error/import-error-dialog.html\"),\r\n\t\t\t\tparameter: errorResponse,\r\n\t\t\t};\r\n\r\n\t\t\tthis.dialogService.show(options)\r\n\t\t\t\t.then((result: IDialogResult<any>) => {\r\n\t\t\t\t\tswitch (result.button) {\r\n\t\t\t\t\t\tcase DialogButtonType.Yes:\r\n\t\t\t\t\t\t\tif (errorResponse.subcode === Subcodes.PROJECT_DISPLAYNAME_CONFLICT) {\r\n\t\t\t\t\t\t\t\treturn this.handleReplace(filePath, errorResponse.detail);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this.handleReplace(filePath);\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate handleReplace(filePath: string, appId?: string): void {\r\n\t\tthis.administrationService\r\n\t\t\t.importProject(filePath, ReplaceEnum.OVERWRITE, appId)\r\n\t\t\t.then((appProject) => {\r\n\t\t\t\tthis.loadRuntimeProjects().then(() => {\r\n\t\t\t\t\tthis.dialogService.showToast({\r\n\t\t\t\t\t\ttitle: \"App Imported\",\r\n\t\t\t\t\t\tmessage: \"The App was successfully saved.\",\r\n\t\t\t\t\t\tposition: \"top right\",\r\n\t\t\t\t\t\tprogressBar: true\r\n\t\t\t\t\t});\r\n\t\t\t\t}).finally(() => {\r\n\t\t\t\t\tthis.apps.forEach((app) => {\r\n\t\t\t\t\t\tconst appManifest = app.manifest as IJsonAppManifest;\r\n\t\t\t\t\t\tif (app.manifest.id === appProject.manifest.id) {\r\n\t\t\t\t\t\t\tappManifest.imported = true;\r\n\t\t\t\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\t\t\t\tappManifest.imported = false;\r\n\t\t\t\t\t\t\t}, Numbers.FIVE_THOUSAND);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}).catch((errorResponse) => {\r\n\t\t\t\tthis.dialogService.showError(\"Import App Error\", errorResponse.message);\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic openFeatureCatalog(): void {\r\n\t\tthis.dialogService.showContextualActionPanel({\r\n\t\t\ttitle: \"Feature Catalog\",\r\n\t\t\ttemplate: \"<eir-feature-catalog></eir-feature-catalog>\",\r\n\t\t});\r\n\t}\r\n\r\n\tpublic deleteProject(project: IJsonRuntimeManifest): void {\r\n\t\tif (project.status === AppStatus.ONLINE) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst options: IMessageDialogOptions = {\r\n\t\t\ttitle: \"Delete Project\",\r\n\t\t\tmessage: \"Please confirm that you want to delete this project.\",\r\n\t\t\tstandardButtons: StandardDialogButtons.YesNo,\r\n\t\t};\r\n\t\tthis.dialogService.showMessage(options).then((result: IDialogResult<any>) => {\r\n\t\t\tif (result && result.button === DialogButtonType.Yes) {\r\n\t\t\t\tthis.administrationService.deleteRuntimeApp(project.id).then(() => {\r\n\t\t\t\t\tthis.selectedProjectSetting = null; //Clear sidebar\r\n\t\t\t\t\tthis.apps.forEach((app, index) => {\r\n\t\t\t\t\t\tif (app.manifest.id === project.id) {\r\n\t\t\t\t\t\t\tthis.apps.splice(index, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}).catch((errorResponse: IErrorResponse) => {\r\n\t\t\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\t\t\ttitle: \"Delete Project\",\r\n\t\t\t\t\t\tmessage: errorResponse.message,\r\n\t\t\t\t\t\tstandardButtons: StandardDialogButtons.Ok,\r\n\t\t\t\t\t\tisError: true,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.dialogService.showMessage(options);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate loadRuntimeProjects(): ng.IPromise<void> {\r\n\t\treturn this.administrationService.loadRuntimeProjects().then((response: IProjectInfo[]) => {\r\n\t\t\tthis.apps = response;\r\n\t\t}).catch((errorMessage: IErrorResponse) => {\r\n\t\t\tconsole.error(\"Unable to load projects\");\r\n\t\t});\r\n\t}\r\n\r\n\tpublic navigateBack(): void {\r\n\t\t// remove toolbar before changing page.\r\n\t\t// soho issue\r\n\t\tconst toolbar = this.$element.find(\".toolbar\");\r\n\t\ttoolbar.remove();\r\n\t\tthis.$state.go(AppState.HOME, {\r\n\t\t\tisFromAdmin: true,\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport class AdministrationDirective {\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.directive(\"eirAdministration\", () => {\r\n\t\t\treturn {\r\n\t\t\t\tcontroller: AdministrationCtrl,\r\n\t\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t\t\ttemplate: require(\"./administration.html\")\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n}\r\n","import { IJsonDatasource } from \"ng2/common/model/databearer/dataservice/json-datasource.model\";\r\nimport { IJsonExpression } from \"ng2/common/model/databearer/json-expression.model\";\r\nimport { IJsonInteraction } from \"ng2/common/model/databearer/json-interaction.model\";\r\nimport { IJsonLayoutComponent } from \"ng2/common/model/databearer/json-layout-component.model\";\r\nimport { IMap } from \"ng2/common/model/imap.model\";\r\nimport { IJsonLanguageComponent } from \"ng2/common/model/language.model\";\r\n\r\nexport interface IJsonCompositeComponent {\r\n\tmanifest: IJsonCompositeComponentManifest;\r\n\tcomponent: IJsonLayoutComponent;\r\n\tdatasources?: IJsonDatasource[];\r\n\tinteractions?: IJsonInteraction[];\r\n\ttranslations?: IMap<IJsonLanguageComponent[]>;\r\n\texpressions?: IJsonExpression[];\r\n}\r\n\r\nexport interface IJsonCompositeComponentManifest {\r\n\tid: string;\r\n\tdisplayName: string;\r\n\tauthor: string;\r\n\tauthorDisplayName?: string;\r\n\tcreationDate: number;\r\n\r\n}\r\n","// Module\nvar code = \"<div ng-controller=\\\"eirImportErrorCtrl as ctrl\\\"> <p>{{::ctrl.information}}</p><p> </p><p>{{::ctrl.extraInfo}}</p> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=btn-modal-primary ng-click=ctrl.confirm()> {{::ctrl.confirmButtonDisplayName}} </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=page-container> <header class=header> <div class=toolbar xi-control=toolbar> <div class=title> <button class=\\\"btn-icon application-menu-trigger\\\" type=button ng-click=ctrl.navigateBack()> <span class=\\\"icon app-header go-back\\\"> <span class=one></span> <span class=two></span> <span class=three></span> </span> </button> <h1><span>App Administration</span></h1> </div> <div class=buttonset> <input id=header-searchfield class=searchfield name=header-searchfield ng-model=ctrl.searchString xi-searchfield=ctrl.searchfieldOptions /> <button class=btn-primary type=button xi-tooltip=\\\"'Import App'\\\" xi-button ng-click=ctrl.importProject()> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-add></use> </svg> <span>Import App</span> </button> <button xi-tooltip=\\\"'Feature Catalog'\\\" xi-button class=btn-primary type=button ng-click=ctrl.openFeatureCatalog() ng-if=ctrl.isFeatureCatalogEnabled()> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-bullet-list></use> </svg> </button> <button xi-tooltip=\\\"'Developer Tools'\\\" xi-button class=btn-primary type=button ng-if=::ctrl.isDeveloper ui-sref=developer> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-tools></use> </svg> </button> </div> </div> </header> <div class=\\\"page-container custom-fixed\\\"> <section class=main role=main ng-click=ctrl.hideSettingPanel()> <div class=content> <eir-filter-toolbar-component ng-if=::ctrl.apps sort-properties-options=ctrl.sortPropertiesTypes filter-type-options=ctrl.filterTypes filter-target=ctrl.apps local-prefix=runtime-> </eir-filter-toolbar-component> <eir-app-card ng-repeat=\\\"project in collection = (ctrl.apps |\\r\\n\\t\\t\\t\\t\\tfilter : { manifest: { displayName : ctrl.searchString } }) track by project.manifest.id\\\" ng-class=\\\"{card: true, selected: project.manifest.id === ctrl.selectedProjectSetting.manifest.id, highlighted: project.manifest.imported }\\\" ng-mouseenter=\\\"project.manifest.showCardOverlay = true\\\" ng-mouseleave=\\\"project.manifest.showCardOverlay = false\\\" ng-click=\\\"$event.stopPropagation(); ctrl.showSettingPanel(project)\\\" project-setting=ctrl.selectedProjectSetting manifest=project.manifest tags=project.tags on-delete=ctrl.deleteProject(project.manifest)> </eir-app-card> </div> <eir-licenses-button app-name=\\\"Infor App Hub\\\"></eir-licenses-button> </section> <eir-admin-sidebar project-setting=ctrl.selectedProjectSetting></eir-admin-sidebar> </div> </div> \";\n// Exports\nmodule.exports = code;","import { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { FeatureSwitchService, IFeature } from \"../../../appbuilder/common/services/feature-switch-service\";\r\n\r\nexport class FeatureCatalog {\r\n\tpublic features: IFeature[];\r\n\r\n\tstatic $inject = [\r\n\t\tInjectNames.FEATURE_SWITCH_SERVICE,\r\n\t];\r\n\r\n\tconstructor(private featureService: FeatureSwitchService) { }\r\n\r\n\tpublic $onInit(): void {\r\n\t\tthis.features = this.featureService.getFeatures();\r\n\t}\r\n\r\n\tpublic toggleEnabled(feature: IFeature): void {\r\n\t\tthis.featureService.toggleFeatureStatus(feature.id);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirFeatureCatalog\", {\r\n\t\t\tcontroller: FeatureCatalog,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t\ttemplate: require(\"./feature-catalog.html\"),\r\n\t\t});\r\n\t}\r\n}\r\n","// Imports\nvar ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___ = require(\"../../../../../../../node_modules/html-loader/dist/runtime/getUrl.js\");\nvar ___HTML_LOADER_IMPORT_0___ = require(\"../../assets/images/02-thumb.png\");\n// Module\nvar ___HTML_LOADER_REPLACER_0___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_0___);\nvar code = \"<div class=list-container> <div class=\\\"row list-item\\\" ng-repeat=\\\"feature in ctrl.features\\\"> <div class=\\\"two columns\\\"> <a href=../../assets/images/02-thumb.png target=_blank> <img src=\" + ___HTML_LOADER_REPLACER_0___ + \" /> </a> </div> <div class=\\\"eight columns\\\"> <h2>{{feature.id}}</h2> <p>{{feature.description}}</p> <span>Expires: {{feature.defaultFromDate | date}}</span> </div> <div class=\\\"two columns\\\"> <button class=btn-primary ng-disabled=!feature.togglable ng-click=ctrl.toggleEnabled(feature)> {{feature.status.enabled ? 'Disable' : 'Enable'}} </button> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","export default \"../assets/images/02-thumb.png\";","import { WSForm } from \"etc-assets/user-control-es\";\r\n\r\nimport { ABFormScriptMethod, AppStatus, Config, InjectNames, MGPlatform, SaveProjectSettingEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { IExportDialogParams } from \"../../../appbuilder/common/dialogs/export/export-dialog\";\r\nimport { Helper } from \"../../../appbuilder/common/helper\";\r\nimport { DialogButtonType, DialogService, IDialogOptions, IDialogResult, IToastOptions } from \"../../../appbuilder/common/services/dialog-service\";\r\nimport { IProjectSetting } from \"../../model/project-settings\";\r\n\r\nimport { AdministrationService } from \"../services/administration-service\";\r\n\r\nexport class AdminAppCard {\r\n\tpublic projectSetting: IProjectSetting;\r\n\tpublic manifest: IJsonRuntimeManifest;\r\n\tpublic tags: IJsonTag[];\r\n\r\n\tstatic $inject: string[] = [\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.ADMINISTRATION_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate administrationService: AdministrationService\r\n\t) {\r\n\t}\r\n\r\n\tpublic get ProjectImportedBy(): string {\r\n\t\treturn Helper.htmlEncode(this.manifest.createdByDisplayName);\r\n\t}\r\n\r\n\tpublic get ProjectVersion(): string {\r\n\t\treturn Helper.htmlEncode(this.manifest.version);\r\n\t}\r\n\r\n\tpublic exportProject(): void {\r\n\t\tconst projectId = this.manifest.id;\r\n\r\n\t\tif (Config.MG_PLATFORM === MGPlatform.WEB) {\r\n\t\t\tconst displayName = this.manifest.displayName;\r\n\t\t\tconst options: IDialogOptions<IExportDialogParams> = {\r\n\t\t\t\ttitle: \"Export Project\",\r\n\t\t\t\ttemplate: require(\"../../../appbuilder/common/dialogs/export/export-dialog.html\"),\r\n\t\t\t\tparameter: {\r\n\t\t\t\t\ttype: \"project\",\r\n\t\t\t\t\tfilename: displayName,\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<string>) => {\r\n\t\t\t\tif (result.button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.administrationService.exportProject(projectId, result.value);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else { // MG_PLATFORM === WinStudio\r\n\t\t\tWSForm.call({\r\n\t\t\t\tname: ABFormScriptMethod.SHOW_SAVE_FILE_DIALOG,\r\n\t\t\t\tparameters: [\r\n\t\t\t\t\t`${this.manifest.displayName}.iap`, // Filename\r\n\t\t\t\t\t\"Export Filename\",  // Caption\r\n\t\t\t\t\t\"AppBuilder Project (*.iap)|*.iap\" // Filter\r\n\t\t\t\t],\r\n\t\t\t\tonCompleted: filePath => {\r\n\t\t\t\t\tthis.administrationService.exportProject(projectId, filePath);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic toggleActivated(): void {\r\n\t\tconst project = this.manifest;\r\n\t\tconst projectStatus = project.status ? AppStatus.OFFLINE : AppStatus.ONLINE;\r\n\t\tconst statusText = projectStatus ? \"Activated\" : \"Deactivated\";\r\n\r\n\t\tthis.administrationService.saveProjectSetting(\r\n\t\t\tthis.projectSetting,\r\n\t\t\tSaveProjectSettingEnum.INFO,\r\n\t\t\tprojectStatus\r\n\t\t).then(() => {\r\n\t\t\tproject.status = projectStatus;\r\n\t\t\tconst options: IToastOptions = {\r\n\t\t\t\ttitle: \"App \" + statusText,\r\n\t\t\t\tmessage: \"The app successfully \" + statusText,\r\n\t\t\t\tposition: \"top right\",\r\n\t\t\t\tprogressBar: true\r\n\t\t\t};\r\n\t\t\tthis.dialogService.showToast(options);\r\n\t\t\tthis.projectSetting.manifest.status = projectStatus;\r\n\t\t}).catch(() => {\r\n\t\t\tconst options: IToastOptions = {\r\n\t\t\t\ttitle: \"App\",\r\n\t\t\t\tmessage: \"The app unsuccessfully \" + statusText,\r\n\t\t\t\tposition: \"top right\",\r\n\t\t\t\tprogressBar: true\r\n\t\t\t};\r\n\t\t\tthis.dialogService.showToast(options);\r\n\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirAppCard\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tprojectSetting: \"=\",\r\n\t\t\t\tmanifest: \"<\",\r\n\t\t\t\ttags: \"<\",\r\n\t\t\t\tonDelete: \"&\"\r\n\t\t\t},\r\n\t\t\tcontroller: AdminAppCard,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t\ttemplate: require(\"./admin-app-card.html\"),\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=export-dialog ng-controller=\\\"eirExportProjectCtrl as ctrl\\\"> <div class=field> <div class=filename> <eir-input-field-component class=input-field-component label-name=\\\"Name of the exported file\\\" field-value=ctrl.exportFileName validation=\\\"{\\r\\n\\t\\t\\t\\t\\tvalidators: [\\r\\n\\t\\t\\t\\t\\t\\t{\\r\\n\\t\\t\\t\\t\\t\\t\\ttype: 'custom',\\r\\n\\t\\t\\t\\t\\t\\t\\tcustom: {\\r\\n\\t\\t\\t\\t\\t\\t\\t\\tvalidator: ctrl.validate,\\r\\n\\t\\t\\t\\t\\t\\t\\t\\terrorMessage: 'Valid characters are A-Z a-z 0-9 . _ -'\\r\\n\\t\\t\\t\\t\\t\\t\\t}\\r\\n\\t\\t\\t\\t\\t\\t},\\r\\n\\t\\t\\t\\t\\t\\t{type: 'not-empty'}\\r\\n\\t\\t\\t\\t\\t],\\r\\n\\t\\t\\t\\t\\terrorList: ctrl.errorList\\r\\n\\t\\t\\t\\t}\\\"/> </div> <div class=extension> <p><b>{{:: \\\".\\\" + ctrl.fileExtension}}</b></p> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.close()>Cancel</button> <button type=button class=\\\"btn-modal btn-modal-primary\\\" ng-click=ctrl.export() ng-disabled=ctrl.isInvalid> Export </button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=card-header> <h2 class=widget-title> {{ctrl.manifest.displayName}} </h2> <div class=status-icon ng-if=\\\"ctrl.manifest.status === 1\\\"> <svg class=\\\"icon icon-activated\\\" focusable=false aria-hidden=true role=presentation xi-tooltip=\\\"'Active'\\\"> <use xlink:href=#icon-confirm></use> </svg> </div> <div class=\\\"status-icon status-offline icon\\\" ng-if=\\\"ctrl.manifest.status === 0\\\" xi-tooltip=\\\"'Deactivated'\\\"></div> </div> <div class=card-content> <div class=image-container> <img ng-src=\\\"{{ctrl.manifest.previewImg ? ctrl.manifest.previewImg : 'assets/images/02-thumb.png'}}\\\" alt=\\\"No image\\\"/> </div> <div class=\\\"description small-thin-text\\\"> <div class=\\\"information import-info\\\" xi-tooltip=\\\"'Imported by: {{::ctrl.ProjectImportedBy}}'\\\"> <span>Imported by</span> <span>{{::ctrl.ProjectImportedBy}}</span> <span class=date>{{::ctrl.manifest.createdTime | date:'yyyy-MM-dd HH:mm:ss'}}</span> </div> <div class=information xi-tooltip=\\\"'Version: {{ctrl.manifest.status ? ctrl.ProjectVersion : '-'}}'\\\"> <span>Version</span> <span>{{ctrl.manifest.status ? ctrl.ProjectVersion : '-'}}</span> </div> </div> <div class=card-overlay ng-if=\\\"ctrl.manifest.id === ctrl.projectSetting.manifest.id || ctrl.manifest.showCardOverlay\\\"> <div class=project-description> <p>{{ctrl.manifest.description ? ctrl.manifest.description : 'No description'}}</p> </div> <eir-project-tags class=tags tags=ctrl.tags></eir-project-tags> <div ng-show=\\\"ctrl.manifest.id === ctrl.projectSetting.manifest.id\\\" class=overlay-buttons ng-click=$event.stopPropagation()> <button class=btn-tertiary xi-tooltip=\\\"ctrl.manifest.status === 1 ? 'Deactivate App' : 'Activate App'\\\" ng-click=\\\"$event.stopPropagation(); ctrl.toggleActivated();\\\"> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=\\\"\\\" ng-attr-xlink:href=\\\"{{ctrl.manifest.status === 1 ? '#icon-stop' : '#icon-play'}}\\\"></use> </svg> <span>{{ctrl.manifest.status === 1 ? 'Deactivate' : 'Activate'}}</span> </button> <button class=btn-tertiary xi-tooltip=\\\"'Export App'\\\" ng-click=\\\"$event.stopPropagation(); ctrl.exportProject();\\\"> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-export></use> </svg> <span>Export</span> </button> <button class=btn-tertiary xi-tooltip=\\\"ctrl.manifest.status === 1 ? 'Only Deactivated Apps can be deleted' : 'Delete App'\\\" ng-class=\\\"{ 'disabled-action': ctrl.manifest.status === 1 }\\\" ng-click=\\\"$event.stopPropagation(); ctrl.onDelete({manifest: ctrl.manifest});\\\"> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-delete></use> </svg> <span>Delete</span> </button> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport {\r\n\tIDatagridApi,\r\n\tIDataGridColumn,\r\n\tIDataGridOptions,\r\n\tIDataGridToolbarOptions,\r\n} from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { AngularConstants } from \"../../../../appbuilder/common/angular-constants\";\r\nimport { IDialogBaseScope } from \"../../../../appbuilder/common/defines\";\r\nimport { Helper } from \"../../../../appbuilder/common/helper\";\r\nimport { IDialog } from \"../../../../appbuilder/common/services/dialog-service\";\r\nimport { IRowItem } from \"../../../../appbuilder/common/sohoxi/datagrid-helper\";\r\nimport { IRole } from \"../../../model/project-role\";\r\n\r\nexport class AddRolesDialog {\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.ELEMENT\r\n\t];\r\n\r\n\tpublic dialog: IDialog<{ dataset: IRole[] }>;\r\n\tpublic datagridOptions: IDataGridOptions<IRole>;\r\n\r\n\tprivate selectedRoles: IRole[] = [];\r\n\tprivate dataset: IRole[];\r\n\tprivate datagridApi: IDatagridApi;\r\n\r\n\tconstructor(\r\n\t\tprivate scope: IDialogBaseScope<{ dataset: IRole[] }>,\r\n\t\tprivate $element: ng.IAugmentedJQuery\r\n\t) {\r\n\t\tthis.dialog = scope.eirDialog;\r\n\t\tthis.dataset = this.dialog.parameter.dataset;\r\n\r\n\t\tthis.initDatagrid();\r\n\t\tif (Helper.isIE()) {\r\n\t\t\tthis.refreshSohoIcons();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic initDatagrid(): void {\r\n\t\tconst columns: IDataGridColumn[] = [];\r\n\t\tcolumns.push({\r\n\t\t\tid: \"selectionCheckbox\",\r\n\t\t\tsortable: false,\r\n\t\t\tresizable: false,\r\n\t\t\tformatter: Soho.Formatters.SelectionCheckbox,\r\n\t\t\talign: \"center\"\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"groupId\",\r\n\t\t\tname: \"Name\",\r\n\t\t\tfield: \"groupId\",\r\n\t\t\tsortable: true,\r\n\t\t\tresizable: true,\r\n\t\t\ttextOverflow: \"ellipsis\",\r\n\t\t\twidth: 200\r\n\t\t});\r\n\t\tcolumns.push({\r\n\t\t\tid: \"displayName\",\r\n\t\t\tname: \"Description\",\r\n\t\t\tfield: \"displayName\",\r\n\t\t\tsortable: true,\r\n\t\t\tresizable: true,\r\n\t\t\ttextOverflow: \"ellipsis\",\r\n\t\t\twidth: 400,\r\n\t\t});\r\n\r\n\t\tconst toolbarOptions: IDataGridToolbarOptions = {\r\n\t\t\ttitle: \" \", // needs to be here to align search field to right\r\n\t\t\tresults: true,\r\n\t\t\tkeywordFilter: true,\r\n\t\t\tactions: false,\r\n\t\t\tcollapsibleFilter: true,\r\n\t\t};\r\n\r\n\t\tconst datagridOptions: IDataGridOptions<IRole> = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tdataset: this.dataset,\r\n\t\t\tselectable: SelectableEnum.Multiple,\r\n\t\t\tpaging: true,\r\n\t\t\tpagesize: 10,\r\n\t\t\ttoolbar: toolbarOptions,\r\n\t\t\tenableTooltips: true\r\n\t\t};\r\n\t\tthis.datagridOptions = datagridOptions;\r\n\r\n\t\tthis.initDatagridOnSelectEvent();\r\n\t}\r\n\r\n\tprivate initDatagridOnSelectEvent(): void {\r\n\t\tthis.$element.find(\"#role-list\").on(\"selected\", (event, rowItems: IRowItem<IRole>[]) => {\r\n\t\t\tif (rowItems.length > 0) {\r\n\t\t\t\tthis.selectedRoles = rowItems.map(rowObject => rowObject.data);\r\n\t\t\t} else {\r\n\t\t\t\tthis.selectedRoles = [];\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate refreshSohoIcons(): void {\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.$element.find(\"use\").each((idx: number, elem: Element) => {\r\n\t\t\t\telem.setAttribute(\"xlink:href\", elem.getAttribute(\"xlink:href\"));\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic add(): void {\r\n\t\tthis.dialog.close({\r\n\t\t\tvalue: this.selectedRoles\r\n\t\t});\r\n\t}\r\n\r\n\tpublic cancel(): void {\r\n\t\tthis.dialog.close();\r\n\t}\r\n\r\n\tpublic onRemove(): void {\r\n\t\tif (!this.datagridApi) {\r\n\t\t\tthis.datagridApi = this.$element.find(\"#role-list\").data(\"datagrid\");\r\n\t\t}\r\n\t\tthis.datagridApi.removeSelected();\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirAddRoles\", AddRolesDialog);\r\n\t}\r\n}\r\n","import angular from \"angular\";\r\nimport { AngularConstants } from \"../../../appbuilder/common/angular-constants\";\r\n\r\nimport { InjectNames, SaveProjectSettingEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IJsonTag } from \"ng2/common/model/databearer/json-tag.model\";\r\nimport { BackwardCompatible } from \"ng2/common/project/backward-compatible\";\r\nimport { ProjectInfo } from \"ng2/common/project/project-info\";\r\n\r\nimport { IListViewApi, IListViewOptions } from \"../../../appbuilder/common/model/sohoxi/sohoxi-listview.model\";\r\nimport { Utils } from \"../../../appbuilder/common/sohoxi/utils\";\r\nimport { IProjectRole, IRole } from \"../../model/project-role\";\r\nimport { IProjectSetting } from \"../../model/project-settings\";\r\n\r\nimport {\r\n\tDialogButtonType, DialogService, IDialogOptions, IDialogResult,\r\n\tIMessageDialogOptions, IToastOptions, StandardDialogButtons\r\n} from \"../../../appbuilder/common/services/dialog-service\";\r\nimport { AdministrationService } from \"../services/administration-service\";\r\nimport { IVersionDialogParameters } from \"./version-dialog/version-dialog\";\r\n\r\nexport class AdminSidebar {\r\n\r\n\tpublic static URL_LIMIT = 50;\r\n\tpublic previousProjectSetting: IProjectSetting;\r\n\tpublic set projectSetting(value: IProjectSetting) {\r\n\t\tthis.previousProjectSetting = angular.copy(this.innerProjectSetting = value);\r\n\r\n\t\tif (value) {\r\n\t\t\tthis.roleListViewOptions = {\r\n\t\t\t\tdataset: value.roles,\r\n\t\t\t\ttemplate: `<ul>\r\n\t\t\t\t\t\t\t\t{{#dataset}}\r\n\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t<p id=\"{{name}}\" class=\"listview-heading\">{{name}}</p>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t{{/dataset}}\r\n\t\t\t\t\t\t\t</ul>`\r\n\t\t\t};\r\n\r\n\t\t\tthis.innerProjectSetting.manifest = angular.copy(value.manifest);\r\n\t\t\tthis.innerProjectSetting.isModified = value.isModified;\r\n\t\t\tthis.innerProjectSetting.roles = angular.copy(value.roles);\r\n\t\t\tthis.innerProjectSetting.tags = angular.copy(value.tags);\r\n\r\n\t\t}\r\n\t}\r\n\tpublic get projectSetting(): IProjectSetting {\r\n\t\treturn this.innerProjectSetting;\r\n\t}\r\n\tprivate innerProjectSetting: IProjectSetting;\r\n\r\n\tpublic get project(): IJsonRuntimeManifest {\r\n\t\treturn this.projectSetting ? this.projectSetting.manifest : null;\r\n\t}\r\n\tpublic get projectRoles(): IProjectRole[] {\r\n\t\treturn this.projectSetting ? this.projectSetting.roles : null;\r\n\t}\r\n\r\n\t/**\r\n\t * True if any (savable) setting has changed.\r\n\t */\r\n\tpublic get isModified(): boolean {\r\n\t\tif (!this.projectSetting || !this.previousProjectSetting) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tconst newProject = this.projectSetting.manifest;\r\n\t\tconst oldProject = this.previousProjectSetting.manifest;\r\n\t\tconst newRoles = this.projectSetting.roles;\r\n\t\tconst oldRoles = this.previousProjectSetting.roles;\r\n\t\tconst newTags = this.projectSetting.tags;\r\n\t\tconst oldTags = this.previousProjectSetting.tags;\r\n\r\n\t\tthis.projectSetting.isModified = newProject.description !== oldProject.description ||\r\n\t\t\tnewProject.displayName !== oldProject.displayName ||\r\n\t\t\tnewProject.title !== oldProject.title ||\r\n\t\t\tnewProject.urlName !== oldProject.urlName ||\r\n\t\t\tnewProject.version !== oldProject.version ||\r\n\t\t\tthis.deepListEquals(newRoles, oldRoles, \"name\") ||\r\n\t\t\tthis.deepListEquals(newTags, oldTags, \"name\");\r\n\r\n\t\treturn this.projectSetting.isModified;\r\n\t}\r\n\r\n\t/**\r\n\t * TODO: Give better name, and move to somewhere else. Perhaps helper class\r\n\t * deepListEquals compares if list of object has changed. Specically it checks for one property\r\n\t * in objects if it has changed.\r\n\t */\r\n\tprivate deepListEquals(listOfObj1: any[], listOfObj2: any[], propertyName: string): boolean {\r\n\t\tconst result1 =\r\n\t\t\tlistOfObj1.length !== listOfObj2.length ||\r\n\t\t\tlistOfObj1.some(\r\n\t\t\t\tnewRole => listOfObj2.findIndex(oldRole => oldRole[propertyName] === newRole[propertyName]) === -1);\r\n\t\tconst result2 =\r\n\t\t\tlistOfObj1.length === listOfObj2.length &&\r\n\t\t\tlistOfObj1.some(\r\n\t\t\t\tnewRole => listOfObj2.findIndex(oldRole => oldRole[propertyName] === newRole[propertyName]) === -1);\r\n\t\treturn result1 || result2;\r\n\t}\r\n\r\n\tpublic disabledButtonSet: boolean = false;\r\n\tpublic ifsRoles: IRole[] = [];\r\n\tpublic roleListViewOptions: IListViewOptions;\r\n\tpublic appUrl: string;\r\n\tpublic limitUrl: number = AdminSidebar.URL_LIMIT;\r\n\r\n\tstatic $inject: string[] = [\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tAngularConstants.Q,\r\n\t\tInjectNames.ADMINISTRATION_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate administrationService: AdministrationService,\r\n\t\tprivate dialogService: DialogService,\r\n\t) {\r\n\t\tadministrationService.getIfsRoles()\r\n\t\t\t.then(roles => this.ifsRoles = roles);\r\n\t}\r\n\r\n\tprivate previousProjectId: string;\r\n\r\n\tpublic $doCheck(): void {\r\n\t\tif (this.project && this.previousProjectId !== this.project.id) {\r\n\t\t\tthis.limitUrl = AdminSidebar.URL_LIMIT;\r\n\t\t\tthis.setSidebarBaseURL();\r\n\t\t\tthis.previousProjectId = this.project.id;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate setSidebarBaseURL(): void {\r\n\t\tconst manifest = this.projectSetting.manifest;\r\n\t\tif (BackwardCompatible.tryUpdateUrlName(manifest)) { //backwards compatibility\r\n\t\t\tthis.previousProjectSetting.manifest.urlName = manifest.urlName;\r\n\r\n\t\t\tconst dontShowToast = true;\r\n\t\t\tthis.save(dontShowToast);\r\n\t\t}\r\n\r\n\t\tthis.appUrl = window.location.origin +\r\n\t\t\t\"/WSWebClient/PlainForm.aspx?page=FormOnly&notitle=1&Form=AppHub\" + this.projectSetting.manifest.urlName;\r\n\t}\r\n\r\n\tpublic showMore(): void {\r\n\t\tif (this.limitUrl === this.appUrl.length) {\r\n\t\t\tthis.limitUrl = AdminSidebar.URL_LIMIT;\r\n\t\t} else {\r\n\t\t\tthis.limitUrl = this.appUrl.length;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic copyUrl(): void { //Copy url to clipboard\r\n\t\tconst url = this.appUrl;\r\n\t\tconst textArea = document.createElement(\"textarea\");\r\n\t\ttextArea.value = url;\r\n\t\tdocument.body.appendChild(textArea);\r\n\t\ttextArea.select();\r\n\r\n\t\ttry {\r\n\t\t\tdocument.execCommand(\"copy\");\r\n\t\t\tconst toastOptions: IToastOptions = {\r\n\t\t\t\ttitle: \"Copy\",\r\n\t\t\t\tmessage: \"URL Copied to Clipboard\",\r\n\t\t\t\tposition: \"top right\"\r\n\t\t\t};\r\n\t\t\tthis.dialogService.showToast(toastOptions);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.warn(\"Unable to copy\");\r\n\t\t}\r\n\r\n\t\tdocument.body.removeChild(textArea);\r\n\t}\r\n\r\n\tpublic saveTags(tags: IJsonTag[]): void {\r\n\t\tthis.projectSetting.tags = tags;\r\n\t}\r\n\r\n\tpublic upgradeProject(): void {\r\n\t\tconst options: IDialogOptions<IVersionDialogParameters> = {\r\n\t\t\ttitle: \"Select App Version\",\r\n\t\t\ttemplate: require(\"./version-dialog/version-dialog.html\"),\r\n\t\t\tstyle: \"width: 500px; max-height: 500px;\",\r\n\t\t\tparameter: {\r\n\t\t\t\tprojectId: this.project.id,\r\n\t\t\t\tcurrentVersion: this.previousProjectSetting.manifest.version,\r\n\t\t\t},\r\n\t\t};\r\n\t\tthis.dialogService.show<IVersionDialogParameters, ProjectInfo>(options).then(result => {\r\n\t\t\tif (result.button === DialogButtonType.Ok && result.value) {\r\n\t\t\t\tconst manifest = result.value.manifest as IJsonRuntimeManifest;\r\n\t\t\t\tthis.projectSetting.manifest = manifest;\r\n\t\t\t\tthis.projectSetting.tags = result.value.tags;\r\n\t\t\t\tthis.buildUrl(manifest);\r\n\t\t\t}\r\n\t\t}).catch(err => {\r\n\t\t\tconsole.error(\"Version dialog closed with error:\", err);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic editUrlValues(): void {\r\n\t\tif (this.projectSetting.manifest.urlVariables.length > 0) {\r\n\t\t\tconst options: IDialogOptions<IJsonRuntimeManifest> = {\r\n\t\t\t\ttitle: \"Edit URL Values\",\r\n\t\t\t\ttemplate: require(\"./url-value-dialog/url-value-dialog.html\"),\r\n\t\t\t\tparameter: this.projectSetting.manifest,\r\n\t\t\t\tstyle: \"width: 750px; height: 300px;\"\r\n\t\t\t};\r\n\t\t\tthis.dialogService.show(options).then((result: IDialogResult<IDataPair[]>) => {\r\n\t\t\t\tconst button = result.button;\r\n\t\t\t\tif (button === DialogButtonType.Ok) {\r\n\t\t\t\t\tthis.buildUrl(this.projectSetting.manifest, result.value);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconst options: IMessageDialogOptions = {\r\n\t\t\t\ttitle: \"Url Variables\",\r\n\t\t\t\tmessage: \"This App has no inbound Url Parameters.\",\r\n\t\t\t\tstandardButtons: StandardDialogButtons.Ok\r\n\t\t\t};\r\n\t\t\tthis.dialogService.showMessage(options);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic onAddRoles(): void {\r\n\t\tconst options: IDialogOptions<{ dataset: IRole[] }> = {\r\n\t\t\ttitle: \"Select Security Roles\",\r\n\t\t\ttemplate: require(\"./add-roles-dialog/add-roles-dialog.html\"),\r\n\t\t\tparameter: {\r\n\t\t\t\tdataset: angular.copy(this.getFilteredAddedRoles())\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.dialogService.show(options).then((result) => {\r\n\t\t\tif (result.value) {\r\n\t\t\t\tconst ifsRoles = result.value as IRole[];\r\n\t\t\t\tifsRoles.forEach(ifsRole => {\r\n\t\t\t\t\tthis.projectSetting.roles.push({\r\n\t\t\t\t\t\tname: ifsRole.groupId\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tthis.roleListViewOptions.dataset = this.projectSetting.roles;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onRemoveRole(): void {\r\n\t\tconst api: IListViewApi = Utils.getData(this.$element.find(\"#roleList\"), \"listview\");\r\n\t\tconst selectedRole = api.getSelected();\r\n\t\tconst indexToRemove = this.projectSetting.roles.findIndex((item) => {\r\n\t\t\treturn item.name === selectedRole.find(\"p\")[0].id;\r\n\t\t});\r\n\r\n\t\tif (indexToRemove !== -1) {\r\n\t\t\tapi.remove(selectedRole as any);\r\n\t\t\tthis.projectSetting.roles.splice(indexToRemove, 1);\r\n\t\t\tthis.roleListViewOptions.dataset = this.projectSetting.roles;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate buildUrl(manifest: IJsonRuntimeManifest, urlValues: IDataPair[] = []): void {\r\n\t\tvar urlString = \"\";\r\n\t\tmanifest.urlVariables.forEach((urlVariable) => {\r\n\t\t\tconst variable = urlValues.find((urlValue) => {\r\n\t\t\t\treturn urlValue.name === urlVariable.name;\r\n\t\t\t});\r\n\t\t\turlString += `,${urlVariable.name}=`;\r\n\t\t\tif (variable) {\r\n\t\t\t\turlString += variable.value;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.projectSetting.manifest.urlName = `(SETVARVALUES(InitURL=run/${manifest.id}${urlString})`;\r\n\t\tthis.setSidebarBaseURL();\r\n\t}\r\n\r\n\t/**\r\n\t * Filter out roles which is already added to project\r\n\t */\r\n\tprivate getFilteredAddedRoles(): IRole[] {\r\n\t\tconst filteredRoles: IRole[] = [];\r\n\t\tthis.ifsRoles.forEach(ifsRole => {\r\n\t\t\tconst result = this.projectRoles.find(projectRole => {\r\n\t\t\t\treturn ifsRole.groupId === projectRole.name;\r\n\t\t\t});\r\n\t\t\tif (!result) {\r\n\t\t\t\tfilteredRoles.push(ifsRole);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn filteredRoles;\r\n\t}\r\n\r\n\tpublic discard(): void {\r\n\t\tif (this.disabledButtonSet) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.projectSetting = this.previousProjectSetting;\r\n\t\tthis.roleListViewOptions.dataset = this.projectSetting.roles;\r\n\t}\r\n\r\n\tpublic save(noToast: boolean = false): void {\r\n\t\tif (this.disabledButtonSet) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.disabledButtonSet = true;\r\n\t\tlet promise;\r\n\t\tif (this.previousProjectSetting.manifest.version !== this.projectSetting.manifest.version) {\r\n\t\t\tpromise = this.doVersionUpgrade();\r\n\t\t} else {\r\n\t\t\tpromise = this.administrationService\r\n\t\t\t\t.saveProjectSetting(this.projectSetting, SaveProjectSettingEnum.ALL);\r\n\t\t}\r\n\t\tpromise\r\n\t\t\t.then((response: IProjectSetting) => {\r\n\t\t\t\tthis.administrationService.projectSettingsChangedEvent.raise(response);\r\n\r\n\t\t\t\tthis.projectSetting.tags = response.tags;\r\n\t\t\t\tthis.previousProjectSetting = angular.copy(this.projectSetting);\r\n\r\n\t\t\t\tconst options: IToastOptions = {\r\n\t\t\t\t\ttitle: \"Properties Saved\",\r\n\t\t\t\t\tmessage: \"Changes to app properties have been saved\",\r\n\t\t\t\t\tposition: \"top right\",\r\n\t\t\t\t\tprogressBar: true\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (!noToast) {\r\n\t\t\t\t\tthis.dialogService.showToast(options);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.disabledButtonSet = false;\r\n\t\t\t})\r\n\t\t\t.catch(errorResponse => {\r\n\t\t\t\tthis.dialogService.showError(\"Save Error\", errorResponse.message);\r\n\t\t\t\tthis.disabledButtonSet = false;\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Check if version has changed, and performs an upgrade.\r\n\t */\r\n\tprivate doVersionUpgrade(): ng.IPromise<IProjectSetting> {\r\n\t\tconst newVersion = this.projectSetting.manifest.version;\r\n\t\tconst projectId = this.projectSetting.manifest.id;\r\n\t\tconst status = this.previousProjectSetting.manifest.status;\r\n\r\n\t\treturn this.administrationService.activateProjectVersion(projectId, status, newVersion);\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirAdminSidebar\", {\r\n\t\t\tbindings: {\r\n\t\t\t\tprojectSetting: \"=\",\r\n\t\t\t},\r\n\t\t\tcontroller: AdminSidebar as any,\r\n\t\t\tcontrollerAs: \"ctrl\",\r\n\t\t\ttemplate: require(\"./admin-sidebar.html\"),\r\n\t\t});\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=eir-version-dialog ng-controller=\\\"eirVersionDialogCtrl as $ctrl\\\"> <div class=listview xi-listview=\\\"{selectable: 'single'}\\\"> <ul> <li ng-repeat=\\\"version in $ctrl.versions\\\" ng-click=$ctrl.toggleSelected(version)> <p class=listview-heading>{{version}} <i ng-show=\\\"$ctrl.currentVersion === version\\\">(Current Version)</i></p> </li> </ul> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=$ctrl.cancel()>Cancel</button> <button type=button class=btn-modal-primary ng-disabled=!$ctrl.selectedVersion ng-click=$ctrl.switch()>Select</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=eir-url-value-dialog ng-controller=\\\"eirUrlValueDialogCtrl as $ctrl\\\"> <div class=url-datagrid id=url-datagrid xi-datagrid=$ctrl.datagridOptions /> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=$ctrl.cancel()>Cancel</button> <button type=button class=btn-modal-primary ng-click=$ctrl.save()>Close</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"datagrid-container add-roles\\\" ng-controller=\\\"eirAddRoles as ctrl\\\"> <div class=field> <div class=manage-datagrid> <div class=\\\"contextual-toolbar toolbar is-hidden\\\"> <div class=\\\"title selection-count\\\"></div> <div class=buttonset> <button class=btn type=button id=remove-btn ng-click=ctrl.onRemove()> <svg class=icon focusable=false aria-hidden=true role=presentation> <use xlink:href=#icon-delete></use> </svg> <span>Remove</span> </button> </div> </div> <div id=role-list class=datagrid-contained xi-datagrid=ctrl.datagridOptions></div> </div> </div> <div class=modal-buttonset> <button type=button class=btn-modal ng-click=ctrl.cancel()>Cancel</button> <button type=button class=\\\"btn-modal-primary no-validation\\\" ng-click=ctrl.add()>Select</button> </div> </div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<nav class=\\\"sidebar {{ctrl.isModified ? 'has-save-button' : ''}}\\\"> <div class=splash ng-hide=ctrl.project> <p>No App Selected</p> </div> <div class=\\\"content project-settings\\\" ng-if=ctrl.project> <div class=field> <label for=name>Name</label> <input class=sidebar-field type=text id=name name=name ng-model=ctrl.project.displayName> </div> <div class=\\\"field description-field\\\"> <label for=description>Description</label> <textarea class=\\\"textarea sidebar-field\\\" id=description name=description ng-model=ctrl.project.description></textarea> </div> <div class=url-button> <button type=button class=btn-tertiary ng-click=ctrl.editUrlValues()> <span>Edit URL Values</span> </button> </div> <div class=field> <label>URL</label> <p class=\\\"text-data text-block url-area\\\"> {{ctrl.appUrl | limitTo: ctrl.limitUrl }}{{ ctrl.appUrl.length > ctrl.limitUrl ? \\\"...\\\" : \\\"\\\" }} <button class=\\\"btn-tertiary show-more\\\" ng-if=\\\"ctrl.appUrl.length > 50\\\" ng-click=ctrl.showMore()> {{ ctrl.appUrl.length > ctrl.limitUrl ? \\\"Show more\\\" : \\\"Show less\\\" }}</button> </p> <div class=btn-field ng-if=\\\"ctrl.appUrl.length <= ctrl.limitUrl\\\"> <button type=button class=\\\"btn-tertiary copy-btn\\\" ng-click=ctrl.copyUrl()>Copy to Clipboard</button> </div> </div> <eir-tag-dropdown class=\\\"light admin\\\" project=ctrl.projectSetting.manifest selected-tags=ctrl.projectSetting.tags on-save-tags=ctrl.saveTags($tags)></eir-tag-dropdown> <div class=\\\"field data-field\\\"> <label class=version-label>Version</label> <div class=horizontal> <p class=\\\"text-data text-block\\\">{{ctrl.project.version}}</p> <button type=button class=btn-tertiary ng-click=ctrl.upgradeProject()> <span>Upgrade</span> </button> </div> </div> <div class=\\\"field imported-field\\\"> <label>Imported By</label> <p class=\\\"text-data text-block\\\"> {{ctrl.project.createdByDisplayName}} <br/> {{ctrl.project.createdTime | date:'yyyy-MM-dd, HH:mm:ss'}} </p> </div> <div class=\\\"field role-list\\\"> <div class=card> <div class=card-header> <h2 class=card-title>App Access</h2> </div> <div class=card-content> <div class=\\\"contextual-toolbar toolbar is-hidden\\\"> <div class=buttonset> <button class=btn-tertiary title=\\\"Remove Selected Items\\\" type=button ng-click=ctrl.onRemoveRole()>Remove</button> </div> </div> <div id=roleList class=listview xi-listview=ctrl.roleListViewOptions></div> </div> </div> <div class=buttonset> <button type=button class=btn-tertiary aria-haspopup=false ng-click=ctrl.onAddRoles()> <svg class=icon focusable=false aria-hidden=true> <use xlink:href=#icon-add></use> </svg> <span>Add Role</span> </button> </div> </div> <div class=\\\"angularAnimate field project-settings-buttonset animate-show-hide {{ctrl.disabledButtonSet ? 'disabled' : ''}}\\\" ng-show=ctrl.isModified> <button ng-click=ctrl.discard()>Discard Changes</button> <button ng-click=ctrl.save()>Save</button> </div> </div> </nav>\";\n// Exports\nmodule.exports = code;","import { AngularConstants } from \"../../../../appbuilder/common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { SelectableEnum } from \"ng2/common/constants/sohoxi.constant\";\r\nimport { IDataPair } from \"ng2/common/model/data-pair.model\";\r\nimport { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { IJsonUrlVariable } from \"ng2/common/model/databearer/json-url-variable.model\";\r\nimport {\r\n\tIDatagridApi,\r\n\tIDataGridColumn,\r\n\tIDatagridColumnArgs,\r\n\tIDataGridOptions,\r\n} from \"ng2/common/model/sohoxi/sohoxi-datagrid.model\";\r\n\r\nimport { IDialogBaseScope } from \"../../../../appbuilder/common/defines\";\r\nimport { Helper } from \"../../../../appbuilder/common/helper\";\r\nimport { DialogButtonType, DialogService, IDialogResult } from \"../../../../appbuilder/common/services/dialog-service\";\r\n\r\nexport interface IDatagridUrlVariableItem extends IJsonUrlVariable {\r\n\tvalue?: string;\r\n}\r\n\r\nexport class UrlValueDialogCtrl {\r\n\tpublic project: IJsonRuntimeManifest;\r\n\tpublic projectId: string;\r\n\tpublic urlVariables: IDatagridUrlVariableItem[];\r\n\tpublic urlValues: IDataPair[] = [];\r\n\tpublic urlName: string;\r\n\tpublic datagridOptions: IDataGridOptions<IDatagridUrlVariableItem>;\r\n\tprivate illegalCharactersRegex = /[!@#$%^&*(),.?=\":{}|<>]/;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tAngularConstants.TIMEOUT,\r\n\t\tAngularConstants.ELEMENT,\r\n\t\tInjectNames.DIALOG_SERVICE\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<IJsonRuntimeManifest>,\r\n\t\tprivate $timeout: ng.ITimeoutService,\r\n\t\tprivate $element: ng.IAugmentedJQuery,\r\n\t\tprivate dialogService: DialogService\r\n\t) {\r\n\t\tthis.project = $scope.eirDialog.parameter;\r\n\t\tthis.projectId = this.project.id;\r\n\t\tthis.urlName = this.project.urlName;\r\n\t\tthis.urlVariables = this.project.urlVariables;\r\n\r\n\t\tthis.initDatagridOptions();\r\n\t\tthis.$timeout(() => {\r\n\t\t\tthis.initUrlVariablesValues();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic updateUrlValue(updatedUrlValue: IDataPair): void {\r\n\t\tconst urlVariable = this.urlValues.find((urlValue) => {\r\n\t\t\treturn urlValue.name === updatedUrlValue.name;\r\n\t\t});\r\n\r\n\t\tif (urlVariable) {\r\n\t\t\turlVariable.value = updatedUrlValue.value;\r\n\t\t} else {\r\n\t\t\tthis.urlValues.push({\r\n\t\t\t\tname: updatedUrlValue.name,\r\n\t\t\t\tvalue: updatedUrlValue.value\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic cancel(): void {\r\n\t\tthis.$scope.eirDialog.close();\r\n\t}\r\n\r\n\tpublic save(): void {\r\n\t\tconst hasIllegalCharacters = this.urlValues.find((urlValue) => {\r\n\t\t\treturn this.illegalCharactersRegex.test(urlValue.value);\r\n\t\t});\r\n\r\n\t\tif (hasIllegalCharacters) {\r\n\t\t\tthis.dialogService.showError(\"Error\", \"No special characters allowed.\");\r\n\t\t} else {\r\n\t\t\tconst result: IDialogResult<IDataPair[]> = {\r\n\t\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\t\tvalue: this.urlValues\r\n\t\t\t};\r\n\t\t\tthis.$scope.eirDialog.close(result);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate initUrlVariablesValues(): void {\r\n\t\tconst myList = Helper.getListByRegex(\"\\(SETVARVALUES((.*))\\)\", this.urlName);\r\n\t\tmyList.forEach((urlData) => {\r\n\t\t\tconst name = urlData.substring(0, urlData.indexOf(\"=\"));\r\n\t\t\tconst value = urlData.substring(urlData.lastIndexOf(\"=\") + 1);\r\n\r\n\t\t\tconst datagridUrlVariable = this.urlVariables.find((urlVariable) => {\r\n\t\t\t\treturn urlVariable.name === name;\r\n\t\t\t});\r\n\t\t\tif (datagridUrlVariable) {\r\n\t\t\t\tdatagridUrlVariable.value = value;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate initDatagridOptions(): void {\r\n\t\tconst columns: IDataGridColumn[] = [\r\n\t\t\t{\r\n\t\t\t\tid: \"name\",\r\n\t\t\t\tname: \"Name\",\r\n\t\t\t\tfield: \"name\",\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t\twidth: \"25%\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"description\",\r\n\t\t\t\tname: \"Description\",\r\n\t\t\t\tfield: \"description\",\r\n\t\t\t\tresizable: true,\r\n\t\t\t\tsortable: true,\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t\twidth: \"45%\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: \"value\",\r\n\t\t\t\tname: \"Value\",\r\n\t\t\t\tfield: \"value\",\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tsortable: false,\r\n\t\t\t\teditor: Soho.Editors.Input,\r\n\t\t\t\tisEditable: () => {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\tformatter: Soho.Formatters.Ellipsis,\r\n\t\t\t\twidth: \"30%\"\r\n\t\t\t},\r\n\t\t];\r\n\r\n\t\tthis.datagridOptions = {\r\n\t\t\tcolumns: columns,\r\n\t\t\tisList: true,\r\n\t\t\teditable: true,\r\n\t\t\tselectable: SelectableEnum.Single,\r\n\t\t\tdataset: this.urlVariables\r\n\t\t};\r\n\r\n\t\tthis.$element.find(\"#url-datagrid\").on(\"cellchange\",\r\n\t\t\t(e: JQueryEventObject, args: IDatagridColumnArgs<IDataPair>) => {\r\n\t\t\t\tconst hasNewValue = args.value !== args.oldValue;\r\n\t\t\t\tconst hasIllegalCharacters = this.illegalCharactersRegex.test(args.value);\r\n\t\t\t\tif (hasIllegalCharacters) {\r\n\t\t\t\t\tthis.showCellError(args);\r\n\t\t\t\t}\r\n\t\t\t\tif (hasNewValue && args.oldValue !== undefined) {\r\n\t\t\t\t\tconst updatedUrlValue = {\r\n\t\t\t\t\t\tname: args.rowData.name,\r\n\t\t\t\t\t\tvalue: args.value\r\n\t\t\t\t\t} as IDataPair;\r\n\t\t\t\t\tthis.updateUrlValue(updatedUrlValue);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tprivate showCellError(args: IDatagridColumnArgs<IDataPair>): void {\r\n\t\tthis.getSohoXiApi().showCellError(args.row, args.cell, \"No special characters allowed.\", \"Error\");\r\n\t}\r\n\r\n\tprivate getSohoXiApi(): IDatagridApi {\r\n\t\treturn this.$element.find(\"#url-datagrid\").data(\"datagrid\");\r\n\t}\r\n\r\n\tpublic static add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirUrlValueDialogCtrl\", UrlValueDialogCtrl);\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../../../appbuilder/common/angular-constants\";\r\n\r\nimport { InjectNames } from \"ng2/common/constants/common.constant\";\r\nimport { ProjectInfo } from \"ng2/common/project/project-info\";\r\nimport { IDialogBaseScope } from \"../../../../appbuilder/common/defines\";\r\nimport { DialogButtonType, IDialogResult } from \"../../../../appbuilder/common/services/dialog-service\";\r\nimport { AdministrationService } from \"../../services/administration-service\";\r\n\r\nexport interface IVersionDialogParameters {\r\n\tprojectId: string;\r\n\tcurrentVersion: string;\r\n}\r\n\r\nexport class VersionDialogCtrl {\r\n\tpublic versions: string[];\r\n\tpublic projectId: string;\r\n\tpublic currentVersion: string;\r\n\tpublic selectedVersion: string;\r\n\r\n\tstatic $inject = [\r\n\t\tAngularConstants.SCOPE,\r\n\t\tInjectNames.ADMINISTRATION_SERVICE,\r\n\t];\r\n\r\n\tconstructor(\r\n\t\tprivate $scope: IDialogBaseScope<IVersionDialogParameters>,\r\n\t\tprivate adminService: AdministrationService\r\n\t) {\r\n\t\tthis.projectId = $scope.eirDialog.parameter.projectId;\r\n\t\tthis.currentVersion = $scope.eirDialog.parameter.currentVersion;\r\n\r\n\t\tthis.adminService.listProjectVersions(this.projectId).then(versions => {\r\n\t\t\tthis.versions = versions;\r\n\t\t}).catch(err => {\r\n\t\t\tconsole.error(\"Error getting project versions:\", err);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic toggleSelected(version: string): void {\r\n\t\tif (this.selectedVersion === version) {\r\n\t\t\tthis.selectedVersion = null;\r\n\t\t} else {\r\n\t\t\tthis.selectedVersion = version;\r\n\t\t}\r\n\t}\r\n\r\n\tpublic cancel(): void {\r\n\t\tconst result: IDialogResult<string> = {\r\n\t\t\tvalue: null,\r\n\t\t\tbutton: DialogButtonType.Cancel,\r\n\t\t};\r\n\t\tthis.$scope.eirDialog.close(result);\r\n\t}\r\n\r\n\tpublic switch(): void {\r\n\t\tthis.adminService.getRepositoryProject(this.projectId, this.selectedVersion)\r\n\t\t\t.then(manifest => {\r\n\t\t\t\tconst result: IDialogResult<ProjectInfo> = {\r\n\t\t\t\t\tvalue: manifest,\r\n\t\t\t\t\tbutton: DialogButtonType.Ok,\r\n\t\t\t\t};\r\n\t\t\t\tthis.$scope.eirDialog.close(result);\r\n\t\t\t});\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.controller(\"eirVersionDialogCtrl\", VersionDialogCtrl);\r\n\t}\r\n}\r\n","import { IMap } from \"ng2/common/model/imap.model\";\r\nimport { DeveloperToolCtrl } from \"./developer-tool-ctrl\";\r\n\r\nexport class DeveloperToolComponent implements ng.IComponentOptions {\r\n\tpublic controller: any;\r\n\tpublic controllerAs: string;\r\n\tpublic template: string;\r\n\tpublic bindings: IMap<string>;\r\n\r\n\tconstructor() {\r\n\t\tthis.bindings = {};\r\n\r\n\t\tthis.controller = DeveloperToolCtrl;\r\n\t\tthis.controllerAs = \"ctrl\";\r\n\t\tthis.template = require(\"./developer-tool-template.html\");\r\n\t}\r\n\r\n\tstatic add(m: ng.IModule): void {\r\n\t\tm.component(\"eirDeveloperTool\", new DeveloperToolComponent());\r\n\t}\r\n}\r\n","import { AngularConstants } from \"../../appbuilder/common/angular-constants\";\r\nimport { AppState } from \"../app.state\";\r\n\r\nimport { AppStatus, Config, InjectNames, SaveProjectSettingEnum } from \"ng2/common/constants/common.constant\";\r\nimport { IJsonRuntimeManifest } from \"ng2/common/model/databearer/json-manifest.model\";\r\nimport { Debugger } from \"../../appbuilder/common/debugger\";\r\nimport { IProjectSetting } from \"../model/project-settings\";\r\n\r\nimport { DialogService } from \"../../appbuilder/common/services/dialog-service\";\r\nimport { AdministrationService } from \"../administration/services/administration-service\";\r\n\r\nexport class DeveloperToolCtrl {\r\n\tpublic static $inject = [\r\n\t\tAngularConstants.Q,\r\n\t\tAngularConstants.STATE_SERVICE,\r\n\t\tInjectNames.DIALOG_SERVICE,\r\n\t\tInjectNames.ADMINISTRATION_SERVICE\r\n\t];\r\n\r\n\tget isDeveloper(): boolean {\r\n\t\treturn Debugger.isEnabled() && Config.IS_DEV;\r\n\t}\r\n\r\n\tprivate acceptanceTestAppIdList: string[];\r\n\tprivate activatedAcceptanceTestAppList: { id: string; name: string; description: string; status: number }[];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: ng.IQService,\r\n\t\tprivate $state: ng.ui.IStateService,\r\n\t\tprivate dialogService: DialogService,\r\n\t\tprivate adminstrationService: AdministrationService\r\n\t) {}\r\n\r\n\tpublic $onInit(): void {\r\n\t\tif (this.isDeveloper) {\r\n\t\t\tconsole.debug(\"I am developer\");\r\n\t\t} else {\r\n\t\t\tthis.$state.go(AppState.HOME, {\r\n\t\t\t\tisFromAdmin: true,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst filterAcceptanceTestItems = (\r\n\t\t\tlist: { id: string; name: string; description: string; status: number }[]\r\n\t\t): { id: string; name: string; description: string; status: number }[] => {\r\n\t\t\treturn list\r\n\t\t\t\t.filter(item => item.name.indexOf(\"ACCTEST\") === 0);\r\n\t\t};\r\n\r\n\t\tthis.adminstrationService\r\n\t\t\t.loadRuntimeProjects()\r\n\t\t\t.then(runtimeApps => {\r\n\t\t\t\treturn runtimeApps.map(app => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tid: app.manifest.id,\r\n\t\t\t\t\t\tname: app.manifest.displayName,\r\n\t\t\t\t\t\tdescription: app.manifest.description,\r\n\t\t\t\t\t\tstatus: (app.manifest as IJsonRuntimeManifest).status\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t\t.then(filterAcceptanceTestItems)\r\n\t\t\t.then(result => {\r\n\t\t\t\tthis.acceptanceTestAppIdList = result.map(app => app.id);\r\n\t\t\t\tthis.activatedAcceptanceTestAppList = result.filter(app => app.status === 1);\r\n\t\t\t});\r\n\t}\r\n\r\n\tpublic static resolve(): void {\r\n\t\tDebugger.initialize();\r\n\t}\r\n\r\n\tpublic deleteAllAcceptanceTestApps(): void {\r\n\t\tconst amount = this.acceptanceTestAppIdList.length;\r\n\t\tconst promises: ng.IPromise<void>[] = [];\r\n\r\n\t\tthis.acceptanceTestAppIdList.forEach((projectId, index) => {\r\n\t\t\tpromises.push(\r\n\t\t\t\tthis.adminstrationService.deleteRuntimeApp(projectId).then(() =>\r\n\t\t\t\t\tthis.dialogService.showToast({\r\n\t\t\t\t\t\ttitle: \"Deleted\",\r\n\t\t\t\t\t\tmessage: `Deleted ${projectId}, still ${amount -\r\n\t\t\t\t\t\t\tindex - 1} of ${amount} to process`\r\n\t\t\t\t\t})\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tthis.$q.all(promises)\r\n\t\t\t.then(() =>\r\n\t\t\t\tthis.dialogService.showToast({\r\n\t\t\t\t\ttitle: \"Result\",\r\n\t\t\t\t\tmessage: \"All acceptance test projects deleted\"\r\n\t\t\t\t}))\r\n\t\t\t.finally(() => this.acceptanceTestAppIdList.length = 0);\r\n\t}\r\n\r\n\tpublic deactivateAllApps(): void {\r\n\t\tconst amount = this.activatedAcceptanceTestAppList.length;\r\n\t\tconst promises: ng.IPromise<void>[] = [];\r\n\r\n\t\tthis.activatedAcceptanceTestAppList.forEach((app, index) => {\r\n\t\t\tconst stuff: IProjectSetting = {\r\n\t\t\t\tmanifest: {\r\n\t\t\t\t\tid: app.id,\r\n\t\t\t\t\tstatus: app.status,\r\n\t\t\t\t\tdisplayName: app.name,\r\n\t\t\t\t\tdescription: app.description\r\n\t\t\t\t}\r\n\t\t\t} as any;\r\n\r\n\t\t\tpromises.push(\r\n\t\t\t\tthis.adminstrationService\r\n\t\t\t\t\t.saveProjectSetting(stuff, SaveProjectSettingEnum.INFO, AppStatus.OFFLINE)\r\n\t\t\t\t\t.then(() =>\r\n\t\t\t\t\t\tthis.dialogService.showToast({\r\n\t\t\t\t\t\t\ttitle: \"Deactivated\",\r\n\t\t\t\t\t\t\tmessage: `Deactivated ${app.name}, still ${amount -\r\n\t\t\t\t\t\t\t\tindex - 1} of ${amount} to process`\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t)\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tthis.$q.all(promises)\r\n\t\t\t.then(() =>\r\n\t\t\t\tthis.dialogService.showToast({\r\n\t\t\t\t\ttitle: \"Result\",\r\n\t\t\t\t\tmessage: \"All acceptance test projects deactivated\"\r\n\t\t\t\t}))\r\n\t\t\t.finally(() => this.activatedAcceptanceTestAppList.length = 0);\r\n\t}\r\n}\r\n","// Module\nvar code = \"<div class=container ng-show=::ctrl.isDeveloper> <div class=page-container> <header class=\\\"header is-personalizable\\\"> <div class=toolbar> <div class=title> <button class=\\\"btn-icon application-menu-trigger\\\" type=button ui-sref=administration> <span class=\\\"icon app-header go-back\\\"> <span class=one></span> <span class=two></span> <span class=three></span> </span> </button> <h1><span>Developer Tools</span></h1> </div> </div> </header> <div class=\\\"page-container scrollable\\\" id=maincontent role=main> <div class=\\\"row top-padding\\\"> <div class=\\\"twelve columns\\\"> <div class=row> <div class=field> <button class=btn-primary ng-click=ctrl.deleteAllAcceptanceTestApps() ng-disabled=\\\"ctrl.acceptanceTestAppIdList.length === 0\\\"> Delete all acceptance test apps </button> <br/><br/> <button class=btn-primary ng-click=ctrl.deactivateAllApps() ng-disabled=\\\"ctrl.activatedAcceptanceTestAppList.length === 0\\\"> Deactivate all activate acceptance test apps </button> </div> </div> </div> </div> </div> </div> </div>\";\n// Exports\nmodule.exports = code;","import { runtimeApp as ng1RootModule } from \"../appruntime/app\";\r\n\r\nimport { appStates } from \"./app.states\";\r\nimport { Ng2Component } from \"./ng2.component\";\r\n\r\nimport { NgModule } from \"@angular/core\";\r\nimport { BrowserModule } from \"@angular/platform-browser\";\r\nimport { UpgradeModule } from \"@angular/upgrade/static\";\r\nimport { UIRouterUpgradeModule } from \"@uirouter/angular-hybrid\";\r\n\r\n// The main NgModule for the Angular portion of the hybrid app\r\n@NgModule({\r\n\timports: [\r\n\t\tBrowserModule,\r\n\t\t// Provide angular upgrade capabilities\r\n\t\tUpgradeModule,\r\n\t\t// Provides the @uirouter/angular directives and registers\r\n\t\t// the future state for the lazy loaded contacts module\r\n\t\tUIRouterUpgradeModule.forRoot({ states: appStates }),\r\n\t],\r\n\tdeclarations: [Ng2Component],\r\n\tentryComponents: [Ng2Component],\r\n\tproviders: [],\r\n})\r\nexport class RootModule {\r\n\tconstructor(\r\n\t\tprivate upgrade: UpgradeModule\r\n\t) { }\r\n\r\n\tpublic ngDoBootstrap(): void {\r\n\t\tthis.upgrade.bootstrap(document.body, [ng1RootModule.name]);\r\n\t}\r\n}\r\n","import { Ng2Component } from \"./ng2.component\";\r\n\r\nimport { NgHybridStateDeclaration } from \"@uirouter/angular-hybrid\";\r\n\r\nconst ng2RootState: NgHybridStateDeclaration = {\r\n\turl: \"/ng2\",\r\n\tname: \"app.ng2\",\r\n\tcomponent: Ng2Component,\r\n};\r\n\r\nconst nestedState: NgHybridStateDeclaration = {\r\n\turl: \"/ng2nested\",\r\n\tname: \"app.ng2.ng2\",\r\n\tcomponent: Ng2Component,\r\n};\r\n\r\nexport const appStates = [ng2RootState, nestedState];\r\n"],"sourceRoot":""}